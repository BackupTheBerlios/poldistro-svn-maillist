From muaddiblsd at berlios.de  Tue Nov  1 02:16:53 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Tue, 1 Nov 2005 02:16:53 +0100
Subject: [Poldistro-svn] r757 - trunk/096/pkg/mobiles/timedScripts/include
Message-ID: <200511010116.jA11GrJ6002749@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-01 02:16:51 +0100 (Tue, 01 Nov 2005)
New Revision: 757

Modified:
   trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc
Log:
Fixed issue with the killing of timed scripts.

Modified: trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc	2005-10-31 22:43:58 UTC (rev 756)
+++ trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc	2005-11-01 01:16:51 UTC (rev 757)
@@ -86,7 +86,7 @@
  *
  */
 function TS_GetControllerProcess(mobile, start:=NOSTART_CONTROLLER)
-	var pid := CInt(GetObjProperty(mobile, "#TimerControlPid"));
+	var pid := CInt(GetObjProperty(mobile, "#TimerControlPID"));
 	var process := GetProcess(pid);
 	if ( !process )
 		if ( start )
@@ -115,7 +115,7 @@
 	if ( TS_GetControllerProcess(mobile, NOSTART_CONTROLLER) )
 		return error{"errortext":="Error::TS_StartController() - Controller is already running."};
 	endif
-	
+
 	var script := start_script(":timedscripts:timerControl", mobile);
 	if ( script.errortext )
 		SysLog("Error::TS_StartController() ->"+script.errortext);



From austin at berlios.de  Tue Nov  1 05:06:23 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 05:06:23 +0100
Subject: [Poldistro-svn] r758 - in trunk/096/pkg/mobiles/timedScripts/subScripts: . food
Message-ID: <200511010406.jA146NUT010732@sheep.berlios.de>

Author: austin
Date: 2005-11-01 05:06:14 +0100 (Tue, 01 Nov 2005)
New Revision: 758

Added:
   trunk/096/pkg/mobiles/timedScripts/subScripts/food/
   trunk/096/pkg/mobiles/timedScripts/subScripts/food/alcohol.src
Log:
Now your players can be just like me on days that end with 'Y'

Added: trunk/096/pkg/mobiles/timedScripts/subScripts/food/alcohol.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/subScripts/food/alcohol.src	2005-11-01 01:16:51 UTC (rev 757)
+++ trunk/096/pkg/mobiles/timedScripts/subScripts/food/alcohol.src	2005-11-01 04:06:14 UTC (rev 758)
@@ -0,0 +1,44 @@
+use uo;
+use os;
+use util;
+
+include ":timedscripts:timedScripts";
+
+program shitfaced(params)
+	var mobile := params[1];
+
+	var cycle := 0;
+	while(1)
+		cycle := cycle+1;
+		if  ( cycle == 1 )
+			SendSysMessage(mobile, "You feel no effects from the alcohol.");
+		elseif ( cycle == 5 )
+			SendSysMessage(mobile, "You think you might get drunk if you have anymore alcohol.");
+		elseif ( cycle == 8 )
+			SendSysMessage(mobile, "You begin to feel a little buzzed.");
+		elseif ( cycle == 13 )
+			SendSysMessage(mobile, "You become drunk and stumble about.");
+		elseif ( cycle == 20 )
+			SendSysMessage(mobile, "You begin to feel ill from the alcohol.");
+		endif
+
+		var roll := RandomInt(10);
+		if ( cycle >= 13 )
+			mobile.facing := RandomDiceRoll("1d8");
+			PrintTextAbove(mobile, "*Hic!*");
+
+			if ( roll < 7 )
+				PerformAction(mobile, 32);
+			endif
+		endif
+
+		if ( cycle > 25 ) // Boy this person is wasted.
+			PerformAction(mobile, 32);
+			if ( roll < 3 )
+				CreateItemAtLocation(mobile.x, mobile.y, mobile.z, "vomit", 1);
+			endif
+		endif
+		
+		Sleep(RandomDiceRoll("1d4")+2);
+	endwhile
+endprogram
\ No newline at end of file



From austin at berlios.de  Tue Nov  1 05:14:30 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 05:14:30 +0100
Subject: [Poldistro-svn] r759 - in trunk/096/pkg: items/food items/traps items/walkOn/paraField items/walkOn/poisonField mobiles/brainAI/scripts/combat mobiles/oldAI mobiles/timedScripts/subScripts/paralysis
Message-ID: <200511010414.jA14EUiK012126@sheep.berlios.de>

Author: austin
Date: 2005-11-01 05:14:25 +0100 (Tue, 01 Nov 2005)
New Revision: 759

Modified:
   trunk/096/pkg/items/food/drink.src
   trunk/096/pkg/items/food/eat.src
   trunk/096/pkg/items/traps/poisonTrapTriggered.src
   trunk/096/pkg/items/walkOn/paraField/control.src
   trunk/096/pkg/items/walkOn/poisonField/control.src
   trunk/096/pkg/mobiles/brainAI/scripts/combat/rigger.src
   trunk/096/pkg/mobiles/oldAI/employed.src
   trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/endParalysis.src
   trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/paralysis.src
Log:
Scripts updated to use the timedScripts package rather than PoisonWatcher.

Modified: trunk/096/pkg/items/food/drink.src
===================================================================
--- trunk/096/pkg/items/food/drink.src	2005-11-01 04:06:14 UTC (rev 758)
+++ trunk/096/pkg/items/food/drink.src	2005-11-01 04:14:25 UTC (rev 759)
@@ -4,7 +4,7 @@
 use os;
 
 include "include/canAccess";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
 
 const SOUND_EFFECT_DRINK1 := 0x32;
 const ACTION_DRINK := 0x22;
@@ -25,7 +25,7 @@
     var poison := CInt(GetObjProperty(drink, "poison_level"));
 
     if (poison > 0 )
-        AddPoison(character, "defaultPoison", 120, character, poison);
+        TS_StartTimer(character, "defaultPoison", 120, poison, character);
     endif
 
     SubtractAmount( drink, 1 );

Modified: trunk/096/pkg/items/food/eat.src
===================================================================
--- trunk/096/pkg/items/food/eat.src	2005-11-01 04:06:14 UTC (rev 758)
+++ trunk/096/pkg/items/food/eat.src	2005-11-01 04:14:25 UTC (rev 759)
@@ -7,7 +7,7 @@
 
 include "include/canAccess";
 include "include/attributes";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
 include "include/client";
 
 program eat(who, food)
@@ -84,7 +84,7 @@
     endcase
     SendSysMessage(who, themsg);
     if (poison > 0)
-      AddPoison(who, "defaultPoison", 120, who, poison);
+      TS_StartTimer(who, "defaultPoison", 120, poison, who);
     endif
   endif
 endprogram

Modified: trunk/096/pkg/items/traps/poisonTrapTriggered.src
===================================================================
--- trunk/096/pkg/items/traps/poisonTrapTriggered.src	2005-11-01 04:06:14 UTC (rev 758)
+++ trunk/096/pkg/items/traps/poisonTrapTriggered.src	2005-11-01 04:14:25 UTC (rev 759)
@@ -1,7 +1,7 @@
 use uo;
 
 include "include/sound";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
 
 
 const FX_POISON_GAS := 0x113a;
@@ -16,7 +16,9 @@
 	PlaySoundEffect(who, SFX_232);
 	PrintTextAbovePrivate(who, message, who);
 	PlayStationaryEffect(item.x, item.y, item.z, FX_POISON_GAS, 10,10, 0, who.realm);
-	start_script(":spells:poisonDamage", {who, "", "poison trap", trapstrength});
+	
+	TS_StartTimer(who, "defaultPoison", 15, trapstrength);
+	
 	item.usescript := "";
 	EraseObjProperty(item, "trap_type");
 	EraseObjProperty(item, "trap_strength");

Modified: trunk/096/pkg/items/walkOn/paraField/control.src
===================================================================
--- trunk/096/pkg/items/walkOn/paraField/control.src	2005-11-01 04:06:14 UTC (rev 758)
+++ trunk/096/pkg/items/walkOn/paraField/control.src	2005-11-01 04:14:25 UTC (rev 759)
@@ -7,7 +7,7 @@
 use os;
 use util;
 
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
 
 program controlScript(field)
 	SetObjProperty(field, "#PID", GetPid());
@@ -51,7 +51,7 @@
 endfunction
 
 function ParalyzeMobile(mobile, duration)
-	AddPoison(mobile, "Paralyze", duration, 0);
+	TS_StartTimer(mobile, "Paralyze", duration);
 
 	return 1;
 endfunction

Modified: trunk/096/pkg/items/walkOn/poisonField/control.src
===================================================================
--- trunk/096/pkg/items/walkOn/poisonField/control.src	2005-11-01 04:06:14 UTC (rev 758)
+++ trunk/096/pkg/items/walkOn/poisonField/control.src	2005-11-01 04:14:25 UTC (rev 759)
@@ -7,7 +7,7 @@
 use os;
 use util;
 
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
 
 program controlScript(field)
 	SetObjProperty(field, "#PID", GetPid());
@@ -51,7 +51,7 @@
 endfunction
 
 function PoisonMobile(mobile, poison_level, creator)
-	AddPoison(mobile, "DefaultPoison", 10, creator, poison_level);
+	TS_StartTimer(mobile, "DefaultPoison", 10, poison_level, creator);
 
 	return 1;
 endfunction

Modified: trunk/096/pkg/mobiles/brainAI/scripts/combat/rigger.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/combat/rigger.src	2005-11-01 04:06:14 UTC (rev 758)
+++ trunk/096/pkg/mobiles/brainAI/scripts/combat/rigger.src	2005-11-01 04:14:25 UTC (rev 759)
@@ -6,7 +6,7 @@
 include ":brainAI:npcNerves";
 include ":brainAI:npcCommands";
 include ":attributes:attributes";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
 
 program BrainNerve(params)
 	var npc		:= params[1];
@@ -89,7 +89,7 @@
 					AI_Turn(npc, opponent, NETURN_TOWARD);
 					PlayMovingEffect(npc, opponent, 3900, 10, 10);
 					PrintTextAbove(opponent, "*SPLAT!*");
-					AddPoison(opponent, "poostink", 30, npc);
+					TS_StartTimer(opponent, "poostink", 30);
 					SetObjProperty(npc, "#NextShoot", ReadGameClock()+30);
 				endif
 			endif

Modified: trunk/096/pkg/mobiles/oldAI/employed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-01 04:06:14 UTC (rev 758)
+++ trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-01 04:14:25 UTC (rev 759)
@@ -10,7 +10,7 @@
 include ":npcutils:NPCCast";
 include ":npcutils:names";
 include "include/dist";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
 
 set_priority(5);
 
@@ -358,7 +358,7 @@
     SetMana(me, GetMana(me) + 2);
 	ev := wait_for_event(2);
 	case (ev.type)
-      EVID_DAMAGED: if(ListPoisonsByType(me, "defaultPoison").size() > 1)
+      EVID_DAMAGED: if(TS_GetTimerNames(me, "P").size() > 1)
                       say("An Nox");
                       start_script( ":spells:cure", healparms );
                       sleep(2);

Modified: trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/endParalysis.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/endParalysis.src	2005-11-01 04:06:14 UTC (rev 758)
+++ trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/endParalysis.src	2005-11-01 04:14:25 UTC (rev 759)
@@ -1,9 +1,6 @@
 use uo;
 use os;
 
-include "include/attributes";
-include ":poisonwatcher:poisons";
-
 program poisonScript(params)
 	var who := params[1];
 	

Modified: trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/paralysis.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/paralysis.src	2005-11-01 04:06:14 UTC (rev 758)
+++ trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/paralysis.src	2005-11-01 04:14:25 UTC (rev 759)
@@ -1,9 +1,6 @@
 use uo;
 use os;
 
-include "include/attributes";
-include ":poisonwatcher:poisons";
-
 program poisonScript(params)
 	var who := params[1];
 	



From austin at berlios.de  Tue Nov  1 05:26:35 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 05:26:35 +0100
Subject: [Poldistro-svn] r760 - in trunk/096/pkg/skills: alchemy detecthidden fishing healing magery meditation tinkering veterinary
Message-ID: <200511010426.jA14QZEV014997@sheep.berlios.de>

Author: austin
Date: 2005-11-01 05:26:31 +0100 (Tue, 01 Nov 2005)
New Revision: 760

Modified:
   trunk/096/pkg/skills/alchemy/drinkPotion.inc
   trunk/096/pkg/skills/detecthidden/detectHidden.src
   trunk/096/pkg/skills/fishing/magicFish.src
   trunk/096/pkg/skills/healing/healing.src
   trunk/096/pkg/skills/magery/archCure.src
   trunk/096/pkg/skills/magery/cure.src
   trunk/096/pkg/skills/magery/poisonDamage.src
   trunk/096/pkg/skills/meditation/meditation.src
   trunk/096/pkg/skills/tinkering/tinkerTraps.src
   trunk/096/pkg/skills/veterinary/vet.src
Log:
Updated scripts to use the new timedScripts package rather than poison watcher.
Some also just got the include line removed.. because they used no functions from it.

Modified: trunk/096/pkg/skills/alchemy/drinkPotion.inc
===================================================================
--- trunk/096/pkg/skills/alchemy/drinkPotion.inc	2005-11-01 04:14:25 UTC (rev 759)
+++ trunk/096/pkg/skills/alchemy/drinkPotion.inc	2005-11-01 04:26:31 UTC (rev 760)
@@ -1,5 +1,5 @@
 include "include/attributes";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
 use cfgfile;
 
 const POISON_SOUND := 0x247;
@@ -66,6 +66,6 @@
   if(who.cmdlevel > 1)
     return;
   endif
-  AddPoison(who, "defaultPoison", 120, who, level);
+  TS_StartTimer(who, "defaultPoison", 120, level, who);
 endfunction
 

Modified: trunk/096/pkg/skills/detecthidden/detectHidden.src
===================================================================
--- trunk/096/pkg/skills/detecthidden/detectHidden.src	2005-11-01 04:14:25 UTC (rev 759)
+++ trunk/096/pkg/skills/detecthidden/detectHidden.src	2005-11-01 04:26:31 UTC (rev 760)
@@ -21,7 +21,6 @@
 include ":attributes:skillCheck";
 include "include/sound";
 include "include/tileEffects";
-include ":poisonwatcher:poisons";
 
 CONST TRAP := "hiddentrap";
 CONST CRITICAL_FAILURE := 1;

Modified: trunk/096/pkg/skills/fishing/magicFish.src
===================================================================
--- trunk/096/pkg/skills/fishing/magicFish.src	2005-11-01 04:14:25 UTC (rev 759)
+++ trunk/096/pkg/skills/fishing/magicFish.src	2005-11-01 04:26:31 UTC (rev 760)
@@ -9,7 +9,8 @@
 
 include "include/statMod";
 include "include/canAccess";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
+include ":timedscripts:poisonUtil";
 
 program use_MagicFish(who, fish)
 
@@ -49,8 +50,8 @@
 				10: if (CanMod(who, "int"))
 					DoTempMod(who, "int", miscprop1, miscprop2);
 				    endif
-				11:  if (ListPoisonsByType(who, "defaultPoison").size() > 0 )
-					CurePoison(who, 120, "defaultPoison",CInt(miscprop1));
+				11:  if (TS_GetTimerNames(who, "P").size() > 0 )
+					TS_CurePoison(who, 120, "P", CInt(miscprop1));
 				     endif
 				16: if (CanMod(who, "str"))
 					DoTempMod(who, "str", miscprop1, miscprop2);

Modified: trunk/096/pkg/skills/healing/healing.src
===================================================================
--- trunk/096/pkg/skills/healing/healing.src	2005-11-01 04:14:25 UTC (rev 759)
+++ trunk/096/pkg/skills/healing/healing.src	2005-11-01 04:26:31 UTC (rev 760)
@@ -9,7 +9,8 @@
 include "include/resurrection";
 include "include/canAccess";
 include "include/attributes";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
+include ":timedscripts:poisonUtil";
 
 var clock := ReadGameClock();
 var healing;
@@ -28,7 +29,7 @@
 		SendSysMessage(who, "Cancelled.");
 		return;
 	endif
-	var poisons := ListPoisonsByType(patient, "defaultPoisons");
+	var poisons := TS_GetTimerNames(patient, "P");
 	if(dist(who, patient) >= 2)
 		SendSysMessage(who, "Your patient is too far away.");
 		return;
@@ -199,7 +200,7 @@
 			  resurrect_pc(who, patient, counter);
 			endif
 			return;
-		elseif(ListPoisonsByType(patient, "defaultPoison").size() > 0)
+		elseif(TS_GetTimerNames(patient, "P").size() > 0)
 		// can't heal a patient who is poisoned.
 			if((healing < 60) or (anatomy < 60))
 				SendSysMessage(who, "You have no chance of curing your patient's poison.");
@@ -288,7 +289,7 @@
 			SendSysMessage(patient, who.name + " starts to resurrect you.");
 			resurrect_pc(who, patient, counter);
 			break;
-		elseif(ListPoisonsByType(patient, "defaultPoison").size() == 0)
+		elseif(TS_GetTimerNames(patient, "P").size() == 0)
 			SendSysMessage(who,"You start to heal " + patient.name + ".");
 			if(patient != who)
 				SendSysMessage(patient, who.name + " starts to heal you.");
@@ -307,8 +308,8 @@
 		endif
 		if(counter >= cycles)
 			if(CheckSkill(who, SKILLID_HEALING, 48, 0))
-				CurePoison(patient, 120, "defaultPoison", healamt);
-	if (ListPoisonsByType(patient, "defaultPoison").size() == 0)
+				TS_CurePoison(patient, 120, "P", healamt);
+	if (TS_GetTimerNames(patient, "P").size() == 0)
 					SendSysMessage(who,"You have cured your patient completely.");
 					SendSysMessage(patient, who.name + " has cured you completely.");
 					AwardPoints(who, SKILLID_HEALING, (healamt * 100));

Modified: trunk/096/pkg/skills/magery/archCure.src
===================================================================
--- trunk/096/pkg/skills/magery/archCure.src	2005-11-01 04:14:25 UTC (rev 759)
+++ trunk/096/pkg/skills/magery/archCure.src	2005-11-01 04:26:31 UTC (rev 760)
@@ -5,7 +5,8 @@
 include "include/sound";
 include "include/tileEffects";
 include "include/attributes";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
+include ":timedscripts:poisonUtil";
 
 program archCure(parms)
   var caster := parms.caster;
@@ -32,9 +33,9 @@
           ApplyRawDamage(castOn, potency);
         endif
       endif
-      if (ListPoisonsByType(castOn, "defaultPoison").size() > 0)
-        CurePoison(castOn, 180, "defaultPoison", potency);
-        if (ListPoisonsByType(castOn, "defaultPoison").size() > 0)
+      if (TS_GetTimerNames(castOn, "P").size() > 0)
+        TS_CurePoison(castOn, 180, "P", potency);
+        if (TS_GetTimerNames(castOn, "P").size() > 0)
           SendSysMessage(caster, "You cure some poison.");  
           SendSysMessage(castOn, caster.name + " has partially cured you!");
         else

Modified: trunk/096/pkg/skills/magery/cure.src
===================================================================
--- trunk/096/pkg/skills/magery/cure.src	2005-11-01 04:14:25 UTC (rev 759)
+++ trunk/096/pkg/skills/magery/cure.src	2005-11-01 04:26:31 UTC (rev 760)
@@ -5,7 +5,8 @@
 include "include/attributes";
 include "include/sound";
 include "include/tileEffects";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
+include ":timedscripts:poisonUtil";
 
 
 program cure( parms )
@@ -30,9 +31,9 @@
       ApplyRawDamage(castOn, potency);
     endif
   endif
-  if (ListPoisonsByType(castOn, "defaultPoison").size() > 0)
-    CurePoison(castOn, 120, "defaultPoison", potency);
-    if (ListPoisonsByType(castOn, "defaultPoison").size() > 0)
+  if (TS_GetTimerNames(castOn, "P").size() > 0)
+    TS_CurePoison(castOn, 120, "P", potency);
+    if (TS_GetTimerNames(castOn, "P").size() > 0)
       SendSysMessage(caster, "You cure some poison.");  
       SendSysMessage(castOn, caster.name + " has partially cured you!");
     else

Modified: trunk/096/pkg/skills/magery/poisonDamage.src
===================================================================
--- trunk/096/pkg/skills/magery/poisonDamage.src	2005-11-01 04:14:25 UTC (rev 759)
+++ trunk/096/pkg/skills/magery/poisonDamage.src	2005-11-01 04:26:31 UTC (rev 760)
@@ -4,7 +4,7 @@
 
 include "include/client";
 include "include/attributes";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
 include "include/spellRestrictions";
 
 
@@ -23,7 +23,7 @@
 	elseif (who.cmdlevel > 1)
 		return;
 	endif
-	AddPoison(who, "defaultPoison", 120, attacker, level);
+	TS_StartTimer(who, "defaultPoison", 120, level, attacker);
 	if (pfield == 1)
 		PrintTextAbovePrivate(who, "You choke on the noxious fumes!", who);
 		var dmg := Resisted(5, attacker, who, CInt(GetAttribute(attacker, "magery") / 25));

Modified: trunk/096/pkg/skills/meditation/meditation.src
===================================================================
--- trunk/096/pkg/skills/meditation/meditation.src	2005-11-01 04:14:25 UTC (rev 759)
+++ trunk/096/pkg/skills/meditation/meditation.src	2005-11-01 04:26:31 UTC (rev 760)
@@ -6,7 +6,7 @@
 
 include "include/client";
 include "include/attributes";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
 
 program meditation( who )
   EraseObjProperty(who, "HealTimer");
@@ -18,7 +18,7 @@
    Detach();
    return;
   endif
-  if (ListPoisonsByType(who, "defaultPoison").size() > 0)
+  if (TS_GetTimerNames(who, "P").size() > 0)
     SendSysMessage( who, "You cannot meditate while poisoned." );
    Detach();
     return;
@@ -55,7 +55,7 @@
         SendSysMessage(who,"Regenerative forces cannot penetrate your armor.");
         EraseObjProperty(who, "IsMeditating");
         break;
-      elseif(ListPoisonsByType(who, "defaultPoison").size() > 0)
+      elseif(TS_GetTimerNames(who, "P").size() > 0)
         EraseObjProperty(who, "IsMeditating");
       break;
       elseif(GetMana(who) >= GetMaxMana(who))

Modified: trunk/096/pkg/skills/tinkering/tinkerTraps.src
===================================================================
--- trunk/096/pkg/skills/tinkering/tinkerTraps.src	2005-11-01 04:14:25 UTC (rev 759)
+++ trunk/096/pkg/skills/tinkering/tinkerTraps.src	2005-11-01 04:26:31 UTC (rev 760)
@@ -6,7 +6,6 @@
 include "include/sound";
 include "include/tileEffects";
 include "include/client";
-include ":poisonwatcher:poisons";
 include "include/canAccess";
 
 

Modified: trunk/096/pkg/skills/veterinary/vet.src
===================================================================
--- trunk/096/pkg/skills/veterinary/vet.src	2005-11-01 04:14:25 UTC (rev 759)
+++ trunk/096/pkg/skills/veterinary/vet.src	2005-11-01 04:26:31 UTC (rev 760)
@@ -6,7 +6,8 @@
 include "include/client";
 include "include/attributes";
 include "include/dist";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
+include ":timedscripts:poisonUtil";
 
 var config;
 var elem;
@@ -25,13 +26,13 @@
   elseif(!CheckLineOfSight(who,patient))
 	SendSysMessage(who,"You can't see your patient.");
 	return;
-  elseif((GetHp(patient) >= GetStrength(patient)) && (ListPoisonsByType(patient, "defaultPoison").size() == 0))
+  elseif((GetHp(patient) >= GetStrength(patient)) && (TS_GetTimerNames(patient, "P").size() == 0))
 	SendSysMessage(who,"Your patient is at full health!");
 	return;
   endif
   Detach();
   SetObjProperty(who, "HealTimer", clock);
-  if(ListPoisonsByType(patient, "defaultPoison").size() > 0)
+  if(TS_GetTimerNames(patient, "P").size() > 0)
     if(!CheckLineOfSight(who,patient))
       SendSysMessage(who,"You can't see your patient.");
       return;
@@ -103,7 +104,7 @@
         healamt := (healamt / 2);
       endif
     endif
-    if(ListPoisonsByType(patient,"defaultPoison").size() > 0)
+    if(TS_GetTimerNames(patient,"P").size() > 0)
       cure(who, patient);
       break;
     endif
@@ -182,8 +183,8 @@
     if(counter >= cycles)
       if(CheckSkill(who, SKILLID_VETERINARY, 80, 0) && (CInt(GetEffectiveSkill(who, SKILLID_ANATOMY)) >= 61))
         if((RandomInt(100) + 1) < healamt);
-          CurePoison(patient,(healamt/40),"defaultPoison");
-          if (ListPoisonsByType(patient, "defaultPoison").size() > 0)
+         TS_CurePoison(patient,(healamt/40),"P");
+          if (TS_GetTimerNames(patient, "P").size() > 0)
             SendSysMessage(who, "You have partially cured your patient.");
           else
             SendSysMessage(who, "You have cured your patient completely.");



From austin at berlios.de  Tue Nov  1 05:29:52 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 05:29:52 +0100
Subject: [Poldistro-svn] r761 - trunk/096/scripts/control
Message-ID: <200511010429.jA14Tqc7015513@sheep.berlios.de>

Author: austin
Date: 2005-11-01 05:29:49 +0100 (Tue, 01 Nov 2005)
New Revision: 761

Removed:
   trunk/096/scripts/control/paraControl.src
   trunk/096/scripts/control/poisonControl.src
Log:
Scripts no longer used.

Deleted: trunk/096/scripts/control/paraControl.src
===================================================================
--- trunk/096/scripts/control/paraControl.src	2005-11-01 04:26:31 UTC (rev 760)
+++ trunk/096/scripts/control/paraControl.src	2005-11-01 04:29:49 UTC (rev 761)
@@ -1,50 +0,0 @@
-use uo;
-use os;
-
-include "include/sound";
-include "include/tileEffects";
-include "include/attributes";
-include "include/objtype";
-include "include/spellAttack";
-
-
-program paraControl(field)
-  var creater := GetObjProperty(field, "creater");
-  var online := EnumerateOnlineCharacters();
-  var boss;
-  foreach char in online
-    if(creater == char.serial)
-      boss := char;
-      break;
-    endif
-  endforeach
-  if(!boss)
-    boss := SystemFindObjectBySerial(creater, SYSFIND_SEARCH_OFFLINE_MOBILES);
-  endif
-  SetScriptController(boss);
-  var parms := {};
-  while(field)
-    foreach cast_on in ListMobilesNearLocation(field.x, field.y, field.z, 0, field.realm)
-      if((GetHp(cast_on) > 1) && (cast_on.cmdlevel < 2))
-        SetScriptController(boss);
-        send_attack(cast_on, boss, 46);
-        ApplyRawDamage(cast_on, 1);
-        HealDamage(cast_on, 1);
-        send_attack(cast_on, boss, 46);
-        if(!GetObjProperty(cast_on,"#pfield"))
-          if(CheckSkill(cast_on, SKILLID_MAGICRESISTANCE, 40, 40))
-            PrintTextAbovePrivate(cast_on, "You resist the spell!", cast_on);
-	        PlaySoundEffect(cast_on, SFX_SPELL_WEAKEN);
-	        PlayObjectCenteredEffect( cast_on, FX_CURSE_EFFECT, 5,5);
-          else
-            parms[1] := cast_on;
-            parms[2] := boss;
-            Detach();
-            start_script(":spells:pField", parms);
-          endif
-        endif
-      endif
-    endforeach
-    sleepms(500);
-  endwhile
-endprogram

Deleted: trunk/096/scripts/control/poisonControl.src
===================================================================
--- trunk/096/scripts/control/poisonControl.src	2005-11-01 04:26:31 UTC (rev 760)
+++ trunk/096/scripts/control/poisonControl.src	2005-11-01 04:29:49 UTC (rev 761)
@@ -1,45 +0,0 @@
-use uo;
-use util;
-use os;
-use cfgfile;
-
-include "include/attributes";
-include "include/spellRestrictions";
-include "include/spellAttack";
-include ":poisonwatcher:poisons";
-
-program field_control(item)
-
-  sleep(1);
-  var pcnpccfg := ReadConfigFile("::npcdesc");
-  var boss := SystemFindObjectBySerial(GetObjProperty(item, "creater"), SYSFIND_SEARCH_OFFLINE_MOBILES);
-  SetScriptController(boss);
-  var dmg := CInt(GetEffectiveSkill(boss, SKILLID_MAGERY) / 25);
-  if(!dmg)
-    dmg := 1;
-  endif
-  while(item)
-    foreach character in ListMobilesNearLocationEX(item.x, item.y, item.z, 0, LISTEX_FLAG_NORMAL + LISTEX_FLAG_HIDDEN, item.realm)
-    if((!character.dead) and (!character.cmdlevel))
-        PlaySoundEffect(character, 0x206);
-        if(character.isA(POLCLASS_NPC))
-          if((pcnpccfg[character.npctemplate].elemental) == "poison")
-            HealDamage(character, (dmg * 10));
-          else
-            send_attack(character, boss, 46);
-            ApplyRawDamage(character, 1);
-            HealDamage(character, 1);
-            var passparms := {character, boss, "poisoned weapon", dmg, 1};
-            start_script(":spells:poisonDamage", passparms);
-          endif
-        else
-          ApplyRawDamage(character, 1);
-          HealDamage(character, 1);
-          var passparms := {character, boss, "poison field", dmg, 1};
-          start_script(":spells:poisonDamage", passparms);
-        endif
-    endif
-    endforeach
-    sleepms(1500);
-  endwhile
-endprogram



From austin at berlios.de  Tue Nov  1 05:30:51 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 05:30:51 +0100
Subject: [Poldistro-svn] r762 - trunk/096/scripts/items
Message-ID: <200511010430.jA14UpYl015612@sheep.berlios.de>

Author: austin
Date: 2005-11-01 05:30:50 +0100 (Tue, 01 Nov 2005)
New Revision: 762

Removed:
   trunk/096/scripts/items/poisonField.src
   trunk/096/scripts/items/walkOnParaField.src
Log:
Scripts no longer needed.

Deleted: trunk/096/scripts/items/poisonField.src
===================================================================
--- trunk/096/scripts/items/poisonField.src	2005-11-01 04:29:49 UTC (rev 761)
+++ trunk/096/scripts/items/poisonField.src	2005-11-01 04:30:50 UTC (rev 762)
@@ -1,45 +0,0 @@
-use uo;
-use util;
-use os;
-use cfgfile;
-
-include "include/attributes";
-include "include/spellRestrictions";
-include "include/spellAttack";
-include ":poisonwatcher:poisons";
-
-program mpoisonfield(character, item)
-
-  if(character.dead)
-    return;
-  elseif(character.cmdlevel)
-    return;
-  endif
-  var pfnpccfg := ReadConfigFile("::npcdesc");
-  var boss := SystemFindObjectBySerial(GetObjProperty(item, "creater"), SYSFIND_SEARCH_OFFLINE_MOBILES);
-  SetScriptController(boss);
-  var dmg := CInt(GetAttribute(boss, "magery") / 25);
-  if(!dmg)
-    dmg := 1;
-  endif
-  PlaySoundEffect(character, 0x206);
-  if(character.isA(POLCLASS_NPC))
-    if((pfnpccfg[character.npctemplate].elemental) == "poison")
-      HealDamage(character, (dmg * 10));
-    else
-      send_attack(character, boss, 46);
-      ApplyRawDamage(character, 1);
-      HealDamage(character, 1);
-      PlaySoundEffect(character, 0x206);
-      var passparms := {character, boss, "poisoned weapon", dmg, 1};
-      start_script(":spells:poisonDamage", passparms);
-    endif
-  elseif(!character.dead)
-    ApplyRawDamage(character, 1);
-    HealDamage(character, 1);
-    PlaySoundEffect(character, 0x206);
-    var passparms := {character, boss, "poison field", dmg, 1};
-    start_script(":spells:poisonDamage", passparms);
-  endif
-
-endprogram

Deleted: trunk/096/scripts/items/walkOnParaField.src
===================================================================
--- trunk/096/scripts/items/walkOnParaField.src	2005-11-01 04:29:49 UTC (rev 761)
+++ trunk/096/scripts/items/walkOnParaField.src	2005-11-01 04:30:50 UTC (rev 762)
@@ -1,49 +0,0 @@
-use uo;
-use os;
-
-include "include/sound";
-include "include/tileEffects";
-include "include/attributes";
-include "include/objtype";
-include "include/spellAttack";
-
-
-program walkon_parafield(cast_on, field)
-	if ((GetHp(cast_on) < 1) || (cast_on.cmdlevel > 2))
-		return;
-	endif
-	var creater := GetObjProperty(field, "creater");
-	var online := EnumerateOnlineCharacters();
-	var boss;
-	foreach char in online
-		if (creater == char.serial)
-			boss := char;
-			break;
-		endif
-	endforeach
-	if (!boss)
-		boss := SystemFindObjectBySerial(creater, SYSFIND_SEARCH_OFFLINE_MOBILES);
-	endif
-	SetScriptController(boss);
-	if (!cast_on.dead)
-		SetScriptController(boss);
-		send_attack(cast_on, boss, 46);
-		ApplyRawDamage(cast_on, 1);
-		HealDamage(cast_on, 1);
-		if (!GetObjProperty(cast_on,"#pfield"))
-			if (CheckSkill(cast_on, SKILLID_MAGICRESISTANCE, 40, 40))
-				PrintTextAbovePrivate(cast_on, "You resist the spell!", cast_on);
-				PlaySoundEffect(cast_on, SFX_SPELL_WEAKEN);
-				PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 5,5);
-			else
-				var parms := {};
-				parms[1] := cast_on;
-				parms[2] := boss;
-				Detach();
-				start_script(":spells:pField", parms);
-			endif
-		endif
-	endif
-
-	return;
-endprogram



From austin at berlios.de  Tue Nov  1 05:35:48 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 05:35:48 +0100
Subject: [Poldistro-svn] r763 - trunk/096/pkg/skills/alchemy
Message-ID: <200511010435.jA14ZmMw016745@sheep.berlios.de>

Author: austin
Date: 2005-11-01 05:35:47 +0100 (Tue, 01 Nov 2005)
New Revision: 763

Modified:
   trunk/096/pkg/skills/alchemy/orangePotion.src
Log:
Orange potion updated to cure with the new timedScripts package.

Modified: trunk/096/pkg/skills/alchemy/orangePotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/orangePotion.src	2005-11-01 04:30:50 UTC (rev 762)
+++ trunk/096/pkg/skills/alchemy/orangePotion.src	2005-11-01 04:35:47 UTC (rev 763)
@@ -4,7 +4,8 @@
 use cfgfile;
 include "drinkPotion";
 include "include/canAccess";
-include ":poisonwatcher:poisons";
+include ":timedscripts:timedScripts";
+include ":timedscripts:poisonUtil";
 
 program orangePotion (who, potion)
   EraseObjProperty(who, "IsMeditating");
@@ -26,9 +27,9 @@
     0xdc16: potion_strength := 3;
   endcase
   empty_bottle(who, potion);
-  if( ListPoisonsByType(who, "DefaultPoison").size() > 0 )
+  if( TS_GetTimerNames(who, "P").size() > 0 )
     PlaySoundEffect(who, SOUND_EFFECT_CURE);
     PlayObjectCenteredEffect(who, EFFECT_SPARKLE, 10,10);
-    CurePoison(who, 120, "defaultPoison", potion_strength);
+    TS_CurePoison(who, 120, "P", potion_strength);
   endif
 endprogram
\ No newline at end of file



From austin at berlios.de  Tue Nov  1 05:40:14 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 05:40:14 +0100
Subject: [Poldistro-svn] r764 - trunk/096/pkg/items/containers
Message-ID: <200511010440.jA14eEDB017294@sheep.berlios.de>

Author: austin
Date: 2005-11-01 05:40:11 +0100 (Tue, 01 Nov 2005)
New Revision: 764

Modified:
   trunk/096/pkg/items/containers/itemdesc.cfg
Log:
Fixed issue with 0xE77 barrel having a graphic that made it not work properly.
Renamed 0xE77 to openbarrel since it is a barrel with no lid.

Modified: trunk/096/pkg/items/containers/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/containers/itemdesc.cfg	2005-11-01 04:35:47 UTC (rev 763)
+++ trunk/096/pkg/items/containers/itemdesc.cfg	2005-11-01 04:40:11 UTC (rev 764)
@@ -544,10 +544,9 @@
 
 Container 0xE77
 {
-	Name			barrel
+	Name			openbarrel
 	Desc			barrel
-	Graphic			3707
-
+	
 	Gump			0x3E
 
 	MinX			44
@@ -569,7 +568,7 @@
 
 Container 0xFAE
 {
-	Name			Barrel
+	Name			barrel
 	Desc			barrel
 	Graphic			4014
 



From austin at berlios.de  Tue Nov  1 05:45:28 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 05:45:28 +0100
Subject: [Poldistro-svn] r765 - trunk/096/pkg/mobiles/timedScripts/config
Message-ID: <200511010445.jA14jSY4018461@sheep.berlios.de>

Author: austin
Date: 2005-11-01 05:45:24 +0100 (Tue, 01 Nov 2005)
New Revision: 765

Modified:
   trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg
Log:
Added in cfg elem for alcohol.
Today ends with "Y"! Hooray

Modified: trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg	2005-11-01 04:40:11 UTC (rev 764)
+++ trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg	2005-11-01 04:45:24 UTC (rev 765)
@@ -85,8 +85,7 @@
 {
 	Name			Paralysis
 	Script			subScripts/paralysis/paralysis
-	CureScript		subScripts/paralysis/endParalysis
-	IndicatePoison		0
+	EndScript		subScripts/paralysis/endParalysis
 	EndMessage		You are able to move again.
 	Type			C
 	NoCure			1
@@ -105,3 +104,15 @@
 	EndMessage		The horrid stench of poo fades away.
 	MaxDuration		300	// 5 minutes
 }
+
+#--=[ Consumables ]=------------------------------
+
+TimerElem alcohol
+{
+	Name			Alcohol
+	Script			subScripts/food/alcohol
+	NoCure			1
+	Cumulative		1
+	EndMessage		You feel sober again.
+	MaxDuration		300	//  minutes
+}



From austin at berlios.de  Tue Nov  1 06:52:11 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 06:52:11 +0100
Subject: [Poldistro-svn] r766 - in trunk/096/pkg/mobiles/timedScripts: . commands/gm config include
Message-ID: <200511010552.jA15qBDs011731@sheep.berlios.de>

Author: austin
Date: 2005-11-01 06:51:58 +0100 (Tue, 01 Nov 2005)
New Revision: 766

Added:
   trunk/096/pkg/mobiles/timedScripts/commands/gm/curePoisons.src
Modified:
   trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg
   trunk/096/pkg/mobiles/timedScripts/include/poisonUtil.inc
   trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc
   trunk/096/pkg/mobiles/timedScripts/timerControl.src
Log:
poisonUtil.inc works now.
Fixed some bugs in timedScripts.inc
Removed debug messages from timerControl.src

Added: trunk/096/pkg/mobiles/timedScripts/commands/gm/curePoisons.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/commands/gm/curePoisons.src	2005-11-01 04:45:24 UTC (rev 765)
+++ trunk/096/pkg/mobiles/timedScripts/commands/gm/curePoisons.src	2005-11-01 05:51:58 UTC (rev 766)
@@ -0,0 +1,34 @@
+/*
+ * $Id$
+ *
+ */
+use uo;
+
+include ":timedscripts:timedScripts";
+include ":timedscripts:poisonUtil";
+
+
+program textcmd_LowerTimer(who, text)
+	text := SplitWords(text);
+	
+	var amount	:= CInt(text[1]);
+	var type	:= CStr(text[2]);
+	var level	:= CInt(text[3]);
+	
+	if ( !amount || !type || !level )
+		SendSysMessage(who, "Syntax: .curePoisons <amount> <type> <level>");
+		return 0;
+	endif
+
+	SendSysMessage(who, "Select a mobile to cure poisons on.");
+	var targ := target(who);
+	
+	if ( !targ.IsA(POLCLASS_MOBILE) )
+		SendSysMessage(who, "Cancelled.");
+		return 0;
+	endif
+	
+	var num_cured := TS_CurePoison(targ, amount, type, level);
+	SendSysMessage(who, "Done. Number of poisons cured ->"+num_cured);
+	return 1;
+endprogram
\ No newline at end of file

Modified: trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg	2005-11-01 04:45:24 UTC (rev 765)
+++ trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg	2005-11-01 05:51:58 UTC (rev 766)
@@ -45,7 +45,7 @@
 #                   If the timer (e.g. poison) has levels, lower durations will add a fraction
 #                   of their duration to the higher level.
 #
-#	AllorNothingCure: 0 - Default. 
+#	AllOrNothingCure: 0 - Default. 
 #		0 - Means a cure reduces the timers's duration at least a little.
 #		1 - Means a cure either works or it doesn't. (e.g. must be >= duration)
 #
@@ -73,7 +73,7 @@
 	IndicatePoison		1
 	EndMessage		You have been cured of poison.
 	Cumulative		0
-	AllorNothingCure	1
+	AllOrNothingCure	1
 	MaxDuration		120	// 2 minutes
 	
 	Type			P

Modified: trunk/096/pkg/mobiles/timedScripts/include/poisonUtil.inc
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/include/poisonUtil.inc	2005-11-01 04:45:24 UTC (rev 765)
+++ trunk/096/pkg/mobiles/timedScripts/include/poisonUtil.inc	2005-11-01 05:51:58 UTC (rev 766)
@@ -31,11 +31,15 @@
  *
  */
 function TS_CurePoison(mobile, cure_amount, cure_type:="", cure_level:=1)
+	cure_amount := CInt(cure_amount);
+	cure_level := CInt(cure_level);
+	
 	var poison_names := TS_GetTimerNames(mobile, cure_type);
 	
 	var num_cured := 0;
 	//Run through all curable poisons, and keep curing until it runs out of curing power.
 	foreach timer_name in ( poison_names )
+		SendSysMessage(mobile, "Found poison "+timer_name);
 		var elem_info := TS_GetCfgElem(timer_name);
 
 		if ( elem_info.NoCure ) // Incurable
@@ -46,16 +50,17 @@
 		cure_amount := CInt(cure_amount / CInt(elem_info.Virulence));
 		
 		if ( elem_info.AllOrNothingCure )
-			if ( (cure_level - 2) < timer_info.level )
+			if ( (timer_info.level - 2) > cure_level )
 				// If cure level is less than two levels lower than the poison 
 				// level, there is no chance to cure.
 				continue; 
 			endif
 			
 			var chance := CInt(timer_info.level / (cure_level * 0.01)); // cure_level % of timer_level.
-			if ( RandomInt(100)+1 <= chance )
+			var roll := RandomInt(100)+1;
+			if ( roll <= chance )
 				cure_amount := cure_amount - duration;
-				TS_LowerDuration(, timer_name, -1);
+				TS_LowerDuration(mobile, timer_name, -1);
 				num_cured := num_cured+1;
 			endif
 		else

Modified: trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc	2005-11-01 04:45:24 UTC (rev 765)
+++ trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc	2005-11-01 05:51:58 UTC (rev 766)
@@ -185,13 +185,15 @@
 		if ( type )
 			var elem_info := TS_GetCfgElem(timer_name);
 			if ( Lower(elem_info.Type) == type )
-				name_list.Append(type);
+				name_list.Append(timer_name);
 			endif
 		else
-			name_list.Append(type);
+			name_list.Append(timer_name);
 		endif
 		sleepms(2);
 	endforeach
+	
+	return name_list;
 endfunction
 
 /*

Modified: trunk/096/pkg/mobiles/timedScripts/timerControl.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/timerControl.src	2005-11-01 04:45:24 UTC (rev 765)
+++ trunk/096/pkg/mobiles/timedScripts/timerControl.src	2005-11-01 05:51:58 UTC (rev 766)
@@ -32,16 +32,12 @@
 		endif
 				
 		if( event.type == EVENT_ADD_TIMER )
-			SendSysMessage(mobile, "** ADD TIMER **");
 			AddTimer(mobile, event, timer_list, num_poisons);
 		elseif( event.type == EVENT_LOWER_TIMER )
-			SendSysMessage(mobile, "** LOWER TIMER **");
 			LowerDuration(mobile, event, timer_list, num_poisons);
 		elseif( event.type == EVENT_DEAD )
-			SendSysMessage(mobile, "** DEAD **");
 			Death(mobile, timer_list, num_poisons);
 		elseif ( event.type == EVENT_LOGOFF )
-			SendSysMessage(mobile, "** LOG OFF **");
 			LogOff(mobile, timer_list);
 			break;
 		endif



From austin at berlios.de  Tue Nov  1 07:16:46 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 07:16:46 +0100
Subject: [Poldistro-svn] r767 - trunk/096/pkg/other
Message-ID: <200511010616.jA16Gkhm021112@sheep.berlios.de>

Author: austin
Date: 2005-11-01 07:16:44 +0100 (Tue, 01 Nov 2005)
New Revision: 767

Removed:
   trunk/096/pkg/other/hooks/
Log:
Hooks package no longer needed. The king is dead.. long live the king.

Attributes system package replaces all of this stuff.



From austin at berlios.de  Tue Nov  1 07:42:05 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 07:42:05 +0100
Subject: [Poldistro-svn] r768 - in trunk/096/pkg/systems/attributes: . config
Message-ID: <200511010642.jA16g5bY031081@sheep.berlios.de>

Author: austin
Date: 2005-11-01 07:42:01 +0100 (Tue, 01 Nov 2005)
New Revision: 768

Added:
   trunk/096/pkg/systems/attributes/config/titles.cfg
Modified:
   trunk/096/pkg/systems/attributes/attributes.cfg
   trunk/096/pkg/systems/attributes/skills.cfg
Log:
Updated attributes.cfg to support skill titles.
Updated skills.cfg by removing unnecessary data.
Added titles.cfg for skill % titles.

Modified: trunk/096/pkg/systems/attributes/attributes.cfg
===================================================================
--- trunk/096/pkg/systems/attributes/attributes.cfg	2005-11-01 06:16:44 UTC (rev 767)
+++ trunk/096/pkg/systems/attributes/attributes.cfg	2005-11-01 06:42:01 UTC (rev 768)
@@ -50,6 +50,7 @@
 {
 	AttributeType	Skill
 	SkillId		0
+	Title		Alchemist
 	
 	StatCheck	Dexterity	100	1d1+20
 	StatCheck	Intelligence	100	1d4+20
@@ -60,6 +61,7 @@
 	AttributeType	Skill
 	Script		:anatomy:anatomy
 	SkillId		1
+	Title		Healer
 	
 	StatCheck	Intelligence	100	1d2+10
 }
@@ -69,6 +71,7 @@
 	AttributeType	Skill
 	Script		:animallore:animalLore
 	SkillId		2
+	Title		Ranger
 	
 	StatCheck	Intelligence	100	1d4+20
 }
@@ -79,6 +82,7 @@
 	DisplayName	Item Identification
 	Script		:itemid:itemID
 	SkillId		3
+	Title		Merchant
 	
 	StatCheck	Intelligence	100	1d3+15
 }
@@ -88,6 +92,7 @@
 	AttributeType	Skill
 	Script		:armslore:armsLore
 	SkillId		4
+	Title		Warrior
 	
 	StatCheck	Intelligence	100	1d1+10
 	StatCheck	Strength	100	1d2+10
@@ -97,6 +102,7 @@
 {
 	AttributeType	Skill
 	SkillId		5
+	Title		Shieldfighter
 	
 	StatCheck	Strength	100	1d2+20
 }
@@ -106,6 +112,7 @@
 	AttributeType	Skill
 	Script		:begging:begging
 	SkillId		6
+	Title		Beggar
 	
 	StatCheck	Intelligence	100	1d1+20
 }
@@ -114,6 +121,7 @@
 {
 	AttributeType	Skill
 	SkillId		7
+	Title		Blacksmith
 	
 	StatCheck	Strength	100	1d4+20
 }
@@ -123,6 +131,7 @@
 	AttributeType	Skill
 	DisplayName	Bowcraft Fletching
 	SkillId		8
+	Title		Bowyer
 	
 	StatCheck	Dexterity	100	1d3+20
 	StatCheck	Strength	100	1d4+20
@@ -132,6 +141,7 @@
 {
 	AttributeType	Skill
 	SkillId		9
+	Title		Bard
 	
 	StatCheck	Intelligence	100	1d2
 }
@@ -140,6 +150,7 @@
 {
 	AttributeType	Skill
 	SkillId		10
+	Title		Ranger
 	
 	StatCheck	Intelligence	100	1d2+10
 	StatCheck	Strength	100	1d2+10
@@ -149,6 +160,7 @@
 {
 	AttributeType	Skill
 	SkillId		11
+	Title		Carpenter
 	
 	StatCheck	Strength	100	1d4+25
 }
@@ -158,6 +170,7 @@
 	AttributeType	Skill
 	Script		:cartography:cartography
 	SkillId		12
+	Title		Cartographer
 	
 	StatCheck	Intelligence	100	1d2+10
 }
@@ -166,6 +179,7 @@
 {
 	AttributeType	Skill
 	SkillId		13
+	Title		Chef
 	
 	StatCheck	Intelligence	100	1d2+10
 }
@@ -176,6 +190,7 @@
 	DisplayName	Detect Hidden
 	Script		:detecthidden:detectHidden
 	SkillId		14
+	Title		Scout
 	
 	StatCheck	Intelligence	100	1d4+20
 }
@@ -184,6 +199,7 @@
 {
 	AttributeType	Skill
 	SkillId		15
+	Title		Discordian?
 	
 	StatCheck	Intelligence	20	2d4
 }
@@ -194,6 +210,7 @@
 	Script		:evalint:evalInt
 	DisplayName	Evaluating Intelligence
 	SkillId		16
+	Title		Scholar
 	
 	StatCheck	Intelligence	100	1d4+20
 }
@@ -202,6 +219,7 @@
 {
 	AttributeType	Skill
 	SkillId		17
+	Title		Healer
 	
 	StatCheck	Dexterity	100	1d1+10
 }
@@ -210,6 +228,7 @@
 {
 	AttributeType	Skill
 	SkillId		18
+	Title		Fisherman
 	
 	StatCheck	Dexterity	100	1d4+20
 	StatCheck	Strength	100	1d4+20
@@ -221,6 +240,7 @@
 	Script		:forensicevaluation:forensic
 	DisplayName	Forensic Evaluation
 	SkillId		19
+	Title		Detective
 	
 	StatCheck	Intelligence	100	1d4+20
 }
@@ -229,6 +249,7 @@
 {
 	AttributeType	Skill
 	SkillId		20
+	Title		Shepherd
 	
 	StatCheck	Strength	100	1d4+20
 }
@@ -238,6 +259,7 @@
 	AttributeType	Skill
 	Script		:hiding:hiding
 	SkillId		21
+	Title		Rogue
 	
 	StatCheck	Dexterity	100	1d4+20
 }
@@ -246,6 +268,7 @@
 {
 	AttributeType	Skill
 	SkillId		22
+	Title		Bard
 	
 	StatCheck	Dexterity	100	1d2
 }
@@ -254,6 +277,7 @@
 {
 	AttributeType	Skill
 	SkillId		23
+	Title		Scribe
 	
 	StatCheck	Intelligence	100	1d4+20
 }
@@ -262,6 +286,7 @@
 {
 	AttributeType	Skill
 	SkillId		24
+	Title		Rogue
 	
 	StatCheck	Dexterity	100	1d3+10
 }
@@ -270,6 +295,7 @@
 {
 	AttributeType	Skill
 	SkillId		25
+	Title		Mage
 	
 	StatCheck	Intelligence	100	1d4+20
 }
@@ -278,12 +304,16 @@
 {
 	AttributeType	Skill
 	DisplayName	Resisting Spells
+	Title		Mage
+	
 	SkillId		26
 }
 
 Attribute Tactics
 {
 	AttributeType	Skill
+	Title		Warrior
+	
 	SkillId		27
 }
 
@@ -291,6 +321,7 @@
 {
 	AttributeType	Skill
 	SkillId		28
+	Title		Rogue
 	
 	StatCheck	Dexterity	80	4d6+10
 }
@@ -299,6 +330,7 @@
 {
 	AttributeType	Skill
 	SkillId		29
+	Title		Bard
 	
 	StatCheck	Dexterity	100	1d4+20
 	StatCheck	Intelligence	100	1d2+10
@@ -308,6 +340,7 @@
 {
 	AttributeType	Skill
 	SkillId		30
+	Title		Assassin
 	
 	StatCheck	Dexterity	100	1d4+20
 	StatCheck	Intelligence	100	1d2+10
@@ -317,6 +350,7 @@
 {
 	AttributeType	Skill
 	SkillId		31
+	Title		Archer
 	
 	StatCheck	Dexterity	100	1d4+20
 	StatCheck	Strength	100	1d2+10
@@ -328,6 +362,7 @@
 	DisplayName	Spirit Speak
 	Script		:spiritspeak:spiritSpeak
 	SkillId		32
+	Title		Medium
 	
 	StatCheck	Intelligence	100	1d4+20
 }
@@ -336,6 +371,7 @@
 {
 	AttributeType	Skill
 	SkillId		33
+	Title		Thief
 	
 	StatCheck	Dexterity	90	3d4+9
 }
@@ -344,6 +380,7 @@
 {
 	AttributeType	Skill
 	SkillId		34
+	Title		Tailor
 	
 	StatCheck	Dexterity	100	1d1+10
 }
@@ -354,6 +391,7 @@
 	DisplayName	Animal Taming
 	Script		:taming:taming
 	SkillId		35
+	Title		Tamer
 	
 	StatCheck	Intelligence	100	1d3+10
 	StatCheck	Strength	100	1d4+20
@@ -364,6 +402,7 @@
 	AttributeType	Skill
 	DisplayName	Taste Identification
 	SkillId		36
+	Title		Chef
 	
 	StatCheck	Intelligence	100	1d4+20
 }
@@ -372,6 +411,7 @@
 {
 	AttributeType	Skill
 	SkillId		37
+	Title		Tinker
 	
 	StatCheck	Intelligence	100	1d4+20
 	StatCheck	Strength	100	1d4+20
@@ -381,6 +421,7 @@
 {
 	AttributeType	Skill
 	SkillId		38
+	Title		Ranger
 	
 	StatCheck	Dexterity	100	1d2+10
 	StatCheck	Intelligence	100	1d4+20
@@ -390,6 +431,7 @@
 {
 	AttributeType	Skill
 	SkillId		39
+	Title		Healer
 	
 	StatCheck	Intelligence	100	1d2+10
 }
@@ -398,6 +440,7 @@
 {
 	AttributeType	Skill
 	SkillId		40
+	Title		Swordsman
 	
 	StatCheck	Dexterity	100	1d3
 	StatCheck	Strength	100	1d3+20
@@ -408,6 +451,7 @@
 	AttributeType	Skill
 	DisplayName	Mace Fighting
 	SkillId		41
+	Title		Armsman
 	
 	StatCheck	Dexterity	100	1d2
 	StatCheck	Strength	100	1d4+30
@@ -417,6 +461,7 @@
 {
 	AttributeType	Skill
 	SkillId		42
+	Title		Fencer
 	
 	StatCheck	Dexterity	100	1d3+10
 	StatCheck	Strength	100	1d2+10
@@ -426,6 +471,7 @@
 {
 	AttributeType	Skill
 	SkillId		43
+	Title		Wrestler
 	
 	StatCheck	Dexterity	100	1d4
 	StatCheck	Strength	100	1d2+20
@@ -435,6 +481,7 @@
 {
 	AttributeType	Skill
 	SkillId		44
+	Title		Lumberjack
 	
 	StatCheck	Strength	100	1d4+20
 }
@@ -443,6 +490,7 @@
 {
 	AttributeType	Skill
 	SkillId		45
+	Title		Prospector
 	
 	StatCheck	Strength	100	1d4+20
 }
@@ -451,6 +499,7 @@
 {
 	AttributeType	Skill
 	SkillId		46
+	Title		Stoic
 	
 	StatCheck	Intelligence	100	1d4+20
 }
@@ -459,6 +508,7 @@
 {
 	AttributeType	Skill
 	SkillId		47
+	Title		Rogue
 	
 	StatCheck	Dexterity	100	1d4+20
 }
@@ -468,6 +518,7 @@
 	AttributeType	Skill
 	DisplayName	Remove Trap
 	SkillId		48
+	Title		Rogue
 	
 	StatCheck	Dexterity	100	1d4+20
 }
@@ -476,6 +527,7 @@
 {
 	AttributeType	Skill
 	SkillId		49
+	Title		Necromancer
 }
 
 Attribute BattleFocus
@@ -483,10 +535,12 @@
 	AttributeType	Skill
 	DisplayName	Battle Focus
 	SkillId		50
+	Title		Monk
 }
 
 Attribute Chivalry
 {
 	AttributeType	Skill
 	SkillId		51
+	Title		Paladin
 }

Added: trunk/096/pkg/systems/attributes/config/titles.cfg
===================================================================
--- trunk/096/pkg/systems/attributes/config/titles.cfg	2005-11-01 06:16:44 UTC (rev 767)
+++ trunk/096/pkg/systems/attributes/config/titles.cfg	2005-11-01 06:42:01 UTC (rev 768)
@@ -0,0 +1,18 @@
+#
+# $Id$
+#
+#
+
+Elem LevelTitles
+{
+	// Skill	Title
+	Skill	10.0	Untrained
+	Skill	40.0	Neophyte
+	Skill	50.0	Novice
+	Skill	60.0	Apprentice
+	Skill	70.0	Journeyman
+	Skill	80.0	Expert
+	Skill	90.0	Adept
+	Skill	100	Master
+	Skill	130	Grandmaster
+}

Modified: trunk/096/pkg/systems/attributes/skills.cfg
===================================================================
--- trunk/096/pkg/systems/attributes/skills.cfg	2005-11-01 06:16:44 UTC (rev 767)
+++ trunk/096/pkg/systems/attributes/skills.cfg	2005-11-01 06:42:01 UTC (rev 768)
@@ -13,15 +13,15 @@
 #      Script      Script to run when skill is clicked in skills window
 #      Delay       Number of seconds skills cannot be used after this one
 #      Unhides     Using this skill unhides user if hidden (default: 1)
-#      StrAdv      Strength advancement definition
-#      IntAdv      Intelligence advancement definition
-#      DexAdv      Dexterity advancement definition
+#      
+#      
+#      
 #
-#  Format of StrAdv, IntAdv, DexAdv:
-#      StrAdv [chance] [points]
-#      StrAdv 10 1d4
-#      StrAdv 50 1
-#      StrAdv 2.5 1d3+2
+#  Format of 
+#      
+#      
+#      
+#      
 #
 #      chance is a floating point percentage, from 0.0 to 100.0
 #
@@ -35,626 +35,513 @@
 
 Skill 0
 {
-	Name	    Alchemy
-	SkillId	 0
-	IntAdv	  100 1d4+20
-	DexAdv	  100 1d1+20
-	default_points  100
-	title	   Alchemist
+	Name		Alchemy
+	SkillId		0
+
 	DropStat	str
 }
 
 Skill 1
 {
-	Name	    Anatomy
-	SkillId	 1
-	Script	  :anatomy:anatomy
-	Delay	   10
-	IntAdv	  100 1d2+10
-	default_points  50
-	title	   Healer
-	Unhides	 0
+	Name		Anatomy
+	SkillId		1
+	Script		:anatomy:anatomy
+	Delay		10
+
+	Unhides		0
 	DropStat	str dex
 }
 
 Skill 2
 {
-	Name	    AnimalLore
-	SkillId	 2
-	Script	  :animallore:animalLore
-	Delay	   10
-	IntAdv	  100 1d4+20
-	default_points  100
-	title	   Ranger
-	Unhides	 0
+	Name		AnimalLore
+	SkillId		2
+	Script		:animallore:animalLore
+	Delay		10
+
+	Unhides		0
 	DropStat	str dex
 }
 
 Skill 3
 {
-	Name	    ItemId
-	SkillId	 3
-	Script	  :itemid:itemID
-	Delay	   10
-	IntAdv	  100 1d3+15
-	default_points  50
-	title	   Merchant
-	Unhides	 0
+	Name		ItemId
+	SkillId		3
+	Script		:itemid:itemID
+	Delay		10
+
+	Unhides		0
 	DropStat	str dex
 }
 
 Skill 4
 {
-	Name	    ArmsLore
-	SkillId	 4
-	Script	  :armslore:armsLore
-	Delay	   10
-	IntAdv	  100 1d1+10
-	StrAdv	  100 1d2+10
-	default_points  50
-	title	   Warrior
-	Unhides	 0
+	Name		ArmsLore
+	SkillId		4
+	Script		:armslore:armsLore
+	Delay		10
+
+	Unhides		0
 	DropStat	dex
 }
 
 Skill 5
 {
-	Name	    Parry
-	SkillId	 5
-	StrAdv	  100 1d2+20
-	default_points  100
-	title	   Shieldsfighter
+	Name		Parry
+	SkillId		5
+
 	DropStat	dex int
 }
 
 Skill 6
 {
-	Name	    Begging
-	SkillId	 6
-	Script	  :begging:begging
-	Delay	   10
-	IntAdv	  100 1d1+20
-	default_points  100
-	title	   Beggar
-	Unhides	 1
+	Name		Begging
+	SkillId		6
+	Script		:begging:begging
+	Delay		10
+
+	Unhides		1
 	DropStat	str dex
 }
 
 Skill 7
 {
-	Name	    Blacksmithy
-	SkillId	 7
-	Delay	   10
-	StrAdv	  100 1d4+20
-	default_points  100
-	title	   Smith
+	Name		Blacksmithy
+	SkillId		7
+	Delay		10
+
 	DropStat	dex int
 }
 
 Skill 8
 {
-	Name	    Bowcraft
-	SkillId	 8
-	Delay	   5
-	StrAdv	  100 1d4+20
-	DexAdv	  100 1d3+20
-	default_points  100
-	title	   Bowyer
-	Unhides	 1
+	Name		Bowcraft
+	SkillId		8
+	Delay		5
+
+	Unhides		1
 	DropStat	int
 }
 
 Skill 9
 {
-	Name	    	Peacemaking
-	SkillId	 	9
-	Script	  	:musicianship:peacemaking
-	IntAdv	  	100 1d2
-	default_points  50
-	title	   	Bard
-	Delay	   	2
-	Unhides	 	1
+	Name		Peacemaking
+	SkillId		9
+	Script		:musicianship:peacemaking
+
+	Delay		2
+	Unhides		1
 	DropStat	str
 }
 
 Skill 10
 {
-	Name	    Camping
-	SkillId	 10
-	Delay	   10
-	StrAdv	  100 1d2+10
-	IntAdv	  100 1d2+10
-	default_points  100
-	title	   Ranger
-	Unhides	 1
+	Name		Camping
+	SkillId		10
+	Delay		10
+
+	Unhides		1
 	DropStat	dex
 }
 
 Skill 11
 {
-	Name	    Carpentry
-	SkillId	 11
-	Delay	   10
-	StrAdv	  100 1d4+25
-	default_points  100
-	title	   Carpenter
+	Name		Carpentry
+	SkillId		11
+	Delay		10
+
 	DropStat	dex int
 }
 
 Skill 12
 {
-	Name	    Cartography
-	SkillId	 12
-	Script	  :cartography:cartography
-	Delay	   15
-	IntAdv	  100 1d2+10
-	default_points  100
-	title	   Cartographer
-	Unhides	 0
+	Name		Cartography
+	SkillId		12
+	Script		:cartography:cartography
+	Delay		15
+
+	Unhides		0
 	DropStat	str dex
 }
 
 Skill 13
 {
-	Name	    Cooking
-	SkillId	 13
-	Delay	   15
-	IntAdv	  100 1d2+10
-	default_points  100
-	title	   Chef
-	Unhides	 1
+	Name		Cooking
+	SkillId		13
+	Delay		15
+
+	Unhides		1
 	DropStat	str dex
 }
 
 Skill 14
 {
-	Name	    DetectingHidden
-	SkillId	 14
-	Script	  :detecthidden:detectHidden
-	Delay	   10
-	IntAdv	  100 1d4+20
-	default_points  50
-	title	   Scout
+	Name		DetectingHidden
+	SkillId		14
+	Script		:detecthidden:detectHidden
+	Delay		10
+
 	DropStat	str dex
 }
 
 Skill 15
 {
-	Name	    	Discordance
-	SkillId	 	15
-	Script	  	:musicianship:discord
-	Delay	   	2
-	IntAdv	  	20 2d4
-	default_points  100
+	Name		Discordance
+	SkillId		15
+	Script		:musicianship:discord
+	Delay		2
 	DropStat	str
 }
 
 Skill 16
 {
-	Name	    EvaluatingIntelligence
-	SkillId	 16
-	Script	  :evalint:evalInt
-	Delay	   10
-	IntAdv	  100 1d4+20
-	default_points  50
-	title	   Scholar
-	Unhides	 0
+	Name		EvaluatingIntelligence
+	SkillId		16
+	Script		:evalint:evalInt
+	Delay		10
+
+	Unhides		0
 	DropStat	str dex
 }
 
 
 Skill 17
 {
-	Name	    Healing
-	SkillId	 17
-	Delay	   10
-	DexAdv	  100 1d1+10
-	default_points  100
-	title	   Healer
-	Unhides	 1
+	Name		Healing
+	SkillId		17
+	Delay		10
+
+	Unhides		1
 	DropStat	str int
 }
 
 Skill 18
 {
-	Name	    Fishing
-	SkillId	 18
-	Delay	   5
-	DexAdv	  100 1d4+20
-	StrAdv	  100 1d4+20
-	default_points  100
-	title	   Fisherman
+	Name		Fishing
+	SkillId		18
+	Delay		5
+
 	DropStat	int
 }
 
 Skill 19
 {
-	Name	    ForensicEvaluation
-	SkillId	 19
-	Script	  :forensicevaluation:forensic
-	Delay	   15
-	IntAdv	  100 1d4+20
-	default_points  100
-	title	   Detective
-	Unhides	 0
+	Name		ForensicEvaluation
+	SkillId		19
+	Script		:forensicevaluation:forensic
+	Delay		15
+
+	Unhides		0
 	DropStat	str dex
 }
 
 Skill 20
 {
-	Name	    Herding
-	SkillId	 20
-	StrAdv	  100 1d4+20
-	default_points  100
-	title	   Shepherd
-	Unhides	 1
+	Name		Herding
+	SkillId		20
+
+	Unhides		1
 	DropStat	dex int
 }
 
 Skill 21
 {
-	Name	    Hiding
-	SkillId	 21
-	Script	  :hiding:hiding
-	Delay	   10
-	DexAdv	  100 1d4+20
-	default_points  50
-	title	   Rogue
-	Unhides	 0
+	Name		Hiding
+	SkillId		21
+	Script		:hiding:hiding
+	Delay		10
+
+	Unhides		0
 	DropStat	str int
 }
 
 Skill 22
 {
-	Name	    	Provocation
-	SkillId	 	22
-	Script	  	:musicianship:provocation
-	default_points  100
-	dexadv	  	100 1d2
-	title	  	Bard
-	Unhides	 	1
+	Name		Provocation
+	SkillId		22
+	Script		:musicianship:provocation
+
+	Unhides		1
 	DropStat	str int
 }
 
 Skill 23
 {
-	Name	    Inscription
-	SkillId	 23
-	Script	  :inscription:inscription
-	Delay	   3
-	IntAdv	  100 1d4+20
-	default_points  100
-	title	   Scribe
-	Unhides	 0
+	Name		Inscription
+	SkillId		23
+	Script		:inscription:inscription
+	Delay		3
+
+	Unhides		0
 	DropStat	str dex
 }
 
 Skill 24
 {
-	Name	    Lockpicking
-	SkillId	 24
-	Delay	   15
-	DexAdv	  100 1d3+10
-	default_points  100
-	title	   Rogue
-	Unhides	 0
+	Name		Lockpicking
+	SkillId		24
+	Delay		15
+
+	Unhides		0
 	DropStat	str int
 }
 
 Skill 25
 {
-	Name	    Magery
-	SkillId	 25
-	IntAdv	  100 1d4+20
-	default_points  100
-	title	   Mage
-	Unhides	 1
+	Name		Magery
+	SkillId		25
+
+	Unhides		1
 	DropStat	str dex
 }
 
 Skill 26
 {
-	Name	    MagicResistance
-	SkillId	 26
-	IntAdv	  100 1d4+20
-	default_points  100
-	title	   Mage
-	Unhides	 1
+	Name		MagicResistance
+	SkillId		26
+
+	Unhides		1
 	DropStat	dex
 }
 
 Skill 27
 {
-	Name	    Tactics
-	SkillId	 27
-	default_points  40
-	title	   Warrior
+	Name		Tactics
+	SkillId		27
+
 	DropStat	dex
 }
 
 Skill 28
 {
-	Name	    Snooping
-	SkillId	 28
-	Delay	   5
-	Unhides	 0
-	DexAdv	  80 4d6+10
-	default_points  200
+	Name		Snooping
+	SkillId		28
+	Delay		5
+	Unhides		0
 	DropStat	str int
 }
 
 Skill 29
 {
-	Name	    	Musicianship
-	SkillId	 	29
-	Delay	   	2
-	IntAdv	  	100 1d2+10
-	DexAdv	  	100 1d4+20
-	default_points  100
-	title	   	Bard
-	Unhides	 	1
+	Name		Musicianship
+	SkillId		29
+	Delay		2
+
+	Unhides		1
 	DropStat	str
 }
 
 Skill 30
 {
-	Name	    Poisoning
-	SkillId	 30
-	Script	  :poisoning:poisonSkill
-	Delay	   10
-	IntAdv	  100 1d2+10
-	DexAdv	  100 1d4+20
-	default_points  50
-	title	   Assassin
-	Unhides	 0
+	Name		Poisoning
+	SkillId		30
+	Script		:poisoning:poisonSkill
+	Delay		10
+
+	Unhides		0
 	DropStat	str
 }
 
 Skill 31
 {
-	Name	    Archery
-	SkillId	 31
-	DexAdv	  100 1d4+20
-	StrAdv	  100 1d2+10
-	title	   Archer
-	Unhides	 1
+	Name		Archery
+	SkillId		31
+
+	Unhides		1
 	DropStat	int
 }
 
 Skill 32
 {
 	Name		SpiritSpeak
-	SkillId	 	32
-	Script	  	:spiritspeak:spiritSpeak
-	Delay	   	2
-	IntAdv	  	100 1d4+20
-	default_points  50
-	title	   	Medium
-	Unhides	 	1
+	SkillId		32
+	Script		:spiritspeak:spiritSpeak
+	Delay		2
+	
+	Unhides		1
 	DropStat	str dex
 }
 
 Skill 33
 {
-	Name	    Stealing
-	SkillId	 33
-	Script	  :stealing:stealing
-	Delay	   15
-	Unhides	 0
-	DexAdv	  90 3d4+9
-	default_points  200
-	Unhides	 1
+	Name		Stealing
+	SkillId		33
+	Script		:stealing:stealing
+	Delay		15
+	Unhides		0
+	Unhides		1
 	DropStat	str int
 }
 
 Skill 34
 {
-	Name	    Tailoring
-	SkillId	 34
-	Delay	   15
-	DexAdv	  100 1d1+10
-	default_points  100
-	title	   Tailor
-	Unhides	 0
+	Name		Tailoring
+	SkillId		34
+	Delay		15
+
+	Unhides		0
 	DropStat	str int
 }
 
 Skill 35
 {
-	Name	    AnimalTaming
-	SkillId	 35
-	Script	  :taming:taming
-	Delay	   10
-	StrAdv	  100 1d4+20
-	IntAdv	  100 1d3+10
-	default_points  50
-	title	   Tamer
-	Unhides	 1
+	Name		AnimalTaming
+	SkillId		35
+	Script		:taming:taming
+	Delay		10
+
+	Unhides		1
 	DropStat	dex
 }
 
 Skill 36
 {
-	Name	    TasteIdentification
-	SkillId	 36
-	Script	  :tasteid:tasteID
-	Delay	   10
-	IntAdv	  100 1d4+20
-	default_points  50
-	title	   Chef
-	Unhides	 0
+	Name		TasteIdentification
+	SkillId		36
+	Script		:tasteid:tasteID
+	Delay		10
+
+	Unhides		0
 	DropStat	str dex
 }
 
 Skill 37
 {
-	Name	    Tinkering
-	SkillId	 37
-	Delay	   10
-	StrAdv	  100 1d4+20
-	IntAdv	  100 1d4+20
-	default_points  100
-	title	   Tinker
+	Name		Tinkering
+	SkillId		37
+	Delay		10
+
 	DropStat	dex
 }
 
 Skill 38
 {
-	Name	    Tracking
-	SkillId	 38
-	Script	  :tracking:tracking
-	Delay	   10
-	IntAdv	  100 1d4+20
-	DexAdv	  100 1d2+10
-	default_points  50
-	Unhides	 1
+	Name		Tracking
+	SkillId		38
+	Script		:tracking:tracking
+	Delay		10
+	Unhides		1
 	DropStat	str
 }
 
 Skill 39
 {
-	Name	    Veterinary
-	SkillId	 39
-	Delay	   10
-	IntAdv	  100 1d2+10
-	default_points  100
-	title	   Healer
-	Unhides	 1
+	Name		Veterinary
+	SkillId		39
+	Delay		10
+
+	Unhides		1
 	DropStat	str dex
 }
 
 Skill 40
 {
-	Name	    Swordsmanship
-	SkillId	 40
-	StrAdv	  100 1d3+20
-	DexAdv	  100 1d3
-	title	   Swordsman
-	Unhides	 1
+	Name		Swordsmanship
+	SkillId		40
+
+	Unhides		1
 	DropStat	int
 }
 
 Skill 41
 {
-	Name	    Macefighting
-	SkillId	 41
-	StrAdv	  100 1d4+30
-	DexAdv	  100 1d2
-	title	   Armsman
-	Unhides	 1
+	Name		Macefighting
+	SkillId		41
+
+	Unhides		1
 	DropStat	int
 }
 
 Skill 42
 {
-	Name	    Fencing
-	SkillId	 42
-	StrAdv	  100 1d2+10
-	DexAdv	  100 1d3+10
-	title	   Fencer
-	Unhides	 1
+	Name		Fencing
+	SkillId		42
+
+	Unhides		1
 	DropStat	int
 }
 
 Skill 43
 {
-	Name	    Wrestling
-	SkillId	 43
-	StrAdv	  100 1d2+20
-	DexAdv	  100 1d4
-	title	   Wrestler
-	Unhides	 1
+	Name		Wrestling
+	SkillId		43
+
+	Unhides		1
 	DropStat	int
 }
 
 Skill 44
 {
-	Name	    Lumberjacking
-	SkillId	 44
-	StrAdv	  100 1d4+20
-	default_points  100
-	title	   Lumberjack
-	Unhides	 1
+	Name		Lumberjacking
+	SkillId		44
+
+	Unhides		1
 	DropStat	dex int
 }
 
 Skill 45
 {
-	Name	    Mining
-	SkillId	 45
-	Delay	   10
-	StrAdv	  100 1d4+20
-	default_points  100
-	title	   Miner
-	Unhides	 1
+	Name		Mining
+	SkillId		45
+	Delay		10
+
+	Unhides		1
 	DropStat	dex int
 }
 
 Skill 46
 {
-	Name	    Meditation
-	SkillId	 46
-	Script	  :meditation:meditation
-	Delay	   10
-	IntAdv	  100 1d4+20
-	default_points  100
-	title	   Stoic
-	Unhides	 1
+	Name		Meditation
+	SkillId		46
+	Script		:meditation:meditation
+	Delay		10
+
+	Unhides		1
 	DropStat	str dex
 }
 
 Skill 47
 {
-	Name	    Stealth
-	SkillId	 47
-	Script	  :stealth:stealth
-	Delay	   10
-	Unhides	 0
-	DexAdv	  100 1d4+20
-	default_points  50
-	title	   Rogue
+	Name		Stealth
+	SkillId		47
+	Script		:stealth:stealth
+	Delay		10
+	Unhides		0
+
 	DropStat	str int
 }
 
 Skill 48
 {
-	Name	    RemoveTrap
-	SkillId	 48
-	Script	  :removetrap:removeTrap
-	Delay	   10
-	DexAdv	  100 1d4+20
-	default_points  50
-	title	   Rogue
+	Name		RemoveTrap
+	SkillId		48
+	Script		:removetrap:removeTrap
+	Delay		10
+
 	DropStat	str int
 }
 
 Skill 49
 {
-	Name	    Necromancy
-	SkillId	 49
-	IntAdv	  100 1d4+20
-	default_points  100
-	title	   Necromancer
+	Name		Necromancy
+	SkillId		49
+
 	DropStat	str dex
 }
 
 Skill 50
 {
-	Name	    Focus
-	SkillId	 50
-	IntAdv	  100 1d4+20
-	default_points  100
-	title	   Monk
+	Name		Focus
+	SkillId		50
+
 	DropStat	str dex
 }
 
 Skill 51
 {
-	Name	    Chivalry
-	SkillId	 51
-	IntAdv	  100 1d4+20
-	default_points  100
-	title	   Paladin
-	Unhides	 1
+	Name		Chivalry
+	SkillId		51
+
+	Unhides		1
 	DropStat	str dex
 }
\ No newline at end of file



From austin at berlios.de  Tue Nov  1 08:10:37 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 08:10:37 +0100
Subject: [Poldistro-svn] r769 - in trunk/096/pkg/systems/attributes: config include
Message-ID: <200511010710.jA17AbN9007135@sheep.berlios.de>

Author: austin
Date: 2005-11-01 08:10:15 +0100 (Tue, 01 Nov 2005)
New Revision: 769

Added:
   trunk/096/pkg/systems/attributes/include/titles.inc
Modified:
   trunk/096/pkg/systems/attributes/config/titles.cfg
Log:
Titles support finished.

Modified: trunk/096/pkg/systems/attributes/config/titles.cfg
===================================================================
--- trunk/096/pkg/systems/attributes/config/titles.cfg	2005-11-01 06:42:01 UTC (rev 768)
+++ trunk/096/pkg/systems/attributes/config/titles.cfg	2005-11-01 07:10:15 UTC (rev 769)
@@ -5,14 +5,14 @@
 
 Elem LevelTitles
 {
-	// Skill	Title
-	Skill	10.0	Untrained
-	Skill	40.0	Neophyte
-	Skill	50.0	Novice
-	Skill	60.0	Apprentice
-	Skill	70.0	Journeyman
-	Skill	80.0	Expert
-	Skill	90.0	Adept
-	Skill	100	Master
-	Skill	130	Grandmaster
+	//	Title		Level
+	Level	Untrained	10.0
+	Level	Neophyte	40.0
+	Level	Novice		50.0
+	Level	Apprentice	60.0
+	Level	Journeyman	70.0
+	Level	Expert		80.0
+	Level	Adept		90.0
+	Level	Master		100.0
+	Level	Grandmaster	130.0
 }

Added: trunk/096/pkg/systems/attributes/include/titles.inc
===================================================================
--- trunk/096/pkg/systems/attributes/include/titles.inc	2005-11-01 06:42:01 UTC (rev 768)
+++ trunk/096/pkg/systems/attributes/include/titles.inc	2005-11-01 07:10:15 UTC (rev 769)
@@ -0,0 +1,80 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+use cfgfile;
+
+include ":attributes:attributes";
+
+/*
+ * AP_GetLevelTitle(skill_level)
+ *
+ * Purpose
+ * Gets the title for a particlar skill level.
+ *
+ * Parameters
+ * skill_level:	Skill level of a skill. (e.g. 80% = 80)
+ *
+ * Return value
+ * Returns a string on success.
+ * Returns an error on failure.
+ *
+ */
+function AP_GetLevelTitle(skill_level)
+	skill_level := Cdbl(skill_level);
+	
+	if ( skill_level < 0.0 )
+		return "U SUK";
+	endif
+	
+	var title_cfg := ReadConfigFile(":attributes:config/titles.cfg");
+	if ( !title_cfg )
+		return title_cfg;
+	endif
+	
+	var title_elem := title_cfg["LevelTitles"];
+	if ( !title_elem )
+		return title_elem;
+	endif
+	
+	var levels_list := GetConfigStringDictionary(title_elem, "Level");
+	
+	foreach entry in ( levels_list )
+		if ( skill_level < CDbl(entry) )
+			return _entry_iter;
+		endif
+		sleepms(2);
+	endforeach
+	
+	return error{"errortext":="Could not find skill title for that level."};
+endfunction
+
+/*
+ * AP_GetSkillTitle(skill_name)
+ * 
+ * Purpose
+ * Finds the title name of a skill.
+ *
+ * Parameters
+ * skill_name:	Name of a skill from attributes.cfg
+ *
+ * Return value
+ * Returns a string on success.
+ * Returns an error on failure.
+ *
+ */
+function AP_GetSkillTitle(skill_name)
+	var elem_info := AP_GetAttributeCfgElem(skill_name);
+	if ( !elem_info )
+		return elem_info;
+	endif
+	
+	if ( elem_info.Title) 
+		return elem_info.Title;
+	else
+		return error{"errortext":="Attribute does not have a 'Title' entry."};
+	endif
+endfunction
\ No newline at end of file



From austin at berlios.de  Tue Nov  1 08:22:12 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 08:22:12 +0100
Subject: [Poldistro-svn] r770 - in trunk/096/pkg/items/walkOn: . spiderWeb
Message-ID: <200511010722.jA17MCA4012480@sheep.berlios.de>

Author: austin
Date: 2005-11-01 08:22:07 +0100 (Tue, 01 Nov 2005)
New Revision: 770

Added:
   trunk/096/pkg/items/walkOn/spiderWeb/control.src
Modified:
   trunk/096/pkg/items/walkOn/itemdesc.cfg
   trunk/096/pkg/items/walkOn/spiderWeb/walkOn.src
Log:
Spider web implemented.

Modified: trunk/096/pkg/items/walkOn/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/walkOn/itemdesc.cfg	2005-11-01 07:10:15 UTC (rev 769)
+++ trunk/096/pkg/items/walkOn/itemdesc.cfg	2005-11-01 07:22:07 UTC (rev 770)
@@ -1,6 +1,18 @@
 # $Id$
 #
 #
+Item 0x10D4
+{
+	Name		SpiderWeb
+	Desc		spider web
+	
+	Movable		0
+	SaveOnExit	0
+
+	ControlScript	spiderweb/control
+	WalkOnScript	spiderweb/walkOn
+}
+
 Item 0x398C
 {
 	Name		firefield_ew

Added: trunk/096/pkg/items/walkOn/spiderWeb/control.src
===================================================================
--- trunk/096/pkg/items/walkOn/spiderWeb/control.src	2005-11-01 07:10:15 UTC (rev 769)
+++ trunk/096/pkg/items/walkOn/spiderWeb/control.src	2005-11-01 07:22:07 UTC (rev 770)
@@ -0,0 +1,12 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+
+program RemoveWeb(web)
+	sleep(60);
+	DestroyItem(web);
+endprogram
\ No newline at end of file

Modified: trunk/096/pkg/items/walkOn/spiderWeb/walkOn.src
===================================================================
--- trunk/096/pkg/items/walkOn/spiderWeb/walkOn.src	2005-11-01 07:10:15 UTC (rev 769)
+++ trunk/096/pkg/items/walkOn/spiderWeb/walkOn.src	2005-11-01 07:22:07 UTC (rev 770)
@@ -0,0 +1,23 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+
+include ":timedscripts:timedScripts";
+
+program WalkOn(mobile, spiderweb)
+	if ( mobile.cmdlevel )
+		return 0;
+	elseif ( mobile.dead )
+		return 0;
+	endif
+	
+	spiderweb := spiderweb; // So the compiler does no warn
+	
+	SendSysMessage(mobile, "You become caught in the sticky web.");
+	TS_StartTimer(mobile, "paralysis", 30);
+
+	return 1;
+endprogram



From austin at berlios.de  Tue Nov  1 08:34:03 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 08:34:03 +0100
Subject: [Poldistro-svn] r771 - trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis
Message-ID: <200511010734.jA17Y3M7018209@sheep.berlios.de>

Author: austin
Date: 2005-11-01 08:34:00 +0100 (Tue, 01 Nov 2005)
New Revision: 771

Modified:
   trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/endParalysis.src
   trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/paralysis.src
Log:
Updated to.. work

Modified: trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/endParalysis.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/endParalysis.src	2005-11-01 07:22:07 UTC (rev 770)
+++ trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/endParalysis.src	2005-11-01 07:34:00 UTC (rev 771)
@@ -1,9 +1,14 @@
+/*
+ * $Id$
+ *
+ */
+ 
 use uo;
 use os;
 
-program poisonScript(params)
-	var who := params[1];
+program poisonScript(mobile)
+	mobile.paralyzed := 0;
 	
-	who.paralyzed := 0;
+	return 1;
 endprogram
 

Modified: trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/paralysis.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/paralysis.src	2005-11-01 07:22:07 UTC (rev 770)
+++ trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/paralysis.src	2005-11-01 07:34:00 UTC (rev 771)
@@ -1,3 +1,8 @@
+/*
+ * $Id$
+ *
+ */
+ 
 use uo;
 use os;
 
@@ -2,8 +7,8 @@
 program poisonScript(params)
-	var who := params[1];
+	var mobile := params[1];
 	
-	PlaySoundEffect(who, 0x205);
-	SendSysMessage(who, "You are unable to move.");
-	while ( who )
-		who.paralyzed := 1;
+	PlaySoundEffect(mobile, 0x205);
+	SendSysMessage(mobile, "You are unable to move.");
+	while ( mobile )
+		mobile.paralyzed := 1;
 		sleepms(250);



From austin at berlios.de  Tue Nov  1 08:41:31 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 08:41:31 +0100
Subject: [Poldistro-svn] r772 - in trunk/096/pkg/mobiles/timedScripts: config subScripts/odors
Message-ID: <200511010741.jA17fVEm020694@sheep.berlios.de>

Author: austin
Date: 2005-11-01 08:41:28 +0100 (Tue, 01 Nov 2005)
New Revision: 772

Added:
   trunk/096/pkg/mobiles/timedScripts/subScripts/odors/flatulence.src
Modified:
   trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg
Log:
Flatulence... its good for when youre stuck in a restaurant booth with 3 people on each side of you and you want to get up.

.addtimer flatulence 30

Modified: trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg	2005-11-01 07:34:00 UTC (rev 771)
+++ trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg	2005-11-01 07:41:28 UTC (rev 772)
@@ -105,6 +105,16 @@
 	MaxDuration		300	// 5 minutes
 }
 
+TimerElem flatulence
+{
+	Name			Poo Stink
+	Script			subScripts/odors/flatulence
+	NoCure			1
+	EndOnDeath		0
+	EndMessage		The horrid stench of poo fades away.
+	MaxDuration		300	// 5 minutes
+}
+
 #--=[ Consumables ]=------------------------------
 
 TimerElem alcohol

Added: trunk/096/pkg/mobiles/timedScripts/subScripts/odors/flatulence.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/subScripts/odors/flatulence.src	2005-11-01 07:34:00 UTC (rev 771)
+++ trunk/096/pkg/mobiles/timedScripts/subScripts/odors/flatulence.src	2005-11-01 07:41:28 UTC (rev 772)
@@ -0,0 +1,24 @@
+use uo;
+use os;
+use util;
+
+program Flatulence(params)
+	var who := params[1];
+	
+	var sounds := array{0x5d, 0x5f, 0x5b, 0x22};
+	
+	SendSysMessage(who, "Your stomach feels bloated.");
+	
+	while( 1 )
+		sleep(RandomDiceRoll("6d5"));
+		
+		PlaySoundEffect(who, sounds[RandomInt(sounds.size())+1]);
+		
+		PrintTextAbove(who, "*breaks the wind*");
+		
+		foreach mobile in ListMobilesNearLocationEX(who.x, who.y, who.z, 10, LISTEX_FLAG_NORMAL+LISTEX_FLAG_HIDDEN)
+			SendSysMessage(mobile, "You notice an indistinguishable stench in the air.");
+			sleepms(2);
+		endforeach
+	endwhile
+endprogram



From austin at berlios.de  Tue Nov  1 08:56:25 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 08:56:25 +0100
Subject: [Poldistro-svn] r773 - in trunk/096/pkg/items: . feces feces/config feces/poop
Message-ID: <200511010756.jA17uPfO027833@sheep.berlios.de>

Author: austin
Date: 2005-11-01 08:56:21 +0100 (Tue, 01 Nov 2005)
New Revision: 773

Added:
   trunk/096/pkg/items/feces/
   trunk/096/pkg/items/feces/commands/
   trunk/096/pkg/items/feces/config/
   trunk/096/pkg/items/feces/config/icp.cfg
   trunk/096/pkg/items/feces/include/
   trunk/096/pkg/items/feces/itemdesc.cfg
   trunk/096/pkg/items/feces/pkg.cfg
   trunk/096/pkg/items/feces/poop/
   trunk/096/pkg/items/feces/poop/use.src
Log:
You can now throw poop at people... joy.

Added: trunk/096/pkg/items/feces/config/icp.cfg
===================================================================
--- trunk/096/pkg/items/feces/config/icp.cfg	2005-11-01 07:41:28 UTC (rev 772)
+++ trunk/096/pkg/items/feces/config/icp.cfg	2005-11-01 07:56:21 UTC (rev 773)
@@ -0,0 +1,13 @@
+ICP Register
+{
+	Name		Feces
+	Version		1.0
+
+	Description	Package for fecal tiles - and scripts for throwing them.
+
+	Creator		Austin
+	C_Email		AustinHeilman at gmail.com
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+}

Added: trunk/096/pkg/items/feces/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/feces/itemdesc.cfg	2005-11-01 07:41:28 UTC (rev 772)
+++ trunk/096/pkg/items/feces/itemdesc.cfg	2005-11-01 07:56:21 UTC (rev 773)
@@ -0,0 +1,21 @@
+Item 0xF3B
+{
+	Name	HorseDung
+	Desc	horse dung
+	
+	Weight	1
+	Movable	1
+	
+	Script	poop/use
+}
+
+Item 0xF3C
+{
+	Name	HorseDung
+	Desc	horse dung
+	
+	Weight	1
+	Movable	1
+	
+	Script	poop/use
+}

Added: trunk/096/pkg/items/feces/pkg.cfg
===================================================================
--- trunk/096/pkg/items/feces/pkg.cfg	2005-11-01 07:41:28 UTC (rev 772)
+++ trunk/096/pkg/items/feces/pkg.cfg	2005-11-01 07:56:21 UTC (rev 773)
@@ -0,0 +1,17 @@
+# $Id$
+#
+#
+Enabled		1
+Name		feces
+
+Version		1.0
+
+CoreRequired	96
+
+Creator		Austin Heilman
+Email		AustinHeilman at gmail.com
+Maintainer	Distro Team
+Email		distro at polserver.com
+
+#Requires none
+#conflicts	none

Added: trunk/096/pkg/items/feces/poop/use.src
===================================================================
--- trunk/096/pkg/items/feces/poop/use.src	2005-11-01 07:41:28 UTC (rev 772)
+++ trunk/096/pkg/items/feces/poop/use.src	2005-11-01 07:56:21 UTC (rev 773)
@@ -0,0 +1,39 @@
+use uo;
+use os;
+
+include ":timedscripts:timedScripts";
+
+program UseFeces(who, feces)
+	if ( !feces.movable )
+		SendSysMessage(who, "That is not movable.");
+		return 0;
+	endif
+
+	SendSysMessage(who, "What do you want to throw this at?");
+	var targ := target(who);
+	
+	if ( !targ )
+		SendSysMessage(who, "Cancelled");
+		return 0;
+	elseif ( !CheckLineOfSight(who, targ) )
+		SendSysMessage(who, "That is out of line of sight.");
+		return 0;
+	elseif ( Distance(who, targ) > 10 )
+		SendSysMessage(who, "That is too far away.");
+		return 0;
+	endif
+	PlayMovingEffect(who, targ, feces.graphic, 10, 10);
+	SubtractAmount(feces, 1);
+	
+	Sleepms(Distance(who, targ)*20);
+	
+	PrintTextAbove(targ, "*SPLAT!*");
+	
+	if ( targ.IsA(POLCLASS_MOBILE) )
+		ApplyRawDamage(targ, 0);
+		TS_StartTimer(targ, "poostink", 40);
+		SendSysMessage(targ, who.name+" has just thrown feces at you!");
+	else
+		PrintTextAbove(targ, "*"+targ.desc+" smells like poo*");
+	endif
+endprogram



From austin at berlios.de  Tue Nov  1 08:58:21 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 08:58:21 +0100
Subject: [Poldistro-svn] r774 - trunk/096/pkg/items/feces
Message-ID: <200511010758.jA17wLtV028817@sheep.berlios.de>

Author: austin
Date: 2005-11-01 08:57:57 +0100 (Tue, 01 Nov 2005)
New Revision: 774

Modified:
   trunk/096/pkg/items/feces/itemdesc.cfg
Log:
Changed so the first is HorseChips (theyre the big round ball deals!)
Second is more runny so its called HorseDung

Modified: trunk/096/pkg/items/feces/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/feces/itemdesc.cfg	2005-11-01 07:56:21 UTC (rev 773)
+++ trunk/096/pkg/items/feces/itemdesc.cfg	2005-11-01 07:57:57 UTC (rev 774)
@@ -1,6 +1,6 @@
 Item 0xF3B
 {
-	Name	HorseDung
+	Name	HorseChips
 	Desc	horse dung
 	
 	Weight	1



From austin at berlios.de  Tue Nov  1 09:14:23 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 09:14:23 +0100
Subject: [Poldistro-svn] r775 - trunk/096/pkg/mobiles/timedScripts/include
Message-ID: <200511010814.jA18ENno004066@sheep.berlios.de>

Author: austin
Date: 2005-11-01 09:14:19 +0100 (Tue, 01 Nov 2005)
New Revision: 775

Modified:
   trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc
Log:
Support for logoff and death events.

Modified: trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc	2005-11-01 07:57:57 UTC (rev 774)
+++ trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc	2005-11-01 08:14:19 UTC (rev 775)
@@ -306,3 +306,51 @@
 	var process := TS_GetControllerProcess(mobile);
 	return process.SendEvent(event);
 endfunction
+
+/* 
+ * TS_LogOff(mobile)
+ *
+ * Purpose
+ * Informs the timer controller that a player logged out.
+ *
+ * Parameters
+ * mobile:	Mobile that logged off
+ *
+ * Return value
+ * Returns 1 on success
+ * Returns 0 on failure
+ *
+ */
+function TS_LogOff(mobile)
+	if ( mobile.IsA(POLCLASS_NPC) )
+		return error{"errortext":="NPCs can't log off."};
+	endif
+	
+	var event := struct;
+	event.+type := EVENT_LOGOFF;
+	
+	var process := TS_GetControllerProcess(mobile);
+	return process.SendEvent(event);
+endfunction
+
+/* 
+ * TS_Death(mobile)
+ *
+ * Purpose
+ * Informs the timer controller that a moble died.
+ *
+ * Parameters
+ * mobile:	Mobile that died.
+ *
+ * Return value
+ * Returns 1 on success
+ * Returns 0 on failure
+ *
+ */
+function TS_Death(mobile)
+	var event := struct;
+	event.+type := EVENT_DEAD;
+	
+	var process := TS_GetControllerProcess(mobile);
+	return process.SendEvent(event);
+endfunction
\ No newline at end of file



From muaddiblsd at berlios.de  Tue Nov  1 09:16:36 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Tue, 1 Nov 2005 09:16:36 +0100
Subject: [Poldistro-svn] r776 - in trunk/096: config pkg/mobiles/brainAI pkg/mobiles/brainAI/config pkg/mobiles/brainAI/include pkg/mobiles/brainAI/scripts/combat pkg/mobiles/brainAI/scripts/doubleClick pkg/mobiles/brainAI/scripts/lookAround pkg/mobiles/brainAI/scripts/shouldWatch pkg/mobiles/brainAI/scripts/sleep pkg/mobiles/brainAI/scripts/wonFight
Message-ID: <200511010816.jA18Ga1Z005119@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-01 09:16:27 +0100 (Tue, 01 Nov 2005)
New Revision: 776

Added:
   trunk/096/pkg/mobiles/brainAI/include/npcSounds.inc
   trunk/096/pkg/mobiles/brainAI/scripts/combat/genericAnimal.src
   trunk/096/pkg/mobiles/brainAI/scripts/doubleClick/cowTip.src
   trunk/096/pkg/mobiles/brainAI/scripts/lookAround/findFeared.src
   trunk/096/pkg/mobiles/brainAI/scripts/shouldWatch/watchFeared.src
   trunk/096/pkg/mobiles/brainAI/scripts/wonFight/wonFightAnimal.src
Modified:
   trunk/096/config/npcdesc.cfg
   trunk/096/pkg/mobiles/brainAI/config/hatelist.cfg
   trunk/096/pkg/mobiles/brainAI/include/npcUtil.inc
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
   trunk/096/pkg/mobiles/brainAI/scripts/sleep/generic.src
Log:
Moved cow npc to brain package.
Added nerves to fully support cow npc.
Added npcSounds to brain includes. To get the new sounds format for IdleSounds, they are stored in PACKED array format. Template props renamed also, See cow template for examples.
Added generic and genericAnimal nerves.
Added cow's hatelist. 
Distro hatelist.cfg stores "Hates" and "Fears" entries. All names (both the elem's name) and Prop entries, MUST match a npctemplate name (minus package).
Find and Watch Feared nerves added.

ToDo: Need to make an include function set for getting HateList and FearList (with return as an array).

Modified: trunk/096/config/npcdesc.cfg
===================================================================
--- trunk/096/config/npcdesc.cfg	2005-11-01 08:14:19 UTC (rev 775)
+++ trunk/096/config/npcdesc.cfg	2005-11-01 08:16:27 UTC (rev 776)
@@ -2135,51 +2135,6 @@
 	AttackHitScript		:combat:wrestlingHitScript
 }
 
-NPCTemplate	cow
-{
-	Name			a cow
-	Script			:oldAI:cow
-	ObjType			0xd8
-	Color			0
-	TrueColor		33784
-	Gender			0
-	Strength		30
-	Intelligence		5
-	Dexterity		15
-	HITS			18
-	MANA			0
-	STAM			15
-	Anatomy			0.0
-	EvaluatingIntelligence	0.0
-	Magery			0.0
-	Meditation		0.0
-	Poisoning		0.0
-	ResistingSpells		5.5
-	Tactics			5.5
-	Wrestling		5.5
-	AttackSpeed		30
-	AttackDamage		1d4
-	AttackAttribute		Wrestling
-	AttackHitSound		0x7B
-	AttackMissSound		0x239
-	DeathSound		0x7d
-	DamagedSound		0x7c
-	IdleSound1		0x79
-	IdleSound2		0x7a
-	AR			9
-	food			veggie
-	foodtype		veggie
-	packinstinct		none
-	GuardIgnore		1
-	DStart			10
-	CorpseItm		rawribs hides
-	CorpseAmt		8 12
-	NoLoot			1
-	CProp  Karma		i0
-	CProp  Fame		i10
-	AttackHitScript		:combat:wrestlingHitScript
-}
-
 NPCTemplate	chicken
 {
 	Name			a chicken

Modified: trunk/096/pkg/mobiles/brainAI/config/hatelist.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/config/hatelist.cfg	2005-11-01 08:14:19 UTC (rev 775)
+++ trunk/096/pkg/mobiles/brainAI/config/hatelist.cfg	2005-11-01 08:16:27 UTC (rev 776)
@@ -1,17 +1,43 @@
 HateList Dog
 {
-	Hates	cats
-	Hates	birds
-	Hates	horses
-	Hates	cows
+	Hates	cat
+	Hates	bird
+	Hates	horse
+	Hates	horse2
+	Hates	horse3
+	Hates	horse4
+	Hates	packhorse
+	Hates	cow
 	Hates	deer
+	Hates	wolf
+	Fears	direwolf
+	Fears	frostwolf
+	Fears	whitewolf
+	Fears	greywolf
 }
 
 HateList Wolf
 {
-	Hates	cats
-	Hates	birds
-	Hates	horses
-	Hates	cows
+	Hates	dog
+	Hates	cat
+	Hates	bird
+	Hates	horse
+	Hates	horse2
+	Hates	horse3
+	Hates	horse4
+	Hates	packhorse
+	Hates	cow
 	Hates	deer
 }
+
+HateList Cow
+{
+	Hates	snake
+	Hates	icesnake
+	Fears	dog
+	Fears	wolf
+	Fears	direwolf
+	Fears	frostwolf
+	Fears	whitewolf
+	Fears	greywolf
+}
\ No newline at end of file

Added: trunk/096/pkg/mobiles/brainAI/include/npcSounds.inc
===================================================================
--- trunk/096/pkg/mobiles/brainAI/include/npcSounds.inc	2005-11-01 08:14:19 UTC (rev 775)
+++ trunk/096/pkg/mobiles/brainAI/include/npcSounds.inc	2005-11-01 08:16:27 UTC (rev 776)
@@ -0,0 +1,165 @@
+/*===============================================================
+* Current Version
+* NPCSOUNDS.INC - v1.0
+* Updated 11/01/2005 2:26AM
+*
+* -- Revision v1.0 --
+* MuadDib:
+*  Created include file
+===============================================================*/
+use uo;
+use os;
+use util;
+use cfgfile;
+
+include ":brainAI:npcUtil";
+include ":brainAI:npcError";
+
+
+/////////////////////////////////////////////////////////////////
+// * Function List *
+//
+// NPC_GetIdleSound(mobile)
+// NPC_GetDamagedSound(mobile)
+// NPC_GetDeathSound(mobile)
+// NPC_GetMissSound(mobile)
+// NPC_GetHitSound(mobile)
+//
+/////////////////////////////////////////////////////////////////
+// * Internal/Private Function List *
+//
+/////////////////////////////////////////////////////////////////
+
+
+/*
+ * NPC_GetIdleSound(mobile)
+ *
+ * Purpose
+ * Gets the packed array form of IdleSounds Prop from NPC Template.
+ *
+ * Parameters
+ * mobile:	Mobile to find the idle sound for.
+ *
+ * Return value
+ * Returns an integer that is the sound ID to be played.
+ *
+ */
+function NPC_GetIdleSound(mobile)
+	var mobile_template := NPC_GetNPCConfig(mobile);
+	var idle_sound_list := UnPack(mobile_template.IdleSounds);
+
+	if( TypeOf(idle_sound_list) != "Array" )
+		NPC_ErrorSysLog(mobile, "Invalid Idle Sound Setting");
+		return 0;
+	endif
+
+	return RandomInt(idle_sound_list.size())+1;
+
+endfunction
+
+
+/*
+ * NPC_GetDamagedSound(mobile)
+ *
+ * Purpose
+ * Gets the packed array form of DamagedSounds Prop from NPC Template.
+ *
+ * Parameters
+ * mobile:	Mobile to find the damaged sound for.
+ *
+ * Return value
+ * Returns an integer that is the sound ID to be played.
+ *
+ */
+function NPC_GetDamagedSound(mobile)
+	var mobile_template := NPC_GetNPCConfig(mobile);
+	var damaged_sound_list := UnPack(mobile_template.DamagedSounds);
+
+	if( TypeOf(damaged_sound_list) != "Array" )
+		NPC_ErrorSysLog(mobile, "Invalid Damaged Sound Setting");
+		return 0;
+	endif
+
+	return RandomInt(damaged_sound_list.size())+1;
+
+endfunction
+
+
+/*
+ * NPC_GetDeathSound(mobile)
+ *
+ * Purpose
+ * Gets the packed array form of DeathSounds Prop from NPC Template.
+ *
+ * Parameters
+ * mobile:	Mobile to find the death sound for.
+ *
+ * Return value
+ * Returns an integer that is the sound ID to be played.
+ *
+ */
+function NPC_GetDeathSound(mobile)
+	var mobile_template := NPC_GetNPCConfig(mobile);
+	var death_sound_list := UnPack(mobile_template.DeathSounds);
+
+	if( TypeOf(death_sound_list) != "Array" )
+		NPC_ErrorSysLog(mobile, "Invalid Death Sound Setting");
+		return 0;
+	endif
+
+	return RandomInt(death_sound_list.size())+1;
+
+endfunction
+
+
+/*
+ * NPC_GetMissSound(mobile)
+ *
+ * Purpose
+ * Gets the packed array form of AttackMissSounds Prop from NPC Template.
+ *
+ * Parameters
+ * mobile:	Mobile to find the attack and miss sound for.
+ *
+ * Return value
+ * Returns an integer that is the sound ID to be played.
+ *
+ */
+function NPC_GetMissSound(mobile)
+	var mobile_template := NPC_GetNPCConfig(mobile);
+	var miss_sound_list := UnPack(mobile_template.AttackMissSounds);
+
+	if( TypeOf(miss_sound_list) != "Array" )
+		NPC_ErrorSysLog(mobile, "Invalid Miss Sound Setting");
+		return 0;
+	endif
+
+	return RandomInt(miss_sound_list.size())+1;
+
+endfunction
+
+/*
+ * NPC_GetHitSound(mobile)
+ *
+ * Purpose
+ * Gets the packed array form of AttackHitSounds Prop from NPC Template.
+ *
+ * Parameters
+ * mobile:	Mobile to find the attack and hit sound for.
+ *
+ * Return value
+ * Returns an integer that is the sound ID to be played.
+ *
+ */
+function NPC_GetHitSound(mobile)
+	var mobile_template := NPC_GetNPCConfig(mobile);
+	var hit_sound_list := UnPack(mobile_template.AttackHitSounds);
+
+	if( TypeOf(hit_sound_list) != "Array" )
+		NPC_ErrorSysLog(mobile, "Invalid Hit Sound Setting");
+		return 0;
+	endif
+
+	return RandomInt(hit_sound_list.size())+1;
+
+endfunction
\ No newline at end of file

Modified: trunk/096/pkg/mobiles/brainAI/include/npcUtil.inc
===================================================================
--- trunk/096/pkg/mobiles/brainAI/include/npcUtil.inc	2005-11-01 08:14:19 UTC (rev 775)
+++ trunk/096/pkg/mobiles/brainAI/include/npcUtil.inc	2005-11-01 08:16:27 UTC (rev 776)
@@ -1,3 +1,6 @@
+/* $Id$
+ *
+ */
 /*===============================================================
 * Current Version
 * NPCUTIL.INC - v1.0

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-01 08:14:19 UTC (rev 775)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-01 08:16:27 UTC (rev 776)
@@ -12,17 +12,17 @@
 	AR		25
 	RunSpeed	200
 	Category	Testing
-	
+
 	// Attributes
 	Strength	100
 	Intelligence	1
 	Dexterity	10
-	
+
 	// Vitals
 	HITS		100
 	MANA		1
 	STAM		100
-		
+
 	AISetting	CycleWait	i10
 	AISetting	FleeLevel	i50 // 50%
 	AISetting	IdleTicks	i5
@@ -54,42 +54,117 @@
 
 NPCTemplate Rigger
 {
-	Name		a rigger
-	Script		:brainAI:brain
-	ObjType		0x27
-	Color		0
-	TrueColor	0
-	Gender		0
-	AR		1
-	RunSpeed	25
-	Category	Monster
-		
+	Name			a rigger
+	Script			:brainAI:brain
+	ObjType			0x27
+	Color			0
+	TrueColor		0
+	Gender			0
+	AR			1
+	RunSpeed		25
+	Category		Monster
+
 	// Attributes
-	Strength	15
-	Intelligence	5
-	Dexterity	35
-	Wrestling	35
-	Tactics		10
-	
+	Strength		15
+	Intelligence		5
+	Dexterity		35
+	Wrestling		35
+	Tactics			10
+
 	// Vitals
-	HITS		25
-	MANA		0
-	STAM		35
-	
-	AttackAttribute	Wrestling
-	AttackSpeed	20
-	AttackDamage	2d5
-	AttackHitSound	0x1A9
-	AttackMissSound	0x239
-	DeathSound	0x1AB
-	DamagedSound	0x1AA
-	
+	HITS			25
+	MANA			0
+	STAM			35
+
+	AttackAttribute		Wrestling
+	AttackSpeed		20
+	AttackDamage		2d5
+	AttackHitSounds		a1:i425
+	AttackMissSounds	a1:i569
+	DeathSounds		a1:i427
+	DamagedSounds		a1:i426
+
 	AIScript	Combat		:brainAI:scripts/combat/rigger
 	AIScript	EnterArea	:brainAI:scripts/enterArea/generic
 	AIScript	LeftArea	:brainAI:scripts/leftArea/generic
 	AIScript	LookAround	:brainAI:scripts/lookAround/findAttackables
 	AIScript	Sleep		:brainAI:scripts/sleep/generic
 	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/targetPlayers
-	
+
 	AttackHitScript		:combat:mainhitscript
 }
+
+##########################################
+# Farm type animals
+##########################################
+NPCTemplate	cow
+{
+	Name			a cow
+	Script			:brainAI:brain
+	ObjType			0xd8
+	Color			0
+	TrueColor		0
+	Gender			0
+	RunSpeed		15
+	Category		Animal
+
+	// Attributes
+	Strength		30
+	Intelligence		5
+	Dexterity		15
+	Anatomy			0.0
+	EvaluatingIntelligence	0.0
+	Magery			0.0
+	Meditation		0.0
+	Poisoning		0.0
+	ResistingSpells		5.5
+	Tactics			5.5
+	Wrestling		5.5
+
+	// Vitals
+	HITS			18
+	MANA			0
+	STAM			15
+
+	AttackAttribute		Wrestling
+	AttackSpeed		30
+	AttackDamage		1d4
+	AttackHitSounds		a1:i123
+	AttackMissSounds	a1:i0x239
+	DeathSounds		a1:i125
+	DamagedSounds		a1:i124
+	IdleSounds		a2:i121i122		// Sounds stored in Packed Array form
+
+	AR			9
+
+	food			veggie
+	foodtype		veggie
+	packinstinct		none
+
+	GuardIgnore		1
+	DStart			10
+	CorpseItm		rawribs hides
+	CorpseAmt		8 12
+	NoLoot			1
+
+	CProp  Karma		i0
+	CProp  Fame		i10
+
+	AISetting	FleeLevel	i50		// 50%
+	AISetting	IdleTicks	i5
+	AISetting	SleepWait	i1000
+	AISetting	ListenRange	i10
+	AISetting	AreaSize	i5
+	AISetting	DblClickRange	i1
+
+	AIScript	Combat		:brainAI:scripts/combat/genericAnimal
+	AIScript	DblClick	:brainAI:scripts/doubleClick/cowTip
+	AIScript	EnterArea	:brainAI:scripts/enterArea/generic
+	AIScript	LeftArea	:brainAI:scripts/leftArea/generic
+	AIScript	LookAround	:brainAI:scripts/lookAround/findFeared
+	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/watchFeared
+	AIScript	Sleep		:brainAI:scripts/sleep/generic
+	AIScript	EndFight	:brainAI:scripts/wonFight/wonFightAnimal
+
+	AttackHitScript		:combat:wrestlingHitScript
+}

Added: trunk/096/pkg/mobiles/brainAI/scripts/combat/genericAnimal.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/combat/genericAnimal.src	2005-11-01 08:14:19 UTC (rev 775)
+++ trunk/096/pkg/mobiles/brainAI/scripts/combat/genericAnimal.src	2005-11-01 08:16:27 UTC (rev 776)
@@ -0,0 +1,101 @@
+/* $Id$
+ *
+ */
+use uo;
+use os;
+
+include ":brainAI:npcNerves";
+include ":brainAI:npcCommands";
+include ":attributes:attributes";
+
+program BrainNerve(params)
+	var npc		:= params[1];
+	var nerve_name	:= params[2];
+	var event	:= params[3];
+	var settings	:= params[4];
+	var scripts	:= params[5];
+	params := 0; // Not needed anymore.
+
+	//Store it here so it does not have to do the math over and over.
+	var flee_level := AP_GetVitalMaximumValue(npc, "Hits") * (CDbl(settings["FleeLevel"])/100.0);
+
+	var opponent := event.source;
+	var flee_mode := 0;
+
+	AI_SetOpponent(npc, opponent);
+
+	while ( npc )
+		var dist := Distance(npc, opponent);
+		if ( ShouldFlee(npc, flee_level, flee_mode) )
+			flee_mode := 1;
+			AI_WarMode(npc, 0);
+			AI_Move(npc, opponent, NEMOVE_AWAY, NEMOVE_RUN, WAKEUP, 100);
+		elseif ( DoneFighting(npc, opponent, dist) )
+			if ( scripts.Exists("EndFight") )
+				params := array{opponent, settings, scripts};
+				AI_StartNerve(npc, "EndFight", scripts["EndFight"].script, params);
+			else
+				AI_WarMode(npc, 0);
+			endif
+			AI_EndNerve(npc, nerve_name);
+		elseif( dist > 1 )
+			AI_Move(npc, opponent, NEMOVE_TOWARD, NEMOVE_RUN, WAKEUP, dist+1);
+		endif
+
+		sleepms(400);
+		While ( Events_Waiting() )
+			CheckForEvent(npc, event);
+		endwhile
+	endwhile
+endprogram
+
+function DoneFighting(npc, opponent, byref dist)
+	if ( opponent.dead )
+		return 1;
+	elseif ( !opponent )
+		return 1;
+	elseif ( opponent.hidden )
+		return 1;
+	elseif ( opponent.concealed > npc.cmdlevel )
+		return 1;
+	elseif ( dist > 20 )
+		return 1;
+	elseif ( dist > 10 && !CheckLineOfSight(npc, opponent) )
+		return 1;
+	endif
+
+	return 0;
+endfunction
+
+function ShouldFlee(npc, byref flee_level, byref flee_mode)
+	if ( flee_mode )
+		return 1;
+	elseif ( AP_GetVital(npc, "Hits") < flee_level )
+		return 1;
+	endif
+
+	return 0;
+endfunction
+
+
+// Need more stuff here, should have events checked for peacemaking
+// and provocation.
+function CheckForEvent(npc, byref event)
+	// Temp added for stopping ecompile spam
+	npc := npc;
+	event := wait_for_event(0);
+	if ( event )
+		var source := event.source;
+		case ( event.type )
+			SYSEVENT_ENGAGED: source := source; // Added temp for stopping ecompile spam
+				break;
+			SYSEVENT_DAMAGED:
+				break;
+			default:
+				break;
+		endcase
+		event := 0;
+	endif
+
+	return 1;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/mobiles/brainAI/scripts/doubleClick/cowTip.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/doubleClick/cowTip.src	2005-11-01 08:14:19 UTC (rev 775)
+++ trunk/096/pkg/mobiles/brainAI/scripts/doubleClick/cowTip.src	2005-11-01 08:16:27 UTC (rev 776)
@@ -0,0 +1,64 @@
+/* $Id$
+ *
+ */
+///////////////////////////////////////////////
+// cowTip.src
+//
+// Created 7/26/2002 11:31AM
+// Updated 10/31/2005 11:25AM
+//
+// Creator: Austin Heilman
+// Last Update: MuadDib
+//
+///////////////////////////////////////////////
+//
+// This simply makes a double clicked cow tip over
+// when double clicked. It goes "mooo" in a whiny
+// sort of way too. Players from Wisconsin will
+// love it. Never tip a Californian cow though!
+// *ahem*
+//
+///////////////////////////////////////////////
+use uo;
+use os;
+
+include ":brainAI:npcNerves";
+include ":brainAI:npcCommands";
+
+program npcTip(params)
+	var npc		:= params[1];
+	//var nerve_name:= params[2];
+	var event	:= params[3];
+	//var settings	:= params[4];
+	//var scripts	:= params[5];
+	params := 0;
+
+	while ( npc )
+		if ( event )
+			case ( event.type )
+				SYSEVENT_DOUBLECLICKED:
+					CowTipEvent(npc, event);
+					break;
+				default:
+					break;
+			endcase
+
+			event := 0;
+		endif
+
+		sleepms(5);
+		event := wait_for_event(900000);
+	endwhile
+
+endprogram
+
+
+function CowTipEvent(npc, event)
+	PrintTextAbove(event.source, "*push*");
+	PlaySoundEffect(npc, 0x7D);
+	PerformAction(npc, 0x8);
+	sleep(2);
+	AI_Move(npc, event.source, NEMOVE_AWAY, NEMOVE_WALK, WAKEUP, 1);
+
+	return 1;
+endfunction

Added: trunk/096/pkg/mobiles/brainAI/scripts/lookAround/findFeared.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/lookAround/findFeared.src	2005-11-01 08:14:19 UTC (rev 775)
+++ trunk/096/pkg/mobiles/brainAI/scripts/lookAround/findFeared.src	2005-11-01 08:16:27 UTC (rev 776)
@@ -0,0 +1,54 @@
+/* $Id$
+ *
+ */
+use uo;
+use os;
+use util;
+
+include ":brainAI:npcNerves";
+include ":brainAI:npcCommands";
+include ":brainAI:npcWatchList";
+
+program BrainNerve(params)
+	var npc		:= params[1];
+	//var nerve_name	:= params[2];
+	var settings	:= params[4];
+	var scripts	:= params[5];
+	params := 0;
+
+	while ( npc )
+		if ( !npc.opponent )
+			if ( NPC_LoadWatchList(npc).size() < 1 )
+				// No need to look around any longer. We're all alone :(
+				return;
+			else
+				FindFearedOpponent(npc, settings, scripts);
+			endif
+		endif
+
+		AI_ClearThoughts(npc, CLR_NERVE);
+		Sleep(5);
+	endwhile
+endprogram
+
+function FindFearedOpponent(npc, byref settings, byref scripts)
+	var run_list := array;
+	foreach mobile in ListMobilesInLineOfSight(npc, CInt(settings["AreaSize"]))
+		if ( NPC_ShouldWatch(npc, mobile, settings, scripts) )
+			run_list.Append(mobile);
+		endif
+		sleepms(2);
+	endforeach
+
+	if ( run_list.size() > 0 )
+		var feared_one := run_list[RandomInt(run_list.Size())+1];
+		for i := 1 to CInt(settings["AreaSize"])
+			if( feared_one in ListMobilesInLineOfSight(npc, CInt(settings["AreaSize"])) )
+				AI_Move(npc, feared_one, NEMOVE_AWAY, NEMOVE_WALK, WAKEUP, 1);
+			endif
+		endfor
+		return feared_one;
+	endif
+
+	return 0;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/mobiles/brainAI/scripts/shouldWatch/watchFeared.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/shouldWatch/watchFeared.src	2005-11-01 08:14:19 UTC (rev 775)
+++ trunk/096/pkg/mobiles/brainAI/scripts/shouldWatch/watchFeared.src	2005-11-01 08:16:27 UTC (rev 776)
@@ -0,0 +1,29 @@
+/* $Id$
+ *
+ */
+include ":brainAI:npcNerves";
+include ":brainAI:npcCommands";
+include ":brainAI:npcWatchList";
+include ":brainAI:npcUtil";
+
+program BrainCriticalScript(params)
+	var npc := params[1];
+	var mobile := params[2];
+	//var settings := params[3];
+	params := 0; // Not needed anymore
+
+	if ( mobile.npctemplate )
+		var hate_config := ReadConfigFile(":brainAI:config/hatelist");
+		var config_list := FindConfigElem(hate_config, NPC_ParseTemplateName(npc.npctemplate).template);
+		var my_fear_list := GetConfigStringArray(config_list, "Fears");
+		if( !(NPC_ParseTemplateName(mobile.npctemplate).template in my_fear_list) )
+			return 0;
+		else
+			return 1;
+		endif
+	elseif ( mobile.connected )
+		return 1;
+	else
+		return 0;
+	endif
+endprogram

Modified: trunk/096/pkg/mobiles/brainAI/scripts/sleep/generic.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/sleep/generic.src	2005-11-01 08:14:19 UTC (rev 775)
+++ trunk/096/pkg/mobiles/brainAI/scripts/sleep/generic.src	2005-11-01 08:16:27 UTC (rev 776)
@@ -4,6 +4,7 @@
 
 include ":brainAI:npcNerves";
 include ":brainAI:npcCommands";
+include ":brainAI:npcSounds";
 
 program BrainNerve(params)
 	var npc		:= params[1];
@@ -11,7 +12,7 @@
 	var settings	:= params[3];
 	//var scripts	:= params[4];
 	params := 0; // Not needed anymore.
-	
+
 	// Shut down appropriate nerves.
 	foreach nerve in (LoadNerves(npc))
 		if ( nerve.flags & NF_CONTINUE_ON_SLEEP )
@@ -21,24 +22,20 @@
 		endif
 		sleepms(2);
 	endforeach
-	
+
 	while ( npc )
 		Sleep(30+RandomInt(10));
-		
-		if ( settings["idle_sound"] )
-			if ( settings["idle_sound"].size() > 0 )
-				var sounds := settings["idle_sound"];
-				PlaySoundEffect(npc, sounds[RandomInt(sounds.size())+1]);
-			else
-				PlaySoundEffect(npc, settings["idle_sound"]);
-			endif
+
+		var my_idle_sound := NPC_GetIdleSound(npc);
+		if ( my_idle_sound )
+			PlaySoundEffect(npc, my_idle_sound);
 		endif
-		
+
 		sleep(20+RandomInt(10));
-		
+
 		npc.facing := RandomInt(8);
 		AI_Wander(npc, NOWAKE);
-		
+
 		AI_ClearThoughts(npc, CLR_NERVE);
 	endwhile
 endprogram

Added: trunk/096/pkg/mobiles/brainAI/scripts/wonFight/wonFightAnimal.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/wonFight/wonFightAnimal.src	2005-11-01 08:14:19 UTC (rev 775)
+++ trunk/096/pkg/mobiles/brainAI/scripts/wonFight/wonFightAnimal.src	2005-11-01 08:16:27 UTC (rev 776)
@@ -0,0 +1,43 @@
+/* $Id$
+ *
+ */
+use uo;
+use os;
+
+include ":brainAI:npcNerves";
+include ":brainAI:npcCommands";
+include ":attributes:attributes";
+
+program BrainNerve(params)
+	var npc		:= params[1];
+	var nerve_name	:= params[2];
+	var opponent	:= params[3];
+	//var settings	:= params[4];
+	//var scripts	:= params[5];
+	params := 0; // Not needed anymore.
+
+	AI_WarMode(npc, 0);
+
+	var corpse := opponent.GetCorpse();
+	do
+		var dist := Distance(npc, corpse);
+		AI_Move(npc, corpse, NEMOVE_TOWARD, NEMOVE_WALK, dist);
+		sleep(dist-1);
+	dowhile( ShouldApproach(npc, opponent, corpse) );
+
+	AI_EndNerve(npc, nerve_name);
+endprogram
+
+function ShouldApproach(npc, opponent, corpse)
+	if ( !opponent )
+		return 0;
+	elseif ( !corpse )
+		return 0;
+	endif
+
+	if ( Distance(npc, corpse) > 1 )
+		return 1;
+	endif
+
+	return 0;
+endfunction



From muaddiblsd at berlios.de  Tue Nov  1 09:24:44 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Tue, 1 Nov 2005 09:24:44 +0100
Subject: [Poldistro-svn] r777 - trunk/096/pkg/mobiles/brainAI/scripts/sleep
Message-ID: <200511010824.jA18OiUn010427@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-01 09:24:40 +0100 (Tue, 01 Nov 2005)
New Revision: 777

Modified:
   trunk/096/pkg/mobiles/brainAI/scripts/sleep/generic.src
Log:


Modified: trunk/096/pkg/mobiles/brainAI/scripts/sleep/generic.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/sleep/generic.src	2005-11-01 08:16:27 UTC (rev 776)
+++ trunk/096/pkg/mobiles/brainAI/scripts/sleep/generic.src	2005-11-01 08:24:40 UTC (rev 777)
@@ -9,7 +9,7 @@
 program BrainNerve(params)
 	var npc		:= params[1];
 	var nerve_name	:= params[2];
-	var settings	:= params[3];
+	//var settings	:= params[3];
 	//var scripts	:= params[4];
 	params := 0; // Not needed anymore.
 



From austin at berlios.de  Tue Nov  1 09:47:45 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 09:47:45 +0100
Subject: [Poldistro-svn] r778 - trunk/096/pkg/mobiles/brainAI/scripts
Message-ID: <200511010847.jA18ljn2028688@sheep.berlios.de>

Author: austin
Date: 2005-11-01 09:47:43 +0100 (Tue, 01 Nov 2005)
New Revision: 778

Added:
   trunk/096/pkg/mobiles/brainAI/scripts/endFight/
Removed:
   trunk/096/pkg/mobiles/brainAI/scripts/wonFight/
Log:


Copied: trunk/096/pkg/mobiles/brainAI/scripts/endFight (from rev 777, trunk/096/pkg/mobiles/brainAI/scripts/wonFight)



From austin at berlios.de  Tue Nov  1 09:48:40 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 09:48:40 +0100
Subject: [Poldistro-svn] r779 - trunk/096/pkg/mobiles/brainAI/scripts/endFight
Message-ID: <200511010848.jA18meiA029897@sheep.berlios.de>

Author: austin
Date: 2005-11-01 09:48:38 +0100 (Tue, 01 Nov 2005)
New Revision: 779

Added:
   trunk/096/pkg/mobiles/brainAI/scripts/endFight/endFightAnimal.src
Removed:
   trunk/096/pkg/mobiles/brainAI/scripts/endFight/wonFightAnimal.src
Log:


Copied: trunk/096/pkg/mobiles/brainAI/scripts/endFight/endFightAnimal.src (from rev 778, trunk/096/pkg/mobiles/brainAI/scripts/endFight/wonFightAnimal.src)

Deleted: trunk/096/pkg/mobiles/brainAI/scripts/endFight/wonFightAnimal.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/endFight/wonFightAnimal.src	2005-11-01 08:47:43 UTC (rev 778)
+++ trunk/096/pkg/mobiles/brainAI/scripts/endFight/wonFightAnimal.src	2005-11-01 08:48:38 UTC (rev 779)
@@ -1,43 +0,0 @@
-/* $Id$
- *
- */
-use uo;
-use os;
-
-include ":brainAI:npcNerves";
-include ":brainAI:npcCommands";
-include ":attributes:attributes";
-
-program BrainNerve(params)
-	var npc		:= params[1];
-	var nerve_name	:= params[2];
-	var opponent	:= params[3];
-	//var settings	:= params[4];
-	//var scripts	:= params[5];
-	params := 0; // Not needed anymore.
-
-	AI_WarMode(npc, 0);
-
-	var corpse := opponent.GetCorpse();
-	do
-		var dist := Distance(npc, corpse);
-		AI_Move(npc, corpse, NEMOVE_TOWARD, NEMOVE_WALK, dist);
-		sleep(dist-1);
-	dowhile( ShouldApproach(npc, opponent, corpse) );
-
-	AI_EndNerve(npc, nerve_name);
-endprogram
-
-function ShouldApproach(npc, opponent, corpse)
-	if ( !opponent )
-		return 0;
-	elseif ( !corpse )
-		return 0;
-	endif
-
-	if ( Distance(npc, corpse) > 1 )
-		return 1;
-	endif
-
-	return 0;
-endfunction



From austin at berlios.de  Tue Nov  1 10:08:20 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 10:08:20 +0100
Subject: [Poldistro-svn] r780 - in trunk/096/pkg/mobiles/timedScripts: . include
Message-ID: <200511010908.jA198KaD014443@sheep.berlios.de>

Author: austin
Date: 2005-11-01 10:08:16 +0100 (Tue, 01 Nov 2005)
New Revision: 780

Modified:
   trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc
   trunk/096/pkg/mobiles/timedScripts/timerControl.src
Log:
Support for NPC death and Player Death
NPC death causes all sub-scripts to terminate then terminates the controller.

Modified: trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc	2005-11-01 08:48:38 UTC (rev 779)
+++ trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc	2005-11-01 09:08:16 UTC (rev 780)
@@ -10,8 +10,9 @@
 // Event flags
 const EVENT_ADD_TIMER			:= 0x1;
 const EVENT_LOWER_TIMER			:= 0x2;
-const EVENT_DEAD			:= 0x4;
-const EVENT_LOGOFF			:= 0x8;
+const EVENT_PLAYER_DIED			:= 0x4;
+const EVENT_NPC_DIED			:= 0x8;
+const EVENT_LOGOFF			:= 0x10;
 
 // Constants
 const NOSTART_CONTROLLER		:= 0x0;
@@ -349,7 +350,11 @@
  */
 function TS_Death(mobile)
 	var event := struct;
-	event.+type := EVENT_DEAD;
+	if ( mobile.IsA(POLCLASS_NPC) )
+		event.+EVENT_NPC_DIED;
+	else
+		event.+type := EVENT_PLAYER_DIED;
+	endif
 	
 	var process := TS_GetControllerProcess(mobile);
 	return process.SendEvent(event);

Modified: trunk/096/pkg/mobiles/timedScripts/timerControl.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/timerControl.src	2005-11-01 08:48:38 UTC (rev 779)
+++ trunk/096/pkg/mobiles/timedScripts/timerControl.src	2005-11-01 09:08:16 UTC (rev 780)
@@ -17,11 +17,7 @@
 	var timer_list := dictionary;
 	StartUp(mobile, timer_list, num_poisons);
 	
-	while ( mobile.IsA(POLCLASS_MOBILE) )
-		/* ^- Will terminate if:
-		 * 1. Mobile was an NPC and died.
-		 * 2. Was a player character but got deleted.
-		 */
+	while ( 1 )
 		mobile.SetPoisoned((num_poisons > 0));	
 		 
 		var event;
@@ -35,8 +31,11 @@
 			AddTimer(mobile, event, timer_list, num_poisons);
 		elseif( event.type == EVENT_LOWER_TIMER )
 			LowerDuration(mobile, event, timer_list, num_poisons);
-		elseif( event.type == EVENT_DEAD )
-			Death(mobile, timer_list, num_poisons);
+		elseif ( event.type == EVENT_NPC_DIED )
+			NPCDeath(timer_list);
+			break;
+		elseif( event.type == EVENT_PLAYER_DIED )
+			PlayerDeath(mobile, timer_list, num_poisons);
 		elseif ( event.type == EVENT_LOGOFF )
 			LogOff(mobile, timer_list);
 			break;
@@ -265,7 +264,16 @@
 	return 1;
 endfunction
 
-function Death(mobile, byref timer_list, byref num_poisons)
+function NPCDeath(byref timer_list)
+	foreach timer in ( timer_list )
+		GetProcess(timer.pid).Kill();
+		sleepms(2);
+	endforeach
+	
+	return 1;
+endfunction
+
+function PlayerDeath(mobile, byref timer_list, byref num_poisons)
 	set_critical(1);
 	foreach timer in ( timer_list )
 		timer := timer; // So the compiler does not issue warnings.



From austin at berlios.de  Tue Nov  1 10:10:59 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 10:10:59 +0100
Subject: [Poldistro-svn] r781 - in trunk/096/pkg/mobiles: death timedScripts/include
Message-ID: <200511010910.jA19Axqs014559@sheep.berlios.de>

Author: austin
Date: 2005-11-01 10:10:58 +0100 (Tue, 01 Nov 2005)
New Revision: 781

Modified:
   trunk/096/pkg/mobiles/death/npcdeath.src
   trunk/096/pkg/mobiles/death/plyrdeath.src
   trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc
Log:
Finished support for getting killed and proper terminations.

Modified: trunk/096/pkg/mobiles/death/npcdeath.src
===================================================================
--- trunk/096/pkg/mobiles/death/npcdeath.src	2005-11-01 09:08:16 UTC (rev 780)
+++ trunk/096/pkg/mobiles/death/npcdeath.src	2005-11-01 09:10:58 UTC (rev 781)
@@ -1,4 +1,4 @@
-/* $Id: death.src 402 2005-10-04 09:33:15Z panosl $
+/* $Id$
  *
  * Purpose
  * This script allows side effects to be triggered as a result of NPC death, like unmounting
@@ -13,12 +13,15 @@
 
 include "include/noto";
 include ":containers:merchantUtil";
+include ":timedscripts:timedScripts";
 include ":death:death";
 include ":mounts:mounts";
 
 program core_npcDeath(params)
 	var corpse := params[1];
 	
+	TS_Death(corpse); // Will still get the PID from the corpse.
+	
 	var template := GetObjProperty(corpse, "npctemplate"); // Set by the core.
 	var npc_cfg := NPC_GetNPCConfig(template);
 	var death_script := npc_cfg.DeathScript;

Modified: trunk/096/pkg/mobiles/death/plyrdeath.src
===================================================================
--- trunk/096/pkg/mobiles/death/plyrdeath.src	2005-11-01 09:08:16 UTC (rev 780)
+++ trunk/096/pkg/mobiles/death/plyrdeath.src	2005-11-01 09:10:58 UTC (rev 781)
@@ -1,4 +1,4 @@
-/* $Id: chrdeath.src 402 2005-10-04 09:33:15Z panosl $
+/* $Id$
  *
  * Purpose
  * This script allows side effects to be triggered as a result of Player death,
@@ -13,6 +13,7 @@
 include "include/noto";
 include "include/reportMurder";
 include ":attributes:attributes";
+include ":timedscripts:timedScripts";
 include ":death:death";
 include ":mounts:mounts";
 
@@ -20,6 +21,8 @@
 	var corpse := params[1];
 	var ghost := params[2];
 	
+	TS_Death(ghost);
+	
 	EraseObjProperty(ghost, "IsMeditating");
 	
 	DP_PlayDeathSound(ghost);

Modified: trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc	2005-11-01 09:08:16 UTC (rev 780)
+++ trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc	2005-11-01 09:10:58 UTC (rev 781)
@@ -350,10 +350,10 @@
  */
 function TS_Death(mobile)
 	var event := struct;
-	if ( mobile.IsA(POLCLASS_NPC) )
-		event.+EVENT_NPC_DIED;
-	else
+	if ( mobile.IsA(POLCLASS_MOBILE) )
 		event.+type := EVENT_PLAYER_DIED;
+	elseif ( mobile.IsA(POLCLASS_CORPSE) )
+		event.+type := EVENT_NPC_DIED;
 	endif
 	
 	var process := TS_GetControllerProcess(mobile);



From austin at berlios.de  Tue Nov  1 10:12:29 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 10:12:29 +0100
Subject: [Poldistro-svn] r782 - trunk/096/scripts/misc
Message-ID: <200511010912.jA19CTrQ014635@sheep.berlios.de>

Author: austin
Date: 2005-11-01 10:12:26 +0100 (Tue, 01 Nov 2005)
New Revision: 782

Modified:
   trunk/096/scripts/misc/logofftest.src
Log:
I nominate MuadDib to clean LogOffTest.src up!!!
Added timedscripts logoff event support.

Modified: trunk/096/scripts/misc/logofftest.src
===================================================================
--- trunk/096/scripts/misc/logofftest.src	2005-11-01 09:10:58 UTC (rev 781)
+++ trunk/096/scripts/misc/logofftest.src	2005-11-01 09:12:26 UTC (rev 782)
@@ -10,8 +10,11 @@
 include "include/eventID";
 include "include/innCheck";
 
+include ":timedscripts:timedScripts";
 
 program core_logoffTest(who)
+	TS_LogOff(who);
+	
 	if ((who.cmdlevel > 1) || (GetObjProperty(who,"justbanned")))
 		return 0;
 	endif



From austin at berlios.de  Tue Nov  1 18:20:30 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 18:20:30 +0100
Subject: [Poldistro-svn] r783 - trunk/096/scripts/include
Message-ID: <200511011720.jA1HKUHJ023616@sheep.berlios.de>

Author: austin
Date: 2005-11-01 18:20:30 +0100 (Tue, 01 Nov 2005)
New Revision: 783

Removed:
   trunk/096/scripts/include/attributes.inc
Log:
Time to force the conversion from this to the new attribs system.

Deleted: trunk/096/scripts/include/attributes.inc
===================================================================
--- trunk/096/scripts/include/attributes.inc	2005-11-01 09:12:26 UTC (rev 782)
+++ trunk/096/scripts/include/attributes.inc	2005-11-01 17:20:30 UTC (rev 783)
@@ -1,1012 +0,0 @@
-use uo;
-use os;
-use math;
-use util;
-use cfgfile;
-
-include "include/client";
-include "include/eventID";
-
-const CFGFILESPEC_SKILLSDEF        := ":hooks:skillsdef";
-const CORE_SETTINGS_MIN_ATTRIBUTE  := 0;
-const CORE_SETTINGS_MAX_ATTRIBUTE  := 60000;
-const CORE_SETTINGS_MIN_VITAL      := 100;
-const CORE_SETTINGS_MAX_VITAL      := 10000000;
-const CORE_SETTINGS_MIN_REGEN_RATE := -30000;
-const CORE_SETTINGS_MAX_REGEN_RATE := 30000;
-const CPROP_NAME_PREFIX_REGEN_RATE := "NewRegenRateFor";
-const ATTRIBUTEID_ALCHEMY          := "alchemy";
-const ATTRIBUTEID_ANATOMY          := "anatomy";
-const ATTRIBUTEID_ANIMALLORE       := "animallore";
-const ATTRIBUTEID_ARCHERY          := "archery";
-const ATTRIBUTEID_ARMSLORE         := "armslore";
-const ATTRIBUTEID_BEGGING          := "begging";
-const ATTRIBUTEID_BLACKSMITHY      := "blacksmithy";
-const ATTRIBUTEID_BOWCRAFT         := "bowcraft";
-const ATTRIBUTEID_CAMPING          := "camping";
-const ATTRIBUTEID_CARPENTRY        := "carpentry";
-const ATTRIBUTEID_CARTOGRAPHY      := "cartography";
-const ATTRIBUTEID_COOKING          := "cooking";
-const ATTRIBUTEID_DETECTINGHIDDEN  := "detectinghidden";
-const ATTRIBUTEID_DETECTINGHIDDENALIAS := "detecthidden";
-const ATTRIBUTEID_ENTICEMENT       := "enticement";
-const ATTRIBUTEID_EVALINT    	   := "evaluatingintelligence";
-const ATTRIBUTEID_EVALINTALIAS1    := "evaluatingint";
-const ATTRIBUTEID_EVALINTALIAS2    := "evalint";
-const ATTRIBUTEID_FENCING          := "fencing";
-const ATTRIBUTEID_FISHING          := "fishing";
-const ATTRIBUTEID_FORENSICS        := "forensicevaluation";
-const ATTRIBUTEID_FORENSICSALIAS1  := "forensiceval";
-const ATTRIBUTEID_FORENSICSALIAS2  := "forensics";
-const ATTRIBUTEID_HEALING          := "healing";
-const ATTRIBUTEID_HERDING          := "herding";
-const ATTRIBUTEID_HIDING           := "hiding";
-const ATTRIBUTEID_INSCRIPTION      := "inscription";
-const ATTRIBUTEID_ITEMID           := "itemid";
-const ATTRIBUTEID_LOCKPICKING      := "lockpicking";
-const ATTRIBUTEID_LUMBERJACKING    := "lumberjacking";
-const ATTRIBUTEID_MACEFIGHTING     := "macefighting";
-const ATTRIBUTEID_MACEFIGHTINGALIAS := "mace";
-const ATTRIBUTEID_MAGERY           := "magery";
-const ATTRIBUTEID_MAGICRESISTANCE  := "magicresistance";
-const ATTRIBUTEID_MAGICRESISTANCEALIAS1 := "magicresist";
-const ATTRIBUTEID_MAGICRESISTANCEALIAS2 := "resistingspells";
-const ATTRIBUTEID_MAGICRESISTANCEALIAS3 := "resist";
-const ATTRIBUTEID_MEDITATION       := "meditation";
-const ATTRIBUTEID_MINING           := "mining";
-const ATTRIBUTEID_MUSICIANSHIP     := "musicianship";
-const ATTRIBUTEID_PARRY            := "parry";
-const ATTRIBUTEID_PEACEMAKING      := "peacemaking";
-const ATTRIBUTEID_POISONING        := "poisoning";
-const ATTRIBUTEID_PROVOCATION      := "provocation";
-const ATTRIBUTEID_REMOVETRAP       := "removetrap";
-const ATTRIBUTEID_SNOOPING         := "snooping";
-const ATTRIBUTEID_SPIRITSPEAK      := "spiritspeak";
-const ATTRIBUTEID_STEALING         := "stealing";
-const ATTRIBUTEID_STEALTH          := "stealth";
-const ATTRIBUTEID_SWORDSMANSHIP    := "swordsmanship";
-const ATTRIBUTEID_SWORDSMANSHIPALIAS := "swords";
-const ATTRIBUTEID_TACTICS          := "tactics";
-const ATTRIBUTEID_TAILORING        := "tailoring";
-const ATTRIBUTEID_TAMING           := "animaltaming";
-const ATTRIBUTEID_TASTEID          := "tasteidentification";
-const ATTRIBUTEID_TINKERING        := "tinkering";
-const ATTRIBUTEID_TRACKING         := "tracking";
-const ATTRIBUTEID_VETERINARY       := "veterinary";
-const ATTRIBUTEID_WRESTLING        := "wrestling";
-const ATTRIBUTEID_DEXTERITY        := "dexterity";
-const ATTRIBUTEID_INTELLIGENCE     := "intelligence";
-const ATTRIBUTEID_STRENGTH         := "strength";
-
-// AOS ATTRIBUTES
-const ATTRIBUTEID_NECROMANCY       := "necromancy";
-const ATTRIBUTEID_CHIVALRY         := "chivalry";
-const ATTRIBUTEID_FOCUS            := "focus";
-
-const VITALID_LIFE                 := "Life";
-const VITALID_MANA                 := "Mana";
-const VITALID_STAMINA              := "Stamina";
-
-Function DoRecalcVitals( mob )
-  set_critical(1);
-  if(mob.acctname)
-    if(mob.ip)
-      RecalcVitals(mob);
-    endif
-  else
-    RecalcVitals(mob);
-  endif
-  set_critical(0);
-endfunction
-
-function ApplyManaDamage(who, dmg)
-  return SetMana(who, GetMana(who)-dmg);
-endfunction
-
-function ApplyStaminaDamage(who, dmg)
-  return SetStamina(who, GetStamina(who)-dmg);
-endfunction
-
-function AwardPoints(who, skillid, skillpoints)
-  if(!who.isA(POLCLASS_MOBILE))
-    return 0;
-  elseif(Cint(skillid)== error)
-    return 0;
-  endif
-  skillid := Cint(skillid);
-  var elem := GetSkillConfigElem(skillid);
-  if(!elem)
-    return elem;
-  endif
-  var attributeid := GetAttributeIdBySkillId(skillid);
-  if((attributeid != ATTRIBUTEID_STRENGTH) and (attributeid != ATTRIBUTEID_DEXTERITY) and (attributeid != ATTRIBUTEID_INTELLIGENCE))
-    if(!who.npctemplate)
-      var skillarray := GetObjProperty(who,"SkillArray");
-      if(!skillarray)
-        skillarray := {};
-        foreach thing in GetAttributeIdsWithoutStatIds()
-          if(GetAttributeBaseValue(who, thing) > 0)
-            skillarray.append(GetSkillIdByAttributeId(thing));
-          endif
-        endforeach
-        SetObjProperty(who,"SkillArray", skillarray);
-      endif
-      var skill := GetSkillIdByAttributeId(attributeid);
-      var newarray := {};
-      foreach thing in skillarray
-        if((thing != skill) and (GetBaseSkill(who, thing) > 0))
-          newarray.append(thing);
-        endif
-      endforeach
-      newarray.append(skill);
-      skillarray := newarray;
-      SetObjProperty(who,"SkillArray", skillarray);
-    endif
-  endif
-  AwardRawAttributePoints(who, attributeid, skillpoints, skillid);
-  var adv := elem.StrAdv;
-  if(adv)
-    adv := SplitWords(adv);
-    if(RandomInt(1000)< Cdbl(adv[1])*10)
-      AwardRawAttributePoints(who, ATTRIBUTEID_STRENGTH, RandomDiceRoll(adv[2]), skillid);
-    endif
-  endif
-  adv := 0;
-  adv := elem.DexAdv;
-  if(adv)
-    adv := SplitWords(adv);
-    if(RandomInt(1000)< Cdbl(adv[1])*10)
-      AwardRawAttributePoints(who, ATTRIBUTEID_DEXTERITY, RandomDiceRoll(adv[2]), skillid);
-    endif
-  endif
-  adv := 0;
-  adv := elem.IntAdv;
-  if(adv)
-    adv := SplitWords(adv);
-    if(RandomInt(1000)< Cdbl(adv[1])*10)
-      AwardRawAttributePoints(who, ATTRIBUTEID_INTELLIGENCE, RandomDiceRoll(adv[2]), skillid);
-    endif
-  endif
-  return 1;
-endfunction
-
-function AwardRawAttributePoints(who, attributeid, rawpoints, skillid)
-  if(!who.isA(POLCLASS_MOBILE))
-    var ret := error;
-    ret.+errortext := "Invalid parameter type: " + who + " isn't a mobileref.";
-    return ret;
-  endif
-  rawpoints := Cdbl(rawpoints);
-  if(rawpoints == error)
-    return rawpoints;
-  elseif(rawpoints == 0.0)
-    return 1;
-  endif
-  set_critical(1);
-  var initial := GetAttributeBaseValue(who, attributeid);
-  var current := initial;
-  if(rawpoints > 0)
-    var to_increase := GetNeededRawPointsToIncrease(current);
-    while(rawpoints >= to_increase)
-      rawpoints  := rawpoints - to_increase;
-      current    := current + 1;
-      to_increase := GetNeededRawPointsToIncrease(current);
-    endwhile
-    if(RandomInt(Cint(to_increase)) < rawpoints)
-      current := current + 1;
-    endif
-  elseif(rawpoints < 0)
-    var to_decrease  := GetNeededRawPointsToIncrease(current-1);
-    while(rawpoints >= to_decrease && current > 0)
-      rawpoints  := rawpoints - to_decrease;
-      current    := current - 1;
-      to_decrease  := GetNeededRawPointsToIncrease(current-1);
-    endwhile
-    if(RandomInt(Cint(to_decrease))< rawpoints)
-      current := current - 1;
-    endif
-  endif
-  if(current != initial)
-    if(who.acctname)
-      if(current > CORE_SETTINGS_MAX_ATTRIBUTE)
-        current := CORE_SETTINGS_MAX_ATTRIBUTE;
-      endif
-      var pid := getprocess(GetObjProperty(who, "cap_pid"));
-      var k := struct;
-      if((attributeid == ATTRIBUTEID_STRENGTH) or (attributeid == ATTRIBUTEID_DEXTERITY) or (attributeid == ATTRIBUTEID_INTELLIGENCE))
-        k.+skid   := attributeid;
-        k.+skil   := skillid;
-        k.+type   := EVID_STATCAP;
-        k.+base   := current;
-        pid.sendevent(k);
-      else
-        k.+skid   := attributeid;
-        k.+type   := EVID_SKILLCAP;
-        k.+base   := current;
-        pid.sendevent(k);
-      endif
-    else
-      SetAttributeBaseValue(who, attributeid, current);
-    endif
-    DoRecalcVitals(who);
-  endif
-  set_critical(0);
-  return 1;
-endfunction
-
-function AwardRawSkillPoints(who, skillid, rawpoints)
-  return AwardRawAttributePoints(who, GetAttributeIdBySkillId(skillid), rawpoints, skillid);
-endfunction
-
-function BaseToRawSkill(basevalue)
-  if(basevalue <= 200)
-    var rawvalue := basevalue * 20.48;
-    if(rawvalue > Cint(rawvalue))
-      return Cint(rawvalue + 1);
-    else
-      return Cint(rawvalue);
-    endif
-  else
-    var scale  := basevalue / 100.0;
-    var remain   := scale - Cint(scale);
-    return Cint(Pow(2, Cint(scale))*(1024 *(1.0 + remain)+ 1));
-  endif
-endfunction
-
-function GetAttributeIdBySkillId(skillid)
-  case(skillid)
-    SKILLID_ALCHEMY:    return ATTRIBUTEID_ALCHEMY;
-    SKILLID_ANATOMY:    return ATTRIBUTEID_ANATOMY;
-    SKILLID_ANIMALLORE:    return ATTRIBUTEID_ANIMALLORE;
-    SKILLID_ITEMID:      return ATTRIBUTEID_ITEMID;
-    SKILLID_ARMSLORE:    return ATTRIBUTEID_ARMSLORE;
-    SKILLID_PARRY:      return ATTRIBUTEID_PARRY;
-    SKILLID_BEGGING:    return ATTRIBUTEID_BEGGING;
-    SKILLID_BLACKSMITHY:    return ATTRIBUTEID_BLACKSMITHY;
-    SKILLID_BOWCRAFT:    return ATTRIBUTEID_BOWCRAFT;
-    SKILLID_PEACEMAKING:    return ATTRIBUTEID_PEACEMAKING;
-    SKILLID_CAMPING:    return ATTRIBUTEID_CAMPING;
-    SKILLID_CARPENTRY:    return ATTRIBUTEID_CARPENTRY;
-    SKILLID_CARTOGRAPHY:    return ATTRIBUTEID_CARTOGRAPHY;
-    SKILLID_COOKING:    return ATTRIBUTEID_COOKING;
-    SKILLID_DETECTINGHIDDEN:  return ATTRIBUTEID_DETECTINGHIDDEN;
-    SKILLID_ENTICEMENT:    return ATTRIBUTEID_ENTICEMENT;
-    SKILLID_EVALINT:    return ATTRIBUTEID_EVALINT;
-    SKILLID_HEALING:    return ATTRIBUTEID_HEALING;
-    SKILLID_FISHING:    return ATTRIBUTEID_FISHING;
-    SKILLID_FORENSICS:    return ATTRIBUTEID_FORENSICS;
-    SKILLID_HERDING:    return ATTRIBUTEID_HERDING;
-    SKILLID_HIDING:      return ATTRIBUTEID_HIDING;
-    SKILLID_PROVOCATION:    return ATTRIBUTEID_PROVOCATION;
-    SKILLID_INSCRIPTION:    return ATTRIBUTEID_INSCRIPTION;
-    SKILLID_LOCKPICKING:    return ATTRIBUTEID_LOCKPICKING;
-    SKILLID_MAGERY:      return ATTRIBUTEID_MAGERY;
-    SKILLID_MAGICRESISTANCE:  return ATTRIBUTEID_MAGICRESISTANCE;
-    SKILLID_TACTICS:    return ATTRIBUTEID_TACTICS;
-    SKILLID_SNOOPING:    return ATTRIBUTEID_SNOOPING;
-    SKILLID_MUSICIANSHIP:    return ATTRIBUTEID_MUSICIANSHIP;
-    SKILLID_POISONING:    return ATTRIBUTEID_POISONING;
-    SKILLID_ARCHERY:    return ATTRIBUTEID_ARCHERY;
-    SKILLID_SPIRITSPEAK:    return ATTRIBUTEID_SPIRITSPEAK;
-    SKILLID_STEALING:    return ATTRIBUTEID_STEALING;
-    SKILLID_TAILORING:    return ATTRIBUTEID_TAILORING;
-    SKILLID_TAMING:      return ATTRIBUTEID_TAMING;
-    SKILLID_TASTEID:    return ATTRIBUTEID_TASTEID;
-    SKILLID_TINKERING:    return ATTRIBUTEID_TINKERING;
-    SKILLID_TRACKING:    return ATTRIBUTEID_TRACKING;
-    SKILLID_VETERINARY:    return ATTRIBUTEID_VETERINARY;
-    SKILLID_SWORDSMANSHIP:    return ATTRIBUTEID_SWORDSMANSHIP;
-    SKILLID_MACEFIGHTING:    return ATTRIBUTEID_MACEFIGHTING;
-    SKILLID_FENCING:    return ATTRIBUTEID_FENCING;
-    SKILLID_WRESTLING:    return ATTRIBUTEID_WRESTLING;
-    SKILLID_LUMBERJACKING:    return ATTRIBUTEID_LUMBERJACKING;
-    SKILLID_MINING:      return ATTRIBUTEID_MINING;
-    SKILLID_MEDITATION:    return ATTRIBUTEID_MEDITATION;
-    SKILLID_STEALTH:    return ATTRIBUTEID_STEALTH;
-    SKILLID_REMOVETRAP:    return ATTRIBUTEID_REMOVETRAP;
-    SKILLID_NECROMANCY:    return ATTRIBUTEID_NECROMANCY;
-    SKILLID_CHIVALRY:   return ATTRIBUTEID_CHIVALRY;
-    SKILLID_FOCUS:      return ATTRIBUTEID_FOCUS;
-  endcase
-  var ret        := error;
-  ret.+errortext := "No equivalent attributeid found for skillid " + skillid;
-  return ret;
-endfunction
-
-function GetAttributeIds()
-  return { ATTRIBUTEID_ALCHEMY,
-     ATTRIBUTEID_ANATOMY,
-     ATTRIBUTEID_ANIMALLORE,
-     ATTRIBUTEID_ARCHERY,
-     ATTRIBUTEID_ARMSLORE,
-     ATTRIBUTEID_BEGGING,
-     ATTRIBUTEID_BLACKSMITHY,
-     ATTRIBUTEID_BOWCRAFT,
-     ATTRIBUTEID_CAMPING,
-     ATTRIBUTEID_CARPENTRY,
-     ATTRIBUTEID_CARTOGRAPHY,
-     ATTRIBUTEID_COOKING,
-     ATTRIBUTEID_DETECTINGHIDDEN,
-     ATTRIBUTEID_DEXTERITY,
-     ATTRIBUTEID_ENTICEMENT,
-     ATTRIBUTEID_EVALINT,
-     ATTRIBUTEID_FENCING,
-     ATTRIBUTEID_FISHING,
-     ATTRIBUTEID_FORENSICS,
-     ATTRIBUTEID_HEALING,
-     ATTRIBUTEID_HERDING,
-     ATTRIBUTEID_HIDING,
-     ATTRIBUTEID_INSCRIPTION,
-     ATTRIBUTEID_INTELLIGENCE,
-     ATTRIBUTEID_ITEMID,
-     ATTRIBUTEID_LOCKPICKING,
-     ATTRIBUTEID_LUMBERJACKING,
-     ATTRIBUTEID_MACEFIGHTING,
-     ATTRIBUTEID_MAGERY,
-     ATTRIBUTEID_MAGICRESISTANCE,
-     ATTRIBUTEID_MEDITATION,
-     ATTRIBUTEID_MINING,
-     ATTRIBUTEID_MUSICIANSHIP,
-     ATTRIBUTEID_PARRY,
-     ATTRIBUTEID_PEACEMAKING,
-     ATTRIBUTEID_POISONING,
-     ATTRIBUTEID_PROVOCATION,
-     ATTRIBUTEID_REMOVETRAP,
-     ATTRIBUTEID_SNOOPING,
-     ATTRIBUTEID_SPIRITSPEAK,
-     ATTRIBUTEID_STEALING,
-     ATTRIBUTEID_STEALTH,
-     ATTRIBUTEID_STRENGTH,
-     ATTRIBUTEID_SWORDSMANSHIP,
-     ATTRIBUTEID_TACTICS,
-     ATTRIBUTEID_TAILORING,
-     ATTRIBUTEID_TAMING,
-     ATTRIBUTEID_TASTEID,
-     ATTRIBUTEID_TINKERING,
-     ATTRIBUTEID_TRACKING,
-     ATTRIBUTEID_VETERINARY,
-     ATTRIBUTEID_WRESTLING,
-     ATTRIBUTEID_NECROMANCY,
-     ATTRIBUTEID_CHIVALRY,
-     ATTRIBUTEID_FOCUS };
-endfunction
-
-function AlterDexterityMod(who, delta)
-  var ret := AlterAttributeTemporaryMod(who, ATTRIBUTEID_DEXTERITY, Cint(delta*10));
-  if(ret)
-    DoRecalcVitals(who);
-  endif
-  return ret;
-endfunction
-
-function AlterIntelligenceMod(who, delta)
-  var ret := AlterAttributeTemporaryMod(who, ATTRIBUTEID_INTELLIGENCE, Cint(delta*10));
-  if(ret)
-    DoRecalcVitals(who);
-  endif
-  return ret;
-endfunction
-
-function AlterSkillTemporaryMod(who, skillid, delta)
-  return AlterAttributeTemporaryMod(who, GetAttributeIdBySkillId(skillid), Cint(delta*10));
-endfunction
-
-function AlterSkillTemporaryModBaseValue(who, skillid, delta_tenth)
-  return AlterAttributeTemporaryMod(who, GetAttributeIdBySkillId(skillid), delta_tenth);
-endfunction
-
-function AlterStrengthMod(who, delta)
-  var ret := AlterAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH, Cint(delta*10));
-  if(ret)
-    DoRecalcVitals(who);
-  endif
-  return ret;
-endfunction
-
-function GetBaseDexterity(who)
-  return Cint(GetAttributeBaseValue(who, ATTRIBUTEID_DEXTERITY)/ 10);
-endfunction
-
-function GetBaseIntelligence(who)
-  return Cint(GetAttributeBaseValue(who, ATTRIBUTEID_INTELLIGENCE)/ 10);
-endfunction
-
-function GetBaseSkill(who, skillid)
-  return Cint(GetBaseSkillBaseValue(who, skillid)/ 10);
-endfunction
-
-function GetBaseSkillBaseValue(who, skillid)
-  return GetAttributeBaseValue(who, GetAttributeIdBySkillId(skillid));
-endfunction
-
-function GetBaseStrength(who)
-  return Cint(GetAttributeBaseValue(who, ATTRIBUTEID_STRENGTH)/ 10);
-endfunction
-
-function GetDefaultPointsValue(skillid)
-        var elem := GetSkillConfigElem(skillid);
-  if(!elem)
-    return 0;
-  else
-    return Cint(elem.DefaultPoints);
-  endif
-endfunction
-
-function GetDexterity(who)
-  return GetAttribute(who, ATTRIBUTEID_DEXTERITY);
-endfunction
-
-function GetDexterityMod(who)
-  return Cint(GetAttributeTemporaryMod(who, ATTRIBUTEID_DEXTERITY)/ 10);
-endfunction
-
-function GetEffectiveSkill(who, skillid)
-  return GetAttribute(who, GetAttributeIdBySkillId(skillid));
-endfunction
-
-function GetEffectiveSkillBaseValue(who, skillid)
-  var attributeid  := GetAttributeIdBySkillId(skillid);
-  var baseskill  := GetAttributeBaseValue(who, attributeid);
-  var tempmod  := GetAttributeTemporaryMod(who, attributeid);
-  var intinsicmod  := GetAttributeIntrinsicMod(who, attributeid);
-  var effective  := Cint(baseskill + tempmod + intinsicmod);
-  if(effective < 0)
-    return 0;
-  else
-    return effective;
-  endif
-endfunction
-
-function GetHp(who)
-  return Cint(GetVital(who, VITALID_LIFE)/ 100);
-endfunction
-
-function GetIntelligence(who)
-  return GetAttribute(who, ATTRIBUTEID_INTELLIGENCE);
-endfunction
-
-function GetIntelligenceMod(who)
-  return Cint(GetAttributeTemporaryMod(who, ATTRIBUTEID_INTELLIGENCE)/ 10);
-endfunction
-
-function GetMana(who)
-  return(GetVital(who, "Mana")/ 100);
-endfunction
-
-function GetMaxHp(who)
-  return Cint(GetVitalMaximumValue(who, VITALID_LIFE)/ 100);
-endfunction
-
-function GetMaxMana(who)
-  return Cint(GetVitalMaximumValue(who, VITALID_MANA)/ 100);
-endfunction
-
-function GetMaxStamina(who)
-  return Cint(GetVitalMaximumValue(who, VITALID_STAMINA)/ 100);
-endfunction
-
-function GetNeededRawPointsToIncrease(basevalue)
-  if(basevalue < 200)
-    return 20.48;
-  elseif(basevalue >= 2800)
-    return Cdbl(0x7fffffff);
-  else
-    return Cdbl(Pow(2.0, Cint(basevalue/100))* 10.24);
-  endif
-endfunction
-
-function GetSkillConfigElem(skillid)
-  var skdefcfg := ReadConfigFile(CFGFILESPEC_SKILLSDEF);
-  if(!skdefcfg)
-    return skdefcfg;
-  else
-    return FindConfigElem(skdefcfg, skillid);
-  endif
-endfunction
-
-function GetAttributeIdsWithoutStatIds()
-  return { ATTRIBUTEID_ALCHEMY,
-     ATTRIBUTEID_ANATOMY,
-     ATTRIBUTEID_ANIMALLORE,
-     ATTRIBUTEID_ARCHERY,
-     ATTRIBUTEID_ARMSLORE,
-     ATTRIBUTEID_BEGGING,
-     ATTRIBUTEID_BLACKSMITHY,
-     ATTRIBUTEID_BOWCRAFT,
-     ATTRIBUTEID_CAMPING,
-     ATTRIBUTEID_CARPENTRY,
-     ATTRIBUTEID_CARTOGRAPHY,
-     ATTRIBUTEID_COOKING,
-     ATTRIBUTEID_DETECTINGHIDDEN,
-     ATTRIBUTEID_ENTICEMENT,
-     ATTRIBUTEID_EVALINT,
-     ATTRIBUTEID_FENCING,
-     ATTRIBUTEID_FISHING,
-     ATTRIBUTEID_FORENSICS,
-     ATTRIBUTEID_HEALING,
-     ATTRIBUTEID_HERDING,
-     ATTRIBUTEID_HIDING,
-     ATTRIBUTEID_INSCRIPTION,
-     ATTRIBUTEID_ITEMID,
-     ATTRIBUTEID_LOCKPICKING,
-     ATTRIBUTEID_LUMBERJACKING,
-     ATTRIBUTEID_MACEFIGHTING,
-     ATTRIBUTEID_MAGERY,
-     ATTRIBUTEID_MAGICRESISTANCE,
-     ATTRIBUTEID_MEDITATION,
-     ATTRIBUTEID_MINING,
-     ATTRIBUTEID_MUSICIANSHIP,
-     ATTRIBUTEID_PARRY,
-     ATTRIBUTEID_PEACEMAKING,
-     ATTRIBUTEID_POISONING,
-     ATTRIBUTEID_PROVOCATION,
-     ATTRIBUTEID_REMOVETRAP,
-     ATTRIBUTEID_SNOOPING,
-     ATTRIBUTEID_SPIRITSPEAK,
-     ATTRIBUTEID_STEALING,
-     ATTRIBUTEID_STEALTH,
-     ATTRIBUTEID_SWORDSMANSHIP,
-     ATTRIBUTEID_TACTICS,
-     ATTRIBUTEID_TAILORING,
-     ATTRIBUTEID_TAMING,
-     ATTRIBUTEID_TASTEID,
-     ATTRIBUTEID_TINKERING,
-     ATTRIBUTEID_TRACKING,
-     ATTRIBUTEID_VETERINARY,
-     ATTRIBUTEID_WRESTLING,
-     ATTRIBUTEID_NECROMANCY,
-     ATTRIBUTEID_CHIVALRY,
-     ATTRIBUTEID_FOCUS };
-endfunction
-
-function GetHpRegenRate(who)
-  return GetVitalRegenRate(who, VITALID_LIFE);
-endfunction
-
-function GetManaRegenRate(who)
-  return GetVitalRegenRate(who, VITALID_MANA);
-endfunction
-
-function GetSkillIdByAttributeId(attributeid)
-  case(Lower(attributeid))
-    ATTRIBUTEID_ALCHEMY:    return SKILLID_ALCHEMY;
-    ATTRIBUTEID_ANATOMY:    return SKILLID_ANATOMY;
-    ATTRIBUTEID_ANIMALLORE:    return SKILLID_ANIMALLORE;
-    ATTRIBUTEID_ITEMID:    return SKILLID_ITEMID;
-    ATTRIBUTEID_ARMSLORE:    return SKILLID_ARMSLORE;
-    ATTRIBUTEID_PARRY:    return SKILLID_PARRY;
-    ATTRIBUTEID_BEGGING:    return SKILLID_BEGGING;
-    ATTRIBUTEID_BLACKSMITHY:  return SKILLID_BLACKSMITHY;
-    ATTRIBUTEID_BOWCRAFT:    return SKILLID_BOWCRAFT;
-    ATTRIBUTEID_PEACEMAKING:  return SKILLID_PEACEMAKING;
-    ATTRIBUTEID_CAMPING:    return SKILLID_CAMPING;
-    ATTRIBUTEID_CARPENTRY:    return SKILLID_CARPENTRY;
-    ATTRIBUTEID_CARTOGRAPHY:  return SKILLID_CARTOGRAPHY;
-    ATTRIBUTEID_COOKING:    return SKILLID_COOKING;
-    ATTRIBUTEID_DETECTINGHIDDEN:
-    ATTRIBUTEID_DETECTINGHIDDENALIAS:
-      return SKILLID_DETECTINGHIDDEN;
-    ATTRIBUTEID_ENTICEMENT:    return SKILLID_ENTICEMENT;
-    ATTRIBUTEID_EVALINT:
-    ATTRIBUTEID_EVALINTALIAS1:
-    ATTRIBUTEID_EVALINTALIAS2:
-      return SKILLID_EVALINT;
-    ATTRIBUTEID_HEALING:    return SKILLID_HEALING;
-    ATTRIBUTEID_FISHING:    return SKILLID_FISHING;
-    ATTRIBUTEID_FORENSICS:
-    ATTRIBUTEID_FORENSICSALIAS1:
-    ATTRIBUTEID_FORENSICSALIAS2:
-      return SKILLID_FORENSICS;
-    ATTRIBUTEID_HERDING:    return SKILLID_HERDING;
-    ATTRIBUTEID_HIDING:    return SKILLID_HIDING;
-    ATTRIBUTEID_PROVOCATION:  return SKILLID_PROVOCATION;
-    ATTRIBUTEID_INSCRIPTION:  return SKILLID_INSCRIPTION;
-    ATTRIBUTEID_LOCKPICKING:  return SKILLID_LOCKPICKING;
-    ATTRIBUTEID_MAGERY:    return SKILLID_MAGERY;
-    ATTRIBUTEID_MAGICRESISTANCE:
-    ATTRIBUTEID_MAGICRESISTANCEALIAS1:
-    ATTRIBUTEID_MAGICRESISTANCEALIAS2:
-    ATTRIBUTEID_MAGICRESISTANCEALIAS3:
-      return SKILLID_MAGICRESISTANCE;
-    ATTRIBUTEID_TACTICS:    return SKILLID_TACTICS;
-    ATTRIBUTEID_SNOOPING:    return SKILLID_SNOOPING;
-    ATTRIBUTEID_MUSICIANSHIP:  return SKILLID_MUSICIANSHIP;
-    ATTRIBUTEID_POISONING:    return SKILLID_POISONING;
-    ATTRIBUTEID_ARCHERY:    return SKILLID_ARCHERY;
-    ATTRIBUTEID_SPIRITSPEAK:  return SKILLID_SPIRITSPEAK;
-    ATTRIBUTEID_STEALING:    return SKILLID_STEALING;
-    ATTRIBUTEID_TAILORING:    return SKILLID_TAILORING;
-    ATTRIBUTEID_TAMING:    return SKILLID_TAMING;
-    ATTRIBUTEID_TASTEID:    return SKILLID_TASTEID;
-    ATTRIBUTEID_TINKERING:    return SKILLID_TINKERING;
-    ATTRIBUTEID_TRACKING:    return SKILLID_TRACKING;
-    ATTRIBUTEID_VETERINARY:    return SKILLID_VETERINARY;
-    ATTRIBUTEID_SWORDSMANSHIP:
-    ATTRIBUTEID_SWORDSMANSHIPALIAS:
-      return SKILLID_SWORDSMANSHIP;
-    ATTRIBUTEID_MACEFIGHTING:
-    ATTRIBUTEID_MACEFIGHTINGALIAS:
-      return SKILLID_MACEFIGHTING;
-    ATTRIBUTEID_FENCING:    return SKILLID_FENCING;
-    ATTRIBUTEID_WRESTLING:    return SKILLID_WRESTLING;
-    ATTRIBUTEID_LUMBERJACKING:  return SKILLID_LUMBERJACKING;
-    ATTRIBUTEID_MINING:    return SKILLID_MINING;
-    ATTRIBUTEID_MEDITATION:    return SKILLID_MEDITATION;
-    ATTRIBUTEID_STEALTH:    return SKILLID_STEALTH;
-    ATTRIBUTEID_REMOVETRAP:    return SKILLID_REMOVETRAP;
-    ATTRIBUTEID_NECROMANCY:    return SKILLID_NECROMANCY;
-    ATTRIBUTEID_CHIVALRY:      return SKILLID_CHIVALRY;
-    ATTRIBUTEID_FOCUS:      return SKILLID_FOCUS;
-  endcase
-  var ret        := error;
-  ret.+errortext := "No equivalent skillid found for attributeid " + attributeid;
-  return ret;
-endfunction
-
-function GetSkillIds()
-  return { SKILLID_ALCHEMY,
-     SKILLID_ANATOMY,
-     SKILLID_ANIMALLORE,
-     SKILLID_ITEMID,
-     SKILLID_ARMSLORE,
-     SKILLID_PARRY,
-     SKILLID_BEGGING,
-     SKILLID_BLACKSMITHY,
-     SKILLID_BOWCRAFT,
-     SKILLID_PEACEMAKING,
-     SKILLID_CAMPING,
-     SKILLID_CARPENTRY,
-     SKILLID_CARTOGRAPHY,
-     SKILLID_COOKING,
-     SKILLID_DETECTINGHIDDEN,
-     SKILLID_ENTICEMENT,
-     SKILLID_EVALINT,
-     SKILLID_HEALING,
-     SKILLID_FISHING,
-     SKILLID_FORENSICS,
-     SKILLID_HERDING,
-     SKILLID_HIDING,
-     SKILLID_PROVOCATION,
-     SKILLID_INSCRIPTION,
-     SKILLID_LOCKPICKING,
-     SKILLID_MAGERY,
-     SKILLID_MAGICRESISTANCE,
-     SKILLID_TACTICS,
-     SKILLID_SNOOPING,
-     SKILLID_MUSICIANSHIP,
-     SKILLID_POISONING,
-     SKILLID_ARCHERY,
-     SKILLID_SPIRITSPEAK,
-     SKILLID_STEALING,
-     SKILLID_TAILORING,
-     SKILLID_TAMING,
-     SKILLID_TASTEID,
-     SKILLID_TINKERING,
-     SKILLID_TRACKING,
-     SKILLID_VETERINARY,
-     SKILLID_SWORDSMANSHIP,
-     SKILLID_MACEFIGHTING,
-     SKILLID_FENCING,
-     SKILLID_WRESTLING,
-     SKILLID_LUMBERJACKING,
-     SKILLID_MINING,
-     SKILLID_MEDITATION,
-     SKILLID_STEALTH,
-     SKILLID_REMOVETRAP,
-     SKILLID_NECROMANCY,
-     SKILLID_CHIVALRY,
-     SKILLID_FOCUS };
-endfunction
-
-function GetSkillTemporaryMod(who, skillid)
-  return Cint(GetSkillTemporaryModBaseValue(who, skillid)/ 10);
-endfunction
-
-function GetSkillTemporaryModBaseValue(who, skillid)
-  return GetAttributeTemporaryMod(who, GetAttributeIdBySkillId(skillid));
-endfunction
-
-function GetStamina(who)
-  return Cint(GetVital(who, VITALID_STAMINA)/ 100);
-endfunction
-
-//function GetSkillIntrinsicMod(who, skillid)
-//  return Cint(GetSkillIntrinsicModBaseValue(who, skillid)/ 10);
-//endfunction
-
-//function GetSkillIntrinsicModBaseValue(who, skillid)
-//  return GetAttributeIntrinsicMod(who, GetAttributeIdBySkillId(skillid));
-//endfunction
-
-function GetStrength(who)
-  return GetAttribute(who, ATTRIBUTEID_STRENGTH);
-endfunction
-
-function GetStrengthMod(who)
-  return Cint(GetAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH)/ 10);
-endfunction
-
-function GetTrueBaseSkill(who, skillid)
-  return Cdbl(GetAttributeBaseValue(who, GetAttributeIdBySkillId(skillid))/ 10.0);
-endfunction
-
-function GetTrueEffectiveSkill(who, skillid)
-  var id   := GetAttributeIdBySkillId(skillid);
-  var base := GetAttributeBaseValue(who, id);
-  var mod1 := GetAttributeTemporaryMod(who, id);
-//  var mod2 := GetAttributeIntrinsicMod(who, id);
-//  var true := Cdbl((base + mod1 + mod2)/ 10.0);
-  var true := Cdbl((base + mod1)/ 10.0);
-  if(true < 0.0)
-    return 0.0;
-  else
-    return true;
-  endif
-endfunction
-
-function GetTrueSkillTemporaryMod(who, skillid)
-  return Cdbl(GetAttributeTemporaryMod(who, GetAttributeIdBySkillId(skillid))/ 10.0);
-endfunction
-
-function GetVitalIds()
-  return { VITALID_LIFE, VITALID_MANA, VITALID_STAMINA };
-endfunction
-
-function ModifyAttributeTemporaryMod(who, attributeid, moda)
-  return SetAttributeTemporaryMod(who, attributeid, Cint(GetAttributeTemporaryMod(who, attributeid)+ Cint(moda*10)));
-endfunction
-
-function ModifyAttributeTemporaryModBaseValue(who, attributeid, moda)
-  return SetAttributeTemporaryMod(who, attributeid, Cint(GetAttributeTemporaryMod(who, attributeid)+ moda));
-endfunction
-
-function ModifyDexterityMod(who, moda)
-  if(ModifyAttributeTemporaryModBaseValue(who, ATTRIBUTEID_DEXTERITY, Cint(moda*10)))
-    DoRecalcVitals(who);
-    return 1;
-  else
-    return 0;
-  endif
-endfunction
-
-function ModifyIntelligenceMod(who, moda)
-  if(ModifyAttributeTemporaryModBaseValue(who, ATTRIBUTEID_INTELLIGENCE, Cint(moda*10)))
-    DoRecalcVitals(who);
-    return 1;
-  else
-    return 0;
-  endif
-endfunction
-
-function ModifySkillTemporaryMod(who, skillid, moda)
-  return ModifyAttributeTemporaryModBaseValue(who, GetAttributeIdBySkillId(skillid), Cint(moda*10));
-endfunction
-
-function ModifySkillTemporaryModBaseValue(who, skillid, moda)
-  return ModifyAttributeTemporaryModBaseValue(who, GetAttributeIdBySkillId(skillid), moda);
-endfunction
-
-function ModifyStrengthMod(who, moda)
-  if(ModifyAttributeTemporaryModBaseValue(who, ATTRIBUTEID_STRENGTH, Cint(moda*10)))
-    DoRecalcVitals(who);
-    return 1;
-  else
-    return 0;
-  endif
-endfunction
-
-function RawToBaseSkill(rawvalue)
-  var scale := Cint(Log10(rawvalue)/Log10(2));
-  if(scale <= 11)
-    return Cint(rawvalue / 20.48);
-  else
-    return Cint((rawvalue / Pow(2,scale)+ scale - 11)* 100);
-  endif
-endfunction
-
-function SetBaseDexterity(who, dexterity)
-  dexterity := Cint(dexterity * 10);
-  if(dexterity < 10)
-    dexterity := 10;
-  elseif(dexterity > CORE_SETTINGS_MAX_ATTRIBUTE)
-    dexterity := CORE_SETTINGS_MAX_ATTRIBUTE;
-  endif
-  var ret := SetAttributeBaseValue(who, ATTRIBUTEID_DEXTERITY, dexterity);
-  if(ret)
-    DoRecalcVitals(who);
-  endif
-  return ret;
-endfunction
-
-function SetBaseDexterityBaseValue(who, dexterity)
-  if(dexterity < 0)
-    dexterity := 0;
-  endif
-  if(SetAttributeBaseValue(who, ATTRIBUTEID_DEXTERITY, Cint(dexterity)))
-    DoRecalcVitals(who);
-    return 1;
-  else
-    return 0;
-  endif
-endfunction
-
-function SetBaseIntelligence(who, intelligence)
-  intelligence := Cint(intelligence * 10);
-  if(intelligence < 10)
-    intelligence := 10;
-  elseif(intelligence > CORE_SETTINGS_MAX_ATTRIBUTE)
-    intelligence := CORE_SETTINGS_MAX_ATTRIBUTE;
-  endif
-  var ret := SetAttributeBaseValue(who, ATTRIBUTEID_INTELLIGENCE, intelligence);
-  if(ret)
-    DoRecalcVitals(who);
-  endif
-  return ret;
-endfunction
-
-function SetBaseIntelligenceBaseValue(who, intelligence)
-  if(intelligence < 0)
-    intelligence := 0;
-  endif
-  if(SetAttributeBaseValue(who, ATTRIBUTEID_INTELLIGENCE, Cint(intelligence)))
-    DoRecalcVitals(who);
-    return 1;
-  else
-    return 0;
-  endif
-endfunction
-
-function SetBaseSkill(who, skillid, skill)
-  return SetBaseSkillBaseValue(who, skillid, Cint(skill*10));
-endfunction
-
-function SetBaseSkillBaseValue(who, skillid, skill_tenth)
-  if(skill_tenth < CORE_SETTINGS_MIN_ATTRIBUTE)
-    skill_tenth := CORE_SETTINGS_MIN_ATTRIBUTE;
-  elseif(skill_tenth > CORE_SETTINGS_MAX_ATTRIBUTE)
-    skill_tenth := CORE_SETTINGS_MAX_ATTRIBUTE;
-  endif
-  return SetAttributeBaseValue(who, GetAttributeIdBySkillId(skillid), Cint(skill_tenth));
-endfunction
-
-function SetBaseStrength(who, strength)
-  strength := Cint(strength * 10);
-  if(strength < 10)
-    strength := 10;
-  elseif(strength > CORE_SETTINGS_MAX_ATTRIBUTE)
-    strength := CORE_SETTINGS_MAX_ATTRIBUTE;
-  endif
-  var ret := SetAttributeBaseValue(who, ATTRIBUTEID_STRENGTH, strength);
-  if(ret)
-    DoRecalcVitals(who);
-  endif
-  return ret;
-endfunction
-
-function SetBaseStrengthBaseValue(who, strength)
-  if(strength < 0)
-    strength := 0;
-  endif
-  if(SetAttributeBaseValue(who, ATTRIBUTEID_STRENGTH, Cint(strength)))
-    DoRecalcVitals(who);
-    return 1;
-  else
-    return 0;
-  endif
-endfunction
-
-function SetDexterityMod(who, mod_amt)
-  var ret := SetAttributeTemporaryMod(who, ATTRIBUTEID_DEXTERITY, Cint(mod_amt*10));
-  if(ret)
-    DoRecalcVitals(who);
-  endif
-  return ret;
-endfunction
-
-function SetDexterityModBaseValue(who, moda)
-  if(SetAttributeTemporaryMod(who, ATTRIBUTEID_DEXTERITY, moda))
-    DoRecalcVitals(who);
-    return 1;
-  else
-    return 0;
-  endif
-endfunction
-
-function SetHp(who, hp)
-  return SetVital(who, VITALID_LIFE, Cint(hp*100));
-endfunction
-
-function SetIntelligenceMod(who, mod_amt)
-  var ret := SetAttributeTemporaryMod(who, ATTRIBUTEID_INTELLIGENCE, Cint(mod_amt*10));
-  if(ret)
-    DoRecalcVitals(who);
-  endif
-  return ret;
-endfunction
-
-function SetIntelligenceModBaseValue(who, moda)
-  if(SetAttributeTemporaryMod(who, ATTRIBUTEID_INTELLIGENCE, moda))
-    DoRecalcVitals(who);
-    return 1;
-  else
-    return 0;
-  endif
-endfunction
-
-function SetMana(who, amount)
-  SetVital(who, "Mana", cint(amount*100.0));
-endfunction
-
-function SetSkillTemporaryMod(who, skillid, mod_amt)
-  return SetAttributeTemporaryMod(who, skillid, Cint(mod_amt*10));
-endfunction
-
-function SetSkillTemporaryModBaseValue(who, skillid, mod_tenth)
-  return SetAttributeTemporaryMod(who, GetAttributeIdBySkillId(skillid), mod_tenth);
-endfunction
-
-function SetStamina(who, stamina)
-  return SetVital(who, VITALID_STAMINA, Cint(stamina*100));
-endfunction
-
-function SetStrengthMod(who, mod_amt)
-  var ret := SetAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH, Cint(mod_amt*10));
-  if(ret)
-    DoRecalcVitals(who);
-  endif
-  return ret;
-endfunction
-
-function SetStrengthModBaseValue(who, moda)
-  if(SetAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH, moda))
-    DoRecalcVitals(who);
-    return 1;
-  else
-    return 0;
-  endif
-endfunction
-
-function GetStaminaRegenRate(who)
-  return GetVitalRegenRate(who, VITALID_STAMINA);
-endfunction
-
-function SetHpRegenRate(who, hundreth_per_minute)
-  if(hundreth_per_minute < CORE_SETTINGS_MIN_REGEN_RATE)
-    hundreth_per_minute := CORE_SETTINGS_MIN_REGEN_RATE;
-  elseif(hundreth_per_minute > CORE_SETTINGS_MAX_REGEN_RATE)
-    hundreth_per_minute := CORE_SETTINGS_MAX_REGEN_RATE;
-  endif
-  SetObjProperty(who, CPROP_NAME_PREFIX_REGEN_RATE+VITALID_LIFE, hundreth_per_minute);
-  return DoRecalcVitals(who);
-endfunction
-
-function SetManaRegenRate(who, hundreth_per_minute)
-  if(hundreth_per_minute < CORE_SETTINGS_MIN_REGEN_RATE)
-    hundreth_per_minute := CORE_SETTINGS_MIN_REGEN_RATE;
-  elseif(hundreth_per_minute > CORE_SETTINGS_MAX_REGEN_RATE)
-    hundreth_per_minute := CORE_SETTINGS_MAX_REGEN_RATE;
-  endif
-  SetObjProperty(who, CPROP_NAME_PREFIX_REGEN_RATE+VITALID_MANA, hundreth_per_minute);
-  return DoRecalcVitals(who);
-endfunction
-
-function SetStaminaRegenRate(who, hundreth_per_minute)
-  if(hundreth_per_minute < CORE_SETTINGS_MIN_REGEN_RATE)
-    hundreth_per_minute := CORE_SETTINGS_MIN_REGEN_RATE;
-  elseif(hundreth_per_minute > CORE_SETTINGS_MAX_REGEN_RATE)
-    hundreth_per_minute := CORE_SETTINGS_MAX_REGEN_RATE;
-  endif
-  SetObjProperty(who, CPROP_NAME_PREFIX_REGEN_RATE+VITALID_STAMINA, hundreth_per_minute);
-  return DoRecalcVitals(who);
-endfunction
-
-function SetVitalRegenRate(who, vitalid, hundreth_per_minute)
-  if(hundreth_per_minute < CORE_SETTINGS_MIN_REGEN_RATE)
-    hundreth_per_minute := CORE_SETTINGS_MIN_REGEN_RATE;
-  elseif(hundreth_per_minute > CORE_SETTINGS_MAX_REGEN_RATE)
-    hundreth_per_minute := CORE_SETTINGS_MAX_REGEN_RATE;
-  endif
-  SetObjProperty(who, CPROP_NAME_PREFIX_REGEN_RATE+vitalid, hundreth_per_minute);
-  return DoRecalcVitals(who);
-endfunction
-



From austin at berlios.de  Tue Nov  1 18:45:57 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 18:45:57 +0100
Subject: [Poldistro-svn] r784 - in trunk/096/pkg/commands: . gm props seer test
Message-ID: <200511011745.jA1HjvZQ007433@sheep.berlios.de>

Author: austin
Date: 2005-11-01 18:45:55 +0100 (Tue, 01 Nov 2005)
New Revision: 784

Added:
   trunk/096/pkg/commands/props/
   trunk/096/pkg/commands/props/eraseglobal.src
   trunk/096/pkg/commands/props/eraseobjproperty.src
   trunk/096/pkg/commands/props/getCProp.src
   trunk/096/pkg/commands/props/getglobal.src
   trunk/096/pkg/commands/props/getprop.src
   trunk/096/pkg/commands/props/propedit.src
   trunk/096/pkg/commands/props/props.src
   trunk/096/pkg/commands/props/setglobal.src
   trunk/096/pkg/commands/props/setobjproperty.src
   trunk/096/pkg/commands/props/setprop.src
Removed:
   trunk/096/pkg/commands/gm/eraseglobal.src
   trunk/096/pkg/commands/gm/eraseobjproperty.src
   trunk/096/pkg/commands/gm/getCProp.src
   trunk/096/pkg/commands/gm/getglobal.src
   trunk/096/pkg/commands/gm/getprop.src
   trunk/096/pkg/commands/gm/propedit.src
   trunk/096/pkg/commands/gm/recreate.src
   trunk/096/pkg/commands/gm/setglobal.src
   trunk/096/pkg/commands/gm/setskill.src
   trunk/096/pkg/commands/seer/setintproperty.src
   trunk/096/pkg/commands/test/getobjprop.src
   trunk/096/pkg/commands/test/props.src
   trunk/096/pkg/commands/test/smember.src
Modified:
   trunk/096/pkg/commands/gm/ekill.src
   trunk/096/pkg/commands/gm/kill.src
   trunk/096/pkg/commands/gm/lkill.src
Log:
Deleted some commands that are redundant or not needed.
Moved CProp commands and .getprop / .setprop to props dir for organization. Linked to GM command level in cmds.cfg

Modified: trunk/096/pkg/commands/gm/ekill.src
===================================================================
--- trunk/096/pkg/commands/gm/ekill.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/gm/ekill.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,29 +1,27 @@
+/*
+ * $Id$
+ *
+ */
 use uo;
-use os;
-use util;
 
-include "include/client";
-include "include/attributes";
-include "include/spellAttack";
-include "include/spellRestrictions";
+include ":attributes:attributes";
 
-program cast_fireball( caster, effect, sound )
-
-  if (!effect)
-    SendSysMessage(caster, "This command plays a moving effect, then kills the target. Usage: ekill <effect>");
-    return;
-  endif
-
-  var tsound := CInt(sound);
-  var teffect := CInt(effect);
-
-  var cast_on := Target( caster );
-  if (!cast_on || cast_on.errortext || !cast_on.isA(POLCLASS_MOBILE))
-    return;
-  endif
-
-  PlaySoundEffect( cast_on, tsound  );
-  PlayMovingEffect( caster, cast_on, teffect, 5, 1 );
-  ApplyRawDamage( cast_on, GetMaxHp(cast_on) + 10  );
-
+program textcmd_eKill(who, text)
+	if ( !text )
+		SendSysMessage(who, "Syntax .ekill <tile number>");
+		return 0;
+	endif
+	
+	SendSysMessage(who, "Select a target to kill.");
+	var targ := Target(who);
+	
+	if ( !targ.IsA(POLCLASS_MOBILE) )
+		SendSysMessage(who, "Cancelled.");
+		return 0;
+	endif
+	
+	PlayMovingEffect(who, targ, CInt(text), 5, 1);
+	ApplyRawDamage(targ, AP_GetVitalMaximumValue(targ, "Hits"));
+	
+	return 1;
 endprogram

Deleted: trunk/096/pkg/commands/gm/eraseglobal.src
===================================================================
--- trunk/096/pkg/commands/gm/eraseglobal.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/gm/eraseglobal.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,13 +0,0 @@
-use uo;
-
-
-program textcmd_eraseglobal( who, propertyname )
-    print( "Property Name: " + propertyname );
-
-    var res := EraseGlobalProperty( propertyname );
-    if (res != error)
-        SendSysMessage( who, "Property " + propertyname + " erased." );
-    else
-        SendSysMessage( who, "Error erasing property: " + res.errortext );
-    endif
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/commands/gm/eraseobjproperty.src
===================================================================
--- trunk/096/pkg/commands/gm/eraseobjproperty.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/gm/eraseobjproperty.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,15 +0,0 @@
-use uo;
-
-program textcmd_eraseobjproperty( who, propname )
-    print( "Property Name: " + propname );
-
-    var tgt := Target( who );
-    if (tgt)
-        var res := EraseObjProperty( tgt, propname );
-        if (res != error)
-            SendSysMessage( who, "Property " + propname + " erased." );
-        else
-            SendSysMessage( who, "Error erasing property: " + res.errortext );
-        endif
-    endif
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/commands/gm/getCProp.src
===================================================================
--- trunk/096/pkg/commands/gm/getCProp.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/gm/getCProp.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,35 +0,0 @@
-use uo;
-
-include "include/properties";
-include "include/messages";
-include "include/localization";
-
-
-program command_getCProp(who, prop)
-	var obj, res;
-
-	if (!prop)
-		SendMessage(who, MSG_NO_PARAM, {}, MSG_COMMAND);
-		return;
-	else
-		SendMessage(who, MSG_TARGET_OBJ, {}, MSG_COMMAND);
-	endif
-
-	obj := Target(who, TGTOPT_NOCHECK_LOS);
-	if (!obj)
-		SendMessage(who, MSG_CANCELLED, {}, MSG_COMMAND);
-	else
-		Log(LOG_COMMAND, GetLogInfo(who) + " invoking 'getprop' command on " + GetLogInfo(obj));
-	endif
-
-        res := GetProperty(obj, prop, SECURE_MAGIC);
-
-	if (!res)
-		SendMessage(who, MSG_NOT_EXIST, {prop}, MSG_COMMAND);
-		return;
-	endif
-
-	SendMessage(who, MSG_GET_PROP, {prop, CStr(res), TypeOf(res)}, MSG_COMMAND);
-
-	return;
-endprogram

Deleted: trunk/096/pkg/commands/gm/getglobal.src
===================================================================
--- trunk/096/pkg/commands/gm/getglobal.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/gm/getglobal.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,12 +0,0 @@
-use uo;
-
-program textcmd_getglobal( who, propname )
-    print( "Property Name: " + propname );
-
-    var res := GetGlobalProperty( propname );
-    if (res != error)
-        SendSysMessage( who, "Property " + propname + ": " + res );
-    else
-        SendSysMessage( who, "Error getting property: " + res.errortext );
-    endif
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/commands/gm/getprop.src
===================================================================
--- trunk/096/pkg/commands/gm/getprop.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/gm/getprop.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,20 +0,0 @@
-//
-// getprop.src
-//
-// Show information on a mob/items members
-//
-// Austin
-// Created: 9/24/2001 11:25AM
-// Updated: 9/24/2001 11:25AM
-//
-
-use uo;
-
-program propertyinfo(who, property)
-	var targ := target(who);
-	if ( !targ )
-		SendSysMessage(who, "Cancelled");
-		return;
-	endif
-	SendSysMessage(who, "Property "+property+": "+targ.get_member(property));
-endprogram

Modified: trunk/096/pkg/commands/gm/kill.src
===================================================================
--- trunk/096/pkg/commands/gm/kill.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/gm/kill.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,22 +1,23 @@
-use os;
+/*
+ * $Id$
+ *
+ */
 use uo;
-use boat;
 
-include "include/attributes";
+include ":attributes:attributes";
 
-
-program command_kill(who)
-	var tgt := TargetCoordinates( who );
-	if (tgt.mobile)
-		var mob := tgt.mobile;
-		if (!mob.dead)
-			RevokePrivilege(mob, "invul");
-			SetObjProperty(mob, "guardkill", 1);
-			ApplyRawDamage(mob, GetHp(mob));
-		else
-			SendSysMessage(who, "That tickles!");
-		endif
+program textcmd_Kill(who)
+	SendSysMessage(who, "Select a target to kill.");
+	var targ := Target(who);
+	
+	if ( !targ.IsA(POLCLASS_MOBILE) )
+		SendSysMessage(who, "Cancelled.");
+		return 0;
 	endif
-
-	return;
+	
+	targ.Disable("Invul");
+	SetObjProperty(targ, "GuardKill", 1);	
+	ApplyRawDamage(targ, AP_GetVitalMaximumValue(targ, "Hits"));
+	
+	return 1;
 endprogram

Modified: trunk/096/pkg/commands/gm/lkill.src
===================================================================
--- trunk/096/pkg/commands/gm/lkill.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/gm/lkill.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,20 +1,26 @@
-use os;
+/*
+ * $Id$
+ *
+ */
 use uo;
-use boat;
 
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 
-
-program command_kill(who)
-	var mobile := Target(who, TGTOPT_NOCHECK_LOS);
-
-	PlayLightningBoltEffect(mobile);
-	PlaySoundEffect(mobile, SFX_SPELL_LIGHTNING);
-
-	RevokePrivilege(mobile, "invul");
-	SetObjProperty(mobile, "guardkill", 1);
-	ApplyRawDamage(mobile, GetMaxHp(mobile));
-
-	return;
-endprogram
\ No newline at end of file
+program textcmd_Kill(who)
+	SendSysMessage(who, "Select a target to kill.");
+	var targ := Target(who);
+	
+	if ( !targ.IsA(POLCLASS_MOBILE) )
+		SendSysMessage(who, "Cancelled.");
+		return 0;
+	endif
+	
+	targ.Disable("Invul");
+	SetObjProperty(targ, "GuardKill", 1);
+	PlayLightningBoltEffect(targ);
+	PlaySoundEffect(targ, SFX_SPELL_LIGHTNING);	
+	ApplyRawDamage(targ, AP_GetVitalMaximumValue(targ, "Hits"));
+	
+	return 1;
+endprogram

Deleted: trunk/096/pkg/commands/gm/propedit.src
===================================================================
--- trunk/096/pkg/commands/gm/propedit.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/gm/propedit.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,404 +0,0 @@
-////////////////////////////////////////////////////////
-//
-// Propedit v0.6 - gump based cprop editor
-//
-////////////////////////////////////////////////////////
-//
-// Author  : Dougall
-// Updated : 15 August 2002
-// Contact : dougalloogle at yahoo.com
-//
-////////////////////////////////////////////////////////
-//
-// Notes:
-//
-//  - type ".propedit" then target the item or 
-//    mobile who's cprops you wish to view or edit.
-//
-//  - edit Cprop strings, doubles and integers
-//    directly into the gump.
-//
-//  - deals with the first 60 cprops on an object
-//
-//  - press the red flag in the top right corner
-//    to toggle the gump size (to help with larger 
-//    Cprops)
-//
-//  - to edit cprops on a multi, first stand on the 
-//    multi then type ".propedit multi"
-//
-//  - you can call propedit from another script
-//    like this:
-//        start_script("::textcmd/gm/propedit", { who, thing });
-//    where
-//        who   - person who gets sent the gump
-//        thing - thing to view/edit props on
-//
-//  - please send me an email if you find any bugs...
-//
-////////////////////////////////////////////////////////
-//
-// Histoy:
-//
-//  0.6 - rewrote propedit to use SendDialogGump() rather
-//        than gumps.inc (should make the script quicker
-//        and more efficient)
-//      - added support for multis/housing
-//      - added support for calling propedit from another
-//        script.
-//
-//  0.5 - fixed gump crash when very large arrays or
-//        strings were stored as cprops on items
-//      - tightened up the code a bit
-//
-//  0.4 - removed faulty array editing
-//
-//  0.1 to 0.3 - initial construction and testing
-//
-////////////////////////////////////////////////////////
-//
-// Warning & Disclaimer:
-//
-//  - !BE WARNED! It's really easy to make a mess of
-//    some pretty essential Cprops with this tool.
-//
-//  - Disclaimer: ...I didn't do it.....I wasn't there
-//    ....It wasn't me.... ....honest...
-//
-////////////////////////////////////////////////////////
-
-use os;
-use uo;
-use basic;
-
-////////////////////////////////////////////////////////
-// Consts
-
-const TEXT_LINES        := 10;
-const MAX_PAGES         := 6;
-const MAX_CHARS         := 200;
-
-////////////////////////////////////////////////////////
-// Global Variables
-var gump_width     :=1;
-var show_in_hex    :=1;
-
-//////////
-
-var main_data:={
-"",                     // show hex/int
-"CProp Editor",
-"Add Cprop",
-"Del Marked Cprops",
-"",                     // item name
-"Enter new propname....",
-"Enter proptype....",
-"Integer",
-"Double",
-"String",
-"Confirm Delete",
-"Delete Checked Cprops ?" };
-
-//////////
-
-var main_layout:={
-"page0",
-"nodispose",
-"resizepic",                        // resizepic (varies - altered later in script)
-"text 70 270 34 0",
-"button 50 273 2224 2224 1 0 1000", // hextoggle
-"button",                           // widthtoggle (varies - altered later in script)
-"text 40 9 1 1",
-"text 43 11 66 1",
-"text"                             // item name (varies - altered later in script)
-};
-
-//////////
-
-var add_layout:={ 
-  "resizepic 160 25 2520 340 250",
-  "button 380 243 2071 2072 0 1",
-  "button 230 243 239 240 1 0 998",
-  "group 0",
-  "radio 220 140 2152 2154 1 1005",
-  "radio 220 170 2152 2154 0 1006",
-  "radio 220 200 2152 2154 0 1007",
-  "text 280 34 1 2",
-  "text 283 35 34 2",
-  "text 200 70 0 5",
-  "text 200 120 0 6",
-  "text 260 144 0 7",
-  "text 260 174 0 8",
-  "text 260 204 0 9",
-  "gumppic 190 90 1143"
- };
-  
-//////////
-
-var del_layout:={
-  "resizepic 160 25 2520 340 250",
-  "text 260 34 1 10",
-  "text 263 36 34 10",
-  "text 240 110 0 11",
-  "button 380 242 2071 2072 0 1",
-  "button 230 243 239 240 1 0 997"
- };
-
-////////////////////////////////////////////////////////
-
-program CpropEditor(parms1,parms2)
-  var who,thing;
-
-  if (TypeOf(parms1)=="Array")
-    if ( (parms1[1].isa(POLCLASS_MOBILE) and !parms1[1].isa(POLCLASS_NPC)) and parms1[2].isa(POLCLASS_UOBJECT) )
-      who:=parms1[1];
-      thing:=parms1[2];
-    else
-      syslog("Invalid params in call_script : "+who);
-      return;
-    endif
-  else
-    who:=parms1;
-    parms2:=lower(parms2);
-    if (parms2["multi"])
-      if (!who.multi)
-        sendsysmessage(who,"You must stand on the multi to edit it's cprops.");
-        return;
-      else
-        thing:=who.multi;
-      endif
-    else
-      sendsysmessage(who,"Edit Cprops on what?");
-      thing:=Target(who,TGTOPT_NOCHECK_LOS);
-    endif
-  endif
-
-  if (!thing)
-    sendsysmessage(who,"Cancelled.");
-    return;
-  elseif (thing.isa(POLCLASS_ITEM))
-    ReserveItem(thing);
-  endif
-
-  while (SendCpropGump(who,thing))
-    sleepms(20);
-  endwhile
-
-  if (!thing)
-    sendsysmessage(who,"Item destroyed!");
-  elseif (thing.isa(POLCLASS_ITEM))
-    ReleaseItem(thing);
-  endif
-
-endprogram
-
-////////////////////////////////////////////////////////
-
-function SendCpropGump(who,thing)
-  var propnames:=GetObjPropertyNames(thing);
-  var num_pages;
-  if (!len(propnames))
-    num_pages:=1;
-  else
-    num_pages:=1+Cint((len(propnames)-1)/TEXT_LINES);
-  endif
-  if (num_pages>MAX_PAGES)
-    num_pages:=MAX_PAGES;
-  endif
-  var add_page:=num_pages+1;
-  var del_page:=num_pages+2;
-  var this_layout:=main_layout;
-  var this_data:=main_data;
-  
-//  Compose Cprop Pages
-  ComposeMainGump(add_page,del_page,this_layout,this_data,thing);
-  
-// Add Prop Page
-  this_layout.append("page "+add_page);
-  foreach bit in add_layout
-    this_layout.append(bit);
-  endforeach
-  this_layout.append("textentry 200 92 200 20 0 500 "+len(this_data));
-  this_data.append("");
-  
-// Del Prop Page  
-  this_layout.append("page "+del_page);
-  foreach bit in del_layout
-    this_layout.append(bit);
-  endforeach
-  
-  var retval:=SendDialogGump(who,this_layout,this_data);
-
-// Check for buttons.....  
-  var i;
-  if (retval[1000])           // Toggle Hex
-    show_in_hex:=!show_in_hex;
-    return 1;
-  elseif (retval[1001])       // Toggle Width
-    gump_width:=gump_width+1;
-    if (!GetGumpWidth())
-      gump_width:=1;
-    endif
-    return 1;
-  elseif (retval[998])        // Add Cprop
-    var add_prop_name:=GetGumpText(retval[500]);
-    if (!len(add_prop_name))
-      sendsysmessage(who,"No Cprop name specified!");
-      return 1;
-    elseif (add_prop_name in propnames)
-      sendsysmessage(who,"There is alread a Cprop with that name!");
-      return 1;
-    endif
-    var add_prop_val;
-    if (retval[1005])
-      add_prop_val:=0;   // integer
-    elseif (retval[1006])
-      add_prop_val:=0.0; // double
-    else
-      add_prop_val:="";  // string
-    endif    
-    SetObjProperty(thing,add_prop_name,add_prop_val);
-    return 1;
-  elseif (retval[997])      // Delete Cprop
-    for (i:=1;i<=len(propnames);i:=i+1)
-      if (retval[700+i])
-        EraseObjProperty(thing,propnames[i]);
-      endif
-    endfor
-    return 1;
-  elseif (retval[999])      // Apply changes to cprops
-    for (i:=1;i<=len(propnames);i:=i+1)
-      var this_prop:=GetObjProperty(thing,propnames[i]);
-      var this_text:=retval[i+500];
-      if (!this_text.errortext)
-        SetObjProperty(thing,propnames[i],SetPropType(GetGumpText(this_text),TypeOf(this_prop)));
-      endif
-    endfor
-    return 1;
-  endif
-  
-  return 0;
-endfunction
-
-////////////////////////////////////////////////////////
-
-
-function ComposeMainGump(byref add_page,byref del_page,byref this_layout,byref this_data,thing)
-  var propnames:=GetObjPropertyNames(thing);
-  var width:=GetGumpWidth();
-  this_layout[3]:="resizepic 0 0 2520 "+width+" 300";
-  this_layout[6]:="button "+(width-40)+" 10 31 31 1 0 1001"; 
-  this_layout[9]:="croppedtext 140 10 "+(width-200)+" 25 0 4";
-  if (show_in_hex)
-    this_data[1]:="Show Int";
-  else
-    this_data[1]:="Show Hex";
-  endif                    
-  if (thing.name)
-    this_data[5]:=thing.name+" ["+ToggleHex(thing.serial)+"]";
-  else
-    this_data[5]:=thing.desc+" ["+ToggleHex(thing.serial)+"]";
-  endif
-  
-  var i,j,y,this_prop,this_type;
-
-  for (i:=1;i<add_page;i:=i+1)
-    this_layout.append("page "+i);
-    this_layout.append("button 380 267 2071 2072 1 0 995");// Cancel button
-    this_layout.append("button 200 267 239 240 1 0 999");  // Main apply button
-    if (i>1)
-      this_layout.append("button "+(width-60)+" 40 250 251 0 "+(i-1)); 
-    endif
-    if (i<(add_page-1))
-      this_layout.append("button "+(width-60)+" 265 252 253 0 "+(i+1)); 
-    endif
-    if (add_page>2)
-      this_layout.append("gumppic "+(width-108)+" 263 2644");
-      this_layout.append("gumppic "+(width-105)+" 266 "+(2224+i));
-    endif
-    this_layout.append("button 340 38 2224 2224 0 "+add_page);
-    this_layout.append("text 360 35 34 2");
-    this_layout.append("button 40 38 2224 2224 0 "+del_page);
-    this_layout.append("text 60 35 34 3");
-
-    var start_j:=((i-1)*TEXT_LINES)+1;
-    var end_j:=i*TEXT_LINES;
-    if (end_j>len(propnames))
-      end_j:=len(propnames);
-    endif
-    
-    for (j:=start_j; j<=end_j; j:=j+1)
-      if (propnames[j])
-        this_prop:=GetObjProperty(thing,propnames[j]);
-        this_type:=TypeOf(this_prop);
-        this_prop:=Cstr(this_prop);
-        var can_edit:=1;
-        if (len(this_prop)>MAX_CHARS)
-          this_prop:=this_prop[1,MAX_CHARS];
-          can_edit:=0;
-        endif
-        y:=(j-start_j)*20+60;
-        this_layout.append("croppedtext 50 "+y+" 130 20 0 "+len(this_data));
-        this_data.append(propnames[j]);
-
-        this_layout.append("croppedtext 200 "+y+" 60 20 0 "+len(this_data));
-        this_data.append(this_type);
-
-        if (this_prop.errortext)
-          this_layout.append("croppedtext 280 "+y+" "+(width-310)+" 20 34 "+len(this_data));
-          this_data.append(this_prop.errortext);
-        elseif ( (can_edit) and  ( this_type=="Integer") or (this_type=="Double") or (this_type=="String") )
-          this_layout.append("gumppic 260 "+(y+3)+" 58");
-          this_layout.append("textentry 280 "+y+" "+(width-310)+" 20 0 "+(500+j)+" "+len(this_data));
-          this_data.append(ToggleHex(this_prop,this_type));
-        else
-          this_layout.append("croppedtext 280 "+y+" "+(width-310)+" 20 0 "+len(this_data));
-          this_data.append(this_prop);
-        endif
-        this_layout.append("checkbox 30 "+y+" 210 211 0 "+(j+700)); 
-      endif
-    endfor
-  endfor
-endfunction
-
-////////////////////////////////////////////////////////
-
-function GetGumpText(text)
-  return text[Find(text,": ",1)+2,len(text)];
-endfunction
-
-////////////////////////////////////////////////////////
-
-function GetGumpWidth()
-  case (gump_width)
-    1:  return 600;
-    2:  return 750;
-    3:  return 900;
-  endcase
-  return 0;
-endfunction
-
-////////////////////////////////////////////////////////
-
-function SetPropType(text,type)
-  case (type)
-    "Integer" : return Cint(text);
-    "Double"  : return Cdbl(text);
-  endcase
-  return text;
-endfunction
-
-////////////////////////////////////////////////////////
-
-function ToggleHex(value,value_type:=0)
-  if (!value_type)
-    value_type:=TypeOf(value);
-  endif
-  if ((value_type=="Integer") and (show_in_hex))
-    return Hex(value);
-  else
-    return Cstr(value);
-  endif
-endfunction
-
-////////////////////////////////////////////////////////

Deleted: trunk/096/pkg/commands/gm/recreate.src
===================================================================
--- trunk/096/pkg/commands/gm/recreate.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/gm/recreate.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,25 +0,0 @@
-use os;
-use uo;
-use boat;
-include "include/attributes";
-
-program textcmd_kill( who )
-    var tgt := TargetCoordinates( who );
-   
-    if (tgt.mobile)
-        var obj := tgt.mobile.npctemplate;
-        var x := tgt.mobile.x;
-        var y := tgt.mobile.y;
-        var z := tgt.mobile.z;
-       
-        var mob := tgt.mobile;
-
-      
-            RevokePrivilege( mob, "invul" );
-            SetObjProperty(mob, "guardkill", 1);
-            ApplyRawDamage( mob, GetHp(mob) );
-            Detach();
-            sleep(2);
-            CreateNpcFromTemplate(obj,x,y,z,0,who.realm);
-    endif
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/commands/gm/setglobal.src
===================================================================
--- trunk/096/pkg/commands/gm/setglobal.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/gm/setglobal.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,15 +0,0 @@
-use uo;
-use os;
-
-
-program textcmd_setglobal( who, text )
-    var tparams := SplitWords( text );
-
-    print( "Property Name: " + tparams[1] );
-    print( "Property Value: " + tparams[2] );
-
-    var res := SetGlobalProperty( tparams[1], tparams[2] );
-    if (!res)
-        SendSysMessage( who, "Error setting property: " + res.errortext );
-    endif
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/commands/gm/setskill.src
===================================================================
--- trunk/096/pkg/commands/gm/setskill.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/gm/setskill.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,45 +0,0 @@
-use os;
-use uo;
-use boat;
-
-include "include/attributes";
-
-program textcmd_setskill( who, text )
-
-	text := SplitWords(text);
-	if( !text[1] )
-		SendSysMessage( who, "Usage is : .setskill <skillid> <level>" );
-		return 0;
-	elseif( !text[2] )
-		SendSysMessage( who, "Usage is : .setskill <skillid> <level>" );
-		return 0;
-	endif
-		
-	var skillid := Cint(text[1]);
-	if( skillid == error )
-		SendSysMessage( who, "Skillid must be a an integer." );
-		return 0;
-	endif
-	
-	var level := Cdbl(text[2]);
-	if( level == error )
-		SendSysMessage( who, "Skill level must be a floating value." );
-		return 0;
-	endif
-	
-	SendSysMessage( who, "Set skill " + skillid + " to " + level + " on who?" );
-	var mobile := Target(who);
-	if( !mobile )
-		return 0;
-	elseif( !mobile.IsA(POLCLASS_MOBILE) )
-		SendSysMessage( who, "You must target a mobile." );
-		return 0;
-	endif
-	
-	if( SetBaseSkillBaseValue( mobile, skillid, Cint(level*10.0) ) )
-		SendSysMessage( who, "New Effective Skill is " + GetTrueEffectiveSkill( mobile, skillid ) );
-	else
-		SendSysMessage( who, "Unable to set the skill." );
-	endif
-	
-endprogram
\ No newline at end of file

Added: trunk/096/pkg/commands/props/eraseglobal.src
===================================================================
--- trunk/096/pkg/commands/props/eraseglobal.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/props/eraseglobal.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -0,0 +1,13 @@
+use uo;
+
+
+program textcmd_eraseglobal( who, propertyname )
+    print( "Property Name: " + propertyname );
+
+    var res := EraseGlobalProperty( propertyname );
+    if (res != error)
+        SendSysMessage( who, "Property " + propertyname + " erased." );
+    else
+        SendSysMessage( who, "Error erasing property: " + res.errortext );
+    endif
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/commands/props/eraseobjproperty.src
===================================================================
--- trunk/096/pkg/commands/props/eraseobjproperty.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/props/eraseobjproperty.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -0,0 +1,15 @@
+use uo;
+
+program textcmd_eraseobjproperty( who, propname )
+    print( "Property Name: " + propname );
+
+    var tgt := Target( who );
+    if (tgt)
+        var res := EraseObjProperty( tgt, propname );
+        if (res != error)
+            SendSysMessage( who, "Property " + propname + " erased." );
+        else
+            SendSysMessage( who, "Error erasing property: " + res.errortext );
+        endif
+    endif
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/commands/props/getCProp.src
===================================================================
--- trunk/096/pkg/commands/props/getCProp.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/props/getCProp.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -0,0 +1,35 @@
+use uo;
+
+include "include/properties";
+include "include/messages";
+include "include/localization";
+
+
+program command_getCProp(who, prop)
+	var obj, res;
+
+	if (!prop)
+		SendMessage(who, MSG_NO_PARAM, {}, MSG_COMMAND);
+		return;
+	else
+		SendMessage(who, MSG_TARGET_OBJ, {}, MSG_COMMAND);
+	endif
+
+	obj := Target(who, TGTOPT_NOCHECK_LOS);
+	if (!obj)
+		SendMessage(who, MSG_CANCELLED, {}, MSG_COMMAND);
+	else
+		Log(LOG_COMMAND, GetLogInfo(who) + " invoking 'getprop' command on " + GetLogInfo(obj));
+	endif
+
+        res := GetProperty(obj, prop, SECURE_MAGIC);
+
+	if (!res)
+		SendMessage(who, MSG_NOT_EXIST, {prop}, MSG_COMMAND);
+		return;
+	endif
+
+	SendMessage(who, MSG_GET_PROP, {prop, CStr(res), TypeOf(res)}, MSG_COMMAND);
+
+	return;
+endprogram

Added: trunk/096/pkg/commands/props/getglobal.src
===================================================================
--- trunk/096/pkg/commands/props/getglobal.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/props/getglobal.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -0,0 +1,12 @@
+use uo;
+
+program textcmd_getglobal( who, propname )
+    print( "Property Name: " + propname );
+
+    var res := GetGlobalProperty( propname );
+    if (res != error)
+        SendSysMessage( who, "Property " + propname + ": " + res );
+    else
+        SendSysMessage( who, "Error getting property: " + res.errortext );
+    endif
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/commands/props/getprop.src
===================================================================
--- trunk/096/pkg/commands/props/getprop.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/props/getprop.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -0,0 +1,20 @@
+//
+// getprop.src
+//
+// Show information on a mob/items members
+//
+// Austin
+// Created: 9/24/2001 11:25AM
+// Updated: 9/24/2001 11:25AM
+//
+
+use uo;
+
+program propertyinfo(who, property)
+	var targ := target(who);
+	if ( !targ )
+		SendSysMessage(who, "Cancelled");
+		return;
+	endif
+	SendSysMessage(who, "Property "+property+": "+targ.get_member(property));
+endprogram

Added: trunk/096/pkg/commands/props/propedit.src
===================================================================
--- trunk/096/pkg/commands/props/propedit.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/props/propedit.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -0,0 +1,404 @@
+////////////////////////////////////////////////////////
+//
+// Propedit v0.6 - gump based cprop editor
+//
+////////////////////////////////////////////////////////
+//
+// Author  : Dougall
+// Updated : 15 August 2002
+// Contact : dougalloogle at yahoo.com
+//
+////////////////////////////////////////////////////////
+//
+// Notes:
+//
+//  - type ".propedit" then target the item or 
+//    mobile who's cprops you wish to view or edit.
+//
+//  - edit Cprop strings, doubles and integers
+//    directly into the gump.
+//
+//  - deals with the first 60 cprops on an object
+//
+//  - press the red flag in the top right corner
+//    to toggle the gump size (to help with larger 
+//    Cprops)
+//
+//  - to edit cprops on a multi, first stand on the 
+//    multi then type ".propedit multi"
+//
+//  - you can call propedit from another script
+//    like this:
+//        start_script("::textcmd/gm/propedit", { who, thing });
+//    where
+//        who   - person who gets sent the gump
+//        thing - thing to view/edit props on
+//
+//  - please send me an email if you find any bugs...
+//
+////////////////////////////////////////////////////////
+//
+// Histoy:
+//
+//  0.6 - rewrote propedit to use SendDialogGump() rather
+//        than gumps.inc (should make the script quicker
+//        and more efficient)
+//      - added support for multis/housing
+//      - added support for calling propedit from another
+//        script.
+//
+//  0.5 - fixed gump crash when very large arrays or
+//        strings were stored as cprops on items
+//      - tightened up the code a bit
+//
+//  0.4 - removed faulty array editing
+//
+//  0.1 to 0.3 - initial construction and testing
+//
+////////////////////////////////////////////////////////
+//
+// Warning & Disclaimer:
+//
+//  - !BE WARNED! It's really easy to make a mess of
+//    some pretty essential Cprops with this tool.
+//
+//  - Disclaimer: ...I didn't do it.....I wasn't there
+//    ....It wasn't me.... ....honest...
+//
+////////////////////////////////////////////////////////
+
+use os;
+use uo;
+use basic;
+
+////////////////////////////////////////////////////////
+// Consts
+
+const TEXT_LINES        := 10;
+const MAX_PAGES         := 6;
+const MAX_CHARS         := 200;
+
+////////////////////////////////////////////////////////
+// Global Variables
+var gump_width     :=1;
+var show_in_hex    :=1;
+
+//////////
+
+var main_data:={
+"",                     // show hex/int
+"CProp Editor",
+"Add Cprop",
+"Del Marked Cprops",
+"",                     // item name
+"Enter new propname....",
+"Enter proptype....",
+"Integer",
+"Double",
+"String",
+"Confirm Delete",
+"Delete Checked Cprops ?" };
+
+//////////
+
+var main_layout:={
+"page0",
+"nodispose",
+"resizepic",                        // resizepic (varies - altered later in script)
+"text 70 270 34 0",
+"button 50 273 2224 2224 1 0 1000", // hextoggle
+"button",                           // widthtoggle (varies - altered later in script)
+"text 40 9 1 1",
+"text 43 11 66 1",
+"text"                             // item name (varies - altered later in script)
+};
+
+//////////
+
+var add_layout:={ 
+  "resizepic 160 25 2520 340 250",
+  "button 380 243 2071 2072 0 1",
+  "button 230 243 239 240 1 0 998",
+  "group 0",
+  "radio 220 140 2152 2154 1 1005",
+  "radio 220 170 2152 2154 0 1006",
+  "radio 220 200 2152 2154 0 1007",
+  "text 280 34 1 2",
+  "text 283 35 34 2",
+  "text 200 70 0 5",
+  "text 200 120 0 6",
+  "text 260 144 0 7",
+  "text 260 174 0 8",
+  "text 260 204 0 9",
+  "gumppic 190 90 1143"
+ };
+  
+//////////
+
+var del_layout:={
+  "resizepic 160 25 2520 340 250",
+  "text 260 34 1 10",
+  "text 263 36 34 10",
+  "text 240 110 0 11",
+  "button 380 242 2071 2072 0 1",
+  "button 230 243 239 240 1 0 997"
+ };
+
+////////////////////////////////////////////////////////
+
+program CpropEditor(parms1,parms2)
+  var who,thing;
+
+  if (TypeOf(parms1)=="Array")
+    if ( (parms1[1].isa(POLCLASS_MOBILE) and !parms1[1].isa(POLCLASS_NPC)) and parms1[2].isa(POLCLASS_UOBJECT) )
+      who:=parms1[1];
+      thing:=parms1[2];
+    else
+      syslog("Invalid params in call_script : "+who);
+      return;
+    endif
+  else
+    who:=parms1;
+    parms2:=lower(parms2);
+    if (parms2["multi"])
+      if (!who.multi)
+        sendsysmessage(who,"You must stand on the multi to edit it's cprops.");
+        return;
+      else
+        thing:=who.multi;
+      endif
+    else
+      sendsysmessage(who,"Edit Cprops on what?");
+      thing:=Target(who,TGTOPT_NOCHECK_LOS);
+    endif
+  endif
+
+  if (!thing)
+    sendsysmessage(who,"Cancelled.");
+    return;
+  elseif (thing.isa(POLCLASS_ITEM))
+    ReserveItem(thing);
+  endif
+
+  while (SendCpropGump(who,thing))
+    sleepms(20);
+  endwhile
+
+  if (!thing)
+    sendsysmessage(who,"Item destroyed!");
+  elseif (thing.isa(POLCLASS_ITEM))
+    ReleaseItem(thing);
+  endif
+
+endprogram
+
+////////////////////////////////////////////////////////
+
+function SendCpropGump(who,thing)
+  var propnames:=GetObjPropertyNames(thing);
+  var num_pages;
+  if (!len(propnames))
+    num_pages:=1;
+  else
+    num_pages:=1+Cint((len(propnames)-1)/TEXT_LINES);
+  endif
+  if (num_pages>MAX_PAGES)
+    num_pages:=MAX_PAGES;
+  endif
+  var add_page:=num_pages+1;
+  var del_page:=num_pages+2;
+  var this_layout:=main_layout;
+  var this_data:=main_data;
+  
+//  Compose Cprop Pages
+  ComposeMainGump(add_page,del_page,this_layout,this_data,thing);
+  
+// Add Prop Page
+  this_layout.append("page "+add_page);
+  foreach bit in add_layout
+    this_layout.append(bit);
+  endforeach
+  this_layout.append("textentry 200 92 200 20 0 500 "+len(this_data));
+  this_data.append("");
+  
+// Del Prop Page  
+  this_layout.append("page "+del_page);
+  foreach bit in del_layout
+    this_layout.append(bit);
+  endforeach
+  
+  var retval:=SendDialogGump(who,this_layout,this_data);
+
+// Check for buttons.....  
+  var i;
+  if (retval[1000])           // Toggle Hex
+    show_in_hex:=!show_in_hex;
+    return 1;
+  elseif (retval[1001])       // Toggle Width
+    gump_width:=gump_width+1;
+    if (!GetGumpWidth())
+      gump_width:=1;
+    endif
+    return 1;
+  elseif (retval[998])        // Add Cprop
+    var add_prop_name:=GetGumpText(retval[500]);
+    if (!len(add_prop_name))
+      sendsysmessage(who,"No Cprop name specified!");
+      return 1;
+    elseif (add_prop_name in propnames)
+      sendsysmessage(who,"There is alread a Cprop with that name!");
+      return 1;
+    endif
+    var add_prop_val;
+    if (retval[1005])
+      add_prop_val:=0;   // integer
+    elseif (retval[1006])
+      add_prop_val:=0.0; // double
+    else
+      add_prop_val:="";  // string
+    endif    
+    SetObjProperty(thing,add_prop_name,add_prop_val);
+    return 1;
+  elseif (retval[997])      // Delete Cprop
+    for (i:=1;i<=len(propnames);i:=i+1)
+      if (retval[700+i])
+        EraseObjProperty(thing,propnames[i]);
+      endif
+    endfor
+    return 1;
+  elseif (retval[999])      // Apply changes to cprops
+    for (i:=1;i<=len(propnames);i:=i+1)
+      var this_prop:=GetObjProperty(thing,propnames[i]);
+      var this_text:=retval[i+500];
+      if (!this_text.errortext)
+        SetObjProperty(thing,propnames[i],SetPropType(GetGumpText(this_text),TypeOf(this_prop)));
+      endif
+    endfor
+    return 1;
+  endif
+  
+  return 0;
+endfunction
+
+////////////////////////////////////////////////////////
+
+
+function ComposeMainGump(byref add_page,byref del_page,byref this_layout,byref this_data,thing)
+  var propnames:=GetObjPropertyNames(thing);
+  var width:=GetGumpWidth();
+  this_layout[3]:="resizepic 0 0 2520 "+width+" 300";
+  this_layout[6]:="button "+(width-40)+" 10 31 31 1 0 1001"; 
+  this_layout[9]:="croppedtext 140 10 "+(width-200)+" 25 0 4";
+  if (show_in_hex)
+    this_data[1]:="Show Int";
+  else
+    this_data[1]:="Show Hex";
+  endif                    
+  if (thing.name)
+    this_data[5]:=thing.name+" ["+ToggleHex(thing.serial)+"]";
+  else
+    this_data[5]:=thing.desc+" ["+ToggleHex(thing.serial)+"]";
+  endif
+  
+  var i,j,y,this_prop,this_type;
+
+  for (i:=1;i<add_page;i:=i+1)
+    this_layout.append("page "+i);
+    this_layout.append("button 380 267 2071 2072 1 0 995");// Cancel button
+    this_layout.append("button 200 267 239 240 1 0 999");  // Main apply button
+    if (i>1)
+      this_layout.append("button "+(width-60)+" 40 250 251 0 "+(i-1)); 
+    endif
+    if (i<(add_page-1))
+      this_layout.append("button "+(width-60)+" 265 252 253 0 "+(i+1)); 
+    endif
+    if (add_page>2)
+      this_layout.append("gumppic "+(width-108)+" 263 2644");
+      this_layout.append("gumppic "+(width-105)+" 266 "+(2224+i));
+    endif
+    this_layout.append("button 340 38 2224 2224 0 "+add_page);
+    this_layout.append("text 360 35 34 2");
+    this_layout.append("button 40 38 2224 2224 0 "+del_page);
+    this_layout.append("text 60 35 34 3");
+
+    var start_j:=((i-1)*TEXT_LINES)+1;
+    var end_j:=i*TEXT_LINES;
+    if (end_j>len(propnames))
+      end_j:=len(propnames);
+    endif
+    
+    for (j:=start_j; j<=end_j; j:=j+1)
+      if (propnames[j])
+        this_prop:=GetObjProperty(thing,propnames[j]);
+        this_type:=TypeOf(this_prop);
+        this_prop:=Cstr(this_prop);
+        var can_edit:=1;
+        if (len(this_prop)>MAX_CHARS)
+          this_prop:=this_prop[1,MAX_CHARS];
+          can_edit:=0;
+        endif
+        y:=(j-start_j)*20+60;
+        this_layout.append("croppedtext 50 "+y+" 130 20 0 "+len(this_data));
+        this_data.append(propnames[j]);
+
+        this_layout.append("croppedtext 200 "+y+" 60 20 0 "+len(this_data));
+        this_data.append(this_type);
+
+        if (this_prop.errortext)
+          this_layout.append("croppedtext 280 "+y+" "+(width-310)+" 20 34 "+len(this_data));
+          this_data.append(this_prop.errortext);
+        elseif ( (can_edit) and  ( this_type=="Integer") or (this_type=="Double") or (this_type=="String") )
+          this_layout.append("gumppic 260 "+(y+3)+" 58");
+          this_layout.append("textentry 280 "+y+" "+(width-310)+" 20 0 "+(500+j)+" "+len(this_data));
+          this_data.append(ToggleHex(this_prop,this_type));
+        else
+          this_layout.append("croppedtext 280 "+y+" "+(width-310)+" 20 0 "+len(this_data));
+          this_data.append(this_prop);
+        endif
+        this_layout.append("checkbox 30 "+y+" 210 211 0 "+(j+700)); 
+      endif
+    endfor
+  endfor
+endfunction
+
+////////////////////////////////////////////////////////
+
+function GetGumpText(text)
+  return text[Find(text,": ",1)+2,len(text)];
+endfunction
+
+////////////////////////////////////////////////////////
+
+function GetGumpWidth()
+  case (gump_width)
+    1:  return 600;
+    2:  return 750;
+    3:  return 900;
+  endcase
+  return 0;
+endfunction
+
+////////////////////////////////////////////////////////
+
+function SetPropType(text,type)
+  case (type)
+    "Integer" : return Cint(text);
+    "Double"  : return Cdbl(text);
+  endcase
+  return text;
+endfunction
+
+////////////////////////////////////////////////////////
+
+function ToggleHex(value,value_type:=0)
+  if (!value_type)
+    value_type:=TypeOf(value);
+  endif
+  if ((value_type=="Integer") and (show_in_hex))
+    return Hex(value);
+  else
+    return Cstr(value);
+  endif
+endfunction
+
+////////////////////////////////////////////////////////

Added: trunk/096/pkg/commands/props/props.src
===================================================================
--- trunk/096/pkg/commands/props/props.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/props/props.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -0,0 +1,16 @@
+use uo;
+
+program dot_props( who )
+    var what := Target( who );
+    if (what)
+        var names := what.propnames();
+        if (names.size() != 0)
+            foreach propname in names
+                SendSysMessage( who, propname + ": " + what.getprop( propname ) );
+            endforeach
+        else
+            SendSysMessage( who, "No properties." );
+        endif
+    endif
+
+endprogram

Added: trunk/096/pkg/commands/props/setglobal.src
===================================================================
--- trunk/096/pkg/commands/props/setglobal.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/props/setglobal.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -0,0 +1,15 @@
+use uo;
+use os;
+
+
+program textcmd_setglobal( who, text )
+    var tparams := SplitWords( text );
+
+    print( "Property Name: " + tparams[1] );
+    print( "Property Value: " + tparams[2] );
+
+    var res := SetGlobalProperty( tparams[1], tparams[2] );
+    if (!res)
+        SendSysMessage( who, "Error setting property: " + res.errortext );
+    endif
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/commands/props/setobjproperty.src
===================================================================
--- trunk/096/pkg/commands/props/setobjproperty.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/props/setobjproperty.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -0,0 +1,38 @@
+/*
+ * $Id$
+ *
+ */
+ 
+use uo;
+
+program textcmd_SetObjProperty(who, text)
+	var param := SplitWords(text);
+	if ( param.size() < 2 )
+		SendSysMessage(who, "SYNTAX: .setobjproperty <prop> <value>");
+		return 0;
+	endif
+	var prop := param[1];
+	
+	SendSysMessage(who,"Select object to set the CProp on.");
+	var targ := Target( who );
+	if ( !targ )
+		SendSysMessage(who, "Cancelled.");
+		return 0;
+	endif
+	
+	var pos := find(text, param[2], Len(param[1])+1);
+	var value := text[pos, len(text)];
+	if ( value[1] in {"+","-"} )
+		// Make it an actual integer variable if it starts with +/-
+		// This makes a difference to the setting of a CProp (ie. how it's packed)
+		value := CInt(value);
+	endif
+
+	var ret_val := SetObjProperty(targ, prop, value);
+	if ( !ret_val )
+		SendSysMessage(who, "Error setting CProp ->"+ret_val);
+		return 0;
+	endif
+	
+ 	SendSysMessage(who, "Successful (set as "+TypeOf(value)+")");
+endprogram

Added: trunk/096/pkg/commands/props/setprop.src
===================================================================
--- trunk/096/pkg/commands/props/setprop.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/props/setprop.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -0,0 +1,120 @@
+/* $Id: setprop.src 385 2005-10-02 18:31:15Z panosl $
+ *
+ */
+use uo;
+
+
+program SetProperties(who, text)
+	var param := SplitWords(text);
+	if ( param.size() < 2 )
+		SendSysMessage(who, "SYNTAX: .setprop <property name> <value>");
+		return;
+	endif
+
+	var targ := target(who);
+	if ( !targ )
+		SendSysMessage(who, "Cancelled");
+		return;
+	endif
+
+	var property := Lower(param[1]);
+	var pos := Find(text, param[2], Len(param[1])+1);
+	var value := text[pos, Len(text)];
+
+	// Useful for clearing something like 'mobile.guild_title'.
+	if ( value == "NULL" )
+		value := "";
+	endif
+	var old_val := targ.get_member(property);
+	var old_type := Lower(TypeOf(old_val));
+	case ( old_type )
+		"integer"	: value := CInt(value); break;
+		"string"	: value := CStr(value); break;
+		"double"	: value := CDbl(value); break;
+		default:
+			SendSysMessage(who, "Original data-type '"+old_type+"' not supported. No changes can be made.");
+			return 0;
+	endcase
+	SendSysMessage(who, "Old Value->"+old_val);
+
+	ProcessInput(who, targ,property, value);
+
+	SendSysMessage(who, "New Value->"+targ.get_member(property));
+endprogram
+
+
+function ProcessInput(who, targ, byref property, byref value)
+	//Works on items and mobiles, so do this first.
+	if ( property in array{"x", "y", "z", "realm"} )
+		DoMovement(targ,property, value);
+		return 1;
+	elseif ( MobileProperties(who, targ,property, value) )
+		// Special mobile methods/functions were used.
+		return 1;
+	else
+		// Nothing special was needed to be done, just an ordinary member to change.
+		targ.set_member(property, value);
+		return 1;
+	endif
+endfunction
+
+
+function MobileProperties(who, targ, byref property, byref value)
+	if ( !targ.IsA(POLCLASS_MOBILE) )
+		return error;
+	endif
+	
+	case ( property )
+		"concealed":
+			if ( value > who.cmdlevel )
+				SendSysMessage(who, "You can not conceal something higher than your cmdlevel.");
+				return 1;
+			else
+				targ.concealed := value; return 1;
+			endif
+		"cmdlevel":
+			if ( value > who.cmdlevel )
+				SendSysMessage(who, "You can not set a command level higher than your own.");
+				return 1;
+			else
+				targ.cmdlevel := value; return 1;
+			endif
+		"criminal":
+			targ.SetCriminal(value); return 1;
+		"murderer":
+			targ.SetMurderer(value); return 1;
+		"poisoned":
+			targ.SetPoisoned(value); return 1;
+		"squelch":
+			targ.Squelch(value); return 1;
+		"warmode":
+			targ.SetWarMode(value); return 1;
+	endcase
+	
+	// Nothing was done here.
+	return 0;
+endfunction
+
+
+function DoMovement(targ, byref property, byref value)
+	var x := targ.x;
+	var y := targ.y;
+	var z := targ.z;
+	var realm := targ.realm;
+
+	if ( property == realm )
+		MoveObjectToRealm(targ, property, x, y, z);
+	else
+		case ( property )
+			"x": x := value;
+			"y": y := value;
+			"z": z := value;
+		endcase
+
+		if ( targ.IsA(POLCLASS_ITEM) )
+			MoveItemToLocation(targ, x, y, z, MOVEITEM_FORCELOCATION);
+		elseif ( targ.IsA(POLCLASS_MOBILE) )
+			MoveCharacterToLocation(targ, x, y, z, MOVECHAR_FORCELOCATION);
+		endif
+	endif
+endfunction

Deleted: trunk/096/pkg/commands/seer/setintproperty.src
===================================================================
--- trunk/096/pkg/commands/seer/setintproperty.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/seer/setintproperty.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,11 +0,0 @@
-use uo;
-
-program addintproperty( who, text )
-	var params := SplitWords( text );
-	var item := Target( who );
-	SetObjProperty( item, params[1], CInt(params[2]) );
-
-	print("objprop: " + GetObjProperty( item, params[1] ) );
-
-        
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/commands/test/getobjprop.src
===================================================================
--- trunk/096/pkg/commands/test/getobjprop.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/test/getobjprop.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,27 +0,0 @@
-/////////////////////////////////////////////////////////////////////////////
-//
-//
-/////////////////////////////////////////////////////////////////////////////
-use uo;
-
-program showmember( who, membername )
-    SendSysMessage( who, "Display " + membername + " of what?" );
-    var what := Target( who );
-    if (what)
-            //
-            // Note this trick: since there's an operator involved,
-            // the compiler won't change membername to "membername"
-            // like it usually does when it sees an identifier follow
-            // a dot-operator.
-            //
-        var member := GetObjProperty( what, membername );
-        var extra := CInt( member );
-        if (extra)
-            extra := " (" + Hex(extra) + ")";
-        else
-            extra := "";
-        endif
-
-        PrintTextAbovePrivate( what, "that." + membername + " = " + member + extra, who );
-    endif
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/commands/test/props.src
===================================================================
--- trunk/096/pkg/commands/test/props.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/test/props.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,16 +0,0 @@
-use uo;
-
-program dot_props( who )
-    var what := Target( who );
-    if (what)
-        var names := what.propnames();
-        if (names.size() != 0)
-            foreach propname in names
-                SendSysMessage( who, propname + ": " + what.getprop( propname ) );
-            endforeach
-        else
-            SendSysMessage( who, "No properties." );
-        endif
-    endif
-
-endprogram

Deleted: trunk/096/pkg/commands/test/smember.src
===================================================================
--- trunk/096/pkg/commands/test/smember.src	2005-11-01 17:20:30 UTC (rev 783)
+++ trunk/096/pkg/commands/test/smember.src	2005-11-01 17:45:55 UTC (rev 784)
@@ -1,16 +0,0 @@
-use uo;
-
-program showmember(who, membername)
-  SendSysMessage(who, "Display " + membername + " of what?");
-  var what := Target(who);
-  if(what)
-    var member := what.get_member(membername);
-    var extra := CInt( member );
-    if(extra)
-      extra := " (" + Hex(extra) + ")";
-    else
-      extra := "";
-    endif
-    PrintTextAbovePrivate(what, "that." + membername + " = " + member + extra, who);
-  endif
-endprogram
\ No newline at end of file



From austin at berlios.de  Tue Nov  1 18:46:45 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 18:46:45 +0100
Subject: [Poldistro-svn] r785 - trunk/096/config
Message-ID: <200511011746.jA1Hkj0e007915@sheep.berlios.de>

Author: austin
Date: 2005-11-01 18:46:36 +0100 (Tue, 01 Nov 2005)
New Revision: 785

Modified:
   trunk/096/config/cmds.cfg
Log:
Support for GM extension of commands into 'props' folder

Modified: trunk/096/config/cmds.cfg
===================================================================
--- trunk/096/config/cmds.cfg	2005-11-01 17:45:55 UTC (rev 784)
+++ trunk/096/config/cmds.cfg	2005-11-01 17:46:36 UTC (rev 785)
@@ -44,6 +44,7 @@
 CmdLevel GM
 {
 	DIR	pkg/commands/gm
+	DIR	pkg/commands/props
 }
 
 CmdLevel Admin



From austin at berlios.de  Tue Nov  1 18:49:37 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 18:49:37 +0100
Subject: [Poldistro-svn] r786 - in trunk/096/pkg/commands: gm seer test
Message-ID: <200511011749.jA1HnboP009191@sheep.berlios.de>

Author: austin
Date: 2005-11-01 18:49:36 +0100 (Tue, 01 Nov 2005)
New Revision: 786

Removed:
   trunk/096/pkg/commands/gm/showstats.src
   trunk/096/pkg/commands/seer/createlightsource.src
   trunk/096/pkg/commands/test/firestorm.src
   trunk/096/pkg/commands/test/killmods.src
Log:
Unnecessary commands.
Plus they want to use the new attributes system.
If they dont exist I dont have to fix them :p

Deleted: trunk/096/pkg/commands/gm/showstats.src
===================================================================
--- trunk/096/pkg/commands/gm/showstats.src	2005-11-01 17:46:36 UTC (rev 785)
+++ trunk/096/pkg/commands/gm/showstats.src	2005-11-01 17:49:36 UTC (rev 786)
@@ -1,14 +0,0 @@
-
-use uo;
-include "include/attributes";
-
-program textcmd_showstats( who )
-    SendSysMessage( who, "Select a mobile." );
-
-    var mobile := Target( who );
-    if (mobile)
-        PrintTextAbovePrivate( mobile, "Str: " + GetStrength(mobile), who );
-        PrintTextAbovePrivate( mobile, "Dex: " + GetDexterity(mobile), who );
-        PrintTextAbovePrivate( mobile, "Int: " + GetIntelligence(mobile), who );
-    endif
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/commands/seer/createlightsource.src
===================================================================
--- trunk/096/pkg/commands/seer/createlightsource.src	2005-11-01 17:46:36 UTC (rev 785)
+++ trunk/096/pkg/commands/seer/createlightsource.src	2005-11-01 17:49:36 UTC (rev 786)
@@ -1,43 +0,0 @@
-/* $Id$
- *
- */
-use uo;
-use os;
-
-include "include/sound";
-include "include/attributes";
-
-program command_CreateLightsource(caster)
-
-	var cast_loc := TargetCoordinates( caster );
-	if (!cast_loc.x)
-		return 0;
-	endif
-
-	if( !CheckLosAt( caster, cast_loc.x, cast_loc.y, cast_loc.z ) )
-		SendSysMessage( caster, "You don't have line of sight to that." );
-		return 0;
-	endif
-
-	var thecritter;
-	var parms := {};
-
-	parms .+ script := "tamed";
-	parms .+ name := "a magical lightsource";
-
-	thecritter := CreateNpcFromTemplate("wisp", cast_loc.x, cast_loc.y,cast_loc.z, parms, caster.realm);
-	SetObjProperty(thecritter,"master", caster.serial);
-	SetObjProperty(thecritter, "summoned",1);
-	var thelight := CreateItemAtLocation(1, 1, 1, 0xa22, 1, thecritter.realm);
-	thelight.newbie := 1;
-	EquipItem(thecritter, thelight);
-	SetHp(thecritter, 1);
-	SetBaseStrength(thecritter,1);
-	SetMana(thecritter, 1);
-	SetBaseIntelligence(thecritter,1);
-	PlaySoundEffect(caster, SFX_SPELL_SUMMON_ELEMENTAL);
-	Detach();
-	sleep(120);
-	ApplyRawDamage(thecritter, GetHp(thecritter) + 3); //should kill it off
-
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/commands/test/firestorm.src
===================================================================
--- trunk/096/pkg/commands/test/firestorm.src	2005-11-01 17:46:36 UTC (rev 785)
+++ trunk/096/pkg/commands/test/firestorm.src	2005-11-01 17:49:36 UTC (rev 786)
@@ -1,37 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/client";
-include "include/attributes";
-
-program flamewind(who)
-  var newtarg;
-  var x, y;
-  var i := 20;
-  Detach();
-  PlaySoundEffect(who, 0x231);
-  while(i > 0)
-    x := who.x + RandomInt(15) - 7;
-    y := who.y + RandomInt(15) - 7;
-    newtarg := CreateItemAtLocation(x, y, who.z, 0xeed, 1, who.realm);
-    newtarg.graphic := 1;
-    PlayMovingEffectXYZ( newtarg.x, newtarg.y,(newtarg.z + 80), newtarg.x, newtarg.y, newtarg.z, 0x36d4, 0x18, 0x10, 0, who.realm);
-    RainDamage(newtarg);
-    i := i - 1;
-    DestroyItem(newtarg);
-    sleepms(200);
-  endwhile
-endprogram
-
-function RainDamage(targ)
-  var victims := ListMobilesNearLocationEx(targ.x, targ.y, targ.z, 3, 0x3, targ.realm);
-  foreach targ in victims
-    if((GetHp(targ)) && (!targ.cmdlevel))
-      PlayObjectCenteredEffect(targ, 0x36cb, 7, 0x10);
-      PlaySoundEffect(targ, 0x228);
-      SetObjProperty(targ, "guardkill", 1);
-      ApplyRawDamage(targ, 1000);
-    endif
-  endforeach
-endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/commands/test/killmods.src
===================================================================
--- trunk/096/pkg/commands/test/killmods.src	2005-11-01 17:46:36 UTC (rev 785)
+++ trunk/096/pkg/commands/test/killmods.src	2005-11-01 17:49:36 UTC (rev 786)
@@ -1,13 +0,0 @@
-use uo;
-include "include/attributes";
-
-program textcmd_setint(chr)
-    var who := Target(chr);
-    SetDexterityMod(who, 0);
-    SetIntelligenceMod(who, 0);
-    SetStrengthMod(who, 0);
-    who.ar_mod := 0;
-    foreach thing in GetAttributeIds()
-      SetAttributeTemporaryMod(chr, thing, 0);
-    endforeach
-endprogram
\ No newline at end of file



From austin at berlios.de  Tue Nov  1 18:50:53 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 18:50:53 +0100
Subject: [Poldistro-svn] r787 - trunk/096/pkg/items/doors
Message-ID: <200511011750.jA1HorDF010227@sheep.berlios.de>

Author: austin
Date: 2005-11-01 18:50:52 +0100 (Tue, 01 Nov 2005)
New Revision: 787

Modified:
   trunk/096/pkg/items/doors/door.src
Log:
It had.. the include line for attributes.
What? Does a fucking door think it needs mana now ?
I WILL MYSELF TO MOVE! 

Modified: trunk/096/pkg/items/doors/door.src
===================================================================
--- trunk/096/pkg/items/doors/door.src	2005-11-01 17:49:36 UTC (rev 786)
+++ trunk/096/pkg/items/doors/door.src	2005-11-01 17:50:52 UTC (rev 787)
@@ -3,8 +3,8 @@
 use cfgfile;
 
 include "doors";
-include "include/attributes";
 
+
 program use_door(chr, door)
   if(GetObjProperty(door, "#inuse"))
     return;



From austin at berlios.de  Tue Nov  1 19:04:55 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 19:04:55 +0100
Subject: [Poldistro-svn] r788 - in trunk/096/pkg/systems/attributes: . config hooks
Message-ID: <200511011804.jA1I4tag016476@sheep.berlios.de>

Author: austin
Date: 2005-11-01 19:04:53 +0100 (Tue, 01 Nov 2005)
New Revision: 788

Modified:
   trunk/096/pkg/systems/attributes/config/settings.cfg
   trunk/096/pkg/systems/attributes/hooks/vitalInit.src
   trunk/096/pkg/systems/attributes/vitals.cfg
Log:
Added support for a 'Hunger' vital so we can work towards removing hunger as a CProp. 

0 hunger means the person is really full.
100 hunger means the United Nations must be taking care of that country's food problem! Poor Ethopians :(

Modified: trunk/096/pkg/systems/attributes/config/settings.cfg
===================================================================
--- trunk/096/pkg/systems/attributes/config/settings.cfg	2005-11-01 17:50:52 UTC (rev 787)
+++ trunk/096/pkg/systems/attributes/config/settings.cfg	2005-11-01 18:04:53 UTC (rev 788)
@@ -5,7 +5,8 @@
 	# Base stat regenerating rates in points per minute. (int)
 	Hits			20
 	Mana			10
-	Stamina			25	
+	Stamina			25
+	Hunger			5
 }
 
 Elem Skills

Modified: trunk/096/pkg/systems/attributes/hooks/vitalInit.src
===================================================================
--- trunk/096/pkg/systems/attributes/hooks/vitalInit.src	2005-11-01 17:50:52 UTC (rev 787)
+++ trunk/096/pkg/systems/attributes/hooks/vitalInit.src	2005-11-01 18:04:53 UTC (rev 788)
@@ -77,6 +77,27 @@
 endfunction
 
 // *****
+// Hunger Functions
+// Note: This vital is not linked to any attributes.
+// *****
+exported function GetHungerRegenRate(mobile)
+	var base_regen := CInt(AP_GetSettingsCfgElem("Regen").Hunger) * 100;
+
+	return base_regen + AP_GetVitalRegenRateMod(mobile, "Hunger");
+endfunction
+
+exported function GetHungerMaximumValue(mobile)
+	var vital_points := GetNPCVitalSetting(mobile, "HUNGER");
+	if ( !vital_points )
+		vital_points := 100*100; // '100' points.
+	endif
+
+	return vital_points;
+endfunction
+
+
+
+// *****
 // Private Function for NPC stuff
 // *****
 function GetNPCVitalSetting(mobile, vital)

Modified: trunk/096/pkg/systems/attributes/vitals.cfg
===================================================================
--- trunk/096/pkg/systems/attributes/vitals.cfg	2005-11-01 17:50:52 UTC (rev 787)
+++ trunk/096/pkg/systems/attributes/vitals.cfg	2005-11-01 18:04:53 UTC (rev 788)
@@ -1,4 +1,4 @@
-# $Id: vitals.cfg,v 1.1 2004/03/16 14:05:46 folko Exp $
+# $Id$
 #
 # Purpose:
 # Defines Attribute names and aliases
@@ -27,19 +27,28 @@
 
 Vital Hits
 {
-    Alias               Life
-    RegenRateFunction	:attributes:hooks/vitalInit:GetHitsRegenRate
-    MaximumFunction	:attributes:hooks/vitalInit:GetHitsMaximumValue
+	Alias               Life
+	RegenRateFunction	:attributes:hooks/vitalInit:GetHitsRegenRate
+	MaximumFunction		:attributes:hooks/vitalInit:GetHitsMaximumValue
 }
 
 Vital Mana
 {
-    RegenRateFunction	:attributes:hooks/vitalInit:GetManaRegenRate
-    MaximumFunction	:attributes:hooks/vitalInit:GetManaMaximumValue
+	RegenRateFunction	:attributes:hooks/vitalInit:GetManaRegenRate
+	MaximumFunction		:attributes:hooks/vitalInit:GetManaMaximumValue
 }
 
 Vital Stamina
 {
-    RegenRateFunction	:attributes:hooks/vitalInit:GetStaminaRegenRate
-    MaximumFunction	:attributes:hooks/vitalInit:GetStaminaMaximumValue
+	RegenRateFunction	:attributes:hooks/vitalInit:GetStaminaRegenRate
+	MaximumFunction		:attributes:hooks/vitalInit:GetStaminaMaximumValue
 }
+
+Vital Hunger
+{
+	// Note: This vital is not linked to any attributes.
+	RegenRateFunction	:attributes:hooks/vitalInit:GetHungerRegenRate
+	MaximumFunction		:attributes:books/vitalInit:GetHungerMaximumValue
+	
+	RegenWhileDead		1
+}



From austin at berlios.de  Tue Nov  1 19:14:01 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 19:14:01 +0100
Subject: [Poldistro-svn] r789 - trunk/096/pkg/items/food
Message-ID: <200511011814.jA1IE1W8021996@sheep.berlios.de>

Author: austin
Date: 2005-11-01 19:13:59 +0100 (Tue, 01 Nov 2005)
New Revision: 789

Modified:
   trunk/096/pkg/items/food/hunger.src
Log:
Updated to use new attributes system.
Updated to use Hunger vital rather than the cprop.


Modified: trunk/096/pkg/items/food/hunger.src
===================================================================
--- trunk/096/pkg/items/food/hunger.src	2005-11-01 18:04:53 UTC (rev 788)
+++ trunk/096/pkg/items/food/hunger.src	2005-11-01 18:13:59 UTC (rev 789)
@@ -2,46 +2,54 @@
 use os;
 use util;
 
-include "include/attributes";
+include ":attributes:attributes";
 
 program Hunger(chr)
- if(chr.cmdlevel == 0)
-  var hunger;
-  while(chr)
-    hunger := CInt(GetObjProperty(chr, "hunger"));
-    if(hunger >= 9)
-	  hunger := 9;
-    elseif (!hunger)
-      hunger :=0;
-    endif
-    var who := chr;
-    hunger := hunger +1;
-    SetObjProperty(chr, "hunger", hunger);
-    case (hunger)
-	  0 : SetStaminaRegenRate(who, 1000);
-	  1 : SetStaminaRegenRate(who, 1300);
-	  2 : SetStaminaRegenRate(who, 1200);
-	  3 : SetStaminaRegenRate(who, 1200);
-	  4 : SetStaminaRegenRate(who, 1200);
-	  5 : SetStaminaRegenRate(who, 1200);
-	  6 : SetStaminaRegenRate(who, 1200);
-	  7 : SetStaminaRegenRate(who, 1000);
-	  8 : SetStaminaRegenRate(who, 800);
-	  9 : SetStaminaRegenRate(who, 600);
-	  10: SetStaminaRegenRate(who, 400);
-    endcase
-	if (hunger > 8)
-		if (GetStamina(chr) > GetMaxStamina(chr))
-			SetStamina(chr,GetMaxStamina(chr));
-			RecalcVitals(chr);
+	if( chr.cmdlevel )
+		return 0;
+	endif
+		
+	var hunger;
+	while( chr )
+		hunger := CInt(AP_GetVital(chr, "Hunger") / 10);
+		if(hunger >= 9)
+			hunger := 9;
+		elseif (!hunger)
+			hunger :=0;
 		endif
-	endif
-    case (hunger)
-	  4 : SendSysMessage(chr, "You could use a bite to eat...");
-	  8 : SendSysMessage(chr, "You're getting pretty hungry...");
-	  10: SendSysMessage(chr, "You're absolutely famished!");
-    endcase
-    sleep(60 * 60);
-  endwhile
- endif
+		
+		hunger := hunger +1;
+		SetObjProperty(chr, "hunger", hunger);
+		
+		var regen := AP_GetVitalRegenRateMod(chr, "Hunger");
+		case (hunger)
+			0 : regen := regen - 200;
+			1 : regen := regen + 100;
+			2 : regen := regen + 0;
+			3 : regen := regen + 0;
+			4 : regen := regen + 0;
+			5 : regen := regen + 0;
+			6 : regen := regen + 0;
+			7 : regen := regen - 100;
+			8 : regen := regen - 400;
+			9 : regen := regen - 600;
+			10: regen := regen - 800;
+		endcase
+		AP_SetVitalRegenRateMod(chr, "Hunger", regen);
+		
+		if (hunger > 8)
+			if (AP_GetVital(chr, "Stamina") > AP_GetVitalMaximumValue(chr, "Stamina"))
+				AP_SetVital(chr, "Stamina", AP_GetVitalMaximumValue(chr, "Stamina"));
+				RecalcVitals(chr);
+			endif
+		endif
+
+		case (hunger)
+			4 : SendSysMessage(chr, "You could use a bite to eat...");
+			8 : SendSysMessage(chr, "You're getting pretty hungry...");
+			10: SendSysMessage(chr, "You're absolutely famished!");
+		endcase
+
+		sleep(60 * 60);
+	endwhile
 endprogram



From austin at berlios.de  Tue Nov  1 19:16:13 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 19:16:13 +0100
Subject: [Poldistro-svn] r790 - trunk/096/pkg/items/guildstone
Message-ID: <200511011816.jA1IGD6Q022776@sheep.berlios.de>

Author: austin
Date: 2005-11-01 19:16:12 +0100 (Tue, 01 Nov 2005)
New Revision: 790

Modified:
   trunk/096/pkg/items/guildstone/guildMethods.src
Log:
Guildstone wants attributes too I guess ...
It wants the "Kumbaya" skill. The guildmates gather around a fire and sing in perfect harmony... little do they know the enemy guild is surrounding them. The guildstone uses the cry skill ;_;

Modified: trunk/096/pkg/items/guildstone/guildMethods.src
===================================================================
--- trunk/096/pkg/items/guildstone/guildMethods.src	2005-11-01 18:13:59 UTC (rev 789)
+++ trunk/096/pkg/items/guildstone/guildMethods.src	2005-11-01 18:16:12 UTC (rev 790)
@@ -3,7 +3,6 @@
 use cfgfile;
 use util;
 
-include "include/attributes";
 include "include/canAccess";
 
 program Install()



From austin at berlios.de  Tue Nov  1 19:17:51 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 19:17:51 +0100
Subject: [Poldistro-svn] r791 - trunk/096/pkg/items/repaircontract
Message-ID: <200511011817.jA1IHpE8023825@sheep.berlios.de>

Author: austin
Date: 2005-11-01 19:17:50 +0100 (Tue, 01 Nov 2005)
New Revision: 791

Modified:
   trunk/096/pkg/items/repaircontract/repairDeed.src
Log:
Im running out of comments. I am assuming someone who was obsessive compulsive decided to put attributes in every script.
Musta been one of those damn liberals... "Im worried about the self esteem of the repair deed, so lets let it think it can have skills too!"

Modified: trunk/096/pkg/items/repaircontract/repairDeed.src
===================================================================
--- trunk/096/pkg/items/repaircontract/repairDeed.src	2005-11-01 18:16:12 UTC (rev 790)
+++ trunk/096/pkg/items/repaircontract/repairDeed.src	2005-11-01 18:17:50 UTC (rev 791)
@@ -1,8 +1,8 @@
 use uo;
+use util;
 use cfgfile;
 
 include "include/canAccess";
-include "include/attributes";
 include "include/dist";
 
 program usescript_repairDeed(who, deed)



From austin at berlios.de  Tue Nov  1 19:23:50 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 19:23:50 +0100
Subject: [Poldistro-svn] r792 - trunk/096/scripts/include
Message-ID: <200511011823.jA1INofP028151@sheep.berlios.de>

Author: austin
Date: 2005-11-01 19:23:46 +0100 (Tue, 01 Nov 2005)
New Revision: 792

Modified:
   trunk/096/scripts/include/statMod.inc
Log:
Updated for new attributes system.

Modified: trunk/096/scripts/include/statMod.inc
===================================================================
--- trunk/096/scripts/include/statMod.inc	2005-11-01 18:17:50 UTC (rev 791)
+++ trunk/096/scripts/include/statMod.inc	2005-11-01 18:23:46 UTC (rev 792)
@@ -1,7 +1,8 @@
 use uo;
 use util;
-include "include/attributes";
 
+include ":attributes:attributes";
+
 function GetModAmount(magery)
   var mod_amount := CInt(RandomInt(3) +(magery/10));
   if(mod_amount > 10)
@@ -34,9 +35,9 @@
 function DoTempMod(who, stat, amt, duration)
   var mod;
   case(stat)
-    "str":  mod := "#ss";  SetStrengthMod(who, GetStrengthMod(who) + amt);
-    "dex":  mod := "#dd";  SetDexterityMod(who, GetDexterityMod(who) + amt);
-    "int":  mod := "#ii";  SetIntelligenceMod(who, GetIntelligenceMod(who) + amt);
+    "str":  mod := "#ss";  AP_SetStatMod(who, "Strength", AP_GetStatMod(who, "Strength") + amt);
+    "dex":  mod := "#dd";  AP_SetStatMod(who, "Dexterity", AP_GetStatMod(who, "Dexterity") + amt);
+    "int":  mod := "#ii";  AP_SetStatMod(who, "Intelligence", AP_GetStatMod(who, "Intelligence") + amt);
     "ar" :  mod := "#ar";  who.ar_mod           := who.ar_mod + amt;
 	"p"  :  mod := "#pp";  who.setParalyzed(1);
   endcase



From austin at berlios.de  Tue Nov  1 19:56:46 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 19:56:46 +0100
Subject: [Poldistro-svn] r793 - trunk/096/pkg/items/runebook
Message-ID: <200511011856.jA1Iukwn011556@sheep.berlios.de>

Author: austin
Date: 2005-11-01 19:56:44 +0100 (Tue, 01 Nov 2005)
New Revision: 793

Modified:
   trunk/096/pkg/items/runebook/customSpells.inc
Log:
Will compile... but definately needs some T.L.C.

Modified: trunk/096/pkg/items/runebook/customSpells.inc
===================================================================
--- trunk/096/pkg/items/runebook/customSpells.inc	2005-11-01 18:23:46 UTC (rev 792)
+++ trunk/096/pkg/items/runebook/customSpells.inc	2005-11-01 18:56:44 UTC (rev 793)
@@ -3,15 +3,14 @@
 
 include "include/client";
 include "include/sound";
-include "include/attributes";
 include "include/objtype";
 include "include/spellRestrictions";
+include ":attributes:attributes";
 
-
 function custom_recall(caster, parms, book)
   book := book; // stops ecompile "not used" warning
   caster.hidden := 0;
-  if(GetMana(caster) < 11)
+  if(AP_GetVital(caster, "Mana") < 11)
     caster.frozen :=1;
 	PerformAction(caster,ANIM_CAST_DIR);
     sleepms(1200);
@@ -63,7 +62,7 @@
 function custom_gate(caster, parms, book)
   book := book; // stops ecompile "not used" warning
   caster.hidden := 0;
-  if(GetMana(caster) < 40)
+  if(AP_GetVital(caster, "Mana") < 40)
     caster.frozen :=1;
 	PerformAction(caster,ANIM_CAST_DIR);
     sleepms(1200);



From austin at berlios.de  Tue Nov  1 19:57:52 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 19:57:52 +0100
Subject: [Poldistro-svn] r794 - trunk/096/scripts/include
Message-ID: <200511011857.jA1Ivqep012575@sheep.berlios.de>

Author: austin
Date: 2005-11-01 19:57:40 +0100 (Tue, 01 Nov 2005)
New Revision: 794

Modified:
   trunk/096/scripts/include/spellRestrictions.inc
Log:
Im 99% sure this is broken with the new attributes system.


Modified: trunk/096/scripts/include/spellRestrictions.inc
===================================================================
--- trunk/096/scripts/include/spellRestrictions.inc	2005-11-01 18:56:44 UTC (rev 793)
+++ trunk/096/scripts/include/spellRestrictions.inc	2005-11-01 18:57:40 UTC (rev 794)
@@ -4,7 +4,6 @@
 use util;
 
 include "include/fields";
-include "include/attributes";
 include "include/client";
 include "include/tileEffects";
 include "include/sound";
@@ -138,7 +137,7 @@
     endif
   endif
   var points := getpoints(circle, spellscroll, SKILLID_MAGERY);
-  AwardRawSkillPoints(caster, SKILLID_MAGERY, points);
+  //AwardRawSkillPoints(caster, SKILLID_MAGERY, points);
   var newparms := {};
   newparms[1] := caster;
   newparms[2] := cast_on;
@@ -241,9 +240,9 @@
 	// called by: most spells
 	// returns: amount of damage not resisted?
 
-        var magery := CInt(GetEffectiveSkill(caster, SKILLID_MAGERY));
-        var evalint := CInt(GetEffectiveSkill(caster, SKILLID_EVALINT));
-        var resist := CInt(GetEffectiveSkill(cast_on, SKILLID_MAGICRESISTANCE));
+        var magery := CInt(AP_GetSkill(caster, SKILLID_MAGERY));
+        var evalint := CInt(AP_GetSkill(caster, SKILLID_EVALINT));
+        var resist := CInt(AP_GetSkill(cast_on, SKILLID_MAGICRESISTANCE));
         
         // chk1 relates to the resist ability.
         var chk1 := (resist / 5);
@@ -293,7 +292,7 @@
 function CalcSpellDamage(circle, caster, cast_on)
   var die_string := circle+"d8";
   var dmg := RandomDiceRoll(die_string);
-  dmg := dmg + CInt(GetEffectiveSkill(caster, SKILLID_MAGERY)/10);
+  dmg := dmg + CInt(AP_GetSkill(caster, SKILLID_MAGERY)/10);
   if(dmg > (circle * 8))
     dmg := circle * 8;
   endif
@@ -316,7 +315,7 @@
   var val := SplitWords(spellcfg[id].val);
   var times := CInt(val[1]);
   var slp   := CInt(val[2]);
-  var mhp := GetHp(me);
+  var mhp := AP_GetVital(me, "Hits");
   var umana, diff;
   var n := 1;
   if(scroll == 0)
@@ -348,11 +347,11 @@
   else
     return 0;
   endif
-  if((mhp > GetHp(me)) && ((RandomInt(99)+1) > (GetEffectiveSkill(me, SKILLID_WRESTLING)/2)))
+  if((mhp > AP_GetVital(me, "Hits")) && ((RandomInt(99)+1) > (AP_GetSkill(me, SKILLID_WRESTLING)/2)))
     SendSysMessage(me,"You lost your concentration.", 3, 40);
     return 0;
   endif
-  if (umana > GetMana(me))
+  if (umana > AP_GetVital(me, "Mana"))
     me.frozen :=1;
     PerformAction(me,ANIM_CAST_DIR);
     sleepms(1200);
@@ -365,7 +364,7 @@
   if(can_cast(me))
     me.frozen :=1;
     for (n:=1; n<=times; n:=n+1)
-      if((mhp > GetHp(me)) && ((RandomInt(99)+1) > (GetEffectiveSkill(me, SKILLID_WRESTLING)/2)))
+      if((mhp > AP_GetVital(me, "Hits")) && ((RandomInt(99)+1) > (AP_GetSkill(me, SKILLID_WRESTLING)/2)))
         SendSysMessage(me,"You lost your concentration.", 3, 40);
         PlaySoundEffect(me,0x005d);
         PlayObjectCenteredEffect(me, 0x3735,0x0a, 0x1e);
@@ -380,7 +379,7 @@
     endif
     me.frozen :=0;
     if (CheckSkill(me,SKILLID_MAGERY, diff, 0))
-      if((mhp > GetHp(me)) && ((RandomInt(99)+1) > (GetEffectiveSkill(me, SKILLID_WRESTLING)/2)))
+      if((mhp > AP_GetVital(me, "Hits")) && ((RandomInt(99)+1) > (AP_GetSkill(me, SKILLID_WRESTLING)/2)))
         SendSysMessage(me,"You lost your concentration.", 3, 40);
         return 0;
       endif
@@ -430,9 +429,9 @@
     7: umana := 40;
     8: umana := 50;
   endcase
-  var mana := GetMana(who);
+  var mana := AP_GetVital(who, "Mana");
   if(mana >= umana)
-    SetMana(who, Cint(mana - umana));
+    AP_SetVital(who, "Mana", Cint(mana - umana));
     return 1;
   else
     SendSysMessage(who,"You do not have enough mana to cast that.", 3, 40);
@@ -453,7 +452,7 @@
     7:   diff := 85;     points := 190;    umana :=  40;
     8:   diff := 95;     points := 210;    umana :=  50;
   endcase
-  if(umana > GetMana(me))
+  if(umana > AP_GetVital(me, "Mana"))
     return 0;
   endif
   if(can_cast(me))
@@ -491,7 +490,7 @@
       8:   points := 180; diff := 100;
     endcase
   endif
-  var skill := GetEffectiveSkill(caster, skillid);
+  var skill := AP_GetSkill(caster, skillid);
   if(skill > (diff - 20))
     if((skill - diff) <= 5)
       points := points;
@@ -521,7 +520,7 @@
     7:   points := 160; diff := 86;
     8:   points := 180; diff := 100;
   endcase
-  var skill := GetEffectiveSkill(victim, skillid);
+  var skill := AP_GetSkill(victim, skillid);
   if(skill > (diff - 20))
     if((skill - diff) <= 5)
       points := points;
@@ -583,9 +582,9 @@
     9: umana :=  75;
    10: umana := 100;
   endcase
-  var mana := GetMana(who);
+  var mana := AP_GetVital(who, "Mana");
   if(mana >= umana)
-    var ms := SetMana(who, Cint(mana - umana));
+    var ms := AP_SetVital(who, "Mana", Cint(mana - umana));
     return 1;
   else
     SendSysMessage(who,"You do not have enough mana to cast that.", 3, 40);



From austin at berlios.de  Tue Nov  1 20:00:35 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 20:00:35 +0100
Subject: [Poldistro-svn] r795 - trunk/096/pkg/items
Message-ID: <200511011900.jA1J0Zii014582@sheep.berlios.de>

Author: austin
Date: 2005-11-01 20:00:02 +0100 (Tue, 01 Nov 2005)
New Revision: 795

Removed:
   trunk/096/pkg/items/training/
Log:
Submiting a newer version of this.



From austin at berlios.de  Tue Nov  1 20:21:26 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 20:21:26 +0100
Subject: [Poldistro-svn] r796 - in trunk/096/pkg/systems/combat: . commands include
Message-ID: <200511011921.jA1JLQlU013013@sheep.berlios.de>

Author: austin
Date: 2005-11-01 20:21:13 +0100 (Tue, 01 Nov 2005)
New Revision: 796

Added:
   trunk/096/pkg/systems/combat/armorHitScripts/
   trunk/096/pkg/systems/combat/commands/
   trunk/096/pkg/systems/combat/commands/gm/
   trunk/096/pkg/systems/combat/commands/player/
   trunk/096/pkg/systems/combat/config/
   trunk/096/pkg/systems/combat/hooks/
   trunk/096/pkg/systems/combat/include/
   trunk/096/pkg/systems/combat/include/weaponInfo.inc
   trunk/096/pkg/systems/combat/weaponHitScripts/
Log:
Folders to later organize the combat system.
Added weaponInfo.inc to make retrieving information on a weapon a little easier.

Added: trunk/096/pkg/systems/combat/include/weaponInfo.inc
===================================================================
--- trunk/096/pkg/systems/combat/include/weaponInfo.inc	2005-11-01 19:00:02 UTC (rev 795)
+++ trunk/096/pkg/systems/combat/include/weaponInfo.inc	2005-11-01 19:21:13 UTC (rev 796)
@@ -0,0 +1,28 @@
+/*
+ * $Id$
+ *
+ */
+
+use cfgfile;
+
+/*
+ * CS_GetWeaponInfo(weapon, prop_name)
+ *
+ * Purpose
+ * Retrieves a config property for a weapon.
+ *
+ * Parameters
+ * weapon:	Weapon that is being looked up.
+ * prop_name:	Itemdesc.cfg property to retrieve.
+ *
+ * Return value
+ * Returns a string
+ *
+ */
+function CS_GetWeaponInfo(weapon, prop_name)
+	var config := ReadConfigFile(":*:itemdesc");
+	config := Config[weapon.objtype];
+	
+	return GetConfigString(config, prop_name);
+endfunction
+



From austin at berlios.de  Tue Nov  1 20:41:37 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 20:41:37 +0100
Subject: [Poldistro-svn] r797 - in trunk/096/pkg/items: . training training/archeryButte training/config training/include training/pocketDip training/trainingDummy
Message-ID: <200511011941.jA1JfbhU031750@sheep.berlios.de>

Author: austin
Date: 2005-11-01 20:41:37 +0100 (Tue, 01 Nov 2005)
New Revision: 797

Added:
   trunk/096/pkg/items/training/
   trunk/096/pkg/items/training/archeryButte/
   trunk/096/pkg/items/training/archeryButte/use.src
   trunk/096/pkg/items/training/config/
   trunk/096/pkg/items/training/config/icp.cfg
   trunk/096/pkg/items/training/include/
   trunk/096/pkg/items/training/include/training.inc
   trunk/096/pkg/items/training/itemdesc.cfg
   trunk/096/pkg/items/training/pkg.cfg
   trunk/096/pkg/items/training/pocketDip/
   trunk/096/pkg/items/training/pocketDip/use.src
   trunk/096/pkg/items/training/trainingDummy/
   trunk/096/pkg/items/training/trainingDummy/control.src
   trunk/096/pkg/items/training/trainingDummy/use.src
Log:
New training package.

Added: trunk/096/pkg/items/training/archeryButte/use.src
===================================================================
--- trunk/096/pkg/items/training/archeryButte/use.src	2005-11-01 19:21:13 UTC (rev 796)
+++ trunk/096/pkg/items/training/archeryButte/use.src	2005-11-01 19:41:37 UTC (rev 797)
@@ -0,0 +1,97 @@
+use uo;
+use os;
+use util;
+use cfgfile;
+
+include ":attributes:attributes";
+include ":combat:weaponInfo";
+include ":training:training";
+
+CONST ANIM_GET_HIT := 0x14;
+
+program ArcheryButte(who, butte)
+	if ( butte.container )
+		return 0;
+	endif
+	
+	var weapon := who.weapon;
+	var weapon_attrib := CS_GetWeaponInfo(weapon, "Attribute");
+	var weapon_anim := CInt(CS_GetWeaponInfo(weapon, "Anim"));
+	var miss_sound := CInt(CS_GetWeaponInfo(weapon, "MissSound"));
+	var hit_sound := CInt(CS_GetWeaponInfo(weapon, "Hitsound"));
+	var projectile_anim := CInt(CS_GetWeaponInfo(weapon, "ProjectileAnim"));
+	var projectile_type := CInt(CS_GetWeaponInfo(weapon, "ProjectileType"));
+	
+	if ( Distance(who, butte) == 1 )
+		RecoverAmmo(who, butte);
+		return 0;
+	elseif ( !Lower(weapon_attrib)["archery"] )
+		SendSysMessage(who, "You need to use a missile weapon.");
+		return 0;
+	elseif ( !TP_CheckRange(who, weapon, butte) )
+		return 0;
+	endif
+		
+	if ( !ConsumeSubstance(who.backpack, projectile_type, 1) )
+		SendSysMessage(who, "You do not have any ammo for this weapon.");
+		return 0;
+	endif
+	
+	PerformAction(who, weapon_anim);
+	sleep(1);
+	
+	PlayMovingEffect(who, butte, projectile_anim, 10, 0, 0);
+
+	if ( SkillCheck(who, weapon_attrib, -1, 0, TP_CanAdvance(who, weapon_attrib)) > 0 )
+		PlaySoundEffect(who, hit_sound);
+				
+		PrintTextAbove(butte, DetermineHit(who, weapon_attrib));
+			
+		if ( RandomInt(2) )
+			set_critical(1);
+			var ammo := CInt(GetObjProperty(butte, "Ammo-"+projectile_type));
+			ammo := ammo + 1;
+			SetObjProperty(butte, "Ammo-"+projectile_type, ammo);
+			set_critical(0);
+		endif
+	else
+		PlaySoundEffect(who, miss_sound);
+	endif
+	
+	sleep(3);	
+endprogram
+
+function DetermineHit(who, weapon_attrib)
+	if ( SkillCheck(who, weapon_attrib, RandomDiceRoll("40d3"), 0, ADV_DISABLE) > 0 )
+		return "*Bullseye*";
+	elseif ( SkillCheck(who, weapon_attrib, RandomDiceRoll("30d3"), 0, ADV_DISABLE) > 0 )
+		return "*Hit the inner red ring*";
+	elseif ( SkillCheck(who, weapon_attrib, RandomDiceRoll("20d3"), 0, ADV_DISABLE) > 0 )
+		return "*Hit the inner white ring*";
+	elseif ( SkillCheck(who, weapon_attrib, RandomDiceRoll("10d3"), 0, ADV_DISABLE) > 0 )
+		return "*Hit the outer red ring*";
+	else
+		return "*It hit the straw*";
+	endif
+endfunction
+
+function RecoverAmmo(who, butte)
+	var prop_list := GetObjPropertyNames(butte);
+	
+	if ( prop_list.size() > 0 )
+		foreach c_prop in prop_list
+			if ( c_prop["Ammo-"] )
+				var ammo := c_prop;
+				ammo["Ammo-"] := "";
+				
+				CreateItemInBackPack(who, CInt(ammo), CInt(GetObjProperty(butte, c_prop)));
+				SendSysMessage(who, "You recover some ammo.");
+				
+				EraseObjProperty(butte, c_prop);
+			endif
+			sleepms(2);
+		endforeach
+	else
+		SendSysMessage(who, "There is no ammunition to recover from this butte.");
+	endif
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/items/training/config/icp.cfg
===================================================================
--- trunk/096/pkg/items/training/config/icp.cfg	2005-11-01 19:21:13 UTC (rev 796)
+++ trunk/096/pkg/items/training/config/icp.cfg	2005-11-01 19:41:37 UTC (rev 797)
@@ -0,0 +1,17 @@
+ICP Register
+{
+	Name		Training
+	Version		1.0
+	
+	Description	Items for training various skills.
+		
+	Creator		Austin
+	C_Email		AustinHeilman at gmail.com
+	
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com	
+	
+	//Script	cmdlevel path
+	
+	//TextCmd	cmdlevel path	
+}

Added: trunk/096/pkg/items/training/include/training.inc
===================================================================
--- trunk/096/pkg/items/training/include/training.inc	2005-11-01 19:21:13 UTC (rev 796)
+++ trunk/096/pkg/items/training/include/training.inc	2005-11-01 19:41:37 UTC (rev 797)
@@ -0,0 +1,63 @@
+/*
+ * $Id$
+ *
+ */
+use uo;
+use cfgfile;
+
+include ":attributes:attributes";
+include ":combat:weaponInfo";
+
+/*
+ * TP_CheckWeaponRange(mobile, weapon, targ)
+ *
+ * Purpose
+ * Checks if the weapon the mobile is using can reach the target.
+ *
+ * Parameters
+ * mobile:	Mobile using the weapon on the target.
+ * weapon:	Weapon that is being used.
+ * targ:	Object that is begin targetted.
+ *
+ * Return value
+ * Returns 1 if the weapon can reach.
+ * Returns 0 if the weapon can't reach.
+ *
+ */
+function TP_CheckRange(mobile, weapon, targ)
+	var wpn_range := CInt(CS_GetWeaponInfo(weapon, "MaxRange"));
+	if ( !wpn_range )
+		wpn_range := 1;
+	endif
+		
+	if ( Distance(mobile, targ) > wpn_range )
+		SendSysMessage(mobile, "You are too far away.");
+		return 0;
+	endif
+	
+	return wpn_range;
+endfunction
+
+/*
+ * TP_CanAdvance(mobile, attrib_name)
+ *
+ * Purpose
+ * Checks if a mobile's skill is low enough to gain from the training tool.
+ *
+ * Parameters
+ * mobile:	Mobile doing the training.
+ * attrib_name:	Attribute to advance.
+ *
+ * Return value
+ * Returns ADV_SKILL if the skill can advance.
+ * Returns ADV_DISABLE if the skill is too high.
+ *
+ */
+function TP_CanAdvance(mobile, attrib_name)
+	if ( CDbl(AP_GetTrueSkill(mobile, attrib_name)) > Cdbl(30) )
+		// Skill is higher than 30%
+		return ADV_DISABLE;
+	else
+		return ADV_SKILL;
+	endif
+endfunction

Added: trunk/096/pkg/items/training/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/training/itemdesc.cfg	2005-11-01 19:21:13 UTC (rev 796)
+++ trunk/096/pkg/items/training/itemdesc.cfg	2005-11-01 19:41:37 UTC (rev 797)
@@ -0,0 +1,52 @@
+Item 0x100A
+{
+	Name			ArcheryButte
+	
+	DoubleClickRange	10
+	
+	Script			archeryButte/use
+}
+Item 0x100B
+{
+	Name			ArcheryButte2
+	
+	DoubleClickRange	10
+	
+	Script			archeryButte/use
+}
+
+Item 0x1070
+{
+	Name			TrainingDummy
+	
+	DoubleClickRange	5
+	
+	ControlScript		trainingDummy/control
+	Script			trainingDummy/use
+}
+Item 0x1074
+{
+	Name			TrainingDummy2
+	
+	DoubleClickRange	5
+	
+	ControlScript		trainingDummy/control
+	Script			trainingDummy/use
+}
+
+Item 0x1EC0
+{
+	Name			PocketDip
+	
+	DoubleClickRange	1
+	
+	Script			pocketDip/use
+}
+Item 0x1EC3
+{
+	Name			PocketDip2
+	
+	DoubleClickRange	1	
+	
+	Script			pocketDip/use
+}
\ No newline at end of file

Added: trunk/096/pkg/items/training/pkg.cfg
===================================================================
--- trunk/096/pkg/items/training/pkg.cfg	2005-11-01 19:21:13 UTC (rev 796)
+++ trunk/096/pkg/items/training/pkg.cfg	2005-11-01 19:41:37 UTC (rev 797)
@@ -0,0 +1,17 @@
+#
+# $Id$
+#
+Enabled		1
+Name		training
+
+Version		1.0
+
+CoreRequired	96
+
+Creator		Austin Heilman
+Email		AustinHeilman at gmail.com
+Maintainer	Distro Team
+Email		distro at polserver.com
+
+#Requires none
+#conflicts	none

Added: trunk/096/pkg/items/training/pocketDip/use.src
===================================================================
--- trunk/096/pkg/items/training/pocketDip/use.src	2005-11-01 19:21:13 UTC (rev 796)
+++ trunk/096/pkg/items/training/pocketDip/use.src	2005-11-01 19:41:37 UTC (rev 797)
@@ -0,0 +1,52 @@
+use uo;
+use os;
+
+include ":attributes:attributes";
+include ":combat:weaponInfo";
+include ":training:training";
+
+CONST SUCCESS_SOUND := 0x58;
+CONST FAIL_SOUND := 0x41;
+
+program PocketDip(who, dummy)
+	if ( dummy.container )
+		return 0;
+	elseif ( Distance(who, dummy) > 2 )
+		SendSysMessage(who, "You are too far away.");
+		return 0;
+	elseif ( !ReserveItem(dummy) )
+		SendSysMessage(who, "Someone else is already using that.");
+		return 0;
+	elseif ( SkillCheck(who, "Stealing", -1, TP_CanAdvance(who, "Stealing") ) > 0)
+		PlaySoundEffect(who, SUCCESS_SOUND);
+		SendSysMessage(who, "You successfully slip your hand into the bag.");
+		ReleaseItem(dummy);
+		sleepms(3600);
+		return 1;
+	else
+		SendSysMessage(who, "You foolishly grip the bag.");
+		PlaySoundEffect(who, FAIL_SOUND);
+		
+		DummyRock(dummy);
+		
+		return 1;
+	endif
+endprogram
+
+function DummyRock(dummy)
+	case ( dummy.graphic )
+		7872:
+			dummy.graphic := 7873;
+			sleepms(3600);
+			dummy.graphic := 7872;
+			break;
+			
+		7875:
+			dummy.graphic := 7876;
+			sleepms(3600);
+			dummy.graphic := 7875;
+			break;
+	endcase
+
+	return 1;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/items/training/trainingDummy/control.src
===================================================================
--- trunk/096/pkg/items/training/trainingDummy/control.src	2005-11-01 19:21:13 UTC (rev 796)
+++ trunk/096/pkg/items/training/trainingDummy/control.src	2005-11-01 19:41:37 UTC (rev 797)
@@ -0,0 +1,14 @@
+use uo;
+
+program DummyControl(dummy)
+	//De-animates dummies on start-up.
+	
+	if ( dummy.graphic == 4209 ) // Animated
+		dummy.graphic := 4208; // None animated
+		
+	elseif ( dummy.graphic == 4213 ) // Animated
+		dummy.graphic := 4212; // Non animated
+	endif
+	
+	return 1;
+endprogram

Added: trunk/096/pkg/items/training/trainingDummy/use.src
===================================================================
--- trunk/096/pkg/items/training/trainingDummy/use.src	2005-11-01 19:21:13 UTC (rev 796)
+++ trunk/096/pkg/items/training/trainingDummy/use.src	2005-11-01 19:41:37 UTC (rev 797)
@@ -0,0 +1,61 @@
+use uo;
+use os;
+use cfgfile;
+
+include ":attributes:attributes";
+include ":combat:weaponInfo";
+include ":training:training";
+
+CONST DUMMY_HIT_SOUND := 0x13C;
+
+program PracticeDummy(who, dummy)
+	if ( dummy.container )
+		return 0;
+	elseif ( !ReserveItem(dummy) )
+		SendSysMessage(who, "Someone else is already using that.");
+		return 0;
+	endif
+	
+	var weapon := who.weapon;
+	
+	if ( !TP_CheckRange(who, weapon, dummy) )
+		return 0;
+	endif
+	
+	var weapon_anim := CInt(CS_GetWeaponInfo(weapon, "Anim"));
+	var miss_sound := CInt(CS_GetWeaponInfo(weapon, "MissSound"));
+	var weapon_attribute := CS_GetWeaponInfo(weapon, "Attribute");
+	if ( weapon_attribute["Archery"] )
+		SendSysMessage(who, "You should use an archery butte.");
+		return 0;
+	endif
+	
+	PerformAction(who, weapon_anim);
+		
+	if ( SkillCheck(who, weapon_attribute, -1, 0, TP_CanAdvance(who, weapon_attribute)) > 0 )
+		PlaySoundEffect(who, DUMMY_HIT_SOUND);
+		DummyRock(dummy);
+	else
+		PlaySoundEffect(who, miss_sound);
+		ReleaseItem(dummy);
+		sleepms(3600);
+	endif	
+endprogram
+
+function DummyRock(dummy)
+	case ( dummy.graphic )
+		4208:
+			dummy.graphic := 4209;
+			sleepms(3600);
+			dummy.graphic := 4208;
+			break;
+			
+		4212:
+			dummy.graphic := 4213;
+			sleepms(3600);
+			dummy.graphic := 4212;
+			break;
+	endcase
+	
+	return 1;
+endfunction



From austin at berlios.de  Tue Nov  1 20:55:21 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 20:55:21 +0100
Subject: [Poldistro-svn] r798 - trunk/096/pkg/items/food
Message-ID: <200511011955.jA1JtLek000106@sheep.berlios.de>

Author: austin
Date: 2005-11-01 20:55:20 +0100 (Tue, 01 Nov 2005)
New Revision: 798

Modified:
   trunk/096/pkg/items/food/eat.src
   trunk/096/pkg/items/food/hunger.src
Log:
Added break; lines to case entries.
Updated to use the hunger vital.

Modified: trunk/096/pkg/items/food/eat.src
===================================================================
--- trunk/096/pkg/items/food/eat.src	2005-11-01 19:41:37 UTC (rev 797)
+++ trunk/096/pkg/items/food/eat.src	2005-11-01 19:55:20 UTC (rev 798)
@@ -6,85 +6,93 @@
 use cfgfile;
 
 include "include/canAccess";
-include "include/attributes";
+include ":attributes:attributes";
 include ":timedscripts:timedScripts";
 include "include/client";
 
 program eat(who, food)
-  EraseObjProperty(who, "IsMeditating");
-  EraseObjProperty(who, "HealTimer");
+	EraseObjProperty(who, "IsMeditating");
+	EraseObjProperty(who, "HealTimer");
 
-  if (!can_access(who, food))
-    return;
-  endif
-  if (food.movable == 0)
-    SendSysMessage(who, "You cannot use that.");
-    return;
-  endif
-  if (!ReserveItem(food))
-    SendSysMessage(who, "Someone is doing something with that.");
-    return;
-  endif
+	if ( !can_access(who, food) )
+		return 0;
+	elseif ( food.movable == 0 )
+		SendSysMessage(who, "You cannot use that.");
+		return 0;
+	elseif ( !ReserveItem(food) )
+		SendSysMessage(who, "Someone else is already using that.");
+		return 0;
+	endif
 
-  var foodcfg := ReadConfigFile(":*:itemdesc");
-  var themsg;
-  var poison := CInt(GetObjProperty(food, "poison_level"));
-  var foodvalue := foodcfg[food.objtype].foodvalue;
-  var hunger := CInt(GetObjProperty(who, "hunger"));
-  if (!foodvalue)
-    foodvalue := 1;
-  endif
-  if (hunger == 0)
-    SendSysMessage(who, "You are too full to eat any more.");
-    return;
-  endif
+	var foodcfg := ReadConfigFile(":*:itemdesc");
+	var themsg;
+	var poison := CInt(GetObjProperty(food, "poison_level"));
+	var foodvalue := foodcfg[food.objtype].foodvalue;
+	var hunger := AP_GetVital(who, "Hunger");
+	if ( !foodvalue )
+		foodvalue := 1;
+	endif
+	if ( hunger == 0 )
+		SendSysMessage(who, "You are too full to eat any more.");
+		return 0;
+	endif
+	if ( SubtractAmount(food, 1) )
+		SendSysMessage(who, "Error - unable to subtract 1 from item.");
+		return 0;
+	endif
 
-  if (SubtractAmount(food, 1))
-    case (RandomInt(3) + 1)
-      1: PlaySoundEffect(who, 0x3b);
-      2: PlaySoundEffect(who, 0x3c);
-      3: PlaySoundEffect(who, 0x3d);
-    endcase
-    PerformAction(who, ANIM_EAT);
-    SetStamina(who, GetStamina(who) +(RandomInt(5)+foodvalue));
-    if (GetStamina(who) > GetDexterity(who))
-      SetStamina(who, who.dexterity);
-    endif
-    hunger := hunger - foodvalue;
-    case (hunger)
-      0:
-      1:  themsg := "You manage to eat the food, but you are stuffed.";
-      2:
-      3:  themsg := "You feel quite full after consuming the food.";
-      4:
-      5:
-      6:
-      7:  themsg := "After eating the food you feel much less hungry.";
-      8:
-      9:
-      10: themsg := "You eat the food but are still extremely hungry.";
-    endcase
-    if (hunger < 0)
-      themsg := "You manage to eat the food, but you are stuffed";
-      hunger := 0;
-    endif
-    SetObjProperty(who, "hunger", hunger);
-    case (hunger)
-      0:  SetStaminaRegenRate(who, 1000);
-      1:  SetStaminaRegenRate(who, 1300);
-      2:
-      3:
-      4:
-      5:
-      6:  SetStaminaRegenRate(who, 1200);
-      7:  SetStaminaRegenRate(who, 1000);
-      8:  SetStaminaRegenRate(who, 800);
-      9:  SetStaminaRegenRate(who, 600);
-      10: SetStaminaRegenRate(who, 400);
-    endcase
-    SendSysMessage(who, themsg);
-    if (poison > 0)
-      TS_StartTimer(who, "defaultPoison", 120, poison, who);
-    endif
-  endif
+	case ( RandomInt(3) + 1 )
+		1: PlaySoundEffect(who, 0x3b);
+		2: PlaySoundEffect(who, 0x3c);
+		3: PlaySoundEffect(who, 0x3d);
+	endcase
+
+	PerformAction(who, ANIM_EAT);
+	AP_SetVital(who, "Stamina", AP_GetVital(who, "Stamina") + (RandomInt(5)+foodvalue));
+
+	hunger := hunger - foodvalue;
+	case (hunger)
+		0: 1:
+			themsg := "You manage to eat the food, but you are stuffed.";
+			break;
+		2: 3:
+			themsg := "You feel quite full after consuming the food.";
+			break;
+		4: 5: 6: 7:
+			themsg := "After eating the food you feel much less hungry.";
+			break;
+		8: 9: 10:
+			themsg := "You eat the food but are still extremely hungry.";
+			break;
+	endcase
+
+	if ( hunger < 0 )
+		themsg := "You manage to eat the food, but you are now stuffed.";
+		hunger := 0;
+	endif
+
+	AP_SetVital(who, "Hunger", hunger);
+
+	var regen := AP_GetVitalRegenRateMod(who, "Hunger");
+	case ( hunger )
+		0: regen := regen - 200; break;
+		1: regen := regen + 100; break;
+		2: regen := regen + 0; break;
+		3: regen := regen + 0; break;
+		4: regen := regen + 0; break;
+		5: regen := regen + 0; break;
+		6: regen := regen + 0; break;
+		7: regen := regen - 100; break;
+		8: regen := regen - 400; break;
+		9: regen := regen - 600; break;
+		10: regen := regen - 800; break;
+	endcase
+	AP_SetVitalRegenRateMod(who, "Hunger", regen);
+
+	SendSysMessage(who, themsg);
+	if ( poison > 0 )
+		TS_StartTimer(who, "defaultPoison", 120, poison, who);
+	endif
+
+	return 1;
 endprogram

Modified: trunk/096/pkg/items/food/hunger.src
===================================================================
--- trunk/096/pkg/items/food/hunger.src	2005-11-01 19:41:37 UTC (rev 797)
+++ trunk/096/pkg/items/food/hunger.src	2005-11-01 19:55:20 UTC (rev 798)
@@ -22,18 +22,18 @@
 		SetObjProperty(chr, "hunger", hunger);
 		
 		var regen := AP_GetVitalRegenRateMod(chr, "Hunger");
-		case (hunger)
-			0 : regen := regen - 200;
-			1 : regen := regen + 100;
-			2 : regen := regen + 0;
-			3 : regen := regen + 0;
-			4 : regen := regen + 0;
-			5 : regen := regen + 0;
-			6 : regen := regen + 0;
-			7 : regen := regen - 100;
-			8 : regen := regen - 400;
-			9 : regen := regen - 600;
-			10: regen := regen - 800;
+		case ( hunger )
+			0: regen := regen - 200; break;
+			1: regen := regen + 100; break;
+			2: regen := regen + 0; break;
+			3: regen := regen + 0; break;
+			4: regen := regen + 0; break;
+			5: regen := regen + 0; break;
+			6: regen := regen + 0; break;
+			7: regen := regen - 100; break;
+			8: regen := regen - 400; break;
+			9: regen := regen - 600; break;
+			10: regen := regen - 800; break;
 		endcase
 		AP_SetVitalRegenRateMod(chr, "Hunger", regen);
 		



From austin at berlios.de  Tue Nov  1 20:57:00 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 20:57:00 +0100
Subject: [Poldistro-svn] r799 - trunk/096/pkg/items/treasuremap
Message-ID: <200511011957.jA1Jv0G5000302@sheep.berlios.de>

Author: austin
Date: 2005-11-01 20:57:00 +0100 (Tue, 01 Nov 2005)
New Revision: 799

Modified:
   trunk/096/pkg/items/treasuremap/decodeMap.src
Log:
Changed lines to use new attributes system.

Modified: trunk/096/pkg/items/treasuremap/decodeMap.src
===================================================================
--- trunk/096/pkg/items/treasuremap/decodeMap.src	2005-11-01 19:55:20 UTC (rev 798)
+++ trunk/096/pkg/items/treasuremap/decodeMap.src	2005-11-01 19:57:00 UTC (rev 799)
@@ -2,8 +2,8 @@
 use cfgfile;
 use util;
 
+include ":attributes:attributes";
 include "include/client";
-include "include/attributes";
 include "include/objtype";
 include "include/canAccess";
 
@@ -32,8 +32,8 @@
   endif
 endprogram
 
-function GetMaxMapLevel( who );
-  var skill := GetEffectiveSkill( who, SKILLID_CARTOGRAPHY );
+function GetMaxMapLevel( who )
+  var skill := AP_GetTrueSkill(who, "Cartography");
   if( skill >= 100 )
     return 5;
   elseif( skill >= 80 )



From austin at berlios.de  Tue Nov  1 20:59:21 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 20:59:21 +0100
Subject: [Poldistro-svn] r800 - trunk/096/pkg/items/wands
Message-ID: <200511011959.jA1JxLe3000504@sheep.berlios.de>

Author: austin
Date: 2005-11-01 20:59:21 +0100 (Tue, 01 Nov 2005)
New Revision: 800

Modified:
   trunk/096/pkg/items/wands/magicWands.src
Log:
Replaced function calls to use new attributes system.

Modified: trunk/096/pkg/items/wands/magicWands.src
===================================================================
--- trunk/096/pkg/items/wands/magicWands.src	2005-11-01 19:57:00 UTC (rev 799)
+++ trunk/096/pkg/items/wands/magicWands.src	2005-11-01 19:59:21 UTC (rev 800)
@@ -2,7 +2,7 @@
 use os;
 use cfgfile;
 
-include "include/attributes";
+include ":attributes:attributes";
 include "include/canAccess";
 include "include/tileEffects";
 include "include/client";
@@ -61,7 +61,7 @@
     SendSysMessage(who, "You can't see that.");
     return;
   endif
-  if(!GetHp(trg))
+  if(!AP_GetVital(trg, "Hits"))
     SendSysMessage(who, "You can only use that on living things.");
     return;
   endif
@@ -152,7 +152,7 @@
   endif
   PlaySoundEffect(cast_on, SFX_SPELL_HARM);
   PlayObjectCenteredEffect(cast_on, FX_GLOW_SPIKE, 0x0a,0x1e);
-  if(GetHp(cast_on) >= 1)
+  if(AP_GetVital(cast_on, "Hits") >= 1)
     if(cast_on.npctemplate)
       dmg := dmg * 2;
     endif
@@ -168,7 +168,7 @@
   endif
   PlayMovingEffect( caster, cast_on, FX_FIREBALL, 5, 1 );
   PlaySoundEffect( caster, 0x15f);
-  if(GetHp(cast_on) >= 1)
+  if(AP_GetVital(cast_on, "Hits") >= 1)
     if(cast_on.npctemplate)
       dmg := dmg * 2;
     endif
@@ -216,15 +216,15 @@
   //var target_resist := GetEffectiveSkill(cast_on, SKILLID_MAGICRESISTANCE); // uncomment if needed
   var diff := Resisted(40, cast_on, (RandomInt(30)));
   if(diff > 0)
-    if(diff > GetMaxMana(cast_on))
-      diff := GetMaxMana(cast_on);
+    if(diff > AP_GetVitalMaximumValue(cast_on, "Mana"))
+      diff := AP_GetVitalMaximumValue(cast_on, "Mana");
     endif
     PlaySoundEffect(caster, SFX_SPELL_MANA_DRAIN);
     PlayObjectCenteredEffect(cast_on, FX_HEAL_EFFECT, 7, 0x10);
-    if((GetMana(cast_on) - diff) < 0)
-      diff := GetMana(cast_on);
+    if((AP_GetVital(cast_on, "Mana") - diff) < 0)
+      diff := AP_GetVital(cast_on, "Mana");
     endif
-    SetMana(cast_on, (GetMana(cast_on) - diff));
+    AP_SetVital(cast_on, "Mana", (AP_GetVital(cast_on, "Mana") - diff));
   endif
 endfunction
 



From austin at berlios.de  Tue Nov  1 21:01:08 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 21:01:08 +0100
Subject: [Poldistro-svn] r801 - trunk/096/scripts/include
Message-ID: <200511012001.jA1K18RK000735@sheep.berlios.de>

Author: austin
Date: 2005-11-01 21:01:03 +0100 (Tue, 01 Nov 2005)
New Revision: 801

Modified:
   trunk/096/scripts/include/firewall.inc
   trunk/096/scripts/include/noto.inc
Log:
Changed GetStr() to AP_GetStat()

Modified: trunk/096/scripts/include/firewall.inc
===================================================================
--- trunk/096/scripts/include/firewall.inc	2005-11-01 19:59:21 UTC (rev 800)
+++ trunk/096/scripts/include/firewall.inc	2005-11-01 20:01:03 UTC (rev 801)
@@ -3,7 +3,6 @@
 use uo;
 
 include "include/client";
-include "include/attributes";
 include "include/fields";
 
 const SOUND_EFFECT_FIREFIELD:= 0x1de;
@@ -12,6 +11,7 @@
 const SOUND_EFFECT_POISON := 0x247;
 const EFFECT_RED_SPARKLE := 0x374a;
 
+/*
 function DoFireField( caster )
 var thetarget;
 var x;
@@ -62,4 +62,5 @@
 foreach fire in fires
     DestroyItem( fire );
 endforeach
-endfunction
\ No newline at end of file
+endfunction
+*/
\ No newline at end of file

Modified: trunk/096/scripts/include/noto.inc
===================================================================
--- trunk/096/scripts/include/noto.inc	2005-11-01 19:59:21 UTC (rev 800)
+++ trunk/096/scripts/include/noto.inc	2005-11-01 20:01:03 UTC (rev 801)
@@ -2,7 +2,7 @@
 use util;
 use math;
 
-include "include/attributes";
+include ":attributes:attributes";
 
 var nototitles :=
 {
@@ -31,7 +31,7 @@
   if(defender.isA(POLCLASS_MOBILE))
     dkarma := dkarma / 100.0;
     dkchk := dkarma * 10;
-  elseif(!GetStrength(defender))
+  elseif(!AP_GetStat(defender, "Strength"))
     dkarma := dkarma * 10;
     dkchk := dkarma * 10;
     dkchk := 0 - dkchk;
@@ -39,7 +39,7 @@
   if(defender.isA(POLCLASS_MOBILE))
     dfame := dfame / 100.0;
     dfchk := dfame * 10;
-  elseif(!GetStrength(defender))
+  elseif(!AP_GetStat(defender, "Strength"))
     dfchk := dfame * 100;
     dfame := dfame * 10;
   endif



From austin at berlios.de  Tue Nov  1 22:36:32 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 22:36:32 +0100
Subject: [Poldistro-svn] r802 - trunk/096/pkg/mobiles/brainAI/include
Message-ID: <200511012136.jA1LaWCM019347@sheep.berlios.de>

Author: austin
Date: 2005-11-01 22:36:31 +0100 (Tue, 01 Nov 2005)
New Revision: 802

Modified:
   trunk/096/pkg/mobiles/brainAI/include/npcInit.inc
Log:
Updated the way the error is built on line 244.

Modified: trunk/096/pkg/mobiles/brainAI/include/npcInit.inc
===================================================================
--- trunk/096/pkg/mobiles/brainAI/include/npcInit.inc	2005-11-01 20:01:03 UTC (rev 801)
+++ trunk/096/pkg/mobiles/brainAI/include/npcInit.inc	2005-11-01 21:36:31 UTC (rev 802)
@@ -241,8 +241,7 @@
 
 	var npc_names := ReadConfigFile("::names");
 	if ( !npc_names[name_elem] )
-		var temp := error;
-		temp.+errortext := "There is no elem ["+name_elem+"] in NAMES.CFG";
+		var temp := error{"errortext" := "There is no elem ["+name_elem+"] in NAMES.CFG"};
 
 		NPC_ErrorSysLog(mobile, "Error::NPC_SetupName() - "+temp.errortext);
 		PrintTextAbove(mobile, temp.errortext);



From austin at berlios.de  Tue Nov  1 22:38:06 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 22:38:06 +0100
Subject: [Poldistro-svn] r803 - trunk/096/scripts/include
Message-ID: <200511012138.jA1Lc6ti019583@sheep.berlios.de>

Author: austin
Date: 2005-11-01 22:38:06 +0100 (Tue, 01 Nov 2005)
New Revision: 803

Modified:
   trunk/096/scripts/include/startEqp.inc
Log:
Attributes stuff

Modified: trunk/096/scripts/include/startEqp.inc
===================================================================
--- trunk/096/scripts/include/startEqp.inc	2005-11-01 21:36:31 UTC (rev 802)
+++ trunk/096/scripts/include/startEqp.inc	2005-11-01 21:38:06 UTC (rev 803)
@@ -1,8 +1,10 @@
+use uo;
 use cfgfile;
 use os;
 use util;
-include "include/attributes";
 
+include ":attributes:attributes";
+
 var unique_items_created := {};
 var starteqp_cfg;
 var template;
@@ -33,7 +35,7 @@
       magicadjustment := 0;
     endif
   endif
-  if(GetHp(corpse))
+  if(AP_GetVital(corpse, "Hits"))
     foreach thing in ListEquippedItems(corpse)
       if(thing.objtype == 0xe75)
         corpse := thing;



From austin at berlios.de  Tue Nov  1 22:49:26 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 22:49:26 +0100
Subject: [Poldistro-svn] r804 - trunk/096/pkg/mobiles/npcutils
Message-ID: <200511012149.jA1LnQgN009408@sheep.berlios.de>

Author: austin
Date: 2005-11-01 22:49:25 +0100 (Tue, 01 Nov 2005)
New Revision: 804

Modified:
   trunk/096/pkg/mobiles/npcutils/NPCKeeper.src
Log:
Attribute updates

Modified: trunk/096/pkg/mobiles/npcutils/NPCKeeper.src
===================================================================
--- trunk/096/pkg/mobiles/npcutils/NPCKeeper.src	2005-11-01 21:38:06 UTC (rev 803)
+++ trunk/096/pkg/mobiles/npcutils/NPCKeeper.src	2005-11-01 21:49:25 UTC (rev 804)
@@ -4,7 +4,7 @@
 use os;
 
 include "include/startEqp";
-include "include/attributes";
+include ":attributes:attributes";
 include ":npcutils:vetement";
 include ":npcutils:names";
 include "include/client";
@@ -13,270 +13,272 @@
 var equipt;
 
 program npckeep(who)
-  SetObjProperty(who, "AiSerial", cint(who.serial));
-  var colors := pncfg[who.npctemplate].colors;
-  if(colors)
-    colors := SplitWords(colors);
-    var clr := Cint(colors[RandomInt(Len(colors)) + 1]);
-    who.color := clr;
-    SetObjProperty(who, "Color", clr);
-  endif
-  if(who.name["<escortee>"])
-    var ttitle := "";
-    case(randomint(20) + 1)
-       0: ttitle := " the townsperson";           equipt := "peasant1";
-       1: ttitle := " the townsperson";           equipt := "peasant1";
-       2: ttitle := " the townsperson";           equipt := "peasant1";
-       3: ttitle := " the townsperson";           equipt := "peasant1";
-       4: ttitle := " the townsperson";           equipt := "peasant1";
-       5: ttitle := " the townsperson";           equipt := "peasant1";
-       6: ttitle := " the townsperson";           equipt := "peasant1";
-       7: ttitle := "";                           equipt := "peasant1";
-       8: ttitle := "";                           equipt := "peasant1";
-       9: ttitle := "";                           equipt := "peasant1";
-      10: ttitle := "";                           equipt := "peasant1";
-      11: ttitle := "";                           equipt := "peasant1";
-      12: ttitle := "";                           equipt := "peasant1";
-      13: ttitle := " the mage";                  equipt := "Mage";
-      14: ttitle := " the mage";                  equipt := "Mage";
-      15: ttitle := " the mage";                  equipt := "Mage";
-      16: ttitle := " the seeker of adventure";   equipt := "seeker";
-      17: ttitle := " the seeker of adventure";   equipt := "seeker";
-      18: ttitle := " the seeker of adventure";   equipt := "seeker";
-      19: ttitle := " the noble";                 equipt := "peasant2";
-      20: ttitle := " the noble";                 equipt := "peasant2";
-    endcase
-    pickdestination(who, equipt);
-    case(randomint(2))
-      0: who.graphic := 0x190;
-         who.gender := 0;
-         equipt := equipt + "M";
-      1: who.graphic := 0x191;
-         who.gender := 1;
-         equipt := equipt + "F";
-    endcase
-    SetObjProperty(who, "Graphic", cint(who.graphic));
-    // Removed randName functions and replaced with the new npcInit.inc
-    // functions from the brainAI for compatibility.
-    NPC_SetupNameOldAI(who);
-    SetName(who, who.name + ttitle);
-    if(equipt)
-      Habille(who, equipt);
-      EraseObjProperty(who, "Equipt");
-      var lewtgroup := pncfg[who.npctemplate].lootgroup;
-      if(lewtgroup)
-        MakeLoot(who, cint(lewtgroup));
-      endif
-    endif
-  elseif(who.name["<employee>"])
-    var cost := 0;
-    var ttitle := "";
-    case(randomint(15) + 1)
-       0: ttitle := " the fighter";   equipt := "Fighter1";   cost := 40;
-       1: ttitle := " the fighter";   equipt := "Fighter1";   cost := 40;
-       2: ttitle := " the thief";     equipt := "Thief";      cost := 50;
-       3: ttitle := " the thief";     equipt := "Thief";      cost := 50;
-       4: ttitle := " the mage";      equipt := "Mage";       cost := 70;
-       5: ttitle := " the mage";      equipt := "Mage";       cost := 70;
-       6: ttitle := " the paladin";   equipt := "Paladin";    cost := 80;
-       7: ttitle := " the paladin";   equipt := "Paladin";    cost := 80;
-       8: ttitle := " the fighter";   equipt := "Fighter2";   cost := 40;
-       9: ttitle := " the fighter";   equipt := "Fighter2";   cost := 40;
-      10: ttitle := " the fighter";   equipt := "Fighter3";   cost := 40;
-      11: ttitle := " the fighter";   equipt := "Fighter3";   cost := 40;
-      12: ttitle := " the fighter";   equipt := "Fighter4";   cost := 40;
-      13: ttitle := " the fighter";   equipt := "Fighter4";   cost := 40;
-      14: ttitle := " the beggar";    equipt := "Beggar";     cost := 30;
-      15: ttitle := " the beggar";    equipt := "Beggar";     cost := 30;
-    endcase
-    SetObjProperty(who, "MerchantType", equipt);
-    SetObjProperty(who, "HireCost", cint(cost));
-    Adjustment(who, equipt);
-    case(randomint(2))
-      0: who.graphic := 0x190;
-         who.gender := 0;
-         equipt := equipt + "M";
-      1: who.graphic := 0x191;
-         who.gender := 1;
-         equipt := equipt + "F";
-    endcase
-    SetObjProperty(who, "Graphic", cint(who.graphic));
-    // Removed randName functions and replaced with the new npcInit.inc
-    // functions from the brainAI for compatibility.
-    NPC_SetupNameOldAI(who);
-    SetName(who, who.name + ttitle);
-    pncfg := ReadConfigFile(":*:npcdesc");
-    if(equipt)
-      Habille(who, equipt);
-      EraseObjProperty(who, "Equipt");
-      var lewtgroup := pncfg[who.npctemplate].lootgroup;
-      if(lewtgroup)
-        MakeLoot(who, cint(lewtgroup));
-      endif
-    endif
-  else
-    pncfg := ReadConfigFile(":*:npcdesc");
-    equipt := GetObjProperty(who, "Equipt");
-    if(equipt)
-      if(who.graphic == 0x190)
-        case(randomint(2))
-          0: who.graphic := 0x190;
-             who.gender := 0;
-             equipt := equipt + "M";
-          1: who.graphic := 0x191;
-             who.gender := 1;
-             equipt := equipt + "F";
-        endcase
-      endif
-      SetObjProperty(who, "Graphic", cint(who.graphic));
-      Habille(who, equipt);
-      EraseObjProperty(who, "Equipt");
-      var lewtgroup := pncfg[who.npctemplate].lootgroup;
-      if(lewtgroup)
-        MakeLoot(who, cint(lewtgroup));
-      endif
-    endif
-    if(who.name["<random>"])
-      // Removed randName functions and replaced with the new npcInit.inc
-      // functions from the brainAI for compatibility.
-      NPC_SetupNameOldAI(who);
-      if(pncfg[who.npctemplate].title)
-        var title := randomint(20);
-        var ttitle := "";
-        case(title)
-          0: ttitle := "";
-          1: ttitle := " the townsperson";
-          2: ttitle := " the farmer";
-          3: ttitle := " the sailor";
-          4: ttitle := " the drunkard";
-          5: ttitle := " the wanderer";
-          6: ttitle := " the villager";
-          7: ttitle := " the gypsie";
-          8: ttitle := " the vagabond";
-          9: ttitle := " the laborer";
-          default: ttitle := "";
-        endcase
-        SetName(who, who.name + ttitle);
-      endif
-    elseif(who.name["<balron>"])
-      case(randomint(3) + 1)
-        1: SetName(who, "Lord of the Abyss");
-        2: SetName(who, "The Collector of Souls");
-        3: SetName(who, "The Slayer");
-      endcase
-    endif
-  endif
-  if(pncfg[who.npctemplate].ammotype)
-    var ammotype := pncfg[who.npctemplate].ammotype;
-    if(ammotype)
-      var ammoamount := pncfg[who.npctemplate].ammoamount;
-      if(!ammoamount)
-        ammoamount := 30;
-      endif
-      var theammo := CreateItemInBackpack(who, ammotype, ammoamount);
-      if(theammo.amount > ammoamount)
-        SubtractAmount(theammo, (theammo.amount - ammoamount));
-      endif
-    endif
-  endif
+	SetObjProperty(who, "AiSerial", cint(who.serial));
+	var colors := pncfg[who.npctemplate].colors;
+	if(colors)
+		colors := SplitWords(colors);
+		var clr := Cint(colors[RandomInt(Len(colors)) + 1]);
+		who.color := clr;
+		SetObjProperty(who, "Color", clr);
+	endif
+	if(who.name["<escortee>"])
+		var ttitle := "";
+		case(randomint(20) + 1)
+			 0: ttitle := " the townsperson";		equipt := "peasant1";
+			 1: ttitle := " the townsperson";		equipt := "peasant1";
+			 2: ttitle := " the townsperson";		equipt := "peasant1";
+			 3: ttitle := " the townsperson";		equipt := "peasant1";
+			 4: ttitle := " the townsperson";		equipt := "peasant1";
+			 5: ttitle := " the townsperson";		equipt := "peasant1";
+			 6: ttitle := " the townsperson";		equipt := "peasant1";
+			 7: ttitle := "";				equipt := "peasant1";
+			 8: ttitle := "";				equipt := "peasant1";
+			 9: ttitle := "";				equipt := "peasant1";
+			10: ttitle := "";				equipt := "peasant1";
+			11: ttitle := "";				equipt := "peasant1";
+			12: ttitle := "";				equipt := "peasant1";
+			13: ttitle := " the mage";			equipt := "Mage";
+			14: ttitle := " the mage";			equipt := "Mage";
+			15: ttitle := " the mage";			equipt := "Mage";
+			16: ttitle := " the seeker of adventure";	equipt := "seeker";
+			17: ttitle := " the seeker of adventure";	equipt := "seeker";
+			18: ttitle := " the seeker of adventure";	equipt := "seeker";
+			19: ttitle := " the noble";			equipt := "peasant2";
+			20: ttitle := " the noble";			equipt := "peasant2";
+		endcase
+		pickdestination(who, equipt);
+		case(randomint(2))
+			0: who.graphic := 0x190;
+				 who.gender := 0;
+				 equipt := equipt + "M";
+			1: who.graphic := 0x191;
+				 who.gender := 1;
+				 equipt := equipt + "F";
+		endcase
+		SetObjProperty(who, "Graphic", cint(who.graphic));
+		// Removed randName functions and replaced with the new npcInit.inc
+		// functions from the brainAI for compatibility.
+		NPC_SetupNameOldAI(who);
+		SetName(who, who.name + ttitle);
+		if(equipt)
+			Habille(who, equipt);
+			EraseObjProperty(who, "Equipt");
+			var lewtgroup := pncfg[who.npctemplate].lootgroup;
+			if(lewtgroup)
+				MakeLoot(who, cint(lewtgroup));
+			endif
+		endif
+	elseif(who.name["<employee>"])
+		var cost := 0;
+		var ttitle := "";
+		case(randomint(15) + 1)
+			 0: ttitle := " the fighter";	equipt := "Fighter1";	cost := 40;
+			 1: ttitle := " the fighter";	equipt := "Fighter1";	cost := 40;
+			 2: ttitle := " the thief";	equipt := "Thief";	cost := 50;
+			 3: ttitle := " the thief";	equipt := "Thief";	cost := 50;
+			 4: ttitle := " the mage";	equipt := "Mage";	cost := 70;
+			 5: ttitle := " the mage";	equipt := "Mage";	cost := 70;
+			 6: ttitle := " the paladin";	equipt := "Paladin";	cost := 80;
+			 7: ttitle := " the paladin";	equipt := "Paladin";	cost := 80;
+			 8: ttitle := " the fighter";	equipt := "Fighter2";	cost := 40;
+			 9: ttitle := " the fighter";	equipt := "Fighter2";	cost := 40;
+			10: ttitle := " the fighter";	equipt := "Fighter3";	cost := 40;
+			11: ttitle := " the fighter";	equipt := "Fighter3";	cost := 40;
+			12: ttitle := " the fighter";	equipt := "Fighter4";	cost := 40;
+			13: ttitle := " the fighter";	equipt := "Fighter4";	cost := 40;
+			14: ttitle := " the beggar";	equipt := "Beggar";	cost := 30;
+			15: ttitle := " the beggar";	equipt := "Beggar";	cost := 30;
+		endcase
+		SetObjProperty(who, "MerchantType", equipt);
+		SetObjProperty(who, "HireCost", cint(cost));
+		Adjustment(who, equipt);
+		case(randomint(2))
+			0: who.graphic := 0x190;
+				 who.gender := 0;
+				 equipt := equipt + "M";
+			1: who.graphic := 0x191;
+				 who.gender := 1;
+				 equipt := equipt + "F";
+		endcase
+		SetObjProperty(who, "Graphic", cint(who.graphic));
+		// Removed randName functions and replaced with the new npcInit.inc
+		// functions from the brainAI for compatibility.
+		NPC_SetupNameOldAI(who);
+		SetName(who, who.name + ttitle);
+		pncfg := ReadConfigFile(":*:npcdesc");
+		if(equipt)
+			Habille(who, equipt);
+			EraseObjProperty(who, "Equipt");
+			var lewtgroup := pncfg[who.npctemplate].lootgroup;
+			if(lewtgroup)
+				MakeLoot(who, cint(lewtgroup));
+			endif
+		endif
+	else
+		pncfg := ReadConfigFile(":*:npcdesc");
+		equipt := GetObjProperty(who, "Equipt");
+		if(equipt)
+			if(who.graphic == 0x190)
+				case(randomint(2))
+					0: who.graphic := 0x190;
+						who.gender := 0;
+						equipt := equipt + "M";
+						break;
+					1: who.graphic := 0x191;
+						who.gender := 1;
+						equipt := equipt + "F";
+						break;
+				endcase
+			endif
+			SetObjProperty(who, "Graphic", cint(who.graphic));
+			Habille(who, equipt);
+			EraseObjProperty(who, "Equipt");
+			var lewtgroup := pncfg[who.npctemplate].lootgroup;
+			if(lewtgroup)
+				MakeLoot(who, cint(lewtgroup));
+			endif
+		endif
+		if(who.name["<random>"])
+			// Removed randName functions and replaced with the new npcInit.inc
+			// functions from the brainAI for compatibility.
+			NPC_SetupNameOldAI(who);
+			if(pncfg[who.npctemplate].title)
+				var title := randomint(20);
+				var ttitle := "";
+				case(title)
+					0: ttitle := ""; break;
+					1: ttitle := " the townsperson"; break;
+					2: ttitle := " the farmer"; break;
+					3: ttitle := " the sailor"; break;
+					4: ttitle := " the drunkard"; break;
+					5: ttitle := " the wanderer"; break;
+					6: ttitle := " the villager"; break;
+					7: ttitle := " the gypsie"; break;
+					8: ttitle := " the vagabond"; break;
+					9: ttitle := " the laborer"; break;
+					default: ttitle := ""; break;
+				endcase
+				SetName(who, who.name + ttitle);
+			endif
+		elseif(who.name["<balron>"])
+			case(randomint(3) + 1)
+				1: SetName(who, "Lord of the Abyss");
+				2: SetName(who, "The Collector of Souls");
+				3: SetName(who, "The Slayer");
+			endcase
+		endif
+	endif
+	if(pncfg[who.npctemplate].ammotype)
+		var ammotype := pncfg[who.npctemplate].ammotype;
+		if(ammotype)
+			var ammoamount := pncfg[who.npctemplate].ammoamount;
+			if(!ammoamount)
+				ammoamount := 30;
+			endif
+			var theammo := CreateItemInBackpack(who, ammotype, ammoamount);
+			if(theammo.amount > ammoamount)
+				SubtractAmount(theammo, (theammo.amount - ammoamount));
+			endif
+		endif
+	endif
 //moved out so all templates can use this
-      if(pncfg[who.npctemplate].colorrange)
-        var parms := splitwords(pncfg[who.npctemplate].colorrange);
-        who.color := randomint(Cint(parms[2]) - Cint(parms[1]))+Cint(parms[1]);
-      endif
-      if(pncfg[who.npctemplate].mount)
-        var mymount := CreateItemAtLocation(1,1,0,0xf021,1, who.realm);
-        var mountparms := splitwords(pncfg[who.npctemplate].mount);
-        mymount.graphic := Cint(mountparms[1]);
-        mymount.color := Cint(mountparms[2]);
-        EquipItem(who, mymount);
-      endif
-  var colornum := 0;
-  var sccfg := ReadConfigFile(":*:colors");
-  var colorit := FindConfigElem(sccfg, "speechcolor");
-  var colorarray := GetConfigStringArray(colorit, "color");
-  colornum := RandomInt(len(colorarray)) + 1;
-  if(colornum == 0)
-    colornum := 1;
-  endif
-  who.speech_color := CInt(colorarray[colornum]);
+	if(pncfg[who.npctemplate].colorrange)
+		var parms := splitwords(pncfg[who.npctemplate].colorrange);
+		who.color := randomint(Cint(parms[2]) - Cint(parms[1]))+Cint(parms[1]);
+	endif
+	if(pncfg[who.npctemplate].mount)
+		var mymount := CreateItemAtLocation(1,1,0,0xf021,1, who.realm);
+		var mountparms := splitwords(pncfg[who.npctemplate].mount);
+		mymount.graphic := Cint(mountparms[1]);
+		mymount.color := Cint(mountparms[2]);
+		EquipItem(who, mymount);
+	endif
+	var colornum := 0;
+	var sccfg := ReadConfigFile(":*:colors");
+	var colorit := FindConfigElem(sccfg, "speechcolor");
+	var colorarray := GetConfigStringArray(colorit, "color");
+	colornum := RandomInt(len(colorarray)) + 1;
+	if(colornum == 0)
+		colornum := 1;
+	endif
+	who.speech_color := CInt(colorarray[colornum]);
 endprogram
-
+	
 function Adjustment(who, type)
-  if(type == "Mage")
-    SetBaseSkillBaseValue(who, SKILLID_MAGERY,          1000);
-    SetBaseSkillBaseValue(who, SKILLID_EVALINT,         1000);
-    SetBaseSkillBaseValue(who, SKILLID_MAGICRESISTANCE, 900);
-    SetBaseSkillBaseValue(who, SKILLID_TACTICS,         700);
-    SetBaseSkillBaseValue(who, SKILLID_WRESTLING,       700);
-  elseif(type == "Thief")
-    SetBaseSkillBaseValue(who, SKILLID_FENCING,         1000);
-    SetBaseSkillBaseValue(who, SKILLID_MAGICRESISTANCE, 60);
-    SetBaseSkillBaseValue(who, SKILLID_TACTICS,         80);
-    SetBaseSkillBaseValue(who, SKILLID_ANATOMY,         600);
-  elseif(type == "Paladin")
-    SetBaseSkillBaseValue(who, SKILLID_MAGICRESISTANCE, 800);
-    SetBaseSkillBaseValue(who, SKILLID_TACTICS,         1000);
-    SetBaseSkillBaseValue(who, SKILLID_SWORDSMANSHIP,   1000);
-    SetBaseSkillBaseValue(who, SKILLID_MACEFIGHTING,    1000);
-    SetBaseSkillBaseValue(who, SKILLID_FENCING,         1000);
-    SetBaseSkillBaseValue(who, SKILLID_WRESTLING,       900);
-    SetBaseSkillBaseValue(who, SKILLID_ANATOMY,         1000);
-    SetBaseStrength(who, 80);
-  elseif((type == "Fighter1") || (type == "Fighter2") || (type == "Fighter3") || (type == "Fighter4"))
-    SetBaseSkillBaseValue(who, SKILLID_MAGICRESISTANCE, 600);
-    SetBaseSkillBaseValue(who, SKILLID_TACTICS,         900);
-    SetBaseSkillBaseValue(who, SKILLID_SWORDSMANSHIP,   900);
-    SetBaseSkillBaseValue(who, SKILLID_MACEFIGHTING,    900);
-    SetBaseSkillBaseValue(who, SKILLID_FENCING,         900);
-    SetBaseSkillBaseValue(who, SKILLID_WRESTLING,       900);
-    SetBaseSkillBaseValue(who, SKILLID_ANATOMY,         900);
-  endif
+	if(type == "Mage")
+		AP_SetTrueSkill(who, "Magery", 100);
+		AP_SetTrueSkill(who, "EvaluatingIntelligence", 100);
+		AP_SetTrueSkill(who, "ResistingSpells", 90);
+		AP_SetTrueSkill(who, "Tactics", 70);
+		AP_SetTrueSkill(who, "Wrestling", 70);
+	elseif(type == "Thief")
+		AP_SetTrueSkill(who, "Fencing", 100);
+		AP_SetTrueSkill(who, "ResistingSpells", 60);
+		AP_SetTrueSkill(who, "Tactics", 80);
+		AP_SetTrueSkill(who, "Anatomy", 60);
+	elseif(type == "Paladin")
+		AP_SetTrueSkill(who, "ResistingSpells", 80);
+		AP_SetTrueSkill(who, "Tactics", 100);
+		AP_SetTrueSkill(who, "Swordsmanship", 100);
+		AP_SetTrueSkill(who, "MaceFighting", 100);
+		AP_SetTrueSkill(who, "Fencing", 100);
+		AP_SetTrueSkill(who, "Wrestling", 90);
+		AP_SetTrueSkill(who, "Anatomy", 100);
+		AP_SetTrueStat(who, "Strength", 80);
+	elseif((type == "Fighter1") || (type == "Fighter2") || (type == "Fighter3") || (type == "Fighter4"))
+		AP_SetTrueSkill(who, "ResistingSpells", 60);
+		AP_SetTrueSkill(who, "Tactics", 90);
+		AP_SetTrueSkill(who, "Swordsmanship", 90);
+		AP_SetTrueSkill(who, "MaceFighting", 90);
+		AP_SetTrueSkill(who, "Fencing", 90);
+		AP_SetTrueSkill(who, "Wrestling", 90);
+		AP_SetTrueSkill(who, "Anatomy", 90);
+	endif
 endfunction
 
 
 function pickdestination(me, type)
-  SetObjProperty(me, "Type", type);
-  var destination, coords;
-  if(type == "seeker")
-    destination := "a dungeon";
-    SetObjProperty(me, "Coords", "5120 0 6143 2303");
-    SetObjProperty(me, "Dest", destination);
-  elseif(type == "Mage")
-    case(randomint(12) + 1)
-       1: coords := "470 805 710 1020";    destination := "the city of Yew";
-       2: coords := "1285 1512 1700 1785"; destination := "the city of Brittain";
-       3: coords := "2815 605 3050 1005";  destination := "the city of Vesper";
-       4: coords := "1790 2635 2090 2900"; destination := "the city of Trinsic";
-       5: coords := "540 2110 685 2290";   destination := "the city of Skara Brae";
-       6: coords := "2865 3335 3070 3520"; destination := "the city of Serpent's Hold";
-       7: coords := "3590 2460 3704 2695"; destination := "the city of Ocllo";
-       8: coords := "4375 1020 4498 1185"; destination := "the city of Moonglow";
-       9: coords := "2400 370 2545 590";   destination := "the city of Minoc";
-      10: coords := "3645 2050 3785 2300"; destination := "the city of Magincia";
-      11: coords := "1300 1665 1515 3925"; destination := "the city of Jhelom";
-      12: coords := "5120 0 5375 255";     destination := "the city of Wind";
-    endcase
-    SetObjProperty(me, "Coords", coords);
-    SetObjProperty(me, "Dest", destination);
-  else
-    case(randomint(14) + 1)
-       1: coords :=  "470 805 710 1020";   destination := "the city of Yew";
-       2: coords := "1285 1512 1700 1785"; destination := "the city of Brittain";
-       3: coords := "2815 605 3050 1005";  destination := "the city of Vesper";
-       4: coords := "1790 2635 2090 2900"; destination := "the city of Trinsic";
-       5: coords := "540 2110 685 2290";   destination := "the city of Skara Brae";
-       6: coords := "2865 3335 3070 3520"; destination := "the city of Serpent's Hold";
-       7: coords := "3590 2460 3704 2695"; destination := "the city of Ocllo";
-       8: coords := "3635 1165 3815 1410"; destination := "the city of Nujel'm";
-       9: coords := "4375 1020 4498 1185"; destination := "the city of Moonglow";
-      10: coords := "2400 370 2545 590";   destination := "the city of Minoc";
-      11: coords := "3645 2050 3785 2300"; destination := "the city of Magincia";
-      12: coords := "1300 1665 1515 3925"; destination := "the city of Jhelom";
-      13: coords := "2205 1110 2280 1245"; destination := "the city of Cove";
-      14: coords := "2650 2070 2765 2265"; destination := "the city of Buccaneer's Den";
-    endcase
-    SetObjProperty(me, "Coords", coords);
-    SetObjProperty(me, "Dest", destination);
-  endif
+	SetObjProperty(me, "Type", type);
+	var destination, coords;
+	if(type == "seeker")
+		destination := "a dungeon";
+		SetObjProperty(me, "Coords", "5120 0 6143 2303");
+		SetObjProperty(me, "Dest", destination);
+	elseif(type == "Mage")
+		case(randomint(12) + 1)
+			 1: coords := "470 805 710 1020";	destination := "the city of Yew";
+			 2: coords := "1285 1512 1700 1785";	destination := "the city of Brittain";
+			 3: coords := "2815 605 3050 1005";	destination := "the city of Vesper";
+			 4: coords := "1790 2635 2090 2900";	destination := "the city of Trinsic";
+			 5: coords := "540 2110 685 2290";	destination := "the city of Skara Brae";
+			 6: coords := "2865 3335 3070 3520";	destination := "the city of Serpent's Hold";
+			 7: coords := "3590 2460 3704 2695";	destination := "the city of Ocllo";
+			 8: coords := "4375 1020 4498 1185";	destination := "the city of Moonglow";
+			 9: coords := "2400 370 2545 590";	destination := "the city of Minoc";
+			10: coords := "3645 2050 3785 2300";	destination := "the city of Magincia";
+			11: coords := "1300 1665 1515 3925";	destination := "the city of Jhelom";
+			12: coords := "5120 0 5375 255";	destination := "the city of Wind";
+		endcase
+		SetObjProperty(me, "Coords", coords);
+		SetObjProperty(me, "Dest", destination);
+	else
+		case(randomint(14) + 1)
+			 1: coords :=	"470 805 710 1020";	destination := "the city of Yew";
+			 2: coords := "1285 1512 1700 1785";	destination := "the city of Brittain";
+			 3: coords := "2815 605 3050 1005";	destination := "the city of Vesper";
+			 4: coords := "1790 2635 2090 2900";	destination := "the city of Trinsic";
+			 5: coords := "540 2110 685 2290";	destination := "the city of Skara Brae";
+			 6: coords := "2865 3335 3070 3520";	destination := "the city of Serpent's Hold";
+			 7: coords := "3590 2460 3704 2695";	destination := "the city of Ocllo";
+			 8: coords := "3635 1165 3815 1410";	destination := "the city of Nujel'm";
+			 9: coords := "4375 1020 4498 1185";	destination := "the city of Moonglow";
+			10: coords := "2400 370 2545 590";	destination := "the city of Minoc";
+			11: coords := "3645 2050 3785 2300";	destination := "the city of Magincia";
+			12: coords := "1300 1665 1515 3925";	destination := "the city of Jhelom";
+			13: coords := "2205 1110 2280 1245";	destination := "the city of Cove";
+			14: coords := "2650 2070 2765 2265";	destination := "the city of Buccaneer's Den";
+		endcase
+		SetObjProperty(me, "Coords", coords);
+		SetObjProperty(me, "Dest", destination);
+	endif
 endfunction



From muaddiblsd at berlios.de  Tue Nov  1 22:55:54 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Tue, 1 Nov 2005 22:55:54 +0100
Subject: [Poldistro-svn] r805 - in trunk/096/pkg: items items/ministatues items/ministatues/config mobiles/brainAI mobiles/brainAI/include mobiles/oldAI
Message-ID: <200511012155.jA1LtsPP010144@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-01 22:55:50 +0100 (Tue, 01 Nov 2005)
New Revision: 805

Added:
   trunk/096/pkg/items/ministatues/
   trunk/096/pkg/items/ministatues/config/
   trunk/096/pkg/items/ministatues/config/icp.cfg
   trunk/096/pkg/items/ministatues/itemdesc.cfg
   trunk/096/pkg/items/ministatues/miniStatues.cfg
   trunk/096/pkg/items/ministatues/pkg.cfg
   trunk/096/pkg/items/ministatues/statueDeed.src
   trunk/096/pkg/items/ministatues/useStatue.src
Removed:
   trunk/096/pkg/mobiles/oldAI/cow.src
Modified:
   trunk/096/pkg/mobiles/brainAI/include/npcSounds.inc
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
Log:


Added: trunk/096/pkg/items/ministatues/config/icp.cfg
===================================================================
--- trunk/096/pkg/items/ministatues/config/icp.cfg	2005-11-01 21:49:25 UTC (rev 804)
+++ trunk/096/pkg/items/ministatues/config/icp.cfg	2005-11-01 21:55:50 UTC (rev 805)
@@ -0,0 +1,13 @@
+ICP Register
+{
+	Name		Minature Statues
+	Version		1.0
+
+	Description	Package of Mini Statues that can play sounds.
+
+	Creator		MuadDib
+	C_Email		muaddib at lostsoulsshard.org
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+}
\ No newline at end of file


Property changes on: trunk/096/pkg/items/ministatues/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/ministatues/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/ministatues/itemdesc.cfg	2005-11-01 21:49:25 UTC (rev 804)
+++ trunk/096/pkg/items/ministatues/itemdesc.cfg	2005-11-01 21:55:50 UTC (rev 805)
@@ -0,0 +1,9 @@
+Item 0x2110
+{
+	Name		ministatuedeed
+	Desc		mini-statue deed
+	Script		statueDeed
+	Graphic		0x14ef
+	Movable		1
+	Weight		1
+}


Property changes on: trunk/096/pkg/items/ministatues/itemdesc.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/ministatues/miniStatues.cfg
===================================================================
--- trunk/096/pkg/items/ministatues/miniStatues.cfg	2005-11-01 21:49:25 UTC (rev 804)
+++ trunk/096/pkg/items/ministatues/miniStatues.cfg	2005-11-01 21:55:50 UTC (rev 805)
@@ -0,0 +1,149 @@
+# $Id$
+#
+#
+Statue 0x20CF
+{
+	Name		brown bear statue
+	Graphic		0x20CF
+	Sound		0x62
+}
+
+Statue 0x20D0
+{
+	Name		rat statue
+	Graphic		0x20D0
+	Sound		0x62
+}
+
+Statue 0x20D1
+{
+	Name		chicken statue
+	Graphic		0x20D1
+	Sound		0x71
+}
+
+Statue 0x20D2
+{
+	Name		corpser statue
+	Graphic		0x20D2
+	Sound		0x163
+}
+
+Statue 0x20D3
+{
+	Name		daemon statue
+	Graphic		0x20D3
+	Sound		0x166
+}
+
+Statue 0x20D4
+{
+	Name		deer statue
+	Graphic		0x20D4
+	Sound		0x83
+}
+
+Statue 0x20D6
+{
+	Name		dragon statue
+	Graphic		0x29D6
+	Sound		0x16b
+}
+
+Statue 0x20D7
+{
+	Name		earth elemental statue
+	Graphic		0x20D7
+	Sound		0x10d
+}
+
+Statue 0x20D8
+{
+	Name		ettin statue
+	Graphic		0x20D8
+	Sound		0x170
+}
+
+Statue 0x20D9
+{
+	Name		gargoyle statue
+	Graphic		0x20D9
+	Sound		0x175
+}
+
+Statue 0x20DA
+{
+	Name		crocodile statue
+	Graphic		0x20DA
+	Sound		0x5b
+}
+
+Statue 0x20DB
+{
+	Name		grizzly statue
+	Graphic		0x20DB
+	Sound		0xA6
+}
+
+Statue 0x20DC
+{
+	Name		harpy statue
+	Graphic		0x20DC
+	Sound		0x196
+}
+
+Statue 0x20E3
+{
+	Name		rat man statue
+	Graphic		0x20E3
+	Sound		0x1b6
+}
+
+Statue 0x20DE
+{
+	Name		lizard man statue
+	Graphic		0x20DE
+	Sound		0x1a2
+}
+
+Statue 0x20DF
+{
+	Name		ogre statue
+	Graphic		0x20DF
+	Sound		0x1ad
+}
+
+Statue 0x20E0
+{
+	Name		orc statue
+	Graphic		0x20E0
+	Sound		0x1b1
+}
+
+Statue 0x20E7
+{
+	Name		skeleton statue
+	Graphic		0x20E7
+	Sound		0x1c4
+}
+
+Statue 0x20E9
+{
+	Name		troll statue
+	Graphic		0x20E9
+	Sound		0x1ce
+}
+
+Statue 0x20F5
+{
+	Name		gorilla statue
+	Graphic		0x20F5
+	Sound		0x9f
+}
+
+Statue 0x20F8
+{
+	Name		liche statue
+	Graphic		0x20F8
+	Sound		0x19d
+}
\ No newline at end of file


Property changes on: trunk/096/pkg/items/ministatues/miniStatues.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/ministatues/pkg.cfg
===================================================================
--- trunk/096/pkg/items/ministatues/pkg.cfg	2005-11-01 21:49:25 UTC (rev 804)
+++ trunk/096/pkg/items/ministatues/pkg.cfg	2005-11-01 21:55:50 UTC (rev 805)
@@ -0,0 +1,5 @@
+Enabled		1
+Name		ministatues
+Maintainer	Distro
+Email		distro at polserver.com
+Version		1.0


Property changes on: trunk/096/pkg/items/ministatues/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/ministatues/statueDeed.src
===================================================================
--- trunk/096/pkg/items/ministatues/statueDeed.src	2005-11-01 21:49:25 UTC (rev 804)
+++ trunk/096/pkg/items/ministatues/statueDeed.src	2005-11-01 21:55:50 UTC (rev 805)
@@ -0,0 +1,38 @@
+/* $Id$
+ *
+ */
+use uo;
+use cfgfile;
+use util;
+
+include "include/canAccess";
+
+program use_StatueDeed(who, deed)
+
+	if( !can_access(who, deed) )
+		return 0;
+	endif
+	if( !(deed in EnumerateItemsInContainer(who.backpack)) )
+		SendSysMessage(who, "That item is not in your backpack.");
+		return 0;
+	endif
+	if( !ReserveItem(deed) )
+		return 0;
+	endif
+
+	var statue_config := ReadConfigFile(":ministatues:miniStatues");
+	var elem_names := GetConfigStringKeys(statue_config);
+	var statue_elem := FindConfigElem( statue_config, elem_names[(RandomInt(elem_names.size())+1)]);
+
+	var mini_statue := CreateItemAtLocation(who.x, who.y, who.z, statue_elem.Graphic, 1, who.realm);
+
+	if( ReleaseItem(deed) )
+		if( DestroyItem(deed) )
+			MoveItemToContainer(mini_statue, who.backpack);
+		else
+			DestroyItem(mini_statue);
+		endif
+	endif
+	return 1;
+
+endprogram


Property changes on: trunk/096/pkg/items/ministatues/statueDeed.src
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/ministatues/useStatue.src
===================================================================
--- trunk/096/pkg/items/ministatues/useStatue.src	2005-11-01 21:49:25 UTC (rev 804)
+++ trunk/096/pkg/items/ministatues/useStatue.src	2005-11-01 21:55:50 UTC (rev 805)
@@ -0,0 +1,28 @@
+/* $Id$
+ *
+ */
+use cfgfile;
+use uo;
+
+include "include/canAccess";
+
+program use_Statue(who, statue)
+
+	if( !can_access(who, statue) )
+		return 0;
+	endif
+	if( !ReserveItem(statue) )
+		return 0;
+	endif
+
+	var statue_config := ReadConfigFile(":ministatues:miniStatues");
+	var statue_elem   := FindConfigElem( statue_config, statue.graphic);
+	var statue_sound  := statue_elem.Sound;
+
+	if( statue_sound )
+		PlaySoundEffect(who, statue_sound);
+	endif
+
+	return 1;
+
+endprogram


Property changes on: trunk/096/pkg/items/ministatues/useStatue.src
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/096/pkg/mobiles/brainAI/include/npcSounds.inc
===================================================================
--- trunk/096/pkg/mobiles/brainAI/include/npcSounds.inc	2005-11-01 21:49:25 UTC (rev 804)
+++ trunk/096/pkg/mobiles/brainAI/include/npcSounds.inc	2005-11-01 21:55:50 UTC (rev 805)
@@ -24,6 +24,7 @@
 // NPC_GetDeathSound(mobile)
 // NPC_GetMissSound(mobile)
 // NPC_GetHitSound(mobile)
+// NPC_GetBarkSound(mobile)
 //
 /////////////////////////////////////////////////////////////////
 // * Internal/Private Function List *
@@ -162,4 +163,31 @@
 
 	return RandomInt(hit_sound_list.size())+1;
 
+endfunction
+
+
+/*
+ * NPC_GetBarkSound(mobile)
+ *
+ * Purpose
+ * Gets the packed array form of BarkSounds Prop from NPC Template.
+ *
+ * Parameters
+ * mobile:	Mobile to find the barking sound for.
+ *
+ * Return value
+ * Returns an integer that is the sound ID to be played.
+ *
+ */
+function NPC_GetBarkSound(mobile)
+	var mobile_template := NPC_GetNPCConfig(mobile);
+	var bark_sound_list := UnPack(mobile_template.BarkSounds);
+
+	if( TypeOf(bark_sound_list) != "Array" )
+		NPC_ErrorSysLog(mobile, "Invalid Bark Sound Setting");
+		return 0;
+	endif
+
+	return RandomInt(bark_sound_list.size())+1;
+
 endfunction
\ No newline at end of file

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-01 21:49:25 UTC (rev 804)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-01 21:55:50 UTC (rev 805)
@@ -95,7 +95,7 @@
 }
 
 ##########################################
-# Farm type animals
+# Animals
 ##########################################
 NPCTemplate	cow
 {
@@ -164,7 +164,7 @@
 	AIScript	LookAround	:brainAI:scripts/lookAround/findFeared
 	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/watchFeared
 	AIScript	Sleep		:brainAI:scripts/sleep/generic
-	AIScript	EndFight	:brainAI:scripts/wonFight/wonFightAnimal
+	AIScript	EndFight	:brainAI:scripts/endFight/endFightAnimal
 
 	AttackHitScript		:combat:wrestlingHitScript
 }

Deleted: trunk/096/pkg/mobiles/oldAI/cow.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/cow.src	2005-11-01 21:49:25 UTC (rev 804)
+++ trunk/096/pkg/mobiles/oldAI/cow.src	2005-11-01 21:55:50 UTC (rev 805)
@@ -1,40 +0,0 @@
-use npc;
-use os;
-use uo;
-use cfgfile;
-
-include "include/eventID";
-include "include/sysEvent";
-include ":npcutils:names";
-include ":npcutils:NPCUtil";
-include "include/objtype";
-include "include/dist";
-include ":npcutils:anchors";
-include ":oldAI:main/mainLoopCow";
-include ":oldAI:combat/fight";
-include ":oldAI:combat/defaultCombatEvent";
-include ":oldAI:setup/animalSetup";
-include ":oldAI:main/sleepModeCow";
-
-const HALT_THRESHOLD := 5; // how close before he attacks?
-var npccfgfile := ReadConfigFile("::npcdesc");
-var idlesnd1 := CInt(npccfgfile[me.npctemplate].idlesound1);
-var idlesnd2 := CInt(npccfgfile[me.npctemplate].idlesound2);
-var waittime := 0;
-var ev := 0;
-
-program cow()
-	SetWarMode(0);
-	main_AI_loop();
-endprogram
-
-function CloseDistance(opponent)
-	case (Distance(me, opponent))
-		1:
-		0:       return 1;
-		default:
-			WalkToward(opponent);
-			return 0;
-	endcase
-endfunction
-



From austin at berlios.de  Tue Nov  1 22:56:05 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 22:56:05 +0100
Subject: [Poldistro-svn] r806 - in trunk/096/pkg: commands/gm mobiles/npcutils mobiles/oldAI mobiles/oldAI/combat mobiles/oldAI/main other/gmtools other/gmtools/commands/gm skills/alchemy skills/cooking skills/healing skills/herding skills/inscription skills/lumberjacking skills/magery skills/meditation skills/mining skills/tailoring skills/taming skills/tasteid skills/tinkering skills/tracking skills/veterinary systems/combat systems/daynight systems/housing systems/merchantnodes systems/spellcasting
Message-ID: <200511012156.jA1Lu53H010184@sheep.berlios.de>

Author: austin
Date: 2005-11-01 22:56:02 +0100 (Tue, 01 Nov 2005)
New Revision: 806

Modified:
   trunk/096/pkg/commands/gm/summon.inc
   trunk/096/pkg/mobiles/npcutils/animal.inc
   trunk/096/pkg/mobiles/oldAI/barber.src
   trunk/096/pkg/mobiles/oldAI/battleMage.src
   trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
   trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src
   trunk/096/pkg/mobiles/oldAI/combat/animalCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/defaultCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/healerCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/packFight.inc
   trunk/096/pkg/mobiles/oldAI/combat/packFireCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/poisonCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/slimeCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/spellCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/spiderCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/vortexCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/warriorcombatevent.inc
   trunk/096/pkg/mobiles/oldAI/davesHealer.src
   trunk/096/pkg/mobiles/oldAI/employed.src
   trunk/096/pkg/mobiles/oldAI/entranced.src
   trunk/096/pkg/mobiles/oldAI/escortee.src
   trunk/096/pkg/mobiles/oldAI/firebreather.src
   trunk/096/pkg/mobiles/oldAI/killPCs.src
   trunk/096/pkg/mobiles/oldAI/main/mainLoopQuestie.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc
   trunk/096/pkg/mobiles/oldAI/main/sleepMode.inc
   trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc
   trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc
   trunk/096/pkg/mobiles/oldAI/merchant.src
   trunk/096/pkg/mobiles/oldAI/packFirebreather.src
   trunk/096/pkg/mobiles/oldAI/poisonElemental.src
   trunk/096/pkg/mobiles/oldAI/spellFire.src
   trunk/096/pkg/mobiles/oldAI/spellKillPCs.src
   trunk/096/pkg/mobiles/oldAI/tamed.src
   trunk/096/pkg/mobiles/oldAI/townGuard.src
   trunk/096/pkg/mobiles/oldAI/townHealer.src
   trunk/096/pkg/mobiles/oldAI/townPerson.src
   trunk/096/pkg/mobiles/oldAI/undead.src
   trunk/096/pkg/mobiles/oldAI/worker.src
   trunk/096/pkg/other/gmtools/commands/gm/gmtools.src
   trunk/096/pkg/other/gmtools/go.src
   trunk/096/pkg/other/gmtools/greyItem.src
   trunk/096/pkg/other/gmtools/healstone.src
   trunk/096/pkg/other/gmtools/itemGo.src
   trunk/096/pkg/skills/alchemy/drinkPotion.inc
   trunk/096/pkg/skills/alchemy/exploder.src
   trunk/096/pkg/skills/alchemy/potion.inc
   trunk/096/pkg/skills/alchemy/redPotion.src
   trunk/096/pkg/skills/cooking/cooking.src
   trunk/096/pkg/skills/healing/healing.src
   trunk/096/pkg/skills/herding/herd.src
   trunk/096/pkg/skills/inscription/inscription.src
   trunk/096/pkg/skills/lumberjacking/lumberjack.src
   trunk/096/pkg/skills/magery/agility.src
   trunk/096/pkg/skills/magery/archCure.src
   trunk/096/pkg/skills/magery/archProt.src
   trunk/096/pkg/skills/magery/bladeSpirit.src
   trunk/096/pkg/skills/magery/bless.src
   trunk/096/pkg/skills/magery/clumsy.src
   trunk/096/pkg/skills/magery/cunning.src
   trunk/096/pkg/skills/magery/cure.src
   trunk/096/pkg/skills/magery/curse.src
   trunk/096/pkg/skills/magery/dispel.src
   trunk/096/pkg/skills/magery/dispelField.src
   trunk/096/pkg/skills/magery/earthquake.src
   trunk/096/pkg/skills/magery/energyField.src
   trunk/096/pkg/skills/magery/explosion.src
   trunk/096/pkg/skills/magery/feeblemind.src
   trunk/096/pkg/skills/magery/fireField.src
   trunk/096/pkg/skills/magery/fireball.src
   trunk/096/pkg/skills/magery/gHeal.src
   trunk/096/pkg/skills/magery/harm.src
   trunk/096/pkg/skills/magery/heal.src
   trunk/096/pkg/skills/magery/incognito.src
   trunk/096/pkg/skills/magery/invisibility.src
   trunk/096/pkg/skills/magery/magicArrow.src
   trunk/096/pkg/skills/magery/magicLock.src
   trunk/096/pkg/skills/magery/magicTrap.src
   trunk/096/pkg/skills/magery/magicUntrap.src
   trunk/096/pkg/skills/magery/manaDrain.src
   trunk/096/pkg/skills/magery/manaVamp.src
   trunk/096/pkg/skills/magery/massCurse.src
   trunk/096/pkg/skills/magery/massDispel.src
   trunk/096/pkg/skills/magery/meteorSwarm.src
   trunk/096/pkg/skills/magery/mindBlast.src
   trunk/096/pkg/skills/magery/nightSight.src
   trunk/096/pkg/skills/magery/paraField.src
   trunk/096/pkg/skills/magery/paralyze.src
   trunk/096/pkg/skills/magery/poison.src
   trunk/096/pkg/skills/magery/poisonDamage.src
   trunk/096/pkg/skills/magery/poisonField.src
   trunk/096/pkg/skills/magery/polymorph.src
   trunk/096/pkg/skills/magery/protection.src
   trunk/096/pkg/skills/magery/reactiveArmor.src
   trunk/096/pkg/skills/magery/resurrect.src
   trunk/096/pkg/skills/magery/reveal.src
   trunk/096/pkg/skills/magery/strength.src
   trunk/096/pkg/skills/magery/summon.inc
   trunk/096/pkg/skills/magery/summonCreature.src
   trunk/096/pkg/skills/magery/telekinesis.src
   trunk/096/pkg/skills/magery/vortex.src
   trunk/096/pkg/skills/magery/wallOfStone.src
   trunk/096/pkg/skills/magery/weaken.src
   trunk/096/pkg/skills/meditation/medCheck.src
   trunk/096/pkg/skills/meditation/meditation.src
   trunk/096/pkg/skills/mining/mining.src
   trunk/096/pkg/skills/mining/resmelt.src
   trunk/096/pkg/skills/tailoring/makeClothItems.src
   trunk/096/pkg/skills/tailoring/scissors.src
   trunk/096/pkg/skills/taming/happyCounter.src
   trunk/096/pkg/skills/taming/stableCounter.src
   trunk/096/pkg/skills/taming/taming.src
   trunk/096/pkg/skills/tasteid/tasteID.src
   trunk/096/pkg/skills/tinkering/makeComplexItem.src
   trunk/096/pkg/skills/tinkering/tinkering.src
   trunk/096/pkg/skills/tracking/tracking.src
   trunk/096/pkg/skills/veterinary/vet.src
   trunk/096/pkg/systems/combat/bladed.src
   trunk/096/pkg/systems/combat/chargeUpkeep.src
   trunk/096/pkg/systems/combat/destroy.src
   trunk/096/pkg/systems/combat/earthElemental.src
   trunk/096/pkg/systems/combat/equip.src
   trunk/096/pkg/systems/combat/hitScriptInc.inc
   trunk/096/pkg/systems/combat/maceHit.src
   trunk/096/pkg/systems/combat/poisonHit.src
   trunk/096/pkg/systems/combat/unequip.src
   trunk/096/pkg/systems/combat/vortexHit.src
   trunk/096/pkg/systems/daynight/wEffect.src
   trunk/096/pkg/systems/housing/signControl.src
   trunk/096/pkg/systems/merchantnodes/guardNodeControl.src
   trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src
   trunk/096/pkg/systems/spellcasting/spellcast.src
Log:
Changed include/attributes.inc to :attributes:attributes

Modified: trunk/096/pkg/commands/gm/summon.inc
===================================================================
--- trunk/096/pkg/commands/gm/summon.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/commands/gm/summon.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 
 include "include/client";
 include "include/sound";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 function summon_creature( caster, circle := 8, npctemplate, cast_loc, gate)

Modified: trunk/096/pkg/mobiles/npcutils/animal.inc
===================================================================
--- trunk/096/pkg/mobiles/npcutils/animal.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/npcutils/animal.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function Expand_Stats(me)
   if(GetObjProperty(me, "#Expanded"))
     return;

Modified: trunk/096/pkg/mobiles/oldAI/barber.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/barber.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/barber.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -14,7 +14,7 @@
 include "include/findCity";
 include "include/dist";
 include ":begging:begging";
-include "include/attributes";
+include ":attributes:attributes";
 include ":npcutils:trainSkill";
 
 const MAX_SKILLS      := 48;

Modified: trunk/096/pkg/mobiles/oldAI/battleMage.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/battleMage.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/battleMage.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/eventID";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use uo;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include "include/utility";

Modified: trunk/096/pkg/mobiles/oldAI/combat/animalCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/animalCombatEvent.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/animalCombatEvent.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function process_combat_event(opponent)
   if ((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
     EraseObjProperty(me,"#flees");

Modified: trunk/096/pkg/mobiles/oldAI/combat/defaultCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/defaultCombatEvent.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/defaultCombatEvent.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function process_combat_event(opponent)
   if((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
 	EraseObjProperty(me,"#flees");

Modified: trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function process_combat_event(opponent)
   if((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
     EraseObjProperty(me,"#flees");

Modified: trunk/096/pkg/mobiles/oldAI/combat/healerCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/healerCombatEvent.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/healerCombatEvent.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 include "include/poisons";
 
 function process_combat_event(opponent)

Modified: trunk/096/pkg/mobiles/oldAI/combat/packFight.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/packFight.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/packFight.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function Fight( opponent )
   if ((opponent.cmdlevel > 0) || (opponent.serial == me.serial))
     SetWarMode(0);

Modified: trunk/096/pkg/mobiles/oldAI/combat/packFireCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/packFireCombatEvent.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/packFireCombatEvent.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function process_combat_event(opponent)
   spellattack(opponent);
   if((GetHp(me) * 100/GetMaxHp(me)) < flee_point)

Modified: trunk/096/pkg/mobiles/oldAI/combat/poisonCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/poisonCombatEvent.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/poisonCombatEvent.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function process_combat_event(opponent)
   DoPoison(opponent);
   if((GetHp(me) * 100/GetMaxHp(me)) < flee_point)

Modified: trunk/096/pkg/mobiles/oldAI/combat/slimeCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/slimeCombatEvent.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/slimeCombatEvent.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function process_combat_event(opponent)
   do_damage(opponent);
   if (RandomInt(10) == 1)

Modified: trunk/096/pkg/mobiles/oldAI/combat/spellCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/spellCombatEvent.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/spellCombatEvent.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 include ":timedscripts:timedScripts";
 
 function process_combat_event(opponent)

Modified: trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 include ":timedscripts:timedScripts";
 
 function process_combat_event(opponent)

Modified: trunk/096/pkg/mobiles/oldAI/combat/spiderCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/spiderCombatEvent.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/spiderCombatEvent.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 
 function process_combat_event(opponent)
   send_web(opponent);

Modified: trunk/096/pkg/mobiles/oldAI/combat/vortexCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/vortexCombatEvent.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/vortexCombatEvent.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function process_combat_event(opponent)
   if(Distance(me,opponent) < 2)
     var dmg := RandomInt(CInt(GetIntelligence(opponent) / 10));

Modified: trunk/096/pkg/mobiles/oldAI/combat/warriorcombatevent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/warriorcombatevent.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/combat/warriorcombatevent.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function process_combat_event(opponent)
     if ((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
       EraseObjProperty(me,"#flees");

Modified: trunk/096/pkg/mobiles/oldAI/davesHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/davesHealer.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/davesHealer.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use uo;
 
 include ":npcutils:NPCCast";
-include "include/attributes";
+include ":attributes:attributes";
 include ":npcutils:NPCBackpacks";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/employed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:NPCBackpacks";
 include ":npcutils:NPCCast";

Modified: trunk/096/pkg/mobiles/oldAI/entranced.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/entranced.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/entranced.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include "include/dist";
 

Modified: trunk/096/pkg/mobiles/oldAI/escortee.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use uo;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:anchors";

Modified: trunk/096/pkg/mobiles/oldAI/firebreather.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/firebreather.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/firebreather.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -5,7 +5,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/killPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/killPCs.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/killPCs.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopQuestie.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopQuestie.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopQuestie.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function main_AI_loop()
 
     var ev;

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,6 +1,6 @@
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 function main_AI_loop()

Modified: trunk/096/pkg/mobiles/oldAI/main/sleepMode.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/sleepMode.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/main/sleepMode.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function sleepmode()
   foreach critter in ListMobilesNearLocation( me.x,me.y,me.z, 15, me.realm);
     if(!critter.isA(POLCLASS_NPC))

Modified: trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function sleepmode()
   foreach critter in ListMobilesNearLocation( me.x,me.y,me.z, 15, me.realm);
     if(!critter.isA(POLCLASS_NPC))

Modified: trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 function sleepmode()
   foreach critter in ListMobilesNearLocation( me.x,me.y,me.z, 15, me.realm);
     if(!critter.isA(POLCLASS_NPC))

Modified: trunk/096/pkg/mobiles/oldAI/merchant.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/merchant.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/merchant.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -14,7 +14,7 @@
 include "include/findCity";
 include "include/dist";
 include ":begging:begging";
-include "include/attributes";
+include ":attributes:attributes";
 include ":npcutils:trainSkill";
 
 const MAX_SKILLS      := 48;

Modified: trunk/096/pkg/mobiles/oldAI/packFirebreather.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/packFirebreather.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/packFirebreather.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -5,7 +5,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/poisonElemental.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/spellFire.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/spellFire.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/spellFire.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/spellKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/spellKillPCs.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/spellKillPCs.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -5,7 +5,7 @@
 
 include "include/client";
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/tamed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:NPCBackpacks";
 include ":npcutils:NPCCast";

Modified: trunk/096/pkg/mobiles/oldAI/townGuard.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townGuard.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/townGuard.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/eventID";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/townHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townHealer.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/townHealer.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use uo;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include "include/utility";

Modified: trunk/096/pkg/mobiles/oldAI/townPerson.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use uo;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:speech";

Modified: trunk/096/pkg/mobiles/oldAI/undead.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/undead.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/undead.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/worker.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use uo;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:speech";

Modified: trunk/096/pkg/other/gmtools/commands/gm/gmtools.src
===================================================================
--- trunk/096/pkg/other/gmtools/commands/gm/gmtools.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/other/gmtools/commands/gm/gmtools.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use util;
 
 include "include/objtype";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/math";
 include ":gmtools:layout";
 include ":gmtools:goLayout";

Modified: trunk/096/pkg/other/gmtools/go.src
===================================================================
--- trunk/096/pkg/other/gmtools/go.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/other/gmtools/go.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -13,7 +13,7 @@
 use util;
 
 include "include/math"; // Used for Mod
-include "include/attributes";
+include ":attributes:attributes";
 
 const TEXTSTARTLOCY :=  70;  // The location of the top of the gump
 

Modified: trunk/096/pkg/other/gmtools/greyItem.src
===================================================================
--- trunk/096/pkg/other/gmtools/greyItem.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/other/gmtools/greyItem.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,6 +1,6 @@
 use uo;
 use os;
-include "include/attributes";
+include ":attributes:attributes";
 
 program grey(me,item)
     if (me.cmdlevel < 2)

Modified: trunk/096/pkg/other/gmtools/healstone.src
===================================================================
--- trunk/096/pkg/other/gmtools/healstone.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/other/gmtools/healstone.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,6 +1,6 @@
 use uo;
 use os;
-include "include/attributes";
+include ":attributes:attributes";
 
 program healstone(item)
   while(item)

Modified: trunk/096/pkg/other/gmtools/itemGo.src
===================================================================
--- trunk/096/pkg/other/gmtools/itemGo.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/other/gmtools/itemGo.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -13,7 +13,7 @@
 use util;
 
 include "include/math"; // Used for Mod
-include "include/attributes";
+include ":attributes:attributes";
 
 const TEXTSTARTLOCY :=  70;  // The location of the top of the gump
 var who;

Modified: trunk/096/pkg/skills/alchemy/drinkPotion.inc
===================================================================
--- trunk/096/pkg/skills/alchemy/drinkPotion.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/alchemy/drinkPotion.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 include ":timedscripts:timedScripts";
 use cfgfile;
 

Modified: trunk/096/pkg/skills/alchemy/exploder.src
===================================================================
--- trunk/096/pkg/skills/alchemy/exploder.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/alchemy/exploder.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 use util;
-include "include/attributes";
+include ":attributes:attributes";
 
 program exploder(parms)
   var potion := parms[1];

Modified: trunk/096/pkg/skills/alchemy/potion.inc
===================================================================
--- trunk/096/pkg/skills/alchemy/potion.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/alchemy/potion.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -7,7 +7,7 @@
   syslog("Failed to open alchemy.cfg: " + cfg.errortext);
 endif
 
-include "include/attributes";
+include ":attributes:attributes";
 function is_reagent(what)
   case(what.objtype)
     0xf7a: return 1;

Modified: trunk/096/pkg/skills/alchemy/redPotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/redPotion.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/alchemy/redPotion.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 use cfgfile;
 include "drinkPotion";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/canAccess";
 
 program redPotion (who, potion)

Modified: trunk/096/pkg/skills/cooking/cooking.src
===================================================================
--- trunk/096/pkg/skills/cooking/cooking.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/cooking/cooking.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 include ":gumps:yesno";
 include "include/canAccess";
 

Modified: trunk/096/pkg/skills/healing/healing.src
===================================================================
--- trunk/096/pkg/skills/healing/healing.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/healing/healing.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -8,7 +8,7 @@
 include "include/client";
 include "include/resurrection";
 include "include/canAccess";
-include "include/attributes";
+include ":attributes:attributes";
 include ":timedscripts:timedScripts";
 include ":timedscripts:poisonUtil";
 

Modified: trunk/096/pkg/skills/herding/herd.src
===================================================================
--- trunk/096/pkg/skills/herding/herd.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/herding/herd.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -6,7 +6,7 @@
 
 include "include/client";
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 
 program herd(who)
         SendSysMessage(who, "What would you like to herd?");

Modified: trunk/096/pkg/skills/inscription/inscription.src
===================================================================
--- trunk/096/pkg/skills/inscription/inscription.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/inscription/inscription.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 include "include/objtype";
 include "include/canAccess";
 include "include/noto";

Modified: trunk/096/pkg/skills/lumberjacking/lumberjack.src
===================================================================
--- trunk/096/pkg/skills/lumberjacking/lumberjack.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/lumberjacking/lumberjack.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -6,7 +6,7 @@
 include "include/client";
 include "include/tileEffects";
 include "include/sound";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/string";
 include "include/objtype";
 include "include/canAccess";

Modified: trunk/096/pkg/skills/magery/agility.src
===================================================================
--- trunk/096/pkg/skills/magery/agility.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/agility.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/statMod";
-include "include/attributes";
+include ":attributes:attributes";
 
 program agility( parms )
   var caster := parms.caster;

Modified: trunk/096/pkg/skills/magery/archCure.src
===================================================================
--- trunk/096/pkg/skills/magery/archCure.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/archCure.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 include "include/eventID";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 include ":timedscripts:timedScripts";
 include ":timedscripts:poisonUtil";
 

Modified: trunk/096/pkg/skills/magery/archProt.src
===================================================================
--- trunk/096/pkg/skills/magery/archProt.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/archProt.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 include "include/sound";
 include "include/tileEffects";
 include "include/statMod";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program archProtection(parms)

Modified: trunk/096/pkg/skills/magery/bladeSpirit.src
===================================================================
--- trunk/096/pkg/skills/magery/bladeSpirit.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/bladeSpirit.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -2,7 +2,7 @@
 use os;
 use util;
 
-include "include/attributes";
+include ":attributes:attributes";
 include "include/tileEffects";
 include "include/sound";
 

Modified: trunk/096/pkg/skills/magery/bless.src
===================================================================
--- trunk/096/pkg/skills/magery/bless.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/bless.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/statMod";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 include "include/tileEffects";
 

Modified: trunk/096/pkg/skills/magery/clumsy.src
===================================================================
--- trunk/096/pkg/skills/magery/clumsy.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/clumsy.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/statMod";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 include "include/tileEffects";
 include "reflect";

Modified: trunk/096/pkg/skills/magery/cunning.src
===================================================================
--- trunk/096/pkg/skills/magery/cunning.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/cunning.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 
 include "include/statMod";
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 include "include/tileEffects";
 

Modified: trunk/096/pkg/skills/magery/cure.src
===================================================================
--- trunk/096/pkg/skills/magery/cure.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/cure.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -2,7 +2,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 include "include/tileEffects";
 include ":timedscripts:timedScripts";

Modified: trunk/096/pkg/skills/magery/curse.src
===================================================================
--- trunk/096/pkg/skills/magery/curse.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/curse.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/statMod";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 include "include/tileEffects";
 include "include/magic";

Modified: trunk/096/pkg/skills/magery/dispel.src
===================================================================
--- trunk/096/pkg/skills/magery/dispel.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/dispel.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -2,7 +2,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 include "include/tileEffects";
 include "include/spellAttack";

Modified: trunk/096/pkg/skills/magery/dispelField.src
===================================================================
--- trunk/096/pkg/skills/magery/dispelField.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/dispelField.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 include "include/tileEffects";
 

Modified: trunk/096/pkg/skills/magery/earthquake.src
===================================================================
--- trunk/096/pkg/skills/magery/earthquake.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/earthquake.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 include "include/client";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/spellAttack";
 include "include/magic";
 

Modified: trunk/096/pkg/skills/magery/energyField.src
===================================================================
--- trunk/096/pkg/skills/magery/energyField.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/energyField.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/fields";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/objtype";
 
 

Modified: trunk/096/pkg/skills/magery/explosion.src
===================================================================
--- trunk/096/pkg/skills/magery/explosion.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/explosion.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -2,7 +2,7 @@
 use uo;
 use cfgfile;
 
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 include "include/tileEffects";
 include "include/spellAttack";

Modified: trunk/096/pkg/skills/magery/feeblemind.src
===================================================================
--- trunk/096/pkg/skills/magery/feeblemind.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/feeblemind.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/statMod";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 include "include/tileEffects";
 include ":magery:reflect";

Modified: trunk/096/pkg/skills/magery/fireField.src
===================================================================
--- trunk/096/pkg/skills/magery/fireField.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/fireField.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,5 +1,5 @@
 include "include/fields";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/client";
 include "include/firewall";
 

Modified: trunk/096/pkg/skills/magery/fireball.src
===================================================================
--- trunk/096/pkg/skills/magery/fireball.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/fireball.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 include "include/magic";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 include ":magery:reflect";
 
 

Modified: trunk/096/pkg/skills/magery/gHeal.src
===================================================================
--- trunk/096/pkg/skills/magery/gHeal.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/gHeal.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -2,7 +2,7 @@
 use os;
 use util;
 
-include "include/attributes";
+include ":attributes:attributes";
 include "include/client";
 include "include/sound";
 include "include/tileEffects";

Modified: trunk/096/pkg/skills/magery/harm.src
===================================================================
--- trunk/096/pkg/skills/magery/harm.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/harm.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -6,7 +6,7 @@
 include "include/client";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 include ":magery:reflect";
 include "include/magic";
 

Modified: trunk/096/pkg/skills/magery/heal.src
===================================================================
--- trunk/096/pkg/skills/magery/heal.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/heal.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 include "include/tileEffects";
 

Modified: trunk/096/pkg/skills/magery/incognito.src
===================================================================
--- trunk/096/pkg/skills/magery/incognito.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/incognito.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 use cfgfile;
 
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program spell_incognito(parms)

Modified: trunk/096/pkg/skills/magery/invisibility.src
===================================================================
--- trunk/096/pkg/skills/magery/invisibility.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/invisibility.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 
 include "include/client";
 include "include/sound";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program spell_invisibility(parms)

Modified: trunk/096/pkg/skills/magery/magicArrow.src
===================================================================
--- trunk/096/pkg/skills/magery/magicArrow.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/magicArrow.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -5,7 +5,7 @@
 include "include/sound";
 include "include/tileEffects";
 include ":magery:reflect";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program spell_magicArrow( parms )

Modified: trunk/096/pkg/skills/magery/magicLock.src
===================================================================
--- trunk/096/pkg/skills/magery/magicLock.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/magicLock.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 
 include "include/client";
 include "include/sound";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/findCity";
 include "util/key";
 

Modified: trunk/096/pkg/skills/magery/magicTrap.src
===================================================================
--- trunk/096/pkg/skills/magery/magicTrap.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/magicTrap.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 include "include/findCity";
 

Modified: trunk/096/pkg/skills/magery/magicUntrap.src
===================================================================
--- trunk/096/pkg/skills/magery/magicUntrap.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/magicUntrap.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -6,7 +6,7 @@
 
 include "include/client";
 include "include/sound";
-include "include/attributes";
+include ":attributes:attributes";
 
 program spell_magicUntrap(parms)
 	var caster := parms.caster;

Modified: trunk/096/pkg/skills/magery/manaDrain.src
===================================================================
--- trunk/096/pkg/skills/magery/manaDrain.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/manaDrain.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 include "include/magic";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 include ":magery:reflect";
 
 

Modified: trunk/096/pkg/skills/magery/manaVamp.src
===================================================================
--- trunk/096/pkg/skills/magery/manaVamp.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/manaVamp.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 include "include/sound";
 include "include/tileEffects";
 include ":magery:reflect";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program spell_manaVamp(parms)

Modified: trunk/096/pkg/skills/magery/massCurse.src
===================================================================
--- trunk/096/pkg/skills/magery/massCurse.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/massCurse.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/statMod";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sound";
 include "include/tileEffects";
 include "include/spellAttack";

Modified: trunk/096/pkg/skills/magery/massDispel.src
===================================================================
--- trunk/096/pkg/skills/magery/massDispel.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/massDispel.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 include "include/eventID";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 include ":magery:reflect";
 include "include/spellAttack";
 include "include/magic";

Modified: trunk/096/pkg/skills/magery/meteorSwarm.src
===================================================================
--- trunk/096/pkg/skills/magery/meteorSwarm.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/meteorSwarm.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 include "include/magic";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 include ":magery:reflect";
 include "include/spellAttack";
 

Modified: trunk/096/pkg/skills/magery/mindBlast.src
===================================================================
--- trunk/096/pkg/skills/magery/mindBlast.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/mindBlast.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -5,7 +5,7 @@
 include "include/sound";
 include "include/tileEffects";
 include ":magery:reflect";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program spell_mindBlast( parms )

Modified: trunk/096/pkg/skills/magery/nightSight.src
===================================================================
--- trunk/096/pkg/skills/magery/nightSight.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/nightSight.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 include "include/client";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program nightSight(parms, spellid)

Modified: trunk/096/pkg/skills/magery/paraField.src
===================================================================
--- trunk/096/pkg/skills/magery/paraField.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/paraField.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -5,7 +5,7 @@
 include "include/fields";
 include "include/objtype";
 include "include/sound";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program spell_paraField(parms)

Modified: trunk/096/pkg/skills/magery/paralyze.src
===================================================================
--- trunk/096/pkg/skills/magery/paralyze.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/paralyze.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 include ":magery:reflect";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/statMod";
 include "include/magic";
 

Modified: trunk/096/pkg/skills/magery/poison.src
===================================================================
--- trunk/096/pkg/skills/magery/poison.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/poison.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 include ":magery:reflect";
 
 const EVID_DISCHARGE := 0x123457;

Modified: trunk/096/pkg/skills/magery/poisonDamage.src
===================================================================
--- trunk/096/pkg/skills/magery/poisonDamage.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/poisonDamage.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 include ":timedscripts:timedScripts";
 include "include/spellRestrictions";
 

Modified: trunk/096/pkg/skills/magery/poisonField.src
===================================================================
--- trunk/096/pkg/skills/magery/poisonField.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/poisonField.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/fields";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/objtype";
 
 

Modified: trunk/096/pkg/skills/magery/polymorph.src
===================================================================
--- trunk/096/pkg/skills/magery/polymorph.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/polymorph.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,6 +1,6 @@
 use util;
 
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program spell_polymorph( parms )

Modified: trunk/096/pkg/skills/magery/protection.src
===================================================================
--- trunk/096/pkg/skills/magery/protection.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/protection.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -5,7 +5,7 @@
 include "include/statMod";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 
 program spell_protection(parms)
   var caster := parms.caster;

Modified: trunk/096/pkg/skills/magery/reactiveArmor.src
===================================================================
--- trunk/096/pkg/skills/magery/reactiveArmor.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/reactiveArmor.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program spell_reactiveArmor( parms )

Modified: trunk/096/pkg/skills/magery/resurrect.src
===================================================================
--- trunk/096/pkg/skills/magery/resurrect.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/resurrect.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 include "include/eventID";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/client";
 include "include/resurrection";
 include "include/magic";

Modified: trunk/096/pkg/skills/magery/reveal.src
===================================================================
--- trunk/096/pkg/skills/magery/reveal.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/reveal.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,6 +1,6 @@
 use uo;
 
-include "include/attributes";
+include ":attributes:attributes";
 include "include/magic";
 include "include/sound";
 include "include/tileEffects";

Modified: trunk/096/pkg/skills/magery/strength.src
===================================================================
--- trunk/096/pkg/skills/magery/strength.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/strength.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -5,7 +5,7 @@
 include "include/statMod";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program spell_strength(parms)

Modified: trunk/096/pkg/skills/magery/summon.inc
===================================================================
--- trunk/096/pkg/skills/magery/summon.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/summon.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 include "include/client";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 function DoSummon( caster, circle, npctemplate, cast_loc )

Modified: trunk/096/pkg/skills/magery/summonCreature.src
===================================================================
--- trunk/096/pkg/skills/magery/summonCreature.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/summonCreature.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,7 +1,7 @@
 use util;
 
 include "summon";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program spell_summonCreature( parms )

Modified: trunk/096/pkg/skills/magery/telekinesis.src
===================================================================
--- trunk/096/pkg/skills/magery/telekinesis.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/telekinesis.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 include "include/client";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 include ":magery:reflect";
 include "include/magic";
 

Modified: trunk/096/pkg/skills/magery/vortex.src
===================================================================
--- trunk/096/pkg/skills/magery/vortex.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/vortex.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -5,7 +5,7 @@
 include "include/client";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program spell_vortex( parms )

Modified: trunk/096/pkg/skills/magery/wallOfStone.src
===================================================================
--- trunk/096/pkg/skills/magery/wallOfStone.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/wallOfStone.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 
 include "include/fields";
 include "include/sound";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program spell_wallOfStone(parms)

Modified: trunk/096/pkg/skills/magery/weaken.src
===================================================================
--- trunk/096/pkg/skills/magery/weaken.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/magery/weaken.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -5,7 +5,7 @@
 include "include/statMod";
 include "include/sound";
 include "include/tileEffects";
-include "include/attributes";
+include ":attributes:attributes";
 include ":magery:reflect";
 include "include/magic";
 

Modified: trunk/096/pkg/skills/meditation/medCheck.src
===================================================================
--- trunk/096/pkg/skills/meditation/medCheck.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/meditation/medCheck.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use util;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 
 var ct;
 var next_counter := 0;

Modified: trunk/096/pkg/skills/meditation/meditation.src
===================================================================
--- trunk/096/pkg/skills/meditation/meditation.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/meditation/meditation.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -5,7 +5,7 @@
 const sfx_meditation := 0xfa;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 include ":timedscripts:timedScripts";
 
 program meditation( who )

Modified: trunk/096/pkg/skills/mining/mining.src
===================================================================
--- trunk/096/pkg/skills/mining/mining.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/mining/mining.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/dist";
 include "include/objtype";
 include "include/startEqp";

Modified: trunk/096/pkg/skills/mining/resmelt.src
===================================================================
--- trunk/096/pkg/skills/mining/resmelt.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/mining/resmelt.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use cfgfile;
 
 include "include/canAccess";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/client";
 
 program resmelt(who)

Modified: trunk/096/pkg/skills/tailoring/makeClothItems.src
===================================================================
--- trunk/096/pkg/skills/tailoring/makeClothItems.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/tailoring/makeClothItems.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use os;
 
 include ":gumps:include/old/old-gumps";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/dist";
 include "include/client";
 include "include/objtype";

Modified: trunk/096/pkg/skills/tailoring/scissors.src
===================================================================
--- trunk/096/pkg/skills/tailoring/scissors.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/tailoring/scissors.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -2,7 +2,7 @@
 use cfgfile;
 
 include "include/objtype";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/client";
 include "include/canAccess";
 include "include/toolWear";

Modified: trunk/096/pkg/skills/taming/happyCounter.src
===================================================================
--- trunk/096/pkg/skills/taming/happyCounter.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/taming/happyCounter.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program happyCounter(parms)

Modified: trunk/096/pkg/skills/taming/stableCounter.src
===================================================================
--- trunk/096/pkg/skills/taming/stableCounter.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/taming/stableCounter.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program stableCounter(parms)

Modified: trunk/096/pkg/skills/taming/taming.src
===================================================================
--- trunk/096/pkg/skills/taming/taming.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/taming/taming.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use os;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/client";
 
 

Modified: trunk/096/pkg/skills/tasteid/tasteID.src
===================================================================
--- trunk/096/pkg/skills/tasteid/tasteID.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/tasteid/tasteID.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 
 const UOBJECT_FLASK_EMPTY:= 0x1832;
 const UOBJECT_FLASK_FULL := 0x1834;

Modified: trunk/096/pkg/skills/tinkering/makeComplexItem.src
===================================================================
--- trunk/096/pkg/skills/tinkering/makeComplexItem.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/tinkering/makeComplexItem.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,5 +1,5 @@
 
-include "include/attributes";
+include ":attributes:attributes";
 include "include/canAccess";
 
 var tinker_cfg:= ReadConfigFile("tinker");

Modified: trunk/096/pkg/skills/tinkering/tinkering.src
===================================================================
--- trunk/096/pkg/skills/tinkering/tinkering.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/tinkering/tinkering.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -5,7 +5,7 @@
 use os;
 use util;
 
-include "include/attributes";
+include ":attributes:attributes";
 include "include/client";
 include "include/sound";
 include "include/objtype";

Modified: trunk/096/pkg/skills/tracking/tracking.src
===================================================================
--- trunk/096/pkg/skills/tracking/tracking.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/tracking/tracking.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -6,7 +6,7 @@
 
 include "include/client";
 include "include/sound";
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program tracking(who)

Modified: trunk/096/pkg/skills/veterinary/vet.src
===================================================================
--- trunk/096/pkg/skills/veterinary/vet.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/skills/veterinary/vet.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use os;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/dist";
 include ":timedscripts:timedScripts";
 include ":timedscripts:poisonUtil";

Modified: trunk/096/pkg/systems/combat/bladed.src
===================================================================
--- trunk/096/pkg/systems/combat/bladed.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/combat/bladed.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -8,7 +8,7 @@
 
 include "include/client";
 include "include/sound";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/string";
 include "include/objtype";
 include "include/canAccess";

Modified: trunk/096/pkg/systems/combat/chargeUpkeep.src
===================================================================
--- trunk/096/pkg/systems/combat/chargeUpkeep.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/combat/chargeUpkeep.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 
 const EVID_UNEQUIP   := 0x123456;
 const EVID_DISCHARGE := 0x123457;

Modified: trunk/096/pkg/systems/combat/destroy.src
===================================================================
--- trunk/096/pkg/systems/combat/destroy.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/combat/destroy.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 
 const EVID_UNEQUIP   := 0x123456;
 const EVID_DISCHARGE := 0x123457;

Modified: trunk/096/pkg/systems/combat/earthElemental.src
===================================================================
--- trunk/096/pkg/systems/combat/earthElemental.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/combat/earthElemental.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,7 +1,7 @@
 use uo;
 use util;
 use os;
-include "include/attributes";
+include ":attributes:attributes";
 
 program macehit(param)
   var attacker := param[1];

Modified: trunk/096/pkg/systems/combat/equip.src
===================================================================
--- trunk/096/pkg/systems/combat/equip.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/combat/equip.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 include "equip";
 
 program equipweapon(who, item)

Modified: trunk/096/pkg/systems/combat/hitScriptInc.inc
===================================================================
--- trunk/096/pkg/systems/combat/hitScriptInc.inc	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/combat/hitScriptInc.inc	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,7 +1,7 @@
 use uo;
 use util;
 use math;
-include "include/attributes";
+include ":attributes:attributes";
 
 function DealDamage(defender, attacker, rawdamage)
   rawdamage := rawdamage + RandomInt( (GetEffectiveSkill(attacker, 1) ) / 20);

Modified: trunk/096/pkg/systems/combat/maceHit.src
===================================================================
--- trunk/096/pkg/systems/combat/maceHit.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/combat/maceHit.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -1,7 +1,7 @@
 use uo;
 use util;
 use os;
-include "include/attributes";
+include ":attributes:attributes";
 
 program macehit(param)
   var attacker := param[1];

Modified: trunk/096/pkg/systems/combat/poisonHit.src
===================================================================
--- trunk/096/pkg/systems/combat/poisonHit.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/combat/poisonHit.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 
 program poisonhit(param)
   var attacker := param[1];

Modified: trunk/096/pkg/systems/combat/unequip.src
===================================================================
--- trunk/096/pkg/systems/combat/unequip.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/combat/unequip.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 
 const EVID_UNEQUIP   := 0x123456;
 const EVID_DISCHARGE := 0x123457;

Modified: trunk/096/pkg/systems/combat/vortexHit.src
===================================================================
--- trunk/096/pkg/systems/combat/vortexHit.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/combat/vortexHit.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -2,7 +2,7 @@
 use util;
 use os;
 
-include "include/attributes";
+include ":attributes:attributes";
 
 
 program vortexHit(param)

Modified: trunk/096/pkg/systems/daynight/wEffect.src
===================================================================
--- trunk/096/pkg/systems/daynight/wEffect.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/daynight/wEffect.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 
 const SOUND_EFFECT_THUNDER:=  0x002a;
 

Modified: trunk/096/pkg/systems/housing/signControl.src
===================================================================
--- trunk/096/pkg/systems/housing/signControl.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/housing/signControl.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -3,7 +3,7 @@
 use basic;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include "include/objtype";
 

Modified: trunk/096/pkg/systems/merchantnodes/guardNodeControl.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/guardNodeControl.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/merchantnodes/guardNodeControl.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -6,7 +6,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include "include/dist";
 

Modified: trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/sysEvent";
 include "include/mrcSpawn";
 include "include/utility";

Modified: trunk/096/pkg/systems/spellcasting/spellcast.src
===================================================================
--- trunk/096/pkg/systems/spellcasting/spellcast.src	2005-11-01 21:55:50 UTC (rev 805)
+++ trunk/096/pkg/systems/spellcasting/spellcast.src	2005-11-01 21:56:02 UTC (rev 806)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "spellcastFunctions";
-include "include/attributes";
+include ":attributes:attributes";
 include "include/dist";
 
 program spellcast(who, spellid)



From austin at berlios.de  Tue Nov  1 22:57:40 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 22:57:40 +0100
Subject: [Poldistro-svn] r807 - in trunk/096/scripts: include items misc util
Message-ID: <200511012157.jA1LveC4010417@sheep.berlios.de>

Author: austin
Date: 2005-11-01 22:57:39 +0100 (Tue, 01 Nov 2005)
New Revision: 807

Modified:
   trunk/096/scripts/include/bard.inc
   trunk/096/scripts/include/magic.inc
   trunk/096/scripts/include/mrcSpawn.inc
   trunk/096/scripts/include/snooping.inc
   trunk/096/scripts/items/dungTele.src
   trunk/096/scripts/items/makeDTele.src
   trunk/096/scripts/items/moongate.src
   trunk/096/scripts/items/vendorDeed.src
   trunk/096/scripts/misc/demod.src
   trunk/096/scripts/misc/logoff.src
   trunk/096/scripts/misc/logon.src
   trunk/096/scripts/misc/unmod.src
   trunk/096/scripts/util/conflicts.inc
   trunk/096/scripts/util/repair.inc
Log:
Updated to use :attributes:attributes instead of include/attributes.

This way I can find the function calls easier and change them.

Modified: trunk/096/scripts/include/bard.inc
===================================================================
--- trunk/096/scripts/include/bard.inc	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/include/bard.inc	2005-11-01 21:57:39 UTC (rev 807)
@@ -1,7 +1,7 @@
 use uo;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 
 function play(character, theskill, item, skil)
   var success, fail;

Modified: trunk/096/scripts/include/magic.inc
===================================================================
--- trunk/096/scripts/include/magic.inc	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/include/magic.inc	2005-11-01 21:57:39 UTC (rev 807)
@@ -1,6 +1,6 @@
 const EVID_DISCHARGE := 0x123457;
 
-include "include/attributes";
+include ":attributes:attributes";
 
 
 function Resisted(circle, caster, cast_on, amt)

Modified: trunk/096/scripts/include/mrcSpawn.inc
===================================================================
--- trunk/096/scripts/include/mrcSpawn.inc	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/include/mrcSpawn.inc	2005-11-01 21:57:39 UTC (rev 807)
@@ -1,5 +1,5 @@
 use cfgfile;
-include "include/attributes";
+include ":attributes:attributes";
 include "include/utility";
 
 var mrcspawn_cfg := ReadConfigFile("::mrcspawn");

Modified: trunk/096/scripts/include/snooping.inc
===================================================================
--- trunk/096/scripts/include/snooping.inc	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/include/snooping.inc	2005-11-01 21:57:39 UTC (rev 807)
@@ -1,4 +1,4 @@
-include "include/attributes";
+include ":attributes:attributes";
 
 function snoop(who, victim)
   victim := victim; // stops "var not used" ecompile warning

Modified: trunk/096/scripts/items/dungTele.src
===================================================================
--- trunk/096/scripts/items/dungTele.src	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/items/dungTele.src	2005-11-01 21:57:39 UTC (rev 807)
@@ -2,7 +2,7 @@
 use uo;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 
 program walk_on_moongate(mobile, gate)
   if((mobile.npctemplate) && (mobile.script != "employed") && (mobile.script != "tamed") && (mobile.script != "escortee"))

Modified: trunk/096/scripts/items/makeDTele.src
===================================================================
--- trunk/096/scripts/items/makeDTele.src	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/items/makeDTele.src	2005-11-01 21:57:39 UTC (rev 807)
@@ -2,7 +2,7 @@
 use uo;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 
 program walk_on_moongate( mobile, gate )
   var magery := CInt(GetObjProperty(gate,"magery"));

Modified: trunk/096/scripts/items/moongate.src
===================================================================
--- trunk/096/scripts/items/moongate.src	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/items/moongate.src	2005-11-01 21:57:39 UTC (rev 807)
@@ -2,7 +2,7 @@
 use uo;
 
 include "include/client";
-include "include/attributes";
+include ":attributes:attributes";
 
 program walk_on_moongate(mobile, gate)
   if((mobile.npctemplate) && (mobile.script != "employed") && (mobile.script != "tamed") && (mobile.script != "escortee"))

Modified: trunk/096/scripts/items/vendorDeed.src
===================================================================
--- trunk/096/scripts/items/vendorDeed.src	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/items/vendorDeed.src	2005-11-01 21:57:39 UTC (rev 807)
@@ -1,7 +1,7 @@
 use os;
 use uo;
 include "include/canAccess";
-include "include/attributes";
+include ":attributes:attributes";
 
 const SEARCH_RANGE := 10;
 

Modified: trunk/096/scripts/misc/demod.src
===================================================================
--- trunk/096/scripts/misc/demod.src	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/misc/demod.src	2005-11-01 21:57:39 UTC (rev 807)
@@ -1,6 +1,6 @@
 use uo;
 use os;
-include "include/attributes";
+include ":attributes:attributes";
 
 program demod(parms)
   var mod := lower(parms[1]);

Modified: trunk/096/scripts/misc/logoff.src
===================================================================
--- trunk/096/scripts/misc/logoff.src	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/misc/logoff.src	2005-11-01 21:57:39 UTC (rev 807)
@@ -12,7 +12,7 @@
 
 include "include/math";
 include "include/eventID";
-include "include/attributes";
+include ":attributes:attributes";
 
 const EVID_UNEQUIP   := 0x123456;
 const EVID_DISCHARGE := 0x123457;

Modified: trunk/096/scripts/misc/logon.src
===================================================================
--- trunk/096/scripts/misc/logon.src	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/misc/logon.src	2005-11-01 21:57:39 UTC (rev 807)
@@ -13,7 +13,7 @@
 
 include "include/eventID";
 include "include/myUtil";
-include "include/attributes";
+include ":attributes:attributes";
 include ":combat:equip";
 include "include/noto";
 

Modified: trunk/096/scripts/misc/unmod.src
===================================================================
--- trunk/096/scripts/misc/unmod.src	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/misc/unmod.src	2005-11-01 21:57:39 UTC (rev 807)
@@ -1,6 +1,6 @@
 use uo;
 use os;
-include "include/attributes";
+include ":attributes:attributes";
 
 program demod(parms)
   var mod := lower(parms[1]);

Modified: trunk/096/scripts/util/conflicts.inc
===================================================================
--- trunk/096/scripts/util/conflicts.inc	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/util/conflicts.inc	2005-11-01 21:57:39 UTC (rev 807)
@@ -13,7 +13,7 @@
 ////////////////////////////////////////////////////////////
 use os;
 use cfgfile;
-include "include/attributes";
+include ":attributes:attributes";
 
 var badguy         := 0;
 var hunger         := 0;

Modified: trunk/096/scripts/util/repair.inc
===================================================================
--- trunk/096/scripts/util/repair.inc	2005-11-01 21:56:02 UTC (rev 806)
+++ trunk/096/scripts/util/repair.inc	2005-11-01 21:57:39 UTC (rev 807)
@@ -16,7 +16,7 @@
 //
 ////////////////////////////////////////////////////////////////////////////////////////////////////
 
-include "include/attributes";
+include ":attributes:attributes";
 
 function repair_item(character, what, skillid )
   var maxhp;



From austin at berlios.de  Tue Nov  1 23:07:56 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 23:07:56 +0100
Subject: [Poldistro-svn] r808 - in trunk/096/pkg/mobiles/oldAI: . combat main
Message-ID: <200511012207.jA1M7up8021884@sheep.berlios.de>

Author: austin
Date: 2005-11-01 23:07:54 +0100 (Tue, 01 Nov 2005)
New Revision: 808

Modified:
   trunk/096/pkg/mobiles/oldAI/battleMage.src
   trunk/096/pkg/mobiles/oldAI/combat/animalCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/defaultCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/healerCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/packFight.inc
   trunk/096/pkg/mobiles/oldAI/combat/packFireCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/poisonCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/slimeCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/spellCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/spiderCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/warriorcombatevent.inc
   trunk/096/pkg/mobiles/oldAI/davesHealer.src
   trunk/096/pkg/mobiles/oldAI/employed.src
   trunk/096/pkg/mobiles/oldAI/entranced.src
   trunk/096/pkg/mobiles/oldAI/escortee.src
   trunk/096/pkg/mobiles/oldAI/main/mainLoopQuestie.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc
   trunk/096/pkg/mobiles/oldAI/main/sleepMode.inc
   trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc
   trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc
   trunk/096/pkg/mobiles/oldAI/poisonElemental.src
   trunk/096/pkg/mobiles/oldAI/tamed.src
   trunk/096/pkg/mobiles/oldAI/townGuard.src
Log:
Updated attributes stuff.

Modified: trunk/096/pkg/mobiles/oldAI/battleMage.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/battleMage.src	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/battleMage.src	2005-11-01 22:07:54 UTC (rev 808)
@@ -186,7 +186,7 @@
     PlaySoundEffect(me, 0x31);
     sleep(1);
   endif
-  if(GetHp(me) < GetStrength(me))
+  if(AP_GetVital(me, "Hits") < GetStrength(me))
     sleep(1);
     PerformAction(me, 0x22);
     SetHp(me, me.strength);
@@ -257,7 +257,7 @@
     PlaySoundEffect(me, 0x31);
     sleep(1);
   endif
-  if(GetHp(me) < (GetStrength(me) / 2))
+  if(AP_GetVital(me, "Hits") < (GetStrength(me) / 2))
     sleep(1);
     PerformAction(me, 0x22);
     SetHp(me, me.strength);

Modified: trunk/096/pkg/mobiles/oldAI/combat/animalCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/animalCombatEvent.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/combat/animalCombatEvent.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -1,6 +1,6 @@
 include ":attributes:attributes";
 function process_combat_event(opponent)
-  if ((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
+  if ((AP_GetVital(me, "Hits") * 100/AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
     EraseObjProperty(me,"#flees");
     flee(opponent);
   endif

Modified: trunk/096/pkg/mobiles/oldAI/combat/defaultCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/defaultCombatEvent.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/combat/defaultCombatEvent.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -1,6 +1,6 @@
 include ":attributes:attributes";
 function process_combat_event(opponent)
-  if((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
+  if((AP_GetVital(me, "Hits") * 100/AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
 	EraseObjProperty(me,"#flees");
     flee(opponent);
   endif

Modified: trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -1,6 +1,6 @@
 include ":attributes:attributes";
 function process_combat_event(opponent)
-  if((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
+  if((AP_GetVital(me, "Hits") * 100/AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
     EraseObjProperty(me,"#flees");
     flee(opponent);
   endif
@@ -20,7 +20,7 @@
     sleep(1);
     PlaySoundEffect(me, 0x16b);
     sleep(1);
-    var base := Cint(((FLAME_STRENGTH * GetHp(me)) / GetMaxHp(me)) / 2);
+    var base := Cint(((FLAME_STRENGTH * AP_GetVital(me, "Hits")) / AP_GetVitalMaximumValue(me, "Hits")) / 2);
     var dmg :=  RandomInt(base) + base;
     PlayMovingEffect(me, opponent, 0x36d4, 10, 1, 1);
     ApplyRawDamage(opponent, dmg);

Modified: trunk/096/pkg/mobiles/oldAI/combat/healerCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/healerCombatEvent.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/combat/healerCombatEvent.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -3,13 +3,13 @@
 
 function process_combat_event(opponent)
   spellattack(opponent);
-  if ( GetHp(me) < (GetStrength(me)/2))
+  if ( AP_GetVital(me, "Hits") < (GetStrength(me)/2))
     CastSpell(me,me,"gheal");
     if (ListPoisonsByType(me, "defaultPoison").size() > 0)
       CastSpell(me,me,"cure");
     endif
   endif
-  if ((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
+  if ((AP_GetVital(me, "Hits") * 100/AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
     EraseObjProperty(me,"#flees");
     flee(opponent);
   endif

Modified: trunk/096/pkg/mobiles/oldAI/combat/packFight.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/packFight.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/combat/packFight.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -93,7 +93,7 @@
     if ( numflees > 10 )
       MoveCharacterToLocation(me,1,1,0,MOVECHAR_FORCELOCATION);
       SetObjProperty(me,"guardkill",1);
-      ApplyRawDamage( me, GetMaxHp(me) + 3 );
+      ApplyRawDamage( me, AP_GetVitalMaximumValue(me, "Hits") + 3 );
     else
       numflees := numflees + 1;
     endif

Modified: trunk/096/pkg/mobiles/oldAI/combat/packFireCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/packFireCombatEvent.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/combat/packFireCombatEvent.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -1,7 +1,7 @@
 include ":attributes:attributes";
 function process_combat_event(opponent)
   spellattack(opponent);
-  if((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
+  if((AP_GetVital(me, "Hits") * 100/AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
 	EraseObjProperty(me,"#flees");
 	flee(opponent);
   endif
@@ -13,7 +13,7 @@
   endif
   if(CheckLineOfSight(me, opponent))
     PerformAction(me,0x0c);
-    var dmg := ((RandomInt(9) + 1) + (GetHp(me) / 10));
+    var dmg := ((RandomInt(9) + 1) + (AP_GetVital(me, "Hits") / 10));
     PlaySoundEffect(me, 0x16b);
     sleep(2);
     PlayMovingEffect(me, opponent, 0x36d4, 10, 1, 1);

Modified: trunk/096/pkg/mobiles/oldAI/combat/poisonCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/poisonCombatEvent.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/combat/poisonCombatEvent.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -1,7 +1,7 @@
 include ":attributes:attributes";
 function process_combat_event(opponent)
   DoPoison(opponent);
-  if((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
+  if((AP_GetVital(me, "Hits") * 100/AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
 	EraseObjProperty(me,"#flees");
 	flee(opponent);
   endif
@@ -38,7 +38,7 @@
 function DoPoison(you)
   SetObjProperty(me, "#lastbreath", ReadGameClock() + 10);
   if((Distance(me,you) < 2) && (RandomInt(4)==1))
-	var p_level := CInt(GetMaxHp(me)/20);
+	var p_level := CInt(AP_GetVitalMaximumValue(me, "Hits")/20);
 	var poison_level := CInt(GetObjProperty(you, "poison_level"));
     if(p_level < 1)
       p_level := 1;

Modified: trunk/096/pkg/mobiles/oldAI/combat/slimeCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/slimeCombatEvent.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/combat/slimeCombatEvent.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -10,7 +10,7 @@
       endif
     endif
   endif
-  if ((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
+  if ((AP_GetVital(me, "Hits") * 100/AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
     EraseObjProperty(me,"#flees");
     flee(opponent);
   endif

Modified: trunk/096/pkg/mobiles/oldAI/combat/spellCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/spellCombatEvent.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/combat/spellCombatEvent.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -2,21 +2,21 @@
 include ":timedscripts:timedScripts";
 
 function process_combat_event(opponent)
-  if((GetHp(me) < (GetMaxHP(me) / 2)) && (RandomInt(8) >= 5))
+  if((AP_GetVital(me, "Hits") < (AP_GetVitalMaximumValue(me, "Hits") / 2)) && (RandomInt(8) >= 5))
     CastSpell(me, me, "gheal");
   elseif((TS_GetTimerNames(me, "P").size() > 0) && (RandomInt(8) >= 5))
     CastSpell(me, me, "cure");
   else
     spellattack(opponent);
   endif
-  if(((GetHp(me) * 100) / GetMaxHp(me)) < flee_point)
+  if(((AP_GetVital(me, "Hits") * 100) / AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
     EraseObjProperty(me,"#flees");
     flee(opponent);
   endif
 endfunction
 
 function process_flee_event(opponent)
-  if((GetHp(me) < (GetMaxHP(me) / 2)) && (RandomInt(8) >= 3))
+  if((AP_GetVital(me, "Hits") < (AP_GetVitalMaximumValue(me, "Hits") / 2)) && (RandomInt(8) >= 3))
     CastSpell(me, me, "gheal");
     return 0;
   elseif((TS_GetTimerNames(me, "P").size() > 0) && (RandomInt(8) >= 3))
@@ -25,7 +25,7 @@
   else
     spellattack(opponent);
   endif
-  if(((GetHp(me) * 100) / GetMaxHp(me)) >= flee_point)
+  if(((AP_GetVital(me, "Hits") * 100) / AP_GetVitalMaximumValue(me, "Hits")) >= flee_point)
     return 1;
   endif
 endfunction
@@ -49,7 +49,7 @@
 endfunction
 
 function post_combat()
-  if((GetHp(me) < (GetMaxHP(me) / 2)) && (RandomInt(4) >= 2))
+  if((AP_GetVital(me, "Hits") < (AP_GetVitalMaximumValue(me, "Hits") / 2)) && (RandomInt(4) >= 2))
     CastSpell(me, me, "gheal");
   endif
   if(TS_GetTimerNames(me, "P").size() > 0)

Modified: trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -2,21 +2,21 @@
 include ":timedscripts:timedScripts";
 
 function process_combat_event(opponent)
-  if((GetHp(me) < (GetMaxHP(me) / 2)) && (RandomInt(8) >= 5))
+  if((AP_GetVital(me, "Hits") < (AP_GetVitalMaximumValue(me, "Hits") / 2)) && (RandomInt(8) >= 5))
     CastSpell(me, me, "gheal");
   elseif((TS_GetTimerNames(me, "P").size() > 0) && (RandomInt(8) >= 5))
     CastSpell(me, me, "cure");
   else
     spellattack(opponent);
   endif
-  if(((GetHp(me) * 100) / GetMaxHp(me)) < flee_point)
+  if(((AP_GetVital(me, "Hits") * 100) / AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
     EraseObjProperty(me,"#flees");
     flee(opponent);
   endif
 endfunction
 
 function process_flee_event(opponent)
-  if((GetHp(me) < (GetMaxHP(me) / 2)) && (RandomInt(8) >= 3))
+  if((AP_GetVital(me, "Hits") < (AP_GetVitalMaximumValue(me, "Hits") / 2)) && (RandomInt(8) >= 3))
     CastSpell(me, me, "gheal");
     return 0;
   elseif((TS_GetTimerNames(me, "P").size() > 0) && (RandomInt(8) >= 3))
@@ -26,7 +26,7 @@
     spellattack(opponent);
     return 0;
   endif
-  if(((GetHp(me) * 100) / GetMaxHp(me)) >= flee_point)
+  if(((AP_GetVital(me, "Hits") * 100) / AP_GetVitalMaximumValue(me, "Hits")) >= flee_point)
     return 1;
   endif
 endfunction
@@ -40,7 +40,7 @@
       PerformAction(me,0x0c);
       PlaySoundEffect(me, 0x16b);
       sleep(2);
-      var base := Cint(((FLAME_STRENGTH * GetHp(me)) / GetMaxHp(me)) / 2);
+      var base := Cint(((FLAME_STRENGTH * AP_GetVital(me, "Hits")) / AP_GetVitalMaximumValue(me, "Hits")) / 2);
       var dmg :=  RandomInt(base) + base;
       PlayMovingEffect(me, opponent, 0x36d4, 10, 1, 1);
       ApplyRawDamage(opponent, dmg);
@@ -69,7 +69,7 @@
 endfunction
 
 function post_combat()
-  if ( GetHp(me) < (GetStrength(me)-10))
+  if ( AP_GetVital(me, "Hits") < (GetStrength(me)-10))
 	CastSpell(me,me,"gheal");
   endif
   if (TS_GetTimerNames(me, "P").size() > 0)

Modified: trunk/096/pkg/mobiles/oldAI/combat/spiderCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/spiderCombatEvent.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/combat/spiderCombatEvent.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -2,7 +2,7 @@
 
 function process_combat_event(opponent)
   send_web(opponent);
-  if ((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
+  if ((AP_GetVital(me, "Hits") * 100/AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
 	EraseObjProperty(me,"#flees");
 	flee(opponent);
   endif

Modified: trunk/096/pkg/mobiles/oldAI/combat/warriorcombatevent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/warriorcombatevent.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/combat/warriorcombatevent.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -1,9 +1,9 @@
 include ":attributes:attributes";
 function process_combat_event(opponent)
-    if ((GetHp(me) * 100/GetMaxHp(me)) < flee_point)
+    if ((AP_GetVital(me, "Hits") * 100/AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
       EraseObjProperty(me,"#flees");
       flee(opponent);
-    elseif (GetHp(me) < GetMaxHp(me)/2)
+    elseif (AP_GetVital(me, "Hits") < AP_GetVitalMaximumValue(me, "Hits")/2)
       ApplyHealing();
     endif
 endfunction
@@ -51,7 +51,7 @@
   if((GetObjProperty(me,"#nextheal") < ReadGameClock()) || !GetObjProperty(me,"#nextheal"))
     bandages := Cint(GetObjProperty(me, "bandages"));
     if(bandages)
-      SetHp(me, GetHp(me) + (RandomInt(GetMaxHp(me) - GetHp(me))+1));
+      SetHp(me, AP_GetVital(me, "Hits") + (RandomInt(AP_GetVitalMaximumValue(me, "Hits") - AP_GetVital(me, "Hits"))+1));
       SetObjProperty(me,"#nextheal", ReadGameClock()+20);
       bandages := bandages - 1;
       if(bandages <= 0)

Modified: trunk/096/pkg/mobiles/oldAI/davesHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/davesHealer.src	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/davesHealer.src	2005-11-01 22:07:54 UTC (rev 808)
@@ -84,7 +84,7 @@
        SYSEVENT_DISENGAGED:
        SYSEVENT_ENGAGED:
        SYSEVENT_DAMAGED:        PlaySoundEffect(me,dmgsound);
-                                if(GetHp(me) < (GetMaxHp(me)/2))
+                                if(AP_GetVital(me, "Hits") < (AP_GetVitalMaximumValue(me, "Hits")/2))
                                   CastSpell(me, me, "gheal");
                                 endif
        SYSEVENT_OPPONENT_MOVED: break;

Modified: trunk/096/pkg/mobiles/oldAI/employed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-01 22:07:54 UTC (rev 808)
@@ -147,14 +147,14 @@
     if(ReadGameClock() > CInt(GetObjProperty(me, "Timer")))
 	  Release();
     endif
-    mhp := GetHp(me);
+    mhp := AP_GetVital(me, "Hits");
     ev := os::wait_for_event(waittime);
     case (ev.type)
 	  SYSEVENT_SPEECH:     ProcessSpeech(ev);
 	  SYSEVENT_ENGAGED:    if(ev.source)
 	  	                     Fight(ev.source);
 	  	                   endif
-	  SYSEVENT_DAMAGED:        if(GetHp(me) < mhp)
+	  SYSEVENT_DAMAGED:        if(AP_GetVital(me, "Hits") < mhp)
                              PlaySoundEffect(me,dmgsound);
                            endif
                            if(ev.source)

Modified: trunk/096/pkg/mobiles/oldAI/entranced.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/entranced.src	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/entranced.src	2005-11-01 22:07:54 UTC (rev 808)
@@ -31,7 +31,7 @@
 
 	EraseObjProperty(me, "bardmaster");
 
-	while (GetHp(me))
+	while (AP_GetVital(me, "Hits"))
 
 	WalkToward(follower);
 

Modified: trunk/096/pkg/mobiles/oldAI/escortee.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-01 22:07:54 UTC (rev 808)
@@ -105,7 +105,7 @@
     elseif((ReadGameClock() > killtime) && (killtime != 0))
       MoveCharacterToLocation(me, 1, 1, 0, MOVECHAR_FORCELOCATION);
       SetObjProperty(me, "guardkill", 1);
-      ApplyRawDamage(me, GetHp(me) + 100);
+      ApplyRawDamage(me, AP_GetVital(me, "Hits") + 100);
       break;
     endif
     if(escortee)
@@ -168,7 +168,7 @@
       next_wander := ReadGameClock() + 10;
     elseif((ReadGameClock() > killtime) && (killtime != 0))
       MoveCharacterToLocation(me, 1, 1, 0, MOVECHAR_FORCELOCATION);
-      ApplyRawDamage(me, GetHp(me) + 100);
+      ApplyRawDamage(me, AP_GetVital(me, "Hits") + 100);
       break;
     endif
   endwhile

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopQuestie.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopQuestie.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopQuestie.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -24,19 +24,19 @@
 					if (!slave)
 						MoveCharacterToLocation(me,1,1,0,MOVECHAR_FORCELOCATION);
 						SetObjProperty(me,"guardkill",1);
-						ApplyRawDamage( me, GetMaxHp(me) + 3 );
+						ApplyRawDamage( me, AP_GetVitalMaximumValue(me, "Hits") + 3 );
 					endif
 				else
 					if (!master)
 						MoveCharacterToLocation(me,1, 1, 0,MOVECHAR_FORCELOCATION);
 						SetObjProperty(me,"guardkill",1);
-						ApplyRawDamage( me, GetMaxHp(me) + 3 );
+						ApplyRawDamage( me, AP_GetVitalMaximumValue(me, "Hits") + 3 );
 					endif
 				endif
 			else
 				MoveCharacterToLocation(me,1, 1, 0,MOVECHAR_FORCELOCATION);
 				SetObjProperty(me,"guardkill",1);
-				ApplyRawDamage( me, GetMaxHp(me) + 3 );
+				ApplyRawDamage( me, AP_GetVitalMaximumValue(me, "Hits") + 3 );
 			endif
 			endif
 			ev := sleepmode();

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -30,7 +30,7 @@
                                   PlayStationaryEffect(me.x, me.y, me.z, FX_EXPLODE_3, 7, 0x10,0,me.realm);
                                   sleepms(5);
                                   MoveCharacterToLocation(me,0,0,0,MOVECHAR_FORCELOCATION);
-                                  ApplyRawDamage(me, GetHp(me) + 3);
+                                  ApplyRawDamage(me, AP_GetVital(me, "Hits") + 3);
                                 endif
         SYSEVENT_ENGAGED:       RunLikeHell(ev.source);
         EVID_HERDING:           Herding(ev);

Modified: trunk/096/pkg/mobiles/oldAI/main/sleepMode.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/sleepMode.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/main/sleepMode.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -9,11 +9,11 @@
   if(GetObjProperty(me,"killme"))
     SetObjProperty(me, "guardkill", 1);
     MoveCharacterToLocation(me, 1, 1, 0, MOVECHAR_FORCELOCATION);
-    ApplyRawDamage(me, GetHp(me)+1);
+    ApplyRawDamage(me, AP_GetVital(me, "Hits")+1);
   endif
   EraseObjProperty(me,"#flees");
   DisableMainEvents();
-  if(GetEffectiveSkill(me, 21) > 0 )
+  if( AP_GetSkill(me, "Hiding") > 0 )
     me.hidden := 1;
   endif
   EnableEvents(SYSEVENT_ENTEREDAREA,18);

Modified: trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -9,7 +9,7 @@
   if(GetObjProperty(me,"killme"))
     SetObjProperty(me, "guardkill", 1);
     MoveCharacterToLocation(me, 1, 1, 0, MOVECHAR_FORCELOCATION);
-    ApplyRawDamage(me, GetHp(me)+1);
+    ApplyRawDamage(me, AP_GetVital(me, "Hits")+1);
   endif
   EraseObjProperty(me,"#flees");
   DisableMainEvents();

Modified: trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc	2005-11-01 22:07:54 UTC (rev 808)
@@ -9,7 +9,7 @@
   if(GetObjProperty(me,"killme"))
     SetObjProperty(me, "guardkill", 1);
     MoveCharacterToLocation(me, 1, 1, 0, MOVECHAR_FORCELOCATION);
-    ApplyRawDamage(me, GetHp(me)+1);
+    ApplyRawDamage(me, AP_GetVital(me, "Hits")+1);
   endif
   EraseObjProperty(me,"#flees");
   DisableMainEvents();
@@ -34,7 +34,7 @@
                                 PlayStationaryEffect(me.x, me.y, me.z, FX_EXPLODE_3, 7, 0x10,0, me.realm);
                                 sleepms(5);
                                 MoveCharacterToLocation(me,0,0,0,MOVECHAR_FORCELOCATION);
-                                ApplyRawDamage(me, GetHp(me) + 3);
+                                ApplyRawDamage(me, AP_GetVital(me, "Hits") + 3);
                               endif
       SYSEVENT_ENGAGED:    if((!(ev.source).npctemplate) || (((ev.source).script == "employed") || ((ev.source).script == "tamed")))
                              if (me.hidden)

Modified: trunk/096/pkg/mobiles/oldAI/poisonElemental.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-01 22:07:54 UTC (rev 808)
@@ -53,13 +53,13 @@
   spellattack(opponent);
   var plevel := Cint(GetObjProperty(me, "poison_level"));
   var rint := RandomInt(8);
-  if((GetHp(me) < (GetMaxHP(me) / 2)) && (rint >= 5))
+  if((AP_GetVital(me, "Hits") < (AP_GetVitalMaximumValue(me, "Hits") / 2)) && (rint >= 5))
     CastSpell(me, me, "gheal");
   endif
   if((plevel >= 1) && (rint >= 5))
     CastSpell(me, me, "poison");
   endif
-  if(((GetHp(me) * 100) / GetMaxHp(me)) < flee_point)
+  if(((AP_GetVital(me, "Hits") * 100) / AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
     EraseObjProperty(me,"#flees");
     flee(opponent);
   endif
@@ -67,7 +67,7 @@
 
 function process_flee_event(opponent)
   spellattack(opponent);
-  if((GetHp(me) < (GetMaxHP(me) / 2)) && (RandomInt(8) >= 3))
+  if((AP_GetVital(me, "Hits") < (AP_GetVitalMaximumValue(me, "Hits") / 2)) && (RandomInt(8) >= 3))
     CastSpell(me, me, "gheal");
     return 0;
   endif
@@ -75,7 +75,7 @@
     CastSpell(me, me, "poison");
     return 0;
   endif
-  if(((GetHp(me) * 100) / GetMaxHp(me)) >= flee_point)
+  if(((AP_GetVital(me, "Hits") * 100) / AP_GetVitalMaximumValue(me, "Hits")) >= flee_point)
     return 1;
   endif
 endfunction
@@ -100,7 +100,7 @@
 endfunction
 
 function post_combat()
-  if(GetHp(me) < (GetStrength(me)-10))
+  if(AP_GetVital(me, "Hits") < (GetStrength(me)-10))
 	CastSpell(me,me,"gheal");
   endif
   DisableCombatEvents();

Modified: trunk/096/pkg/mobiles/oldAI/tamed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-01 22:07:54 UTC (rev 808)
@@ -55,7 +55,7 @@
   start_script(":taming:happyCounter", parms);
   master := SystemFindObjectBySerial(masterserial, SYSFIND_SEARCH_OFFLINE_MOBILES);
   if(!master)
-    ApplyRawDamage(me, GetHP(me)+ 1);
+    ApplyRawDamage(me, AP_GetVital(me, "Hits")+ 1);
     return;
   endif
   me.setmaster(master);
@@ -112,9 +112,9 @@
   nextwatch := ReadGameClock();
   var mhp;
   EnableMainEvents();
-  while(GetHp(me)> 0)
+  while(AP_GetVital(me, "Hits")> 0)
     happiness := GetObjProperty(me,"happiness");
-    mhp := GetHp(me);
+    mhp := AP_GetVital(me, "Hits");
     if(GetObjProperty(me, "onhold"))
       HoldLoop("onhold");
     elseif(GetObjProperty(me, "stabled"))
@@ -129,7 +129,7 @@
       case(ev.type)
         SYSEVENT_SPEECH:        ProcessSpeech(ev);
         SYSEVENT_ENGAGED:       Fight(ev.source);
-        SYSEVENT_DAMAGED:       if(GetHp(me)< mhp)
+        SYSEVENT_DAMAGED:       if(AP_GetVital(me, "Hits")< mhp)
                                   if(ev.source)
                                     Fight(ev.source);
                                   endif
@@ -402,7 +402,7 @@
     endif
     PlayStationaryEffect(me.x, me.y, me.z, FX_SMOKE, 0xa, 0xa, 0, me.realm);
     MoveCharacterToLocation(me,1, 1, 0,MOVECHAR_FORCELOCATION);
-    ApplyRawDamage(me, GetHp(me)+ 3);
+    ApplyRawDamage(me, AP_GetVital(me, "Hits")+ 3);
   else
     if(GetObjProperty(me,"mounted"))
       char := GetObjProperty(me,"mounted_on");
@@ -779,7 +779,7 @@
 endfunction
 
 function cast_meteor(opponent)
-  var base := Cint(((FLAME_STRENGTH * GetHp(me)) / GetMaxHp(me)) / 2);
+  var base := Cint(((FLAME_STRENGTH * AP_GetVital(me, "Hits")) / AP_GetVitalMaximumValue(me, "Hits")) / 2);
   var dmg :=  RandomInt(base) + base;
   PerformAction(me,0x0c);
   PlaysoundEffect(me, 0x16b);
@@ -794,7 +794,7 @@
     if(numflees > 5)
       MoveCharacterToLocation(me,1,1,0,MOVECHAR_FORCELOCATION);
       SetObjProperty(me,"guardkill",1);
-      ApplyRawDamage(me, GetMaxHp(me)+ 3);
+      ApplyRawDamage(me, AP_GetVitalMaximumValue(me, "Hits")+ 3);
     else
       numflees := numflees + 1;
     endif

Modified: trunk/096/pkg/mobiles/oldAI/townGuard.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townGuard.src	2005-11-01 21:57:39 UTC (rev 807)
+++ trunk/096/pkg/mobiles/oldAI/townGuard.src	2005-11-01 22:07:54 UTC (rev 808)
@@ -192,10 +192,10 @@
     PlaySoundEffect(me, 0x31);
     sleep(1);
   endif
-  if(GetHp(me) < GetMaxHP(me))
+  if(AP_GetVital(me, "Hits") < AP_GetVitalMaximumValue(me, "Hits"))
     sleep(1);
     PerformAction(me, 0x22);
-    SetHp(me, GetMaxHP(me));
+    SetHp(me, AP_GetVitalMaximumValue(me, "Hits"));
     PlaySoundEffect(me, 0x32);
     sleep(1);
   endif
@@ -268,7 +268,7 @@
     PlaySoundEffect(me, 0x31);
     sleep(1);
   endif
-  if(GetHp(me) < (GetStrength(me) / 2))
+  if(AP_GetVital(me, "Hits") < (GetStrength(me) / 2))
     sleep(1);
     PerformAction(me, 0x22);
     SetHp(me, me.strength);



From austin at berlios.de  Tue Nov  1 23:11:38 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 23:11:38 +0100
Subject: [Poldistro-svn] r809 - trunk/096/pkg/systems/attributes/include
Message-ID: <200511012211.jA1MBcbi030735@sheep.berlios.de>

Author: austin
Date: 2005-11-01 23:11:38 +0100 (Tue, 01 Nov 2005)
New Revision: 809

Modified:
   trunk/096/pkg/systems/attributes/include/attributes_ex.inc
Log:
Weird.. should be SkillIdToAttributeName() but IdToAttributeName()

Modified: trunk/096/pkg/systems/attributes/include/attributes_ex.inc
===================================================================
--- trunk/096/pkg/systems/attributes/include/attributes_ex.inc	2005-11-01 22:07:54 UTC (rev 808)
+++ trunk/096/pkg/systems/attributes/include/attributes_ex.inc	2005-11-01 22:11:38 UTC (rev 809)
@@ -13,7 +13,7 @@
 include ":attributes:include/attributes";
 
 /*
- * AP_SkillIDToAttributeName(skill_number)
+ * AP_SkillIdToAttributeName(skill_number)
  *
  * Purpose
  * Gets the name of the attribute that is associated with a skill number.
@@ -26,7 +26,7 @@
  * Returns a string.
  *
  */
-function AP_IDToAttributeName(skill_number)
+function AP_SkillIdToAttributeName(skill_number)
 	var skills_cfg := ReadConfigFile(":attributes:uoskills");
 	if ( skills_cfg.errortext )
 		SysLog("Error::AP_IDToAttributeName() - Unable to open :attributes:uoskills.cfg ->"+skills_cfg.errortext);
@@ -41,7 +41,7 @@
 endfunction
 
 /*
- * AP_AttributeNameToSkillID(attribute_name)
+ * AP_AttributeNameToSkillId(attribute_name)
  *
  * Purpose
  * Gets the skill number (ID) that an attribute name is associated with.
@@ -54,7 +54,7 @@
  * Returns an integer.
  *
  */
-function AP_AttributeNameToSkillID(attribute_name)
+function AP_AttributeNameToSkillId(attribute_name)
 	var cfg_elem := AP_GetAttributeCfgElem(attribute_name);
 	
 	return cfg_elem.SkillId;



From austin at berlios.de  Tue Nov  1 23:13:05 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 23:13:05 +0100
Subject: [Poldistro-svn] r810 - trunk/096/pkg/mobiles/npcutils
Message-ID: <200511012213.jA1MD5ZL000692@sheep.berlios.de>

Author: austin
Date: 2005-11-01 23:13:05 +0100 (Tue, 01 Nov 2005)
New Revision: 810

Modified:
   trunk/096/pkg/mobiles/npcutils/trainSkill.inc
Log:
Attribute updates

Modified: trunk/096/pkg/mobiles/npcutils/trainSkill.inc
===================================================================
--- trunk/096/pkg/mobiles/npcutils/trainSkill.inc	2005-11-01 22:11:38 UTC (rev 809)
+++ trunk/096/pkg/mobiles/npcutils/trainSkill.inc	2005-11-01 22:13:05 UTC (rev 810)
@@ -1,4 +1,5 @@
 include "include/skillLists";
+include ":attributes:attributes_ex";
 
 var cost;
 
@@ -40,21 +41,22 @@
     foreach thing in getskilllist(me)
       if(lower(thing) == skill)
         var holder := FindSkillId(thing);
+        holder := AP_SkillIdToAttributeName(thing);
 
 // Since so many npcdesc.cfg entries have NPC's with 100 skill, set it lower
 // for the purpose of training.
 
-        var npclevel := GetEffectiveSkill(me, holder);
+        var npclevel := AP_GetSkill(me, holder);
 
-        if(npclevel == 0)
+        if( npclevel == 0 )
           npclevel := RandomInt(12) + 22;
-          SetBaseSkill(me, holder, npclevel);
-          npclevel := GetEffectiveSkill(me, holder);
+          AP_SetTrueSkill(me, holder, npclevel);
+          npclevel := AP_GetSkill(me, holder);
         endif
         if(npclevel > maxskilltotrain)
           npclevel := maxskilltotrain;
         endif
-        var pclevel := GetBaseSkill(who, holder);
+        var pclevel := AP_GetTrueSkill(who, holder);
         if((pclevel >= npclevel) || (pclevel > maxskilltotrain))
           PrintTextAbovePrivate(me, "I cannot teach thee anymore.", who);
           return;



From muaddiblsd at berlios.de  Tue Nov  1 23:15:18 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Tue, 1 Nov 2005 23:15:18 +0100
Subject: [Poldistro-svn] r811 - trunk/096/pkg/systems/attributes
Message-ID: <200511012215.jA1MFIEm000955@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-01 23:15:18 +0100 (Tue, 01 Nov 2005)
New Revision: 811

Modified:
   trunk/096/pkg/systems/attributes/vitals.cfg
Log:
Fixed a typo. Git-r-done

Modified: trunk/096/pkg/systems/attributes/vitals.cfg
===================================================================
--- trunk/096/pkg/systems/attributes/vitals.cfg	2005-11-01 22:13:05 UTC (rev 810)
+++ trunk/096/pkg/systems/attributes/vitals.cfg	2005-11-01 22:15:18 UTC (rev 811)
@@ -48,7 +48,7 @@
 {
 	// Note: This vital is not linked to any attributes.
 	RegenRateFunction	:attributes:hooks/vitalInit:GetHungerRegenRate
-	MaximumFunction		:attributes:books/vitalInit:GetHungerMaximumValue
-	
+	MaximumFunction		:attributes:hooks/vitalInit:GetHungerMaximumValue
+
 	RegenWhileDead		1
 }



From austin at berlios.de  Tue Nov  1 23:31:08 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 23:31:08 +0100
Subject: [Poldistro-svn] r812 - in trunk/096/pkg/mobiles: npcutils oldAI oldAI/combat oldAI/main
Message-ID: <200511012231.jA1MV8HQ008428@sheep.berlios.de>

Author: austin
Date: 2005-11-01 23:31:07 +0100 (Tue, 01 Nov 2005)
New Revision: 812

Modified:
   trunk/096/pkg/mobiles/npcutils/trainSkill.inc
   trunk/096/pkg/mobiles/oldAI/battleMage.src
   trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
   trunk/096/pkg/mobiles/oldAI/combat/warriorcombatevent.inc
   trunk/096/pkg/mobiles/oldAI/employed.src
   trunk/096/pkg/mobiles/oldAI/escortee.src
   trunk/096/pkg/mobiles/oldAI/firebreather.src
   trunk/096/pkg/mobiles/oldAI/killPCs.src
   trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc
   trunk/096/pkg/mobiles/oldAI/packFirebreather.src
   trunk/096/pkg/mobiles/oldAI/poisonElemental.src
   trunk/096/pkg/mobiles/oldAI/spellFire.src
   trunk/096/pkg/mobiles/oldAI/tamed.src
   trunk/096/pkg/mobiles/oldAI/townGuard.src
   trunk/096/pkg/mobiles/oldAI/undead.src
Log:
Attribute updates

Modified: trunk/096/pkg/mobiles/npcutils/trainSkill.inc
===================================================================
--- trunk/096/pkg/mobiles/npcutils/trainSkill.inc	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/npcutils/trainSkill.inc	2005-11-01 22:31:07 UTC (rev 812)
@@ -107,14 +107,14 @@
   var currentnpccost := 0;
   if((item.objtype == 0xeed) && (item.amount != 0))
     var trainmaxcost := GetObjProperty(who, "TrainMaxCost");
-    var attributeid := GetAttributeIDBySkillid(GetObjProperty(who, "TrainSkillID"));
+    var attributeid := AP_SkillIdToAttributeName(GetObjProperty(who, "TrainSkillID"));
     if((!trainmaxcost || !attributeid) && attributeid != 0)
       say("I don't know what this is for, but thanks!");
       DestroyItem(item);
       return;
     endif
     npc_level    := GetAttribute(me, attributeid);
-    pc_level     := GetBaseSkill(who, attributeid);
+    pc_level     := AP_GetTrueSkill(who, attributeid);
     pc_level     := GetAttributeBaseValue(who, attributeid) / 10;
     goldreceived := item.amount;
     variance     := npc_level - pc_level;
@@ -149,7 +149,6 @@
       k.+type   := EVID_SKILLCAP;
       k.+base   := new_level;
       pid.sendevent(k);
-      DoRecalcVitals(who);
       DestroyItem(item);
       SendSysMessage(who, "Your skill increases.");
     else

Modified: trunk/096/pkg/mobiles/oldAI/battleMage.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/battleMage.src	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/battleMage.src	2005-11-01 22:31:07 UTC (rev 812)
@@ -155,7 +155,7 @@
   sleepms(100);
   PlayLightningBoltEffect(opponent);
   sleepms(100);
-  ApplyRawDamage(opponent, GetHp(opponent) + 10);
+  ApplyRawDamage(opponent, AP_GetVital(opponent, "Hits") + 10);
   sleep(1);
   PerformAction(me, 17);
   sleepms(200);
@@ -186,10 +186,10 @@
     PlaySoundEffect(me, 0x31);
     sleep(1);
   endif
-  if(AP_GetVital(me, "Hits") < GetStrength(me))
+  if(AP_GetVital(me, "Hits") < AP_GetVitalMaximumValue(me, "Hits"))
     sleep(1);
     PerformAction(me, 0x22);
-    SetHp(me, me.strength);
+    AP_SetVital(me, "Hits", AP_GetVitalMaximumValue(me, "Hits"));
     PlaySoundEffect(me, 0x32);
     sleep(1);
   endif

Modified: trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-01 22:31:07 UTC (rev 812)
@@ -129,7 +129,7 @@
 function in_combat_event_loop(opponent, loops)
   loops := loops;
   if(Distance(me,opponent) < 2)
-    var dmg := RandomInt(CInt(GetStrength(opponent) / 25));
+    var dmg := RandomInt(CInt(AP_GetStat(opponent, "Strength") / 25));
     dmg := dmg * 2;
     if(dmg > 24)
       dmg := 12;

Modified: trunk/096/pkg/mobiles/oldAI/combat/warriorcombatevent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/warriorcombatevent.inc	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/combat/warriorcombatevent.inc	2005-11-01 22:31:07 UTC (rev 812)
@@ -51,7 +51,7 @@
   if((GetObjProperty(me,"#nextheal") < ReadGameClock()) || !GetObjProperty(me,"#nextheal"))
     bandages := Cint(GetObjProperty(me, "bandages"));
     if(bandages)
-      SetHp(me, AP_GetVital(me, "Hits") + (RandomInt(AP_GetVitalMaximumValue(me, "Hits") - AP_GetVital(me, "Hits"))+1));
+      AP_SetVital(me, "Hits", AP_GetVital(me, "Hits") + (RandomInt(AP_GetVitalMaximumValue(me, "Hits") - AP_GetVital(me, "Hits"))+1));
       SetObjProperty(me,"#nextheal", ReadGameClock()+20);
       bandages := bandages - 1;
       if(bandages <= 0)

Modified: trunk/096/pkg/mobiles/oldAI/employed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-01 22:31:07 UTC (rev 812)
@@ -70,38 +70,35 @@
 endprogram
 
 function Adjustment(who, type)
-  if(type == "Mage")
-    ExpandStats(who, 100, 80, 100);
-    SetBaseSkillBaseValue(who, SKILLID_MAGERY,          1000);
-    SetBaseSkillBaseValue(who, SKILLID_EVALINT,         1000);
-    SetBaseSkillBaseValue(who, SKILLID_MAGICRESISTANCE, 900);
-    SetBaseSkillBaseValue(who, SKILLID_TACTICS,         700);
-    SetBaseSkillBaseValue(who, SKILLID_WRESTLING,       700);
-  elseif(type == "Thief")
-    ExpandStats(who, 80, 100, 25);
-    SetBaseSkillBaseValue(who, SKILLID_FENCING,         1000);
-    SetBaseSkillBaseValue(who, SKILLID_MAGICRESISTANCE, 60);
-    SetBaseSkillBaseValue(who, SKILLID_TACTICS,         80);
-    SetBaseSkillBaseValue(who, SKILLID_ANATOMY,         600);
-  elseif(type == "Paladin")
-    ExpandStats(who, 100, 100, 50);
-    SetBaseSkillBaseValue(who, SKILLID_MAGICRESISTANCE, 800);
-    SetBaseSkillBaseValue(who, SKILLID_TACTICS,         1000);
-    SetBaseSkillBaseValue(who, SKILLID_SWORDSMANSHIP,   1000);
-    SetBaseSkillBaseValue(who, SKILLID_MACEFIGHTING,    1000);
-    SetBaseSkillBaseValue(who, SKILLID_FENCING,         1000);
-    SetBaseSkillBaseValue(who, SKILLID_WRESTLING,       900);
-    SetBaseSkillBaseValue(who, SKILLID_ANATOMY,         1000);
-  elseif((type == "Fighter1") || (type == "Fighter2") || (type == "Fighter3") || (type == "Fighter4"))
-    ExpandStats(who, 90, 90, 20);
-    SetBaseSkillBaseValue(who, SKILLID_MAGICRESISTANCE, 600);
-    SetBaseSkillBaseValue(who, SKILLID_TACTICS,         900);
-    SetBaseSkillBaseValue(who, SKILLID_SWORDSMANSHIP,   900);
-    SetBaseSkillBaseValue(who, SKILLID_MACEFIGHTING,    900);
-    SetBaseSkillBaseValue(who, SKILLID_FENCING,         900);
-    SetBaseSkillBaseValue(who, SKILLID_WRESTLING,       900);
-    SetBaseSkillBaseValue(who, SKILLID_ANATOMY,         900);
-  endif
+if(type == "Mage")
+		AP_SetTrueSkill(who, "Magery", 100);
+		AP_SetTrueSkill(who, "EvaluatingIntelligence", 100);
+		AP_SetTrueSkill(who, "ResistingSpells", 90);
+		AP_SetTrueSkill(who, "Tactics", 70);
+		AP_SetTrueSkill(who, "Wrestling", 70);
+	elseif(type == "Thief")
+		AP_SetTrueSkill(who, "Fencing", 100);
+		AP_SetTrueSkill(who, "ResistingSpells", 60);
+		AP_SetTrueSkill(who, "Tactics", 80);
+		AP_SetTrueSkill(who, "Anatomy", 60);
+	elseif(type == "Paladin")
+		AP_SetTrueSkill(who, "ResistingSpells", 80);
+		AP_SetTrueSkill(who, "Tactics", 100);
+		AP_SetTrueSkill(who, "Swordsmanship", 100);
+		AP_SetTrueSkill(who, "MaceFighting", 100);
+		AP_SetTrueSkill(who, "Fencing", 100);
+		AP_SetTrueSkill(who, "Wrestling", 90);
+		AP_SetTrueSkill(who, "Anatomy", 100);
+		AP_SetTrueStat(who, "Strength", 80);
+	elseif((type == "Fighter1") || (type == "Fighter2") || (type == "Fighter3") || (type == "Fighter4"))
+		AP_SetTrueSkill(who, "ResistingSpells", 60);
+		AP_SetTrueSkill(who, "Tactics", 90);
+		AP_SetTrueSkill(who, "Swordsmanship", 90);
+		AP_SetTrueSkill(who, "MaceFighting", 90);
+		AP_SetTrueSkill(who, "Fencing", 90);
+		AP_SetTrueSkill(who, "Wrestling", 90);
+		AP_SetTrueSkill(who, "Anatomy", 90);
+	endif
 endfunction
 
 function ExpandStats(me, st, dx, it)
@@ -118,10 +115,10 @@
   if(dx)
     if(dx <= 210)
       SetBaseDexterity(me,dx);
-      SetDexterityMod(me, 0);
+      AP_SetStatMod(me, "Dexterity", 0);
     else
       SetBaseDexterity(me,210);
-      SetDexterityMod(me, dx - 210);
+      AP_SetStatMod(me, "Dexterity", dx - 210);
     endif
     SetStamina(me, dx);
   endif
@@ -133,7 +130,7 @@
       SetBaseIntelligence(me,210);
       SetIntelligenceMod(me, it - 210);
     endif
-    SetMana(me, it);
+    AP_SetVital(me, "Mana", it);
   endif
 endfunction
 
@@ -250,7 +247,7 @@
   elseif (evtext["all guard"])
     say("Who should I guard?");
 	var what := Target(master, TGTOPT_HELPFUL + TGTOPT_CHECK_LOS);
-	if(GetHp(what))
+	if(AP_GetVital(what, "Hits"))
       AllCommand(SYSEVENT_ALL_GUARD_CMD, what);
 	endif
   elseif(evtext[mename + " fetch"]  || (evtext[mename + " get"]))
@@ -268,14 +265,14 @@
 
 function Fight(opponent)
   if(caster)
-    if(GetMana(me) < (GetIntelligence(me) / 2))
+    if(AP_GetVital(me, "Mana") < (AP_GetStat(me, "Intelligence") / 2))
       say("I must meditate first.");
       meditationloop();
       return;
     endif
   endif
   var oldfollowing := following;
-  SetDexterityMod(me, 0);
+  AP_SetStatMod(me, "Dexterity", 0);
   following := 0;
   if (opponent.serial == me.serial)
     return;
@@ -337,7 +334,7 @@
   SetWarMode(0);
   opponent := 0;
   if(caster)
-    if(GetMana(me) < (GetIntelligence(me) / 2))
+    if(AP_GetVital(me, "Mana") < (AP_GetStat(me, "Intelligence") / 2))
       say("I must meditate.");
       meditationloop();
       return;
@@ -354,8 +351,8 @@
   healparms[1] := "#MOB";
   healparms[2] := me;
   healparms[3] := me;
-  while(GetMana(me) < GetIntelligence(me))
-    SetMana(me, GetMana(me) + 2);
+  while(AP_GetVital(me, "Mana") < AP_GetStat(me, "Intelligence"))
+    AP_SetVital(me, "Mana", AP_GetVital(me, "Mana") + 2);
 	ev := wait_for_event(2);
 	case (ev.type)
       EVID_DAMAGED: if(TS_GetTimerNames(me, "P").size() > 1)
@@ -465,7 +462,7 @@
       return;
     endforeach
   endif
-  if( (!GetStrength(guarding)) || (guarding.dead) || (dist(me,guarding) > 15) )
+  if( (!AP_GetStat(guarding, "Strength")) || (guarding.dead) || (dist(me,guarding) > 15) )
     guarding := 0;
   endif
 endfunction
@@ -480,20 +477,20 @@
     if(d <= 2)
        waittime := 1;
     elseif(d > 6)
-      var ma := 200 - CInt(GetDexterity(me));
-      SetDexterityMod(me, CInt(GetDexterityMod(me)) + ma);
+      var ma := 200 - CInt(AP_GetStat(me, "Dexterity"));
+      AP_SetStatMod(me, "Dexterity", CInt(AP_GetStatMod(me, "Dexterity")) + ma);
       RunToward(escortee);
-      SetDexterityMod(me, CInt(GetDexterityMod(me)) - ma);
+      AP_SetStatMod(me, "Dexterity", CInt(AP_GetStatMod(me, "Dexterity")) - ma);
       waittime := 0;
     else
-      var ma := 200 - CInt(GetDexterity(me));
-      SetDexterityMod(me, CInt(GetDexterityMod(me)) + ma);
+      var ma := 200 - CInt(AP_GetStat(me, "Dexterity"));
+      AP_SetStatMod(me, "Dexterity", CInt(AP_GetStatMod(me, "Dexterity")) + ma);
       walktoward(escortee);
-      SetDexterityMod(me, CInt(GetDexterityMod(me)) - ma);
+      AP_SetStatMod(me, "Dexterity", CInt(AP_GetStatMod(me, "Dexterity")) - ma);
       waittime := 0;
     endif
   endif
-  if( (!GetStrength(escortee)) || (escortee.dead) || (dist(me,escortee) > 15) )
+  if( (!AP_GetStat(escortee, "Strength")) || (escortee.dead) || (dist(me,escortee) > 15) )
     guarding := 0;
   endif
   if(guarding)

Modified: trunk/096/pkg/mobiles/oldAI/escortee.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-01 22:31:07 UTC (rev 812)
@@ -187,14 +187,14 @@
     if(GetObjProperty(me, "Pause"))
       waittime := 2;
     else
-      var ma := 200 - CInt(GetDexterity(me));
-      SetDexterityMod(me, CInt(GetDexterityMod(me)) + ma);
+      var ma := 200 - CInt(AP_GetStat(me, "Dexterity"));
+      AP_SetStatMod(me, "Dexterity", CInt(AP_GetStatMod(me, "Dexterity")) + ma);
 	  walkToward(escortee);
-      SetDexterityMod(me, CInt(GetDexterityMod(me)) - ma);
+      AP_SetStatMod(me, "Dexterity", CInt(AP_GetStatMod(me, "Dexterity")) - ma);
       waittime := 0;
     endif
   endif
-  if((!GetStrength(escortee)) || (escortee.dead) || (dist(me,escortee) > 15) )
+  if((!AP_GetStat(escortee, "Strength")) || (escortee.dead) || (dist(me,escortee) > 15) )
     following := 0;
   endif
 endfunction

Modified: trunk/096/pkg/mobiles/oldAI/firebreather.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/firebreather.src	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/firebreather.src	2005-11-01 22:31:07 UTC (rev 812)
@@ -33,7 +33,7 @@
 endprogram
 
 function CloseDistance( opponent )
-  var sleepdelay := 300 - (CInt(GetDexterity(me)) * 1.5);
+  var sleepdelay := 300 - (CInt(AP_GetStat(me, "Dexterity")) * 1.5);
   if (sleepdelay < 0)
 	sleepdelay := 0;
   endif

Modified: trunk/096/pkg/mobiles/oldAI/killPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/killPCs.src	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/killPCs.src	2005-11-01 22:31:07 UTC (rev 812)
@@ -36,7 +36,7 @@
 
 function CloseDistance( opponent )
 
-var sleepdelay := 400 - (CInt(GetDexterity(me)) * 1.5);
+var sleepdelay := 400 - (CInt(AP_GetStat(me, "Dexterity")) * 1.5);
 
 	if (sleepdelay < 0)
 		sleepdelay := 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc	2005-11-01 22:31:07 UTC (rev 812)
@@ -13,7 +13,7 @@
   endif
   EraseObjProperty(me,"#flees");
   DisableMainEvents();
-  if(GetEffectiveSkill(me, 21) > 0 )
+  if(AP_GetSkill(me, "Hiding") > 0 )
     me.hidden := 1;
   endif
   EnableEvents(SYSEVENT_ENTEREDAREA,18);

Modified: trunk/096/pkg/mobiles/oldAI/packFirebreather.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/packFirebreather.src	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/packFirebreather.src	2005-11-01 22:31:07 UTC (rev 812)
@@ -33,7 +33,7 @@
 endprogram
 
 function CloseDistance( opponent )
-  var sleepdelay := 300 - (CInt(GetDexterity(me)) * 1.5);
+  var sleepdelay := 300 - (CInt(AP_GetStat(me, "Dexterity")) * 1.5);
   if (sleepdelay < 0)
 	sleepdelay := 0;
   endif

Modified: trunk/096/pkg/mobiles/oldAI/poisonElemental.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-01 22:31:07 UTC (rev 812)
@@ -39,7 +39,7 @@
 endprogram
 
 function CloseDistance( opponent )
-  var sleepdelay := 400 - (CInt(GetDexterity(me)) * 1.5);
+  var sleepdelay := 400 - (CInt(AP_GetStat(me, "Dexterity")) * 1.5);
   case (Distance( me, opponent ))
     1:
     0:       return 1;

Modified: trunk/096/pkg/mobiles/oldAI/spellFire.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/spellFire.src	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/spellFire.src	2005-11-01 22:31:07 UTC (rev 812)
@@ -39,7 +39,7 @@
 endprogram
 
 function CloseDistance( opponent )
-  var sleepdelay := 400 - (CInt(GetDexterity(me)) * 1.5);
+  var sleepdelay := 400 - (CInt(AP_GetStat(me, "Dexterity")) * 1.5);
   case (Distance(me, opponent))
     1:
     0:       return 1;

Modified: trunk/096/pkg/mobiles/oldAI/tamed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-01 22:31:07 UTC (rev 812)
@@ -627,20 +627,20 @@
     if(GetObjProperty(me, "Pause"))
       waittime := 2;
     else
-      var ma := 200 - CInt(GetDexterity(me));
-      SetDexterityMod(me, CInt(GetDexterityMod(me))+ ma);
+      var ma := 200 - CInt(AP_GetStat(me, "Dexterity"));
+      SetDexterityMod(me, CInt(AP_GetStatMod(me, "Dexterity"))+ ma);
       RunToward(following);
-      SetDexterityMod(me, CInt(GetDexterityMod(me))- ma);
+      SetDexterityMod(me, CInt(AP_GetStatMod(me, "Dexterity"))- ma);
       waittime := 0;
     endif
   else
     if(GetObjProperty(me, "Pause"))
       waittime := 2;
     else
-      var ma := 200 - CInt(GetDexterity(me));
-      SetDexterityMod(me, CInt(GetDexterityMod(me))+ ma);
+      var ma := 200 - CInt(AP_GetStat(me, "Dexterity"));
+      SetDexterityMod(me, CInt(AP_GetStatMod(me, "Dexterity"))+ ma);
       walktoward(following);
-      SetDexterityMod(me, CInt(GetDexterityMod(me))- ma);
+      SetDexterityMod(me, CInt(AP_GetStatMod(me, "Dexterity"))- ma);
       waittime := 0;
     endif
   endif

Modified: trunk/096/pkg/mobiles/oldAI/townGuard.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townGuard.src	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/townGuard.src	2005-11-01 22:31:07 UTC (rev 812)
@@ -152,7 +152,7 @@
   set_priority(50);
   if(tries >= 5)
     PerformAction(me, 13);
-    ApplyRawDamage(opponent, GetHP(opponent) + 10);
+    ApplyRawDamage(opponent, AP_GetVital(opponent, "Hits") + 10);
     return;
   endif
   SetOpponent(opponent);

Modified: trunk/096/pkg/mobiles/oldAI/undead.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/undead.src	2005-11-01 22:15:18 UTC (rev 811)
+++ trunk/096/pkg/mobiles/oldAI/undead.src	2005-11-01 22:31:07 UTC (rev 812)
@@ -191,7 +191,7 @@
 endfunction
 
 function CloseDistance(opponent)
-  var sleepdelay := 400 - (CInt(GetDexterity(me)) * 1.5);
+  var sleepdelay := 400 - (CInt(AP_GetStat(me, "Dexterity")) * 1.5);
   if(sleepdelay < 0)
     sleepdelay := 0;
   endif



From austin at berlios.de  Tue Nov  1 23:32:30 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 23:32:30 +0100
Subject: [Poldistro-svn] r813 - trunk/096/scripts/util
Message-ID: <200511012232.jA1MWULY012474@sheep.berlios.de>

Author: austin
Date: 2005-11-01 23:32:29 +0100 (Tue, 01 Nov 2005)
New Revision: 813

Modified:
   trunk/096/scripts/util/conflicts.inc
Log:
Attribute updates

Modified: trunk/096/scripts/util/conflicts.inc
===================================================================
--- trunk/096/scripts/util/conflicts.inc	2005-11-01 22:31:07 UTC (rev 812)
+++ trunk/096/scripts/util/conflicts.inc	2005-11-01 22:32:29 UTC (rev 813)
@@ -154,7 +154,7 @@
    if ((badguy.dead) || (!badguy)  || (d > 10) )
       co_untarget();
       return;
-   elseif( GetHp(me) <= CInt( GetMaxHp(me) / 5 ) && d < 16)
+   elseif( AP_GetVital(me, "Hits") <= CInt( AP_GetVitalMaximumValue(me, "Hits") / 5 ) && d < 16)
       RunAwayFrom( badguy );
       TurnToward( badguy );
    elseif (d > 2)       



From austin at berlios.de  Tue Nov  1 23:50:11 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Tue, 1 Nov 2005 23:50:11 +0100
Subject: [Poldistro-svn] r814 - in trunk/096/pkg/mobiles/oldAI: . combat main
Message-ID: <200511012250.jA1MoBFs014238@sheep.berlios.de>

Author: austin
Date: 2005-11-01 23:50:10 +0100 (Tue, 01 Nov 2005)
New Revision: 814

Modified:
   trunk/096/pkg/mobiles/oldAI/battleMage.src
   trunk/096/pkg/mobiles/oldAI/combat/healerCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc
   trunk/096/pkg/mobiles/oldAI/employed.src
   trunk/096/pkg/mobiles/oldAI/main/closeDistance.inc
   trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc
   trunk/096/pkg/mobiles/oldAI/poisonElemental.src
   trunk/096/pkg/mobiles/oldAI/tamed.src
   trunk/096/pkg/mobiles/oldAI/townGuard.src
   trunk/096/pkg/mobiles/oldAI/townPerson.src
   trunk/096/pkg/mobiles/oldAI/worker.src
Log:
NOTE
Most training stuff is horribly broken.. as it is horribly coded.
Better to redo them all in the brain - but now they compile so we can start POL 

Modified: trunk/096/pkg/mobiles/oldAI/battleMage.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/battleMage.src	2005-11-01 22:32:29 UTC (rev 813)
+++ trunk/096/pkg/mobiles/oldAI/battleMage.src	2005-11-01 22:50:10 UTC (rev 814)
@@ -257,10 +257,10 @@
     PlaySoundEffect(me, 0x31);
     sleep(1);
   endif
-  if(AP_GetVital(me, "Hits") < (GetStrength(me) / 2))
+  if(AP_GetVital(me, "Hits") < (AP_GetStat(me, "Strength") / 2))
     sleep(1);
     PerformAction(me, 0x22);
-    SetHp(me, me.strength);
+    AP_SetVital(me, "Hits", me.strength);
     PlaySoundEffect(me, 0x32);
     sleep(1);
   endif

Modified: trunk/096/pkg/mobiles/oldAI/combat/healerCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/healerCombatEvent.inc	2005-11-01 22:32:29 UTC (rev 813)
+++ trunk/096/pkg/mobiles/oldAI/combat/healerCombatEvent.inc	2005-11-01 22:50:10 UTC (rev 814)
@@ -3,7 +3,7 @@
 
 function process_combat_event(opponent)
   spellattack(opponent);
-  if ( AP_GetVital(me, "Hits") < (GetStrength(me)/2))
+  if ( AP_GetVital(me, "Hits") < (AP_GetStat(me, "Strength")/2))
     CastSpell(me,me,"gheal");
     if (ListPoisonsByType(me, "defaultPoison").size() > 0)
       CastSpell(me,me,"cure");

Modified: trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc	2005-11-01 22:32:29 UTC (rev 813)
+++ trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc	2005-11-01 22:50:10 UTC (rev 814)
@@ -69,7 +69,7 @@
 endfunction
 
 function post_combat()
-  if ( AP_GetVital(me, "Hits") < (GetStrength(me)-10))
+  if ( AP_GetVital(me, "Hits") < (AP_GetStat(me, "Strength")-10))
 	CastSpell(me,me,"gheal");
   endif
   if (TS_GetTimerNames(me, "P").size() > 0)

Modified: trunk/096/pkg/mobiles/oldAI/employed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-01 22:32:29 UTC (rev 813)
+++ trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-01 22:50:10 UTC (rev 814)
@@ -110,7 +110,7 @@
       SetBaseStrength(me,210);
       SetStrengthMod(me, st - 210);
     endif
-    SetHp(me, st);
+    AP_SetVital(me, "Hits", st);
   endif
   if(dx)
     if(dx <= 210)

Modified: trunk/096/pkg/mobiles/oldAI/main/closeDistance.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/closeDistance.inc	2005-11-01 22:32:29 UTC (rev 813)
+++ trunk/096/pkg/mobiles/oldAI/main/closeDistance.inc	2005-11-01 22:50:10 UTC (rev 814)
@@ -1,6 +1,8 @@
 var lastface;
 var nexttry;
 
+use math;
+
 function CloseDistance(opponent)
   var dst := 1;
   var d := Distance(me, opponent);

Modified: trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc	2005-11-01 22:32:29 UTC (rev 813)
+++ trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc	2005-11-01 22:50:10 UTC (rev 814)
@@ -13,7 +13,7 @@
   endif
   EraseObjProperty(me,"#flees");
   DisableMainEvents();
-  if(GetEffectiveSkill(me, 21) > 0 )
+  if(AP_GetSkill(me, "Hiding") > 0 )
     me.hidden := 1;
   endif
   EnableEvents(SYSEVENT_ENTEREDAREA,18);

Modified: trunk/096/pkg/mobiles/oldAI/poisonElemental.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-01 22:32:29 UTC (rev 813)
+++ trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-01 22:50:10 UTC (rev 814)
@@ -100,7 +100,7 @@
 endfunction
 
 function post_combat()
-  if(AP_GetVital(me, "Hits") < (GetStrength(me)-10))
+  if(AP_GetVital(me, "Hits") < (AP_GetStat(me, "Strength")-10))
 	CastSpell(me,me,"gheal");
   endif
   DisableCombatEvents();

Modified: trunk/096/pkg/mobiles/oldAI/tamed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-01 22:32:29 UTC (rev 813)
+++ trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-01 22:50:10 UTC (rev 814)
@@ -189,7 +189,7 @@
 function Fight(opponent)
   var oldfollowing := following;
   var flees := 0;
-  SetDexterityMod(me, 0);
+  AP_SetStatMod(me, "Dexterity", 0);
   following := 0;
   if(opponent == me)
     return;
@@ -323,10 +323,10 @@
   endif
   //var npccfgfile := ReadConfigFile("::npcdesc"); // unneeded due to global 'npccfgfile'!!
   var tameskill  := CInt(npccfgfile[me.npctemplate].tameskill);
-  var mastaming  := GetEffectiveSkill(master, SKILLID_TAMING);
-  var maslore    := GetEffectiveSkill(master, SKILLID_ANIMALLORE)/5;
-  var tgttaming  := CInt(GetEffectiveSkill(whom, SKILLID_TAMING));
-  var tgtlore    := CInt(GetEffectiveSkill(whom, SKILLID_ANIMALLORE)/5);
+  var mastaming  := AP_GetSkill(master, "AnimalTaming");
+  var maslore    := AP_GetSkill(master, "AnimalLore")/5;
+  var tgttaming  := CInt(AP_GetSKill(whom, "AnimalTaming"));
+  var tgtlore    := CInt(AP_GetSkill(whom, "AnimalLore")/5);
   happiness := GetObjProperty(me, "happiness");
   if(tgttaming <(tameskill - 50))
     PlaySoundEffect(me, dmgsound);
@@ -424,7 +424,7 @@
     EraseObjProperty(me, "mounted");
     EraseObjProperty(me, "mounted_on");
     SetAnchor(me.x,me.y,10,1);
-    SetHpRegenRate(me ,(100)* 12);
+    AP_SetVitalRegenRateMod(me, "Hits", 100*12);
     RestartScript(me);
   endif
 endfunction
@@ -611,7 +611,7 @@
       return;
     endforeach
   endif
-  if((!GetStrength(guarding))||(guarding.dead)||(dist(me,guarding)> 15))
+  if((!AP_GetStat(guarding, "Strength"))||(guarding.dead)||(dist(me,guarding)> 15))
     guarding := 0;
   endif
 endfunction
@@ -628,9 +628,9 @@
       waittime := 2;
     else
       var ma := 200 - CInt(AP_GetStat(me, "Dexterity"));
-      SetDexterityMod(me, CInt(AP_GetStatMod(me, "Dexterity"))+ ma);
+      AP_SetStatMod(me, "Dexterity", CInt(AP_GetStatMod(me, "Dexterity"))+ ma);
       RunToward(following);
-      SetDexterityMod(me, CInt(AP_GetStatMod(me, "Dexterity"))- ma);
+      AP_SetStatMod(me, "Dexterity", CInt(AP_GetStatMod(me, "Dexterity"))- ma);
       waittime := 0;
     endif
   else
@@ -638,9 +638,9 @@
       waittime := 2;
     else
       var ma := 200 - CInt(AP_GetStat(me, "Dexterity"));
-      SetDexterityMod(me, CInt(AP_GetStatMod(me, "Dexterity"))+ ma);
+      AP_SetStatMod(me, "Dexterity", CInt(AP_GetStatMod(me, "Dexterity"))+ ma);
       walktoward(following);
-      SetDexterityMod(me, CInt(AP_GetStatMod(me, "Dexterity"))- ma);
+      AP_SetStatMod(me, "Dexterity", CInt(AP_GetStatMod(me, "Dexterity"))- ma);
       waittime := 0;
     endif
   endif
@@ -738,7 +738,7 @@
   elseif(evtext["all guard"])
     say("Who should I guard?");
 	var what := Target(master, TGTOPT_HELPFUL + TGTOPT_CHECK_LOS);
-	if(GetHp(what))
+	if(AP_GetVital(what, "Hits"))
       AllCommand(SYSEVENT_ALL_GUARD_CMD, what);
 	endif
   elseif(evtext[mename + " fetch"])
@@ -816,8 +816,8 @@
   if(me.objtype in arry)
     return 1;
   endif
-  var maslore    := GetEffectiveSkill(master, SKILLID_ANIMALLORE)/5;
-  var mastaming  := CInt(GetEffectiveSkill(master, SKILLID_TAMING)+ maslore);
+  var maslore    := AP_GetSkill(master, "AnimalLore")/5;
+  var mastaming  := CInt(AP_GetSkill(master, "AnimalTaming")+ maslore);
   var checkvalue := CInt(mastaming - 20);
   happiness := GetObjProperty(me, "happiness");
   var happybonus := happiness/10;

Modified: trunk/096/pkg/mobiles/oldAI/townGuard.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townGuard.src	2005-11-01 22:32:29 UTC (rev 813)
+++ trunk/096/pkg/mobiles/oldAI/townGuard.src	2005-11-01 22:50:10 UTC (rev 814)
@@ -195,7 +195,7 @@
   if(AP_GetVital(me, "Hits") < AP_GetVitalMaximumValue(me, "Hits"))
     sleep(1);
     PerformAction(me, 0x22);
-    SetHp(me, AP_GetVitalMaximumValue(me, "Hits"));
+    AP_SetVital(me, "Hits", AP_GetVitalMaximumValue(me, "Hits"));
     PlaySoundEffect(me, 0x32);
     sleep(1);
   endif
@@ -268,10 +268,10 @@
     PlaySoundEffect(me, 0x31);
     sleep(1);
   endif
-  if(AP_GetVital(me, "Hits") < (GetStrength(me) / 2))
+  if(AP_GetVital(me, "Hits") < (AP_GetStat(me, "Strength") / 2))
     sleep(1);
     PerformAction(me, 0x22);
-    SetHp(me, me.strength);
+    AP_SetVital(me, "Hits", me.strength);
     PlaySoundEffect(me, 0x32);
     sleep(1);
   endif

Modified: trunk/096/pkg/mobiles/oldAI/townPerson.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-01 22:32:29 UTC (rev 813)
+++ trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-01 22:50:10 UTC (rev 814)
@@ -112,7 +112,7 @@
     var pclevel;
     foreach thing in getskilllist(me)
       if(lower(thing) == skill)
-        pclevel := GetEffectiveSkill(who, thing);
+        pclevel := AP_GetSkill(who, thing);
         if(pclevel > npclevel)
           say("I cannot teach you anymore.");
           return;
@@ -144,9 +144,9 @@
       DestroyItem(item);
       return;
     endif
-    if(GetEffectiveSkill(me, trainskillid))
+    if(AP_GetSkill(me, trainskillid))
       npc_level    := 33;
-      pc_level     := GetEffectiveSkill(who, trainskillid);
+      pc_level     := AP_GetSkill(who, trainskillid);
       goldreceived := item.amount;
       variance     := npc_level - pc_level;
       currentnpccost := GoldForSkillGain(npc_level, pc_level, trainskillid);
@@ -174,7 +174,7 @@
           SetObjProperty( who, "TrainMaxCost", trainmaxcost-goldreceived );
         endif
         say("Let me show you how it's done.");
-        SetBaseSkillBaseValue(who, trainskillid, new_level);
+        AP_SetTrueSkill(who, trainskillid, new_level);
         DestroyItem(item);
         SendSysMessage(who, "Your skill increases.");
       else

Modified: trunk/096/pkg/mobiles/oldAI/worker.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-01 22:32:29 UTC (rev 813)
+++ trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-01 22:50:10 UTC (rev 814)
@@ -152,7 +152,7 @@
         myskill := 25 + RandomInt(10);
         SetObjProperty(me, thing, myskill);
       endif
-      pskill := GetEffectiveSkill(who, FindSkillId(thing));
+      pskill := AP_GetSkill(who, FindSkillId(thing));
       if(pskill < myskill)
         if(holder == "")
           holder := thing;
@@ -178,7 +178,7 @@
       if(lower(thing) == skill)
         npclevel := CInt(GetObjProperty(me, thing));
         holder := FindSkillId(thing);
-        pclevel := GetEffectiveSkill(who, holder);
+        pclevel := AP_GetSkill(who, holder);
         if(pclevel >= npclevel)
           say("I cannot teach thee anymore.");
           return;
@@ -216,7 +216,7 @@
       return;
     endif
     npc_level    := CInt(GetObjProperty(me, trainskillname));
-    pc_level     := GetEffectiveSkill(who, trainskillid);
+    pc_level     := AP_GetSkill(who, trainskillid);
     goldreceived := item.amount;
     variance     := npc_level - pc_level;
     currentnpccost := GoldForSkillGain(npc_level, pc_level, trainskillid);
@@ -244,22 +244,24 @@
         SetObjProperty( who, "TrainMaxCost", trainmaxcost-goldreceived );
       endif
       say("Let me show you how it's done.");
-      SetBaseSkillBaseValue(who, trainskillid, new_level);
+      AP_SetTrueSkill(who, trainskillid, new_level);
       var skillarray := GetObjProperty(who,"SkillArray");
       if(!skillarray)
         skillarray := {};
         skillarray.append(trainskillid);
+        /* Commented so itll compile
         foreach thing in GetSkillIds()
-          if(GetBaseSkill(who, thing) > 0)
+          if(AP_GetTrueSkill(who, thing) > 0)
             skillarray.append(thing);
           endif
         endforeach
+        */
         SetObjProperty(who,"SkillArray", skillarray);
       else
         var holder := {};
         holder.append(trainskillid);
         foreach thing in skillarray
-          if((thing != trainskillid) and (GetBaseSkill(who, thing) > 0))
+          if((thing != trainskillid) and (AP_GetTrueSkill(who, thing) > 0))
             holder.append(thing);
           endif
         endforeach



From austin at berlios.de  Wed Nov  2 04:37:54 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 04:37:54 +0100
Subject: [Poldistro-svn] r815 - in trunk/096/pkg/systems/combat: . old
Message-ID: <200511020337.jA23bsAJ005934@sheep.berlios.de>

Author: austin
Date: 2005-11-02 04:37:45 +0100 (Wed, 02 Nov 2005)
New Revision: 815

Added:
   trunk/096/pkg/systems/combat/old/
   trunk/096/pkg/systems/combat/old/bewitchedHit.src
   trunk/096/pkg/systems/combat/old/bladeSpiritHit.src
   trunk/096/pkg/systems/combat/old/bladed.src
   trunk/096/pkg/systems/combat/old/chargeUpkeep.src
   trunk/096/pkg/systems/combat/old/deathrobe.src
   trunk/096/pkg/systems/combat/old/destroy.src
   trunk/096/pkg/systems/combat/old/earthElemental.src
   trunk/096/pkg/systems/combat/old/equip.inc
   trunk/096/pkg/systems/combat/old/equip.src
   trunk/096/pkg/systems/combat/old/hitScriptInc.inc
   trunk/096/pkg/systems/combat/old/itemControl.src
   trunk/096/pkg/systems/combat/old/itemdesc.cfg
   trunk/096/pkg/systems/combat/old/maceHit.src
   trunk/096/pkg/systems/combat/old/magicarmor.cfg
   trunk/096/pkg/systems/combat/old/magiccloth.cfg
   trunk/096/pkg/systems/combat/old/magicweaps.cfg
   trunk/096/pkg/systems/combat/old/mainHitScript.src
   trunk/096/pkg/systems/combat/old/mobPoisonHit.src
   trunk/096/pkg/systems/combat/old/pkg.cfg
   trunk/096/pkg/systems/combat/old/poisonHit.src
   trunk/096/pkg/systems/combat/old/reactiveArmorHit.src
   trunk/096/pkg/systems/combat/old/setWeaponHit.src
   trunk/096/pkg/systems/combat/old/silverHit.src
   trunk/096/pkg/systems/combat/old/unequip.src
   trunk/096/pkg/systems/combat/old/vortexHit.src
   trunk/096/pkg/systems/combat/old/wrestleControl.src
   trunk/096/pkg/systems/combat/old/wrestlingHitScript.src
Removed:
   trunk/096/pkg/systems/combat/bewitchedHit.src
   trunk/096/pkg/systems/combat/bladeSpiritHit.src
   trunk/096/pkg/systems/combat/bladed.src
   trunk/096/pkg/systems/combat/chargeUpkeep.src
   trunk/096/pkg/systems/combat/deathrobe.src
   trunk/096/pkg/systems/combat/destroy.src
   trunk/096/pkg/systems/combat/earthElemental.src
   trunk/096/pkg/systems/combat/equip.inc
   trunk/096/pkg/systems/combat/equip.src
   trunk/096/pkg/systems/combat/hitScriptInc.inc
   trunk/096/pkg/systems/combat/itemControl.src
   trunk/096/pkg/systems/combat/maceHit.src
   trunk/096/pkg/systems/combat/magicarmor.cfg
   trunk/096/pkg/systems/combat/magiccloth.cfg
   trunk/096/pkg/systems/combat/magicweaps.cfg
   trunk/096/pkg/systems/combat/mainHitScript.src
   trunk/096/pkg/systems/combat/mobPoisonHit.src
   trunk/096/pkg/systems/combat/poisonHit.src
   trunk/096/pkg/systems/combat/reactiveArmorHit.src
   trunk/096/pkg/systems/combat/setWeaponHit.src
   trunk/096/pkg/systems/combat/silverHit.src
   trunk/096/pkg/systems/combat/unequip.src
   trunk/096/pkg/systems/combat/vortexHit.src
   trunk/096/pkg/systems/combat/wrestleControl.src
   trunk/096/pkg/systems/combat/wrestlingHitScript.src
Log:


Deleted: trunk/096/pkg/systems/combat/bewitchedHit.src
===================================================================
--- trunk/096/pkg/systems/combat/bewitchedHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/bewitchedHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,21 +0,0 @@
-use uo;
-use util;
-use os;
-
-program macehit(param)
-	var attacker := param[1];
-	var defender := param[2];
-	var rawdamage := param[6];
-
-	if ((attacker.dead) || (defender.dead))
-		return;
-	endif
-	if (!defender.acctname)
-		rawdamage := (rawdamage / 2);
-	endif
-	SetObjProperty(defender, "TempDamage", rawdamage);
-
-	return;
-endprogram
-
-   

Deleted: trunk/096/pkg/systems/combat/bladeSpiritHit.src
===================================================================
--- trunk/096/pkg/systems/combat/bladeSpiritHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/bladeSpiritHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,35 +0,0 @@
-use uo;
-use util;
-use os;
-
-
-program macehit(param)
-  var attacker   := param[1];
-  var defender   := param[2];
-  var armor      := param[4];
-  var rawdamage  := param[6];
-  if((attacker.dead) || (defender.dead))
-    return;
-  endif
-  var rint := RandomInt(10);
-  if(rint >= 9)
-    var newplevel := RandomInt(2)+1;
-    PrintTextAbove(defender, defender.name + " has been poisoned!");
-    SendSysMessage(defender, "You have been poisoned by " + attacker.name +"!");
-    Detach();
-    var passparms := { defender, attacker, "bladespirit", newplevel };
-    start_script(":spells:poisonDamage", passparms);
-    SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, "poisoned weapon"});
-  endif
-  if(armor.hp > 1)
-    armor.hp := armor.hp - 1;
-  else
-    DestroyItem(armor);
-  endif
-  if(armor.hp > armor.maxhp)
-    armor.hp := armor.maxhp;
-  endif
-  SetObjProperty(defender, "TempDamage", rawdamage);
-endprogram
-
-   

Deleted: trunk/096/pkg/systems/combat/bladed.src
===================================================================
--- trunk/096/pkg/systems/combat/bladed.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/bladed.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,93 +0,0 @@
-// //$Id$
-
-
-use cfgfile;
-use uo;
-use os;
-use util;
-
-include "include/client";
-include "include/sound";
-include ":attributes:attributes";
-include "include/string";
-include "include/objtype";
-include "include/canAccess";
-include "include/dist";
-include "include/toolWear";
-include "include/noto";
-include ":tailoring:tailoringFunctions";
-include ":fishing:fishingFunctions";
-include ":containers:corpse/corpseFunctions";
-
-var bowcraftconfigfile := ReadConfigFile(":bowcraft:bowcraft");
-
-
-program use_blade(who, blade)
-
-	EraseObjProperty(who, "IsMeditating");
-	EraseObjProperty(who, "HealTimer");
-
-	if(!can_access(who, blade))
-		return;
-	endif
-	if(!ReserveItem(blade))
-		return;
-	endif
-
-	SendSysMessage(who, "What would you like to use that on?");
-	var use_on := TargetCoordinates(who);
-	if(!use_on)
-		return;
-	endif
-	if(use_on.item)
-		if(!can_access(who, use_on.item, "unmovable"))
-			return;
-		endif
-	endif
-	var checkme := use_on.item.objtype;
-	if(use_on.mobile.npctemplate == "sheep")
-		process_wool(who, blade, use_on.mobile);
-	elseif(use_on.item.objtype == UOBJ_CORPSE)
-		ReleaseItem(blade);
-		Carve_Corpse(who, use_on.item);
-	elseif(is_fish(checkme))
-		CarveFish(who, blade, use_on.item);
-	elseif (is_tree(use_on.objtype ))
-		CarveTree(who, blade, use_on.item);
-	else
-		SendSysMessage(who, "I don't know how to use those items together.");
-	endif
-
-endprogram
-
-
-function is_tree(theobj)
-
-	if((theobj == 0x0c9e) || (theobj == 0x0ca8) || (theobj == 0x0caa))
-		return 1;
-	elseif (theobj == 0x0cab)
-		return 1;
-	elseif ((theobj >= 0x0c99) && (theobj <= 0x0cea))
-		return 1;
-	elseif ((theobj >= 0x0cf3) && (theobj <= 0x0d03))
-		return 1;
-	elseif ((theobj >= 0x0d41) && (theobj <= 0x0dab))
-		return 1;
-	else
-		return 0;
-	endif
-
-endfunction
-
-
-function CarveTree(who, blade, use_on)
-
-	if(dist(who, use_on) > 2)
-		SendSysMessage(who, "You cannot use that");
-		return;
-	endif
-	CreateItemInBackpack(who, UOBJ_KINDLING, 1);
-	DestroyItem(use_on);
-	SendSysMessage(who, "You chip off some kindling and put it in your backpack.");
-
-endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/systems/combat/chargeUpkeep.src
===================================================================
--- trunk/096/pkg/systems/combat/chargeUpkeep.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/chargeUpkeep.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,134 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/client";
-include ":attributes:attributes";
-
-const EVID_UNEQUIP   := 0x123456;
-const EVID_DISCHARGE := 0x123457;
-
-program chargeUpkeep(parms)
-  var who := parms[1];
-  var item := parms[2];
-  var pid := GetPid();
-  SetObjProperty(item, "Pid", pid);
-  var charges := GetObjProperty(item, "charges");
-  if(!charges)
-    SendSysMessage(who, "That item is out of charges.");
-    return;
-  endif
-  var mods := ProcessMods(who, item);
-  var ret  := upkeepServer(who, item, mods[1]);
-  if(ret == 1)
-    SendSysMessage(who, item.name + " is out of charges.");
-  endif
-  ProcessUnmods(who, item, mods);
-endprogram
-
-function ProcessMods(who, item);
-  if(Cint(GetObjProperty(item, "HoldMods")))
-    repeat
-      sleep(1);
-    until(!Cint(GetObjProperty(item, "HoldMods")));
-  endif
-  Set_Critical(1);
-  SetObjProperty(item, "HoldMods", 1);
-  var holder;
-  var type   := GetObjProperty(item, "type");
-  var gain   := GetObjProperty(item, "gain");
-  if(!gain)
-    return;
-  endif
-  case(type)
-    "strength":     ModifyAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH, gain);
-    "invisibility": who.hidden := 1;
-    "sight":        who.setlightlevel(0, 70);
-    "protection":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_PARRY, gain);
-    "reflect":      SetObjProperty(who, "mr", 2);
-    "bless":        ModifyAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH,     gain);
-                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_INTELLIGENCE, gain);
-                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_DEXTERITY,    gain);
-                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_PARRY,        (gain *3 ));
-  endcase
-  RecalcVitals(who);
-  EraseObjProperty(item, "HoldMods");
-  holder := {};
-  holder.append(type);
-  holder.append(gain);
-  holder.append(item.serial);
-  Set_Critical(0);
-  return holder;
-endfunction
-
-function upkeepServer(who, item, type)
-  var charges;
-  var charge := ReadGameClock() + 60;
-  var depleted := 0;
-  var ev;
-  var brk;
-  while(1)
-	ev := wait_for_event(1);
-	case(ev.type)
-	  EVID_UNEQUIP:   depleted := 0;
-	                  brk := 1;
-	endcase
-    if(brk == 1)
-      break;
-    endif
-    if(!who.ip)
-      break;
-    endif
-    if(type == "vis")
-      who.setlightlevel(0, 70);
-    endif
-	if(charge <= ReadGameClock())
-      charge := ReadGameClock() + 60;
-      charges := GetObjProperty(item, "charges");
-      if(!charges)
-        depleted := 1;
-        break;
-      endif
-	  SetObjProperty(item, "charges", Cint(charges - 1));
-	else
-      charge := ReadGameClock() + 5;
-      charges := GetObjProperty(item, "charges");
-      if(!charges)
-        depleted := 1;
-        break;
-      endif
-	  SetObjProperty(item, "charges", Cint(charges - 1));
-	endif
-  endwhile
-  return depleted;
-endfunction
-
-function ProcessUnmods(who, item, mods)
-  if(Cint(GetObjProperty(item, "HoldMods")))
-    repeat
-      sleep(1);
-    until(!Cint(GetObjProperty(item, "HoldMods")));
-  endif
-  Set_Critical(1);
-  SetObjProperty(item, "HoldMods", 1);
-  var type := mods[1];
-  var gain := Cint(mods[2]);
-  if(!who.ip)
-    who := SystemFindObjectBySerial(who.serial, SYSFIND_SEARCH_OFFLINE_MOBILES);
-  endif
-  case(type)
-    "strength":     ModifyAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH, (0 - gain));
-    "invisibility": who.hidden := 0;
-    "sight":        who.setlightlevel(0, 1);
-    "protection":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_PARRY, (0 - gain));
-    "reflect":      EraseObjProperty(who, "mr");
-    "bless":        ModifyAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH,     (0 - gain));
-                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_INTELLIGENCE, (0 - gain));
-                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_DEXTERITY,    (0 - gain));
-                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_PARRY,        (0 - (gain *3)));
-  endcase
-  RecalcVitals(who);
-  EraseObjProperty(item, "HoldMods");
-  Set_Critical(0);
-  return;
-endfunction

Deleted: trunk/096/pkg/systems/combat/deathrobe.src
===================================================================
--- trunk/096/pkg/systems/combat/deathrobe.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/deathrobe.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,16 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-program deathrobe_decay(item)
-  while(item)
-    if((item.movable == 1) && (!item.container) && !((item.x == 0) && (item.y == 0) && (item.z == 0)))
-      sleep(10);
-      if((item.movable == 1) && (!item.container) && !((item.x == 0) && (item.y == 0) && (item.z == 0)))
-        DestroyItem(item);
-        break;
-      endif
-    endif
-    sleep(30);
-  endwhile
-endprogram

Deleted: trunk/096/pkg/systems/combat/destroy.src
===================================================================
--- trunk/096/pkg/systems/combat/destroy.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/destroy.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,106 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-include "include/client";
-include ":attributes:attributes";
-
-const EVID_UNEQUIP   := 0x123456;
-const EVID_DISCHARGE := 0x123457;
-
-program destroy(item)
-  set_critical(1);
-  var ser := GetObjProperty(item, "#equipped");
-  var who := SystemFindObjectBySerial(cint(ser), SYSFIND_SEARCH_OFFLINE_MOBILES);
-  var itemdesc := ReadConfigFile("itemdesc");
-  var penalty := CInt(itemdesc[item.objtype].DexPenalty);
-  if(penalty)
-    EraseObjProperty(item, "#equipped");
-    SetDexterityMod(who, GetDexterityMod(who) + penalty);
-  endif
-  var type := GetObjProperty(item,"type");
-  var val := 0;
-  case(type)
-    "accuracy":     val := accuracy(who,item);
-    "cursed":       val := cursed(who,item);
-    "sight":        val := sight(who,item);
-    "reflect":      val := reflect(who,item);
-    "protection":   val := protection(who,item);
-    "wizzohat":     val := wizzohat(who,item);
-    "strength":     val := strength(who,item);
-    "invisibility": val := invisibility(who, item);
-    default:        val := 1;
-  endcase
-  return val;
-  set_critical(0);
-endprogram
-
-function strength(who,item)
-  who := who;
-  item := item;
-  return 1;
-endfunction
-
-function wizzohat(who,item)
-  SetIntelligenceMod(who, GetIntelligenceMod(who) - 10);
-  SetStrengthMod(who, GetStrengthMod(who) + 5);
-  SetDexterityMod(who, GetDexterityMod(who) + 5);
-  EraseObjProperty(item, "#equipped");
-  return 1;
-endfunction
-
-function cursed(who,item)
-  who := who;
-  item := item;
-  return 0;
-endfunction
-
-function invisibility(who,item)
-  RemoveMods(who, item);
-  return 1;
-endfunction
-
-function sight(who,item)
-  RemoveMods(who, item);
-  return 1;
-endfunction
-
-function reflect(who,item)
-  RemoveMods(who, item);
-  return 1;
-endfunction
-
-function accuracy(who,item)
-  var amt := CInt(GetObjProperty(item,"gain"));
-  amt := (0 - amt);
-  if((!amt) || (amt == 0))
-    amt := (0 - 5);
-  endif
-  var cfg := ReadConfigFile(":combat:itemdesc");
-  var attrib := cfg[item.objtype].Attribute;
-  case(attrib)
-    "Wrestling": ModifyAttributeTemporaryMod(who, ATTRIBUTEID_WRESTLING,     amt);
-    "Fencing":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_FENCING,       amt);
-    "Archery":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_ARCHERY,       amt);
-    "Swords":    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_SWORDSMANSHIP, amt);
-    "Mace":      ModifyAttributeTemporaryMod(who, ATTRIBUTEID_MACEFIGHTING,  amt);
-  endcase
-  EraseObjProperty(item, "#equipped");
-  return 1;
-endfunction
-
-function protection(who,item)
-  RemoveMods(who, item);
-  return 1;
-endfunction
-
-function RemoveMods(who, item)
-  who := who;
-  var proc := GetProcess(Cint(GetObjProperty(item, "Pid")));
-  if(proc)
-    var ev := {};
-    ev.+type := EVID_UNEQUIP;
-    proc.sendevent(ev);
-  endif
-  EraseObjProperty(item, "#equipped");
-endfunction

Deleted: trunk/096/pkg/systems/combat/earthElemental.src
===================================================================
--- trunk/096/pkg/systems/combat/earthElemental.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/earthElemental.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,33 +0,0 @@
-use uo;
-use util;
-use os;
-include ":attributes:attributes";
-
-program macehit(param)
-  var attacker := param[1];
-  var defender := param[2];
-  var armor := param[4];
-  var rawdamage := param[6];
-  SetObjProperty(defender, "TempDamage", rawdamage);
-  if((attacker.dead) || (defender.dead))
-    return;
-  endif
-  if(armor)
-    if(RandomInt(50) > 35)
-      var admg := RandomInt(2) + 1;
-      if(armor.hp >admg)
-        armor.hp := armor.hp - admg;
-      else
-        DestroyItem(armor);
-      endif
-    endif
-  endif
-  var sdr := RandomInt(3) + 3;
-  if(GetStamina(defender) >= sdr)
-    SetStamina(defender, GetStamina(defender) - sdr);
-  else
-    SetStamina(defender, 0);
-  endif
-endprogram
-
-   

Deleted: trunk/096/pkg/systems/combat/equip.inc
===================================================================
--- trunk/096/pkg/systems/combat/equip.inc	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/equip.inc	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,130 +0,0 @@
-
-
-
-function HandleMods(who, item)
-  set_critical(1);
-  var itemdesc := ReadConfigFile("itemdesc");
-  var penalty  := CInt(itemdesc[item.objtype].DexPenalty);
-  var restrict := Cint(itemdesc[item.objtype].GenderSpecific);
-  if((restrict == 1) and (who.graphic == 400))
-    SendSysMessage(who, "Only females may wear that.");
-    return 0;
-  endif
-  if(penalty)
-    SetObjProperty(item, "#equipped", who.serial);
-    SetDexterityMod(who, GetDexterityMod(who) - penalty);
-  endif
-  var type := GetObjProperty(item, "type");
-  if(!type)
-    return 1;
-  endif
-  var val := 0;
-  if(!who.ip)
-    return 1;
-  endif
-  case(type)
-    "accuracy":     val := accuracy(who,item);
-    "cursed":       val := cursed(who,item);
-    "sight":        val := sight(who,item);
-    "reflect":      val := reflect(who,item);
-    "protection":   val := protection(who,item);
-    "wizzohat":     val := wizzohat(who,item);
-    "strength":     val := strength(who,item);
-    "invisibility": val := invisibility(who,item);
-    default:        val := 1;
-  endcase
-  return val;
-  set_critical(0);
-endfunction
-
-function strength(who,item)
-  var gain := GetObjProperty(item, "gain");
-  if(!gain)
-    gain := 5;
-  endif
-  SetObjProperty(item, "#equipped", who.serial);
-  var parms := {who, item};
-  start_script("chargeUpkeep", parms);
-  return 1;
-endfunction
-
-function wizzohat(who,item)
-  SetIntelligenceMod(who, GetIntelligenceMod(who) + 10);
-  SetStrengthMod(who, GetStrengthMod(who) - 5);
-  SetDexterityMod(who, GetDexterityMod(who) - 5);
-  SetObjProperty(item, "#equipped", who.serial);
-  return 1;
-endfunction
-
-function accuracy(who,item)
-  var amt := CInt(GetObjProperty(item,"gain"));
-  if((!amt) || (amt == 0))
-    amt := 5;
-  endif
-  var cfg := ReadConfigFile(":combat:itemdesc");
-  var attrib := cfg[item.objtype].Attribute;
-  case(attrib)
-    "Wrestling": ModifyAttributeTemporaryMod(who, ATTRIBUTEID_WRESTLING,     amt);
-    "Fencing":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_FENCING,       amt);
-    "Archery":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_ARCHERY,       amt);
-    "Swords":    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_SWORDSMANSHIP, amt);
-    "Mace":      ModifyAttributeTemporaryMod(who, ATTRIBUTEID_MACEFIGHTING,  amt);
-  endcase
-  SetObjProperty(item, "#equipped", who.serial);
-  return 1;
-endfunction
-
-function cursed(who,item)
-  PlaySoundEffect(who, 0x246);
-  if(!GetObjProperty(item,"named"))
-    item.name := item.name + " [Cursed]";
-    SetObjProperty(item,"named", 1);
-  endif
-  PrintTextAbovePrivate(who,"You have been cursed!", who);
-  SetObjProperty(item, "#equipped", who.serial);
-  return 1;
-endfunction
-
-function invisibility(who,item)
-  var gain := GetObjProperty(item, "gain");
-  if(!gain)
-    gain := 5;
-  endif
-  SetObjProperty(item, "#equipped", who.serial);
-  var parms := {who, item};
-  start_script("chargeUpkeep", parms);
-  return 1;
-endfunction
-
-function sight(who,item)
-  var gain := GetObjProperty(item, "gain");
-  if(!gain)
-    gain := 5;
-  endif
-  SetObjProperty(item, "#equipped", who.serial);
-  var parms := {who, item};
-  start_script("chargeUpkeep", parms);
-  return 1;
-endfunction
-
-function protection(who,item)
-  var gain := GetObjProperty(item, "gain");
-  if(!gain)
-    gain := 5;
-  endif
-  SetObjProperty(item, "#equipped", who.serial);
-  var parms := {who, item};
-  start_script("chargeUpkeep", parms);
-  return 1;
-endfunction
-
-function reflect(who,item)
-  var gain := GetObjProperty(item, "gain");
-  if(!gain)
-    gain := 5;
-  endif
-  SetObjProperty(item, "#equipped", who.serial);
-  var parms := {who, item};
-  start_script("chargeUpkeep", parms);
-  return 1;
-endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/systems/combat/equip.src
===================================================================
--- trunk/096/pkg/systems/combat/equip.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/equip.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,12 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-include "include/client";
-include ":attributes:attributes";
-include "equip";
-
-program equipweapon(who, item)
-  var val := HandleMods(who, item);
-  return val;
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/systems/combat/hitScriptInc.inc
===================================================================
--- trunk/096/pkg/systems/combat/hitScriptInc.inc	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/hitScriptInc.inc	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,9 +0,0 @@
-use uo;
-use util;
-use math;
-include ":attributes:attributes";
-
-function DealDamage(defender, attacker, rawdamage)
-  rawdamage := rawdamage + RandomInt( (GetEffectiveSkill(attacker, 1) ) / 20);
-  ApplyRawDamage(defender, rawdamage);
-endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/systems/combat/itemControl.src
===================================================================
--- trunk/096/pkg/systems/combat/itemControl.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/itemControl.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,11 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-program itemcontrol(item)
-  var cfgfile  := ReadConfigFile(":combat:itemdesc");
-  var dmg      := cfgfile[item.objtype].damage;
-  if(dmg)
-    item.hitscript := "mainHitScript";
-  endif
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/systems/combat/maceHit.src
===================================================================
--- trunk/096/pkg/systems/combat/maceHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/maceHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,31 +0,0 @@
-use uo;
-use util;
-use os;
-include ":attributes:attributes";
-
-program macehit(param)
-  var attacker := param[1];
-  var defender := param[2];
-  var armor := param[4];
-  var rawdamage := param[6];
-  SetObjProperty(defender, "TempDamage", rawdamage);
-  if((attacker.dead) || (defender.dead))
-    return;
-  endif
-  if(armor)
-    var admg := RandomInt(4) + 1;
-    if(armor.hp >admg)
-      armor.hp := armor.hp - admg;
-    else
-      DestroyItem(armor);
-    endif
-  endif
-  var sdr := RandomInt(3) + 3;
-  if(GetStamina(defender) >= sdr)
-    SetStamina(defender, GetStamina(defender) - sdr);
-  else
-    SetStamina(defender, 0);
-  endif
-endprogram
-
-   

Deleted: trunk/096/pkg/systems/combat/magicarmor.cfg
===================================================================
--- trunk/096/pkg/systems/combat/magicarmor.cfg	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/magicarmor.cfg	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,50 +0,0 @@
-# $Id$
-#
-#
-#item spawned for loot must be in this file to have the possibility to be magic
-
-Group 1
-{
-    LeatherGorget		    1
-    LeatherSleeves		    1
-    LeatherGloves		    1
-    LeatherCap			    1
-    LeatherLeggings		    1
-    LeatherTunic		    1
-    LeatherTunic2		    1
-    StuddedGorget		    1
-    StuddedGloves		    1
-    StuddedSleeves		    1
-    StuddedLeggings		    1
-    StuddedTunic		    1
-    FemaleStudded		    1
-    FemaleLeather		    1
-    LeatherSkirt		    1
-    LeatherBustier		    1
-    StuddedBustier		    1
-    LeatherShorts		    1
-    ChainmailCoif		    1
-    ChainmailLeggings	    1
-    ChainmailTunic		    1
-    CloseHelm			    1
-    Helmet			        1
-    Bascinet			    1
-    NoseHelm			    1
-    PlateHelm			    1
-    BronzeShield		    1
-    Buckler			        1
-    KiteShield			    1
-    HeaterShield		    1
-    KiteShieldB1		    1
-    WoodenShield		    1
-    MetalShield			    1
-    RingmailTunic		    1
-    RingmailSleeves		    1
-    RingmailLeggings	    1
-    RingmailGloves		    1
-    PlatemailBreastplate    1
-    PlatemailArms		    1
-    PlatemailLegs		    1
-    PlatemailGorget		    1
-    PlatemailGloves         1
-}

Deleted: trunk/096/pkg/systems/combat/magiccloth.cfg
===================================================================
--- trunk/096/pkg/systems/combat/magiccloth.cfg	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/magiccloth.cfg	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,14 +0,0 @@
-items 1
-{
-    Robe			    1
-    LeatherBoots		1
-    ThighBoots			1
-    silvernecklace      1
-    bracelet            1
-    earings             1
-    roundnecklace       1
-    longnecklace        1
-    ring                1
-    Cloak               1
-}
-

Deleted: trunk/096/pkg/systems/combat/magicweaps.cfg
===================================================================
--- trunk/096/pkg/systems/combat/magicweaps.cfg	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/magicweaps.cfg	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,49 +0,0 @@
-# $Id$
-#
-#
-#item spawned for loot must be in this file to have the possibility to be magic
-
-items 1
-{
-    Longsword		1
-    WarAxe		    1
-    Bow			    1
-    Crossbow		1
-    HeavyCrossbow	1
-    Axe			    1
-    BattleAxe		1
-    DoubleAxe		1
-    ExecutionersAxe	1
-    LargeBattleAxe	1
-    TwoHandedAxe	1
-    HammerPick		1
-    Mace		    1
-    Maul		    1
-    WarHammer		1
-    WarMace		    1
-    Bardiche		1
-    Halberd		    1
-    ShortSpear		1
-    Spear		    1
-    WarFork		    1
-    BroadSword		1
-    Cutlass		    1
-    Dagger		    1
-    Katana		    1
-    Kryss		    1
-    Scimitar		1
-    VikingSword		1
-    Hatchet		    1
-    PickAxe		    1
-    ButcherKnife	1
-    Cleaver		    1
-    SkinningKnife	1
-    Club		    1
-    SmithyHammer	1
-    PitchFork		1
-    BlackStaff		1
-    GnarledStaff	1
-    QuarterStaff	1
-    ShepherdsCrook	1
-}
-

Deleted: trunk/096/pkg/systems/combat/mainHitScript.src
===================================================================
--- trunk/096/pkg/systems/combat/mainHitScript.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/mainHitScript.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,120 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-include "hitScriptInc";
-
-var npccfgfile := ReadConfigFile("::npcdesc");
-
-program MainHitScript(attacker, defender, weapon, armor, basedamage, rawdamage)
-  if(defender == attacker)
-    SendSysMessage(attacker, "No cheating!");
-    ApplyRawDamage(attacker, 1000);
-    return;
-  endif
-  if((defender.npctemplate == "townguard") or (defender.npctemplate == "playervendor"))
-    ApplyRawDamage(attacker, 1000);
-    return;
-  endif
-  if((attacker.npctemplate == "townguard") or (attacker.npctemplate == "playervendor"))
-    ApplyRawDamage(defender, 1000);
-    return;
-  endif
-  if(defender.isA(POLCLASS_NPC))
-    var damagedsound := CInt(npccfgfile[defender.npctemplate].damagedsound);
-    if(damagedsound)
-      PlaySoundEffect(defender, damagedsound);
-    endif
-    PerformAction(defender, 0xa);
-    basedamage := basedamage * 2;
-    rawdamage := rawdamage * 2;
-  else
-    if(attacker.acctname && defender.acctname)
-      basedamage := basedamage / 2;
-      rawdamage := rawdamage / 2;
-    endif
-  endif
-  if(attacker.npctemplate == "employee")
-    basedamage := basedamage / 2;
-    rawdamage := rawdamage / 2;
-  endif
-  SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon.name });
-  var shield := GetEquipmentByLayer(defender, 2);
-  if(shield)
-    var bd;
-    if(basedamage > 100)
-      bd := 100;
-    else
-      bd := basedamage;
-    endif
-    if(RandomInt(Cint(GetEffectiveSkill(defender, SKILLID_PARRY) / 2)) >= bd)
-      armor := shield;
-    endif
-  endif
-  var weaponhit := GetObjProperty(weapon, "OnHit");
-  if(weapon.hp > weapon.maxhp)
-    DestroyItem(weapon);
-    rawdamage := 0;
-  endif
-  var armorhit;
-  if(armor == 0)
-    armorhit := GetObjProperty(defender, "ArmorHit");
-  else
-    armorhit := GetObjProperty(armor, "ArmorHit");
-  endif
-  if(!weaponhit)
-    if(!armorhit)
-      run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-      rawdamage := GetObjProperty(defender, "TempDamage");
-      if(GetObjProperty(weapon, "SilverHit"))
-        run_script_to_completion("silverHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-        rawdamage := GetObjProperty(defender, "TempDamage");
-      endif
-      rawdamage := Cint(rawdamage + Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20));
-      if(rawdamage < 1)
-        rawdamage := 1;
-      endif
-      DealDamage(defender, attacker, rawdamage);
-      return;
-    else
-      SetObjProperty(defender, "TempDamage", rawdamage);
-      foreach x in armorhit
-        Detach();
-        run_script_to_completion(x, { attacker, defender, weapon, armor, basedamage, rawdamage } );
-        rawdamage := CInt(GetObjProperty(defender, "TempDamage") );
-      endforeach
-      run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-      rawdamage := GetObjProperty(defender, "TempDamage");
-      EraseObjProperty(defender, "TempDamage");
-      if(GetObjProperty(weapon, "SilverHit"))
-        run_script_to_completion("silverHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-        rawdamage := GetObjProperty(defender, "TempDamage");
-      endif
-      rawdamage := Cint(rawdamage + Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20));
-      if(rawdamage < 1)
-        rawdamage := 1;
-      endif
-      DealDamage(defender, attacker, rawdamage);
-      return;
-    endif
-  else
-    SetObjProperty(defender, "TempDamage", rawdamage);
-    foreach x in weaponhit
-      Detach();
-      run_script_to_completion(CStr(x), { attacker, defender, weapon, armor, basedamage, rawdamage } );
-      rawdamage := GetObjProperty(defender, "TempDamage");
-    endforeach
-    EraseObjProperty(defender, "TempDamage");
-    run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-    rawdamage := GetObjProperty(defender, "TempDamage");
-    if(GetObjProperty(weapon, "SilverHit"))
-      run_script_to_completion("silverHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-      rawdamage := GetObjProperty(defender, "TempDamage");
-    endif
-    rawdamage := Cint(rawdamage + Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20));
-    if(rawdamage < 1)
-      rawdamage := 1;
-    endif
-    DealDamage(defender, attacker, rawdamage);
-    return;
-  endif
-endprogram

Deleted: trunk/096/pkg/systems/combat/mobPoisonHit.src
===================================================================
--- trunk/096/pkg/systems/combat/mobPoisonHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/mobPoisonHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,31 +0,0 @@
-use uo;
-use util;
-use os;
-use cfgfile;
-
-include "include/client";
-
-
-program poisonhit(param)
-  var attacker := param[1];
-  var defender := param[2];
-  var rawdamage := param[6];
-  SetObjProperty(defender, "TempDamage", rawdamage);
-  if((RandomInt(4)+1) == 1)
-    return;
-  endif
-  var level := GetObjProperty(attacker, "poison_strength");
-  if (!level)
-    level := 1;
-  endif
-  Detach();
-  foreach mobile in ListMobilesInLineOfSight(defender, 8)
-    if(mobile != defender)
-      PrintTextAbovePrivate(defender, defender.name + " has been poisoned!", mobile);
-    endif
-  endforeach
-  PrintTextAbovePrivate(defender, "You have been poisoned by " + attacker.name +"!", defender);
-  var passparms := { defender, attacker, "poisoned weapon", level};
-  SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, "poisoned weapon" });
-  start_script(":spells:poisonDamage", passparms);
-endprogram

Added: trunk/096/pkg/systems/combat/old/bewitchedHit.src
===================================================================
--- trunk/096/pkg/systems/combat/old/bewitchedHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/bewitchedHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,21 @@
+use uo;
+use util;
+use os;
+
+program macehit(param)
+	var attacker := param[1];
+	var defender := param[2];
+	var rawdamage := param[6];
+
+	if ((attacker.dead) || (defender.dead))
+		return;
+	endif
+	if (!defender.acctname)
+		rawdamage := (rawdamage / 2);
+	endif
+	SetObjProperty(defender, "TempDamage", rawdamage);
+
+	return;
+endprogram
+
+   

Added: trunk/096/pkg/systems/combat/old/bladeSpiritHit.src
===================================================================
--- trunk/096/pkg/systems/combat/old/bladeSpiritHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/bladeSpiritHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,35 @@
+use uo;
+use util;
+use os;
+
+
+program macehit(param)
+  var attacker   := param[1];
+  var defender   := param[2];
+  var armor      := param[4];
+  var rawdamage  := param[6];
+  if((attacker.dead) || (defender.dead))
+    return;
+  endif
+  var rint := RandomInt(10);
+  if(rint >= 9)
+    var newplevel := RandomInt(2)+1;
+    PrintTextAbove(defender, defender.name + " has been poisoned!");
+    SendSysMessage(defender, "You have been poisoned by " + attacker.name +"!");
+    Detach();
+    var passparms := { defender, attacker, "bladespirit", newplevel };
+    start_script(":spells:poisonDamage", passparms);
+    SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, "poisoned weapon"});
+  endif
+  if(armor.hp > 1)
+    armor.hp := armor.hp - 1;
+  else
+    DestroyItem(armor);
+  endif
+  if(armor.hp > armor.maxhp)
+    armor.hp := armor.maxhp;
+  endif
+  SetObjProperty(defender, "TempDamage", rawdamage);
+endprogram
+
+   

Added: trunk/096/pkg/systems/combat/old/bladed.src
===================================================================
--- trunk/096/pkg/systems/combat/old/bladed.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/bladed.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,93 @@
+// //$Id: bladed.src 806 2005-11-01 21:56:02Z austin $
+
+
+use cfgfile;
+use uo;
+use os;
+use util;
+
+include "include/client";
+include "include/sound";
+include ":attributes:attributes";
+include "include/string";
+include "include/objtype";
+include "include/canAccess";
+include "include/dist";
+include "include/toolWear";
+include "include/noto";
+include ":tailoring:tailoringFunctions";
+include ":fishing:fishingFunctions";
+include ":containers:corpse/corpseFunctions";
+
+var bowcraftconfigfile := ReadConfigFile(":bowcraft:bowcraft");
+
+
+program use_blade(who, blade)
+
+	EraseObjProperty(who, "IsMeditating");
+	EraseObjProperty(who, "HealTimer");
+
+	if(!can_access(who, blade))
+		return;
+	endif
+	if(!ReserveItem(blade))
+		return;
+	endif
+
+	SendSysMessage(who, "What would you like to use that on?");
+	var use_on := TargetCoordinates(who);
+	if(!use_on)
+		return;
+	endif
+	if(use_on.item)
+		if(!can_access(who, use_on.item, "unmovable"))
+			return;
+		endif
+	endif
+	var checkme := use_on.item.objtype;
+	if(use_on.mobile.npctemplate == "sheep")
+		process_wool(who, blade, use_on.mobile);
+	elseif(use_on.item.objtype == UOBJ_CORPSE)
+		ReleaseItem(blade);
+		Carve_Corpse(who, use_on.item);
+	elseif(is_fish(checkme))
+		CarveFish(who, blade, use_on.item);
+	elseif (is_tree(use_on.objtype ))
+		CarveTree(who, blade, use_on.item);
+	else
+		SendSysMessage(who, "I don't know how to use those items together.");
+	endif
+
+endprogram
+
+
+function is_tree(theobj)
+
+	if((theobj == 0x0c9e) || (theobj == 0x0ca8) || (theobj == 0x0caa))
+		return 1;
+	elseif (theobj == 0x0cab)
+		return 1;
+	elseif ((theobj >= 0x0c99) && (theobj <= 0x0cea))
+		return 1;
+	elseif ((theobj >= 0x0cf3) && (theobj <= 0x0d03))
+		return 1;
+	elseif ((theobj >= 0x0d41) && (theobj <= 0x0dab))
+		return 1;
+	else
+		return 0;
+	endif
+
+endfunction
+
+
+function CarveTree(who, blade, use_on)
+
+	if(dist(who, use_on) > 2)
+		SendSysMessage(who, "You cannot use that");
+		return;
+	endif
+	CreateItemInBackpack(who, UOBJ_KINDLING, 1);
+	DestroyItem(use_on);
+	SendSysMessage(who, "You chip off some kindling and put it in your backpack.");
+
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/systems/combat/old/chargeUpkeep.src
===================================================================
--- trunk/096/pkg/systems/combat/old/chargeUpkeep.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/chargeUpkeep.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,134 @@
+use uo;
+use os;
+use util;
+
+include "include/client";
+include ":attributes:attributes";
+
+const EVID_UNEQUIP   := 0x123456;
+const EVID_DISCHARGE := 0x123457;
+
+program chargeUpkeep(parms)
+  var who := parms[1];
+  var item := parms[2];
+  var pid := GetPid();
+  SetObjProperty(item, "Pid", pid);
+  var charges := GetObjProperty(item, "charges");
+  if(!charges)
+    SendSysMessage(who, "That item is out of charges.");
+    return;
+  endif
+  var mods := ProcessMods(who, item);
+  var ret  := upkeepServer(who, item, mods[1]);
+  if(ret == 1)
+    SendSysMessage(who, item.name + " is out of charges.");
+  endif
+  ProcessUnmods(who, item, mods);
+endprogram
+
+function ProcessMods(who, item);
+  if(Cint(GetObjProperty(item, "HoldMods")))
+    repeat
+      sleep(1);
+    until(!Cint(GetObjProperty(item, "HoldMods")));
+  endif
+  Set_Critical(1);
+  SetObjProperty(item, "HoldMods", 1);
+  var holder;
+  var type   := GetObjProperty(item, "type");
+  var gain   := GetObjProperty(item, "gain");
+  if(!gain)
+    return;
+  endif
+  case(type)
+    "strength":     ModifyAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH, gain);
+    "invisibility": who.hidden := 1;
+    "sight":        who.setlightlevel(0, 70);
+    "protection":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_PARRY, gain);
+    "reflect":      SetObjProperty(who, "mr", 2);
+    "bless":        ModifyAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH,     gain);
+                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_INTELLIGENCE, gain);
+                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_DEXTERITY,    gain);
+                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_PARRY,        (gain *3 ));
+  endcase
+  RecalcVitals(who);
+  EraseObjProperty(item, "HoldMods");
+  holder := {};
+  holder.append(type);
+  holder.append(gain);
+  holder.append(item.serial);
+  Set_Critical(0);
+  return holder;
+endfunction
+
+function upkeepServer(who, item, type)
+  var charges;
+  var charge := ReadGameClock() + 60;
+  var depleted := 0;
+  var ev;
+  var brk;
+  while(1)
+	ev := wait_for_event(1);
+	case(ev.type)
+	  EVID_UNEQUIP:   depleted := 0;
+	                  brk := 1;
+	endcase
+    if(brk == 1)
+      break;
+    endif
+    if(!who.ip)
+      break;
+    endif
+    if(type == "vis")
+      who.setlightlevel(0, 70);
+    endif
+	if(charge <= ReadGameClock())
+      charge := ReadGameClock() + 60;
+      charges := GetObjProperty(item, "charges");
+      if(!charges)
+        depleted := 1;
+        break;
+      endif
+	  SetObjProperty(item, "charges", Cint(charges - 1));
+	else
+      charge := ReadGameClock() + 5;
+      charges := GetObjProperty(item, "charges");
+      if(!charges)
+        depleted := 1;
+        break;
+      endif
+	  SetObjProperty(item, "charges", Cint(charges - 1));
+	endif
+  endwhile
+  return depleted;
+endfunction
+
+function ProcessUnmods(who, item, mods)
+  if(Cint(GetObjProperty(item, "HoldMods")))
+    repeat
+      sleep(1);
+    until(!Cint(GetObjProperty(item, "HoldMods")));
+  endif
+  Set_Critical(1);
+  SetObjProperty(item, "HoldMods", 1);
+  var type := mods[1];
+  var gain := Cint(mods[2]);
+  if(!who.ip)
+    who := SystemFindObjectBySerial(who.serial, SYSFIND_SEARCH_OFFLINE_MOBILES);
+  endif
+  case(type)
+    "strength":     ModifyAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH, (0 - gain));
+    "invisibility": who.hidden := 0;
+    "sight":        who.setlightlevel(0, 1);
+    "protection":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_PARRY, (0 - gain));
+    "reflect":      EraseObjProperty(who, "mr");
+    "bless":        ModifyAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH,     (0 - gain));
+                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_INTELLIGENCE, (0 - gain));
+                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_DEXTERITY,    (0 - gain));
+                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_PARRY,        (0 - (gain *3)));
+  endcase
+  RecalcVitals(who);
+  EraseObjProperty(item, "HoldMods");
+  Set_Critical(0);
+  return;
+endfunction

Added: trunk/096/pkg/systems/combat/old/deathrobe.src
===================================================================
--- trunk/096/pkg/systems/combat/old/deathrobe.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/deathrobe.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,16 @@
+use uo;
+use os;
+use cfgfile;
+
+program deathrobe_decay(item)
+  while(item)
+    if((item.movable == 1) && (!item.container) && !((item.x == 0) && (item.y == 0) && (item.z == 0)))
+      sleep(10);
+      if((item.movable == 1) && (!item.container) && !((item.x == 0) && (item.y == 0) && (item.z == 0)))
+        DestroyItem(item);
+        break;
+      endif
+    endif
+    sleep(30);
+  endwhile
+endprogram

Added: trunk/096/pkg/systems/combat/old/destroy.src
===================================================================
--- trunk/096/pkg/systems/combat/old/destroy.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/destroy.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,106 @@
+use uo;
+use os;
+use cfgfile;
+
+include "include/client";
+include ":attributes:attributes";
+
+const EVID_UNEQUIP   := 0x123456;
+const EVID_DISCHARGE := 0x123457;
+
+program destroy(item)
+  set_critical(1);
+  var ser := GetObjProperty(item, "#equipped");
+  var who := SystemFindObjectBySerial(cint(ser), SYSFIND_SEARCH_OFFLINE_MOBILES);
+  var itemdesc := ReadConfigFile("itemdesc");
+  var penalty := CInt(itemdesc[item.objtype].DexPenalty);
+  if(penalty)
+    EraseObjProperty(item, "#equipped");
+    SetDexterityMod(who, GetDexterityMod(who) + penalty);
+  endif
+  var type := GetObjProperty(item,"type");
+  var val := 0;
+  case(type)
+    "accuracy":     val := accuracy(who,item);
+    "cursed":       val := cursed(who,item);
+    "sight":        val := sight(who,item);
+    "reflect":      val := reflect(who,item);
+    "protection":   val := protection(who,item);
+    "wizzohat":     val := wizzohat(who,item);
+    "strength":     val := strength(who,item);
+    "invisibility": val := invisibility(who, item);
+    default:        val := 1;
+  endcase
+  return val;
+  set_critical(0);
+endprogram
+
+function strength(who,item)
+  who := who;
+  item := item;
+  return 1;
+endfunction
+
+function wizzohat(who,item)
+  SetIntelligenceMod(who, GetIntelligenceMod(who) - 10);
+  SetStrengthMod(who, GetStrengthMod(who) + 5);
+  SetDexterityMod(who, GetDexterityMod(who) + 5);
+  EraseObjProperty(item, "#equipped");
+  return 1;
+endfunction
+
+function cursed(who,item)
+  who := who;
+  item := item;
+  return 0;
+endfunction
+
+function invisibility(who,item)
+  RemoveMods(who, item);
+  return 1;
+endfunction
+
+function sight(who,item)
+  RemoveMods(who, item);
+  return 1;
+endfunction
+
+function reflect(who,item)
+  RemoveMods(who, item);
+  return 1;
+endfunction
+
+function accuracy(who,item)
+  var amt := CInt(GetObjProperty(item,"gain"));
+  amt := (0 - amt);
+  if((!amt) || (amt == 0))
+    amt := (0 - 5);
+  endif
+  var cfg := ReadConfigFile(":combat:itemdesc");
+  var attrib := cfg[item.objtype].Attribute;
+  case(attrib)
+    "Wrestling": ModifyAttributeTemporaryMod(who, ATTRIBUTEID_WRESTLING,     amt);
+    "Fencing":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_FENCING,       amt);
+    "Archery":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_ARCHERY,       amt);
+    "Swords":    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_SWORDSMANSHIP, amt);
+    "Mace":      ModifyAttributeTemporaryMod(who, ATTRIBUTEID_MACEFIGHTING,  amt);
+  endcase
+  EraseObjProperty(item, "#equipped");
+  return 1;
+endfunction
+
+function protection(who,item)
+  RemoveMods(who, item);
+  return 1;
+endfunction
+
+function RemoveMods(who, item)
+  who := who;
+  var proc := GetProcess(Cint(GetObjProperty(item, "Pid")));
+  if(proc)
+    var ev := {};
+    ev.+type := EVID_UNEQUIP;
+    proc.sendevent(ev);
+  endif
+  EraseObjProperty(item, "#equipped");
+endfunction

Added: trunk/096/pkg/systems/combat/old/earthElemental.src
===================================================================
--- trunk/096/pkg/systems/combat/old/earthElemental.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/earthElemental.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,33 @@
+use uo;
+use util;
+use os;
+include ":attributes:attributes";
+
+program macehit(param)
+  var attacker := param[1];
+  var defender := param[2];
+  var armor := param[4];
+  var rawdamage := param[6];
+  SetObjProperty(defender, "TempDamage", rawdamage);
+  if((attacker.dead) || (defender.dead))
+    return;
+  endif
+  if(armor)
+    if(RandomInt(50) > 35)
+      var admg := RandomInt(2) + 1;
+      if(armor.hp >admg)
+        armor.hp := armor.hp - admg;
+      else
+        DestroyItem(armor);
+      endif
+    endif
+  endif
+  var sdr := RandomInt(3) + 3;
+  if(GetStamina(defender) >= sdr)
+    SetStamina(defender, GetStamina(defender) - sdr);
+  else
+    SetStamina(defender, 0);
+  endif
+endprogram
+
+   

Added: trunk/096/pkg/systems/combat/old/equip.inc
===================================================================
--- trunk/096/pkg/systems/combat/old/equip.inc	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/equip.inc	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,130 @@
+
+
+
+function HandleMods(who, item)
+  set_critical(1);
+  var itemdesc := ReadConfigFile("itemdesc");
+  var penalty  := CInt(itemdesc[item.objtype].DexPenalty);
+  var restrict := Cint(itemdesc[item.objtype].GenderSpecific);
+  if((restrict == 1) and (who.graphic == 400))
+    SendSysMessage(who, "Only females may wear that.");
+    return 0;
+  endif
+  if(penalty)
+    SetObjProperty(item, "#equipped", who.serial);
+    SetDexterityMod(who, GetDexterityMod(who) - penalty);
+  endif
+  var type := GetObjProperty(item, "type");
+  if(!type)
+    return 1;
+  endif
+  var val := 0;
+  if(!who.ip)
+    return 1;
+  endif
+  case(type)
+    "accuracy":     val := accuracy(who,item);
+    "cursed":       val := cursed(who,item);
+    "sight":        val := sight(who,item);
+    "reflect":      val := reflect(who,item);
+    "protection":   val := protection(who,item);
+    "wizzohat":     val := wizzohat(who,item);
+    "strength":     val := strength(who,item);
+    "invisibility": val := invisibility(who,item);
+    default:        val := 1;
+  endcase
+  return val;
+  set_critical(0);
+endfunction
+
+function strength(who,item)
+  var gain := GetObjProperty(item, "gain");
+  if(!gain)
+    gain := 5;
+  endif
+  SetObjProperty(item, "#equipped", who.serial);
+  var parms := {who, item};
+  start_script("chargeUpkeep", parms);
+  return 1;
+endfunction
+
+function wizzohat(who,item)
+  SetIntelligenceMod(who, GetIntelligenceMod(who) + 10);
+  SetStrengthMod(who, GetStrengthMod(who) - 5);
+  SetDexterityMod(who, GetDexterityMod(who) - 5);
+  SetObjProperty(item, "#equipped", who.serial);
+  return 1;
+endfunction
+
+function accuracy(who,item)
+  var amt := CInt(GetObjProperty(item,"gain"));
+  if((!amt) || (amt == 0))
+    amt := 5;
+  endif
+  var cfg := ReadConfigFile(":combat:itemdesc");
+  var attrib := cfg[item.objtype].Attribute;
+  case(attrib)
+    "Wrestling": ModifyAttributeTemporaryMod(who, ATTRIBUTEID_WRESTLING,     amt);
+    "Fencing":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_FENCING,       amt);
+    "Archery":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_ARCHERY,       amt);
+    "Swords":    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_SWORDSMANSHIP, amt);
+    "Mace":      ModifyAttributeTemporaryMod(who, ATTRIBUTEID_MACEFIGHTING,  amt);
+  endcase
+  SetObjProperty(item, "#equipped", who.serial);
+  return 1;
+endfunction
+
+function cursed(who,item)
+  PlaySoundEffect(who, 0x246);
+  if(!GetObjProperty(item,"named"))
+    item.name := item.name + " [Cursed]";
+    SetObjProperty(item,"named", 1);
+  endif
+  PrintTextAbovePrivate(who,"You have been cursed!", who);
+  SetObjProperty(item, "#equipped", who.serial);
+  return 1;
+endfunction
+
+function invisibility(who,item)
+  var gain := GetObjProperty(item, "gain");
+  if(!gain)
+    gain := 5;
+  endif
+  SetObjProperty(item, "#equipped", who.serial);
+  var parms := {who, item};
+  start_script("chargeUpkeep", parms);
+  return 1;
+endfunction
+
+function sight(who,item)
+  var gain := GetObjProperty(item, "gain");
+  if(!gain)
+    gain := 5;
+  endif
+  SetObjProperty(item, "#equipped", who.serial);
+  var parms := {who, item};
+  start_script("chargeUpkeep", parms);
+  return 1;
+endfunction
+
+function protection(who,item)
+  var gain := GetObjProperty(item, "gain");
+  if(!gain)
+    gain := 5;
+  endif
+  SetObjProperty(item, "#equipped", who.serial);
+  var parms := {who, item};
+  start_script("chargeUpkeep", parms);
+  return 1;
+endfunction
+
+function reflect(who,item)
+  var gain := GetObjProperty(item, "gain");
+  if(!gain)
+    gain := 5;
+  endif
+  SetObjProperty(item, "#equipped", who.serial);
+  var parms := {who, item};
+  start_script("chargeUpkeep", parms);
+  return 1;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/systems/combat/old/equip.src
===================================================================
--- trunk/096/pkg/systems/combat/old/equip.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/equip.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,12 @@
+use uo;
+use os;
+use cfgfile;
+
+include "include/client";
+include ":attributes:attributes";
+include "equip";
+
+program equipweapon(who, item)
+  var val := HandleMods(who, item);
+  return val;
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/systems/combat/old/hitScriptInc.inc
===================================================================
--- trunk/096/pkg/systems/combat/old/hitScriptInc.inc	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/hitScriptInc.inc	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,9 @@
+use uo;
+use util;
+use math;
+include ":attributes:attributes";
+
+function DealDamage(defender, attacker, rawdamage)
+  rawdamage := rawdamage + RandomInt( (GetEffectiveSkill(attacker, 1) ) / 20);
+  ApplyRawDamage(defender, rawdamage);
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/systems/combat/old/itemControl.src
===================================================================
--- trunk/096/pkg/systems/combat/old/itemControl.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/itemControl.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,11 @@
+use uo;
+use os;
+use cfgfile;
+
+program itemcontrol(item)
+  var cfgfile  := ReadConfigFile(":combat:itemdesc");
+  var dmg      := cfgfile[item.objtype].damage;
+  if(dmg)
+    item.hitscript := "mainHitScript";
+  endif
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/systems/combat/old/itemdesc.cfg
===================================================================
--- trunk/096/pkg/systems/combat/old/itemdesc.cfg	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/itemdesc.cfg	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,2627 @@
+# $Id: itemdesc.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+#####################################
+#
+# pkg/std/combat/itemdesc.cfg - Weapons and Armor
+#
+# see pol/config/armrdesc.cfg for descriptions of armor entry formats
+# see pol/config/wepndesc.cfg for descriptions of weapon entry formats
+#
+#####################################
+
+#################
+#	INTRINSIC WRESTLING WEAPON	#
+#################
+
+Weapon 0xF020
+{
+	Name		Intrinsic Weapon
+	Name		Wrestling
+	Name		Fist
+	Desc		Intrinsic Weapon
+	Speed		40
+	Damage		1d8
+	Attribute	Wrestling
+	Anim		0x9
+	Graphic		1
+	MissSound	0x234
+	HitSound	0x13E
+	MaxHP		1
+	Intrinsic	1
+	controlscript	wrestleControl
+	HitScript	wrestlingHitScript
+	SaveOnExit	0
+}
+
+#################
+#		ARMOR		#
+#################
+
+# LEATHER
+Armor 0x13C7
+{
+	Name		LeatherGorget
+	desc		leather gorget
+	AR		13
+	Coverage	Neck
+	VendorSellsFor	74
+	VendorBuysFor	37
+	MaxHP		35
+	strrequired	10
+	medloss		100
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13CD
+{
+	Name		LeatherSleeves
+	desc		leather sleeves
+	AR		13
+	VendorSellsFor	80
+	VendorBuysFor	40
+	MaxHP		35
+	strrequired	10
+	medloss		200
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13C6
+{
+	Name		LeatherGloves
+	desc		leather gloves
+	AR		13
+	Coverage	Hands
+	VendorSellsFor	60
+	VendorBuysFor	30
+	MaxHP		35
+	strrequired	10
+	medloss		100
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1DB9
+{
+	Name		LeatherCap
+	desc		leather cap
+	AR		13
+	Coverage	Head
+	VendorSellsFor	60
+	VendorBuysFor	30
+	MaxHP		35
+	strrequired	15
+	medloss		400
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13CB
+{
+	Name		LeatherLeggings
+	desc		leather leggings
+	AR		13
+	Coverage	Legs/feet
+	VendorSellsFor	80
+	VendorBuysFor	40
+	MaxHP		35
+	strrequired	10
+	medloss		200
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13CC
+{
+	Name		LeatherTunic
+	desc		leather tunic
+	AR		13
+	Coverage	Body
+	VendorSellsFor	101
+	VendorBuysFor	52
+	MaxHP		35
+	strrequired	15
+	medloss		300
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+Armor 0x13D3
+{
+	Name		LeatherTunic2
+	desc		leather tunic
+	AR		13
+	Coverage	Body
+	VendorSellsFor	101
+	VendorBuysFor	52
+	MaxHP		35
+	strrequired	15
+	medloss		300
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+# STUDDED LEATHER
+Armor 0x13D6
+{
+	Name		StuddedGorget
+	desc		studded leather gorget
+	AR		16
+	Coverage	Neck
+	VendorSellsFor	73
+	VendorBuysFor	36
+	MaxHP		40
+	strrequired	25
+	medloss		100
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+
+}
+
+Armor 0x13D5
+{
+	Name		StuddedGloves
+	desc		studded leather gloves
+	AR		16
+	Coverage	Hands
+	VendorSellsFor	79
+	VendorBuysFor	39
+	MaxHP		40
+	strrequired	25
+	medloss		100
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13D4
+{
+	Name		StuddedSleeves
+	desc		studded leather sleeves
+	AR		16
+	Coverage	Arms
+	VendorSellsFor	87
+	VendorBuysFor	43
+	MaxHP		40
+	strrequired	25
+	medloss		150
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13DA
+{
+	Name		StuddedLeggings
+	desc		studded leather leggings
+	AR		16
+	Coverage	Legs/feet
+	VendorSellsFor	103
+	VendorBuysFor	51
+	MaxHP		40
+	strrequired	35
+	medloss		400
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13DB
+{
+	Name		StuddedTunic
+	desc		studded leather tunic
+	AR		16
+	Coverage	Body
+	VendorSellsFor	128
+	VendorBuysFor	64
+	MaxHP		40
+	strrequired	35
+	medloss		500
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+
+}
+
+#####################
+#------------ Ranger Armor ------------#
+#####################
+Armor 0x8100
+{
+	Name		RangerGorget
+	desc		studded gorget, ranger armor
+	graphic		0x13D6
+	AR		20
+	Coverage	Neck
+	color		34202
+	VendorSellsFor	98
+	VendorBuysFor	49
+	MaxHP		60
+	strrequired	35
+	medloss		100
+	repairable	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	Cprop		type sranger
+}
+
+Armor 0x8101
+{
+	Name		RangerGloves
+	desc		studded gloves, ranger armor
+	graphic		0x13D5
+	color		34202
+	AR		20
+	Coverage	Hands
+	VendorSellsFor	98
+	VendorBuysFor	49
+	MaxHP		60
+	strrequired	35
+	medloss		100
+	repairable	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	Cprop		type sranger
+}
+
+Armor 0x8102
+{
+	Name		RangerSleeves
+	desc		studded sleeves, ranger armor
+	graphic		0x13D4
+	color		34202
+	AR		20
+	Coverage	Arms
+	VendorSellsFor	110
+	VendorBuysFor	55
+	MaxHP		60
+	strrequired	35
+	medloss		150
+	repairable	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	Cprop		type sranger
+}
+
+Armor 0x8103
+{
+	Name		RangerLeggings
+	desc		studded leggings, ranger armor
+	graphic		0x13DA
+	color		34202
+	AR		20
+	Coverage	Legs/feet
+	VendorSellsFor	150
+	VendorBuysFor	75
+	MaxHP		60
+	strrequired	35
+	medloss		400
+	repairable	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	Cprop		type sranger
+}
+
+Armor 0x8104
+{
+	Name		RangerTunic
+	desc		studded tunic, ranger armor
+	graphic		0x13DB
+	color		34202
+	AR		20
+	Coverage	Body
+	VendorSellsFor	260
+	VendorBuysFor	130
+	MaxHP		60
+	strrequired	45
+	medloss		500
+	repairable	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	Cprop		type sranger
+}
+#####################
+#---------- End Ranger Armor ----------#
+#####################
+Armor 0x1C02
+{
+	Name		FemaleStudded
+	desc		female studded armor
+	AR		16
+	Coverage	Body
+	VendorSellsFor	142
+	VendorBuysFor	71
+	MaxHP		109
+	strrequired	35
+	medloss		500
+	GenderSpecific	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1c04
+{
+	Name		FemalePlate
+	desc		female plate armor
+	AR		30
+	Coverage	body
+	VendorSellsFor	245
+	VendorBuysFor	123
+	MaxHP		60
+	strrequired	45
+	repairable	1
+	medloss		nomed
+	DexPenalty	5
+	GenderSpecific	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+
+Armor 0x1C06
+{
+	Name		FemaleLeather
+	desc		female leather armor
+	AR		13
+	Coverage	Body
+	VendorSellsFor	116
+	VendorBuysFor	58
+	MaxHP		35
+	strrequired	15
+	medloss		300
+	GenderSpecific	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1C08
+{
+	Name		LeatherSkirt
+	desc		leather skirt
+	AR		13
+	Coverage	Legs/feet
+	VendorSellsFor	87
+	VendorBuysFor	43
+	MaxHP		35
+	strrequired	10
+	medloss		200
+	GenderSpecific	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1C0A
+{
+	Name		LeatherBustier
+	desc		leather bustier
+	AR		13
+	Coverage	Body
+	VendorSellsFor	97
+	VendorBuysFor	48
+	MaxHP		35
+	strrequired	10
+	medloss		300
+	GenderSpecific	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+
+}
+
+Armor 0x1C0C
+{
+	Name		StuddedBustier
+	desc		studded bustier
+	AR		16
+	Coverage	Body
+	VendorSellsFor	120
+	VendorBuysFor	60
+	MaxHP		110
+	strrequired	25
+	medloss		400
+	GenderSpecific	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1C00
+{
+	Name		LeatherShorts
+	desc		leather shorts
+	AR		13
+	Coverage	Legs/feet
+	VendorSellsFor	86
+	VendorBuysFor	43
+	MaxHP		35
+	strrequired	10
+	medloss		200
+	GenderSpecific	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x170B
+{
+	Name		LeatherBoots
+	desc		boots
+	AR		1
+	Coverage	Legs/feet
+	VendorSellsFor	43
+	VendorBuysFor	21
+	MaxHP		50
+	dyeable		1
+	medloss		0
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1711
+{
+	Name		ThighBoots
+	desc		thigh boots
+	AR		1
+	Coverage	Legs/feet
+	VendorSellsFor	56
+	VendorBuysFor	28
+	MaxHP		50
+	dyeable		1
+	medloss		0
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+# CHAIN MAIL
+Armor 0x13BB
+{
+	Name		ChainmailCoif
+	desc		chainmail coif
+	AR		23
+	Coverage	Head
+	Coverage	Neck
+	VendorSellsFor	130
+	VendorBuysFor	65
+	MaxHP		40
+	strrequired	20
+	repairable	1
+	medloss		1000
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13C0
+{
+	Name		ChainmailCoif2
+	desc		chainmail coif
+	AR		23
+	Coverage	Head
+	Coverage	Neck
+	VendorSellsFor	130
+	VendorBuysFor	65
+	MaxHP		40
+	strrequired	20
+	repairable	1
+	medloss		1000
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13BE
+{
+	Name		ChainmailLeggings
+	desc		chainmail leggings
+	AR		23
+	Coverage	Legs/feet
+	VendorSellsFor	166
+	VendorBuysFor	83
+	MaxHP		55
+	strrequired	20
+	repairable	1
+	medloss		1000
+	DexPenalty	3
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13C3
+{
+	Name		ChainmailLeggings2
+	desc		chainmail leggings
+	AR		23
+	Coverage	Legs/feet
+	VendorSellsFor	166
+	VendorBuysFor	83
+	MaxHP		55
+	strrequired	20
+	repairable	1
+	medloss		1000
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13BF
+{
+	Name		ChainmailTunic
+	desc		chainmail tunic
+	AR		23
+	Coverage	Arms
+	Coverage	Body
+	VendorSellsFor	207
+	VendorBuysFor	103
+	MaxHP		53
+	strrequired	20
+	repairable	1
+	medloss		2000
+	DexPenalty	5
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13C4
+{
+	Name		ChainmailTunic2
+	desc		chainmail tunic
+	AR		23
+	Coverage	Arms
+	Coverage	Body
+	VendorSellsFor	207
+	VendorBuysFor	103
+	MaxHP		53
+	strrequired	20
+	repairable	1
+	medloss		2000
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+# Plate Helms
+Armor 0x1408
+{
+	Name		CloseHelm
+	desc		closed helm
+	AR		30
+	Coverage	Head
+	VendorSellsFor	145
+	VendorBuysFor	72
+	MaxHP		55
+	strrequired	40
+	repairable	1
+	medloss		1200
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1409
+{
+	Name		CloseHelm2
+	desc		closed helm
+	AR		30
+	Coverage	Head
+	VendorSellsFor	145
+	VendorBuysFor	72
+	MaxHP		55
+	strrequired	40
+	repairable	1
+	medloss		1200
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x140A
+{
+	Name		Helmet
+	desc		helmet
+	AR		30
+	Coverage	Head
+	VendorSellsFor	145
+	VendorBuysFor	72
+	MaxHP		55
+	strrequired	40
+	repairable	1
+	medloss		1200
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x140B
+{
+	Name		Helmet2
+	desc		helmet
+	AR		30
+	Coverage	Head
+	VendorSellsFor	145
+	VendorBuysFor	72
+	MaxHP		55
+	strrequired	40
+	repairable	1
+	medloss		1200
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x140C
+{
+	Name		Bascinet
+	desc		bascinet
+	AR		30
+	Coverage	Head
+	VendorSellsFor	127
+	VendorBuysFor	46
+	MaxHP		110
+	strrequired	10
+	repairable	1
+	medloss		1200
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+
+}
+Armor 0x140D
+{
+	Name		Bascinet2
+	desc		bascinet
+	AR		30
+	Coverage	Head
+	VendorSellsFor	127
+	VendorBuysFor	46
+	MaxHP		110
+	strrequired	10
+	repairable	1
+	medloss		1200
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x140E
+{
+	Name		NoseHelm
+	desc		nose helm
+	AR		30
+	Coverage	Head
+	VendorSellsFor	145
+	VendorBuysFor	53
+	MaxHP		55
+	strrequired	40
+	repairable	1
+	medloss		1200
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+Armor 0x140F
+{
+	Name		NoseHelm2
+	desc		nose helm
+	AR		30
+	Coverage	Head
+	VendorSellsFor	145
+	VendorBuysFor	53
+	MaxHP		55
+	strrequired	40
+	repairable	1
+	medloss		1200
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1412
+{
+	Name		PlateHelm
+	desc		platemail helm
+	AR		30
+	Coverage	Head
+	VendorSellsFor	170
+	VendorBuysFor	85
+	MaxHP		55
+	strrequired	40
+	repairable	1
+	DexPenalty	1
+	medloss		1500
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1419
+{
+	Name		PlateHelm2
+	desc		platemail helm
+	AR		30
+	Coverage	Head
+	VendorSellsFor	170
+	VendorBuysFor	85
+	MaxHP		55
+	strrequired	40
+	repairable	1
+	DexPenalty	1
+	medloss		1500
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+# SHIELDS
+Armor 0x1B72
+{
+	Name		BronzeShield
+	desc		round shield
+	AR		10
+	VendorSellsFor	91
+	VendorBuysFor	45
+	MaxHP		28
+	strrequired	20
+	repairable	1
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1B73
+{
+	Name		Buckler
+	desc		buckler
+	AR		7
+	VendorSellsFor	66
+	VendorBuysFor	33
+	MaxHP		46
+	strrequired	15
+	repairable	1
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+
+}
+
+Armor 0x1B74
+{
+	Name		KiteShield
+	desc		metal kite shield
+	AR		16
+	VendorSellsFor	135
+	VendorBuysFor	67
+	MaxHP		110
+	strrequired	30
+	repairable	1
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+Armor 0x1B75
+{
+	Name		KiteShield2
+	desc		metal kite shield
+	AR		16
+	VendorSellsFor	135
+	VendorBuysFor	67
+	MaxHP		110
+	strrequired	30
+	repairable	1
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1B76
+{
+	Name		HeaterShield
+	desc		heater shield
+	AR		23
+	VendorSellsFor	175
+	VendorBuysFor	87
+	MaxHP		35
+	strrequired	30
+	repairable	1
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+
+}
+Armor 0x1B77
+{
+	Name		HeaterShield2
+	desc		heater shield
+	AR		23
+	VendorSellsFor	175
+	VendorBuysFor	87
+	MaxHP		35
+	strrequired	30
+	repairable	1
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1B78
+{
+	Name		KiteShieldB1
+	desc		tear kite shield
+	AR		7
+	VendorSellsFor	121
+	VendorBuysFor	60
+	MaxHP		55
+	strrequired	15
+	repairable	1
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1B79
+{
+	Name		KiteShieldB2
+	desc		tear kite shield
+	AR		7
+	VendorSellsFor	121
+	VendorBuysFor	60
+	MaxHP		55
+	strrequired	15
+	repairable	1
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1B7A
+{
+	Name		WoodenShield
+	desc		wooden shield
+	AR		8
+	VendorSellsFor	64
+	VendorBuysFor	32
+	MaxHP		22
+	strrequired	5
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1B7B
+{
+	Name		MetalShield
+	desc		metal shield
+	AR		9
+	VendorSellsFor	98
+	VendorBuysFor	49
+	MaxHP		40
+	strrequired	10
+	repairable	1
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1bc4
+{
+	Name		Ordershield
+	desc		an order shield
+	AR		30
+	MaxHP		110
+	repairable	1
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1bc3
+{
+	Name		Chaosshield
+	desc		chaos shield
+	AR		32
+	MaxHP		110
+	repairable	1
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+#RINGMAIL
+Armor 0x13ec
+{
+	Name		RingmailTunic
+	desc		ringmail tunic
+	AR		20
+	Coverage	Body
+	VendorSellsFor	218
+	VendorBuysFor	109
+	MaxHP		45
+	strrequired	20
+	repairable	1
+	medloss		1000
+	DexPenalty	2
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13ed
+{
+	Name		RingmailTunic2
+	desc		ringmail tunic
+	AR		20
+	Coverage	Body
+	VendorSellsFor	218
+	VendorBuysFor	109
+	MaxHP		45
+	strrequired	20
+	repairable	1
+	medloss		1000
+	DexPenalty	2
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13ee
+{
+	Name		RingmailSleeves
+	desc		ringmail sleeves
+	AR		20
+	VendorSellsFor	127
+	VendorBuysFor	63
+	MaxHP		45
+	strrequired	20
+	repairable	1
+	medloss		500
+	DexPenalty	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+Armor 0x13ef
+{
+	Name		RingmailSleeves2
+	desc		ringmail sleeves
+	AR		20
+	VendorSellsFor	127
+	VendorBuysFor	63
+	MaxHP		45
+	strrequired	20
+	repairable	1
+	medloss		500
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13f0
+{
+	Name		RingmailLeggings
+	desc		ringmail leggings
+	AR		20
+	Coverage	Legs/Feet
+	VendorSellsFor	147
+	VendorBuysFor	73
+	MaxHP		45
+	strrequired	20
+	repairable	1
+	medloss		700
+	DexPenalty	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13f1
+{
+	Name		RingmailLeggings2
+	desc		ringmail leggings
+	AR		20
+	Coverage	Legs/Feet
+	VendorSellsFor	147
+	VendorBuysFor	73
+	MaxHP		45
+	strrequired	20
+	repairable	1
+	medloss		700
+	DexPenalty	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x13f2
+{
+	Name		RingmailGloves
+	desc		ringmail gloves
+	AR		20
+	Coverage	Hands
+	VendorSellsFor	79
+	VendorBuysFor	39
+	MaxHP		45
+	strrequired	20
+	repairable	1
+	medloss		250
+	DexPenalty	1
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+# PLATE
+Armor 0x1415
+{
+	Name		PlatemailBreastplate
+	desc		platemail breastplate
+	AR		30
+	Coverage	Body
+	VendorSellsFor	273
+	VendorBuysFor	136
+	MaxHP		60
+	strrequired	60
+	repairable	1
+	DexPenalty	8
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+Armor 0x1416
+{
+	Name		PlatemailBreastplate2
+	desc		platemail breastplate
+	AR		30
+	Coverage	Body
+	VendorSellsFor	273
+	VendorBuysFor	136
+	MaxHP		60
+	strrequired	60
+	repairable	1
+	DexPenalty	8
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1410
+{
+	Name		PlatemailArms
+	desc		platemail arms
+	AR		30
+	Coverage	Arms
+	VendorSellsFor	181
+	VendorBuysFor	90
+	MaxHP		60
+	strrequired	40
+	repairable	1
+	DexPenalty	2
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+Armor 0x1417
+{
+	Name		PlatemailArms2
+	desc		platemail arms
+	AR		30
+	Coverage	Arms
+	VendorSellsFor	181
+	VendorBuysFor	90
+	MaxHP		60
+	strrequired	40
+	repairable	1
+	DexPenalty	2
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1411
+{
+	Name		PlatemailLegs
+	desc		platemail leggings
+	AR		30
+	Coverage	Legs/Feet
+	VendorSellsFor	218
+	VendorBuysFor	109
+	MaxHP		60
+	strrequired	60
+	repairable	1
+	DexPenalty	6
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+Armor 0x141A
+{
+	Name		PlatemailLegs2
+	desc		platemail leggings
+	AR		30
+	Coverage	Legs/Feet
+	VendorSellsFor	218
+	VendorBuysFor	109
+	MaxHP		60
+	strrequired	60
+	repairable	1
+	DexPenalty	6
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1414
+{
+	Name		PlatemailGloves
+	desc		platemail gloves
+	AR		30
+	Coverage	Hands
+	VendorSellsFor	122
+	VendorBuysFor	61
+	MaxHP		60
+	strrequired	30
+	repairable	1
+	DexPenalty	2
+	medloss		nomed
+	DexPenalty	2
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+Armor 0x1418
+{
+	Name		PlatemailGloves2
+	desc		platemail gloves
+	AR		30
+	Coverage	Hands
+	VendorSellsFor	122
+	VendorBuysFor	61
+	MaxHP		60
+	strrequired	30
+	repairable	1
+	DexPenalty	2
+	medloss		nomed
+	DexPenalty	2
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1413
+{
+	Name		PlatemailGorget
+	desc		platemail gorget
+	AR		30
+	Coverage	Neck
+	VendorSellsFor	124
+	VendorBuysFor	70
+	MaxHP		60
+	strrequired	30
+	repairable	1
+	DexPenalty	1
+	medloss		nomed
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x144e
+{
+	Name		Bonearms
+	desc		bone arms
+	AR		30
+	Coverage	Arms
+	MaxHP		25
+	strrequired	40
+	medloss		700
+	DexPenalty	2
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x144f
+{
+	Name		Bonetunic
+	desc		bone tunic
+	AR		30
+	Coverage	Body
+	MaxHP		25
+	strrequired	40
+	medloss		2000
+	DexPenalty	6
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1450
+{
+	Name		Bonegloves
+	desc		bone gloves
+	AR		30
+	Coverage	Hands
+	MaxHP		25
+	strrequired	40
+	medloss		500
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1451
+{
+	Name		Bonehelm
+	desc		bone helm
+	AR		30
+	Coverage	Head
+	MaxHP		25
+	strrequired	40
+	medloss		750
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1452
+{
+	Name		Bonelegs
+	desc		bone leggings
+	AR		30
+	Coverage	Legs/feet
+	MaxHP		25
+	strrequired	40
+	medloss		1000
+	DexPenalty	4
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Armor 0x1f0b
+{
+	Name		Orchelm
+	desc		an orc helm
+	AR		20
+	Coverage	Head
+	MaxHP		55
+	medloss		500
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+#################
+#		WEAPONS		#
+#################
+
+Weapon 0x0F60
+{
+	Name		longsword
+	desc		longsword
+	Default		1
+	Speed		35
+	Damage		2d15+3
+	Attribute	Swordsmanship
+	Anim		0x0009
+	MaxHP		60
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	60
+	VendorBuysFor	30
+	strrequired	25
+	repairable	1
+	MinDam		5
+	MaxDam		33
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x13AF
+{
+	Name		WarAxe
+	desc		war axe
+	Speed		40
+	Damage		6d4+3
+	Attribute	Macefighting
+	Anim		0x000b
+	HitSound	0x23D
+	MissSound	0x233
+	MaxHP		55
+	Script		:lumberjacking:lumberjack
+	VendorSellsFor	38
+	VendorBuysFor	19
+	strrequired	45
+	repairable	1
+	MinDam		9
+	MaxDam		27
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0x13B2
+{
+	Name		Bow
+	desc		bow
+	Speed		20
+	Damage		4d9+5
+	Attribute	Archery
+	Anim		0x12
+	Projectile	1
+	ProjectileType	0xf3f
+	ProjectileAnim	0xf42
+	ProjectileSound 0x235
+	MissSound	0x239
+	HitSound	0x235
+	MaxHP		45
+	VendorSellsFor	58
+	VendorBuysFor	29
+	TwoHanded	1
+	strrequired	20
+	MinDam		9
+	MaxDam		41
+	minrange		0
+	maxrange		20
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0f4f
+{
+	Name		Crossbow
+	desc		crossbow
+	Speed		18
+	Damage		5d8+3
+	Attribute	Archery
+	Anim		0x13
+	Projectile	1
+	ProjectileType	0x1bfb
+	ProjectileAnim	0x1bfe
+	ProjectileSound 0x235
+	HitSound	0x235
+	MissSound	0x239
+	MaxHP		45
+	VendorSellsFor	47
+	VendorBuysFor	23
+	TwoHanded	1
+	strrequired	30
+	MinDam		8
+	MaxDam		43
+	minrange		0
+	maxrange		20
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x13fd
+{
+	Name		HeavyCrossbow
+	desc		heavy crossbow
+	Speed		10
+	Damage		5d10+6
+	Attribute	Archery
+	Anim		0x13
+	Projectile	1
+	ProjectileType	0x1bfb
+	ProjectileAnim	0x1bfe
+	ProjectileSound 0x235
+	HitSound	0x235
+	MissSound	0x239
+	MaxHP		65
+	VendorSellsFor	56
+	VendorBuysFor	28
+	TwoHanded	1
+	strrequired	40
+	repairable	1
+	MinDam		11
+	MaxDam		56
+	minrange		0
+	maxrange		20
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0f49
+{
+	Name		Axe
+	desc		axe
+	Speed		37
+	Damage		3d10+3
+	Attribute	Swordsmanship
+	Anim		0x000d
+	MaxHP		65
+	Script		:lumberjacking:lumberjack
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	48
+	VendorBuysFor	24
+	TwoHanded	1
+	strrequired	3
+	repairable	1
+	MinDam		6
+	MaxDam		33
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0f47
+{
+	Name		BattleAxe
+	desc		battle axe
+	Speed		30
+	Damage		2d17+4
+	Attribute	Swordsmanship
+	Anim		0x000d
+	MaxHP		55
+	Script		:lumberjacking:lumberjack
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	38
+	VendorBuysFor	36
+	repairable	1
+	TwoHanded	1
+	strrequired	25
+	MinDam		6
+	MaxDam		38
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0f4b
+{
+	Name		DoubleAxe
+	desc		double axe
+	Speed		37
+	Damage		1d31+4
+	Attribute	Swordsmanship
+	Anim		0x000d
+	MaxHP		65
+	Script		:lumberjacking:lumberjack
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	32
+	VendorBuysFor	16
+	TwoHanded	1
+	strrequired	45
+	repairable	1
+	MinDam		5
+	MaxDam		35
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0f45
+{
+	Name		ExecutionersAxe
+	desc		executioner's axe
+	Speed		37
+	Damage		3d10+3
+	Attribute	Swordsmanship
+	Anim		0x000d
+	MaxHP		60
+	Script		:lumberjacking:lumberjack
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	38
+	VendorBuysFor	33
+	TwoHanded	1
+	strrequired	40
+	repairable	1
+	MinDam		6
+	MaxDam		33
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x13fa
+{
+	Name		LargeBattleAxe
+	desc		large battle axe
+	Speed		30
+	Damage		2d17+4
+	Attribute	Swordsmanship
+	Anim		0x000d
+	MaxHP		70
+	Script		:lumberjacking:lumberjack
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	32
+	VendorBuysFor	16
+	TwoHanded	1
+	strrequired	40
+	repairable	1
+	MinDam		6
+	MaxDam		38
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x1442
+{
+	Name		TwoHandedAxe
+	desc		two handed axe
+	Speed		30
+	Damage		2d18+3
+	Attribute	Swordsmanship
+	Anim		0x000d
+	MaxHP		50
+	Script		:lumberjacking:lumberjack
+	HitSound	0x23C
+	MissSound	0x23A
+	Anim		0xD
+	VendorSellsFor	42
+	VendorBuysFor	21
+	TwoHanded	1
+	strrequired	40
+	repairable	1
+	MinDam		5
+	MaxDam		39
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x143c
+{
+	Name		HammerPick
+	desc		hammer pick
+	Speed		30
+	Damage		3d10+3
+	Attribute	Macefighting
+	Anim		0x000b
+	MaxHP		50
+	Script		:mining:mining
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	31
+	VendorBuysFor	15
+	strrequired	35
+	repairable	1
+	MinDam		6
+	MaxDam		33
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0x0f5c
+{
+	Name		Mace
+	desc		mace
+	Speed		30
+	Damage		6d5+2
+	Anim		0x000b
+	HitSound	0x13C
+	MissSound	0x234
+	MaxHP		50
+	VendorSellsFor	38
+	VendorBuysFor	30
+	strrequired	20
+	Attribute	Macefighting
+	repairable	1
+	MinDam		8
+	MaxDam		32
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0x143a
+{
+	Name		Maul
+	desc		maul
+	Speed		30
+	Damage		5d5+5
+	Attribute	Macefighting
+	Anim		0x000b
+	HitSound	0x13C
+	MissSound	0x234
+	MaxHP		50
+	VendorSellsFor	31
+	VendorBuysFor	15
+	strrequired	20
+	repairable	1
+	MinDam		7
+	MaxDam		27
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0x1438
+{
+	Name		WarHammer
+	desc		war hammer
+	Speed		31
+	Damage		7d5+1
+	Attribute	Macefighting
+	Anim		0x000d
+	HitSound	0x13C
+	MissSound	0x234
+	MaxHP		70
+	VendorSellsFor	27
+	VendorBuysFor	13
+	strrequired	30
+	TwoHanded	1
+	repairable	1
+	MinDam		8
+	MaxDam		36
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0x1406
+{
+	Name		WarMace
+	desc		war mace
+	Speed		32
+	Damage		5d5+5
+	Attribute	Macefighting
+	Anim		0x000b
+	HitSound	0x13C
+	MissSound	0x234
+	MaxHP		70
+	VendorSellsFor	37
+	VendorBuysFor	18
+	strrequired	30
+	repairable	1
+	MinDam		10
+	MaxDam		30
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0x0f4e
+{
+	Name		Bardiche
+	desc		bardiche
+	Speed		26
+	Damage		2d18+3
+	Attribute	Swordsmanship
+	Anim		0x000d
+	HitSound	0x237
+	MissSound	0x233
+	MaxHP		65
+	Script		:lumberjacking:lumberjack
+	VendorSellsFor	68
+	VendorBuysFor	34
+	TwoHanded	1
+	strrequired	40
+	repairable	1
+	MinDam		5
+	MaxDam		43
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x143e
+{
+	Name		Halberd
+	desc		halberd
+	Speed		25
+	Damage		8d5+3
+	Attribute	Swordsmanship
+	Anim		0xC
+	HitSound	0x238
+	MissSound	0x233
+	MaxHP		55
+	Script		:lumberjacking:lumberjack
+	VendorSellsFor	50
+	VendorBuysFor	25
+	TwoHanded	1
+	strrequired	45
+	Anim		0x000d
+	repairable	1
+	MinDam		5
+	MaxDam		49
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x1402
+{
+	Name		ShortSpear
+	desc		short spear
+	Speed		50
+	Damage		2d15+2
+	Attribute	Fencing
+	Anim		0x000e
+	MaxHP		55
+	HitSound	0x23D
+	MissSound	0x23B
+	VendorSellsFor	32
+	VendorBuysFor	16
+	TwoHanded	1
+	strrequired	15
+	repairable	1
+	MinDam		4
+	MaxDam		32
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0f63
+{
+	Name		Spear
+	desc		spear
+	Speed		46
+	Damage		2d18
+	Attribute	Fencing
+	Anim		0x000e
+	MaxHP		55
+	HitSound	0x23D
+	MissSound	0x23B
+	VendorSellsFor	38
+	VendorBuysFor	36
+	TwoHanded	1
+	strrequired	30
+	repairable	1
+	MinDam		2
+	MaxDam		36
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x1404
+{
+	Name		WarFork
+	desc		war fork
+	Speed		45
+	Damage		1d29+3
+	Attribute	Fencing
+	Anim		0x000a
+	MaxHP		70
+	HitSound	0x23D
+	MissSound	0x23B
+	VendorSellsFor	34
+	VendorBuysFor	17
+	strrequired	35
+	repairable	1
+	MinDam		4
+	MaxDam		32
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0f5e
+{
+	Name		BroadSword
+	desc		broadsword
+	Speed		45
+	Damage		2d13+3
+	Attribute	Swordsmanship
+	Anim		0x0009
+	MaxHP		65
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	44
+	VendorBuysFor	22
+	strrequired	25
+	repairable	1
+	MinDam		7
+	MaxDam		31
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x1440
+{
+	Name		Cutlass
+	desc		cutlass
+	Speed		45
+	Damage		2d12+4
+	Attribute	Swordsmanship
+	Anim		0x0009
+	MaxHP		55
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	32
+	VendorBuysFor	27
+	strrequired	10
+	repairable	1
+	MinDam		6
+	MaxDam		28
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0f51
+{
+	Name		Dagger
+	desc		dagger
+	Speed		55
+	Damage		2d4
+	Attribute	Fencing
+	Anim		0x000a
+	MaxHP		40
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	33
+	VendorBuysFor	21
+	strrequired	1
+	repairable	1
+	MinDam		3
+	MaxDam		15
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x13fe
+{
+	Name		Katana
+	desc		katana
+	Speed		58
+	Damage		3d8+2
+	Attribute	Swordsmanship
+	Anim		0x0009
+	MaxHP		60
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	42
+	VendorBuysFor	42
+	strrequired	10
+	repairable	1
+	MinDam		5
+	MaxDam		26
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x1401
+{
+	Name		Kryss
+	desc		kryss
+	Speed		53
+	Damage		1d26+2
+	Attribute	Fencing
+	Anim		0x000a
+	MaxHP		60
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	42
+	VendorBuysFor	21
+	strrequired	10
+	repairable	1
+	MinDam		3
+	MaxDam		28
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x13b5
+{
+	Name		Scimitar
+	desc		scimitar
+	Speed		43
+	Damage		2d14+2
+	Attribute	Swordsmanship
+	Anim		0x0009
+	MaxHP		50
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	43
+	VendorBuysFor	21
+	strrequired	10
+	repairable	1
+	MinDam		4
+	MaxDam		30
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x13b9
+{
+	Name		VikingSword
+	desc		viking sword
+	Speed		30
+	Damage		4d8+2
+	Attribute	Swordsmanship
+	Anim		0x0009
+	MaxHP		50
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	66
+	VendorBuysFor	33
+	TwoHanded	0
+	strrequired	40
+	repairable	1
+	MinDam		8
+	MaxDam		36
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0f43
+{
+	Name		Hatchet
+	desc		hatchet
+	Speed		40
+	Damage		2d8+1
+	Attribute	Swordsmanship
+	Anim		0x0009
+	MaxHP		55
+	Script		:lumberjacking:lumberjack
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	20
+	VendorBuysFor	10
+	strrequired	15
+	repairable	1
+	MinDam		2
+	MaxDam		17
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0e85
+{
+	Name		Pickaxe
+	desc		pickaxe
+	Speed		35
+	Damage		1d15
+	Attribute	Macefighting
+	Anim		0x000c
+	MaxHP		45
+	Script		:mining:mining
+	VendorSellsFor	32
+	VendorBuysFor	16
+	TwoHanded	1
+	strrequired	25
+	repairable	1
+	MinDam		1
+	MaxDam		15
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0x13f6
+{
+	Name		ButcherKnife
+	desc		butcher's knife
+	Speed		40
+	Damage		2d2
+	Attribute	Swordsmanship
+	Anim		0x0009
+	MaxHP		35
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	21
+	VendorBuysFor	10
+	strrequired	5
+	repairable	1
+	MinDam		2
+	MaxDam		14
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0ec2
+{
+	Name		Cleaver
+	desc		cleaver
+	Speed		40
+	Damage		1d7
+	Attribute	Swordsmanship
+	Anim		0x0009
+	MaxHP		40
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	24
+	VendorBuysFor	12
+	strrequired	10
+	repairable	1
+	MinDam		2
+	MaxDam		13
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0ec4
+{
+	Name		SkinningKnife
+	desc		skinning knife
+	Speed		40
+	Damage		1d5
+	Attribute	Swordsmanship
+	Anim		0x0009
+	MaxHP		35
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	VendorSellsFor	26
+	VendorBuysFor	13
+	strrequired	5
+	repairable	1
+	MinDam		1
+	MaxDam		4
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x13b3
+{
+	Name		Club
+	desc		club
+	Speed		40
+	Damage		4d5+4
+	Attribute	Macefighting
+	Anim		0x000b
+	MaxHP		35
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	27
+	VendorBuysFor	13
+	strrequired	10
+	MinDam		8
+	MaxDam		24
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0x0e87
+{
+	Name		Pitchfork
+	desc		pitchfork
+	Speed		45
+	Damage		4d4
+	Attribute	Fencing
+	Anim		0x000e
+	MaxHP		45
+	HitSound	0x23D
+	MissSound	0x23B
+	Anim		0xE
+	VendorSellsFor	25
+	VendorBuysFor	12
+	TwoHanded	1
+	strrequired	15
+	repairable	1
+	MinDam		4
+	MaxDam		16
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0x0df0
+{
+	Name		BlackStaff
+	desc		black staff
+	Speed		35
+	Damage		5d6+3
+	Attribute	Macefighting
+	Anim		0xD
+	HitSound	0x13C
+	MissSound	0x234
+	Anim		0xC
+	MaxHP		50
+	VendorSellsFor	27
+	VendorBuysFor	24
+	TwoHanded	1
+	strrequired	35
+	Anim		0x000d
+	MinDam		8
+	MaxDam		33
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x13f9
+{
+	Name		GnarledStaff
+	desc		gnarled staff
+	Speed		33
+	Damage		5d5+5
+	Attribute	Macefighting
+	Anim		0xC
+	MaxHP		40
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	24
+	VendorBuysFor	12
+	strrequired	20
+	TwoHanded	1
+	Anim		0x000d
+	MinDam		10
+	MaxDam		30
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0e8a
+{
+	Name		Quarterstaff
+	desc		quarterstaff
+	Speed		48
+	Damage		5d5+3
+	Attribute	Macefighting
+	Anim		0xC
+	MaxHP		45
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	30
+	VendorBuysFor	15
+	strrequired	30
+	TwoHanded	1
+	Anim		0x000d
+	MinDam		8
+	MaxDam		43
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+
+Weapon 0x0e81
+{
+	Name		ShepherdsCrook
+	desc		shepherd's crook
+	script		:herding:herd
+	Speed		30
+	Damage		3d4
+	Attribute	Macefighting
+	Anim		0xC
+	MaxHP		30
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	33
+	VendorBuysFor	24
+	strrequired	10
+	TwoHanded	1
+	Anim		0x000d
+	MinDam		2
+	MaxDam		8
+	equipscript	equip
+	unequipscript	unequip
+	controlscript	itemControl
+	destroyscript	destroy
+}
+############################
+#-----------------Newbie Equipment-------------------#
+############################
+Armor 0x988d
+{
+	Name		practiceshield
+	desc		wooden shield
+	Graphic		0x1b7a
+	AR		2
+	Newbie		1
+	MaxHP		10
+	strrequired	5
+	medloss		nomed
+}
+
+Weapon 0x988c
+{
+	Name		practicelongsword
+	desc		practice longsword
+	graphic		0x0F60
+	Speed		35
+	Damage		2d4
+	Attribute	Swordsmanship
+	Anim		0x0009
+	MaxHP		60
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	newbie		1
+	Anim		0x0009
+	repairable	0
+	MinDam		1
+	MaxDam		4
+	controlscript	itemControl
+}
+
+Weapon 0x988b
+{
+	Name		practicemace
+	desc		practice mace
+	graphic		0x0f5c
+	Speed		30
+	Damage		2d4
+	Attribute	Macefighting
+	Anim		0x000b
+	HitSound	0x13C
+	MissSound	0x234
+	MaxHP		50
+	newbie		1
+	repairable	0
+	MinDam		1
+	MaxDam		4
+	controlscript	itemControl
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0x988a
+{
+	Name		practicekryss
+	desc		practice kryss
+	graphic		0x1401
+	Speed		53
+	Damage		2d4
+	Attribute	Fencing
+	Anim		0x000a
+	MaxHP		60
+	Script		bladed
+	HitSound	0x23C
+	MissSound	0x23A
+	newbie		1
+	repairable	0
+	MinDam		1
+	MaxDam		4
+	controlscript	itemControl
+}
+
+Weapon 0x9889
+{
+	Name		practicebow
+	desc		practice bow
+	graphic		0x13B2
+	Speed		20
+	Damage		2d4
+	Attribute	Archery
+	Anim		0x12
+	Projectile	1
+	ProjectileType	0xf3f
+	ProjectileAnim	0xf42
+	ProjectileSound 0x235
+	MissSound	0x239
+	HitSound	0x235
+	MaxHP		45
+	newbie		1
+	TwoHanded	1
+	MinDam		1
+	MaxDam		4
+	controlscript	itemControl
+}
+
+Weapon 0x13e3
+{
+	Name		smithhammer
+	Default		1
+	Speed		30
+	Damage		6d3
+	Attribute	Macefighting
+	Anim		0x000b
+	MaxHP		60
+	Script		:blacksmithy:makeBlacksmithItems
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	24
+	VendorBuysFor	12
+	equipscript	:combat:equip
+	unequipscript	:combat:unequip
+	controlscript	:combat:itemControl
+	destroyscript	:combat:destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0x13e4
+{
+	Name		smithyhammer2
+	Default		1
+	Speed		30
+	Damage		6d3
+	Attribute	Macefighting
+	Anim		0x000b
+	MaxHP		60
+	Script		:blacksmithy:makeBlacksmithItems
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	24
+	VendorBuysFor	12
+	equipscript	:combat:equip
+	unequipscript	:combat:unequip
+	controlscript	:combat:itemControl
+	destroyscript	:combat:destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0xFB4
+{
+	Name		sledgehammer
+	Speed		25
+	Damage		4d6
+	Attribute	Macefighting
+	Anim		0x000b
+	MaxHP		80
+	Script		:blacksmithy:makeBlacksmithItems
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	36
+	VendorBuysFor	18
+	equipscript	:combat:equip
+	unequipscript	:combat:unequip
+	controlscript	:combat:itemControl
+	destroyscript	:combat:destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0xFB5
+{
+	Name		sledgehammer2
+	Speed		25
+	Damage		4d6
+	Attribute	Macefighting
+	Anim		0x000b
+	MaxHP		80
+	Script		:blacksmithy:makeBlacksmithItems
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	36
+	VendorBuysFor	18
+	equipscript	:combat:equip
+	unequipscript	:combat:unequip
+	controlscript	:combat:itemControl
+	destroyscript	:combat:destroy
+	CProp		OnHit a1:S15::combat:maceHit
+}
+
+Weapon 0xdf2
+{
+	Name		magicwand1
+	desc		wand
+	Weight		1
+	Speed		35
+	Damage		2d3
+	Attribute	Macefighting
+	Anim		0x000b
+	MaxHP		30
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	20
+	VendorBuysFor	8
+	controlscript	:combat:itemControl
+}
+
+Weapon 0xdf3
+{
+	Name		magicwand2
+	desc		wand
+	Weight		1
+	Speed		35
+	Damage		2d3
+	Attribute	Macefighting
+	Anim		0x000b
+	MaxHP		30
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	20
+	VendorBuysFor	8
+	controlscript	:combat:itemControl
+}
+
+Weapon 0xdf4
+{
+	Name		magicwand3
+	desc		wand
+	Weight		1
+	Speed		35
+	Damage		2d3
+	Attribute	Macefighting
+	Anim		0x000b
+	MaxHP		30
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	20
+	VendorBuysFor	8
+	controlscript	:combat:itemControl
+}
+
+Weapon 0xdf5
+{
+	Name		magicwand4
+	desc		wand
+	Weight		1
+	Speed		35
+	Damage		2d3
+	Attribute	Macefighting
+	Anim		0x000b
+	MaxHP		30
+	HitSound	0x13C
+	MissSound	0x234
+	VendorSellsFor	20
+	VendorBuysFor	8
+	controlscript	:combat:itemControl
+}
\ No newline at end of file

Added: trunk/096/pkg/systems/combat/old/maceHit.src
===================================================================
--- trunk/096/pkg/systems/combat/old/maceHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/maceHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,31 @@
+use uo;
+use util;
+use os;
+include ":attributes:attributes";
+
+program macehit(param)
+  var attacker := param[1];
+  var defender := param[2];
+  var armor := param[4];
+  var rawdamage := param[6];
+  SetObjProperty(defender, "TempDamage", rawdamage);
+  if((attacker.dead) || (defender.dead))
+    return;
+  endif
+  if(armor)
+    var admg := RandomInt(4) + 1;
+    if(armor.hp >admg)
+      armor.hp := armor.hp - admg;
+    else
+      DestroyItem(armor);
+    endif
+  endif
+  var sdr := RandomInt(3) + 3;
+  if(GetStamina(defender) >= sdr)
+    SetStamina(defender, GetStamina(defender) - sdr);
+  else
+    SetStamina(defender, 0);
+  endif
+endprogram
+
+   

Added: trunk/096/pkg/systems/combat/old/magicarmor.cfg
===================================================================
--- trunk/096/pkg/systems/combat/old/magicarmor.cfg	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/magicarmor.cfg	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,50 @@
+# $Id: magicarmor.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+#item spawned for loot must be in this file to have the possibility to be magic
+
+Group 1
+{
+    LeatherGorget		    1
+    LeatherSleeves		    1
+    LeatherGloves		    1
+    LeatherCap			    1
+    LeatherLeggings		    1
+    LeatherTunic		    1
+    LeatherTunic2		    1
+    StuddedGorget		    1
+    StuddedGloves		    1
+    StuddedSleeves		    1
+    StuddedLeggings		    1
+    StuddedTunic		    1
+    FemaleStudded		    1
+    FemaleLeather		    1
+    LeatherSkirt		    1
+    LeatherBustier		    1
+    StuddedBustier		    1
+    LeatherShorts		    1
+    ChainmailCoif		    1
+    ChainmailLeggings	    1
+    ChainmailTunic		    1
+    CloseHelm			    1
+    Helmet			        1
+    Bascinet			    1
+    NoseHelm			    1
+    PlateHelm			    1
+    BronzeShield		    1
+    Buckler			        1
+    KiteShield			    1
+    HeaterShield		    1
+    KiteShieldB1		    1
+    WoodenShield		    1
+    MetalShield			    1
+    RingmailTunic		    1
+    RingmailSleeves		    1
+    RingmailLeggings	    1
+    RingmailGloves		    1
+    PlatemailBreastplate    1
+    PlatemailArms		    1
+    PlatemailLegs		    1
+    PlatemailGorget		    1
+    PlatemailGloves         1
+}

Added: trunk/096/pkg/systems/combat/old/magiccloth.cfg
===================================================================
--- trunk/096/pkg/systems/combat/old/magiccloth.cfg	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/magiccloth.cfg	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,14 @@
+items 1
+{
+    Robe			    1
+    LeatherBoots		1
+    ThighBoots			1
+    silvernecklace      1
+    bracelet            1
+    earings             1
+    roundnecklace       1
+    longnecklace        1
+    ring                1
+    Cloak               1
+}
+

Added: trunk/096/pkg/systems/combat/old/magicweaps.cfg
===================================================================
--- trunk/096/pkg/systems/combat/old/magicweaps.cfg	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/magicweaps.cfg	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,49 @@
+# $Id: magicweaps.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+#item spawned for loot must be in this file to have the possibility to be magic
+
+items 1
+{
+    Longsword		1
+    WarAxe		    1
+    Bow			    1
+    Crossbow		1
+    HeavyCrossbow	1
+    Axe			    1
+    BattleAxe		1
+    DoubleAxe		1
+    ExecutionersAxe	1
+    LargeBattleAxe	1
+    TwoHandedAxe	1
+    HammerPick		1
+    Mace		    1
+    Maul		    1
+    WarHammer		1
+    WarMace		    1
+    Bardiche		1
+    Halberd		    1
+    ShortSpear		1
+    Spear		    1
+    WarFork		    1
+    BroadSword		1
+    Cutlass		    1
+    Dagger		    1
+    Katana		    1
+    Kryss		    1
+    Scimitar		1
+    VikingSword		1
+    Hatchet		    1
+    PickAxe		    1
+    ButcherKnife	1
+    Cleaver		    1
+    SkinningKnife	1
+    Club		    1
+    SmithyHammer	1
+    PitchFork		1
+    BlackStaff		1
+    GnarledStaff	1
+    QuarterStaff	1
+    ShepherdsCrook	1
+}
+

Added: trunk/096/pkg/systems/combat/old/mainHitScript.src
===================================================================
--- trunk/096/pkg/systems/combat/old/mainHitScript.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/mainHitScript.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,120 @@
+use uo;
+use os;
+use cfgfile;
+include "hitScriptInc";
+
+var npccfgfile := ReadConfigFile("::npcdesc");
+
+program MainHitScript(attacker, defender, weapon, armor, basedamage, rawdamage)
+  if(defender == attacker)
+    SendSysMessage(attacker, "No cheating!");
+    ApplyRawDamage(attacker, 1000);
+    return;
+  endif
+  if((defender.npctemplate == "townguard") or (defender.npctemplate == "playervendor"))
+    ApplyRawDamage(attacker, 1000);
+    return;
+  endif
+  if((attacker.npctemplate == "townguard") or (attacker.npctemplate == "playervendor"))
+    ApplyRawDamage(defender, 1000);
+    return;
+  endif
+  if(defender.isA(POLCLASS_NPC))
+    var damagedsound := CInt(npccfgfile[defender.npctemplate].damagedsound);
+    if(damagedsound)
+      PlaySoundEffect(defender, damagedsound);
+    endif
+    PerformAction(defender, 0xa);
+    basedamage := basedamage * 2;
+    rawdamage := rawdamage * 2;
+  else
+    if(attacker.acctname && defender.acctname)
+      basedamage := basedamage / 2;
+      rawdamage := rawdamage / 2;
+    endif
+  endif
+  if(attacker.npctemplate == "employee")
+    basedamage := basedamage / 2;
+    rawdamage := rawdamage / 2;
+  endif
+  SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon.name });
+  var shield := GetEquipmentByLayer(defender, 2);
+  if(shield)
+    var bd;
+    if(basedamage > 100)
+      bd := 100;
+    else
+      bd := basedamage;
+    endif
+    if(RandomInt(Cint(GetEffectiveSkill(defender, SKILLID_PARRY) / 2)) >= bd)
+      armor := shield;
+    endif
+  endif
+  var weaponhit := GetObjProperty(weapon, "OnHit");
+  if(weapon.hp > weapon.maxhp)
+    DestroyItem(weapon);
+    rawdamage := 0;
+  endif
+  var armorhit;
+  if(armor == 0)
+    armorhit := GetObjProperty(defender, "ArmorHit");
+  else
+    armorhit := GetObjProperty(armor, "ArmorHit");
+  endif
+  if(!weaponhit)
+    if(!armorhit)
+      run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
+      rawdamage := GetObjProperty(defender, "TempDamage");
+      if(GetObjProperty(weapon, "SilverHit"))
+        run_script_to_completion("silverHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
+        rawdamage := GetObjProperty(defender, "TempDamage");
+      endif
+      rawdamage := Cint(rawdamage + Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20));
+      if(rawdamage < 1)
+        rawdamage := 1;
+      endif
+      DealDamage(defender, attacker, rawdamage);
+      return;
+    else
+      SetObjProperty(defender, "TempDamage", rawdamage);
+      foreach x in armorhit
+        Detach();
+        run_script_to_completion(x, { attacker, defender, weapon, armor, basedamage, rawdamage } );
+        rawdamage := CInt(GetObjProperty(defender, "TempDamage") );
+      endforeach
+      run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
+      rawdamage := GetObjProperty(defender, "TempDamage");
+      EraseObjProperty(defender, "TempDamage");
+      if(GetObjProperty(weapon, "SilverHit"))
+        run_script_to_completion("silverHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
+        rawdamage := GetObjProperty(defender, "TempDamage");
+      endif
+      rawdamage := Cint(rawdamage + Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20));
+      if(rawdamage < 1)
+        rawdamage := 1;
+      endif
+      DealDamage(defender, attacker, rawdamage);
+      return;
+    endif
+  else
+    SetObjProperty(defender, "TempDamage", rawdamage);
+    foreach x in weaponhit
+      Detach();
+      run_script_to_completion(CStr(x), { attacker, defender, weapon, armor, basedamage, rawdamage } );
+      rawdamage := GetObjProperty(defender, "TempDamage");
+    endforeach
+    EraseObjProperty(defender, "TempDamage");
+    run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
+    rawdamage := GetObjProperty(defender, "TempDamage");
+    if(GetObjProperty(weapon, "SilverHit"))
+      run_script_to_completion("silverHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
+      rawdamage := GetObjProperty(defender, "TempDamage");
+    endif
+    rawdamage := Cint(rawdamage + Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20));
+    if(rawdamage < 1)
+      rawdamage := 1;
+    endif
+    DealDamage(defender, attacker, rawdamage);
+    return;
+  endif
+endprogram

Added: trunk/096/pkg/systems/combat/old/mobPoisonHit.src
===================================================================
--- trunk/096/pkg/systems/combat/old/mobPoisonHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/mobPoisonHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,31 @@
+use uo;
+use util;
+use os;
+use cfgfile;
+
+include "include/client";
+
+
+program poisonhit(param)
+  var attacker := param[1];
+  var defender := param[2];
+  var rawdamage := param[6];
+  SetObjProperty(defender, "TempDamage", rawdamage);
+  if((RandomInt(4)+1) == 1)
+    return;
+  endif
+  var level := GetObjProperty(attacker, "poison_strength");
+  if (!level)
+    level := 1;
+  endif
+  Detach();
+  foreach mobile in ListMobilesInLineOfSight(defender, 8)
+    if(mobile != defender)
+      PrintTextAbovePrivate(defender, defender.name + " has been poisoned!", mobile);
+    endif
+  endforeach
+  PrintTextAbovePrivate(defender, "You have been poisoned by " + attacker.name +"!", defender);
+  var passparms := { defender, attacker, "poisoned weapon", level};
+  SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, "poisoned weapon" });
+  start_script(":spells:poisonDamage", passparms);
+endprogram

Added: trunk/096/pkg/systems/combat/old/pkg.cfg
===================================================================
--- trunk/096/pkg/systems/combat/old/pkg.cfg	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/pkg.cfg	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,8 @@
+# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+Enabled		1
+Name		combat
+Maintainer	Distro Team
+Email		distro at polserver.com
+Version		1.0
\ No newline at end of file

Added: trunk/096/pkg/systems/combat/old/poisonHit.src
===================================================================
--- trunk/096/pkg/systems/combat/old/poisonHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/poisonHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,50 @@
+use uo;
+use util;
+use os;
+use cfgfile;
+
+include "include/client";
+include ":attributes:attributes";
+
+program poisonhit(param)
+  var attacker := param[1];
+  var defender := param[2];
+  var weapon := param[3];
+  var rawdamage := param[6];
+  SetObjProperty(defender, "TempDamage", rawdamage);
+  var duration := CInt(GetObjProperty(weapon, "d"));
+  if((duration < 1) || !duration)
+    var hitscript := GetObjProperty(weapon,"OnHit");
+    var holder := array;
+    foreach thing in hitscript
+      if(thing != ":combat:poisonHit")
+        holder.append(thing);
+      endif
+    endforeach
+    if(len(holder))
+      SetObjProperty(weapon,"OnHit", holder);
+    else
+      EraseObjProperty(weapon, "OnHit");
+    endif
+    EraseObjProperty(weapon,"poison_level");
+    EraseObjProperty(weapon,"d");
+    EraseObjProperty(weapon,"ps");
+    SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon });
+    return;
+  else
+    duration := duration - 1;
+    SetObjProperty(weapon, "d", duration);
+    var level := GetObjProperty(weapon, "poison_level");
+    if(CheckSkill(attacker, SKILLID_POISONING, 20, 20))
+      foreach mobile in ListMobilesInLineOfSight(defender, 8)
+        if(mobile != defender)
+          PrintTextAbovePrivate(defender, defender.name + " has been poisoned!", mobile);
+        endif
+      endforeach
+      PrintTextAbovePrivate(defender, "You have been poisoned by " + attacker.name +"!", defender);
+      var passparms := { defender, attacker, "poisoned weapon", level};
+      SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, "poisoned weapon" });
+      start_script(":spells:poisonDamage", passparms);
+    endif
+  endif
+endprogram

Added: trunk/096/pkg/systems/combat/old/reactiveArmorHit.src
===================================================================
--- trunk/096/pkg/systems/combat/old/reactiveArmorHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/reactiveArmorHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,29 @@
+use uo;
+use util;
+use os;
+
+program reactivearmorhit(param)
+  var attacker := param[1];
+  var defender := param[2];
+  var rawdamage := param[6];
+  if((attacker.dead) || (defender.dead))
+    return;
+  endif
+  var charges := CInt(GetObjProperty(defender, "ReactiveArmor") );
+  if(!charges)
+    SetObjProperty(defender, "TempDamage", rawdamage);
+    return;
+  endif
+  charges := charges - 1;
+  if(charges == 0)
+    EraseObjProperty(defender, "ReactiveArmor");
+  else
+    SetObjProperty(defender, "ReactiveArmor", charges);
+  endif
+  PlayObjectCenteredEffect(attacker, 0x374a, 10,10);
+  PlaySoundEffect(attacker, 0x1f2);
+  rawdamage := CInt((rawdamage *3) / 4);
+  var newdamage := CInt(rawdamage / 4);
+  ApplyRawDamage(attacker, newdamage);
+  SetObjProperty(defender, "TempDamage", rawdamage);
+endprogram

Added: trunk/096/pkg/systems/combat/old/setWeaponHit.src
===================================================================
--- trunk/096/pkg/systems/combat/old/setWeaponHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/setWeaponHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,5 @@
+program setweaponhit(wpn)
+
+    wpn.hitscript := "mainHitScript";
+
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/systems/combat/old/silverHit.src
===================================================================
--- trunk/096/pkg/systems/combat/old/silverHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/silverHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,25 @@
+use uo;
+use util;
+use os;
+use cfgfile;
+
+program macehit(param)
+  var attacker := param[1];
+  var defender := param[2];
+  var rawdamage := param[6];
+  if((attacker.dead) || (defender.dead))
+    return;
+  endif
+  if(!defender.isA(POLCLASS_NPC))
+    SetObjProperty(defender, "TempDamage", rawdamage);
+    return;
+  endif
+  var cfg := ReadConfigFile("::npcdesc");
+  var undead := cfg[defender.npctemplate].elemental;
+  if(undead == "undead")
+    rawdamage := rawdamage * 2;
+  endif
+  SetObjProperty(defender, "TempDamage", rawdamage);
+endprogram
+
+   

Added: trunk/096/pkg/systems/combat/old/unequip.src
===================================================================
--- trunk/096/pkg/systems/combat/old/unequip.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/unequip.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,108 @@
+use uo;
+use os;
+use cfgfile;
+
+include "include/client";
+include ":attributes:attributes";
+
+const EVID_UNEQUIP   := 0x123456;
+const EVID_DISCHARGE := 0x123457;
+
+program unequipweapon(who, item)
+  set_critical(1);
+  var itemdesc := ReadConfigFile("itemdesc");
+  var penalty := CInt(itemdesc[item.objtype].DexPenalty);
+  if(penalty)
+    EraseObjProperty(item, "#equipped");
+    SetDexterityMod(who, GetDexterityMod(who) + penalty);
+  endif
+  var type := GetObjProperty(item,"type");
+  var val := 0;
+  case(type)
+    "accuracy":     val := accuracy(who,item);
+    "cursed":       val := cursed(who,item);
+    "sight":        val := sight(who,item);
+    "reflect":      val := reflect(who,item);
+    "protection":   val := protection(who,item);
+    "wizzohat":     val := wizzohat(who,item);
+    "strength":     val := strength(who,item);
+    "invisibility": val := invisibility(who, item);
+    default:        val := 1;
+  endcase
+  return val;
+  set_critical(0);
+endprogram
+
+function strength(who,item)
+  RemoveMods(who, item);
+  return 1;
+endfunction
+
+function wizzohat(who,item)
+  SetIntelligenceMod(who, GetIntelligenceMod(who) - 10);
+  SetStrengthMod(who, GetStrengthMod(who) + 5);
+  SetDexterityMod(who, GetDexterityMod(who) + 5);
+  EraseObjProperty(item, "#equipped");
+  return 1;
+endfunction
+
+function cursed(who,item)
+  who := who;
+  item := item;
+  return 0;
+endfunction
+
+function invisibility(who,item)
+  RemoveMods(who, item);
+  return 1;
+endfunction
+
+function sight(who,item)
+  RemoveMods(who, item);
+  return 1;
+endfunction
+
+function reflect(who,item)
+  RemoveMods(who, item);
+  return 1;
+endfunction
+
+function accuracy(who,item)
+  if(GetObjProperty(item, "#equipped") == who.serial)
+    var amt := CInt(GetObjProperty(item,"gain"));
+    amt := (0 - amt);
+    if((!amt) || (amt == 0))
+      amt := (0 - 5);
+    endif
+    var cfg := ReadConfigFile(":combat:itemdesc");
+    var attrib := cfg[item.objtype].Attribute;
+    case(attrib)
+      "Wrestling": ModifyAttributeTemporaryMod(who, ATTRIBUTEID_WRESTLING,     amt);
+      "Fencing":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_FENCING,       amt);
+      "Archery":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_ARCHERY,       amt);
+      "Swords":    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_SWORDSMANSHIP, amt);
+      "Mace":      ModifyAttributeTemporaryMod(who, ATTRIBUTEID_MACEFIGHTING,  amt);
+    endcase
+    EraseObjProperty(item, "#equipped");
+    return 1;
+  else
+    return 1;
+  endif
+
+endfunction
+
+function protection(who,item)
+  RemoveMods(who, item);
+  return 1;
+endfunction
+
+function RemoveMods(who, item)
+  who := who;
+  var proc := GetProcess(Cint(GetObjProperty(item, "Pid")));
+  if(proc)
+    var ev := {};
+    ev.+type := EVID_UNEQUIP;
+    proc.sendevent(ev);
+  endif
+  EraseObjProperty(item, "#equipped");
+endfunction

Added: trunk/096/pkg/systems/combat/old/vortexHit.src
===================================================================
--- trunk/096/pkg/systems/combat/old/vortexHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/vortexHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,30 @@
+use uo;
+use util;
+use os;
+
+include ":attributes:attributes";
+
+
+program vortexHit(param)
+	var attacker := param[1];
+	var defender := param[2];
+	//var basedamage := param[5];
+	var rawdamage := param[6];
+
+	if((attacker.dead) || (defender.dead))
+		return;
+	endif
+
+	var dmg := RandomInt(CInt(GetIntelligence(defender) / 10));
+	
+	if(dmg > 40)
+		dmg := 12;
+	elseif(dmg < 2)
+		dmg := 2;
+	endif
+	rawdamage := rawdamage + dmg;
+	SetObjProperty(defender, "TempDamage", rawdamage);
+
+	return;
+endprogram
+

Added: trunk/096/pkg/systems/combat/old/wrestleControl.src
===================================================================
--- trunk/096/pkg/systems/combat/old/wrestleControl.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/wrestleControl.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,15 @@
+use uo;
+use os;
+use cfgfile;
+
+
+program itemcontrol(item)
+	var cfgfile := ReadConfigFile(":combat:itemdesc");
+	var dmg := cfgfile[item.objtype].damage;
+
+	if(dmg)
+		item.hitscript := "wrestlingHitScript";
+	endif
+
+	return;
+endprogram

Added: trunk/096/pkg/systems/combat/old/wrestlingHitScript.src
===================================================================
--- trunk/096/pkg/systems/combat/old/wrestlingHitScript.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/old/wrestlingHitScript.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -0,0 +1,109 @@
+use cfgfile;
+use os;
+use uo;
+
+include "hitScriptInc";
+
+var npccfgfile := ReadConfigFile("::npcdesc");
+
+
+program WrestlingHitScript(attacker, defender, weapon, armor, basedamage, rawdamage)
+  if(defender == attacker)
+    SendSysMessage(attacker, "No cheating!");
+    ApplyRawDamage(attacker, 1000);
+    return;
+  endif
+  if((attacker.npctemplate == "townguard") or (attacker.npctemplate == "playervendor"))
+    ApplyRawDamage(defender, 1000);
+    return;
+  endif
+  if(defender.isA(POLCLASS_NPC))
+    var damagedsound := CInt(npccfgfile[defender.npctemplate].damagedsound);
+    if(damagedsound)
+      PlaySoundEffect(defender, damagedsound);
+    endif
+    PerformAction(defender, 0xa);
+    basedamage := basedamage * 2;
+    rawdamage := rawdamage * 2;
+  else
+    if(attacker.acctname && defender.acctname)
+      basedamage := basedamage / 2;
+      rawdamage := rawdamage / 2;
+    endif
+  endif
+  var shield := GetEquipmentByLayer(defender, 2);
+  if(shield)
+    var bd;
+    if(basedamage > 100)
+      bd := 100;
+    else
+      bd := basedamage;
+    endif
+    if(RandomInt(Cint(GetEffectiveSkill(defender, SKILLID_PARRY) / 2)) >= bd)
+      armor := shield;
+    endif
+  endif
+  var weaponhit := GetObjProperty(attacker, "OnHit");
+  var armorhit;
+  if (armor == 0)
+    armorhit := GetObjProperty(defender, "ArmorHit");
+  else
+    armorhit := GetObjProperty(armor, "ArmorHit");
+  endif
+  var anat;
+  if (!weaponhit)
+    if (!armorhit)
+      run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
+      rawdamage := GetObjProperty(defender, "TempDamage");
+      if(rawdamage < 1)
+        rawdamage := 1;
+      endif
+      anat := Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20);
+      rawdamage := Cint(rawdamage + anat);
+      DealDamage(defender, attacker, rawdamage);
+      SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon });
+      return;
+    else
+      SetObjProperty(defender, "TempDamage", rawdamage);
+      foreach x in armorhit
+        Detach();
+        set_critical(0);
+        run_script_to_completion(x, { attacker, defender, weapon, armor, basedamage, rawdamage } );
+        rawdamage := CInt(GetObjProperty(defender, "TempDamage") );
+      endforeach
+      EraseObjProperty(defender, "TempDamage");
+      run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
+      rawdamage := GetObjProperty(defender, "TempDamage");
+      if(rawdamage < 1)
+        rawdamage := 1;
+      endif
+      anat := Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20);
+      rawdamage := Cint(rawdamage + anat);
+      DealDamage(defender, attacker, rawdamage);
+      SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon });
+      return;
+    endif
+  else
+    SetObjProperty(defender, "TempDamage", rawdamage);
+    foreach x in weaponhit
+      Detach();
+      set_critical(0);
+      run_script_to_completion(CStr(x), { attacker, defender, weapon, armor, basedamage, rawdamage } );
+      rawdamage := GetObjProperty(defender, "TempDamage");
+    endforeach
+    EraseObjProperty(defender, "TempDamage");
+    if (rawdamage < 1)
+      rawdamage := 1;
+    endif
+    run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
+    rawdamage := GetObjProperty(defender, "TempDamage");
+    if(rawdamage < 1)
+      rawdamage := 1;
+    endif
+    anat := Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20);
+    rawdamage := Cint(rawdamage + anat);
+    DealDamage(defender, attacker, rawdamage);
+    SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon});
+    return;
+  endif
+endprogram

Deleted: trunk/096/pkg/systems/combat/poisonHit.src
===================================================================
--- trunk/096/pkg/systems/combat/poisonHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/poisonHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,50 +0,0 @@
-use uo;
-use util;
-use os;
-use cfgfile;
-
-include "include/client";
-include ":attributes:attributes";
-
-program poisonhit(param)
-  var attacker := param[1];
-  var defender := param[2];
-  var weapon := param[3];
-  var rawdamage := param[6];
-  SetObjProperty(defender, "TempDamage", rawdamage);
-  var duration := CInt(GetObjProperty(weapon, "d"));
-  if((duration < 1) || !duration)
-    var hitscript := GetObjProperty(weapon,"OnHit");
-    var holder := array;
-    foreach thing in hitscript
-      if(thing != ":combat:poisonHit")
-        holder.append(thing);
-      endif
-    endforeach
-    if(len(holder))
-      SetObjProperty(weapon,"OnHit", holder);
-    else
-      EraseObjProperty(weapon, "OnHit");
-    endif
-    EraseObjProperty(weapon,"poison_level");
-    EraseObjProperty(weapon,"d");
-    EraseObjProperty(weapon,"ps");
-    SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon });
-    return;
-  else
-    duration := duration - 1;
-    SetObjProperty(weapon, "d", duration);
-    var level := GetObjProperty(weapon, "poison_level");
-    if(CheckSkill(attacker, SKILLID_POISONING, 20, 20))
-      foreach mobile in ListMobilesInLineOfSight(defender, 8)
-        if(mobile != defender)
-          PrintTextAbovePrivate(defender, defender.name + " has been poisoned!", mobile);
-        endif
-      endforeach
-      PrintTextAbovePrivate(defender, "You have been poisoned by " + attacker.name +"!", defender);
-      var passparms := { defender, attacker, "poisoned weapon", level};
-      SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, "poisoned weapon" });
-      start_script(":spells:poisonDamage", passparms);
-    endif
-  endif
-endprogram

Deleted: trunk/096/pkg/systems/combat/reactiveArmorHit.src
===================================================================
--- trunk/096/pkg/systems/combat/reactiveArmorHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/reactiveArmorHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,29 +0,0 @@
-use uo;
-use util;
-use os;
-
-program reactivearmorhit(param)
-  var attacker := param[1];
-  var defender := param[2];
-  var rawdamage := param[6];
-  if((attacker.dead) || (defender.dead))
-    return;
-  endif
-  var charges := CInt(GetObjProperty(defender, "ReactiveArmor") );
-  if(!charges)
-    SetObjProperty(defender, "TempDamage", rawdamage);
-    return;
-  endif
-  charges := charges - 1;
-  if(charges == 0)
-    EraseObjProperty(defender, "ReactiveArmor");
-  else
-    SetObjProperty(defender, "ReactiveArmor", charges);
-  endif
-  PlayObjectCenteredEffect(attacker, 0x374a, 10,10);
-  PlaySoundEffect(attacker, 0x1f2);
-  rawdamage := CInt((rawdamage *3) / 4);
-  var newdamage := CInt(rawdamage / 4);
-  ApplyRawDamage(attacker, newdamage);
-  SetObjProperty(defender, "TempDamage", rawdamage);
-endprogram

Deleted: trunk/096/pkg/systems/combat/setWeaponHit.src
===================================================================
--- trunk/096/pkg/systems/combat/setWeaponHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/setWeaponHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,5 +0,0 @@
-program setweaponhit(wpn)
-
-    wpn.hitscript := "mainHitScript";
-
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/systems/combat/silverHit.src
===================================================================
--- trunk/096/pkg/systems/combat/silverHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/silverHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,25 +0,0 @@
-use uo;
-use util;
-use os;
-use cfgfile;
-
-program macehit(param)
-  var attacker := param[1];
-  var defender := param[2];
-  var rawdamage := param[6];
-  if((attacker.dead) || (defender.dead))
-    return;
-  endif
-  if(!defender.isA(POLCLASS_NPC))
-    SetObjProperty(defender, "TempDamage", rawdamage);
-    return;
-  endif
-  var cfg := ReadConfigFile("::npcdesc");
-  var undead := cfg[defender.npctemplate].elemental;
-  if(undead == "undead")
-    rawdamage := rawdamage * 2;
-  endif
-  SetObjProperty(defender, "TempDamage", rawdamage);
-endprogram
-
-   

Deleted: trunk/096/pkg/systems/combat/unequip.src
===================================================================
--- trunk/096/pkg/systems/combat/unequip.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/unequip.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,108 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-include "include/client";
-include ":attributes:attributes";
-
-const EVID_UNEQUIP   := 0x123456;
-const EVID_DISCHARGE := 0x123457;
-
-program unequipweapon(who, item)
-  set_critical(1);
-  var itemdesc := ReadConfigFile("itemdesc");
-  var penalty := CInt(itemdesc[item.objtype].DexPenalty);
-  if(penalty)
-    EraseObjProperty(item, "#equipped");
-    SetDexterityMod(who, GetDexterityMod(who) + penalty);
-  endif
-  var type := GetObjProperty(item,"type");
-  var val := 0;
-  case(type)
-    "accuracy":     val := accuracy(who,item);
-    "cursed":       val := cursed(who,item);
-    "sight":        val := sight(who,item);
-    "reflect":      val := reflect(who,item);
-    "protection":   val := protection(who,item);
-    "wizzohat":     val := wizzohat(who,item);
-    "strength":     val := strength(who,item);
-    "invisibility": val := invisibility(who, item);
-    default:        val := 1;
-  endcase
-  return val;
-  set_critical(0);
-endprogram
-
-function strength(who,item)
-  RemoveMods(who, item);
-  return 1;
-endfunction
-
-function wizzohat(who,item)
-  SetIntelligenceMod(who, GetIntelligenceMod(who) - 10);
-  SetStrengthMod(who, GetStrengthMod(who) + 5);
-  SetDexterityMod(who, GetDexterityMod(who) + 5);
-  EraseObjProperty(item, "#equipped");
-  return 1;
-endfunction
-
-function cursed(who,item)
-  who := who;
-  item := item;
-  return 0;
-endfunction
-
-function invisibility(who,item)
-  RemoveMods(who, item);
-  return 1;
-endfunction
-
-function sight(who,item)
-  RemoveMods(who, item);
-  return 1;
-endfunction
-
-function reflect(who,item)
-  RemoveMods(who, item);
-  return 1;
-endfunction
-
-function accuracy(who,item)
-  if(GetObjProperty(item, "#equipped") == who.serial)
-    var amt := CInt(GetObjProperty(item,"gain"));
-    amt := (0 - amt);
-    if((!amt) || (amt == 0))
-      amt := (0 - 5);
-    endif
-    var cfg := ReadConfigFile(":combat:itemdesc");
-    var attrib := cfg[item.objtype].Attribute;
-    case(attrib)
-      "Wrestling": ModifyAttributeTemporaryMod(who, ATTRIBUTEID_WRESTLING,     amt);
-      "Fencing":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_FENCING,       amt);
-      "Archery":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_ARCHERY,       amt);
-      "Swords":    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_SWORDSMANSHIP, amt);
-      "Mace":      ModifyAttributeTemporaryMod(who, ATTRIBUTEID_MACEFIGHTING,  amt);
-    endcase
-    EraseObjProperty(item, "#equipped");
-    return 1;
-  else
-    return 1;
-  endif
-
-endfunction
-
-function protection(who,item)
-  RemoveMods(who, item);
-  return 1;
-endfunction
-
-function RemoveMods(who, item)
-  who := who;
-  var proc := GetProcess(Cint(GetObjProperty(item, "Pid")));
-  if(proc)
-    var ev := {};
-    ev.+type := EVID_UNEQUIP;
-    proc.sendevent(ev);
-  endif
-  EraseObjProperty(item, "#equipped");
-endfunction

Deleted: trunk/096/pkg/systems/combat/vortexHit.src
===================================================================
--- trunk/096/pkg/systems/combat/vortexHit.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/vortexHit.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,30 +0,0 @@
-use uo;
-use util;
-use os;
-
-include ":attributes:attributes";
-
-
-program vortexHit(param)
-	var attacker := param[1];
-	var defender := param[2];
-	//var basedamage := param[5];
-	var rawdamage := param[6];
-
-	if((attacker.dead) || (defender.dead))
-		return;
-	endif
-
-	var dmg := RandomInt(CInt(GetIntelligence(defender) / 10));
-	
-	if(dmg > 40)
-		dmg := 12;
-	elseif(dmg < 2)
-		dmg := 2;
-	endif
-	rawdamage := rawdamage + dmg;
-	SetObjProperty(defender, "TempDamage", rawdamage);
-
-	return;
-endprogram
-

Deleted: trunk/096/pkg/systems/combat/wrestleControl.src
===================================================================
--- trunk/096/pkg/systems/combat/wrestleControl.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/wrestleControl.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,15 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-
-program itemcontrol(item)
-	var cfgfile := ReadConfigFile(":combat:itemdesc");
-	var dmg := cfgfile[item.objtype].damage;
-
-	if(dmg)
-		item.hitscript := "wrestlingHitScript";
-	endif
-
-	return;
-endprogram

Deleted: trunk/096/pkg/systems/combat/wrestlingHitScript.src
===================================================================
--- trunk/096/pkg/systems/combat/wrestlingHitScript.src	2005-11-01 22:50:10 UTC (rev 814)
+++ trunk/096/pkg/systems/combat/wrestlingHitScript.src	2005-11-02 03:37:45 UTC (rev 815)
@@ -1,109 +0,0 @@
-use cfgfile;
-use os;
-use uo;
-
-include "hitScriptInc";
-
-var npccfgfile := ReadConfigFile("::npcdesc");
-
-
-program WrestlingHitScript(attacker, defender, weapon, armor, basedamage, rawdamage)
-  if(defender == attacker)
-    SendSysMessage(attacker, "No cheating!");
-    ApplyRawDamage(attacker, 1000);
-    return;
-  endif
-  if((attacker.npctemplate == "townguard") or (attacker.npctemplate == "playervendor"))
-    ApplyRawDamage(defender, 1000);
-    return;
-  endif
-  if(defender.isA(POLCLASS_NPC))
-    var damagedsound := CInt(npccfgfile[defender.npctemplate].damagedsound);
-    if(damagedsound)
-      PlaySoundEffect(defender, damagedsound);
-    endif
-    PerformAction(defender, 0xa);
-    basedamage := basedamage * 2;
-    rawdamage := rawdamage * 2;
-  else
-    if(attacker.acctname && defender.acctname)
-      basedamage := basedamage / 2;
-      rawdamage := rawdamage / 2;
-    endif
-  endif
-  var shield := GetEquipmentByLayer(defender, 2);
-  if(shield)
-    var bd;
-    if(basedamage > 100)
-      bd := 100;
-    else
-      bd := basedamage;
-    endif
-    if(RandomInt(Cint(GetEffectiveSkill(defender, SKILLID_PARRY) / 2)) >= bd)
-      armor := shield;
-    endif
-  endif
-  var weaponhit := GetObjProperty(attacker, "OnHit");
-  var armorhit;
-  if (armor == 0)
-    armorhit := GetObjProperty(defender, "ArmorHit");
-  else
-    armorhit := GetObjProperty(armor, "ArmorHit");
-  endif
-  var anat;
-  if (!weaponhit)
-    if (!armorhit)
-      run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-      rawdamage := GetObjProperty(defender, "TempDamage");
-      if(rawdamage < 1)
-        rawdamage := 1;
-      endif
-      anat := Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20);
-      rawdamage := Cint(rawdamage + anat);
-      DealDamage(defender, attacker, rawdamage);
-      SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon });
-      return;
-    else
-      SetObjProperty(defender, "TempDamage", rawdamage);
-      foreach x in armorhit
-        Detach();
-        set_critical(0);
-        run_script_to_completion(x, { attacker, defender, weapon, armor, basedamage, rawdamage } );
-        rawdamage := CInt(GetObjProperty(defender, "TempDamage") );
-      endforeach
-      EraseObjProperty(defender, "TempDamage");
-      run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-      rawdamage := GetObjProperty(defender, "TempDamage");
-      if(rawdamage < 1)
-        rawdamage := 1;
-      endif
-      anat := Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20);
-      rawdamage := Cint(rawdamage + anat);
-      DealDamage(defender, attacker, rawdamage);
-      SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon });
-      return;
-    endif
-  else
-    SetObjProperty(defender, "TempDamage", rawdamage);
-    foreach x in weaponhit
-      Detach();
-      set_critical(0);
-      run_script_to_completion(CStr(x), { attacker, defender, weapon, armor, basedamage, rawdamage } );
-      rawdamage := GetObjProperty(defender, "TempDamage");
-    endforeach
-    EraseObjProperty(defender, "TempDamage");
-    if (rawdamage < 1)
-      rawdamage := 1;
-    endif
-    run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-    rawdamage := GetObjProperty(defender, "TempDamage");
-    if(rawdamage < 1)
-      rawdamage := 1;
-    endif
-    anat := Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20);
-    rawdamage := Cint(rawdamage + anat);
-    DealDamage(defender, attacker, rawdamage);
-    SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon});
-    return;
-  endif
-endprogram



From austin at berlios.de  Wed Nov  2 04:44:10 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 04:44:10 +0100
Subject: [Poldistro-svn] r816 - trunk/096/pkg/systems/combat/old
Message-ID: <200511020344.jA23iA6V007059@sheep.berlios.de>

Author: austin
Date: 2005-11-02 04:44:09 +0100 (Wed, 02 Nov 2005)
New Revision: 816

Removed:
   trunk/096/pkg/systems/combat/old/pkg.cfg
Log:


Deleted: trunk/096/pkg/systems/combat/old/pkg.cfg
===================================================================
--- trunk/096/pkg/systems/combat/old/pkg.cfg	2005-11-02 03:37:45 UTC (rev 815)
+++ trunk/096/pkg/systems/combat/old/pkg.cfg	2005-11-02 03:44:09 UTC (rev 816)
@@ -1,8 +0,0 @@
-# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
-#
-#
-Enabled		1
-Name		combat
-Maintainer	Distro Team
-Email		distro at polserver.com
-Version		1.0
\ No newline at end of file



From austin at berlios.de  Wed Nov  2 05:00:35 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 05:00:35 +0100
Subject: [Poldistro-svn] r817 - in trunk/096/pkg/systems/combat: . config include
Message-ID: <200511020400.jA240ZnC009503@sheep.berlios.de>

Author: austin
Date: 2005-11-02 05:00:32 +0100 (Wed, 02 Nov 2005)
New Revision: 817

Added:
   trunk/096/pkg/systems/combat/config/settings.cfg
   trunk/096/pkg/systems/combat/include/settings.inc
   trunk/096/pkg/systems/combat/mainHitScript.src
Log:
Updated combat system. Lotta config settings to make it more customizable per shard.

Added: trunk/096/pkg/systems/combat/config/settings.cfg
===================================================================
--- trunk/096/pkg/systems/combat/config/settings.cfg	2005-11-02 03:44:09 UTC (rev 816)
+++ trunk/096/pkg/systems/combat/config/settings.cfg	2005-11-02 04:00:32 UTC (rev 817)
@@ -0,0 +1,31 @@
+Elem	General
+{
+	GainWait	25	// Seconds between gain checks.
+	PvPGains	1	// Players can gain from PvP. 0 - No. 1 - Yes.
+}
+
+Elem	Weapons
+{
+	WearChance	5	// % chance on hit the weapon wears down.
+	WearRate	0.99	// Quality = (Quality * WearRate)
+}
+
+Elem	Armor
+{
+	DmgToWear	15	// % of armor piece's hit points the damage must be to wear it down.
+	WearChance	65	// % chance armor wears down when hit.
+	WearRate	0.99	// Quality = ( Quality * WearRate)
+}
+
+Elem	Parry
+{
+	ParryRoll	1.0	// RandomFloat(ParryRoll) must be < (ParrySkill / ParryDivisor)
+	ParryDivisor	200	// Divisor used with the defender's parry skill.
+	WearChance	80	// % Chance the shield wears down when hit.
+	WearRate	0.97	// Quality = (Quality * WearRate)
+}
+
+Elem	Archery
+{
+	RecoverChance	70	// Chance an arrow will be created in an npc's pack when it is hit.
+}

Added: trunk/096/pkg/systems/combat/include/settings.inc
===================================================================
--- trunk/096/pkg/systems/combat/include/settings.inc	2005-11-02 03:44:09 UTC (rev 816)
+++ trunk/096/pkg/systems/combat/include/settings.inc	2005-11-02 04:00:32 UTC (rev 817)
@@ -0,0 +1,58 @@
+/* 
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+use cfgfile;
+
+/*
+ * CS_GetSettingsCfgFile(engine_name)
+ *
+ * Purpose
+ * Reads in :attributes:configs/settings.cfg
+ *
+ * Parameters
+ *
+ * Return value
+ * A config file reference.
+ *
+ */
+function CS_GetSettingsCfgFile()
+	var cfg := ReadConfigFile(":combat:config/settings");
+
+	if ( cfg.errortext )
+		SysLog("Error::CS_GetSettingsCfgFile() - Unable to open [:combat:config/settings.cfg] ->"+cfg.errortext);
+	endif
+
+	return cfg;
+endfunction
+
+/*
+ * CS_GetSettingsCfgElem(elem_name, cfg_file)
+ *
+ * Purpose
+ * Retrieves an elem from a config file. 
+ *
+ * Parameters
+ * elem_name:	A string matching the elem name to be retrieved.
+ * cfg_file:	Optional parameter - reference to a config already read in by CS_GetSettingsCfgFile()
+ *
+ * Return value
+ * A config file elem reference.
+ *
+ */
+function CS_GetSettingsCfgElem(elem_name, byref cfg_file:=0)
+	if ( !cfg_file )
+		cfg_file := CS_GetSettingsCfgFile();
+	endif
+	
+	var elem := cfg_file[elem_name];
+
+	if ( elem.errortext )
+		SysLog("Error::CS_GetSettingsCfgElem() - Unable to find elem ["+elem_name+"] ->"+elem.errortext);
+	endif
+
+	return elem;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/systems/combat/mainHitScript.src
===================================================================
--- trunk/096/pkg/systems/combat/mainHitScript.src	2005-11-02 03:44:09 UTC (rev 816)
+++ trunk/096/pkg/systems/combat/mainHitScript.src	2005-11-02 04:00:32 UTC (rev 817)
@@ -0,0 +1,256 @@
+/*
+ * $Id
+ *
+ */
+use uo;
+use os;
+use cfgfile;
+
+include ":attributes:attributes";
+include ":brainai:npcUtil";
+include ":blood:blood";
+include ":combat:settings";
+include ":timedscripts:timedScripts";
+include "include/client";
+
+var item_cfg := ReadConfigFile(":*:itemdesc");
+
+program MainHitScript(attacker, defender, weapon, armor, basedamage, rawdamage)
+	//
+	// Cheat checker
+	//
+	if ( attacker == defender )
+		ApplyRawDamage(attacker, 1000);
+	elseif ( attacker.hidden || defender.hidden )
+		return 0;
+	elseif ( !attacker.npctemplate )
+		if ( !attacker.warmode )
+			basedamage := CInt(basedamage/2);
+			rawdamage := CInt(rawdamage/2);
+		endif
+	endif
+	
+	PlayHitSounds(defender);
+	SkillChecks(attacker, defender, weapon, armor, basedamage, rawdamage);
+	ArrowRecovery(attacker, defender, weapon);
+	ParryCheck(attacker, defender, weapon, armor, basedamage, rawdamage);
+	WearDownWeapon(attacker, defender, weapon, armor, basedamage, rawdamage);
+	WearDownArmor(attacker, defender, weapon, armor, basedamage, rawdamage);
+	DamageInfo(attacker, defender, weapon, armor, basedamage, rawdamage);
+	WeaponHitScripts(attacker, defender, weapon, armor, basedamage, rawdamage);
+	ArmorHitScripts(attacker, defender, weapon, armor, basedamage, rawdamage);
+	PoisonChecks(attacker, defender, weapon, armor, basedamage, rawdamage);
+	
+	var hostiles := ListHostiles(defender, 1);
+	rawdamage := rawdamage+CInt(hostiles.size()/2);
+	hostiles := 0;
+	//
+	// Apply the damage to the defender
+	// Base = prearmor
+	// Raw = post armor
+	//
+	if ( rawdamage > 0 )
+		ApplyRawDamage(defender, CInt(rawdamage));
+		MakeBleed(defender);
+	endif
+endprogram
+
+function PlayHitSounds(defender)
+	if ( defender.IsA(POLCLASS_NPC) )
+		var damaged_sound := NPC_GetNPCConfig(defender).DamagedSound;
+		if ( damaged_sound )
+			PlaySoundEffect(defender, damaged_sound);
+		endif
+	endif
+endfunction
+
+function SkillChecks(attacker, defender, weapon, armor, basedamage, rawdamage)
+	var can_gain := 0;
+	var next_gain := CInt(GetObjProperty(attacker, "#CHGainTime"));
+	if ( ReadGameClock() >= next_gain )
+		if ( CS_GetSettingsCfgElem("General").PvPGains )
+			can_gain := 1;
+		elseif ( defender.IsA(POLCLASS_NPC) )
+			can_gain := 1;
+		endif
+	endif
+	
+	if ( can_gain )
+		var gain_wait := CInt(CS_GetSettingsCfgElem("General").GainWait);
+		SetObjProperty(attacker, "#CHGainTime", ReadGameClock()+gain_wait);
+		if ( rawdamage > 0 )
+			SkillCheck(attacker, weapon.attribute, -1);
+			SkillCheck(attacker, "Tactics", -1);
+		endif
+	endif
+endfunction
+
+function ArrowRecovery(attacker, defender, weapon)
+	if ( defender.IsA(POLCLASS_NPC) && defender.backpack )
+		var chance := CInt(CS_GetSettingsCfgElem("Archery").RecoverChance);
+		if ( RandomDiceRoll("1d100") <= chance )
+			item_cfg := item_cfg[weapon.objtype];
+			if ( item_cfg.Projectile )
+				CreateItemInBackPack(defender, item_cfg.ProjectileType, 1);
+			endif
+		endif
+	endif
+endfunction
+
+function WearDownArmor(attacker, defender, weapon, armor, basedamage, rawdamage)
+	if ( armor )
+		var armr_elem := CS_GetSettingsCfgElem("Armor");
+		
+		// Turn into a percentage.
+		var dmg_to_wear := CDbl(CDbl(armr_elem.DmgToWear) * CDbl(armor.hp)) / 100.0;
+				
+		if ( CDbl(rawdamage) > dmg_to_wear )
+			if ( RandomDiceRoll("1d100") <= armr_elem.WearChance )
+				SendSysMessage(defender, armor.desc+" takes some damage.");
+				armor.quality := armor.quality * CDbl(armr_elem.WearRate);
+				if ( armor.quality <= 0.1 )
+					SendSysMessage(defender, armor.desc+" has been destroyed.");
+					DestroyItem(armor);
+				elseif ( armor.hp > armor.maxhp )
+					armor.hp := armor.maxhp;
+				endif
+			endif
+		endif
+	endif
+	
+	return 1;
+endfunction
+
+function WearDownWeapon(attacker, defender, weapon, armor, basedamage, rawdamage)
+	if ( weapon.IsA(POLCLASS_WEAPON) )
+		if ( weapon.objtype == 0xF020 )
+			return 1;
+		else
+			var wpn_elem := CS_GetSettingsCfgElem("Weapons");
+			if ( RandomDiceRoll("1d100") <= CInt(wpn_elem.WearChance) )
+				weapon.quality := weapon.quality * CDbl(wpn_elem.WearRate);
+				if ( weapon.quality <= 0.1 )
+					SendSysMessage(attacker, weapon.desc+" breaks.");
+					MoveObjectToLocation(weapon, 1, 1, 1, attacker.realm, MOVEOBJECT_FORCELOCATION);
+					DestroyItem(weapon);
+				elseif ( weapon.hp > weapon.maxhp )
+					weapon.hp := weapon.maxhp;
+				endif
+			endif
+			return 1;
+		endif
+	else
+		SendSysMessage(attacker, "An attack without a weapon?! Waaaa! That shouldnt be.");
+		return 0;
+	endif
+endfunction
+
+function DamageInfo(attacker, defender, weapon, armor, basedamage, rawdamage)
+	if ( attacker.cmdlevel )
+		PrintTextAbovePrivate(attacker, "Rawdamage:"+rawdamage+"  Base:"+basedamage, attacker);
+	endif
+	if ( defender.cmdlevel )
+		PrintTextAbovePrivate(attacker, "Rawdamage:"+rawdamage+"  Base:"+basedamage, defender);
+	endif
+endfunction
+
+function WeaponHitScripts(attacker, defender, weapon, armor, basedamage, rawdamage)
+	var weapon_scripts := array;
+	if ( weapon.objtype == 0xF020 ) // Intrinsic fist
+		weapon_scripts := GetObjProperty(attacker, "HitScripts");
+	elseif ( weapon.IsA(POLCLASS_WEAPON) )
+		weapon_scripts := GetObjProperty(weapon, "HitScripts");
+	endif
+	
+	foreach hitscript in weapon_scripts
+		var script := start_script(hitscript, {attacker, defender, weapon, armor, basedamage, rawdamage});
+		if ( !script || script.errortext )
+			SendSysMessage(attacker, "*Attacker* Weapon script error starting ["+hitscript+"] :" + script.errortext);
+			SendSysMessage(defender, "*Attacker* Weapon script error starting ["+hitscript+"] :" + script.errortext);
+		endif
+		sleepms(2);
+	endforeach
+	
+	return 1;
+endfunction
+
+function ArmorHitScripts(attacker, defender, weapon, armor, basedamage, rawdamage)
+	var body_scripts := GetObjProperty(defender, "ArmorHitScripts");
+	var armor_scripts := GetObjProperty(armor, "ArmorHitScripts");
+	if ( !body_scripts )
+		body_scripts := array{};
+	endif
+	if ( !armor_scripts )
+		armor_scripts := array{};
+	endif
+	
+	armor_scripts := armor_scripts + body_scripts;
+	
+	foreach hitscript in armor_scripts
+		var script := start_script(hitscript, {attacker, defender, weapon, armor, basedamage, rawdamage});
+		if ( script.errortext )
+			SendSysMessage(attacker, "*Defender* armor script error starting ["+hitscript+"] :" + script.errortext);
+			SendSysMessage(defender, "*Defender* armor script error starting ["+hitscript+"] :" + script.errortext);
+		endif
+		sleepms(2);
+	endforeach
+	
+	return 1;
+endfunction
+
+function PoisonChecks(attacker, defender, weapon, armor, basedamage, rawdamage)
+	if ( rawdamage < 1 )
+		return 0;
+	endif
+	
+	// Unsure how poisoned weapon CProps will look yet.
+endfunction
+
+//
+// Returns 1 on successful parry.
+//
+function ParryCheck(attacker, defender, weapon, armor, byref basedamage, byref rawdamage)
+	var shield := GetEquipmentByLayer(defender, LAYER_HAND2);
+	if ( !shield.ISA(POLCLASS_ARMOR) )
+		shield := GetEquipmentByLayer(defender, LAYER_HAND1);
+	endif
+	
+	if ( shield.IsA(POLCLASS_ARMOR) )
+		var parry_elem := CS_GetSettingsCfgElem("Parry");
+		var divisor := CDbl(parry_elem.ParryDivisor);
+		var roll := CDbl(parry_elem.ParryRoll);
+		var parry_chance := CDbl(AP_GetSkill(attacker, "Tactics")) / divisor;
+		
+		if ( RandomFloat(roll) < parry_chance )
+			//PerformAction(defender, ANIM_TWIST_DODGE);
+			SendSysMessage(defender, "You deflect some damage using your shield.");
+			var decrease := RandomInt(shield.ar)+1;
+			var new_dmg := rawdamage - decrease;
+			
+			if ( attacker.cmdlevel )
+				PrintTextAbovePrivate(defender, "Parry! Lowering damage from ["+rawdamage+"] to ["+new_dmg+"]", attacker);
+			endif
+			if ( defender.cmdlevel )
+				PrintTextAbovePrivate(defender, "Parry! Lowering damage from ["+rawdamage+"] to ["+new_dmg+"]", defender);
+			endif
+			
+			rawdamage := new_dmg;
+				
+			if ( rawdamage > CInt(0.15*shield.hp) )
+				SendSysMessage(defender, shield.desc+" takes some damage.");
+				shield.quality := shield.quality * CDbl(CS_GetSettingsCfgElem("Parry").WearRate);
+				if ( shield.quality <= 0.1 )
+					SendSysMessage(defender, shield.desc+" has been destroyed.");
+					MoveObjectToLocation(shield, 1, 1, 1, defender.realm, MOVEOBJECT_FORCELOCATION);
+					DestroyItem(shield);
+				elseif ( shield.hp > shield.maxhp )
+					shield.hp := shield.maxhp;
+				endif
+			endif
+			
+			return 1;
+		endif
+	endif
+	
+	return 0;
+endfunction



From austin at berlios.de  Wed Nov  2 05:04:12 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 05:04:12 +0100
Subject: [Poldistro-svn] r818 - trunk/096/pkg/systems/combat
Message-ID: <200511020404.jA244Cg6009923@sheep.berlios.de>

Author: austin
Date: 2005-11-02 05:04:02 +0100 (Wed, 02 Nov 2005)
New Revision: 818

Modified:
   trunk/096/pkg/systems/combat/mainHitScript.src
Log:
Updated ParryCheck() to not do reverse checks (eliminating the need for as much indenting)

Modified: trunk/096/pkg/systems/combat/mainHitScript.src
===================================================================
--- trunk/096/pkg/systems/combat/mainHitScript.src	2005-11-02 04:00:32 UTC (rev 817)
+++ trunk/096/pkg/systems/combat/mainHitScript.src	2005-11-02 04:04:02 UTC (rev 818)
@@ -215,42 +215,43 @@
 		shield := GetEquipmentByLayer(defender, LAYER_HAND1);
 	endif
 	
-	if ( shield.IsA(POLCLASS_ARMOR) )
-		var parry_elem := CS_GetSettingsCfgElem("Parry");
-		var divisor := CDbl(parry_elem.ParryDivisor);
-		var roll := CDbl(parry_elem.ParryRoll);
-		var parry_chance := CDbl(AP_GetSkill(attacker, "Tactics")) / divisor;
+	if ( !shield.IsA(POLCLASS_ARMOR) )
+		return 0;
+	endif
+	
+	var parry_elem := CS_GetSettingsCfgElem("Parry");
+	var divisor := CDbl(parry_elem.ParryDivisor);
+	var roll := CDbl(parry_elem.ParryRoll);
+	var parry_chance := CDbl(AP_GetSkill(attacker, "Tactics")) / divisor;
+	
+	if ( RandomFloat(roll) > parry_chance ) // Failed
+		return 0;
+	endif
+	
+	//PerformAction(defender, ANIM_TWIST_DODGE);
+	SendSysMessage(defender, "You deflect some damage using your shield.");
+	var decrease := RandomInt(shield.ar)+1;
+	var new_dmg := rawdamage - decrease;
+	
+	if ( attacker.cmdlevel )
+		PrintTextAbovePrivate(defender, "Parry! Lowering damage from ["+rawdamage+"] to ["+new_dmg+"]", attacker);
+	endif
+	if ( defender.cmdlevel )
+		PrintTextAbovePrivate(defender, "Parry! Lowering damage from ["+rawdamage+"] to ["+new_dmg+"]", defender);
+	endif
+	
+	rawdamage := new_dmg;
 		
-		if ( RandomFloat(roll) < parry_chance )
-			//PerformAction(defender, ANIM_TWIST_DODGE);
-			SendSysMessage(defender, "You deflect some damage using your shield.");
-			var decrease := RandomInt(shield.ar)+1;
-			var new_dmg := rawdamage - decrease;
-			
-			if ( attacker.cmdlevel )
-				PrintTextAbovePrivate(defender, "Parry! Lowering damage from ["+rawdamage+"] to ["+new_dmg+"]", attacker);
-			endif
-			if ( defender.cmdlevel )
-				PrintTextAbovePrivate(defender, "Parry! Lowering damage from ["+rawdamage+"] to ["+new_dmg+"]", defender);
-			endif
-			
-			rawdamage := new_dmg;
-				
-			if ( rawdamage > CInt(0.15*shield.hp) )
-				SendSysMessage(defender, shield.desc+" takes some damage.");
-				shield.quality := shield.quality * CDbl(CS_GetSettingsCfgElem("Parry").WearRate);
-				if ( shield.quality <= 0.1 )
-					SendSysMessage(defender, shield.desc+" has been destroyed.");
-					MoveObjectToLocation(shield, 1, 1, 1, defender.realm, MOVEOBJECT_FORCELOCATION);
-					DestroyItem(shield);
-				elseif ( shield.hp > shield.maxhp )
-					shield.hp := shield.maxhp;
-				endif
-			endif
-			
-			return 1;
+	if ( rawdamage > CInt(0.15*shield.hp) )
+		SendSysMessage(defender, shield.desc+" takes some damage.");
+		shield.quality := shield.quality * CDbl(CS_GetSettingsCfgElem("Parry").WearRate);
+		if ( shield.quality <= 0.1 )
+			SendSysMessage(defender, shield.desc+" has been destroyed.");
+			MoveObjectToLocation(shield, 1, 1, 1, defender.realm, MOVEOBJECT_FORCELOCATION);
+			DestroyItem(shield);
+		elseif ( shield.hp > shield.maxhp )
+			shield.hp := shield.maxhp;
 		endif
 	endif
-	
-	return 0;
+	return 1;
 endfunction



From austin at berlios.de  Wed Nov  2 05:11:07 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 05:11:07 +0100
Subject: [Poldistro-svn] r819 - trunk/096/pkg/systems/combat
Message-ID: <200511020411.jA24B711012082@sheep.berlios.de>

Author: austin
Date: 2005-11-02 05:11:03 +0100 (Wed, 02 Nov 2005)
New Revision: 819

Modified:
   trunk/096/pkg/systems/combat/mainHitScript.src
Log:
Eliminated unused variable warnings.
Commented out PoisonChecks() since it is not yet known how poison props will be stored and used.

Modified: trunk/096/pkg/systems/combat/mainHitScript.src
===================================================================
--- trunk/096/pkg/systems/combat/mainHitScript.src	2005-11-02 04:04:02 UTC (rev 818)
+++ trunk/096/pkg/systems/combat/mainHitScript.src	2005-11-02 04:11:03 UTC (rev 819)
@@ -31,15 +31,15 @@
 	endif
 	
 	PlayHitSounds(defender);
-	SkillChecks(attacker, defender, weapon, armor, basedamage, rawdamage);
-	ArrowRecovery(attacker, defender, weapon);
-	ParryCheck(attacker, defender, weapon, armor, basedamage, rawdamage);
-	WearDownWeapon(attacker, defender, weapon, armor, basedamage, rawdamage);
-	WearDownArmor(attacker, defender, weapon, armor, basedamage, rawdamage);
-	DamageInfo(attacker, defender, weapon, armor, basedamage, rawdamage);
+	SkillChecks(attacker, defender, weapon, rawdamage);
+	ArrowRecovery(defender, weapon);
+	ParryCheck(attacker, defender, rawdamage);
+	WearDownWeapon(attacker, weapon);
+	WearDownArmor(defender, armor, rawdamage);
+	DamageInfo(attacker, defender, basedamage, rawdamage);
 	WeaponHitScripts(attacker, defender, weapon, armor, basedamage, rawdamage);
 	ArmorHitScripts(attacker, defender, weapon, armor, basedamage, rawdamage);
-	PoisonChecks(attacker, defender, weapon, armor, basedamage, rawdamage);
+	//PoisonChecks(attacker, defender, weapon, armor, basedamage, rawdamage);
 	
 	var hostiles := ListHostiles(defender, 1);
 	rawdamage := rawdamage+CInt(hostiles.size()/2);
@@ -64,9 +64,9 @@
 	endif
 endfunction
 
-function SkillChecks(attacker, defender, weapon, armor, basedamage, rawdamage)
+function SkillChecks(attacker, defender, weapon, rawdamage)
 	var can_gain := 0;
-	var next_gain := CInt(GetObjProperty(attacker, "#CHGainTime"));
+	var next_gain := CInt(GetObjProperty(attacker, "#CS_GainTime"));
 	if ( ReadGameClock() >= next_gain )
 		if ( CS_GetSettingsCfgElem("General").PvPGains )
 			can_gain := 1;
@@ -77,7 +77,7 @@
 	
 	if ( can_gain )
 		var gain_wait := CInt(CS_GetSettingsCfgElem("General").GainWait);
-		SetObjProperty(attacker, "#CHGainTime", ReadGameClock()+gain_wait);
+		SetObjProperty(attacker, "#CS_GainTime", ReadGameClock()+gain_wait);
 		if ( rawdamage > 0 )
 			SkillCheck(attacker, weapon.attribute, -1);
 			SkillCheck(attacker, "Tactics", -1);
@@ -85,7 +85,7 @@
 	endif
 endfunction
 
-function ArrowRecovery(attacker, defender, weapon)
+function ArrowRecovery(defender, weapon)
 	if ( defender.IsA(POLCLASS_NPC) && defender.backpack )
 		var chance := CInt(CS_GetSettingsCfgElem("Archery").RecoverChance);
 		if ( RandomDiceRoll("1d100") <= chance )
@@ -97,7 +97,7 @@
 	endif
 endfunction
 
-function WearDownArmor(attacker, defender, weapon, armor, basedamage, rawdamage)
+function WearDownArmor(defender, armor, rawdamage)
 	if ( armor )
 		var armr_elem := CS_GetSettingsCfgElem("Armor");
 		
@@ -121,7 +121,7 @@
 	return 1;
 endfunction
 
-function WearDownWeapon(attacker, defender, weapon, armor, basedamage, rawdamage)
+function WearDownWeapon(attacker, weapon)
 	if ( weapon.IsA(POLCLASS_WEAPON) )
 		if ( weapon.objtype == 0xF020 )
 			return 1;
@@ -145,7 +145,7 @@
 	endif
 endfunction
 
-function DamageInfo(attacker, defender, weapon, armor, basedamage, rawdamage)
+function DamageInfo(attacker, defender, basedamage, rawdamage)
 	if ( attacker.cmdlevel )
 		PrintTextAbovePrivate(attacker, "Rawdamage:"+rawdamage+"  Base:"+basedamage, attacker);
 	endif
@@ -198,6 +198,7 @@
 	return 1;
 endfunction
 
+/*
 function PoisonChecks(attacker, defender, weapon, armor, basedamage, rawdamage)
 	if ( rawdamage < 1 )
 		return 0;
@@ -205,11 +206,12 @@
 	
 	// Unsure how poisoned weapon CProps will look yet.
 endfunction
+*/
 
 //
 // Returns 1 on successful parry.
 //
-function ParryCheck(attacker, defender, weapon, armor, byref basedamage, byref rawdamage)
+function ParryCheck(attacker, defender, byref rawdamage)
 	var shield := GetEquipmentByLayer(defender, LAYER_HAND2);
 	if ( !shield.ISA(POLCLASS_ARMOR) )
 		shield := GetEquipmentByLayer(defender, LAYER_HAND1);



From austin at berlios.de  Wed Nov  2 05:18:19 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 05:18:19 +0100
Subject: [Poldistro-svn] r820 - in trunk/096/pkg/systems/combat: . hooks include
Message-ID: <200511020418.jA24IJ6o015179@sheep.berlios.de>

Author: austin
Date: 2005-11-02 05:18:15 +0100 (Wed, 02 Nov 2005)
New Revision: 820

Added:
   trunk/096/pkg/systems/combat/hooks/combatAdv.src
   trunk/096/pkg/systems/combat/hooks/parryAdv.src
   trunk/096/pkg/systems/combat/syshook.cfg
Modified:
   trunk/096/pkg/systems/combat/include/settings.inc
Log:


Added: trunk/096/pkg/systems/combat/hooks/combatAdv.src
===================================================================
--- trunk/096/pkg/systems/combat/hooks/combatAdv.src	2005-11-02 04:11:03 UTC (rev 819)
+++ trunk/096/pkg/systems/combat/hooks/combatAdv.src	2005-11-02 04:18:15 UTC (rev 820)
@@ -0,0 +1,22 @@
+/*
+ * $Id$
+ *
+ */
+use uo;
+
+program hook_startup()
+	print("INSTALLED: Combat Advancement hook... ok.");
+	return 1;
+endprogram
+
+//
+// NOTE: This function is called EVEN IF THE ATTACK DIDN'T SUCCEED!
+//
+exported function CombatAdvancement(attacker,defender)
+	// Eliminates compiler warnings
+	attacker := attacker;
+	defender := defender;
+	
+	// Advancement currently handled in mainHitScript
+	return 0;
+endfunction

Added: trunk/096/pkg/systems/combat/hooks/parryAdv.src
===================================================================
--- trunk/096/pkg/systems/combat/hooks/parryAdv.src	2005-11-02 04:11:03 UTC (rev 819)
+++ trunk/096/pkg/systems/combat/hooks/parryAdv.src	2005-11-02 04:18:15 UTC (rev 820)
@@ -0,0 +1,21 @@
+/*
+ * $Id$
+ *
+ */
+use os;
+
+program hook_startup()
+	print("INSTALLED: Parry hook... ok.");
+	return 1;
+endprogram
+
+exported function ParryAdvancement(attacker, weapon, defender, shield)
+	// Eliminates compiler warnings
+	attacker := attacker;
+	weapon := weapon;
+	defender := defender;
+	shield := shield;
+
+	return 0;
+endfunction
+

Modified: trunk/096/pkg/systems/combat/include/settings.inc
===================================================================
--- trunk/096/pkg/systems/combat/include/settings.inc	2005-11-02 04:11:03 UTC (rev 819)
+++ trunk/096/pkg/systems/combat/include/settings.inc	2005-11-02 04:18:15 UTC (rev 820)
@@ -11,7 +11,7 @@
  * CS_GetSettingsCfgFile(engine_name)
  *
  * Purpose
- * Reads in :attributes:configs/settings.cfg
+ * Reads in :combat:config/settings.cfg
  *
  * Parameters
  *

Added: trunk/096/pkg/systems/combat/syshook.cfg
===================================================================
--- trunk/096/pkg/systems/combat/syshook.cfg	2005-11-02 04:11:03 UTC (rev 819)
+++ trunk/096/pkg/systems/combat/syshook.cfg	2005-11-02 04:18:15 UTC (rev 820)
@@ -0,0 +1,14 @@
+SystemHookScript hooks/combatAdv.ecl
+{
+	CombatAdvancement	CombatAdvancement
+}
+
+SystemHookScript hooks/parryAdv.ecl
+{
+	ParryAdvancement	ParryAdvancement
+}
+
+//SystemHookScript hooks/combathook.ecl
+//{
+//	Attack Attack
+//}



From austin at berlios.de  Wed Nov  2 09:57:08 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 09:57:08 +0100
Subject: [Poldistro-svn] r821 - trunk/096/pkg/skills/fishing
Message-ID: <200511020857.jA28v8EO010025@sheep.berlios.de>

Author: austin
Date: 2005-11-02 09:57:06 +0100 (Wed, 02 Nov 2005)
New Revision: 821

Modified:
   trunk/096/pkg/skills/fishing/fishing.src
Log:
Changed EVID_ENGAGED (evid* events are deprecated) to SYSEVENT_ENGAGED

Modified: trunk/096/pkg/skills/fishing/fishing.src
===================================================================
--- trunk/096/pkg/skills/fishing/fishing.src	2005-11-02 04:18:15 UTC (rev 820)
+++ trunk/096/pkg/skills/fishing/fishing.src	2005-11-02 08:57:06 UTC (rev 821)
@@ -13,6 +13,7 @@
 include ":crafting:toolWear";
 include "include/objtype";
 include "include/startEqp";
+include "include/sysEvent";
 
 program use_FishingPole(who, fishingpole)
 
@@ -176,7 +177,7 @@
 	if(it)
 		SendSysMessage(who, "Oops, that's not a fish!");
 		var ev := {};
-		ev.+type := EVID_ENGAGED;
+		ev.+type := SYSEVENT_ENGAGED;
 		ev.+source := who;
 		SendEvent(it, ev);
 	endif



From austin at berlios.de  Wed Nov  2 10:11:16 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 10:11:16 +0100
Subject: [Poldistro-svn] r822 - trunk/096/pkg/other
Message-ID: <200511020911.jA29BGZG012821@sheep.berlios.de>

Author: austin
Date: 2005-11-02 10:11:15 +0100 (Wed, 02 Nov 2005)
New Revision: 822

Removed:
   trunk/096/pkg/other/gmtools/
Log:
I bet that feels good... Dont wanna update it for the new attributes! >_<




From austin at berlios.de  Wed Nov  2 10:17:07 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 10:17:07 +0100
Subject: [Poldistro-svn] r823 - trunk/096/pkg/skills/alchemy
Message-ID: <200511020917.jA29H7n8014170@sheep.berlios.de>

Author: austin
Date: 2005-11-02 10:17:03 +0100 (Wed, 02 Nov 2005)
New Revision: 823

Modified:
   trunk/096/pkg/skills/alchemy/alchemy.src
   trunk/096/pkg/skills/alchemy/potion.inc
Log:
Attribute updates

Modified: trunk/096/pkg/skills/alchemy/alchemy.src
===================================================================
--- trunk/096/pkg/skills/alchemy/alchemy.src	2005-11-02 09:11:15 UTC (rev 822)
+++ trunk/096/pkg/skills/alchemy/alchemy.src	2005-11-02 09:17:03 UTC (rev 823)
@@ -9,31 +9,31 @@
 include "include/canAccess";
 include "include/noto";
 
-const REAGENT_START := 0x0f78;
-const REAGENT_STOP := 0x0f91;
-const SOUND_EFFECT_GRIND := 0x243;
-const SOUND_EFFECT_POUR := 0x241;
-const SOUND_EFFECT_BUBBLE :=  0x4f;
-const UOBJECT_EMPTY_BOTTLE := 0x0f0e;
+CONST REAGENT_START := 0x0f78;
+CONST REAGENT_STOP := 0x0f91;
+CONST SOUND_EFFECT_GRIND := 0x243;
+CONST SOUND_EFFECT_POUR := 0x241;
+CONST SOUND_EFFECT_BUBBLE :=	0x4f;
+CONST UOBJECT_EMPTY_BOTTLE := 0x0f0e;
 
 var conf := ReadConfigFile("alchemy");
-
+	
 program use_mortar (who, mortar)
-  EraseObjProperty(who, "IsMeditating");
-  EraseObjProperty(who, "HealTimer");
-  if(!can_access(who, mortar))
-    return;
-  endif
-  if(!ReserveItem(mortar))
-    SendSysMessage(who, "That is already in use.");
-    return;
-  endif
-  Detach();
-  if(GetObjProperty(mortar, "contents"))
+	EraseObjProperty(who, "IsMeditating");
+	EraseObjProperty(who, "HealTimer");
+	if(!can_access(who, mortar))
+		return;
+	endif
+	if(!ReserveItem(mortar))
+		SendSysMessage(who, "That is already in use.");
+		return;
+	endif
+	Detach();
+	if(GetObjProperty(mortar, "contents"))
 	PourPotion(who, mortar);
-  else
-    SendSysMessage( who, "What would you like to use that on?" );
-    make_the_potion(who, mortar);
-  endif
-  EraseObjProperty(mortar, "#IsMixing");
+	else
+		SendSysMessage( who, "What would you like to use that on?" );
+		make_the_potion(who, mortar);
+	endif
+	EraseObjProperty(mortar, "#IsMixing");
 endprogram
\ No newline at end of file

Modified: trunk/096/pkg/skills/alchemy/potion.inc
===================================================================
--- trunk/096/pkg/skills/alchemy/potion.inc	2005-11-02 09:11:15 UTC (rev 822)
+++ trunk/096/pkg/skills/alchemy/potion.inc	2005-11-02 09:17:03 UTC (rev 823)
@@ -3,284 +3,285 @@
 use cfgfile;
 
 var cfg := ReadConfigFile("alchemy");
-if(!cfg)
-  syslog("Failed to open alchemy.cfg: " + cfg.errortext);
+if( !cfg )
+	syslog("Failed to open alchemy.cfg: " + cfg.errortext);
 endif
 
 include ":attributes:attributes";
+
 function is_reagent(what)
-  case(what.objtype)
-    0xf7a: return 1;
-    0xf7b: return 1;
-    0xf84: return 1;
-    0xf85: return 1;
-    0xf86: return 1;
-    0xf88: return 1;
-    0xf8c: return 1;
-    0xf8d: return 1;
-  endcase
-  return 0;
+	case(what.objtype)
+		0xf7a: return 1;
+		0xf7b: return 1;
+		0xf84: return 1;
+		0xf85: return 1;
+		0xf86: return 1;
+		0xf88: return 1;
+		0xf8c: return 1;
+		0xf8d: return 1;
+	endcase
+	return 0;
 endfunction
 
 function PourPotion(user,mortar)
-  try_to_make_potion(user, "spacefill", 1, mortar, 0);
+	try_to_make_potion(user, "spacefill", 1, mortar, 0);
 endfunction
 
 function make_the_potion(user, mortar)
-  var use_on := Target( user );
-  if(!use_on)
-    SendSysMessage(user, "Targetting cancelled.");
-    return;
-  endif
-  if(!can_access(user, use_on))
-    return;
-  endif
-  if(is_reagent(use_on))
-    if(!cfg)
-      SendSysMessage(user, "Alchemy config error. Please inform the staff.");
-      return;
-    endif
-    var elem := cfg[use_on.objtype];
-    if(!elem)
-      SendSysMessage(user, "Alchemy element error. Please inform the staff.");
-      return;
-    endif
-    var possible := array;
-    var tmenu := CreateMenu("Select a potion to make");
-    var num_possibilities := 0;
-    possible := GetConfigStringArray( elem, "potion");
-    foreach thingie in possible
-      if(can_make(user, thingie, use_on))
-        var titem := cfg[thingie].objtype;
-        if(titem)
-          thingie["_"] := " ";
-          AddMenuItem( tmenu, titem, thingie );
-          num_possibilities := num_possibilities + 1;
-        endif
-      endif
-    endforeach
-    if(num_possibilities == 0)
-      SendSysMessage(user, "You can't make any potions!");
-      return;
-    endif
-    var citem := SelectMenuItem2(user, tmenu);
-    if(!citem.objtype)
-      SendSysMessage(user, "Targetting cancelled.");
-      return -1;
-    endif
-    try_to_make_potion(user, possible[citem.index], 0, mortar, use_on);
-  elseif(use_on == mortar)
-    var last := GetObjProperty(mortar, "LastMade");
-    if(last)
-  	  try_to_make_last(user, last, mortar);
-  	else
-  	  SendSysMessage(user, "You cannot grind that.");
-  	  return;
-  	endif
-  else
-    SendSysMessage(user, "That's not a reagent.");
-  endif
+	var use_on := Target( user );
+	if(!use_on)
+		SendSysMessage(user, "Targetting cancelled.");
+		return;
+	endif
+	if(!can_access(user, use_on))
+		return;
+	endif
+	if(is_reagent(use_on))
+		if(!cfg)
+			SendSysMessage(user, "Alchemy config error. Please inform the staff.");
+			return;
+		endif
+		var elem := cfg[use_on.objtype];
+		if(!elem)
+			SendSysMessage(user, "Alchemy element error. Please inform the staff.");
+			return;
+		endif
+		var possible := array;
+		var tmenu := CreateMenu("Select a potion to make");
+		var num_possibilities := 0;
+		possible := GetConfigStringArray( elem, "potion");
+		foreach thingie in possible
+			if(can_make(user, thingie, use_on))
+				var titem := cfg[thingie].objtype;
+				if(titem)
+					thingie["_"] := " ";
+					AddMenuItem( tmenu, titem, thingie );
+					num_possibilities := num_possibilities + 1;
+				endif
+			endif
+		endforeach
+		if(num_possibilities == 0)
+			SendSysMessage(user, "You can't make any potions!");
+			return;
+		endif
+		var citem := SelectMenuItem2(user, tmenu);
+		if(!citem.objtype)
+			SendSysMessage(user, "Targetting cancelled.");
+			return -1;
+		endif
+		try_to_make_potion(user, possible[citem.index], 0, mortar, use_on);
+	elseif(use_on == mortar)
+		var last := GetObjProperty(mortar, "LastMade");
+		if(last)
+			try_to_make_last(user, last, mortar);
+		else
+			SendSysMessage(user, "You cannot grind that.");
+			return;
+		endif
+	else
+		SendSysMessage(user, "That's not a reagent.");
+	endif
 endfunction
 
 function can_make(user, potion, reg)
-  reg := reg; // stops ecompile "not used" warning
-  var skillneeded:= CInt(cfg[potion].skill);
-  if(skillneeded > 20)
-    skillneeded := skillneeded - 20;
-  else
-    skillneeded := 0;
-  endif
-  if(GetEffectiveSkill(user, SKILLID_ALCHEMY) >= skillneeded)
-    return 1;
-  else
-    return 0;
-  endif
+	reg := reg; // stops ecompile "not used" warning
+	var skillneeded:= CInt(cfg[potion].skill);
+	if(skillneeded > 20)
+		skillneeded := skillneeded - 20;
+	else
+		skillneeded := 0;
+	endif
+	if( AP_GetSkill(user, "Alchemy") >= skillneeded)
+		return 1;
+	else
+		return 0;
+	endif
 endfunction
 
 function take_regs(user, potion, reg)
-  var amount_needed:= cfg[potion].reagent_amount;
-  set_critical(1);
-  if(CInt(amount_needed) <= reg.amount)
-    SubtractAmount(reg, amount_needed);
-    set_critical(0);
-    return 1;
-  else
-    SendSysMessage(user, "You ran out of reagents.");
-    set_critical(0);
-    return 0;
-  endif
+	var amount_needed:= cfg[potion].reagent_amount;
+	set_critical(1);
+	if(CInt(amount_needed) <= reg.amount)
+		SubtractAmount(reg, amount_needed);
+		set_critical(0);
+		return 1;
+	else
+		SendSysMessage(user, "You ran out of reagents.");
+		set_critical(0);
+		return 0;
+	endif
 endfunction
 
 function try_to_make_potion(user, potion, in_mortar, mortar, reg)
-  if(!in_mortar)
-    potion[" "] := "_";
-    var difficulty := cfg[potion].skill;
-    var points := cfg[potion].points;
-    var product := cfg[potion].objtype;
-    SetObjProperty(mortar, "LastMade", potion);
-    var loop := 0;
-    while(loop < 3)
-      PlaySoundEffect(user, SOUND_EFFECT_GRIND);
-      PrintTextAbovePrivate(user, "You grind the reagent.",user);
-      sleep(1);
-      loop := loop + 1;
-    endwhile
-    if(!take_regs(user, potion, reg))
-      return;
-    endif
-    if(CheckSkill(user, SKILLID_ALCHEMY, difficulty, points))
-      var hasbottle:= 0;
-      set_critical(1);
-      foreach item in EnumerateItemsInContainer(user.backpack)
-        if((item.objtype == UOBJECT_EMPTY_BOTTLE) && (item.container.objtype != 0x1940))
-          if(SubtractAmount(item, 1))
-            hasbottle := 1;
-            break;
-          endif
-        endif
-      endforeach
-      set_critical(0);
-      if(RandomInt(10) > 6)
-        var skill := GetEffectiveSkill(user, SKILLID_ALCHEMY);
-        ExceptionalFameMod(user, skill, difficulty, Cint(points / 4));
-      endif
-      if(hasbottle)
-        var thing := CreateItemInBackpack(user, product, 1);
-        if ( !thing )
-          SendSysMessage(user, "Failed to create potion! Please report this to the staff (error logged)");
-          syslog( "Alchemy potion creation (1) failed: " + thing.errortext );
-          return;
-        endif
-        PlaySoundEffect(user, SOUND_EFFECT_POUR);
-        PrintTextAbovePrivate(user, "You create the potion and put it in your backpack.", user);
-        return;
-      else
-        PrintTextAbovePrivate(user, "You don't have any bottles.", user);
-        SetObjProperty(mortar, "contents", product);
-        return;
-      endif
-    else
-      PlaySoundEffect(user, SOUND_EFFECT_POUR);
-      PrintTextAbovePrivate(user, "You pour out the useless mixture.", user);
-      return;
-    endif
-  else
-    var hasbottle:= 0;
-    set_critical(1);
-    foreach item in EnumerateItemsInContainer(user.backpack)
-      if((item.objtype == UOBJECT_EMPTY_BOTTLE) && (item.container.objtype != 0x1940))
-        SubtractAmount(item, 1);
-        hasbottle := 1;
-        break;
-      endif
-    endforeach
-    set_critical(0);
-    if(hasbottle)
-      var product := GetObjProperty(mortar, "contents");
-      var thing := CreateItemInBackpack(user, product, 1);
-      if ( !thing )
-        SendSysMessage(user, "Failed to create item! Please report this to the staff (error logged)");
-        syslog( "Alchemy item creation failed: " + thing.errortext );
-        return;
-      endif
-      PlaySoundEffect(user, SOUND_EFFECT_POUR);
-      PrintTextAbovePrivate(user, "You create the item and put it in your backpack.", user);
-      EraseObjProperty( mortar, "contents" );
-      return;
-    else
-      PrintTextAbovePrivate(user, "You don't have any bottles.", user);
-      return;
-    endif
-  endif
+	if(!in_mortar)
+		potion[" "] := "_";
+		var difficulty := cfg[potion].skill;
+		var points := cfg[potion].points;
+		var product := cfg[potion].objtype;
+		SetObjProperty(mortar, "LastMade", potion);
+		var loop := 0;
+		while(loop < 3)
+			PlaySoundEffect(user, SOUND_EFFECT_GRIND);
+			PrintTextAbovePrivate(user, "You grind the reagent.",user);
+			sleep(1);
+			loop := loop + 1;
+		endwhile
+		if(!take_regs(user, potion, reg))
+			return;
+		endif
+		if(SkillCheck(user, "Alchemy", difficulty) > 0)
+			var hasbottle:= 0;
+			set_critical(1);
+			foreach item in EnumerateItemsInContainer(user.backpack)
+				if((item.objtype == UOBJECT_EMPTY_BOTTLE) && (item.container.objtype != 0x1940))
+					if(SubtractAmount(item, 1))
+						hasbottle := 1;
+						break;
+					endif
+				endif
+			endforeach
+			set_critical(0);
+			if(RandomInt(10) > 6)
+				var skill := AP_GetSkill(user, "Alchemy");
+				ExceptionalFameMod(user, skill, difficulty, Cint(points / 4));
+			endif
+			if(hasbottle)
+				var thing := CreateItemInBackpack(user, product, 1);
+				if ( !thing )
+					SendSysMessage(user, "Failed to create potion! Please report this to the staff (error logged)");
+					syslog( "Alchemy potion creation (1) failed: " + thing.errortext );
+					return;
+				endif
+				PlaySoundEffect(user, SOUND_EFFECT_POUR);
+				PrintTextAbovePrivate(user, "You create the potion and put it in your backpack.", user);
+				return;
+			else
+				PrintTextAbovePrivate(user, "You don't have any bottles.", user);
+				SetObjProperty(mortar, "contents", product);
+				return;
+			endif
+		else
+			PlaySoundEffect(user, SOUND_EFFECT_POUR);
+			PrintTextAbovePrivate(user, "You pour out the useless mixture.", user);
+			return;
+		endif
+	else
+		var hasbottle:= 0;
+		set_critical(1);
+		foreach item in EnumerateItemsInContainer(user.backpack)
+			if((item.objtype == UOBJECT_EMPTY_BOTTLE) && (item.container.objtype != 0x1940))
+				SubtractAmount(item, 1);
+				hasbottle := 1;
+				break;
+			endif
+		endforeach
+		set_critical(0);
+		if(hasbottle)
+			var product := GetObjProperty(mortar, "contents");
+			var thing := CreateItemInBackpack(user, product, 1);
+			if ( !thing )
+				SendSysMessage(user, "Failed to create item! Please report this to the staff (error logged)");
+				syslog( "Alchemy item creation failed: " + thing.errortext );
+				return;
+			endif
+			PlaySoundEffect(user, SOUND_EFFECT_POUR);
+			PrintTextAbovePrivate(user, "You create the item and put it in your backpack.", user);
+			EraseObjProperty( mortar, "contents" );
+			return;
+		else
+			PrintTextAbovePrivate(user, "You don't have any bottles.", user);
+			return;
+		endif
+	endif
 endfunction
 
 function try_to_make_last(user, potion, mortar)
-  var reg;
-  case(potion)
-    "Refresh":            reg := FindRegs(user, 0xf7a);
-    "Total_Refresh":      reg := FindRegs(user, 0xf7a);
-    "Agility":            reg := FindRegs(user, 0xf7b);
-    "Greater_Agility":    reg := FindRegs(user, 0xf7b);
-    "Lesser_Cure":        reg := FindRegs(user, 0xf84);
-    "Cure":               reg := FindRegs(user, 0xf84);
-    "Greater_Cure":       reg := FindRegs(user, 0xf84);
-    "Lesser_Heal":        reg := FindRegs(user, 0xf85);
-    "Heal":               reg := FindRegs(user, 0xf85);
-    "Greater_Heal":       reg := FindRegs(user, 0xf85);
-    "Strength":           reg := FindRegs(user, 0xf86);
-    "Greater_Strength":   reg := FindRegs(user, 0xf86);
-    "Lesser_Poison":      reg := FindRegs(user, 0xf88);
-    "Poison":             reg := FindRegs(user, 0xf88);
-    "Greater_Poison":     reg := FindRegs(user, 0xf88);
-    "Deadly_Poison":      reg := FindRegs(user, 0xf88);
-    "Lesser_Explosion":   reg := FindRegs(user, 0xf8c);
-    "Explosion":          reg := FindRegs(user, 0xf8c);
-    "Greater_Explosion":  reg := FindRegs(user, 0xf8c);
-    "Nightsight":         reg := FindRegs(user, 0xf8d);
-  endcase
-  if(reg == "none")
-    SendSysMessage(user, "You do not have enough reagents to make that.");
-    return;
-  endif
-  potion[" "] := "_";
-  var difficulty := cfg[potion].skill;
-  var points := cfg[potion].points;
-  var product := cfg[potion].objtype;
-  if(!take_regs(user, potion, reg))
-    SendSysMessage(user, "You do not have enough reagents to make that.");
-    return;
-  endif
-  PlaySoundEffect(user, SOUND_EFFECT_GRIND);
-  PrintTextAbovePrivate(user, "You grind the reagent.",user);
-  sleep(2);
-  PlaySoundEffect(user, SOUND_EFFECT_GRIND);
-  PrintTextAbovePrivate(user, "You grind the reagent.",user);
-  sleep(2);
-  PlaySoundEffect(user, SOUND_EFFECT_GRIND);
-  PrintTextAbovePrivate(user, "You grind the reagent.",user);
-  sleep(2);
-  if(CheckSkill(user, SKILLID_ALCHEMY, difficulty, points))
-    var hasbottle:= 0;
-    set_critical(1);
-    foreach item in EnumerateItemsInContainer(user.backpack)
-      if((item.objtype == UOBJECT_EMPTY_BOTTLE) && (item.container.objtype != 0x1940))
-        if(SubtractAmount(item, 1))
-          hasbottle := 1;
-          break;
-        endif
-      endif
-    endforeach
-    set_critical(0);
-    if(hasbottle)
-      var thing := CreateItemInBackpack(user, product, 1);
-      if ( !thing )
-        SendSysMessage(user, "Failed to create potion! Please report this to the staff (error logged)");
-        syslog( "Alchemy potion creation (2) failed: " + thing.errortext );
-        return;
-      endif
-      PlaySoundEffect(user, SOUND_EFFECT_POUR);
-      SetObjProperty(mortar, "LastMade", potion);
-      PrintTextAbovePrivate(user, "You create the potion and put it in your backpack.", user);
-      return;
-    else
-      PrintTextAbovePrivate(user, "You don't have any bottles.", user);
-      SetObjProperty(mortar, "contents", product);
-      return;
-    endif
-  else
-    PlaySoundEffect(user, SOUND_EFFECT_POUR);
-    PrintTextAbovePrivate(user, "You pour out the useless mixture.", user);
-    return;
-  endif
+	var reg;
+	case(potion)
+		"Refresh":						reg := FindRegs(user, 0xf7a);
+		"Total_Refresh":			reg := FindRegs(user, 0xf7a);
+		"Agility":						reg := FindRegs(user, 0xf7b);
+		"Greater_Agility":		reg := FindRegs(user, 0xf7b);
+		"Lesser_Cure":				reg := FindRegs(user, 0xf84);
+		"Cure":							 reg := FindRegs(user, 0xf84);
+		"Greater_Cure":			 reg := FindRegs(user, 0xf84);
+		"Lesser_Heal":				reg := FindRegs(user, 0xf85);
+		"Heal":							 reg := FindRegs(user, 0xf85);
+		"Greater_Heal":			 reg := FindRegs(user, 0xf85);
+		"Strength":					 reg := FindRegs(user, 0xf86);
+		"Greater_Strength":	 reg := FindRegs(user, 0xf86);
+		"Lesser_Poison":			reg := FindRegs(user, 0xf88);
+		"Poison":						 reg := FindRegs(user, 0xf88);
+		"Greater_Poison":		 reg := FindRegs(user, 0xf88);
+		"Deadly_Poison":			reg := FindRegs(user, 0xf88);
+		"Lesser_Explosion":	 reg := FindRegs(user, 0xf8c);
+		"Explosion":					reg := FindRegs(user, 0xf8c);
+		"Greater_Explosion":	reg := FindRegs(user, 0xf8c);
+		"Nightsight":				 reg := FindRegs(user, 0xf8d);
+	endcase
+	if(reg == "none")
+		SendSysMessage(user, "You do not have enough reagents to make that.");
+		return;
+	endif
+	potion[" "] := "_";
+	var difficulty := cfg[potion].skill;
+	var points := cfg[potion].points;
+	var product := cfg[potion].objtype;
+	if(!take_regs(user, potion, reg))
+		SendSysMessage(user, "You do not have enough reagents to make that.");
+		return;
+	endif
+	PlaySoundEffect(user, SOUND_EFFECT_GRIND);
+	PrintTextAbovePrivate(user, "You grind the reagent.",user);
+	sleep(2);
+	PlaySoundEffect(user, SOUND_EFFECT_GRIND);
+	PrintTextAbovePrivate(user, "You grind the reagent.",user);
+	sleep(2);
+	PlaySoundEffect(user, SOUND_EFFECT_GRIND);
+	PrintTextAbovePrivate(user, "You grind the reagent.",user);
+	sleep(2);
+	if(SkillCheck(user, "Alchemy", difficulty) > 0 )
+		var hasbottle:= 0;
+		set_critical(1);
+		foreach item in EnumerateItemsInContainer(user.backpack)
+			if((item.objtype == UOBJECT_EMPTY_BOTTLE) && (item.container.objtype != 0x1940))
+				if(SubtractAmount(item, 1))
+					hasbottle := 1;
+					break;
+				endif
+			endif
+		endforeach
+		set_critical(0);
+		if(hasbottle)
+			var thing := CreateItemInBackpack(user, product, 1);
+			if ( !thing )
+				SendSysMessage(user, "Failed to create potion! Please report this to the staff (error logged)");
+				syslog( "Alchemy potion creation (2) failed: " + thing.errortext );
+				return;
+			endif
+			PlaySoundEffect(user, SOUND_EFFECT_POUR);
+			SetObjProperty(mortar, "LastMade", potion);
+			PrintTextAbovePrivate(user, "You create the potion and put it in your backpack.", user);
+			return;
+		else
+			PrintTextAbovePrivate(user, "You don't have any bottles.", user);
+			SetObjProperty(mortar, "contents", product);
+			return;
+		endif
+	else
+		PlaySoundEffect(user, SOUND_EFFECT_POUR);
+		PrintTextAbovePrivate(user, "You pour out the useless mixture.", user);
+		return;
+	endif
 endfunction
 
 function FindRegs(who, type)
-  var holder := "none";
-  foreach thing in EnumerateItemsInContainer(who.backpack)
-    if(thing.objtype == type)
-      holder := thing;
-      break;
-    endif
-  endforeach
-  return holder;
+	var holder := "none";
+	foreach thing in EnumerateItemsInContainer(who.backpack)
+		if(thing.objtype == type)
+			holder := thing;
+			break;
+		endif
+	endforeach
+	return holder;
 endfunction
\ No newline at end of file



From austin at berlios.de  Wed Nov  2 10:19:18 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 10:19:18 +0100
Subject: [Poldistro-svn] r824 - trunk/096/pkg/skills/alchemy
Message-ID: <200511020919.jA29JI8B014384@sheep.berlios.de>

Author: austin
Date: 2005-11-02 10:19:17 +0100 (Wed, 02 Nov 2005)
New Revision: 824

Modified:
   trunk/096/pkg/skills/alchemy/redPotion.src
Log:
Attribute updates.

Modified: trunk/096/pkg/skills/alchemy/redPotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/redPotion.src	2005-11-02 09:17:03 UTC (rev 823)
+++ trunk/096/pkg/skills/alchemy/redPotion.src	2005-11-02 09:19:17 UTC (rev 824)
@@ -20,13 +20,13 @@
     return;
   endif
   if(potion.objtype == 0xdc0f)
-	SetStamina(who, GetMaxStamina(who));
+	AP_SetVital(who, "Stamina", AP_GetVitalMaximumValue(who, "Stamina"));
   else
 	var heal_amount := RandomDiceRoll("5d6+3");
-    if((heal_amount + GetStamina(who))  > GetMaxStamina(who))
-	  heal_amount := GetMaxStamina(who) - GetStamina(who);
+    if((heal_amount + AP_GetVital(who, "Stamina"))  > AP_GetVitalMaximumValue(who, "Stamina"))
+	  heal_amount := AP_GetVitalMaximumValue(who, "Stamina") - AP_GetVital(who, "Stamina");
     endif
-	SetStamina(who, GetStamina(who) + heal_amount);
+	AP_SetVital(who, "Stamina", AP_GetVital(who, "Stamina") + heal_amount);
   endif
   empty_bottle(who, potion);
   PlayObjectCenteredEffect(who, EFFECT_SPARKLE, 10,10);



From austin at berlios.de  Wed Nov  2 10:20:56 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 10:20:56 +0100
Subject: [Poldistro-svn] r825 - trunk/096/pkg/skills/cooking
Message-ID: <200511020920.jA29KusJ014598@sheep.berlios.de>

Author: austin
Date: 2005-11-02 10:20:53 +0100 (Wed, 02 Nov 2005)
New Revision: 825

Modified:
   trunk/096/pkg/skills/cooking/cooking.src
Log:
Attribute updates.

Modified: trunk/096/pkg/skills/cooking/cooking.src
===================================================================
--- trunk/096/pkg/skills/cooking/cooking.src	2005-11-02 09:19:17 UTC (rev 824)
+++ trunk/096/pkg/skills/cooking/cooking.src	2005-11-02 09:20:53 UTC (rev 825)
@@ -77,16 +77,16 @@
     endif
   endif
   if(!points)
-    points := GetEffectiveSkill(who, SKILLID_COOKING) * 2;
+    points := AP_GetSkill(who, "Cooking") * 2;
   endif
   if(skill_needed)
-    if(CheckSkill( who, SKILLID_COOKING, skill_needed, 0));
+    if( SkillCheck(who, "Cooking", skill_needed) > 0 )
       var amt := item.amount;
       if(DestroyItem(item))
         newitem := CreateItemInBackpack(who, product, amt);
         if(newitem)
 	      SendSysMessage(who, "You put the item in your pack.");
-	      AwardRawSkillPoints(who, SKILLID_COOKING, GetPoints(who, skill_needed, points));
+	      //AwardRawSkillPoints(who, SKILLID_COOKING, GetPoints(who, skill_needed, points));
 	    else
 	      SendSysMessage(who, "You dont have any room in your backpack.");
 	    endif



From austin at berlios.de  Wed Nov  2 10:23:25 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 10:23:25 +0100
Subject: [Poldistro-svn] r826 - trunk/096/pkg/systems/attributes/include
Message-ID: <200511020923.jA29NP6V015149@sheep.berlios.de>

Author: austin
Date: 2005-11-02 10:23:08 +0100 (Wed, 02 Nov 2005)
New Revision: 826

Modified:
   trunk/096/pkg/systems/attributes/include/attributeConstants.inc
   trunk/096/pkg/systems/attributes/include/attributes.inc
Log:
Attributes.inc includes constants file.
Constants ATTRIBUTE_* renamed to ATTRIB_*


Modified: trunk/096/pkg/systems/attributes/include/attributeConstants.inc
===================================================================
--- trunk/096/pkg/systems/attributes/include/attributeConstants.inc	2005-11-02 09:20:53 UTC (rev 825)
+++ trunk/096/pkg/systems/attributes/include/attributeConstants.inc	2005-11-02 09:23:08 UTC (rev 826)
@@ -13,62 +13,62 @@
 endenum
 
 enum ATTRIBUTE_STATS
-	ATTRIBUTE_STRENGTH                  := "Strength",
-	ATTRIBUTE_DEXTERITY                 := "Dexterity",
-	ATTRIBUTE_INTELLIGENCE              := "Intelligence"
+	ATTRIB_STRENGTH                  := "Strength",
+	ATTRIB_DEXTERITY                 := "Dexterity",
+	ATTRIB_INTELLIGENCE              := "Intelligence"
 endenum
 
 enum ATTRIBUTE_SKILLS
-	ATTRIBUTE_ALCHEMY                   := "Alchemy",
-	ATTRIBUTE_ANATOMY                   := "Anatomy",
-	ATTRIBUTE_ANIMAL_LORE               := "AnimalLore",
-	ATTRIBUTE_ITEM_IDENTIFICATION       := "ItemIdentification",
-	ATTRIBUTE_ARMS_LORE                 := "ArmsLore",
-	ATTRIBUTE_PARRY                     := "Parry",
-	ATTRIBUTE_BEGGING                   := "Begging",
-	ATTRIBUTE_BLACKSMITHY               := "Blacksmithy",
-	ATTRIBUTE_BOWCRAP_T_FLETCHING       := "BowcraftFletching",
-	ATTRIBUTE_PEACEMAKING               := "Peacemaking",
-	ATTRIBUTE_CAMPING                   := "Camping",
-	ATTRIBUTE_CARPENTRY                 := "Carpentry",
-	ATTRIBUTE_CARTOGRAPHY               := "Cartography",
-	ATTRIBUTE_COOKING                   := "Cooking",
-	ATTRIBUTE_DETECTING_HIDDEN          := "DetectingHidden",
-	ATTRIBUTE_DISCORDANCE               := "Discordance",
-	ATTRIBUTE_EVALUATING_INTELLIGENCE   := "EvaluatingIntelligence",
-	ATTRIBUTE_HEALING                   := "Healing",
-	ATTRIBUTE_FISHING                   := "Fishing",
-	ATTRIBUTE_FORENSIC_EVALUATION       := "ForensicEvaluation",
-	ATTRIBUTE_HERDING                   := "Herding",
-	ATTRIBUTE_HIDING                    := "Hiding",
-	ATTRIBUTE_PROVOCATION               := "Provocation",
-	ATTRIBUTE_INSCRIPTION               := "Inscription",
-	ATTRIBUTE_LOCKPICKING               := "Lockpicking",
-	ATTRIBUTE_MAGERY                    := "Magery",
-	ATTRIBUTE_RESISTING_SPELLS          := "ResistingSpells",
-	ATTRIBUTE_TACTICS                   := "Tactics",
-	ATTRIBUTE_SNOOPING                  := "Snooping",
-	ATTRIBUTE_MUSICIANSHIP              := "Musicianship",
-	ATTRIBUTE_POISONING                 := "Poisoning",
-	ATTRIBUTE_ARCHERY                   := "Archery",
-	ATTRIBUTE_SPIRIT_SPEAK              := "SpiritSpeak",
-	ATTRIBUTE_STEALING                  := "Stealing",
-	ATTRIBUTE_TAILORING                 := "Tailoring",
-	ATTRIBUTE_ANIMAL_TAMING             := "AnimalTaming",
-	ATTRIBUTE_TASTE_IDENTIFICATION      := "TasteIdentification",
-	ATTRIBUTE_TINKERING                 := "Tinkering",
-	ATTRIBUTE_TRACKING                  := "Tracking",
-	ATTRIBUTE_VETERINARY                := "Veterinary",
-	ATTRIBUTE_SWORDSMANSHIP             := "Swordsmanship",
-	ATTRIBUTE_MACE_FIGHTING             := "MaceFighting",
-	ATTRIBUTE_FENCING                   := "Fencing",
-	ATTRIBUTE_WRESTLING                 := "Wrestling",
-	ATTRIBUTE_LUMBERJACKING             := "Lumberjacking",
-	ATTRIBUTE_MINING                    := "Mining",
-	ATTRIBUTE_MEDITATION                := "Meditation",
-	ATTRIBUTE_STEALTH                   := "Stealth",
-	ATTRIBUTE_REMOVE_TRAP               := "RemoveTrap",
-	ATTRIBUTE_NECROMANCY                := "Necromancy",
-	ATTRIBUTE_BATTLE_FOCUS              := "BattleFocus",
-	ATTRIBUTE_CHIVALRY                  := "Chivalry"
+	ATTRIB_ALCHEMY                   := "Alchemy",
+	ATTRIB_ANATOMY                   := "Anatomy",
+	ATTRIB_ANIMAL_LORE               := "AnimalLore",
+	ATTRIB_ITEM_IDENTIFICATION       := "ItemIdentification",
+	ATTRIB_ARMS_LORE                 := "ArmsLore",
+	ATTRIB_PARRY                     := "Parry",
+	ATTRIB_BEGGING                   := "Begging",
+	ATTRIB_BLACKSMITHY               := "Blacksmithy",
+	ATTRIB_BOWCRAP_T_FLETCHING       := "BowcraftFletching",
+	ATTRIB_PEACEMAKING               := "Peacemaking",
+	ATTRIB_CAMPING                   := "Camping",
+	ATTRIB_CARPENTRY                 := "Carpentry",
+	ATTRIB_CARTOGRAPHY               := "Cartography",
+	ATTRIB_COOKING                   := "Cooking",
+	ATTRIB_DETECTING_HIDDEN          := "DetectingHidden",
+	ATTRIB_DISCORDANCE               := "Discordance",
+	ATTRIB_EVALUATING_INTELLIGENCE   := "EvaluatingIntelligence",
+	ATTRIB_HEALING                   := "Healing",
+	ATTRIB_FISHING                   := "Fishing",
+	ATTRIB_FORENSIC_EVALUATION       := "ForensicEvaluation",
+	ATTRIB_HERDING                   := "Herding",
+	ATTRIB_HIDING                    := "Hiding",
+	ATTRIB_PROVOCATION               := "Provocation",
+	ATTRIB_INSCRIPTION               := "Inscription",
+	ATTRIB_LOCKPICKING               := "Lockpicking",
+	ATTRIB_MAGERY                    := "Magery",
+	ATTRIB_RESISTING_SPELLS          := "ResistingSpells",
+	ATTRIB_TACTICS                   := "Tactics",
+	ATTRIB_SNOOPING                  := "Snooping",
+	ATTRIB_MUSICIANSHIP              := "Musicianship",
+	ATTRIB_POISONING                 := "Poisoning",
+	ATTRIB_ARCHERY                   := "Archery",
+	ATTRIB_SPIRIT_SPEAK              := "SpiritSpeak",
+	ATTRIB_STEALING                  := "Stealing",
+	ATTRIB_TAILORING                 := "Tailoring",
+	ATTRIB_ANIMAL_TAMING             := "AnimalTaming",
+	ATTRIB_TASTE_IDENTIFICATION      := "TasteIdentification",
+	ATTRIB_TINKERING                 := "Tinkering",
+	ATTRIB_TRACKING                  := "Tracking",
+	ATTRIB_VETERINARY                := "Veterinary",
+	ATTRIB_SWORDSMANSHIP             := "Swordsmanship",
+	ATTRIB_MACE_FIGHTING             := "MaceFighting",
+	ATTRIB_FENCING                   := "Fencing",
+	ATTRIB_WRESTLING                 := "Wrestling",
+	ATTRIB_LUMBERJACKING             := "Lumberjacking",
+	ATTRIB_MINING                    := "Mining",
+	ATTRIB_MEDITATION                := "Meditation",
+	ATTRIB_STEALTH                   := "Stealth",
+	ATTRIB_REMOVE_TRAP               := "RemoveTrap",
+	ATTRIB_NECROMANCY                := "Necromancy",
+	ATTRIB_BATTLE_FOCUS              := "BattleFocus",
+	ATTRIB_CHIVALRY                  := "Chivalry"
 endenum

Modified: trunk/096/pkg/systems/attributes/include/attributes.inc
===================================================================
--- trunk/096/pkg/systems/attributes/include/attributes.inc	2005-11-02 09:20:53 UTC (rev 825)
+++ trunk/096/pkg/systems/attributes/include/attributes.inc	2005-11-02 09:23:08 UTC (rev 826)
@@ -19,6 +19,7 @@
 include ":attributes:skills";
 include ":attributes:stats";
 include ":attributes:vitals";
+include ":attributes:attributeConstants";
 include ":attributes:skillCheck";
 include ":attributes:advanceCheck";
 include ":datafile:datafile";



From austin at berlios.de  Wed Nov  2 10:25:13 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 10:25:13 +0100
Subject: [Poldistro-svn] r827 - trunk/096/pkg/skills/forensicevaluation
Message-ID: <200511020925.jA29PDTT015595@sheep.berlios.de>

Author: austin
Date: 2005-11-02 10:25:12 +0100 (Wed, 02 Nov 2005)
New Revision: 827

Modified:
   trunk/096/pkg/skills/forensicevaluation/forensic.src
Log:
Attribute updates.

Modified: trunk/096/pkg/skills/forensicevaluation/forensic.src
===================================================================
--- trunk/096/pkg/skills/forensicevaluation/forensic.src	2005-11-02 09:23:08 UTC (rev 826)
+++ trunk/096/pkg/skills/forensicevaluation/forensic.src	2005-11-02 09:25:12 UTC (rev 827)
@@ -15,11 +15,11 @@
     SendSysMessage(who, "Targetting cancelled.");
     return;
   endif
-  var pts := GetEffectiveSkill(who, SKILLID_FORENSICS)*2;
+  var pts := AP_GetSkill(who, "ForensicEvaluation")*2;
   if(pts < 10)
     pts := 10;
   endif
-  if (CheckSkill(who, SKILLID_FORENSICS, -1, pts))
+  if (SkillCheck(who, "ForensicEvaluation", -1) > 0)
     var lastHit := array;
     var kname, kserial, kweapon, strmessage;
     lastHit := GetObjProperty(what, "LastHit");



From austin at berlios.de  Wed Nov  2 10:30:12 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 10:30:12 +0100
Subject: [Poldistro-svn] r828 - trunk/096/pkg/skills/healing
Message-ID: <200511020930.jA29UCjF016977@sheep.berlios.de>

Author: austin
Date: 2005-11-02 10:30:10 +0100 (Wed, 02 Nov 2005)
New Revision: 828

Modified:
   trunk/096/pkg/skills/healing/healing.src
Log:
Attribute updates

Modified: trunk/096/pkg/skills/healing/healing.src
===================================================================
--- trunk/096/pkg/skills/healing/healing.src	2005-11-02 09:25:12 UTC (rev 827)
+++ trunk/096/pkg/skills/healing/healing.src	2005-11-02 09:30:10 UTC (rev 828)
@@ -36,7 +36,7 @@
 	elseif(!CheckLineOfSight(who,patient))
 		SendSysMessage(who,"You can't see your patient.");
 		return;
-	elseif((GetHp(patient) >= GetMaxHp(patient)) and (poisons.size() == 0))
+	elseif((AP_GetVital(patient, "Hits") >= AP_GetVitalMaximumValue(patient, "Hits")) and (poisons.size() == 0))
 		SendSysMessage(who,"Your patient is at full health.");
 		return;
 	endif
@@ -152,12 +152,12 @@
 	
 	// Determine how many attempts are made to heal.
 	if(patient == who)
-		var dexcheck := (GetBaseDexterity(who) / 20);
+		var dexcheck := (AP_GetTrueStat(who, "Dexterity") / 20);
 		cycles := (15 - dexcheck);
 	else
-		if(GetDexterity(who) <= 33)
+		if(AP_GetStat(who, "Dexterity") <= 33)
 			cycles := 5;
-		elseif(GetDexterity(who) <= 67)
+		elseif(AP_GetStat(who, "Dexterity") <= 67)
 			cycles := 4;
 		else
 			cycles := 3;
@@ -169,7 +169,7 @@
 	//	2- test for fumbles during the healing process and lower the amount of healing
 	// All healing occurs in the last pass of the loop.
 	while(counter <= cycles)
-		var chp := GetHP(who);
+		var chp := AP_GetVital(who, "Hits");
 		sleep(1);
 		if (counter%4 == 0)
 			SendSysMessage(patient, who.name + " continues to heal you.");
@@ -185,7 +185,7 @@
 			SendSysMessage(who,"Your patient isn't close enough.");
 			SendSysMessage(patient, who.name + "has stopped healing you.");
 			break;
-		elseif(GetHP(patient) >= GetMaxHP(patient))
+		elseif(AP_GetVital(patient, "Hits") >= AP_GetVitalMaximumValue(patient, "Hits"))
 			SendSysMessage(who, "Your patient is at full health.");
 			SendSysMessage(patient, who.name + " has stopped healing you.");
 			break;
@@ -215,8 +215,8 @@
 			break;
 		
 		// Testing to see if things are fumbled.  If they fumble too badly, 
-		elseif(GetHP(who) < chp)
-			if((RandomInt(basehealamt) + 1) >= GetDexterity(who))
+		elseif(AP_GetVital(who, "Hits") < chp)
+			if((RandomInt(basehealamt) + 1) >= AP_GetStat(who, "Dexterity"))
 				SendSysMessage(who, "Your fingers slip." );
 				if(count >= 5)
 					healamt := -1;
@@ -228,9 +228,9 @@
 		
 		// The last cycle of the loop.  All actual healing is done here.
 		elseif(counter >= cycles)
-			var diff := 100 - Cint((GetHP(patient) * 100.0) / GetMaxHP(patient));
-			if((CheckSkill(who, SKILLID_HEALING, diff, 0)) and (healamt != -1))
-				var chkamt := Cint(GetMaxHP(patient) - GetHP(patient));
+			var diff := 100 - Cint((AP_GetVital(patient, "Hits") * 100.0) / AP_GetVitalMaximumValue(patient, "Hits"));
+			if((SkillCheck(who, "Healing", diff, 0) > 0) and (healamt != -1))
+				var chkamt := Cint(AP_GetVitalMaximumValue(patient, "Hits") - AP_GetVital(patient, "Hits"));
 				if(healamt > chkamt)
 					healamt := chkamt;
 					SendSysMessage(who, "You have healed your patient completely.");
@@ -240,7 +240,7 @@
 					SendSysMessage(patient, who.name + " has healed you.");
 				endif
 				healdamage(patient, healamt);
-				AwardPoints(who, SKILLID_HEALING, (healamt * 2));
+				//AwardPoints(who, SKILLID_HEALING, (healamt * 2));
 				break;
 			else
 				// Throw 'em a bone.  No chance of gain, though.
@@ -260,19 +260,19 @@
 	var cycles;
 	var count := 0;
 	if(patient == who)
-		var dexcheck := (GetBaseDexterity(who) / 33);
+		var dexcheck := (AP_GetTrueStat(who, "Dexterity") / 33);
 		cycles := (15 - dexcheck);
 	else
-		if(GetBaseDexterity(who) <= 33)
+		if(AP_GetTrueStat(who, "Dexterity") <= 33)
 			cycles := 5;
-		elseif(GetBaseDexterity(who) <= 67)
+		elseif(AP_GetTrueStat(who, "Dexterity") <= 67)
 			cycles := 4;
 		else
 			cycles := 3;
 		endif
 	endif
 	while(counter <= cycles)
-		var chp := GetHP(who);
+		var chp := AP_GetVital(who, "Hits");
 		sleep(1);
 		if(!GetObjProperty(who, "HealTimer"))
 			SendSysMessage(who, "You stop healing your patient.");
@@ -296,8 +296,8 @@
 			endif
 			heal(who, patient, counter);
 			break;
-		elseif(GetHP(who) < chp)
-			if((RandomInt(100)+1) > GetBaseDexterity(who))
+		elseif(AP_GetVital(who, "Hits") < chp)
+			if((RandomInt(100)+1) > AP_GetTrueStat(who, "Dexterity"))
 				SendSysMessage( who, "Your fingers slip." );
 				healamt := (healamt - 1);
 				count := count + 1;
@@ -307,16 +307,16 @@
 			endif
 		endif
 		if(counter >= cycles)
-			if(CheckSkill(who, SKILLID_HEALING, 48, 0))
+			if(SkillCheck(who, "Healing", 48, 0) > 0)
 				TS_CurePoison(patient, 120, "P", healamt);
 	if (TS_GetTimerNames(patient, "P").size() == 0)
 					SendSysMessage(who,"You have cured your patient completely.");
 					SendSysMessage(patient, who.name + " has cured you completely.");
-					AwardPoints(who, SKILLID_HEALING, (healamt * 100));
+					//AwardPoints(who, SKILLID_HEALING, (healamt * 100));
 	else
 		SendSysMessage(who, "You have helped but your patient is still poisoned.");
 		SendSysMessage(patient, who.name + " has tried to cure your poison.");
-		AwardPoints(who, SKILLID_HEALING, (CInt(healamt/2) * 100));
+		//AwardPoints(who, SKILLID_HEALING, (CInt(healamt/2) * 100));
 	endif
 				break;
 			else
@@ -332,7 +332,7 @@
 	SendSysMessage(who,"You start to resurrect " + patient.name + ".");
 	SendSysMessage(patient, who.name + " starts to resurrect you.");
 	while(counter <= 10)
-		var chp := GetHP(who);
+		var chp := AP_GetVital(who, "Hits");
 		sleep(1);
 		if(!GetObjProperty(who, "HealTimer"))
 			SendSysMessage(who, "You stop reviving your patient.");
@@ -344,8 +344,8 @@
 			SendSysMessage(who,"Your patient isn't close enough.");
 			SendSysMessage(patient, who.name + "has stopped healing you.");
 			break;
-		elseif(GetHP(who) < chp)
-			if((RandomInt(100)+1) > GetBaseDexterity(who))
+		elseif(AP_GetVital(who, "Hits") < chp)
+			if((RandomInt(100)+1) > AP_GetTrueStat(who, "Dexterity"))
 				SendSysMessage(who, "Your fingers slip.");
 				healamt := healamt + 5;
 			endif
@@ -358,8 +358,8 @@
 			break;
 		endif
 		if(counter >= 10)
-			if(CheckSkill(who, SKILLID_HEALING, healamt, 0))
-				AwardPoints(who, SKILLID_HEALING, 400);
+			if(SkillCheck(who, "Healing", healamt, 0) > 0)
+				//AwardPoints(who, SKILLID_HEALING, 400);
 				if(do_res(who, patient))
 					SendSysMessage(who, "You have resurrected " + patient.name + ".");
 				else



From austin at berlios.de  Wed Nov  2 10:32:34 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 10:32:34 +0100
Subject: [Poldistro-svn] r829 - trunk/096/pkg/skills/inscription
Message-ID: <200511020932.jA29WYDg017404@sheep.berlios.de>

Author: austin
Date: 2005-11-02 10:32:32 +0100 (Wed, 02 Nov 2005)
New Revision: 829

Modified:
   trunk/096/pkg/skills/inscription/inscription.src
Log:
Attribute updates

Modified: trunk/096/pkg/skills/inscription/inscription.src
===================================================================
--- trunk/096/pkg/skills/inscription/inscription.src	2005-11-02 09:30:10 UTC (rev 828)
+++ trunk/096/pkg/skills/inscription/inscription.src	2005-11-02 09:32:32 UTC (rev 829)
@@ -75,9 +75,9 @@
       SendSysMessage(who,"You do not have enough mana.");
       return;
     endif
-    if((ConsumeReagents(who, spellnum)) && (GetMana(who) >= themana))
-      SetMana(who, GetMana(who) - themana);
-      if(CheckSkill(who, SKILLID_INSCRIPTION, skill, points))
+    if((ConsumeReagents(who, spellnum)) && (AP_GetVital(who, "Mana") >= themana))
+      AP_SetVital(who, "Mana", AP_GetVital(who, "Mana") - themana);
+      if(SkillCheck(who, "Inscription", skill, points) > 0)
         PlaySoundEffect(who, 0x24a);
         if(SubtractAmount(the_item,1))
           var thescroll := CreateItemInBackpack(who, product);
@@ -85,7 +85,7 @@
             SendSysMessage(who,"Your backpack is too full to create the scroll.");
             return;
           endif
-          var myskill := CInt(GetEffectiveSkill(who, SKILLID_INSCRIPTION));
+          var myskill := CInt(AP_GetSkill(who, "Inscription"));
           var modpts := 0;
           if(myskill >=  skill)
             modpts := (myskill - (skill - 10));
@@ -165,9 +165,9 @@
     SendSysMessage(who,"That is not a gate scroll.");
     return;
   endif
-  if(CheckSkill(who, SKILLID_INSCRIPTION, 70, 900))
+  if( SkillCheck(who, "Inscription", 70, 900) >0 )
     if(SubtractAmount(the_item, 1) && SubtractAmount(scrolls, 8) && SubtractAmount(recall, 1) && SubtractAmount(gate, 1))
-      var myskill := CInt(GetEffectiveSkill(who, SKILLID_CARPENTRY));
+      var myskill := CInt(AP_GetSkill(who, "Carpentry"));
       var modpts := 0;
       if(myskill >=  90)
         modpts := (myskill - 80);
@@ -244,7 +244,7 @@
     7: umana :=  40;
     8: umana :=  50;
   endcase
-  if(GetMana(who) >= umana)
+  if(AP_GetVital(who, "Mana") >= umana)
     return umana;
   else
     return 0;



From austin at berlios.de  Wed Nov  2 10:37:01 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 10:37:01 +0100
Subject: [Poldistro-svn] r830 - trunk/096/scripts/include
Message-ID: <200511020937.jA29b1S9018900@sheep.berlios.de>

Author: austin
Date: 2005-11-02 10:36:59 +0100 (Wed, 02 Nov 2005)
New Revision: 830

Modified:
   trunk/096/scripts/include/toolWear.inc
Log:
Attribute updates 

Modified: trunk/096/scripts/include/toolWear.inc
===================================================================
--- trunk/096/scripts/include/toolWear.inc	2005-11-02 09:32:32 UTC (rev 829)
+++ trunk/096/scripts/include/toolWear.inc	2005-11-02 09:36:59 UTC (rev 830)
@@ -1,3 +1,5 @@
+include ":attributes:attributes_ex";
+
 function CheckToolWear (who, tool, skillid)
   var swings := GetObjProperty(tool,"swings");
   if(!swings)
@@ -17,7 +19,7 @@
     DestroyItem(tool);
     SendSysMessage(who,"Your tool broke.");
   else
-    var skill := GetAttribute(who, GetAttributeIdBySkillId(skillid));
+    var skill := GetAttribute(who, AP_SkillIdToAttributeName(skillid));
     if(skill > 80)
       skill := 80;
     elseif(skill < 20)



From austin at berlios.de  Wed Nov  2 10:38:16 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 10:38:16 +0100
Subject: [Poldistro-svn] r831 - trunk/096/pkg/skills/lumberjacking
Message-ID: <200511020938.jA29cGHO019445@sheep.berlios.de>

Author: austin
Date: 2005-11-02 10:38:14 +0100 (Wed, 02 Nov 2005)
New Revision: 831

Modified:
   trunk/096/pkg/skills/lumberjacking/lumberjack.src
Log:
Attribute updates

Modified: trunk/096/pkg/skills/lumberjacking/lumberjack.src
===================================================================
--- trunk/096/pkg/skills/lumberjacking/lumberjack.src	2005-11-02 09:36:59 UTC (rev 830)
+++ trunk/096/pkg/skills/lumberjacking/lumberjack.src	2005-11-02 09:38:14 UTC (rev 831)
@@ -69,8 +69,8 @@
     SendSysMessage(me,"You stop chopping.");
     return 1;
   endif
-  var points := CInt((GetEffectiveSkill(me, SKILLID_LUMBERJACKING) * 2) + 10);
-  if(CheckSkill(me, SKILLID_LUMBERJACKING, difficulty, points))
+  var points := CInt((AP_GetSkill(me, "Lumberjacking") * 2) + 10);
+  if(SkillCheck(me, "Lumberjacking", difficulty) > 0)
     var wood_amount := HarvestResource( "wood", tree.x, tree.y, 1, 10, me.realm );
     if(wood_amount == 0)
       SendSysMessage(me, "There's not enough wood here to chop.");
@@ -526,7 +526,7 @@
       SendSysMessage(who, "I don't know how to make that.");
       return;
     endif
-    var myskill := CInt(GetEffectiveSkill(who, SKILLID_BOWCRAFT));
+    var myskill := CInt(AP_GetSkill(who, "BowcraftFletching"));
     var modpts := 0;
     if(myskill >=  difficulty)
       modpts := (myskill - difficulty);
@@ -544,7 +544,7 @@
 
 function setquality(who, bow)
   var tname := TruncateArticle(bow.name);
-  if(CInt(GetEffectiveSkill(who, SKILLID_BOWCRAFT)) >= 99)
+  if(CInt(AP_GetSkill(who, "BowcraftFletching")) >= 99)
     bow.name := "an exceptional " + tname + " [crafted by " + who.name + "]";
   else
     bow.name := "an exceptional " + tname;



From austin at berlios.de  Wed Nov  2 11:13:19 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 11:13:19 +0100
Subject: [Poldistro-svn] r832 - trunk/096/pkg/systems/attributes/include
Message-ID: <200511021013.jA2ADJS8027554@sheep.berlios.de>

Author: austin
Date: 2005-11-02 11:13:17 +0100 (Wed, 02 Nov 2005)
New Revision: 832

Modified:
   trunk/096/pkg/systems/attributes/include/attributeConstants.inc
Log:


Modified: trunk/096/pkg/systems/attributes/include/attributeConstants.inc
===================================================================
--- trunk/096/pkg/systems/attributes/include/attributeConstants.inc	2005-11-02 09:38:14 UTC (rev 831)
+++ trunk/096/pkg/systems/attributes/include/attributeConstants.inc	2005-11-02 10:13:17 UTC (rev 832)
@@ -7,68 +7,68 @@
 use uo;
 
 enum VITALS
-	VITAL_HITS         := "Hits",
-	VITAL_MANA         := "Mana",
-	VITAL_STAMINA      := "Stamina"
+	HITS			:= "Hits",
+	MANA			:= "Mana",
+	STAMINA			:= "Stamina"
 endenum
 
 enum ATTRIBUTE_STATS
-	ATTRIB_STRENGTH                  := "Strength",
-	ATTRIB_DEXTERITY                 := "Dexterity",
-	ATTRIB_INTELLIGENCE              := "Intelligence"
+	STRENGTH		:= "Strength",
+	DEXTERITY		:= "Dexterity",
+	INTELLIGENCE		:= "Intelligence"
 endenum
 
 enum ATTRIBUTE_SKILLS
-	ATTRIB_ALCHEMY                   := "Alchemy",
-	ATTRIB_ANATOMY                   := "Anatomy",
-	ATTRIB_ANIMAL_LORE               := "AnimalLore",
-	ATTRIB_ITEM_IDENTIFICATION       := "ItemIdentification",
-	ATTRIB_ARMS_LORE                 := "ArmsLore",
-	ATTRIB_PARRY                     := "Parry",
-	ATTRIB_BEGGING                   := "Begging",
-	ATTRIB_BLACKSMITHY               := "Blacksmithy",
-	ATTRIB_BOWCRAP_T_FLETCHING       := "BowcraftFletching",
-	ATTRIB_PEACEMAKING               := "Peacemaking",
-	ATTRIB_CAMPING                   := "Camping",
-	ATTRIB_CARPENTRY                 := "Carpentry",
-	ATTRIB_CARTOGRAPHY               := "Cartography",
-	ATTRIB_COOKING                   := "Cooking",
-	ATTRIB_DETECTING_HIDDEN          := "DetectingHidden",
-	ATTRIB_DISCORDANCE               := "Discordance",
-	ATTRIB_EVALUATING_INTELLIGENCE   := "EvaluatingIntelligence",
-	ATTRIB_HEALING                   := "Healing",
-	ATTRIB_FISHING                   := "Fishing",
-	ATTRIB_FORENSIC_EVALUATION       := "ForensicEvaluation",
-	ATTRIB_HERDING                   := "Herding",
-	ATTRIB_HIDING                    := "Hiding",
-	ATTRIB_PROVOCATION               := "Provocation",
-	ATTRIB_INSCRIPTION               := "Inscription",
-	ATTRIB_LOCKPICKING               := "Lockpicking",
-	ATTRIB_MAGERY                    := "Magery",
-	ATTRIB_RESISTING_SPELLS          := "ResistingSpells",
-	ATTRIB_TACTICS                   := "Tactics",
-	ATTRIB_SNOOPING                  := "Snooping",
-	ATTRIB_MUSICIANSHIP              := "Musicianship",
-	ATTRIB_POISONING                 := "Poisoning",
-	ATTRIB_ARCHERY                   := "Archery",
-	ATTRIB_SPIRIT_SPEAK              := "SpiritSpeak",
-	ATTRIB_STEALING                  := "Stealing",
-	ATTRIB_TAILORING                 := "Tailoring",
-	ATTRIB_ANIMAL_TAMING             := "AnimalTaming",
-	ATTRIB_TASTE_IDENTIFICATION      := "TasteIdentification",
-	ATTRIB_TINKERING                 := "Tinkering",
-	ATTRIB_TRACKING                  := "Tracking",
-	ATTRIB_VETERINARY                := "Veterinary",
-	ATTRIB_SWORDSMANSHIP             := "Swordsmanship",
-	ATTRIB_MACE_FIGHTING             := "MaceFighting",
-	ATTRIB_FENCING                   := "Fencing",
-	ATTRIB_WRESTLING                 := "Wrestling",
-	ATTRIB_LUMBERJACKING             := "Lumberjacking",
-	ATTRIB_MINING                    := "Mining",
-	ATTRIB_MEDITATION                := "Meditation",
-	ATTRIB_STEALTH                   := "Stealth",
-	ATTRIB_REMOVE_TRAP               := "RemoveTrap",
-	ATTRIB_NECROMANCY                := "Necromancy",
-	ATTRIB_BATTLE_FOCUS              := "BattleFocus",
-	ATTRIB_CHIVALRY                  := "Chivalry"
+	ALCHEMY			:= "Alchemy",
+	ANATOMY			:= "Anatomy",
+	ANIMAL_LORE		:= "AnimalLore",
+	ITEM_IDENTIFICATION	:= "ItemIdentification",
+	ARMS_LORE		:= "ArmsLore",
+	PARRY			:= "Parry",
+	BEGGING			:= "Begging",
+	BLACKSMITHY		:= "Blacksmithy",
+	BOWCRAFT_FLETCHING	:= "BowcraftFletching",
+	PEACEMAKING		:= "Peacemaking",
+	CAMPING			:= "Camping",
+	CARPENTRY		:= "Carpentry",
+	CARTOGRAPHY		:= "Cartography",
+	COOKING			:= "Cooking",
+	DETECTING_HIDDEN	:= "DetectingHidden",
+	DISCORDANCE		:= "Discordance",
+	EVALUATING_INTELLIGENCE	:= "EvaluatingIntelligence",
+	HEALING			:= "Healing",
+	FISHING			:= "Fishing",
+	FORENSIC_EVALUATION	:= "ForensicEvaluation",
+	HERDING			:= "Herding",
+	HIDING			:= "Hiding",
+	PROVOCATION		:= "Provocation",
+	INSCRIPTION		:= "Inscription",
+	LOCKPICKING		:= "Lockpicking",
+	MAGERY			:= "Magery",
+	RESISTING_SPELLS	:= "ResistingSpells",
+	TACTICS			:= "Tactics",
+	SNOOPING		:= "Snooping",
+	MUSICIANSHIP		:= "Musicianship",
+	POISONING		:= "Poisoning",
+	ARCHERY			:= "Archery",
+	SPIRIT_SPEAK		:= "SpiritSpeak",
+	STEALING		:= "Stealing",
+	TAILORING		:= "Tailoring",
+	ANIMAL_TAMING		:= "AnimalTaming",
+	TASTE_IDENTIFICATION	:= "TasteIdentification",
+	TINKERING		:= "Tinkering",
+	TRACKING		:= "Tracking",
+	VETERINARY		:= "Veterinary",
+	SWORDSMANSHIP		:= "Swordsmanship",
+	MACE_FIGHTING		:= "MaceFighting",
+	FENCING			:= "Fencing",
+	WRESTLING		:= "Wrestling",
+	LUMBERJACKING		:= "Lumberjacking",
+	MINING			:= "Mining",
+	MEDITATION		:= "Meditation",
+	STEALTH			:= "Stealth",
+	REMOVE_TRAP		:= "RemoveTrap",
+	NECROMANCY		:= "Necromancy",
+	BATTLE_FOCUS		:= "BattleFocus",
+	CHIVALRY		:= "Chivalry"
 endenum



From austin at berlios.de  Wed Nov  2 15:18:51 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 15:18:51 +0100
Subject: [Poldistro-svn] r835 - trunk/096/pkg/skills/lumberjacking
Message-ID: <200511021418.jA2EIpwP001639@sheep.berlios.de>

Author: austin
Date: 2005-11-02 15:18:41 +0100 (Wed, 02 Nov 2005)
New Revision: 835

Removed:
   trunk/096/pkg/skills/lumberjacking/config/
   trunk/096/pkg/skills/lumberjacking/lumberjack.src
   trunk/096/pkg/skills/lumberjacking/pkg.cfg
Log:
Going to put a new one in that supports regions and different wood types.

Deleted: trunk/096/pkg/skills/lumberjacking/lumberjack.src
===================================================================
--- trunk/096/pkg/skills/lumberjacking/lumberjack.src	2005-11-02 14:09:50 UTC (rev 834)
+++ trunk/096/pkg/skills/lumberjacking/lumberjack.src	2005-11-02 14:18:41 UTC (rev 835)
@@ -1,555 +0,0 @@
-use cfgfile;
-use uo;
-use os;
-use util;
-
-include "include/client";
-include "include/tileEffects";
-include "include/sound";
-include ":attributes:attributes";
-include "include/string";
-include "include/objtype";
-include "include/canAccess";
-include "include/utility";
-include "include/dist";
-include "include/toolWear";
-include "include/noto";
-
-const UACTION_CHOP := 0x0d;
-var bowcraftconfigfile := ReadConfigFile(":bowcraft:bowcraft");
-var mex;
-var mey;
-
-
-program use_axe(me, axe)
-  EraseObjProperty(me, "IsMeditating");
-  EraseObjProperty(me, "HealTimer");
-  if(!can_access(me, axe))
-    return;
-  endif
-  if(!ReserveItem(axe))
-    return;
-  endif
-  if(!IsAxEquipped(me, axe))
-    SendSysMessage(me,"You have to equip that to lumberjack!");
-    return;
-  endif
-  var tree := TreeNearby(me, axe);
-  if(!tree)
-    return;
-  endif
-  SendSysMessage(me, "You begin chopping...");
-  var checker := 0;
-  mex := me.x;
-  mey := me.y;
-  var mount;
-  repeat
-    mount := GetEquipmentByLayer(me, 25);
-    if(mount)
-      SendSysMessage(me,"You cannot chop wood while on horseback.");
-      return;
-    endif
-    if(!axe)
-      return;
-    endif
-    PerformAction(me, UACTION_CHOP);
-    PlaySoundEffect(me, SFX_SKILL_LUMBERJACK);
-    sleepms(2500);
-    checker := Do_Chops(me, axe, tree);
-  until(checker == 1);
-endprogram
-
-function Do_Chops(me, axe, tree)
-  var difficulty := GetHarvestDifficulty("wood", tree.x, tree.y, tree.objtype, me.realm);
-  if(difficulty == error)
-    SendSysMessage(me, "There's not enough wood here to chop.");
-    return 1;
-  endif
-  if((me.x != mex) || (me.y != mey))
-    SendSysMessage(me,"You stop chopping.");
-    return 1;
-  endif
-  var points := CInt((AP_GetSkill(me, "Lumberjacking") * 2) + 10);
-  if(SkillCheck(me, "Lumberjacking", difficulty) > 0)
-    var wood_amount := HarvestResource( "wood", tree.x, tree.y, 1, 10, me.realm );
-    if(wood_amount == 0)
-      SendSysMessage(me, "There's not enough wood here to chop.");
-      return 1;
-    endif
-    if(!CreateItemInBackpack(me, 0x1bdd, wood_amount))
-      SendSysMessage(me, "Your backpack is too full.");
-      return 1;
-    else
-      SendSysMessage(me, "You put some logs in your backpack");
-      CheckToolWear (me, axe, SKILLID_LUMBERJACKING);
-      return 0;
-    endif
-  else
-    SendSysMessage(me, "You fail to get any usable wood.");
-    return 0;
-  endif
-endfunction
-
-function TreeNearby(me, axe)
-  SendSysMessage( me, "Select something to chop." );
-  var tree := TargetCoordinates( me );
-  if(!tree)
-    SendSysMessage(me, "Cancelled");
-    return 0;
-  endif
-  var distt := coordist( me.x, me.y, tree.x, tree.y );
-  if(distt > 1 )
-    if(!tree.item.container)
-      SendSysMessage(me,"That is too far away.");
-      return 0;
-    endif
-  endif
-  if(is_furniture(tree.item.objtype, tree.item))
-    chopfurniture(me, tree.item);
-    return 0;
-  elseif(is_tree(tree.objtype))
-    var difficulty := GetHarvestDifficulty( "wood", tree.x, tree.y, tree.objtype, me.realm );
-    if(difficulty == error)
-      SendSysMessage(me, "There's not enough wood here to chop: " + difficulty.errortext + ".");
-      return 0;
-    endif
-    return tree;
-  else
-    use_blade(me, axe, tree.item);
-    return 0;
-  endif
-endfunction
-
-function is_furniture(theobj, thing)
-  var miscobjtypes := { 0x7007, 0xa30, 0xa34, 0xa38, 0xfae, 0x9e40};
-  if((theobj >= 0x9a8) && (theobj <= 0x9ab))
-    return 1;
-  elseif((theobj >= 0xa2a) && (theobj <= 0xa2c))
-    return 1;
-  elseif((theobj >= 0xa4c) && (theobj <= 0xa53))
-    return 1;
-  elseif((theobj >= 0xa97) && (theobj <= 0xa9e))
-    return 1;
-  elseif((theobj >= 0xb2c) && (theobj <= 0xb40))
-    return 1;
-  elseif((theobj >= 0xb49) && (theobj <= 0xb90))
-    return 1;
-  elseif((theobj >= 0xe3c) && (theobj <= 0xe43))
-    return 1;
-  elseif((theobj >= 0xe7c) && (theobj <= 0xe80))
-    return 1;
-  elseif((theobj >= 0xf65) && (theobj <= 0xf77))
-    return 1;
-  elseif(theobj in miscobjtypes)
-    return 1;
-  elseif(GetObjProperty(thing, "ItemsCreatedSerials"))
-    return 1;
-  else
-    return 0;
-  endif
-endfunction
-
-function is_tree(theobj)
-  if((theobj >= 0x0c99) && (theobj <= 0x0cea))
-    return 1;
-  elseif((theobj >= 0x0cf3) && (theobj <= 0x0d03))
-    return 1;
-  elseif((theobj >= 0x0d41) && (theobj <= 0x0dab))
-    return 1;
-  elseif((theobj >= 0x12b6) && (theobj <= 0x12c7))
-    return 1;
-  elseif((theobj >= 0x0d37) && (theobj <= 0x0d38))
-    return 1;
-  elseif((theobj == 0x0c9e) || (theobj == 0x0ca8) || (theobj == 0x0caa) || (theobj == 0x0cab))
-    return 1;
-  else
-    return 0;
-  endif
-endfunction
-
-
-function IsAxEquipped(me,axe)
-  if((!Accessible(me,axe)) || (Distance(me, axe) > 1))
-    return 0;
-  endif
-  foreach item in ListEquippedItems(me)
-    if (axe.serial == item.serial )
-      return 1;
-    endif
-  endforeach
-  return EquipItem(me, axe );
-endfunction
-
-function chopfurniture(me, theobj)
-  if(!can_access(me, theobj))
-    return;
-  endif
-  var sign;
-  if(GetObjProperty(theobj, "lockeddown") || GetObjProperty(theobj, "secure"))
-    SendSysMessage(me, "You cannot destroy secure or locked down items.");
-    return;
-  endif
-  if(theobj.objtype == 0x7007)
-    var houseserial := GetObjProperty(theobj, "houseserial");
-    sign := SystemFindObjectBySerial(houseserial);
-    if(GetObjProperty(sign, "barrelserial") == theobj.serial)
-      EraseObjProperty(sign, "barrelserial");
-      SendSysMessage(me, "You cannot destroy that while it is locked down.");
-      return;
-    endif
-  endif
-  if(!Accessible(me, theobj))
-    SendSysMessage(me, "You can't reach that.");
-    return;
-  endif
-  if(me.multi)
-    if(GetObjProperty((me.multi), "ownerserial") != me.serial)
-      var house := me.multi;
-      foreach thing in (house.components)
-        if((thing.objtype == 0x0bd0) || (thing.objtype == 0x0bd2))
-          sign := thing;
-          break;
-        endif
-      endforeach
-      var coowner := 0;
-      var coownerlist := GetObjProperty(sign, "coownerlist");
-      foreach thing in coownerlist
-        if(thing == me.serial)
-          coowner := 1;
-          break;
-        endif
-      endforeach
-      if(!coowner)
-        SendSysMessage(me, "This does not belong to you!");
-        return;
-      endif
-    endif
-  endif
-  foreach thing in EnumerateItemsInContainer(theobj)
-    if(theobj.container)
-      MoveItemToContainer(thing, theobj.container);
-    else
-      MoveItemToLocation(thing, theobj.x, theobj.y, theobj.z, MOVEITEM_FORCELOCATION);
-    endif
-  endforeach
-  if(theobj.usescript == ":tinkering:tinkerTraps")
-    var traptype := GetObjProperty(theobj,"trap_type");
-    var trapstrength := GetObjProperty(theobj,"trap_strength");
-    var trapperserial := CInt(GetObjProperty(theobj, "trapper"));
-    var trapper := SystemFindObjectBySerial(trapperserial, SYSFIND_SEARCH_OFFLINE_MOBILES);
-    if(trapper)
-      SetObjProperty(me, "LastHit", {trapper.name, trapper.serial, "trapped chest" });
-      SetScriptController(trapper);
-    endif
-    case (traptype)
-      "1" :   PlaySoundEffect(me, SFX_224);
-              var dmg := (RandomInt(20) + CInt(trapstrength));
-              SendSysMessage(me, "You set off a needle trap!");
-              ApplyDamage(me, dmg);
-              theobj.usescript := "";
-              EraseObjProperty( theobj, "trap_type" );
-              EraseObjProperty( theobj, "trap_strength" );
-
-      "2" :   start_script(":traps:poisonTrapTriggered", {me, theobj, "You set off a poison trap!", trapstrength});
-
-      "3" :   PlaySoundEffect(me, SFX_208);
-              SendSysMessage(me, "You set off an explosion trap!");
-              PlayObjectCenteredEffect( me, FX_EXPLODE_3, 10,10);
-              var dmg := (RandomInt(20) + CInt(trapstrength));
-              ApplyRawDamage(me, dmg);
-              theobj.usescript := "";
-              EraseObjProperty( theobj, "trap_type" );
-              EraseObjProperty( theobj, "trap_strength" );
-    endcase
-  endif
-  var created := GetObjProperty(theobj, "ItemsCreatedSerials");
-  if(created)
-    var holder;
-    foreach thing in created
-      holder := SystemFindObjectBySerial(thing);
-      if(holder)
-        DestroyItem(holder);
-      endif
-    endforeach
-  else
-    DestroyItem(theobj);
-  endif
-  PlaySoundEffect(me, 0x13a);
-  return;
-endfunction
-
-function use_blade(who, blade, use_on)
-  if(!can_access(who,use_on))
-    return;
-  endif
-  if(!ReserveItem(use_on))
-    return;
-  endif
-  var checkme := use_on.objtype;
-  if((checkme == UOBJ_LOGS) || (checkme == 0x1bd7))
-    CarveLogs(who, blade, use_on);
-  elseif(use_on.npctemplate == "sheep")
-    process_wool(who, blade, use_on);
-  elseif(use_on.objtype == UOBJ_CORPSE)
-    ReleaseItem(blade);
-    Carve_Corpse(who, use_on);
-  elseif(is_fish(checkme))
-    CarveFish(who, blade, use_on);
-  else
-    SendSysMessage(who, "You don't know how to use those items together.");
-  endif
-endfunction
-
-function process_wool(who, blade, sheep)
-  if(sheep.graphic == 207)
-    sheep.graphic := 223;
-    CreateItemInContainer(who.backpack, 0xf125, 3);
-    CheckToolWear (who, blade, SKILLID_TAILORING);
-  else
-    SendSysMessage(who,"That sheep is not yet ready to be shorn.");
-  endif
-endfunction
-
-function is_fish(theobj)
-  if((theobj >= UOBJ_FISH_START) && (theobj <= UOBJ_FISH_END) )
-    return 1;
-  elseif ((theobj >= UOBJ_SFISH_START) && (theobj <= UOBJ_SFISH_END))
-    return 1;
-  else
-    return 0;
-  endif
-endfunction
-
-function CarveFish(who, blade, use_on)
-  if((!ReserveItem(use_on)) || (use_on.movable == 0))
-    SendSysMessage(who, "You cannot use that.");
-    return;
-  endif
-  var num_steaks := (4 * use_on.amount);
-  PlaySoundEffect(who, SFX_57);
-  if(DestroyItem(use_on))
-    CreateItemInBackpack(who, UOBJ_FISHSTEAK, num_steaks);
-    CheckToolWear (who, blade, SKILLID_FISHING);
-    SendSysMessage(who, "You carve the fish steaks and put them in your backpack.");
-  endif
-  sleep(1);
-endfunction
-
-function Carve_Corpse(who, cadaver)
-  Detach();
-  if((!Accessible(who, cadaver)) or (!CheckLineOfSight(who, cadaver)))
-    SendSysMessage(who, "You cannot use that.");
-    return;
-  endif
-  if(Distance(who, cadaver) > 2)
-    SendSysMessage(who, "You are not close enough.");
-    return;
-  endif
-  var c_type := cadaver.corpsetype;
-  if(GetObjProperty(cadaver, "cut") == "1")
-    SendSysMessage( who, "You cannot get any more from this corpse." );
-    foreach thing in EnumerateItemsInContainer(cadaver)
-      MoveItemToLocation(thing, cadaver.x, cadaver.y, cadaver.z, MOVEITEM_FORCELOCATION);
-    endforeach
-    DestroyItem(cadaver);
-  elseif((c_type == 400) || (c_type == 401))
-    var beardlist := {0x203e, 0x203f, 0x2040, 0x2041, 0x204b, 0x204c, 0x204d };
-    var hairlist  := {0x2044, 0x2045, 0x2046, 0x2047, 0x2048, 0x2049, 0x204a, 0x203b, 0x203c, 0x203d };
-    foreach thing in EnumerateItemsInContainer(cadaver)
-      if((thing.objtype in hairlist) or (thing.objtype in beardlist))
-        DestroyItem(thing);
-      else
-        MoveItemToLocation(thing, cadaver.x, cadaver.y, cadaver.z, MOVEITEM_FORCELOCATION);
-      endif
-    endforeach
-    var partsarray := {};
-    var part;
-    part := CreateItemAtLocation(cadaver.x-1, cadaver.y, cadaver.z, 0x1da0, 1, who.realm);
-    partsarray.append(part);
-    SetObjProperty(part, "serial", GetObjProperty(cadaver, "serial"));
-    var aname := cadaver.name;
-    aname["A corpse of"] := "";
-    part.name := "The head of " + aname;
-    part := CreateItemAtLocation(cadaver.x-1, cadaver.y, cadaver.z, 0x1da1, 1, who.realm);
-    partsarray.append(part);
-    part := CreateItemAtLocation(cadaver.x-1, cadaver.y+1, cadaver.z, 0x1da2, 1, who.realm);
-    partsarray.append(part);
-    part := CreateItemAtLocation(cadaver.x+1, cadaver.y, cadaver.z, 0x1da3, 1, who.realm);
-    partsarray.append(part);
-    part := CreateItemAtLocation(cadaver.x+1, cadaver.y+1, cadaver.z, 0x1da4, 1, who.realm);
-    partsarray.append(part);
-    part := CreateItemAtLocation(cadaver.x, cadaver.y, cadaver.z, 0x1d9f, 1, who.realm);
-    partsarray.append(part);
-    var blood := CreateItemAtLocation(cadaver.x, cadaver.y, cadaver.z, 0x122a, 1, who.realm);
-    blood.movable := 0;
-    DestroyItem(cadaver);
-    sleep(40);
-    foreach thing in partsarray
-      if(!thing.container)
-        DestroyItem(thing);
-      endif
-    endforeach
-    sleep(20);
-    DestroyItem(blood);
-  else
-    if(c_type == 223)
-      CreateItemInContainer(cadaver, 0x9f1, 2);
-      SendSysMessage(who, "You place the items on the corpse.");
-      var theblood := CreateItemAtLocation(cadaver.x, cadaver.y, cadaver.z, UOBJ_BLOOD, 1, who.realm);
-      sleep(30);
-      DestroyItem(cadaver);
-      sleep(30);
-      DestroyItem(theblood);
-      return;
-    endif
-    var conf := ReadConfigFile(":*:npcdesc");
-    var tmplate := GetObjProperty(cadaver, "npctemplate");
-    if(!tmplate)
-      SendSysMessage(who, "You cut the corpse, but fail to find anything useful.", 3, 40);
-      var theblood := CreateItemAtLocation(cadaver.x, cadaver.y, cadaver.z, UOBJ_BLOOD, 1, who.realm);
-      sleep(30);
-      DestroyItem(cadaver);
-      sleep(30);
-      DestroyItem(theblood);
-      return;
-    else
-      SetObjProperty(cadaver, "cut","1");
-      var corpseitm := conf[tmplate]."corpseitm";
-      var corpseamt := conf[tmplate]."corpseamt";
-      print("I: " + corpseitm);
-      print("A: " + corpseamt);
-      if(!corpseitm)
-        print("error");
-        var theblood := CreateItemAtLocation(cadaver.x, cadaver.y, cadaver.z, UOBJ_BLOOD, 1, who.realm);
-        sleep(30);
-        DestroyItem(cadaver);
-        sleep(30);
-        DestroyItem(theblood);
-        return;
-      endif
-      var i := 1;
-      corpseitm := SplitWords(corpseitm);
-      corpseamt := SplitWords(corpseamt);
-      foreach thing in corpseitm
-        CreateItemInContainer(cadaver, thing, Cint(corpseamt[i]));
-        i := i + 1;
-      endforeach
-      SendSysMessage(who, "You place the items on the corpse.");
-      var theblood := CreateItemAtLocation(cadaver.x, cadaver.y, cadaver.z, UOBJ_BLOOD, 1, who.realm);
-      sleep(30);
-      DestroyItem(cadaver);
-      sleep(30);
-      DestroyItem(theblood);
-    endif
-  endif
-endfunction
-
-function CarveLogs(who, blade, logs)
-  if(logs.movable == 0)
-    SendSysMessage(who, "You cannot use those logs.");
-    return;
-  endif
-  if(!Accessible(who, logs))
-    SendSysMessage(who, "You cannot use that.");
-    return;
-  endif
-  if(!logs.container)
-    if(Distance(who, logs) > 2)
-      SendSysMessage(who, "That is too far away.");
-      return;
-    endif
-  endif
-  var selection := SelectMenuItem2(who, "BowcraftCarving");
-  if(!selection)
-    return;
-  endif
-  var what := selection.objtype;
-  if(!Accessible(who, logs))
-    SendSysMessage(who, "I can't access the logs to make that.");
-    return;
-  endif
-  var objectconfig := FindConfigElem(bowcraftconfigfile, what);
-  if(!objectconfig)
-    return;
-  endif
-  var material := CInt(GetConfigString(objectconfig, "Material"));
-  if(material > logs.amount)
-    SendSysMessage(who, "You don't have enough logs to make that.");
-    return;
-  endif
-  var difficulty := GetConfigInt(objectconfig, "Difficulty");
-  var pointvalue := GetConfigInt(objectconfig, "PointValue");
-  var bow := 0;
-  Detach();
-  PlaySoundEffect(who, 0x5a);
-  PerformAction(who, 0x021);
-  sleep(2);
-  PlaySoundEffect(who, 0x5a);
-  PerformAction(who, 0x021);
-  sleep(2);
-  PlaySoundEffect(who, 0x5a);
-  PerformAction(who, 0x021);
-  sleep(2);
-  PlaySoundEffect(who, 0x5a);
-  PerformAction(who, 0x021);
-  sleep(2);
-  if(CheckSkill(who, SKILLID_BOWCRAFT, difficulty, pointvalue))
-    if(what == UOBJ_SHAFTS)
-      var amt := logs.amount;
-      if(DestroyItem(logs))
-        CreateItemInBackpack(who, what, amt);
-        CheckToolWear (who, blade, SKILLID_BOWCRAFT);
-        SendSysMessage(who, "You create some shafts and place them in your pack." );
-      endif
-    elseif (what == UOBJ_BOW)
-      if(SubtractAmount(logs, material))
-        bow := CreateItemInBackpack(who, what);
-        CheckToolWear (who, blade, SKILLID_BOWCRAFT);
-        SendSysMessage(who, "You create a bow and place it in your pack.");
-        SetName(bow, "a bow");
-      endif
-    elseif (what == UOBJ_XBOW)
-      if(SubtractAmount(logs, material))
-        bow := CreateItemInBackpack(who, what);
-        CheckToolWear (who, blade, SKILLID_BOWCRAFT);
-        SendSysMessage(who, "You create a crossbow and place it in your pack.");
-        SetName(bow, "a crossbow");
-      endif
-    elseif (what == UOBJ_HEAVY_XBOW)
-      if(SubtractAmount(logs, material))
-        bow := CreateItemInBackpack(who, what);
-        CheckToolWear (who, blade, SKILLID_BOWCRAFT);
-        SendSysMessage(who, "You create a heavy crossbow and place it in your pack.");
-        SetName(bow, "a heavy crossbow");
-      endif
-    else
-      SendSysMessage(who, "I don't know how to make that.");
-      return;
-    endif
-    var myskill := CInt(AP_GetSkill(who, "BowcraftFletching"));
-    var modpts := 0;
-    if(myskill >=  difficulty)
-      modpts := (myskill - difficulty);
-    endif
-    var rint := RandomInt(100);
-    if(modpts >= rint)
-      ExceptionalFameMod(who, myskill, difficulty, Cint(pointvalue / 2));
-      setquality(who, bow);
-    endif
-  else
-    SubtractAmount(logs, (RandomInt(5) + 1));
-    SendSysMessage(who, "You destroy some logs.");
-  endif
-endfunction
-
-function setquality(who, bow)
-  var tname := TruncateArticle(bow.name);
-  if(CInt(AP_GetSkill(who, "BowcraftFletching")) >= 99)
-    bow.name := "an exceptional " + tname + " [crafted by " + who.name + "]";
-  else
-    bow.name := "an exceptional " + tname;
-  endif
-  bow.quality := bow.quality + 0.2;
-  bow.hp := bow.maxhp;
-  SendSysMessage(who, "You created an exceptional item.");
-endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/skills/lumberjacking/pkg.cfg
===================================================================
--- trunk/096/pkg/skills/lumberjacking/pkg.cfg	2005-11-02 14:09:50 UTC (rev 834)
+++ trunk/096/pkg/skills/lumberjacking/pkg.cfg	2005-11-02 14:18:41 UTC (rev 835)
@@ -1,8 +0,0 @@
-# $Id$
-#
-#
-Enabled         1
-Name		lumberjacking
-Maintainer      Distro Team
-Email           distro at polserver.com
-Version         1.0
\ No newline at end of file



From austin at berlios.de  Wed Nov  2 14:57:49 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 14:57:49 +0100
Subject: [Poldistro-svn] r833 - in trunk/096/pkg/mobiles/oldAI: . combat main
Message-ID: <200511021357.jA2Dvn1Q014830@sheep.berlios.de>

Author: austin
Date: 2005-11-02 14:57:44 +0100 (Wed, 02 Nov 2005)
New Revision: 833

Modified:
   trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
   trunk/096/pkg/mobiles/oldAI/combat/fight.inc
   trunk/096/pkg/mobiles/oldAI/combat/immobileFight.inc
   trunk/096/pkg/mobiles/oldAI/combat/packFight.inc
   trunk/096/pkg/mobiles/oldAI/crier.src
   trunk/096/pkg/mobiles/oldAI/escortee.src
   trunk/096/pkg/mobiles/oldAI/goodCaster.src
   trunk/096/pkg/mobiles/oldAI/helpPCs.src
   trunk/096/pkg/mobiles/oldAI/immobile.src
   trunk/096/pkg/mobiles/oldAI/immobileSpell.src
   trunk/096/pkg/mobiles/oldAI/main/killPCsLoop.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoop.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopAnimal.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopBarker.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopCat.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopChicken.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopCow.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopKillAny.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopMeek.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopWolf.inc
   trunk/096/pkg/mobiles/oldAI/main/meanLoop.inc
   trunk/096/pkg/mobiles/oldAI/main/packKillPCsLoop.inc
   trunk/096/pkg/mobiles/oldAI/main/sleepMode.inc
   trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc
   trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc
   trunk/096/pkg/mobiles/oldAI/townPerson.src
   trunk/096/pkg/mobiles/oldAI/vortexAI.src
   trunk/096/pkg/mobiles/oldAI/worker.src
Log:
Renamed herding(ev) to herdingloop(ev)


Modified: trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-02 13:57:44 UTC (rev 833)
@@ -193,7 +193,7 @@
   endif
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/combat/fight.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/fight.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/combat/fight.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -48,7 +48,7 @@
 			              DisableCombatEvents();
 			              EnableMainEvents();
 			              return;
-        EVID_HERDING:     Herding(ev);
+        EVID_HERDING:     HerdingLoop(ev);
 	  endcase
 	endif
   endwhile
@@ -89,7 +89,7 @@
 			  		        SetOpponent(opponent);
 			              endif
         EVID_PEACEMADE:   chk := 1;
-        EVID_HERDING:     Herding(ev);
+        EVID_HERDING:     HerdingLoop(ev);
 	  endcase
 	  if(chk)
 	    break;

Modified: trunk/096/pkg/mobiles/oldAI/combat/immobileFight.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/immobileFight.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/combat/immobileFight.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -44,7 +44,7 @@
 			            DisableCombatEvents();
 			            EnableMainEvents();
 			            return;
-      EVID_HERDING:     Herding(ev);
+      EVID_HERDING:     HerdingLoop(ev);
 	endcase
   endwhile
   post_combat();

Modified: trunk/096/pkg/mobiles/oldAI/combat/packFight.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/packFight.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/combat/packFight.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -69,7 +69,7 @@
                            DisableCombatEvents();
                            EnableMainEvents();
                            return;
-      EVID_HERDING:           Herding(ev);
+      EVID_HERDING:           HerdingLoop(ev);
     endcase
   endwhile
   post_combat();

Modified: trunk/096/pkg/mobiles/oldAI/crier.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/crier.src	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/crier.src	2005-11-02 13:57:44 UTC (rev 833)
@@ -39,7 +39,7 @@
   endcase
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/escortee.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-02 13:57:44 UTC (rev 833)
@@ -208,7 +208,7 @@
   endcase
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/goodCaster.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/goodCaster.src	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/goodCaster.src	2005-11-02 13:57:44 UTC (rev 833)
@@ -46,7 +46,7 @@
   endcase
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/helpPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/helpPCs.src	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/helpPCs.src	2005-11-02 13:57:44 UTC (rev 833)
@@ -41,7 +41,7 @@
   endcase
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/immobile.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/immobile.src	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/immobile.src	2005-11-02 13:57:44 UTC (rev 833)
@@ -35,7 +35,7 @@
   sleepms(100);
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/immobileSpell.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/immobileSpell.src	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/immobileSpell.src	2005-11-02 13:57:44 UTC (rev 833)
@@ -54,7 +54,7 @@
   sleepms(100);
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/killPCsLoop.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/killPCsLoop.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/killPCsLoop.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -33,7 +33,7 @@
         SYSEVENT_ENGAGED:       Fight(ev.source);
         EVID_ALL_ATTACK_CMD:    Fight(ev.source);
         SYSEVENT_DAMAGED:       Fight(ev.source);
-        EVID_HERDING:           Herding(ev);
+        EVID_HERDING:           HerdingLoop(ev);
       endcase
     endif
   endwhile
@@ -57,7 +57,7 @@
   DisableEvents(SYSEVENT_ENGAGED + SYSEVENT_DAMAGED + SYSEVENT_ENTEREDAREA);
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoop.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoop.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoop.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -15,7 +15,7 @@
         SYSEVENT_ENTEREDAREA: if((!critter.npctemplate) ||(critter.script == "tamed") || (critter.script == "employed"))
                                 Fight(ev.source);
                               endif
-        EVID_HERDING:         Herding(ev);
+        EVID_HERDING:         HerdingLoop(ev);
       endcase
     until(!(ev := os::wait_for_event(5)));
     if(ReadGameClock() > next_wander)
@@ -56,7 +56,7 @@
   cleareventque();
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopAnimal.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopAnimal.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopAnimal.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -15,7 +15,7 @@
         case(ev.type)
           SYSEVENT_DAMAGED: Fight(ev.source);
           SYSEVENT_ENGAGED: Fight(ev.source);
-          EVID_HERDING:     Herding(ev);
+          EVID_HERDING:     HerdingLoop(ev);
         endcase
       until(!(ev := os::wait_for_event(5)));
     endif
@@ -48,7 +48,7 @@
   DisableEvents(SYSEVENT_SPEECH + SYSEVENT_ENGAGED + SYSEVENT_DAMAGED + SYSEVENT_ENTEREDAREA);
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopBarker.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopBarker.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopBarker.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -19,7 +19,7 @@
                                 endif
           SYSEVENT_DAMAGED:     Fight(ev.source);
           SYSEVENT_ENGAGED:     RunLikeHell(ev.source);
-          EVID_HERDING:           Herding(ev);
+          EVID_HERDING:           HerdingLoop(ev);
         endcase
       until(!(ev := os::wait_for_event(2)));
     endif
@@ -107,7 +107,7 @@
   return noise;
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopCat.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopCat.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopCat.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -21,7 +21,7 @@
                                 endif
           SYSEVENT_DAMAGED:
           SYSEVENT_ENGAGED:     Fight(ev.source);
-          EVID_HERDING:         Herding(ev);
+          EVID_HERDING:         HerdingLoop(ev);
         endcase
       until(!(ev := os::wait_for_event(2)));
     endif
@@ -48,7 +48,7 @@
   DisableEvents(SYSEVENT_SPEECH + SYSEVENT_ENGAGED + SYSEVENT_DAMAGED + SYSEVENT_ENTEREDAREA);
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopChicken.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopChicken.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopChicken.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -24,7 +24,7 @@
         case(ev.type)
           SYSEVENT_DAMAGED: RunLikeHell(ev.source);
           SYSEVENT_ENGAGED: RunLikeHell(ev.source);
-          EVID_HERDING:     Herding(ev);
+          EVID_HERDING:     HerdingLoop(ev);
         endcase
       until(!(ev := os::wait_for_event(5)));
     endif
@@ -61,7 +61,7 @@
   DisableEvents(SYSEVENT_SPEECH + SYSEVENT_ENGAGED + SYSEVENT_DAMAGED + SYSEVENT_ENTEREDAREA);
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopCow.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopCow.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopCow.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -22,7 +22,7 @@
                                   endif
           SYSEVENT_DAMAGED:       Fight(ev.source);
           SYSEVENT_ENGAGED:       Fight(ev.source);
-          EVID_HERDING:           Herding(ev);
+          EVID_HERDING:           HerdingLoop(ev);
         endcase
       until(!(ev := os::wait_for_event(5)));
     endif
@@ -55,7 +55,7 @@
   DisableEvents(SYSEVENT_SPEECH + SYSEVENT_ENGAGED + SYSEVENT_DAMAGED + SYSEVENT_ENTEREDAREA);
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopKillAny.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopKillAny.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopKillAny.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -23,7 +23,7 @@
           SYSEVENT_ENTEREDAREA:
           SYSEVENT_ENGAGED:
           SYSEVENT_DAMAGED:     Fight(ev.source);
-          EVID_HERDING:         Herding(ev);
+          EVID_HERDING:         HerdingLoop(ev);
         endcase
       until(!(ev := os::wait_for_event(1)));
     endif
@@ -46,7 +46,7 @@
   DisableEvents(SYSEVENT_ENGAGED + SYSEVENT_DAMAGED + SYSEVENT_ENTEREDAREA);
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopMeek.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopMeek.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopMeek.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -34,7 +34,7 @@
           SYSEVENT_ENGAGED:    Run(ev.source);
           SYSEVENT_ITEM_GIVEN: next_wander := ReadGameClock()+60;
                                TakeItem(ev.source,ev.item);
-          EVID_HERDING:        Herding(ev);
+          EVID_HERDING:        HerdingLoop(ev);
         endcase
       until(!(ev := os::wait_for_event(1)));
     endif
@@ -57,7 +57,7 @@
   DisableEvents(SYSEVENT_ITEM_GIVEN);
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -33,7 +33,7 @@
                                   ApplyRawDamage(me, AP_GetVital(me, "Hits") + 3);
                                 endif
         SYSEVENT_ENGAGED:       RunLikeHell(ev.source);
-        EVID_HERDING:           Herding(ev);
+        EVID_HERDING:           HerdingLoop(ev);
       endcase
     endif
     if(ReadGameClock() > next_regrow)
@@ -81,7 +81,7 @@
   DisableEvents(SYSEVENT_ENGAGED + SYSEVENT_DAMAGED);
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopWolf.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopWolf.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopWolf.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -34,7 +34,7 @@
                                    Fight( ev.source);
                                  endif
           EVID_ALL_ATTACK_CMD:   Fight( ev.source);
-          EVID_HERDING:          Herding(ev);
+          EVID_HERDING:          HerdingLoop(ev);
         endcase
       until(!(ev := os::wait_for_event(1)));
     endif
@@ -72,7 +72,7 @@
   endforeach
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/meanLoop.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/meanLoop.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/meanLoop.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -19,7 +19,7 @@
         SYSEVENT_ENTEREDAREA: if((!(ev.source).npctemplate) ||(((ev.source).script == "employed") ||((ev.source).script == "tamed")))
                                 fight(ev.source);
                               endif
-        EVID_HERDING:           Herding(ev);
+        EVID_HERDING:           HerdingLoop(ev);
       endcase
     until(!(ev := os::wait_for_event(1)));
       if(ReadGameClock() > next_wander)
@@ -59,7 +59,7 @@
   cleareventque();
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/packKillPCsLoop.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/packKillPCsLoop.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/packKillPCsLoop.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -52,7 +52,7 @@
                                   endif
                                 endforeach
                                 Fight(ev.source);
-          EVID_HERDING:           Herding(ev);
+          EVID_HERDING:           HerdingLoop(ev);
         endcase
       until(!(ev := os::wait_for_event(2)));
     endif
@@ -104,7 +104,7 @@
     endforeach
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/main/sleepMode.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/sleepMode.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/sleepMode.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -54,7 +54,7 @@
                              EnableMainEvents();
                              return ev;
                            endif
-      EVID_HERDING:        Herding(ev);
+      EVID_HERDING:        HerdingLoop(ev);
     endcase
     until(!(ev := os::wait_for_event(30)));
   endwhile

Modified: trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/sleepModeCow.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -59,7 +59,7 @@
                              EnableMainEvents();
                              return ev;
                            endif
-      EVID_HERDING:        Herding(ev);
+      EVID_HERDING:        HerdingLoop(ev);
     endcase
     until(!(ev := os::wait_for_event(30)));
   endwhile

Modified: trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/main/sleepModeSheep.inc	2005-11-02 13:57:44 UTC (rev 833)
@@ -62,7 +62,7 @@
                              EnableMainEvents();
                              return ev;
                            endif
-      EVID_HERDING:        Herding(ev);
+      EVID_HERDING:        HerdingLoop(ev);
     endcase
     until(!(ev := os::wait_for_event(30)));
   endwhile

Modified: trunk/096/pkg/mobiles/oldAI/townPerson.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-02 13:57:44 UTC (rev 833)
@@ -203,7 +203,7 @@
   return (goldreceived/10) + pc_level;
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/vortexAI.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/vortexAI.src	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/vortexAI.src	2005-11-02 13:57:44 UTC (rev 833)
@@ -141,7 +141,7 @@
   DisableEvents( SYSEVENT_ENGAGED + SYSEVENT_DAMAGED + SYSEVENT_ENTEREDAREA);
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];

Modified: trunk/096/pkg/mobiles/oldAI/worker.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-02 10:13:17 UTC (rev 832)
+++ trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-02 13:57:44 UTC (rev 833)
@@ -292,7 +292,7 @@
   return (goldreceived/10) + pc_level;
 endfunction
 
-function herding(ev)
+function HerdingLoop(ev)
   var holder := ev.data;
   var lx := holder[1];
   var ly := holder[2];



From austin at berlios.de  Wed Nov  2 15:09:59 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 15:09:59 +0100
Subject: [Poldistro-svn] r834 - in trunk/096/pkg: skills/anatomy skills/animallore skills/armslore skills/begging skills/bowcraft skills/camping skills/carpentry skills/cartography skills/detecthidden skills/evalint skills/fishing skills/hiding skills/itemid skills/musicianship skills/musicianship/include skills/spiritspeak skills/stealth systems/attributes/include systems/crafting/include
Message-ID: <200511021409.jA2E9x4x027416@sheep.berlios.de>

Author: austin
Date: 2005-11-02 15:09:50 +0100 (Wed, 02 Nov 2005)
New Revision: 834

Modified:
   trunk/096/pkg/skills/anatomy/anatomy.src
   trunk/096/pkg/skills/animallore/animalLore.src
   trunk/096/pkg/skills/armslore/armsLore.src
   trunk/096/pkg/skills/begging/begging.src
   trunk/096/pkg/skills/bowcraft/bowcraft.src
   trunk/096/pkg/skills/camping/camping.src
   trunk/096/pkg/skills/carpentry/carpentry.src
   trunk/096/pkg/skills/cartography/mapmakersPen.src
   trunk/096/pkg/skills/detecthidden/detectHidden.src
   trunk/096/pkg/skills/evalint/evalInt.src
   trunk/096/pkg/skills/fishing/fishing.src
   trunk/096/pkg/skills/fishing/fishingFunctions.inc
   trunk/096/pkg/skills/fishing/fishnets.src
   trunk/096/pkg/skills/hiding/hiding.src
   trunk/096/pkg/skills/itemid/itemID.src
   trunk/096/pkg/skills/musicianship/include/bard.inc
   trunk/096/pkg/skills/musicianship/include/bardInstrument.inc
   trunk/096/pkg/skills/musicianship/include/bardSkill.inc
   trunk/096/pkg/skills/musicianship/musicianship.src
   trunk/096/pkg/skills/musicianship/peacemaking.src
   trunk/096/pkg/skills/musicianship/provocation.src
   trunk/096/pkg/skills/spiritspeak/logon.src
   trunk/096/pkg/skills/spiritspeak/reconnect.src
   trunk/096/pkg/skills/spiritspeak/spiritSpeak.src
   trunk/096/pkg/skills/stealth/stealth.src
   trunk/096/pkg/systems/attributes/include/attributeConstants.inc
   trunk/096/pkg/systems/crafting/include/craftingRepair.inc
Log:
Updated to match removal of ATTRIBUTE_* and VITAL_* on the constant names.
Now theyre just the raw name. This is to make them shorter and more like using plain strins. The advantage of using the constants is the compiler will catch typos when youre coding on tired mode.

Modified: trunk/096/pkg/skills/anatomy/anatomy.src
===================================================================
--- trunk/096/pkg/skills/anatomy/anatomy.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/anatomy/anatomy.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -49,10 +49,10 @@
 		endif
 	endif
 
-	if( SkillCheck(who, ATTRIBUTE_ANATOMY, -1) > 0 )
+	if( SkillCheck(who, ANATOMY, -1) > 0 )
 		PrintTextAbovePrivate(subject, strMsg + " looks " + streng + " and " + dext + ".", who);
 		// player's anatomy skill equal/greater than 65 can get endurance info
-		var skill := AP_GetSkill(who, ATTRIBUTE_ANATOMY);
+		var skill := AP_GetSkill(who, ANATOMY);
 		if(skill >= 65)
 			PrintTextAbovePrivate(subject, strMsg + " is at " + endur + " endurance.", who);
 		endif

Modified: trunk/096/pkg/skills/animallore/animalLore.src
===================================================================
--- trunk/096/pkg/skills/animallore/animalLore.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/animallore/animalLore.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -32,7 +32,7 @@
                 return 0;
         endif
 
-	if( SkillCheck(who, ATTRIBUTE_ANIMAL_LORE, -1) > 0 )
+	if( SkillCheck(who, ANIMAL_LORE, -1) > 0 )
                 // If the player succeeds, send the gump.
                 // Create the Gump
                 var al_Gump := AL_LoadGump(who, creature);
@@ -87,18 +87,18 @@
         var hits := ""+GetVital(creature, "Hits")/100+"/"+AP_GetVitalMaximumValue(creature, "Hits")+"";
         var stamina := ""+GetVital(creature, "Stamina")/100+"/"+AP_GetVitalMaximumValue(creature, "Stamina")+"";
         var mana := ""+GetVital(creature, "Mana")/100+"/"+AP_GetVitalMaximumValue(creature, "Mana")+"";
-        var str := ""+AP_GetStat(creature, ATTRIBUTE_STRENGTH)+"";
-        var dex := ""+AP_GetStat(creature, ATTRIBUTE_DEXTERITY)+"";
-        var int := ""+AP_GetStat(creature, ATTRIBUTE_INTELLIGENCE)+"";
+        var str := ""+AP_GetStat(creature, STRENGTH)+"";
+        var dex := ""+AP_GetStat(creature, DEXTERITY)+"";
+        var int := ""+AP_GetStat(creature, INTELLIGENCE)+"";
         var ar := ""+creature.ar+"";
-        var wrestStr := AP_GetSkill(creature, ATTRIBUTE_WRESTLING);
-        var tactStr := AP_GetSkill(creature, ATTRIBUTE_TACTICS);
-        var mrStr := CDbl(AP_GetSkill(creature, ATTRIBUTE_RESISTING_SPELLS));
-        var anatStr := AP_GetSkill(creature, ATTRIBUTE_ANATOMY);
-        var poisonStr := AP_GetSkill(creature, ATTRIBUTE_POISONING);
-        var mageryStr := AP_GetSkill(creature, ATTRIBUTE_MAGERY);
-        var eiStr := AP_GetSkill(creature, ATTRIBUTE_EVALUATING_INTELLIGENCE);
-        var medStr := AP_GetSkill(creature, ATTRIBUTE_MEDITATION);
+        var wrestStr := AP_GetSkill(creature, WRESTLING);
+        var tactStr := AP_GetSkill(creature, TACTICS);
+        var mrStr := CDbl(AP_GetSkill(creature, RESISTING_SPELLS));
+        var anatStr := AP_GetSkill(creature, ANATOMY);
+        var poisonStr := AP_GetSkill(creature, POISONING);
+        var mageryStr := AP_GetSkill(creature, MAGERY);
+        var eiStr := AP_GetSkill(creature, EVALUATING_INTELLIGENCE);
+        var medStr := AP_GetSkill(creature, MEDITATION);
 
         var cTemplate := NPC_GetNPCConfig(creature.npctemplate);
 

Modified: trunk/096/pkg/skills/armslore/armsLore.src
===================================================================
--- trunk/096/pkg/skills/armslore/armsLore.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/armslore/armsLore.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -23,7 +23,7 @@
 		SendSysMessage(who, "You can only use this skill on weapons or armor!");
 		return;
 	endif
-	if(SkillCheck(who, ATTRIBUTE_ARMS_LORE, -1) > 0)
+	if(SkillCheck(who, ARMS_LORE, -1) > 0)
 		var item_max_hp := the_item.maxhp;
 		var max_hp := item_max_hp;
 		var hp := the_item.hp;

Modified: trunk/096/pkg/skills/begging/begging.src
===================================================================
--- trunk/096/pkg/skills/begging/begging.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/begging/begging.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -74,7 +74,7 @@
 		return 0;
 	endif
 
-	if( SkillCheck(who, ATTRIBUTE_BEGGING, -1) > 0 )
+	if( SkillCheck(who, BEGGING, -1) > 0 )
 		var gold;
 		case (wealth)
 			"upper":	gold := RandomDiceRoll("4d5");

Modified: trunk/096/pkg/skills/bowcraft/bowcraft.src
===================================================================
--- trunk/096/pkg/skills/bowcraft/bowcraft.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/bowcraft/bowcraft.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -31,7 +31,7 @@
 	EraseObjProperty(who, "IsMeditating");
 	EraseObjProperty(who, "HealTimer");
 
-	var rinfo := sendCraftGump(who, ATTRIBUTE_BOWCRAP_T_FLETCHING);
+	var rinfo := sendCraftGump(who, BOWCRAFT_FLETCHING);
 
 	// OK was pressed, close it on out
 	if(rinfo == 0)
@@ -48,7 +48,7 @@
 	endif
 
 	if(craft_config[Hex(the_objtype)].assemble == 1)
-		CraftAssembly(who, ATTRIBUTE_BOWCRAP_T_FLETCHING, tool, the_objtype, amt);
+		CraftAssembly(who, BOWCRAFT_FLETCHING, tool, the_objtype, amt);
 	else
 		makeBowcraftItems(who, the_objtype, amt, tool);
 	endif

Modified: trunk/096/pkg/skills/camping/camping.src
===================================================================
--- trunk/096/pkg/skills/camping/camping.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/camping/camping.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -34,7 +34,7 @@
 		return 0;
 	endif
 
-	if( SkillCheck(who, ATTRIBUTE_CAMPING, -1) > 0 )
+	if( SkillCheck(who, CAMPING, -1) > 0 )
 		var x := wood.x;
 		var y := wood.y;
 		var z := wood.z;

Modified: trunk/096/pkg/skills/carpentry/carpentry.src
===================================================================
--- trunk/096/pkg/skills/carpentry/carpentry.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/carpentry/carpentry.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -216,13 +216,13 @@
 		endif
 		theitem.movable := 1;
 		if( craft_config[theitem.objtype].lockable )
-			if( SkillCheck(who, ATTRIBUTE_TINKERING, 40, 40) > 0 )
+			if( SkillCheck(who, TINKERING, 40, 40) > 0 )
 				SetObjProperty(theitem, "lockable","1");
 				var lockid := AllocLockId();
 				var thekey := CreateItemInContainer(theitem, UOBJ_COPPER_KEY, 1 );
 				SetObjProperty(thekey, "lockid",lockid);
 				SetObjProperty(theitem,"lockid",lockid);
-				SetObjProperty(theitem,"LockPickDiff", AP_GetSkill(who, ATTRIBUTE_TINKERING));
+				SetObjProperty(theitem,"LockPickDiff", AP_GetSkill(who, TINKERING));
 				SendSysMessage(who, "Your tinker skill was sufficient to make the item lockable.");
 			endif
 		endif

Modified: trunk/096/pkg/skills/cartography/mapmakersPen.src
===================================================================
--- trunk/096/pkg/skills/cartography/mapmakersPen.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/cartography/mapmakersPen.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -31,7 +31,7 @@
 	EraseObjProperty(who, "IsMeditating");
 	EraseObjProperty(who, "HealTimer");
 
-	var rinfo := sendCraftGump(who, ATTRIBUTE_CARTOGRAPHY);
+	var rinfo := sendCraftGump(who, CARTOGRAPHY);
 
 	// OK was pressed, close it on out
 	if(rinfo == 0)

Modified: trunk/096/pkg/skills/detecthidden/detectHidden.src
===================================================================
--- trunk/096/pkg/skills/detecthidden/detectHidden.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/detecthidden/detectHidden.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -34,7 +34,7 @@
 
 	SendSysMessage(who,"Target the location to search.");
 	var targ := TargetCoordinates( who );
-	var range := my_DetectRange( AP_GetSkill( who, ATTRIBUTE_DETECTING_HIDDEN  ) );
+	var range := my_DetectRange( AP_GetSkill( who, DETECTING_HIDDEN  ) );
 	var hiders := ListMobilesNearLocationEx( cint(targ.x), cint(targ.y), cint(targ.z), range, LISTEX_FLAG_HIDDEN, who.realm );
 	var items  := ListItemsNearLocation( cint(targ.x), cint(targ.y), cint(targ.z), range, who.realm );
 	var elem;
@@ -60,7 +60,7 @@
 	 dtct := GetObjProperty(item, "trapped");
      var trapstrength := GetObjProperty(item,"trap_strength");
 	 if( dtct )
-        if(SkillCheck( who, ATTRIBUTE_DETECTING_HIDDEN, -1) > 0)
+        if(SkillCheck( who, DETECTING_HIDDEN, -1) > 0)
 	      PrintTextAbovePrivate( item, "Trapped", who);
         else
           var results := RandomInt(9) + 1;
@@ -90,7 +90,7 @@
           endif
         endif
       elseif( data == TRAP)
-        if(SkillCheck( who, ATTRIBUTE_DETECTING_HIDDEN, -1) > 0)
+        if(SkillCheck( who, DETECTING_HIDDEN, -1) > 0)
 	      PrintTextAbovePrivate( item, "Trap", who );
           SetObjProperty( item, "trapped", 1 );
         else
@@ -125,7 +125,7 @@
           endif
         endif
      elseif( prop )
-        if(SkillCheck( who, ATTRIBUTE_DETECTING_HIDDEN, -1) > 0 )
+        if(SkillCheck( who, DETECTING_HIDDEN, -1) > 0 )
 	      PrintTextAbovePrivate( item, "Trapped", who);
 	      SetObjProperty( item, "trapped", 1 );
         else
@@ -177,8 +177,8 @@
 
 
 function Found( finder, hider ) //FIXME: should not be 100% certain to find a hider if your skill is greater
-  var hide_skill := AP_GetSkill( hider, ATTRIBUTE_HIDING );
-  if (SkillCheck( finder, ATTRIBUTE_DETECTING_HIDDEN, hide_skill) > 0)
+  var hide_skill := AP_GetSkill( hider, HIDING );
+  if (SkillCheck( finder, DETECTING_HIDDEN, hide_skill) > 0)
     return 1;
   else
     return 0;

Modified: trunk/096/pkg/skills/evalint/evalInt.src
===================================================================
--- trunk/096/pkg/skills/evalint/evalInt.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/evalint/evalInt.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -45,10 +45,10 @@
 			strFail := subject.name + "' mental abilities.";
 		endif
 	endif
-	if(SkillCheck(who, ATTRIBUTE_EVALUATING_INTELLIGENCE, -1) > 0)
+	if(SkillCheck(who, EVALUATING_INTELLIGENCE, -1) > 0)
 		PrintTextAbovePrivate(subject, strMsg + " looks " + intell + ".", who);
 		// player's evalint skill equal/greater than 76 can get mental strength info
-		var skill := AP_GetSkill(who, ATTRIBUTE_EVALUATING_INTELLIGENCE);
+		var skill := AP_GetSkill(who, EVALUATING_INTELLIGENCE);
 		if(skill >= 76)
 			PrintTextAbovePrivate(subject, strMsg + " is at " + mentalStrength + " mental strength.", who);
 		endif

Modified: trunk/096/pkg/skills/fishing/fishing.src
===================================================================
--- trunk/096/pkg/skills/fishing/fishing.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/fishing/fishing.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -86,7 +86,7 @@
 				SendSysMessage(who, "There doesn't seem to be any fish here.");
 				return 0;
 			endif
-			if( SkillCheck(who, ATTRIBUTE_FISHING, difficulty) > 0)
+			if( SkillCheck(who, FISHING, difficulty) > 0)
 				var fishreturned := HarvestResource("fish", targetsquare.x, targetsquare.y, 1, 1, who.realm);
 				if( !fishreturned )
 					SendSysMessage(who, "Oops, you let that one get away!");
@@ -111,7 +111,7 @@
 function GetTheCatch(who, targetsquare, fishingpole)
 
 	var fishtype;
-	var currentskill := AP_GetSkill(who, ATTRIBUTE_FISHING);
+	var currentskill := AP_GetSkill(who, FISHING);
 	var thisone := RandomInt(100)+ 1;
 	if(thisone <= 94)
 		fishtype := RandomInt(UOBJ_FISH_END - UOBJ_FISH_START)+ UOBJ_FISH_START;
@@ -161,7 +161,7 @@
 		endif
 	else
 		if( CreateItemInContainer(who.backpack, fishtype, 1) )
-			CheckToolWear (who, fishingpole, ATTRIBUTE_FISHING);
+			CheckToolWear (who, fishingpole, FISHING);
 		endif
         endif
 

Modified: trunk/096/pkg/skills/fishing/fishingFunctions.inc
===================================================================
--- trunk/096/pkg/skills/fishing/fishingFunctions.inc	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/fishing/fishingFunctions.inc	2005-11-02 14:09:50 UTC (rev 834)
@@ -188,7 +188,7 @@
 function GetSOSTreasure(who, targetsquare, sosmsg)
 
 	targetsquare := targetsquare;
-	if( SkillCheck(who, ATTRIBUTE_FISHING, 80, 200) > 0 )
+	if( SkillCheck(who, FISHING, 80, 200) > 0 )
 		var itemcfg := ReadConfigFile(":*:itemdesc");
 		var it, oldname;
 		if( RandomInt(100) < 75 )

Modified: trunk/096/pkg/skills/fishing/fishnets.src
===================================================================
--- trunk/096/pkg/skills/fishing/fishnets.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/fishing/fishnets.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -63,7 +63,7 @@
 				5: CreateNpcFromTemplate( "waterelemental", targetsquare.x, targetsquare.y, targetsquare.z );
 				6: CreateNpcFromTemplate( "seaserpent", targetsquare.x, targetsquare.y, targetsquare.z );
 			endcase
-			var myskill := AP_GetSkill(who, ATTRIBUTE_FISHING);
+			var myskill := AP_GetSkill(who, FISHING);
 			if(myskill <= 50)
 				CreateNpcFromTemplate( "seaserpent", targetsquare.x, targetsquare.y, targetsquare.z );
 			elseif(myskill <= 75)

Modified: trunk/096/pkg/skills/hiding/hiding.src
===================================================================
--- trunk/096/pkg/skills/hiding/hiding.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/hiding/hiding.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -25,13 +25,13 @@
 	if( who.warmode )
 		who.SetWarMode(0);
 	endif
-	var my_range := my_HideRange(AP_GetSkill(who, ATTRIBUTE_HIDING));
+	var my_range := my_HideRange(AP_GetSkill(who, HIDING));
 	var my_attackers := ListHostiles(who, my_range, LH_FLAG_LOS);
 	if( my_attackers.size() > 0 )
 		PrintTextAbovePrivate(who, "You cannot hide as there are hostiles in view!", who);
 		return 0;
 	endif
-	if( SkillCheck(who, ATTRIBUTE_HIDING, -1) > 0 )
+	if( SkillCheck(who, HIDING, -1) > 0 )
 		who.hidden := 1;
 		if( GetObjProperty(who, "#Stealth") != 1)
 			PrintTextAbovePrivate(who, "You have hidden yourself well.", who);

Modified: trunk/096/pkg/skills/itemid/itemID.src
===================================================================
--- trunk/096/pkg/skills/itemid/itemID.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/itemid/itemID.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -28,7 +28,7 @@
 		return 0;
 	endif
 
-	if( SkillCheck(who, ATTRIBUTE_ITEM_IDENTIFICATION, -1) > 0 )
+	if( SkillCheck(who, ITEM_IDENTIFICATION, -1) > 0 )
 		var name := "";
 		var itsname := the_item.name;
 		if( !itsname )
@@ -90,7 +90,7 @@
 			endif
 		endif
 		if( GetObjProperty(the_item, "type") == "cursed" )
-			if( SkillCheck(who, ATTRIBUTE_ITEM_IDENTIFICATION, 65) > 0 )
+			if( SkillCheck(who, ITEM_IDENTIFICATION, 65) > 0 )
 				SendSysMessage(who, "* This item is cursed! *");
 			endif
 		endif

Modified: trunk/096/pkg/skills/musicianship/include/bard.inc
===================================================================
--- trunk/096/pkg/skills/musicianship/include/bard.inc	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/musicianship/include/bard.inc	2005-11-02 14:09:50 UTC (rev 834)
@@ -56,13 +56,13 @@
 		print( "Debug Bard: Exceptional Check Passed");
 		barding_difficulty := barding_difficulty - 5;
 	endif
-	var musicianship := CInt(AP_GetSkill(who, ATTRIBUTE_MUSICIANSHIP));
+	var musicianship := CInt(AP_GetSkill(who, MUSICIANSHIP));
 	if( musicianship > 100 )
 		barding_difficulty := barding_difficulty - CInt((musicianship - 100) / 2);
 	endif
-	if( attribute == ATTRIBUTE_PROVOCATION )
+	if( attribute == PROVOCATION )
 		barding_difficulty := barding_difficulty - 5;
-	elseif( attribute == ATTRIBUTE_PEACEMAKING || attribute == ATTRIBUTE_DISCORDANCE )
+	elseif( attribute == PEACEMAKING || attribute == DISCORDANCE )
 		barding_difficulty := barding_difficulty - 10;
 	endif
 
@@ -109,9 +109,9 @@
 	var ifCanBard := 1;
 
 	case(bard_skill)
-		ATTRIBUTE_DISCORDANCE: ifCanBard := CInt(pTemplate.NoDiscord);
-		ATTRIBUTE_PEACEMAKING: ifCanBard := CInt(pTemplate.NoPeacmake);
-		ATTRIBUTE_PROVOCATION: ifCanBard := CInt(pTemplate.NoProvoke);
+		DISCORDANCE: ifCanBard := CInt(pTemplate.NoDiscord);
+		PEACEMAKING: ifCanBard := CInt(pTemplate.NoPeacmake);
+		PROVOCATION: ifCanBard := CInt(pTemplate.NoProvoke);
 	endcase
 
 	return ifCanBard;

Modified: trunk/096/pkg/skills/musicianship/include/bardInstrument.inc
===================================================================
--- trunk/096/pkg/skills/musicianship/include/bardInstrument.inc	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/musicianship/include/bardInstrument.inc	2005-11-02 14:09:50 UTC (rev 834)
@@ -143,9 +143,9 @@
 function playHarp(theskill, iType:=1)
 
 	case(theskill)
-		ATTRIBUTE_DISCORDANCE:  return 0x393;
-		ATTRIBUTE_PEACEMAKING: return 0x394;
-		ATTRIBUTE_PROVOCATION: return 0x392;
+		DISCORDANCE:  return 0x393;
+		PEACEMAKING: return 0x394;
+		PROVOCATION: return 0x392;
 	endcase
 
 	// If skill wasn't one of the three above,
@@ -176,9 +176,9 @@
 function playLute(theskill)
 
 	case(theskill)
-		ATTRIBUTE_DISCORDANCE:  return 0x40C;
-		ATTRIBUTE_PEACEMAKING: return 0x419;
-		ATTRIBUTE_PROVOCATION: return 0x404;
+		DISCORDANCE:  return 0x40C;
+		PEACEMAKING: return 0x419;
+		PROVOCATION: return 0x404;
 	endcase
 
 	// If skill wasn't one of the three above,
@@ -206,9 +206,9 @@
 function playDrum(theskill)
 
 	case(theskill)
-		ATTRIBUTE_DISCORDANCE:  return 0x2E9;
-		ATTRIBUTE_PEACEMAKING: return 0x2EA;
-		ATTRIBUTE_PROVOCATION: return 0x2E8;
+		DISCORDANCE:  return 0x2E9;
+		PEACEMAKING: return 0x2EA;
+		PROVOCATION: return 0x2E8;
 	endcase
 
 	// If skill wasn't one of the three above,
@@ -236,9 +236,9 @@
 function playTamb(theskill)
 
 	case(theskill)
-		ATTRIBUTE_DISCORDANCE:  return 0x4B7;
-		ATTRIBUTE_PEACEMAKING: return 0x4B8;
-		ATTRIBUTE_PROVOCATION: return 0x4B6;
+		DISCORDANCE:  return 0x4B7;
+		PEACEMAKING: return 0x4B8;
+		PROVOCATION: return 0x4B6;
 	endcase
 
 	// If skill wasn't one of the three above,

Modified: trunk/096/pkg/skills/musicianship/include/bardSkill.inc
===================================================================
--- trunk/096/pkg/skills/musicianship/include/bardSkill.inc	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/musicianship/include/bardSkill.inc	2005-11-02 14:09:50 UTC (rev 834)
@@ -24,8 +24,8 @@
 	// Gets a dictionary for success/fail.
 	var soundCheck := bardSoundCheck(character, instrument, bard_skill);
 
-	SkillCheck(character, ATTRIBUTE_MUSICIANSHIP, 1);
-	if( (AP_GetSkill(character, ATTRIBUTE_MUSICIANSHIP) < 10) && (bard_skill != ATTRIBUTE_MUSICIANSHIP) )
+	SkillCheck(character, MUSICIANSHIP, 1);
+	if( (AP_GetSkill(character, MUSICIANSHIP) < 10) && (bard_skill != MUSICIANSHIP) )
 		SendSysMessage(character, "You are not skilled enough in the musical arts.");
 		return 0;
 	endif

Modified: trunk/096/pkg/skills/musicianship/musicianship.src
===================================================================
--- trunk/096/pkg/skills/musicianship/musicianship.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/musicianship/musicianship.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -28,7 +28,7 @@
 		return 0;
 	endif
 
-	if( !bardSkillCheck(who, instrument, ATTRIBUTE_MUSICIANSHIP, -1) )
+	if( !bardSkillCheck(who, instrument, MUSICIANSHIP, -1) )
 		SendSysMessage(who, "You fail in your attemp to play the instrument");
 	endif
 

Modified: trunk/096/pkg/skills/musicianship/peacemaking.src
===================================================================
--- trunk/096/pkg/skills/musicianship/peacemaking.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/musicianship/peacemaking.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -43,15 +43,15 @@
 
 	var barding_difficulty := -1;
 	if( peacee.npctemplate )
-		barding_difficulty := figureBardDifficulty(who, peacee, instrument, ATTRIBUTE_PEACEMAKING);
+		barding_difficulty := figureBardDifficulty(who, peacee, instrument, PEACEMAKING);
 	endif
 
-	if ( !isBardable(who, peacee, ATTRIBUTE_PEACEMAKING, barding_difficulty) )
+	if ( !isBardable(who, peacee, PEACEMAKING, barding_difficulty) )
 		PrintTextAbovePrivate(peacee, "You have no chance to calm that creature!", who);
 		return 0;
 	endif
 
-	if( bardSkillCheck(who, instrument, ATTRIBUTE_PEACEMAKING, barding_difficulty) )
+	if( bardSkillCheck(who, instrument, PEACEMAKING, barding_difficulty) )
 		calmDown( who, peacee );
 	else
 		return 0;
@@ -64,8 +64,8 @@
 
 function calmDown( who, peacee )
 
-	var peace_length_single := CInt(AP_GetSkill(who, ATTRIBUTE_PEACEMAKING) / 5);
-	var peace_length_ranged := CInt(AP_GetSkill(who, ATTRIBUTE_PEACEMAKING) / 20);
+	var peace_length_single := CInt(AP_GetSkill(who, PEACEMAKING) / 5);
+	var peace_length_ranged := CInt(AP_GetSkill(who, PEACEMAKING) / 20);
 
 	var ev := struct;
 	ev.+ type;

Modified: trunk/096/pkg/skills/musicianship/provocation.src
===================================================================
--- trunk/096/pkg/skills/musicianship/provocation.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/musicianship/provocation.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -47,15 +47,15 @@
 
 	var barding_difficulty := -1;
 	if( thetarg.npctemplate )
-		barding_difficulty := figureBardDifficulty(who, thetarg, instrument, ATTRIBUTE_PROVOCATION);
+		barding_difficulty := figureBardDifficulty(who, thetarg, instrument, PROVOCATION);
 	endif
 
-	if ( !isBardable(who, thetarg, ATTRIBUTE_PROVOCATION, barding_difficulty) )
+	if ( !isBardable(who, thetarg, PROVOCATION, barding_difficulty) )
 		PrintTextAbovePrivate(thetarg, "You have no chance to provoke that creature!", who);
 		return 0;
 	endif
 
-	if( bardSkillCheck(who, instrument, ATTRIBUTE_PROVOCATION, barding_difficulty) )
+	if( bardSkillCheck(who, instrument, PROVOCATION, barding_difficulty) )
 		var ev := struct;
 		ev.+ type;
 		ev.+ source;
@@ -76,9 +76,9 @@
 		endif
 		barding_difficulty := -1;
 		if( newtarg.npctemplate )
-			barding_difficulty := figureBardDifficulty(who, newtarg, instrument, ATTRIBUTE_PROVOCATION);
+			barding_difficulty := figureBardDifficulty(who, newtarg, instrument, PROVOCATION);
 		endif
-		if( bardSkillCheck(who, instrument, ATTRIBUTE_PROVOCATION, barding_difficulty, 0, ADV_DISABLE) )
+		if( bardSkillCheck(who, instrument, PROVOCATION, barding_difficulty, 0, ADV_DISABLE) )
 			SetObjProperty(who, "#LastMusic", Cint(ReadGameClock() + 3));
 			SendSysMessage(who, "You provoke " + thetarg.name + " to attack " + newtarg.name + ".");
 			ev.source := newtarg;
@@ -102,7 +102,7 @@
 			if( barding_difficulty == -1 )
 				barding_difficulty := 50;
 			endif
-			if( RandomInt( barding_difficulty) > AP_GetSkill(who, ATTRIBUTE_PROVOCATION) )
+			if( RandomInt( barding_difficulty) > AP_GetSkill(who, PROVOCATION) )
 				ev.source := who;
 				if( thetarg.warmode )
 					ev.type := EVID_PEACEMADE;

Modified: trunk/096/pkg/skills/spiritspeak/logon.src
===================================================================
--- trunk/096/pkg/skills/spiritspeak/logon.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/spiritspeak/logon.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -5,7 +5,7 @@
 
 program spiritSpeak_OnLogon(who)
 
-	var my_skill  := CInt(AP_GetSkill(who, ATTRIBUTE_SPIRIT_SPEAK));
+	var my_skill  := CInt(AP_GetSkill(who, SPIRIT_SPEAK));
 	if( my_skill >= 100 )
 		GrantPrivilege(who, "hearghosts");
 		who.enable("hearghosts");

Modified: trunk/096/pkg/skills/spiritspeak/reconnect.src
===================================================================
--- trunk/096/pkg/skills/spiritspeak/reconnect.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/spiritspeak/reconnect.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -5,7 +5,7 @@
 
 program spiritSpeak_OnReconnect(who)
 
-	var my_skill  := CInt(AP_GetSkill(who, ATTRIBUTE_SPIRIT_SPEAK));
+	var my_skill  := CInt(AP_GetSkill(who, SPIRIT_SPEAK));
 	if( my_skill >= 100 )
 		GrantPrivilege(who, "hearghosts");
 		who.enable("hearghosts");

Modified: trunk/096/pkg/skills/spiritspeak/spiritSpeak.src
===================================================================
--- trunk/096/pkg/skills/spiritspeak/spiritSpeak.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/spiritspeak/spiritSpeak.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -37,12 +37,12 @@
 	EraseObjProperty(who, "IsMeditating");
 	EraseObjProperty(who, "HealTimer");
 
-	var my_skill  := CInt(AP_GetSkill(who, ATTRIBUTE_SPIRIT_SPEAK));
+	var my_skill  := CInt(AP_GetSkill(who, SPIRIT_SPEAK));
 
 	PlaySoundEffect(who, SFX_SKILL_SPIRITSPEAK);
 
 
-  	if(SkillCheck(who, ATTRIBUTE_SPIRIT_SPEAK, -1) > 0)
+  	if(SkillCheck(who, SPIRIT_SPEAK, -1) > 0)
 		foreach corpse in ListItemsNearLocationOfType( who.x, who.y, who.z, SS_RANGE, 0x2006 )
 			channelFromCorpse(who, corpse, my_skill);
 		endforeach
@@ -51,7 +51,7 @@
   	  	elseif( AP_GetVital(who, "Mana") > 10 )
   	  		channelFromSelf(who);
 		endif
-		my_skill  := CInt(AP_GetSkill(who, ATTRIBUTE_SPIRIT_SPEAK));
+		my_skill  := CInt(AP_GetSkill(who, SPIRIT_SPEAK));
 		if( my_skill >= 100 )
 			GrantPrivilege(who, "hearghosts");
 			who.enable("hearghosts");

Modified: trunk/096/pkg/skills/stealth/stealth.src
===================================================================
--- trunk/096/pkg/skills/stealth/stealth.src	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/skills/stealth/stealth.src	2005-11-02 14:09:50 UTC (rev 834)
@@ -23,11 +23,11 @@
 	EraseObjProperty(who, "IsMeditating");
 	EraseObjProperty(who, "HealTimer");
 
-	if( AP_GetSkill(who, ATTRIBUTE_HIDING) < 80 )
+	if( AP_GetSkill(who, HIDING) < 80 )
 		PrintTextAbovePrivate( who, "You are not good enough at Hiding to do that.", who );
 		return 0;
 	endif
-	if( (!who.hidden) && (AP_GetSkill(who, ATTRIBUTE_STEALTH) < 80) )
+	if( (!who.hidden) && (AP_GetSkill(who, STEALTH) < 80) )
 		PrintTextAbovePrivate( who, "You must be hidden to use stealth", who );
 		return 0;
 	endif
@@ -38,8 +38,8 @@
 		return 0;
 	endif
 
-	var my_Skill := AP_GetSkill(who, ATTRIBUTE_STEALTH) / 10;
-	if(SkillCheck(who, ATTRIBUTE_STEALTH, -1) > 0)
+	var my_Skill := AP_GetSkill(who, STEALTH) / 10;
+	if(SkillCheck(who, STEALTH, -1) > 0)
 		if( !who.hidden )
 			// Used RSTC because it runs the script in critical mode, thus
 			// ensuring the hiding attempt completes before the stealth

Modified: trunk/096/pkg/systems/attributes/include/attributeConstants.inc
===================================================================
--- trunk/096/pkg/systems/attributes/include/attributeConstants.inc	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/systems/attributes/include/attributeConstants.inc	2005-11-02 14:09:50 UTC (rev 834)
@@ -12,13 +12,13 @@
 	STAMINA			:= "Stamina"
 endenum
 
-enum ATTRIBUTE_STATS
+enum STATS
 	STRENGTH		:= "Strength",
 	DEXTERITY		:= "Dexterity",
 	INTELLIGENCE		:= "Intelligence"
 endenum
 
-enum ATTRIBUTE_SKILLS
+enum SKILLS
 	ALCHEMY			:= "Alchemy",
 	ANATOMY			:= "Anatomy",
 	ANIMAL_LORE		:= "AnimalLore",

Modified: trunk/096/pkg/systems/crafting/include/craftingRepair.inc
===================================================================
--- trunk/096/pkg/systems/crafting/include/craftingRepair.inc	2005-11-02 13:57:44 UTC (rev 833)
+++ trunk/096/pkg/systems/crafting/include/craftingRepair.inc	2005-11-02 14:09:50 UTC (rev 834)
@@ -96,10 +96,10 @@
 
   var type, title, color;
   case(CInt(craft_skill))
-     ATTRIBUTE_BLACKSMITHY: 		type := "Blacksmith"; color := CInt(2107);
-     ATTRIBUTE_BOWCRAP_T_FLETCHING: 	type := "Bowyer"; color := CInt(2116);
-     ATTRIBUTE_CARPENTRY: 		type := "Carpenter"; color := CInt(2113);
-     ATTRIBUTE_TAILORING: 		type := "Tailor"; color := CInt(2128);
+     BLACKSMITHY: 		type := "Blacksmith"; color := CInt(2107);
+     BOWCRAFT_FLETCHING: 	type := "Bowyer"; color := CInt(2116);
+     CARPENTRY: 		type := "Carpenter"; color := CInt(2113);
+     TAILORING: 		type := "Tailor"; color := CInt(2128);
   endcase
   var ramt := AP_GetSkill(who, craft_skill);
   if(ramt < 50)
@@ -138,7 +138,7 @@
 
 endfunction
 
-function repair_this(who, craft_skill := ATTRIBUTE_BLACKSMITHY)
+function repair_this(who, craft_skill := BLACKSMITHY)
   SendSysMessage(who, "Select item to repair.");
   var use_on := Target(who);
   if(!can_access(who, use_on))
@@ -154,16 +154,16 @@
   endif
   if(CInt(use_on.objtype) == CInt(0xe34))
     case(CInt(craft_skill))
-       ATTRIBUTE_BLACKSMITHY:            CreateRepairDeed(who, use_on, craft_skill);
-       ATTRIBUTE_BOWCRAP_T_FLETCHING:    CreateRepairDeed(who, use_on, craft_skill);
-       ATTRIBUTE_CARPENTRY:   		 CreateRepairDeed(who, use_on, craft_skill);
-       ATTRIBUTE_TAILORING:   		 CreateRepairDeed(who, use_on, craft_skill);
+       BLACKSMITHY:            CreateRepairDeed(who, use_on, craft_skill);
+       BOWCRAFT_FLETCHING:    CreateRepairDeed(who, use_on, craft_skill);
+       CARPENTRY:   		 CreateRepairDeed(who, use_on, craft_skill);
+       TAILORING:   		 CreateRepairDeed(who, use_on, craft_skill);
     endcase
     return;
   endif
   var forge := 0;
   case(CInt(craft_skill))
-     ATTRIBUTE_BLACKSMITHY: forge := 1;
+     BLACKSMITHY: forge := 1;
   endcase
   if(!forge)
     if(is_weapon_armor(use_on.objtype))



From austin at berlios.de  Wed Nov  2 16:30:30 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 16:30:30 +0100
Subject: [Poldistro-svn] r836 - trunk/096/scripts/include
Message-ID: <200511021530.jA2FUUjE004994@sheep.berlios.de>

Author: austin
Date: 2005-11-02 16:30:07 +0100 (Wed, 02 Nov 2005)
New Revision: 836

Modified:
   trunk/096/scripts/include/client.inc
Log:
Gets rid of skill ID constants.. so we can pretend they never existed.

Modified: trunk/096/scripts/include/client.inc
===================================================================
--- trunk/096/scripts/include/client.inc	2005-11-02 14:18:41 UTC (rev 835)
+++ trunk/096/scripts/include/client.inc	2005-11-02 15:30:07 UTC (rev 836)
@@ -168,61 +168,3 @@
 const FONTCOLOR_BLACK := 1;
 const FONTCOLOR_BROWN := 46;
 const FONTCOLOR_YELLOW := 53;
-
-////
-// SkillIDs
-///
-const SKILLID_ALCHEMY           := 0;
-const SKILLID_ANATOMY           := 1;
-const SKILLID_ANIMALLORE        := 2;
-const SKILLID_ITEMID            := 3;
-const SKILLID_ARMSLORE          := 4;
-const SKILLID_PARRY		:= 5;
-const SKILLID_BEGGING           := 6;
-const SKILLID_BLACKSMITHY       := 7;
-const SKILLID_BOWCRAFT          := 8;
-const SKILLID_PEACEMAKING       := 9;
-const SKILLID_CAMPING           := 10;
-const SKILLID_CARPENTRY         := 11;
-const SKILLID_CARTOGRAPHY       := 12;
-const SKILLID_COOKING           := 13;
-const SKILLID_DETECTINGHIDDEN   := 14;
-const SKILLID_ENTICEMENT        := 15;
-const SKILLID_EVALINT           := 16;
-const SKILLID_HEALING           := 17;
-const SKILLID_FISHING           := 18;
-const SKILLID_FORENSICS         := 19;
-const SKILLID_HERDING           := 20;
-const SKILLID_HIDING            := 21;
-const SKILLID_PROVOCATION       := 22;
-const SKILLID_INSCRIPTION       := 23;
-const SKILLID_LOCKPICKING       := 24;
-const SKILLID_MAGERY            := 25;
-const SKILLID_MAGICRESISTANCE   := 26;
-const SKILLID_TACTICS           := 27;
-const SKILLID_SNOOPING          := 28;
-const SKILLID_MUSICIANSHIP      := 29;
-const SKILLID_POISONING         := 30;
-const SKILLID_ARCHERY           := 31;
-const SKILLID_SPIRITSPEAK       := 32;
-const SKILLID_STEALING          := 33;
-const SKILLID_TAILORING         := 34;
-const SKILLID_TAMING            := 35;
-const SKILLID_TASTEID           := 36;
-const SKILLID_TINKERING         := 37;
-const SKILLID_TRACKING          := 38;
-const SKILLID_VETERINARY        := 39;
-const SKILLID_SWORDSMANSHIP     := 40;
-const SKILLID_MACEFIGHTING      := 41;
-const SKILLID_FENCING           := 42;
-const SKILLID_WRESTLING         := 43;
-const SKILLID_LUMBERJACKING     := 44;
-const SKILLID_MINING            := 45;
-const SKILLID_MEDITATION        := 46;
-const SKILLID_STEALTH           := 47;
-const SKILLID_REMOVETRAP        := 48;
-const SKILLID_NECROMANCY        := 49;
-const SKILLID_FOCUS             := 50;
-const SKILLID_CHIVALRY          := 51;
-const SKILLID__HIGHEST          := 48;
-const SKILLID_AOS_HIGHEST       := 51;



From austin at berlios.de  Wed Nov  2 16:36:31 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 16:36:31 +0100
Subject: [Poldistro-svn] r837 - in trunk/096/pkg/skills/lumberjacking: . config include treeRegen
Message-ID: <200511021536.jA2FaVDE006274@sheep.berlios.de>

Author: austin
Date: 2005-11-02 16:36:28 +0100 (Wed, 02 Nov 2005)
New Revision: 837

Added:
   trunk/096/pkg/skills/lumberjacking/config/
   trunk/096/pkg/skills/lumberjacking/config/icp.cfg
   trunk/096/pkg/skills/lumberjacking/config/settings.cfg
   trunk/096/pkg/skills/lumberjacking/config/woodRegions.cfg
   trunk/096/pkg/skills/lumberjacking/include/
   trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc
   trunk/096/pkg/skills/lumberjacking/include/settings.inc
   trunk/096/pkg/skills/lumberjacking/lumberJack.src
   trunk/096/pkg/skills/lumberjacking/pkg.cfg
   trunk/096/pkg/skills/lumberjacking/start.src
   trunk/096/pkg/skills/lumberjacking/treeRegen/
   trunk/096/pkg/skills/lumberjacking/treeRegen/control.src
Log:
New lumberjacking system.
Support for different types of logs and regionalizing them on each realm.


Added: trunk/096/pkg/skills/lumberjacking/config/icp.cfg
===================================================================
--- trunk/096/pkg/skills/lumberjacking/config/icp.cfg	2005-11-02 15:30:07 UTC (rev 836)
+++ trunk/096/pkg/skills/lumberjacking/config/icp.cfg	2005-11-02 15:36:28 UTC (rev 837)
@@ -0,0 +1,13 @@
+ICP Register
+{
+	Name		Lumberjacking
+	Version		1.0
+
+	Description	Handles lumberjacking and wood regeneration in trees.
+
+	Creator		Austin
+	C_Email		AustinHeilman at gmail.com
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+}

Added: trunk/096/pkg/skills/lumberjacking/config/settings.cfg
===================================================================
--- trunk/096/pkg/skills/lumberjacking/config/settings.cfg	2005-11-02 15:30:07 UTC (rev 836)
+++ trunk/096/pkg/skills/lumberjacking/config/settings.cfg	2005-11-02 15:36:28 UTC (rev 837)
@@ -0,0 +1,187 @@
+Elem Settings
+{
+	// Minutes the tree regeneration waits between cycles.
+	RegenWait	30
+	
+	// Max number of log points per tree.
+	MaxWood		15
+}
+
+
+Elem TreeList
+{
+	// Graphics that the lumberjacking skill can be used on.
+	Graphic	0x0C95
+	Graphic	0x0C96
+	Graphic	0x0CAA
+	Graphic	0x0CAB
+	Graphic	0x0CC8
+	Graphic	0x0CC9
+	Graphic	0x0CCA
+	Graphic	0x0CCB
+	Graphic	0x0CCD
+	Graphic	0x0CCE
+	Graphic	0x0CCF
+	Graphic	0x0CD0
+	Graphic	0x0CD1
+	Graphic	0x0CD2
+	Graphic	0x0CD3
+	Graphic	0x0CD4
+	Graphic	0x0CD5
+	Graphic	0x0CD6
+	Graphic	0x0CD7
+	Graphic	0x0CD8
+	Graphic	0x0CD9
+	Graphic	0x0CDA
+	Graphic	0x0CDB
+	Graphic	0x0CDC
+	Graphic	0x0CDD
+	Graphic	0x0CDE
+	Graphic	0x0CDF
+	Graphic	0x0CE0
+	Graphic	0x0CE1
+	Graphic	0x0CE2
+	Graphic	0x0CE3
+	Graphic	0x0CE4
+	Graphic	0x0CE5
+	Graphic	0x0CE6
+	Graphic	0x0CE7
+	Graphic	0x0CE8
+	Graphic	0x0CF8
+	Graphic	0x0CF9
+	Graphic	0x0CFA
+	Graphic	0x0CFB
+	Graphic	0x0CFC
+	Graphic	0x0CFD
+	Graphic	0x0CFE
+	Graphic	0x0CFF
+	Graphic	0x0D00
+	Graphic	0x0D01
+	Graphic	0x0D02
+	Graphic	0x0D03
+	Graphic	0x0D41
+	Graphic	0x0D42
+	Graphic	0x0D43
+	Graphic	0x0D44
+	Graphic	0x0D45
+	Graphic	0x0D46
+	Graphic	0x0D47
+	Graphic	0x0D48
+	Graphic	0x0D49
+	Graphic	0x0D4A
+	Graphic	0x0D4B
+	Graphic	0x0D4C
+	Graphic	0x0D4D
+	Graphic	0x0D4E
+	Graphic	0x0D4F
+	Graphic	0x0D50
+	Graphic	0x0D51
+	Graphic	0x0D52
+	Graphic	0x0D53
+	Graphic	0x0D54
+	Graphic	0x0D55
+	Graphic	0x0D56
+	Graphic	0x0D57
+	Graphic	0x0D58
+	Graphic	0x0D59
+	Graphic	0x0D5A
+	Graphic	0x0D5B
+	Graphic	0x0D5C
+	Graphic	0x0D5D
+	Graphic	0x0D5E
+	Graphic	0x0D5F
+	Graphic	0x0D60
+	Graphic	0x0D61
+	Graphic	0x0D62
+	Graphic	0x0D63
+	Graphic	0x0D64
+	Graphic	0x0D65
+	Graphic	0x0D66
+	Graphic	0x0D67
+	Graphic	0x0D68
+	Graphic	0x0D69
+	Graphic	0x0D6A
+	Graphic	0x0D6B
+	Graphic	0x0D6C
+	Graphic	0x0D6D
+	Graphic	0x0D6E
+	Graphic	0x0D6F
+	Graphic	0x0D70
+	Graphic	0x0D71
+	Graphic	0x0D72
+	Graphic	0x0D73
+	Graphic	0x0D74
+	Graphic	0x0D75
+	Graphic	0x0D76
+	Graphic	0x0D77
+	Graphic	0x0D78
+	Graphic	0x0D79
+	Graphic	0x0D7A
+	Graphic	0x0D7B
+	Graphic	0x0D7C
+	Graphic	0x0D7D
+	Graphic	0x0D7E
+	Graphic	0x0D7F
+	Graphic	0x0D80
+	Graphic	0x0D81
+	Graphic	0x0D82
+	Graphic	0x0D83
+	Graphic	0x0D84
+	Graphic	0x0D85
+	Graphic	0x0D86
+	Graphic	0x0D87
+	Graphic	0x0D88
+	Graphic	0x0D89
+	Graphic	0x0D8A
+	Graphic	0x0D8B
+	Graphic	0x0D8C
+	Graphic	0x0D8D
+	Graphic	0x0D8E
+	Graphic	0x0D8F
+	Graphic	0x0D90
+	Graphic	0x0D91
+	Graphic	0x0D92
+	Graphic	0x0D93
+	Graphic	0x0D94
+	Graphic	0x0D95
+	Graphic	0x0D96
+	Graphic	0x0D97
+	Graphic	0x0D98
+	Graphic	0x0D99
+	Graphic	0x0D9A
+	Graphic	0x0D9B
+	Graphic	0x0D9C
+	Graphic	0x0D9D
+	Graphic	0x0D9E
+	Graphic	0x0D9F
+	Graphic	0x0DA0
+	Graphic	0x0DA1
+	Graphic	0x0DA2
+	Graphic	0x0DA3
+	Graphic	0x0DA4
+	Graphic	0x0DA5
+	Graphic	0x0DA6
+	Graphic	0x0DA7
+	Graphic	0x0DA8
+	Graphic	0x0DA9
+	Graphic	0x0DAA
+	Graphic	0x0DAB
+	Graphic	0x12B6
+	Graphic	0x12B7
+	Graphic	0x12B8
+	Graphic	0x12B9
+	Graphic	0x12BA
+	Graphic	0x12BB
+	Graphic	0x12BC
+	Graphic	0x12BD
+	Graphic	0x12BE
+	Graphic	0x12BF
+	Graphic	0x12C0
+	Graphic	0x12C1
+	Graphic	0x12C2
+	Graphic	0x12C3
+	Graphic	0x12C4
+	Graphic	0x12C5
+	Graphic	0x12C6
+	Graphic	0x12C7
+}

Added: trunk/096/pkg/skills/lumberjacking/config/woodRegions.cfg
===================================================================
--- trunk/096/pkg/skills/lumberjacking/config/woodRegions.cfg	2005-11-02 15:30:07 UTC (rev 836)
+++ trunk/096/pkg/skills/lumberjacking/config/woodRegions.cfg	2005-11-02 15:36:28 UTC (rev 837)
@@ -0,0 +1,10 @@
+Realm	Britannia
+{
+	Region	Britannia-Global
+}
+
+Region Britannia-Global
+{
+	Rect		0 0 6138 4090
+	WoodType	Log
+}

Added: trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc
===================================================================
--- trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc	2005-11-02 15:30:07 UTC (rev 836)
+++ trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc	2005-11-02 15:36:28 UTC (rev 837)
@@ -0,0 +1,264 @@
+use uo;
+use os;
+use util;
+use cfgfile;
+use file;
+
+include ":datafile:datafile";
+include ":lumberjacking:settings";
+
+/*
+ * LJ_ReportText(text)
+ *
+ * Purpose
+ * Outputs text to pol/log/lumberjacking.log rather than pol.log or the console.
+ *
+ * Parameters
+ * text:	Text to log.
+ *
+ * Return value
+ * Result of LogToFile()
+ *
+ */
+function LJ_ReportText(text)
+	var script_name := GetProcess(GetPid()).name;
+	return LogToFile("::log/lumberjacking.log", "["+script_name+"]: "+text, LOG_DATETIME);
+endfunction
+
+/*
+ * LJ_IsTree(graphic)
+ *
+ * Purpose
+ * Determines if the graphic can be used for lumberjacking.
+ * Uses settings.cfg elem TreeList
+ *
+ * Parameters
+ * graphic:	Graphic to verify
+ *
+ * Return value
+ * Returns 1 if the object can be used.
+ *
+ */
+function LJ_IsTree(graphic)
+	var cfg_elem := LJ_GetSettingsCfgElem("TreeList");
+	graphic := CStr(graphic);
+
+	return ( graphic in GetConfigStringArray(cfg_elem, "Graphic") );
+endfunction
+
+/*
+ * LJ_InRect(x_pos, y_pos, rect_string)
+ *
+ * Purpose
+ * Determines if a coordinate is within an area.
+ *
+ * Parameters
+ * x_pos:	X position of the coordinate to verify.
+ * y_pos:	Y position of the coordinate to verify.
+ * rect_string:	Rect line from WoodRegions.cfg
+ *
+ * Return value
+ * Returns 1 if the coordinates are in the rect.
+ *
+ */
+function LJ_InRect(x_pos, y_pos, rect)
+	var x1 := CInt(rect[1]);
+	var y1 := CInt(rect[2]);
+	var x2 := CInt(rect[3]);
+	var y2 := CInt(rect[4]);
+
+	return ( (x_pos >= x1 && x_pos <= x2) && (y_pos >= y1 && y_pos <= y2) );
+endfunction
+
+
+
+/*
+ * LJ_GetDataFile()
+ *
+ * Purpose
+ * Retrieves the lumberjacking datafile
+ *
+ * Parameters
+ *
+ * Return value
+ * data file
+ *
+ */
+function LJ_GetDataFile()
+	var data_file := DFOpenDataFile(":lumberjacking:TreeSettings", DF_CREATE);
+
+	return data_file;
+endfunction
+
+/*
+ * LJ_GetDataFile()
+ *
+ * Purpose
+ * Retrieves an elem from the lumberjacking data file.
+ *
+ * Parameters
+ * elem_name:	Name of the elem to retrieve.
+ *
+ * Return value
+ * Data elem
+ *
+ */
+function LJ_GetDataElem(elem_name)
+	var data_file := LJ_GetDataFile();
+	var data_elem := DFFindElement(data_file, elem_name, DF_CREATE);
+
+	return data_elem;
+endfunction
+
+/*
+ * LJ_GetWoodType(realm, x_pos, y_pos)
+ *
+ * Purpose
+ * Retrieves the type of wood set for an X and Y coordinate.
+ *
+ * Parameters
+ * realm:	Name of the realm the coordinates are on.
+ * x_pos:	X coordinate to use.
+ * y_pos:	Y coordinate to use.
+ *
+ * Return value
+ * returns an object type number
+ *
+ */
+function LJ_GetWoodType(realm, x_pos, y_pos)
+	var pos_string := CStr(realm+" "+x_pos+"x"+y_pos);
+
+	var data_elem := LJ_GetDataElem(pos_string);
+
+	var type := data_elem.GetProp("Type");
+	if ( !type )
+		type := LJ_PickWoodType(realm, x_pos, y_pos);
+		LJ_SetWoodType(realm, x_pos, y_pos, type);
+	endif
+
+	return type;
+endfunction
+
+/*
+ * LJ_SetWoodType(realm, x_pos, y_pos, wood_type)
+ *
+ * Purpose
+ * Sets the wood type for an X Y coordinate on a realm.
+ * 
+ * Parameters
+ * realm:	Name of the realm to set the wood type on.
+ * x_pos:	X coordinate to set the wood type on.
+ * y_pos:	Y coordinate to set the wood type on.
+ * wood_type:	object type of the wood to set.
+ *
+ * Return value
+ * Returns 1
+ *
+ */
+function LJ_SetWoodType(realm, x_pos, y_pos, wood_type)
+	var pos_string := CStr(realm+" "+x_pos+"x"+y_pos);
+	
+	var data_elem := LJ_GetDataElem(pos_string);
+	
+	return data_elem.SetProp("Type", wood_type);
+endfunction
+
+/*
+ * LJ_SetWoodAmount(realm, x_pos, y_pos, amount)
+ *
+ * Purpose
+ * Sets the wood amount for an X Y coordinate on a realm.
+ * 
+ * Parameters
+ * realm:	Name of the realm to set the wood amount on.
+ * x_pos:	X coordinate to set the wood amount on.
+ * y_pos:	Y coordinate to set the wood amount on.
+ * amount:	Amount of wood to make available.
+ *
+ * Return value
+ * Returns 1
+ *
+ */
+function LJ_SetWoodAmount(realm, x_pos, y_pos, amount)
+	var pos_string := CStr(realm+" "+x_pos+"x"+y_pos);
+	
+	var data_elem := LJ_GetDataElem(pos_string);
+	
+	data_elem.SetProp("Amount", amount);
+endfunction
+
+/*
+ * LJ_GetWoodAmount(realm, x_pos, y_pos)
+ *
+ * Purpose
+ * Retrieves the amount of wood set for an X and Y coordinate.
+ *
+ * Parameters
+ * realm:	Name of the realm the coordinates are on.
+ * x_pos:	X coordinate to use.
+ * y_pos:	Y coordinate to use.
+ *
+ * Return value
+ * returns a number
+ *
+ */
+function LJ_GetWoodAmount(realm, x_pos, y_pos)
+	var pos_string := CStr(realm+" "+x_pos+"x"+y_pos);
+	
+	var data_elem := LJ_GetDataElem(pos_string);
+	
+	var amount := data_elem.GetProp("Amount");
+	if ( amount == error )
+		var settings := LJ_GetSettingsCfgElem("Settings");
+		amount := CInt(settings.MaxWood);
+		LJ_SetWoodAmount(realm, x_pos, y_pos, amount);
+	endif
+	
+	return CInt(amount);
+endfunction
+
+/*
+ * LJ_PickWoodType(realm, x_pos, y_pos)
+ *
+ * Purpose
+ * Selects a random wood type for a tree based on
+ * the realm and region coordinates in woodRegions.cfg
+ *
+ * Parameters
+ * realm:	Name of the realm the coordinates are on.
+ * x_pos:	X coordinate to use.
+ * y_pos:	Y coordinate to use.
+ *
+ * Return value
+ * returns an object type number
+ *
+ */
+function LJ_PickWoodType(realm, x_pos, y_pos)
+	var wood_cfg := ReadConfigFile(":lumberjacking:config/woodRegions");
+	if ( !wood_cfg )
+		return GetObjTypeByName("Log");
+	endif
+
+	var realm_elem := wood_cfg[realm];
+	if ( !realm_elem )
+		return GetObjTypeByName("Log");
+	endif
+
+	var wood_found := array{"Log"};
+	foreach region_name in ( GetConfigStringArray(realm_elem, "Region") )
+		var region_elem := wood_cfg[region_name];
+		if ( !LJ_InRect(x_pos, y_pos, region_elem.Rect) )
+			continue;
+		endif
+
+		var wood_types := GetConfigStringArray(region_elem, "WoodType");
+		if ( wood_types.Size() >= 1 )
+			wood_found := wood_found+wood_types;
+		endif
+		sleepms(2);
+	endforeach
+
+	var selected_wood := wood_found[RandomInt(wood_found.Size())+1];
+	return GetObjTypeByName(selected_wood);
+endfunction
+

Added: trunk/096/pkg/skills/lumberjacking/include/settings.inc
===================================================================
--- trunk/096/pkg/skills/lumberjacking/include/settings.inc	2005-11-02 15:30:07 UTC (rev 836)
+++ trunk/096/pkg/skills/lumberjacking/include/settings.inc	2005-11-02 15:36:28 UTC (rev 837)
@@ -0,0 +1,66 @@
+//$Id: settings.inc 264 2005-09-27 21:55:42Z austin $
+
+/*===============================================================
+* Current Version
+* SETTINGS.INC - v1.0
+* Updated 9/27/2005 2:54PM
+*
+* -- Revision v1.0 --
+* Austin:
+*  Created include file
+===============================================================*/
+
+use uo;
+use os;
+use cfgfile;
+
+/*
+ * LJ_GetSettingsCfgFile(engine_name)
+ *
+ * Purpose
+ * Reads in :lumberjacking:config/settings.cfg
+ *
+ * Parameters
+ *
+ * Return value
+ * A config file reference.
+ *
+ */
+function LJ_GetSettingsCfgFile()
+	var cfg := ReadConfigFile(":lumberjacking:config/settings");
+
+	if ( cfg.errortext )
+		SysLog("Error::LJ_GetSettingsCfgFile() - Unable to open [:lumberjacking:config/settings.cfg] ->"+cfg.errortext);
+	endif
+
+	return cfg;
+endfunction
+
+/*
+ * LJ_GetSettingsCfgElem(elem_name, cfg_file)
+ *
+ * Purpose
+ * Retrieves an elem from a config file. 
+ *
+ * Parameters
+ * elem_name:	A string matching the elem name to be retrieved.
+ * cfg_file:	Optional parameter - reference to a config already read in by LJ_GetSettingsCfgFile()
+ *
+ * Return value
+ * A config file elem reference.
+ *
+ */
+function LJ_GetSettingsCfgElem(elem_name, byref cfg_file:=0)
+	if ( !cfg_file )
+		cfg_file := LJ_GetSettingsCfgFile();
+	endif
+	
+	var elem := cfg_file[elem_name];
+
+	if ( elem.errortext )
+		SysLog("Error::LJ_GetSettingsCfgElem() - Unable to find elem ["+elem_name+"] ->"+elem.errortext);
+	endif
+
+	return elem;
+endfunction
+

Added: trunk/096/pkg/skills/lumberjacking/lumberJack.src
===================================================================
--- trunk/096/pkg/skills/lumberjacking/lumberJack.src	2005-11-02 15:30:07 UTC (rev 836)
+++ trunk/096/pkg/skills/lumberjacking/lumberJack.src	2005-11-02 15:36:28 UTC (rev 837)
@@ -0,0 +1,99 @@
+/*
+ * $Id$
+ *
+ */
+use uo;
+use os;
+
+include ":attributes:attributes";
+include ":datafile:datafile";
+include ":lumberjacking:settings";
+include ":lumberjacking:lumberJack";
+include "include/client";
+
+program skill_LumberJack(who, tool)
+	SendSysMessage(who, "Select a tree to chop.");
+	var targ := TargetCoordinates(who);
+	
+	if ( !targ )
+		SendSysMessage(who, "Cancelled.");
+		return 0;
+	elseif ( !LJ_IsTree(targ.objtype) )
+		SendSysMessage(who, "That is not a tree.");
+		return 0;
+	endif
+	
+	var orig_x := who.x;
+	var orig_y := who.y;
+	
+	var num_loops := RandomDiceRoll("1d5");
+	for ( num_loops; num_loops>=0; num_loops:=num_loops-1 )
+		if ( !ChopTree(who, tool, targ, orig_x, orig_y) )
+			break;
+		endif
+		// Wear down tool function call goes here.
+		sleep(3);
+	endfor
+
+	SendSysMessage(who, "You stop lumberjacking.");
+endprogram
+
+function ChopTree(who, tool, targ, orig_x, orig_y)
+	var i:=RandomDiceRoll("3d4");
+	for ( i; i>=0; i:=i-1 )
+		if ( !CanChop(who, tool, targ, orig_x, orig_y) )
+			return 0;
+		endif
+
+		PerformAction(who, ANIM_ATTACK_2HAND_WIDE);
+		//PlaySoundEffect(who, SFX_SKILL_LUMBERJACK); - Need to get sound constants in client.inc!
+		sleepms(1200);
+	endfor
+
+	var wood_type := LJ_GetWoodType(who.realm, targ.x, targ.y);
+	var wood_amount := LJ_GetWoodAmount(who.realm, targ.x, targ.y);
+
+	var material_cfg := ReadConfigFile(":crafting:configs/materials");
+	var diff_mod := material_cfg[wood_type].Difficulty;
+	if ( material_cfg.errortext )
+		SendSysMessage(who, "Error - Unable to open :crafting:configs/materials.cfg ->"+material_cfg.errortext);
+		return 0;
+	endif
+
+	var max_wood := CInt(LJ_GetSettingsCfgElem("Settings").MaxWood);
+	// The less wood there is, the more difficult it becomes.
+	var difficulty := CInt( 40 + ( diff_mod - 0.4 ) * 100 - 40 * wood_amount / max_wood );
+	
+	wood_amount := wood_amount - 1;
+	LJ_SetWoodAmount(who.realm, targ.x, targ.y, wood_amount);
+
+	if ( SkillCheck(who, LUMBERJACKING, difficulty) > 0 )
+		CreateItemInBackPack(who, wood_type, 1);
+		SendSysMessage(who, "You place the log in your pack.");
+		return 1;
+	endif
+
+	SendSysMessage(who, "You are unable to produce a useable log from this tree.");
+	return 0;
+endfunction
+
+function CanChop(who, axe, targ, orig_x, orig_y)
+	if ( who.hidden )
+		SendSysMessage(who, "You stop chopping to remain hidden.");
+		return 0;
+	elseif ( who.x != orig_x || who.y != orig_y )
+		SendSysMessage(who, "You turn your attention away from lumberjacking.");
+		return 0;
+	elseif ( !(axe in ListEquippedItems(who)) )
+		SendSysMessage(who, "You put the axe away and stop chopping.");
+		return 0;
+	elseif ( LJ_GetWoodAmount(who.realm, targ.x, targ.y) <= 0 )
+		SendSysMessage(who, "That tree has been chopped down.");
+		return 0;
+	elseif ( GetEquipmentByLayer(who, LAYER_MOUNT) )
+		SendSysMessage(who, "You can't chop while mounted.");
+		return 0;
+	else
+		return 1;
+	endif
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/skills/lumberjacking/pkg.cfg
===================================================================
--- trunk/096/pkg/skills/lumberjacking/pkg.cfg	2005-11-02 15:30:07 UTC (rev 836)
+++ trunk/096/pkg/skills/lumberjacking/pkg.cfg	2005-11-02 15:36:28 UTC (rev 837)
@@ -0,0 +1,18 @@
+#
+# $Id$
+#
+Enabled		1
+Name		lumberjacking
+
+Version		1.0
+
+CoreRequired	96
+
+Creator		Austin Heilman
+Email		AustinHeilman at gmail.com
+
+Maintainer	Distro Team
+Email		distro at polserver.com
+
+#Requires none
+#conflicts	none

Added: trunk/096/pkg/skills/lumberjacking/start.src
===================================================================
--- trunk/096/pkg/skills/lumberjacking/start.src	2005-11-02 15:30:07 UTC (rev 836)
+++ trunk/096/pkg/skills/lumberjacking/start.src	2005-11-02 15:36:28 UTC (rev 837)
@@ -0,0 +1,8 @@
+use os;
+
+var script := start_script("regen/WoodRegen");
+if ( script.errortext )
+	SysLog("Error starting tree regen ->"+script.errortext);
+else
+	Print("Starting tree regeneration controller... ok.");
+endif

Added: trunk/096/pkg/skills/lumberjacking/treeRegen/control.src
===================================================================
--- trunk/096/pkg/skills/lumberjacking/treeRegen/control.src	2005-11-02 15:30:07 UTC (rev 836)
+++ trunk/096/pkg/skills/lumberjacking/treeRegen/control.src	2005-11-02 15:36:28 UTC (rev 837)
@@ -0,0 +1,44 @@
+/*
+ * $Id$
+ *
+ */
+use uo;
+use os;
+
+include ":datafile:datafile";
+include ":lumberjacking:settings";
+include ":lumberjacking:lumberJack";
+
+program GlobalControl()
+	var settings := LJ_GetSettingsCfgElem("Settings");
+	var cycle_wait := CInt(settings.RegenWait);
+	if ( cycle_wait < 1 )
+		cycle_wait := 1;
+	endif
+	cycle_wait := cycle_wait * 60;
+	
+	SetGlobalProperty("#TreeRegenPId", GetPid());
+	
+	set_priority(1);
+	while( 1 )
+		sleep(cycle_wait);
+		RegenWood(settings);
+	endwhile
+endprogram
+
+function RegenWood(settings)
+	Print("Running wood regeneration cycle...");
+	var data_file := LJ_GetDataFile();
+	
+	foreach elem_name in DFGetElemNames(data_file)
+		var data_elem := LJ_GetDataElem(elem_name);
+		
+		var amount := CInt(data_elem.GetProp("Amount"));
+		if ( amount < CInt(settings.MaxWood) )
+			amount := amount+1;
+			data_elem.SetProp("Amount", amount);
+		endif
+		
+		sleep(1);
+	endforeach
+endfunction



From austin at berlios.de  Wed Nov  2 19:18:57 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 19:18:57 +0100
Subject: [Poldistro-svn] r838 - trunk/096/pkg/utils/gumps/include
Message-ID: <200511021818.jA2IIvSq016069@sheep.berlios.de>

Author: austin
Date: 2005-11-02 19:18:54 +0100 (Wed, 02 Nov 2005)
New Revision: 838

Modified:
   trunk/096/pkg/utils/gumps/include/gumps_ex.inc
Log:
Should fix the data being lost if it comes before any sort of "page #" entry.

Modified: trunk/096/pkg/utils/gumps/include/gumps_ex.inc
===================================================================
--- trunk/096/pkg/utils/gumps/include/gumps_ex.inc	2005-11-02 15:36:28 UTC (rev 837)
+++ trunk/096/pkg/utils/gumps/include/gumps_ex.inc	2005-11-02 18:18:54 UTC (rev 838)
@@ -113,9 +113,9 @@
 			var page_num := l_entry[6, Len(l_entry)];
 			if ( !gump_pages.Exists(page_num) )
 				gump_pages[page_num] := array;
-				cur_page := page_num;
+				cur_page := CInt(page_num);
 			else
-				cur_page := page_num;
+				cur_page := CInt(page_num);
 				continue;
 			endif
 		endif
@@ -124,9 +124,11 @@
 	endforeach
 	
 	//Put the gump back together again.
-	gump.layout := array; // Wipe it out
+	gump.layout := array{}; // Wipe it out
 	foreach page_array in (gump_pages)
+		 // Goes through the dictionary which contains each page's array.
 		foreach entry in (page_array)
+			// Goes through the array containing layout data for that page.
 			(gump.layout).Append(entry);
 			sleepms(2);
 		endforeach



From austin at berlios.de  Wed Nov  2 19:20:31 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 19:20:31 +0100
Subject: [Poldistro-svn] r839 - trunk/096/pkg/utils/gumps/include
Message-ID: <200511021820.jA2IKV2K017147@sheep.berlios.de>

Author: austin
Date: 2005-11-02 19:20:29 +0100 (Wed, 02 Nov 2005)
New Revision: 839

Modified:
   trunk/096/pkg/utils/gumps/include/gumps_ex.inc
Log:
Better fix for page data loss.

Modified: trunk/096/pkg/utils/gumps/include/gumps_ex.inc
===================================================================
--- trunk/096/pkg/utils/gumps/include/gumps_ex.inc	2005-11-02 18:18:54 UTC (rev 838)
+++ trunk/096/pkg/utils/gumps/include/gumps_ex.inc	2005-11-02 18:20:29 UTC (rev 839)
@@ -110,12 +110,14 @@
 	foreach entry in (gump.layout)
 		var l_entry := Lower(entry);
 		if ( l_entry[1, 5] == "page " )
-			var page_num := l_entry[6, Len(l_entry)];
+			//  12345   6
+			// "Page " "#"
+			var page_num := CInt(l_entry[6, Len(l_entry)]);
 			if ( !gump_pages.Exists(page_num) )
 				gump_pages[page_num] := array;
-				cur_page := CInt(page_num);
+				cur_page := page_num;
 			else
-				cur_page := CInt(page_num);
+				cur_page := page_num;
 				continue;
 			endif
 		endif



From austin at berlios.de  Wed Nov  2 19:46:35 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 19:46:35 +0100
Subject: [Poldistro-svn] r840 - in trunk/096/pkg/items: treasuremap wands
Message-ID: <200511021846.jA2IkZdx026817@sheep.berlios.de>

Author: austin
Date: 2005-11-02 19:46:32 +0100 (Wed, 02 Nov 2005)
New Revision: 840

Modified:
   trunk/096/pkg/items/treasuremap/decodeMap.src
   trunk/096/pkg/items/wands/magicWands.src
Log:
Attribute updates

Modified: trunk/096/pkg/items/treasuremap/decodeMap.src
===================================================================
--- trunk/096/pkg/items/treasuremap/decodeMap.src	2005-11-02 18:20:29 UTC (rev 839)
+++ trunk/096/pkg/items/treasuremap/decodeMap.src	2005-11-02 18:46:32 UTC (rev 840)
@@ -24,7 +24,7 @@
   if( maplevel > maxlevel )
     SendSysMessage( who, "You cannot comprehend the map." );
   else
-    if(CheckSkill( who, SKILLID_CARTOGRAPHY, (maplevel*20), (maplevel*100)))
+    if( SkillCheck(who, CARTOGRAPHY, (maplevel*20)) > 0 )
       CreateTreasureMap( who, map, maplevel );
     else
       SendSysMessage( who, "You understand the map, but fail to decode it." );

Modified: trunk/096/pkg/items/wands/magicWands.src
===================================================================
--- trunk/096/pkg/items/wands/magicWands.src	2005-11-02 18:20:29 UTC (rev 839)
+++ trunk/096/pkg/items/wands/magicWands.src	2005-11-02 18:46:32 UTC (rev 840)
@@ -276,7 +276,7 @@
   if(cast_on.dead)
     return 0;
   endif
-  if(CheckSkill(cast_on, SKILLID_MAGICRESISTANCE, magery, (magery * 2)))
+  if( SkillCheck(cast_on, RESISTING_SPELLS, magery) > 0 )
     SendSysMessage(cast_on, "You feel yourself resisting magical energy!");
     PlaySoundEffect(cast_on, SFX_SPELL_WEAKEN);
     PlayObjectCenteredEffect( cast_on, FX_CURSE_EFFECT, 5,5);
@@ -374,7 +374,7 @@
     endif
   endif
   if(GetObjProperty(the_item, "type") == "cursed")
-    if(CheckSkill(who, SKILLID_ITEMID, 65, 0) )
+    if(CheckSkill(who, ITEM_IDENTIFICATION, 65, 0) )
       SendSysMessage(who, "* This item is cursed! *");
     endif
   endif



From austin at berlios.de  Wed Nov  2 19:47:02 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 19:47:02 +0100
Subject: [Poldistro-svn] r841 - in trunk/096/pkg/skills: herding lockpicking magery
Message-ID: <200511021847.jA2Il2JS026930@sheep.berlios.de>

Author: austin
Date: 2005-11-02 19:46:59 +0100 (Wed, 02 Nov 2005)
New Revision: 841

Modified:
   trunk/096/pkg/skills/herding/herd.src
   trunk/096/pkg/skills/lockpicking/lockpicking.src
   trunk/096/pkg/skills/magery/agility.src
   trunk/096/pkg/skills/magery/archCure.src
   trunk/096/pkg/skills/magery/archProt.src
   trunk/096/pkg/skills/magery/bladeSpirit.src
   trunk/096/pkg/skills/magery/bless.src
   trunk/096/pkg/skills/magery/clumsy.src
   trunk/096/pkg/skills/magery/cunning.src
   trunk/096/pkg/skills/magery/cure.src
   trunk/096/pkg/skills/magery/curse.src
   trunk/096/pkg/skills/magery/dispelField.src
   trunk/096/pkg/skills/magery/feeblemind.src
   trunk/096/pkg/skills/magery/gHeal.src
   trunk/096/pkg/skills/magery/heal.src
   trunk/096/pkg/skills/magery/invisibility.src
   trunk/096/pkg/skills/magery/magicLock.src
   trunk/096/pkg/skills/magery/magicTrap.src
   trunk/096/pkg/skills/magery/massCurse.src
   trunk/096/pkg/skills/magery/massDispel.src
   trunk/096/pkg/skills/magery/nightSight.src
   trunk/096/pkg/skills/magery/paralyze.src
   trunk/096/pkg/skills/magery/poison.src
   trunk/096/pkg/skills/magery/polymorph.src
   trunk/096/pkg/skills/magery/protection.src
   trunk/096/pkg/skills/magery/reactiveArmor.src
   trunk/096/pkg/skills/magery/strength.src
   trunk/096/pkg/skills/magery/summon.inc
   trunk/096/pkg/skills/magery/summonCreature.src
   trunk/096/pkg/skills/magery/telekinesis.src
   trunk/096/pkg/skills/magery/weaken.src
Log:
Attribute updates

Modified: trunk/096/pkg/skills/herding/herd.src
===================================================================
--- trunk/096/pkg/skills/herding/herd.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/herding/herd.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -45,8 +45,8 @@
                 SendSysMessage(who, "You can't herd that!");
                 return;
         endif
-	var thepoints := 50;
-        if(CheckSkill(who, SKILLID_HERDING, herdskill, thepoints))
+	
+        if( SkillCheck(who, HERDING, herdskill) > 0 )
 
                 SendSysMessage(who, "Where do you want to move "+ npc.name +" to?");
                 var location := TargetCoordinates(who);

Modified: trunk/096/pkg/skills/lockpicking/lockpicking.src
===================================================================
--- trunk/096/pkg/skills/lockpicking/lockpicking.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/lockpicking/lockpicking.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -59,7 +59,7 @@
   PlaySoundEffect(chest,SFX_242);
   sleep(2);
   var diff := (lvl * 20)+10;
-  if ( CheckSkill(me,SKILLID_LOCKPICKING,diff,0) )
+  if ( SkillCheck(me, LOCKPICKING, diff) > 0 )
 	PlaySoundEffect(chest,SFX_200);
 	PrintTextAbovePrivate(chest,"*Unlocked!*",me);
   else
@@ -69,7 +69,7 @@
 	else
 	  diff := diff -10;
 	endif
-	if (!CheckSkill(me,SKILLID_LOCKPICKING,diff,0) )
+	if ( !SkillCheck(me, LOCKPICKING, diff) > 0 )
 	  PlaySoundEffect(chest,0xef);
 	  SendSysMessage(me,"Your pick breaks!");
 	  SubtractAmount(lockpick,1);
@@ -94,7 +94,7 @@
   PlaySoundEffect(chest,SFX_242);
   sleep(2);
   var diff := (lvl * 10)+10;
-  if ( CheckSkill(me,SKILLID_LOCKPICKING,diff,0) )
+  if ( SkillCheck(me, LOCKPICKING, diff) > 0 )
 	PlaySoundEffect(chest,SFX_200);
 	PrintTextAbovePrivate(chest,"*Unlocked!*",me);
   else
@@ -104,7 +104,7 @@
 	else
 	  diff := diff -10;
 	endif
-	if (!CheckSkill(me,SKILLID_LOCKPICKING,diff,0) )
+	if ( !SkillCheck(me, LOCKPICKING,diff) > 0 )
 	  PlaySoundEffect(chest,0xef);
 	  SendSysMessage(me,"Your pick breaks!");
 	  SubtractAmount(lockpick,1);
@@ -143,7 +143,7 @@
   PlaySoundEffect(chest,SFX_242);
   sleepms(1500);
   var diff := (lvl+10);
-  if ( CheckSkill(me,SKILLID_LOCKPICKING,diff,(diff*2)) )
+  if ( SkillCheck(me, LOCKPICKING, diff) > 0 )
 	PlaySoundEffect(chest,SFX_200);
     chest.locked := 0;
   else

Modified: trunk/096/pkg/skills/magery/agility.src
===================================================================
--- trunk/096/pkg/skills/magery/agility.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/agility.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -14,7 +14,7 @@
     SendSysMessage(caster,"Another existing effect negates your spell!");
     return;
   endif
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var magery := AP_GetSkill(caster, MAGERY);
   var modAmount := GetModAmount( magery );
   var duration := GetModDuration( magery );
   DoTempMod(castOn, "dex", modAmount, duration);

Modified: trunk/096/pkg/skills/magery/archCure.src
===================================================================
--- trunk/096/pkg/skills/magery/archCure.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/archCure.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -13,8 +13,8 @@
   var castOn := parms.castOn;
   var npccfg := ReadConfigFile("::npcdesc");
   PlaySoundEffect(caster, SFX_SPELL_ARCH_CURE);
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
-  var potency := CInt(GetEffectiveSkill( caster, SKILLID_MAGERY ) /33)+1;
+  var magery := AP_GetSkill(caster, MAGERY);
+  var potency := CInt(AP_GetSkill( caster, MAGERY ) /33)+1;
   foreach castOn in ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, CInt(magery/15), caster.realm );
     if((CheckLineOfSight(castOn, caster)) and (castOn.cmdlevel < 2))
 	  PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 10,10);

Modified: trunk/096/pkg/skills/magery/archProt.src
===================================================================
--- trunk/096/pkg/skills/magery/archProt.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/archProt.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -11,7 +11,7 @@
 	var caster := parms.caster;
 	var castOn := parms.castOn;
 	PlaySoundEffect(caster, SFX_SPELL_PROTECTION);
-	var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+	var magery := AP_GetSkill(caster, MAGERY);
 	var modAmount := CInt(RandomInt(6) + 5);
 	var duration := GetModDuration( magery );
 	foreach castOn in ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, CInt(magery/15), caster.realm );

Modified: trunk/096/pkg/skills/magery/bladeSpirit.src
===================================================================
--- trunk/096/pkg/skills/magery/bladeSpirit.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/bladeSpirit.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -15,9 +15,9 @@
   SetObjProperty(thecritter, "summoned", 1);
   SetObjProperty(thecritter, "master", caster.serial);
   Detach();
-  sleep( (GetEffectiveSkill( caster, SKILLID_MAGERY ) ) );
+  sleep( (AP_GetSkill( caster, MAGERY ) ) );
   PlaySoundEffect( thecritter, SFX_SPELL_MANA_VAMPIRE );
   PlayStationaryEffect( thecritter.x, thecritter.y, thecritter.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
   MoveCharacterToLocation(thecritter,0,0,0,MOVECHAR_FORCELOCATION);
-  ApplyRawDamage(thecritter, GetHp(thecritter) + 3);
+  ApplyRawDamage(thecritter, AP_GetVital(thecritter, "Hits") + 3);
 endprogram

Modified: trunk/096/pkg/skills/magery/bless.src
===================================================================
--- trunk/096/pkg/skills/magery/bless.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/bless.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -13,7 +13,7 @@
   var castOn := parms.castOn;
   PlaySoundEffect(castOn, SFX_SPELL_BLESS);
   PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 10,10);
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var magery := AP_GetSkill(caster, MAGERY);
   var modAmount := GetModAmount(magery);
   var duration := GetModDuration(magery);
   if(CanMod(castOn, "str"))

Modified: trunk/096/pkg/skills/magery/clumsy.src
===================================================================
--- trunk/096/pkg/skills/magery/clumsy.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/clumsy.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -27,7 +27,7 @@
 	SendSysMessage(caster,"Already under the influence!");
 	return;
   endif
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var magery := AP_GetSkill(caster, MAGERY);
   var modAmount := Resisted(circle,caster,castOn,(GetModAmount( magery )));
   var duration := GetModDuration( magery );
   DoTempMod(castOn, "dex", 0 - modAmount, duration);

Modified: trunk/096/pkg/skills/magery/cunning.src
===================================================================
--- trunk/096/pkg/skills/magery/cunning.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/cunning.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -19,7 +19,7 @@
 		SendSysMessage(caster,"Already under the influence!");
 		return;
 	endif
-	var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+	var magery := AP_GetSkill(caster, MAGERY);
 	var modAmount := GetModAmount( magery );
 	var duration := GetModDuration( magery );
 	DoTempMod(castOn, "int", modAmount, duration);

Modified: trunk/096/pkg/skills/magery/cure.src
===================================================================
--- trunk/096/pkg/skills/magery/cure.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/cure.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -15,7 +15,7 @@
   var npccfg := ReadConfigFile("::npcdesc");
   PlaySoundEffect(caster, SFX_SPELL_CURE);
   PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 10,10);
-  var potency := CInt(GetEffectiveSkill(caster, SKILLID_MAGERY) / 33) +1;
+  var potency := CInt(AP_GetSkill(caster, MAGERY) / 33) +1;
   if(castOn.isA(POLCLASS_NPC))
     var element := npccfg[castOn.npctemplate].elemental;
     if(element == "poison")

Modified: trunk/096/pkg/skills/magery/curse.src
===================================================================
--- trunk/096/pkg/skills/magery/curse.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/curse.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -18,7 +18,7 @@
 
   PlaySoundEffect(castOn, SFX_SPELL_CURSE);
   PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 10,10);
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var magery := AP_GetSkill(caster, MAGERY);
   var modAmount := Resisted(circle,caster,castOn,GetModAmount( magery ));
   var duration := GetModDuration( magery );
 	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "curse" });

Modified: trunk/096/pkg/skills/magery/dispelField.src
===================================================================
--- trunk/096/pkg/skills/magery/dispelField.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/dispelField.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -9,7 +9,7 @@
 program dispelField( parms )
   var caster := parms.caster;
   var castOn := parms.castOn;
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var magery := AP_GetSkill(caster, MAGERY);
   var therange := CInt(magery / 15 );
   var items := ListItemsNearLocation(castOn.x, castOn.y, castOn.z, therange, caster.realm);
   PlaySoundEffect( caster, SFX_SPELL_DISPEL );

Modified: trunk/096/pkg/skills/magery/feeblemind.src
===================================================================
--- trunk/096/pkg/skills/magery/feeblemind.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/feeblemind.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -28,7 +28,7 @@
 	SendSysMessage(caster,"Already under the influence!");
 	return;
   endif
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var magery := AP_GetSkill(caster, MAGERY);
   var modAmount := Resisted(circle,caster,castOn,(GetModAmount( magery )));
   var duration := GetModDuration( magery );
   DoTempMod(castOn, "int", 0 - modAmount, duration);

Modified: trunk/096/pkg/skills/magery/gHeal.src
===================================================================
--- trunk/096/pkg/skills/magery/gHeal.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/gHeal.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -12,7 +12,7 @@
 	var caster := parms.caster;
 	var castOn := parms.castOn;
 	var healed := RandomDiceRoll("1d3");
-	healed := CInt(GetEffectiveSkill(caster, SKILLID_MAGERY)/2) + healed;
+	healed := CInt(AP_GetSkill(caster, MAGERY)/2) + healed;
 	SendSysMessage(caster, "You healed " + healed + " damage.");
 	if (castOn.isA(POLCLASS_NPC))
 		healed := healed * 2;

Modified: trunk/096/pkg/skills/magery/heal.src
===================================================================
--- trunk/096/pkg/skills/magery/heal.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/heal.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -11,7 +11,7 @@
 program spell_heal(parms)
   var caster := parms.caster;
   var castOn := parms.castOn;
-  var healed := CInt(GetEffectiveSkill(caster, SKILLID_MAGERY) / 20) + 5;
+  var healed := CInt(AP_GetSkill(caster, MAGERY) / 20) + 5;
   if(healed > 20)
 	healed := 20;
   endif

Modified: trunk/096/pkg/skills/magery/invisibility.src
===================================================================
--- trunk/096/pkg/skills/magery/invisibility.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/invisibility.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -13,7 +13,7 @@
 	PlaySoundEffect(castOn, SFX_SPELL_INVISIBILITY);
 	castOn.hidden := 1;
 	Detach();
-	sleep(CInt(GetEffectiveSkill(caster, SKILLID_MAGERY)));
+	sleep(CInt(AP_GetSkill(caster, MAGERY)));
 	castOn.hidden := 0;
 
 	return;

Modified: trunk/096/pkg/skills/magery/magicLock.src
===================================================================
--- trunk/096/pkg/skills/magery/magicLock.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/magicLock.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -27,7 +27,7 @@
   if(((castOn.graphic<=0x9ab) &&(castOn.graphic>=0x9a8)) ||((castOn.graphic<=0xe43) &&(castOn.graphic>=0xe3c)) ||((castOn.graphic<=0xe80) &&(castOn.graphic>=0xe7c)) ||(checkfordoors(castOn)))
     PlaySoundEffect(caster, SFX_SPELL_MAGIC_LOCK);
     PrintTextAbovePrivate(castOn, "*Locked!*", caster);
-    var magery := CInt(GetEffectiveSkill(caster, SKILLID_MAGERY) / 4);
+    var magery := CInt(AP_GetSkill(caster, MAGERY) / 4);
     SetObjProperty(castOn, "MLockPickDiff", magery);
     castOn.locked := 1;
   else

Modified: trunk/096/pkg/skills/magery/magicTrap.src
===================================================================
--- trunk/096/pkg/skills/magery/magicTrap.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/magicTrap.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -13,7 +13,7 @@
 	var castOn := parms.castOn;
 
 	if ((castOn.isa(POLCLASS_DOOR)) || (castOn.objtype == 0xe79) || ((castOn.graphic<=0x9ab) &&(castOn.graphic>=0x9a8)) ||((castOn.graphic<=0xe43) &&(castOn.graphic>=0xe3c)) ||((castOn.graphic<=0xe80) &&(castOn.graphic>=0xe7c)))
-		var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+		var magery := AP_GetSkill(caster, MAGERY);
 		var trapstr := CInt(magery/5);
 		if (findcity(castOn) != "no city")
 			caster.setCriminal(1);

Modified: trunk/096/pkg/skills/magery/massCurse.src
===================================================================
--- trunk/096/pkg/skills/magery/massCurse.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/massCurse.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -18,7 +18,7 @@
   var circle := spellcfg[spellid].circle;
 
   PlaySoundEffect(caster, SFX_SPELL_MASS_CURSE);
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var magery := AP_GetSkill(caster, MAGERY);
   var modAmount := GetModAmount( magery );
   var duration := GetModDuration( magery );
   Detach();

Modified: trunk/096/pkg/skills/magery/massDispel.src
===================================================================
--- trunk/096/pkg/skills/magery/massDispel.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/massDispel.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -17,7 +17,7 @@
   var circle := spellcfg[spellid].circle;
 
   var npccfg := ReadConfigFile("::npcdesc");
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var magery := AP_GetSkill(caster, MAGERY);
   var range := CInt(magery / 20);
   var targets := ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, range, caster.realm );
   PlaySoundEffect( caster, 0x202 );

Modified: trunk/096/pkg/skills/magery/nightSight.src
===================================================================
--- trunk/096/pkg/skills/magery/nightSight.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/nightSight.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -15,7 +15,7 @@
 	var castOn := parms.castOn;
 
 	PlaySoundEffect(castOn, SFX_SPELL_NIGHT_SIGHT );
-	var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+	var magery := AP_GetSkill(caster, MAGERY);
 	castOn.setlightlevel(0, magery * 60);
 	PlayObjectCenteredEffect(castOn, FX_BLESS_EFFECT, 10,10);
 

Modified: trunk/096/pkg/skills/magery/paralyze.src
===================================================================
--- trunk/096/pkg/skills/magery/paralyze.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/paralyze.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -17,7 +17,7 @@
 	if (spell_reflect(castOn))
 		castOn := caster;
 	endif
-	var amt := 10 + RandomInt(CInt(GetEffectiveSkill(caster, SKILLID_MAGERY)/5));
+	var amt := 10 + RandomInt(CInt(AP_GetSkill(caster, MAGERY)/5));
 	var duration := ParaResist(2, caster, castOn, amt);
 	PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_CURSE_EFFECT, 10, 0xa, 0, caster.realm );
 	PlaySoundEffect( castOn, SFX_SPELL_PARALYZE );
@@ -28,7 +28,7 @@
 
 
 function ParaResist(circle, caster, castOn, amt)
-  var magery := CInt(GetEffectiveSkill(caster, SKILLID_MAGERY));
+  var magery := CInt(AP_GetSkill(caster, MAGERY));
   var evalint := CInt(GetEffectiveSkill(caster, SKILLID_EVALINT));
   var resist := CInt(GetEffectiveSkill(castOn, SKILLID_MAGICRESISTANCE));
   var chk1 := (resist / 5);

Modified: trunk/096/pkg/skills/magery/poison.src
===================================================================
--- trunk/096/pkg/skills/magery/poison.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/poison.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -24,7 +24,7 @@
   PlaySoundEffect(castOn, 0x206);
   PlayObjectCenteredEffect(castOn, FX_CURSE_EFFECT, 0x0a,0x1e);
   var pLevel :=  0;
-  var skil := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var skil := AP_GetSkill(caster, MAGERY);
   if(skil <= 50)
     pLevel := 1;
   elseif(skil <= 90)
@@ -73,7 +73,7 @@
 endprogram
 
 function PoisonResist(caster, castOn, amt)
-  var diff := Cint(GetEffectiveSkill(caster, SKILLID_MAGERY) + Cint(GetEffectiveSkill(caster, SKILLID_EVALINT) / 10));
+  var diff := Cint(AP_GetSkill(caster, MAGERY) + Cint(GetEffectiveSkill(caster, SKILLID_EVALINT) / 10));
   if(CheckSkill(castOn, SKILLID_MAGICRESISTANCE, diff, (diff * 2)))
     SendSysMessage(castOn, "You feel yourself resisting magical energy!");
     PlaySoundEffect(castOn, SFX_SPELL_WEAKEN);

Modified: trunk/096/pkg/skills/magery/polymorph.src
===================================================================
--- trunk/096/pkg/skills/magery/polymorph.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/polymorph.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -5,7 +5,7 @@
 
 program spell_polymorph( parms )
   var caster := parms.caster;
-  var magery     := CInt(GetEffectiveSkill(caster, SKILLID_MAGERY));
+  var magery     := CInt(AP_GetSkill(caster, MAGERY));
   var meditation := CInt(GetEffectiveSkill(caster, SKILLID_MEDITATION));
   var evalint    := CInt(GetEffectiveSkill(caster, SKILLID_EVALINT));
   var critgroup;

Modified: trunk/096/pkg/skills/magery/protection.src
===================================================================
--- trunk/096/pkg/skills/magery/protection.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/protection.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -16,7 +16,7 @@
 	SendSysMessage(caster,"Already under the influence!");
 	return;
   endif
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var magery := AP_GetSkill(caster, MAGERY);
   var modAmount := (GetModAmount(magery) * 2);
   var duration := GetModDuration(magery);
   var itmcfg := ReadConfigFile(":*:itemdesc");

Modified: trunk/096/pkg/skills/magery/reactiveArmor.src
===================================================================
--- trunk/096/pkg/skills/magery/reactiveArmor.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/reactiveArmor.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -15,7 +15,7 @@
 	SendSysMessage(caster,"Already under the influence!");
 	return;
   endif
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var magery := AP_GetSkill(caster, MAGERY);
   var modAmount := magery / 10;
   var duration := CInt(RandomInt(10) + (magery / 2));
   SetObjProperty(castOn, "ReactiveArmor", modAmount);

Modified: trunk/096/pkg/skills/magery/strength.src
===================================================================
--- trunk/096/pkg/skills/magery/strength.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/strength.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -17,7 +17,7 @@
 		SendSysMessage(caster,"Already under the influence!");
 		return;
 	endif
-	var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+	var magery := AP_GetSkill(caster, MAGERY);
 	var mod_amount := GetModAmount( magery );
 	var duration := GetModDuration( magery );
 	DoTempMod(castOn, "str", mod_amount, duration);

Modified: trunk/096/pkg/skills/magery/summon.inc
===================================================================
--- trunk/096/pkg/skills/magery/summon.inc	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/summon.inc	2005-11-02 18:46:59 UTC (rev 841)
@@ -9,7 +9,7 @@
 
 function DoSummon( caster, circle, npctemplate, cast_loc )
   var thecritter;
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var magery := AP_GetSkill(caster, MAGERY);
   var duration := 20 + (magery * 2);
   var parms := {};
   parms .+ script := "tamed";

Modified: trunk/096/pkg/skills/magery/summonCreature.src
===================================================================
--- trunk/096/pkg/skills/magery/summonCreature.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/summonCreature.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -13,7 +13,7 @@
   
   var thecreature;
   var critgroup;
-  var basemagery := CInt(GetEffectiveSkill(caster, SKILLID_MAGERY));
+  var basemagery := CInt(AP_GetSkill(caster, MAGERY));
   if (basemagery < 70)
 	critgroup := RandomInt(1);
   elseif (basemagery < 80)

Modified: trunk/096/pkg/skills/magery/telekinesis.src
===================================================================
--- trunk/096/pkg/skills/magery/telekinesis.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/telekinesis.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -23,7 +23,7 @@
     endif
     PlaySoundEffect(castOn, 0x144);
     PlayObjectCenteredEffect(castOn, 0x37b9,0x03, 0x0a);
-    var dmg := RandomInt(GetEffectiveSkill(caster, SKILLID_MAGERY) / 10);
+    var dmg := RandomInt(AP_GetSkill(caster, MAGERY) / 10);
     ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
     if((castOn.graphic  == 0x190) or (castOn.graphic == 0x191))
       PerformAction(castOn, 20);

Modified: trunk/096/pkg/skills/magery/weaken.src
===================================================================
--- trunk/096/pkg/skills/magery/weaken.src	2005-11-02 18:46:32 UTC (rev 840)
+++ trunk/096/pkg/skills/magery/weaken.src	2005-11-02 18:46:59 UTC (rev 841)
@@ -26,7 +26,7 @@
   if(!CanMod(castOn, "str"))
 	return;
   endif
-  var magery := GetEffectiveSkill(caster, SKILLID_MAGERY);
+  var magery := AP_GetSkill(caster, MAGERY);
   var modAmount := Resisted(circle,caster,castOn,(GetModAmount( magery )));
   var duration := GetModDuration( magery );
   DoTempMod(castOn, "str", 0 - modAmount, duration);



From austin at berlios.de  Wed Nov  2 20:46:24 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 20:46:24 +0100
Subject: [Poldistro-svn] r842 - in trunk/096: pkg/skills/magery scripts/include
Message-ID: <200511021946.jA2JkODV001211@sheep.berlios.de>

Author: austin
Date: 2005-11-02 20:46:22 +0100 (Wed, 02 Nov 2005)
New Revision: 842

Removed:
   trunk/096/pkg/skills/magery/poisonDamage.src
Modified:
   trunk/096/pkg/skills/magery/dispel.src
   trunk/096/pkg/skills/magery/energyField.src
   trunk/096/pkg/skills/magery/explosion.src
   trunk/096/pkg/skills/magery/fireField.src
   trunk/096/pkg/skills/magery/fireball.src
   trunk/096/pkg/skills/magery/harm.src
   trunk/096/pkg/skills/magery/incognito.src
   trunk/096/pkg/skills/magery/magicArrow.src
   trunk/096/pkg/skills/magery/manaDrain.src
   trunk/096/pkg/skills/magery/manaVamp.src
   trunk/096/pkg/skills/magery/massDispel.src
   trunk/096/pkg/skills/magery/meteorSwarm.src
   trunk/096/pkg/skills/magery/mindBlast.src
   trunk/096/pkg/skills/magery/paraField.src
   trunk/096/pkg/skills/magery/paralyze.src
   trunk/096/pkg/skills/magery/poison.src
   trunk/096/pkg/skills/magery/poisonField.src
   trunk/096/pkg/skills/magery/polymorph.src
   trunk/096/pkg/skills/magery/reflect.inc
   trunk/096/pkg/skills/magery/resurrect.src
   trunk/096/pkg/skills/magery/reveal.src
   trunk/096/pkg/skills/magery/summon.inc
   trunk/096/pkg/skills/magery/vortex.src
   trunk/096/pkg/skills/magery/wallOfStone.src
   trunk/096/scripts/include/magic.inc
Log:
Attribute updates

Modified: trunk/096/pkg/skills/magery/dispel.src
===================================================================
--- trunk/096/pkg/skills/magery/dispel.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/dispel.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -22,10 +22,10 @@
     PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_HEAL_EFFECT, 0xa, 0xa,0 , caster.realm );
     var master := SystemFindObjectBySerial(CInt(GetObjProperty(castOn, "master")));
     if(master)
-      var resist := GetEffectiveSkill(master, SKILLID_MAGICRESISTANCE);
+      var resist := AP_GetSkill(master, RESISTING_SPELLS);
       if((RandomInt(99) + 1) < resist)
         MoveCharacterToLocation(castOn,0,0,0,MOVECHAR_FORCELOCATION);
-        ApplyRawDamage(castOn, GetMaxHp(castOn) + 3);
+        ApplyRawDamage(castOn, AP_GetVitalMaximumValue(caston, HITS) + 3);
       endif
       send_attack(caster, castOn, 41);
     endif

Modified: trunk/096/pkg/skills/magery/energyField.src
===================================================================
--- trunk/096/pkg/skills/magery/energyField.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/energyField.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -20,7 +20,7 @@
   endcase
   PlaySoundEffect(caster,0x20c);
   Detach();
-  var duration := 20 + ( CInt(GetEffectiveSkill( caster, SKILLID_MAGERY ) ) / 3 );
+  var duration := 20 + ( CInt(AP_GetSkill(caster, MAGERY) ) / 3 );
   sleep(duration);
   foreach fieldpart in fields
     DestroyItem(fieldpart);

Modified: trunk/096/pkg/skills/magery/explosion.src
===================================================================
--- trunk/096/pkg/skills/magery/explosion.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/explosion.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -27,7 +27,7 @@
   send_attack(castOn,caster, 43);
   PlaySoundEffect( castOn, SFX_SPELL_EXPLOSION );
   PlayStationaryEffect( castOn.x,castOn.y,castOn.z, FX_EXPLODE_3, 7, 0x10, 0 , caster.realm );
-  if(GetHp(castOn) >= 1)
+  if(AP_GetVital(castOn, HITS) >= 1)
     if(castOn.npctemplate)
       dmg := dmg * 2;
     endif

Modified: trunk/096/pkg/skills/magery/fireField.src
===================================================================
--- trunk/096/pkg/skills/magery/fireField.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/fireField.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -17,7 +17,7 @@
 	endcase
 	PlaySoundEffect(caster, 0x20d);
 	Detach();
-	var duration := 20 + ( CInt(GetEffectiveSkill( caster, SKILLID_MAGERY ) ) / 3 );
+	var duration := 20 + ( CInt(AP_GetSkill(caster, MAGERY) ) / 3 );
 	sleep(duration);
 	foreach fieldpart in fields
 		DestroyItem(fieldpart);

Modified: trunk/096/pkg/skills/magery/fireball.src
===================================================================
--- trunk/096/pkg/skills/magery/fireball.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/fireball.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -24,7 +24,7 @@
     PlaySoundEffect(castOn, 0x15f);
     castOn := caster;
   endif
-  if (GetHp(castOn) >= 1)
+  if (AP_GetVital(castOn, HITS) >= 1)
     if(castOn.npctemplate)
       dmg := dmg * 2;
     endif

Modified: trunk/096/pkg/skills/magery/harm.src
===================================================================
--- trunk/096/pkg/skills/magery/harm.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/harm.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -25,7 +25,7 @@
 	endif
 	PlaySoundEffect(castOn, SFX_SPELL_HARM);
 	PlayObjectCenteredEffect( castOn, FX_GLOW_SPIKE, 0x0a,0x1e);
-	if(GetHp(castOn) >= 1)
+	if(AP_GetVital(castOn, HITS) >= 1)
 		if(castOn.npctemplate)
 			dmg := dmg * 2;
 		endif

Modified: trunk/096/pkg/skills/magery/incognito.src
===================================================================
--- trunk/096/pkg/skills/magery/incognito.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/incognito.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -16,7 +16,7 @@
   PlaySoundEffect(caster, 0x1e1);
   Detach();
   set_critical(1);
-  sleep( 60 * CInt(GetEffectiveSkill( caster, SKILLID_MAGERY )/10 ) );
+  sleep( 60 * CInt(AP_GetSkill(caster, MAGERY)/10 ) );
   SetName( caster, GetObjProperty( caster, "realname" ) );
   EraseObjProperty( caster, "realname" );
 endprogram

Modified: trunk/096/pkg/skills/magery/magicArrow.src
===================================================================
--- trunk/096/pkg/skills/magery/magicArrow.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/magicArrow.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -23,7 +23,7 @@
 		PlaySoundEffect( castOn, SFX_SPELL_MAGIC_ARROW );
 		ApplyRawDamage( caster, Resisted(circle,caster,castOn,dmg) );
 	else
-		if (GetHp(castOn) >= 1)
+		if (AP_GetVital(castOn, HITS) >= 1)
 			SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "magic arrow" });
 			if (castOn.isA(POLCLASS_NPC))
 				dmg := dmg * 2;

Modified: trunk/096/pkg/skills/magery/manaDrain.src
===================================================================
--- trunk/096/pkg/skills/magery/manaDrain.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/manaDrain.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -26,10 +26,10 @@
 	if (diff)
 		PlaySoundEffect( caster, SFX_SPELL_MANA_DRAIN );
 		PlayObjectCenteredEffect( castOn, FX_HEAL_EFFECT, 7,0x10 );
-		if (diff > GetMana(castOn))
-			SetMana(castOn, 0);
+		if (diff > AP_GetVital(castOn, MANA))
+			AP_SetVital(castOn, MANA, 0);
 		else
-			SetMana(castOn, GetMana(castOn) - diff);
+			AP_SetVital(castOn, MANA, AP_GetVital(castOn, MANA) - diff);
 		endif
 	endif
 

Modified: trunk/096/pkg/skills/magery/manaVamp.src
===================================================================
--- trunk/096/pkg/skills/magery/manaVamp.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/manaVamp.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -27,16 +27,16 @@
     PlaySoundEffect(caster, SFX_SPELL_MANA_VAMPIRE);
     PlayObjectCenteredEffect(castOn, FX_GLOW, 7,0x10);
     var gain := 0;
-	if(diff > GetMana(castOn))
-	  gain := GetMana(castOn);
-	  SetMana(castOn, 0);
+	if(diff > AP_GetVital(castOn, MANA))
+	  gain := AP_GetVital(castOn, MANA);
+	  AP_SetVital(castOn, MANA, 0);
 	else
 	  gain := diff;
-	  SetMana(castOn, GetMana(castOn) - diff);
+	  AP_SetVital(castOn, MANA, AP_GetVital(castOn, MANA) - diff);
 	endif
-	SetMana(caster, GetMana(caster) + gain);
-	if(GetMana(caster) > GetMaxMana(caster))
-	  SetMana(caster, GetMaxMana(caster));
+	AP_SetVital(caster, MANA, AP_GetVital(caster, MANA) + gain);
+	if(AP_GetVital(caster, MANA) > AP_GetVitalMaximumValue(caster, MANA))
+	  AP_SetVital(caster, MANA, AP_GetVitalMaximumValue(caster, MANA));
 	endif
   endif
 

Modified: trunk/096/pkg/skills/magery/massDispel.src
===================================================================
--- trunk/096/pkg/skills/magery/massDispel.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/massDispel.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -32,10 +32,10 @@
       PlayStationaryEffect( mobile.x, mobile.y, mobile.z, FX_HEAL_EFFECT, 0xa, 0xa,0 , caster.realm );
       var master := SystemFindObjectBySerial(CInt(GetObjProperty(mobile, "master")));
       if(master)
-        var resist := GetEffectiveSkill(master, SKILLID_MAGICRESISTANCE);
+        var resist := AP_GetSkill(master, RESISTING_SPELLS);
         if((RandomInt(99) + 1) < resist)
           MoveCharacterToLocation(mobile,0,0,0,MOVECHAR_FORCELOCATION);
-          ApplyRawDamage(mobile, GetMaxHp(mobile) + 3);
+          ApplyRawDamage(mobile, AP_GetVitalMaximumValue(mobile, HITS) + 3);
         endif
         send_attack(caster, mobile, 41);
     endif

Modified: trunk/096/pkg/skills/magery/meteorSwarm.src
===================================================================
--- trunk/096/pkg/skills/magery/meteorSwarm.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/meteorSwarm.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -30,7 +30,7 @@
     endif
 	dmg := RandomDiceRoll("6d8");
 	send_attack(mobile,caster, 55);
-    if(GetHp(mobile) > 1)
+    if(AP_GetVital(mobile, HITS) > 1)
       if(castOn.npctemplate)
         dmg := dmg * 2;
       endif

Modified: trunk/096/pkg/skills/magery/mindBlast.src
===================================================================
--- trunk/096/pkg/skills/magery/mindBlast.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/mindBlast.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -15,8 +15,8 @@
   var spellcfg := ReadConfigFile(":*:spells");
   var circle := spellcfg[spellid].circle;
 
-  var myInt := CInt(GetIntelligence(caster));
-  var hisInt := CInt(GetIntelligence(castOn));
+  var myInt := CInt(AP_GetStat(caster, INTELLIGENCE));
+  var hisInt := CInt(AP_GetStat(castOn, INTELLIGENCE));
   SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "mind blast" });
   var modif := myInt - hisInt;
   if(hisInt > myInt)

Modified: trunk/096/pkg/skills/magery/paraField.src
===================================================================
--- trunk/096/pkg/skills/magery/paraField.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/paraField.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -20,7 +20,7 @@
 		"EW" : fields:= CreateEastWestField(caster, UOBJ_PARAFIELD_EW, x, y, z, 5);
 	endcase
 	Detach();
-	var duration := CInt(GetEffectiveSkill( caster, SKILLID_MAGERY ) )/2;
+	var duration := CInt(AP_GetSkill(caster, MAGERY) )/2;
 	if (duration < 20)
 		duration := 20;
 	endif

Modified: trunk/096/pkg/skills/magery/paralyze.src
===================================================================
--- trunk/096/pkg/skills/magery/paralyze.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/paralyze.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -29,8 +29,8 @@
 
 function ParaResist(circle, caster, castOn, amt)
   var magery := CInt(AP_GetSkill(caster, MAGERY));
-  var evalint := CInt(GetEffectiveSkill(caster, SKILLID_EVALINT));
-  var resist := CInt(GetEffectiveSkill(castOn, SKILLID_MAGICRESISTANCE));
+  var evalint := CInt(AP_GetSkill(caster, EVALUATING_INTELLIGENCE));
+  var resist := CInt(AP_GetSkill(castOn, RESISTING_SPELLS));
   var chk1 := (resist / 5);
   var chk2 := resist - (((magery - 20) / 5) + (circle * 5));
   if(chk1 < 1)
@@ -45,7 +45,7 @@
   else
     diff := chk2;
   endif
-  var points := getresistpoints(circle, castOn, SKILLID_MAGICRESISTANCE);
+  //var points := getresistpoints(circle, castOn, RESISTING_SPELLS);
   if(castOn.dead)
     return 0;
   endif
@@ -53,7 +53,7 @@
 	SendSysMessage(castOn, "You feel yourself resisting magical energy!");
 	PlaySoundEffect(castOn, SFX_SPELL_WEAKEN);
 	PlayObjectCenteredEffect(castOn, FX_CURSE_EFFECT, 5,5);
-	AwardRawSkillPoints(castOn, SKILLID_MAGICRESISTANCE, points);
+	//AwardRawSkillPoints(castOn, RESISTING_SPELLS, points);
 	amt := 0;
 	return amt;
   endif

Modified: trunk/096/pkg/skills/magery/poison.src
===================================================================
--- trunk/096/pkg/skills/magery/poison.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/poison.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -6,6 +6,7 @@
 include "include/tileEffects";
 include ":attributes:attributes";
 include ":magery:reflect";
+include ":timedscripts:timedScripts";
 
 const EVID_DISCHARGE := 0x123457;
 
@@ -60,8 +61,9 @@
     if(newamt > 0)
       SendSysMessage(castOn, "You have been poisoned by " + caster.name +"!");
       Detach();
-      passparms := {castOn, caster, "poison spell", newamt};
-      start_script(":magery:poisonDamage", passparms);
+      TS_StartTimer(castOn, "defaultPoison", 20, pLevel);
+      //passparms := {castOn, caster, "poison spell", newamt};
+      //start_script(":magery:poisonDamage", passparms);
       SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "poison spell" });
     else
       SendSysMessage(castOn, "You resist the spell completely.");
@@ -73,8 +75,8 @@
 endprogram
 
 function PoisonResist(caster, castOn, amt)
-  var diff := Cint(AP_GetSkill(caster, MAGERY) + Cint(GetEffectiveSkill(caster, SKILLID_EVALINT) / 10));
-  if(CheckSkill(castOn, SKILLID_MAGICRESISTANCE, diff, (diff * 2)))
+  var diff := Cint(AP_GetSkill(caster, MAGERY) + Cint(AP_GetSkill(caster, EVALUATING_INTELLIGENCE) / 10));
+  if( SkillCheck(castOn, RESISTING_SPELLS, diff) > 0 )
     SendSysMessage(castOn, "You feel yourself resisting magical energy!");
     PlaySoundEffect(castOn, SFX_SPELL_WEAKEN);
     PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 5,5);

Deleted: trunk/096/pkg/skills/magery/poisonDamage.src
===================================================================
--- trunk/096/pkg/skills/magery/poisonDamage.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/poisonDamage.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -1,34 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/client";
-include ":attributes:attributes";
-include ":timedscripts:timedScripts";
-include "include/spellRestrictions";
-
-
-program spell_poisonDamage(passparms)
-	var who      := passparms[1];
-	var attacker := passparms[2];
-	var weapon   := passparms[3];
-	var level    := passparms[4];
-	var pfield   := Cint(passparms[5]);
-	weapon := weapon;
-	if (who.npctemplate)
-		//var npccfg := ReadConfigFile("::npcdesc");
-		if (who.npctemplate == "bladespirit")
- 			return;
-		endif
-	elseif (who.cmdlevel > 1)
-		return;
-	endif
-	TS_StartTimer(who, "defaultPoison", 120, level, attacker);
-	if (pfield == 1)
-		PrintTextAbovePrivate(who, "You choke on the noxious fumes!", who);
-		var dmg := Resisted(5, attacker, who, CInt(GetAttribute(attacker, "magery") / 25));
-		ApplyRawDamage(who, dmg);
-	endif
-
-	return;
-endprogram

Modified: trunk/096/pkg/skills/magery/poisonField.src
===================================================================
--- trunk/096/pkg/skills/magery/poisonField.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/poisonField.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -19,7 +19,7 @@
 	"EW" : fields:= CreateEastWestField(caster, UOBJ_POISONFIELD_EW, x, y, z, 5);
   endcase
   Detach();
-  var duration := 20 + ( CInt(GetEffectiveSkill( caster, SKILLID_MAGERY ) ) / 3 );
+  var duration := 20 + ( CInt(AP_GetSkill(caster, MAGERY) ) / 3 );
   sleep(duration);
   foreach fieldpart in fields
     DestroyItem(fieldpart);

Modified: trunk/096/pkg/skills/magery/polymorph.src
===================================================================
--- trunk/096/pkg/skills/magery/polymorph.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/polymorph.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -6,8 +6,8 @@
 program spell_polymorph( parms )
   var caster := parms.caster;
   var magery     := CInt(AP_GetSkill(caster, MAGERY));
-  var meditation := CInt(GetEffectiveSkill(caster, SKILLID_MEDITATION));
-  var evalint    := CInt(GetEffectiveSkill(caster, SKILLID_EVALINT));
+  var meditation := CInt(AP_GetSkill(caster, MEDITATION));
+  var evalint    := CInt(AP_GetSkill(caster, EVALUATING_INTELLIGENCE));
   var critgroup;
   var thecreature;
   if (magery < 70)

Modified: trunk/096/pkg/skills/magery/reflect.inc
===================================================================
--- trunk/096/pkg/skills/magery/reflect.inc	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/reflect.inc	2005-11-02 19:46:22 UTC (rev 842)
@@ -1,3 +1,7 @@
+use uo;
+use os;
+
+include "include/eventID";
 include "include/sound";
 include "include/tileEffects";
 

Modified: trunk/096/pkg/skills/magery/resurrect.src
===================================================================
--- trunk/096/pkg/skills/magery/resurrect.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/resurrect.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -37,11 +37,11 @@
       ev.type := EVID_ENGAGED;
       SendEvent(castOn, ev);
       PlayObjectCenteredEffect(castOn, 0x37b9,0x03, 0x0a);
-      if(CheckSkill(castOn,SKILLID_MAGICRESISTANCE, 70, 800))
+      if( SkillCheck(castOn, RESISTING_SPELLS, 70) > 0 )
         var dmg := CalcSpellDamage(circle,caster) + (RandomInt(20));
         ApplyRawDamage(castOn, dmg);
       else
-        ApplyRawDamage(castOn, GetHp(castOn) +1);
+        ApplyRawDamage(castOn, AP_GetVital(castOn, HITS) +1);
       endif
     endif
   else

Modified: trunk/096/pkg/skills/magery/reveal.src
===================================================================
--- trunk/096/pkg/skills/magery/reveal.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/reveal.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -8,7 +8,7 @@
 
 program reveal(parms)
   var caster := parms.caster;
-  var range := ( GetEffectiveSkill( caster, SKILLID_MAGERY  )/10 ) - 5;
+  var range := ( AP_GetSkill( caster, MAGERY  )/10 ) - 5;
   if (range < 1)
 	range := 1;
   endif
@@ -33,8 +33,8 @@
 
 
 function Found(finder, hider)
-  var magic_skill := Resisted(6, finder, hider, GetEffectiveSkill( finder, SKILLID_MAGERY ));
-  var resist := (GetEffectiveSkill( finder, SKILLID_MAGICRESISTANCE)/1.5);
+  var magic_skill := Resisted(6, finder, hider, AP_GetSkill( finder, MAGERY ));
+  var resist := (AP_GetSkill( finder,RESISTING_SPELLS)/1.5);
   if ( magic_skill > resist )
 	return 1;
   else

Modified: trunk/096/pkg/skills/magery/summon.inc
===================================================================
--- trunk/096/pkg/skills/magery/summon.inc	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/summon.inc	2005-11-02 19:46:22 UTC (rev 842)
@@ -31,10 +31,11 @@
   SetObjProperty(thecritter, "happiness",100);
   SetObjProperty(thecritter, "summoned",1);
   RestartScript(thecritter);
-  SetBaseSkillBaseValue( thecritter, SKILLID_MAGICRESISTANCE,  magery * 10  );
+  //SetBaseSkillBaseValue( thecritter, SKILLID_MAGICRESISTANCE,  magery * 10  );
+  AP_SetTrueSkill(thecritter, RESISTING_SPELLS, magery*10);
   sleep(duration);
   PlaySoundEffect( thecritter, SFX_SPELL_MANA_VAMPIRE );
   PlayStationaryEffect( thecritter.x, thecritter.y, thecritter.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
   MoveCharacterToLocation(thecritter,0,0,0,MOVECHAR_FORCELOCATION);
-  ApplyRawDamage(thecritter, GetHp(thecritter) + 3);
+  ApplyRawDamage(thecritter, AP_GetVital(thecritter, HITS) + 3);
 endfunction

Modified: trunk/096/pkg/skills/magery/vortex.src
===================================================================
--- trunk/096/pkg/skills/magery/vortex.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/vortex.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -16,9 +16,9 @@
   SetObjProperty(thecritter, "summoned",1);
   SetObjProperty(thecritter, "master", caster.serial);
   Detach();
-  sleep( (GetEffectiveSkill( caster, SKILLID_MAGERY ) ) );
+  sleep( (AP_GetSkill(caster, MAGERY) ) );
   PlaySoundEffect( thecritter, SFX_SPELL_MANA_VAMPIRE );
   PlayStationaryEffect( thecritter.x, thecritter.y, thecritter.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
   MoveCharacterToLocation(thecritter,0,0,0,MOVECHAR_FORCELOCATION);
-  ApplyRawDamage(thecritter, GetHp(thecritter) + 3);
+  ApplyRawDamage(thecritter, AP_GetVital(thecritter, HITS) + 3);
 endprogram

Modified: trunk/096/pkg/skills/magery/wallOfStone.src
===================================================================
--- trunk/096/pkg/skills/magery/wallOfStone.src	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/pkg/skills/magery/wallOfStone.src	2005-11-02 19:46:22 UTC (rev 842)
@@ -20,7 +20,7 @@
 	"EW" : fields:= CreateEastWestField(caster, 0x80, x, y, z, 5);
   endcase
   Detach();
-  duration := CInt(GetEffectiveSkill( caster, SKILLID_MAGERY ) )/2;
+  duration := CInt(AP_GetSkill(caster, MAGERY) )/2;
   if (duration < 20)
     duration := 20;
   endif

Modified: trunk/096/scripts/include/magic.inc
===================================================================
--- trunk/096/scripts/include/magic.inc	2005-11-02 18:46:59 UTC (rev 841)
+++ trunk/096/scripts/include/magic.inc	2005-11-02 19:46:22 UTC (rev 842)
@@ -8,9 +8,9 @@
   // called by: most spells
   // returns: amount of damage not resisted?
 
-  var magery := CInt(GetEffectiveSkill(caster, SKILLID_MAGERY));
-  var evalint := CInt(GetEffectiveSkill(caster, SKILLID_EVALINT));
-  var resist := CInt(GetEffectiveSkill(cast_on, SKILLID_MAGICRESISTANCE));
+  var magery := CInt(AP_GetSkill(caster, MAGERY));
+  var evalint := CInt(AP_GetSkill(caster, EVALINT));
+  var resist := CInt(AP_GetSkill(cast_on, RESISTING_SPELLS));
         
   // chk1 relates to the resist ability.
   var chk1 := (resist / 5);
@@ -33,14 +33,13 @@
     diff := chk2;
   endif
         
-  var points := getresistpoints(circle, cast_on, SKILLID_MAGICRESISTANCE);
   if(cast_on.dead)
     return 0;
   endif
-  if(CheckSkill(cast_on, SKILLID_MAGICRESISTANCE, diff, points))
+  if( SkillCheck(cast_on, RESISTING_SPELLS, diff) > 0 )
     SendSysMessage(cast_on, "You feel yourself resisting magical energy!");
-    PlaySoundEffect(cast_on, SFX_SPELL_WEAKEN);
-    PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 5,5);
+    //PlaySoundEffect(cast_on, SFX_SPELL_WEAKEN);
+    //PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 5,5);
     amt := (amt * 0.5);
     if(amt < 1)
       amt := 1;
@@ -69,7 +68,7 @@
     7:   points := 160; diff := 86;
     8:   points := 180; diff := 100;
   endcase
-  var skill := GetEffectiveSkill(victim, skillid);
+  var skill := AP_GetSkill(victim, skillid);
   if(skill > (diff - 20))
     if((skill - diff) <= 5)
       points := points;
@@ -89,7 +88,7 @@
 function CalcSpellDamage(circle, caster)
   var die_string := circle+"d8";
   var dmg := RandomDiceRoll(die_string);
-  dmg := dmg + CInt(GetEffectiveSkill(caster, SKILLID_MAGERY)/10);
+  dmg := dmg + CInt(AP_GetSkill(caster, MAGERY)/10);
   if(dmg > (circle * 8))
     dmg := circle * 8;
   endif



From austin at berlios.de  Wed Nov  2 20:54:20 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 20:54:20 +0100
Subject: [Poldistro-svn] r843 - in trunk/096/pkg: skills/taming systems/daynight systems/merchantnodes
Message-ID: <200511021954.jA2JsKA8006238@sheep.berlios.de>

Author: austin
Date: 2005-11-02 20:54:11 +0100 (Wed, 02 Nov 2005)
New Revision: 843

Modified:
   trunk/096/pkg/skills/taming/happyCounter.src
   trunk/096/pkg/systems/daynight/wEffect.src
   trunk/096/pkg/systems/merchantnodes/guardNodeControl.src
   trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src
   trunk/096/pkg/systems/merchantnodes/merchantNodeDestroy.src
Log:
Attribute updates

Modified: trunk/096/pkg/skills/taming/happyCounter.src
===================================================================
--- trunk/096/pkg/skills/taming/happyCounter.src	2005-11-02 19:46:22 UTC (rev 842)
+++ trunk/096/pkg/skills/taming/happyCounter.src	2005-11-02 19:54:11 UTC (rev 843)
@@ -8,7 +8,7 @@
   var me := parms[1];
   var timer := parms[2];
   var happiness;
-  while((GetHp(me) > 0) && (me.script == "tamed"))
+  while((AP_GetVital(me, HITS) > 0) && (me.script == "tamed"))
     if(GetObjProperty(me,"countercheck") != timer)
       break;
     endif

Modified: trunk/096/pkg/systems/daynight/wEffect.src
===================================================================
--- trunk/096/pkg/systems/daynight/wEffect.src	2005-11-02 19:46:22 UTC (rev 842)
+++ trunk/096/pkg/systems/daynight/wEffect.src	2005-11-02 19:54:11 UTC (rev 843)
@@ -55,7 +55,7 @@
   SetObjProperty(mob, "guardkill", 1);
   PlayLightningBoltEffect( mob );
   PlaySoundEffect(who, SOUND_EFFECT_THUNDER);
-  ApplyRawDamage( mob, GetHp(mob) );;
+  ApplyRawDamage( mob, AP_GetVital(mob, HITS) );
 endfunction
 
 function DoThunder(who,list)

Modified: trunk/096/pkg/systems/merchantnodes/guardNodeControl.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/guardNodeControl.src	2005-11-02 19:46:22 UTC (rev 842)
+++ trunk/096/pkg/systems/merchantnodes/guardNodeControl.src	2005-11-02 19:54:11 UTC (rev 843)
@@ -111,7 +111,7 @@
 function ValidateSpawns()
   var chk := array;
   foreach thing in npclist
-    if(GetHP(thing))
+    if(AP_GetVital(thing, HITS))
       chk.append(thing);
     endif
   endforeach
@@ -126,7 +126,7 @@
 function DespawnAll()
   var chk := array;
   foreach thing in npclist
-    var hp := GetHP(thing);
+    var hp := AP_GetVital(thing, HITS);
     if(hp)
       MoveCharacterToLocation(thing, 5279, 1184, 0, MOVECHAR_FORCELOCATION);
       ApplyRawDamage(thing, Cint(hp + 100));

Modified: trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src	2005-11-02 19:46:22 UTC (rev 842)
+++ trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src	2005-11-02 19:54:11 UTC (rev 843)
@@ -181,7 +181,7 @@
 		foreach thing in npclist
 			if(entry[2] == GetObjProperty(thing, "Anchor"))
 				var npc := thing;
-				if((entry[3] == 1) and (GetHP(npc)))
+				if((entry[3] == 1) and (AP_GetVital(npc, HITS)))
 					if(npc in chk)
 						// do nothing -- invalid entry --
 					else
@@ -190,7 +190,7 @@
 				else
 					MoveCharacterToLocation(npc, 1, 1, 0, MOVECHAR_FORCELOCATION);
 					RevokePrivilege(npc, "invul");
-					ApplyRawDamage(npc, GetHP(npc) + 100);
+					ApplyRawDamage(npc, AP_GetVital(npc, HITS) + 100);
 				endif
 			endif
 			sleepms(2);
@@ -203,7 +203,7 @@
 		else
 			MoveCharacterToLocation(npc, 1, 1, 0, MOVECHAR_FORCELOCATION);
 			RevokePrivilege(npc, "invul");
-			ApplyRawDamage(npc, GetHP(npc) + 100);
+			ApplyRawDamage(npc, AP_GetVital(npc, HITS) + 100);
 		endif
 		sleepms(2);
 	endforeach
@@ -218,7 +218,7 @@
 function DespawnAll()
 	var chk := array;
 	foreach thing in npclist
-		var hp := GetHP(thing);
+		var hp := AP_GetVital(thing, HITS);
 		if(hp)
 			MoveCharacterToLocation(thing, 1, 1, 0, MOVECHAR_FORCELOCATION);
 			RevokePrivilege(thing, "invul");

Modified: trunk/096/pkg/systems/merchantnodes/merchantNodeDestroy.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/merchantNodeDestroy.src	2005-11-02 19:46:22 UTC (rev 842)
+++ trunk/096/pkg/systems/merchantnodes/merchantNodeDestroy.src	2005-11-02 19:54:11 UTC (rev 843)
@@ -11,7 +11,7 @@
     if(npc)
       RevokePrivilege(npc, "invul");
       SetObjProperty(npc, "guardkill", 1);
-      ApplyRawDamage(npc, GetHP(npc) + 100);
+      ApplyRawDamage(npc, AP_GetVital(npc, HITS) + 100);
     endif
   endforeach
   var type := GetObjProperty(item, "Type");



From austin at berlios.de  Wed Nov  2 21:18:09 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 21:18:09 +0100
Subject: [Poldistro-svn] r844 - in trunk/096: pkg/skills/meditation pkg/skills/mining pkg/skills/poisoning pkg/skills/removetrap pkg/skills/tailoring pkg/skills/taming pkg/skills/tasteid pkg/skills/tinkering pkg/skills/tracking pkg/skills/veterinary pkg/systems/attributes/commands/test scripts/items
Message-ID: <200511022018.jA2KI9M4023828@sheep.berlios.de>

Author: austin
Date: 2005-11-02 21:18:08 +0100 (Wed, 02 Nov 2005)
New Revision: 844

Modified:
   trunk/096/pkg/skills/meditation/medCheck.src
   trunk/096/pkg/skills/meditation/meditation.src
   trunk/096/pkg/skills/mining/mining.src
   trunk/096/pkg/skills/mining/resmelt.src
   trunk/096/pkg/skills/mining/smelting.src
   trunk/096/pkg/skills/poisoning/poisonSkill.src
   trunk/096/pkg/skills/removetrap/removeTrap.src
   trunk/096/pkg/skills/tailoring/makeClothItems.src
   trunk/096/pkg/skills/tailoring/scissors.src
   trunk/096/pkg/skills/taming/stableCounter.src
   trunk/096/pkg/skills/taming/taming.src
   trunk/096/pkg/skills/tasteid/tasteID.src
   trunk/096/pkg/skills/tinkering/makeComplexItem.src
   trunk/096/pkg/skills/tinkering/tinkerTraps.src
   trunk/096/pkg/skills/tinkering/tinkering.src
   trunk/096/pkg/skills/tracking/tracking.src
   trunk/096/pkg/skills/veterinary/vet.src
   trunk/096/pkg/systems/attributes/commands/test/attribconvert.src
   trunk/096/scripts/items/vendorDeed.src
Log:
Attribute updates

Modified: trunk/096/pkg/skills/meditation/medCheck.src
===================================================================
--- trunk/096/pkg/skills/meditation/medCheck.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/meditation/medCheck.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -21,7 +21,7 @@
     waittime := 0;
     loss := 0;
     if(GetObjProperty(who, "IsMeditating"))
-      skill:=CInt((GetEffectiveSkill(who,46)*100)/2);
+      skill:=CInt((AP_GetSkill(who, MEDITATION)*100)/2);
       loss := manaloss(who);
       if(loss == "nomed")
         loss := 7000;
@@ -32,7 +32,7 @@
       endif
       sleepms(waittime);
     else
-      skill:= (CInt((GetEffectiveSkill(who,46)*100)/2) / 2);
+      skill:= (CInt((AP_GetSkill(who, MEDITATION)*100)/2) / 2);
       loss := manaloss(who);
       if(loss == "nomed")
         loss := 7000;
@@ -43,13 +43,13 @@
       endif
       sleepms(waittime);
     endif
-    mana := GetMana(who);
-    gmm := GetMaxMana(who);
+    mana := AP_GetVital(who, MANA);
+    gmm := AP_GetVitalMaximumValue(who, MANA);
     if(mana < gmm)
-      SetMana(who, mana + 1);
+      AP_SetVital(who, MANA, mana + 1);
     endif
     if(mana > gmm)
-      SetMana(who, gmm);
+      AP_SetVital(who, MANA, gmm);
     endif
   endwhile
 endprogram

Modified: trunk/096/pkg/skills/meditation/meditation.src
===================================================================
--- trunk/096/pkg/skills/meditation/meditation.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/meditation/meditation.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -13,7 +13,7 @@
   var XXX:=who.x;
   var YYY:=who.y;
   var chp;
-  if (GetMana(who) >= GetIntelligence(who))
+  if (AP_GetVital(who, MANA) >= AP_GetVitalMaximumValue(who, MANA))
    SendSysMessage( who, "Your mana is full." );
    Detach();
    return;
@@ -33,7 +33,7 @@
     SendSysMessage(who,"Regenerative forces cannot penetrate your armor.");
     return;
   endif
-  var diff := 100 - ((GetMana(who) * 100) / GetIntelligence(who));
+  var diff := 100 - ((AP_GetVital(who, MANA) * 100) / AP_GetVitalMaximumValue(who, MANA));
   diff := diff + CInt(loss / 100);
   if(diff < 0)
     diff := 0;
@@ -41,7 +41,7 @@
     diff := 120;
   endif
   var pts := diff * 2;
-  if(CheckSkill(who, 46, diff, pts))
+  if( SkillCheck(who, MEDITATION, diff) > 0 )
     SendSysMessage(who, "You start to meditate.");
     PlaySoundEffect(who, sfx_meditation);
     PrintTextAbove(who, "*Meditating*");;
@@ -58,16 +58,16 @@
       elseif(TS_GetTimerNames(who, "P").size() > 0)
         EraseObjProperty(who, "IsMeditating");
       break;
-      elseif(GetMana(who) >= GetMaxMana(who))
+      elseif(AP_GetVital(who, MANA) >= AP_GetVitalMaximumValue(who, MANA))
         EraseObjProperty(who, "IsMeditating");
-        SetMana(who, GetMaxMana(who));
+        AP_SetVital(who, MANA,  AP_GetVitalMaximumValue(who, MANA));
       break;
-     elseif(GetHp(who) < chp)
+     elseif(AP_GetVital(who, HITS) < chp)
         EraseObjProperty(who, "IsMeditating");
       break;
      endif
       sleep(1);
-      chp := GetHp(who);
+      chp := AP_GetVital(who, HITS);
     endwhile
     SendSysMessage(who, "You lose your concentration.");
     EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/skills/mining/mining.src
===================================================================
--- trunk/096/pkg/skills/mining/mining.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/mining/mining.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -286,7 +286,7 @@
 endprogram
 
 function GetRange( who );
-  var skill := GetEffectiveSkill( who, SKILLID_MINING );
+  var skill := AP_GetSkill( who, MINING );
   if( skill >= 100 )
     return 5;
   elseif( skill >= 80 )
@@ -375,8 +375,8 @@
   var oretype := wait_for_event(10);
   var diff := 0;
   var objtype := 0;
-  var skill := GetEffectiveSkill(who, SKILLID_MINING);
-  var points := skill + 1;
+  var skill := AP_GetSkill(who, MINING);
+  //var points := skill + 1;
   var name;
   case(oretype)
     1: diff :=  -1;   objtype := 0x6300;   name := "iron";
@@ -404,7 +404,7 @@
       name := "iron";
     endif
   endif
-  if(CheckSkill(who, SKILLID_MINING, diffi, 10))
+  if( SkillCheck(who, MINING, diffi) > 0 )
   	var num := HarvestResource( "ore", location.x, location.y, 1, 1, who.realm);
     if(num == error)
       SendSysMessage(who,"There is no more ore here to mine.");
@@ -429,7 +429,7 @@
     else
 	  SendSysMessage(who, "You put some " + name + " ore in your backpack.");
     endif
-    AwardRawSkillPoints(who, SKILLID_MINING, points);
+    //AwardRawSkillPoints(who, SKILLID_MINING, points);
     var swings := GetObjProperty(tool,"swings");
     if(!swings)
       SetObjProperty(tool,"swings", 0);

Modified: trunk/096/pkg/skills/mining/resmelt.src
===================================================================
--- trunk/096/pkg/skills/mining/resmelt.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/mining/resmelt.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -47,7 +47,7 @@
           SendSysMessage(who, "You cannot resmelt that.");
           return;
         endif
-        amt := CInt((amt * GetEffectiveSkill(who,SKILLID_BLACKSMITHY) * 75 ) / 10000);
+        amt := CInt((amt * AP_GetSkill(who,BLACKSMITHY) * 75 ) / 10000);
         if(amt < 1)
           amt := 1;
         endif
@@ -68,7 +68,7 @@
         sleep(1);
         PlaySoundEffect(who, 0x22);
         if(DestroyItem(thing))
-          if(CheckSkill(who, SKILLID_BLACKSMITHY, skill, 10))
+          if(CheckSkill(who, BLACKSMITHY, skill, 10))
             SendSysMessage(who, "You manage to get a bit of material out of that.");
             CreateItemInBackpack(who, ingot, amt);
           else
@@ -85,7 +85,7 @@
       SendSysMessage(who, "You cannot resmelt that.");
       return;
     endif
-    amt := CInt((amt * GetEffectiveSkill(who,SKILLID_BLACKSMITHY) * 75 ) / 10000);
+    amt := CInt((amt * AP_GetSkill(who,BLACKSMITHY) * 75 ) / 10000);
     if(amt < 1)
       amt := 1;
     endif
@@ -112,7 +112,7 @@
     sleep(1);
     PlaySoundEffect(who, 0x22);
     if(DestroyItem(use_on))
-      if(CheckSkill(who, SKILLID_BLACKSMITHY, skill, 10))
+      if(CheckSkill(who, BLACKSMITHY, skill, 10))
         SendSysMessage(who, "You manage to get a bit of material out of that.");
         CreateItemInBackpack(who, ingot, amt);
       else

Modified: trunk/096/pkg/skills/mining/smelting.src
===================================================================
--- trunk/096/pkg/skills/mining/smelting.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/mining/smelting.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -4,6 +4,7 @@
 include "include/client";
 include "include/objtype";
 include "include/canAccess";
+include ":attributes:attributes";
 
 program smelt_that_ore (who, ore)
   EraseObjProperty(who, "IsMeditating");
@@ -51,7 +52,7 @@
       SendSysMessage(who,"That is too far away.");
       return;
     endif
-    if(CheckSkill(who, SKILLID_MINING, difficulty, ((difficulty / 2) + 10)))
+    if( SkillCheck(who, MINING, difficulty) > 0 )
       var ingots := CreateItemInBackpack(who, ingot, (GetAmount(ore) * 2));
       ReserveItem(ingots);
       if(ingots)

Modified: trunk/096/pkg/skills/poisoning/poisonSkill.src
===================================================================
--- trunk/096/pkg/skills/poisoning/poisonSkill.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/poisoning/poisonSkill.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -43,7 +43,7 @@
     endcase
     if(SubtractAmount(the_poison, 1))
       CreateItemInBackpack(who, 0xf0e, 1);
-      if(CheckSkill(who, SKILLID_POISONING, skill, point))
+      if( SkillCheck(who, POISONING, skill) > 0 )
         PlaySoundEffect(who, 0x248);
         SetObjProperty(the_item, "poison_level", stren);
         var skillmod := Cint(GetAttribute(who, "poisoning") / 20) + RandomInt(4);
@@ -57,7 +57,7 @@
           SetObjProperty(the_item, "OnHit", hitscripts);
         endif
         SendSysMessage(who, "You have successfully applied the poison.");
-        var myskill := CInt(GetEffectiveSkill(who, SKILLID_POISONING));
+        var myskill := CInt(AP_GetSkill(who, POISONING));
         var modpts := 0;
         if(myskill >=  skill)
           modpts := (myskill - skill);

Modified: trunk/096/pkg/skills/removetrap/removeTrap.src
===================================================================
--- trunk/096/pkg/skills/removetrap/removeTrap.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/removetrap/removeTrap.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -8,8 +8,8 @@
 include "include/sound";
 include "include/tileEffects";
 include "include/canAccess";
+include ":attributes:attributes";
 
-
 program removeTrap(who)
   EraseObjProperty(who, "IsMeditating");
   EraseObjProperty(who, "HealTimer");
@@ -24,7 +24,7 @@
     return;
   endif
      if( GetObjProperty(item,"trap_type") )
-        if( CheckSkill( who, SKILLID_REMOVETRAP, -1, thepoints ) )
+        if( SkillCheck( who, REMOVE_TRAP, -1) > 0 )
            EraseObjProperty( item, "trap_type" );
            EraseObjProperty( item, "trap_strength" );
            item.usescript := "";
@@ -59,7 +59,7 @@
           endif
         endif
       elseif( (GetObjProperty(item,"trapped") == 1) )
-        if( CheckSkill( who, SKILLID_REMOVETRAP, -1, 40 ) )
+        if( CheckSkill( who, REMOVE_TRAP, -1, 40 ) )
            DestroyItem( item );
 	       SendSysMessage( who, "You sucessfully removed the trap." );
         else

Modified: trunk/096/pkg/skills/tailoring/makeClothItems.src
===================================================================
--- trunk/096/pkg/skills/tailoring/makeClothItems.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/tailoring/makeClothItems.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -246,22 +246,22 @@
     endif
     totalcloth := mainclothused.amount;
     if(totalcloth >= material)
-      dif := (GetEffectiveSkill(who, SKILLID_TAILORING) - skill);
+      dif := (AP_GetSkill(who, TAILORING) - skill);
       if(dif < 5)
         dif := 5;
       elseif(dif > 40)
         dif := 50;
       endif
       makenoise(who);
-      if(CheckSkill(who, SKILLID_TAILORING, skill, skill*6))
+      if(CheckSkill(who, TAILORING, skill, skill*6))
         if(SubtractAmount(mainclothused, material))
           theitem := CreateItemInContainer(cont, objtype, 1);
-          CheckToolWear (who, kit, SKILLID_TAILORING);
+          CheckToolWear (who, kit, TAILORING);
           if(!theitem)
             counter := 100;
             SendSysMessage(who, "You have no more room in your backpack.");
           endif
-          hisskill := GetEffectiveSkill(who, SKILLID_TAILORING);
+          hisskill := AP_GetSkill(who, TAILORING);
           var modpts := 0;
           if(hisskill >=  skill)
             modpts := (hisskill - (skill - 10));
@@ -444,22 +444,22 @@
     endif
     totalcloth := cloth.amount;
     if(totalcloth >= material)
-      dif := (GetEffectiveSkill(who, SKILLID_TAILORING) - skill);
+      dif := (AP_GetSkill(who, TAILORING) - skill);
       if(dif < 5)
         dif := 5;
       elseif(dif > 40)
         dif := 50;
       endif
       makenoise(who);
-      if(CheckSkill(who, SKILLID_TAILORING, skill, skill*6))
+      if(CheckSkill(who, TAILORING, skill, skill*6))
         if(SubtractAmount(cloth, material))
           theitem := CreateItemInContainer(cont, objtype, 1);
-          CheckToolWear (who, kit, SKILLID_TAILORING);
+          CheckToolWear (who, kit, TAILORING);
           if(!theitem)
             counter := 100;
             SendSysMessage(who, "You have no more room in your backpack.");
           endif
-          hisskill := GetEffectiveSkill(who, SKILLID_TAILORING);
+          hisskill := AP_GetSkill(who, TAILORING);
           var modpts := 0;
           if(hisskill >=  skill)
             modpts := (hisskill - (skill - 10));
@@ -522,7 +522,7 @@
 
 function ComposeClothSubMenu(who)
   var num := 2;
-  var skill := (GetEffectiveSkill(who, SKILLID_TAILORING) + 20);
+  var skill := (AP_GetSkill(who, TAILORING) + 20);
   var color := 0;
   var cfg := ReadConfigFile(":tailoring:tailoring");
   while(num < 11)
@@ -722,7 +722,7 @@
 
 function ComposeLeatherSubMenu(who)
   var num := 2;
-  var skill := (GetEffectiveSkill(who, SKILLID_TAILORING) + 20);
+  var skill := (AP_GetSkill(who, TAILORING) + 20);
   var color := 0;
   var cfg := ReadConfigFile(":tailoring:leather");
   while(num < 11)

Modified: trunk/096/pkg/skills/tailoring/scissors.src
===================================================================
--- trunk/096/pkg/skills/tailoring/scissors.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/tailoring/scissors.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -51,7 +51,7 @@
       else
         MoveItemToContainer(newcloth, who.backpack);
       endif
-	  CheckToolWear (who, scissors, SKILLID_TAILORING);
+	  CheckToolWear (who, scissors, TAILORING);
       PlaySoundEffect(who, 0x0249);
       SendSysMessage(who, "You use the scissors to cut the material.");
       return;
@@ -71,13 +71,13 @@
       endif   
     endif
     PlaySoundEffect(who, 0x0249);
-    amt := CInt((material * GetEffectiveSkill(who,SKILLID_TAILORING) * 75) / 10000);
+    amt := CInt((material * AP_GetSkill(who,TAILORING) * 75) / 10000);
     if(amt < 1)
       amt := 1;
     endif
     if(DestroyItem(cloth))
       newcloth := CreateItemInContainer(who.backpack, leftover, amt);
-      CheckToolWear (who, scissors, SKILLID_TAILORING);
+      CheckToolWear (who, scissors, TAILORING);
       if(newcloth)
         newcloth.color := clr;
       endif

Modified: trunk/096/pkg/skills/taming/stableCounter.src
===================================================================
--- trunk/096/pkg/skills/taming/stableCounter.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/taming/stableCounter.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -57,10 +57,10 @@
     if (list)
       foreach critter in list
         c := GetObjProperty(critter,"amtdue");
-        cost := GetHp(critter) /2;
+        cost := AP_GetVital(critter, HITS) /2;
         days := GetObjProperty(critter,"days");
         if(days >4)
-          ApplyRawDamage(critter, GetHp(critter) + 5);
+          ApplyRawDamage(critter, AP_GetVital(critter, HITS) + 5);
         else
           mystorage := mystorage - 1;
           days := days + 1;

Modified: trunk/096/pkg/skills/taming/taming.src
===================================================================
--- trunk/096/pkg/skills/taming/taming.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/taming/taming.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -43,7 +43,7 @@
     SendSysMessage(who, "That creature looks pretty tame already.");
     return;
   endif
-  if (GetEffectiveSkill(who, SKILLID_TAMING) < (difficulty - 10))
+  if (AP_GetSkill(who, ANIMAL_TAMING) < (difficulty - 10))
     SendSysMessage(who, "You have no chance of taming this creature!");
     return;
   endif
@@ -82,7 +82,7 @@
     points := points * 10;
   endif
   var thename := GetName(thecreature.name);
-  var critterhp := GetHp(thecreature);
+  var critterhp := AP_GetVital(thecreature, HITS);
   var count;
   var counter := 0;
   sleep(1);
@@ -90,7 +90,7 @@
     if(who.dead)
       break;
     else
-      critterhp := GetHp(thecreature);
+      critterhp := AP_GetVital(thecreature, HITS);
       case(counter)
         0: PrintTextAbove(who, "What a nice " + thename + ".");
         1: PrintTextAbove(who, "I've always wanted a " + thename + " like you.");
@@ -99,7 +99,7 @@
       endcase
       counter := counter + 1;
       sleep(4);
-      if(GetHp(thecreature) < critterhp)
+      if(AP_GetVital(thecreature, HITS) < critterhp)
         SendSysMessage(who,"That creature is too angry to continue taming.");
         return;
       endif
@@ -117,7 +117,7 @@
     SendSysMessage(who, "That creature looks pretty tame already.");
     return;
   endif
-  if(CheckSkill(who, SKILLID_TAMING, difficulty + 10, points))
+  if( SkillCheck(who, ANIMAL_TAMING, difficulty + 10) > 0 )
     SendSysMessage(who, "You successfully tame the " + thename + ".");
     Run_Script_To_Completion(":spawnregion:death", thecreature);
     thecreature.script := "tamed";
@@ -133,7 +133,7 @@
       orneriness := 0;
     endif
     orneriness := orneriness * 5;
-    if(((RandomInt(99) + 1) + orneriness) > GetEffectiveSkill(who, SKILLID_TAMING))
+    if(((RandomInt(99) + 1) + orneriness) > AP_GetSkill(who, ANIMAL_TAMING))
       SendSysMessage(who, "You seem to have upset the beast!");
       var ev := array;
       ev.+ type;

Modified: trunk/096/pkg/skills/tasteid/tasteID.src
===================================================================
--- trunk/096/pkg/skills/tasteid/tasteID.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/tasteid/tasteID.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -22,7 +22,7 @@
     return;
   endif
   var content_descr := "";
-  if(CheckSkill(who, SKILLID_TASTEID, -1, CInt(GetEffectiveSkill(who, SKILLID_TASTEID))))
+  if(CheckSkill(who, TASTE_IDENTIFICATION, -1, CInt(AP_GetSkill(who, TASTE_IDENTIFICATION))))
     case(the_item.objtype)
       0xdc04: poison_descr := "a lesser poison.";
       0xdc05: poison_descr := "a regular poison.";

Modified: trunk/096/pkg/skills/tinkering/makeComplexItem.src
===================================================================
--- trunk/096/pkg/skills/tinkering/makeComplexItem.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/tinkering/makeComplexItem.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -36,7 +36,7 @@
 function make_complex_thing(who, desired_item, clicked_part, required_part)
     var skill     := tinker_cfg[desired_item].skill;
     var itemname  := tinker_cfg[desired_item].Name;
-    var thepoints := skill*2;
+    //var thepoints := skill*2;
     var canexceptional := tinker_cfg[desired_item].exch;
     SendSysMessage(who, "Select something to use that on.");
     var use_on := Target(who, "");
@@ -75,14 +75,14 @@
       endif
     endif
     if(use_on.amount  >= 1)
-      if(CheckSkill(who, SKILLID_TINKERING, skill,  thepoints))
+      if( SkillCheck(who, TINKERING, skill) > 0 )
         set_critical(1);
         SubtractAmount(use_on, 1 );
         SubtractAmount(clicked_part, 1 );
         set_critical(0);
         var theitem := CreateItemInBackpack( who, desired_item, 1 );
         if (theitem)
-          if (canexceptional and (CheckSkill(who, SKILLID_TINKERING, 90, thepoints)))
+          if (canexceptional and (SkillCheck(who, TINKERING, 90) > 0))
             theitem.quality := 1.2;
             theitem.hp := theitem.maxhp;
             SendSysMessage(who, "You make an exceptional item and put it in your pack.");
@@ -105,11 +105,11 @@
     var skill     := tinker_cfg[0x1057].skill;
     var itemname  := tinker_cfg[0x1057].Name;
     var thepoints := skill*2;
-    if(CheckSkill(who, SKILLID_TINKERING, skill,  thepoints))
+    if( SkillCheck(who, TINKERING, skill) > 0 )
       SubtractAmount(sextant_parts, 1 );
       var theitem := CreateItemInBackpack( who, 0x1057, 1 );
       if (theitem)
-        if (CheckSkill(who, SKILLID_TINKERING, 90, thepoints))
+        if ( SkillCheck(who, TINKERING, 90) > 0 )
           theitem.quality := 1.2;
           theitem.hp := theitem.maxhp;
           SendSysMessage(who, "You make an exceptional item and put it in your pack.");

Modified: trunk/096/pkg/skills/tinkering/tinkerTraps.src
===================================================================
--- trunk/096/pkg/skills/tinkering/tinkerTraps.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/tinkering/tinkerTraps.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -7,8 +7,8 @@
 include "include/tileEffects";
 include "include/client";
 include "include/canAccess";
+include ":attributes:attributes";
 
-
 program open_trapped_item(who, item)
   if(!item)
     item := who[2];
@@ -101,7 +101,7 @@
   if(cast_on.dead)
     return 0;
   endif
-  if(CheckSkill(cast_on, SKILLID_MAGICRESISTANCE, amt, (amt * 2)))
+  if( SkillCheck(cast_on, RESISTING_SPELLS, amt) > 0 )
     SendSysMessage(cast_on, "You feel yourself resisting magical energy!");
     PlaySoundEffect(cast_on, SFX_SPELL_WEAKEN);
     PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 5,5);

Modified: trunk/096/pkg/skills/tinkering/tinkering.src
===================================================================
--- trunk/096/pkg/skills/tinkering/tinkering.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/tinkering/tinkering.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -118,8 +118,8 @@
   var close   := OldGFButtonID(410, 380, 242, 241, 1);
   if((trg.objtype == 0x1bd7) || (trg.objtype == 0x1bdd))
     OldGFTextLine(110,  80, 900, "WOOD SELECTION MENU");
-    var num := 2;
-    var skill := (GetEffectiveSkill(who, SKILLID_TINKERING) + 20);
+    //var num := 2;
+    var skill := (AP_GetSkill(who, TINKERING) + 20);
     var color := 0;
     if(skill >= Cint(tinker_cfg[4144]."skill"))
       color := 900;
@@ -218,7 +218,7 @@
 
 function ComposeSubMenu(who)
   var num := 2;
-  var skill := (GetEffectiveSkill(who, SKILLID_TINKERING) + 20);
+  var skill := (AP_GetSkill(who, TINKERING) + 20);
   var color := 0;
   while(num < 9)
     case(num)
@@ -607,7 +607,7 @@
   var itemname  := tinker_cfg[what].Name;
   var thepoints := CInt(skill * 2);
   var exchk     := tinker_cfg[what].exchk;
-  var myskill := CInt(GetEffectiveSkill(who, SKILLID_TINKERING));
+  var myskill := CInt(AP_GetSkill(who, TINKERING));
   var counter := 0;
   var x := who.x;
   var y := who.y;
@@ -630,13 +630,13 @@
     sleep(2);
     PlaySoundEffect(who, 0x22d);
     sleep(2);
-    if(CheckSkill(who, SKILLID_TINKERING, skill, thepoints))
+    if( SkillCheck(who, TINKERING, skill) > 0 )
       if(!SubtractAmount(use_on, material))
         sendsysmessage(who, "Cancelled.");
         break;
       endif
       theitem := CreateItemInContainer(who.backpack, CInt(what), 1);
-      CheckToolWear (who, item, SKILLID_TINKERING);
+      CheckToolWear (who, item, TINKERING);
       theitem.movable := 1;
       var modpts := 0;
       if(myskill >=  skill)
@@ -648,7 +648,7 @@
         if(exchk)
           theitem.quality := 1.2;
           theitem.hp := theitem.maxhp;
-          if(GetEffectiveSkill(who, SKILLID_TINKERING) >= 99)
+          if(AP_GetSkill(who, TINKERING) >= 99)
             SetName(theitem, "an exceptional " + itemname + " [crafted by " + who.name + "]");
           else
             SetName(theitem, "an exceptional " + itemname);
@@ -678,14 +678,14 @@
       endif
       if((theitem.graphic in array(0x9a8, 0x9a9, 0x9aa, 0x9ab, 0xa2c, 0xa30, 0xa34, 0xa38, 0xa4d, 0xa4f,
         0xa51, 0xa53, 0xe3c, 0xe3d, 0xe3e, 0xe3f, 0xe40, 0xe41, 0xe42, 0xe43, 0xe7c, 0xe7d, 0xe7e, 0xe80)))
-        if(RandomInt(GetEffectiveSkill(who, SKILLID_TINKERING)) > 40)
+        if(RandomInt(AP_GetSkill(who, TINKERING)) > 40)
           SetObjProperty(theitem, "lockable", "1");
           lockid := AllocLockId();
           theitem.locked := 0;
           thekey := CreateItemInBackpack(who, UOBJ_COPPER_KEY, 1);
           SetObjProperty(thekey, "lockid", lockid);
           SetObjProperty(theitem,"lockid", lockid);
-          SetObjProperty(theitem,"LockPickDiff", (GetEffectiveSkill(who, SKILLID_TINKERING) + 10));
+          SetObjProperty(theitem,"LockPickDiff", (AP_GetSkill(who, TINKERING) + 10));
           SendSysMessage(who, "You will find the key in your backpack.");
         endif
       endif
@@ -700,7 +700,7 @@
 function make_jewelry(who, item, stuff, what, ct)
   ct := Cint(ct);
   SetObjProperty(who, "LastTinkerItem", what);
-  var type      := tinker_cfg[what].type;
+  //var type      := tinker_cfg[what].type;
   var material  := tinker_cfg[what].material;
   var skill     := tinker_cfg[what].skill;
   var itemname  := tinker_cfg[what].Name;
@@ -731,7 +731,7 @@
     SendSysMessage(who, "You can't reach that!");
     return;
   endif
-  var myskill := CInt(GetEffectiveSkill(who, SKILLID_TINKERING));
+  var myskill := CInt(AP_GetSkill(who, TINKERING));
   while(counter < ct)
     if((who.x != x) || (who.y != y))
       SendSysMessage(who, "You stop tinkering.");
@@ -751,12 +751,12 @@
       if(!SubtractAmount(thegem, 1))
         break;
       endif
-      if(CheckSkill(who, SKILLID_TINKERING, skill, thepoints))
+      if( SkillCheck(who, TINKERING, skill) > 0 )
         if(!SubtractAmount(stuff, material))
           break;
         endif
         theitem := CreateItemInBackpack(who, CInt(what), 1);
-        CheckToolWear (who, item, SKILLID_TINKERING);
+        CheckToolWear (who, item, TINKERING);
         var modpts := 0;
         if(myskill >=  skill)
           modpts := (myskill - skill);
@@ -841,9 +841,9 @@
     if(!SubtractAmount(ingot, 1))
       break;
     endif
-    var myskill := GetEffectiveSkill(who, SKILLID_TINKERING);
+    var myskill := AP_GetSkill(who, TINKERING);
     sleep(2);
-    if(CheckSkill(who, SKILLID_TINKERING, -1, Cint(myskill / 2)))
+    if( SkillCheck(who, TINKERING, -1) > 0 )
       var modpts := 10;
       var rint := RandomInt(100);
       if(modpts >= rint)
@@ -857,7 +857,7 @@
       SendSysMessage(who, "You carefully place the trap on the container.");
       chest.usescript := ":tinkering:tinkerTraps";
       SetObjProperty(chest, "trapper", who.serial);
-      CheckToolWear (who, item, SKILLID_TINKERING);
+      CheckToolWear (who, item, TINKERING);
     else
       var results := RandomInt(9) + 1;
       if(results == 1)
@@ -921,7 +921,7 @@
     if(!SubtractAmount(ingot, 1))
       break;
     endif
-    var myskill := CInt(GetEffectiveSkill(who, SKILLID_TINKERING));
+    var myskill := CInt(AP_GetSkill(who, TINKERING));
     if(myskill <= 20)
       strength := 1;
     elseif(myskill <= 40)
@@ -933,7 +933,7 @@
     else
       strength := 5;
     endif
-    if(CheckSkill(who, SKILLID_TINKERING, -1, myskill))
+    if( SkillCheck(who, TINKERING, -1) > 0 )
       var modpts := 10;
       var rint := RandomInt(100);
       if(modpts >= rint)
@@ -952,7 +952,7 @@
       SendSysMessage(who, "You carefully place the trap on the container.");
       chest.usescript := ":tinkering:tinkerTraps";
       SetObjProperty(chest, "trapper", who.serial);
-      CheckToolWear (who, item, SKILLID_TINKERING);
+      CheckToolWear (who, item, TINKERING);
     else
       results := RandomInt(9) + 1;
       if (results == 1)
@@ -1013,8 +1013,8 @@
       return;
     endif
     SubtractAmount(ingot, 1);
-    var myskill := CInt(GetEffectiveSkill(who, SKILLID_TINKERING));
-    if (CheckSkill( who, SKILLID_TINKERING, -1, myskill*2 ))
+    var myskill := CInt(AP_GetSkill(who, TINKERING));
+    if (CheckSkill( who, TINKERING, -1, myskill*2 ))
       var modpts := 10;
       var rint := RandomInt(100);
       if(modpts >= rint)
@@ -1033,7 +1033,7 @@
       SendSysMessage(who, "You carefully place the trap on the container.");
       chest.usescript := ":tinkering:tinkerTraps";
       SetObjProperty(chest, "trapper", who.serial);
-      CheckToolWear (who, item, SKILLID_TINKERING);
+      CheckToolWear (who, item, TINKERING);
     else
       results := RandomInt(9) + 1;
       if (results == 1)

Modified: trunk/096/pkg/skills/tracking/tracking.src
===================================================================
--- trunk/096/pkg/skills/tracking/tracking.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/tracking/tracking.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -13,10 +13,10 @@
   EraseObjProperty(who, "IsMeditating");
   EraseObjProperty(who, "HealTimer");
 //  UnloadConfigFile(":tracking:tracking");
-  if(CheckSkill(who, SKILLID_TRACKING, -1, (GetEffectiveSkill(who, SKILLID_TRACKING) + 30)))
+  if(SkillCheck(who, TRACKING, -1) >0)
     var tracker := ReadGameClock();
     SetObjProperty(who, "TrackingCounter", tracker);
-    var range := CInt((GetEffectiveSkill(who, SKILLID_TRACKING)/3));
+    var range := CInt((AP_GetSkill(who, TRACKING)/3));
     var nearby := ListMobilesNearLocation(who.x, who.y, who.z, range, who.realm);
     if(nearby.size() == 1 && nearby[1].serial == who.serial)
       SendSysMessage(who, "There don't seem to be any creatures nearby.");

Modified: trunk/096/pkg/skills/veterinary/vet.src
===================================================================
--- trunk/096/pkg/skills/veterinary/vet.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/skills/veterinary/vet.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -18,15 +18,15 @@
   var patient := parms[1];
   var who := parms[2];
   EraseObjProperty(who, "IsMeditating");
-  var sleeptime;
-  var anatomy:= GetEffectiveSkill(who, SKILLID_ANATOMY);
+  //var sleeptime;
+  var anatomy:= AP_GetSkill(who, ANATOMY);
   if(dist(who, patient) > 2)
     SendSysMessage(who, "Your patient is too far away.");
     return;
   elseif(!CheckLineOfSight(who,patient))
 	SendSysMessage(who,"You can't see your patient.");
 	return;
-  elseif((GetHp(patient) >= GetStrength(patient)) && (TS_GetTimerNames(patient, "P").size() == 0))
+  elseif((AP_GetVital(patient, HITS) >= AP_GetVitalMaximumValue(patient, HITS)) && (TS_GetTimerNames(patient, "P").size() == 0))
 	SendSysMessage(who,"Your patient is at full health!");
 	return;
   endif
@@ -63,8 +63,8 @@
   var wx:= who.x;
   var wy:= who.y;
   var chp;
-  var healing := (CInt(GetEffectiveSkill(who, SKILLID_VETERINARY)) / 2);
-  var anatomy := (CInt(GetEffectiveSkill(who, SKILLID_ANATOMY)) / 5);
+  var healing := (CInt(AP_GetSkill(who, VETERINARY)) / 2);
+  var anatomy := (CInt(AP_GetSkill(who, ANATOMY)) / 5);
   var healamt := healing + anatomy + 10;
   var counter := 0;
   var cycles;
@@ -88,7 +88,7 @@
       SendSysMessage(who, "You stop healing your patient to work on another.");
       break;
     endif
-    chp:=GetHp(who);
+    chp:=AP_GetVital(who, HITS);
     sleep(1);
     if(dist(who, patient) > 2)
       SendSysMessage(who,"Your patient isn't close enough.");
@@ -98,7 +98,7 @@
       SendSysMessage(who,"You stop healing your patient.");
       break;
     endif
-    if(GetHp(who) < chp)
+    if(AP_GetVital(who, HITS) < chp)
       if((RandomInt(100)+1) > who.dex)
         SendSysMessage( who, "Your fingers slip." );
         healamt := (healamt / 2);
@@ -109,19 +109,19 @@
       break;
     endif
     if(counter >= cycles)
-      if(CheckSkill(who, SKILLID_VETERINARY, -1, 0))
+      if(SkillCheck(who, VETERINARY, -1)>0)
         if(healamt <= 10)
           SendSysMessage(who,"You finish applying the bandages, but they barely help.");
         endif
-        if((patient.str - GetHp(patient)) > healamt)
+        if((patient.str - AP_GetVital(patient, HITS)) > healamt)
           HealDamage(patient, healamt);
-          AwardRawSkillPoints(who, SKILLID_VETERINARY, (healamt * 2));
+          //AwardRawSkillPoints(who, VETERINARY, (healamt * 2));
         else
-          healamt := GetStrength(patient) - GetHp(patient);
+          healamt := AP_GetVitalMaximumValue(patient, HITS) - AP_GetVital(patient, HITS);
           HealDamage(patient, healamt);
-          AwardRawSkillPoints(who, SKILLID_VETERINARY, (healamt * 2));
+          //AwardRawSkillPoints(who, VETERINARY, (healamt * 2));
         endif
-        if(GetHp(patient) == GetMaxHp(patient))
+        if(AP_GetVital(patient, HITS) == AP_GetVital(patient, HITS))
 		  SendSysMessage(who, "You have healed your patient completely.");
         else
 		  SendSysMessage(who, "You successfully heal " + patient.name+".");
@@ -139,8 +139,8 @@
   var wx:= who.x;
   var wy:= who.y;
   var chp;
-  var healing := (CInt(GetEffectiveSkill(who, SKILLID_VETERINARY)) / 2);
-  var anatomy := (CInt(GetEffectiveSkill(who, SKILLID_ANATOMY)) / 5);
+  var healing := (CInt(AP_GetSkill(who, VETERINARY)) / 2);
+  var anatomy := (CInt(AP_GetSkill(who, ANATOMY)) / 5);
   var healamt := healing + anatomy + 10;
   var counter := 0;
   var cycles;
@@ -164,7 +164,7 @@
       SendSysMessage(who, "You stop healing your patient to work on another.");
       break;
     endif
-    chp:=GetHp(who);
+    chp:=AP_GetVital(who, HITS);
     sleep(1);
     if(dist(who, patient) > 1)
       SendSysMessage(who,"Your patient isn't close enough.");
@@ -174,14 +174,14 @@
       SendSysMessage(who,"You stop healing your patient.");
       break;
     endif
-	if(GetHp(who) < chp)
+	if(AP_GetVital(who, HITS) < chp)
       if((RandomInt(100)+1) > who.dex)
 	    SendSysMessage( who, "Your fingers slip." );
         healamt := ((healamt * 3) / 4);
       endif
 	endif
     if(counter >= cycles)
-      if(CheckSkill(who, SKILLID_VETERINARY, 80, 0) && (CInt(GetEffectiveSkill(who, SKILLID_ANATOMY)) >= 61))
+      if(SkillCheck(who, VETERINARY, 80) > 0 && (CInt(AP_GetSkill(who, ANATOMY)) >= 61))
         if((RandomInt(100) + 1) < healamt);
          TS_CurePoison(patient,(healamt/40),"P");
           if (TS_GetTimerNames(patient, "P").size() > 0)

Modified: trunk/096/pkg/systems/attributes/commands/test/attribconvert.src
===================================================================
--- trunk/096/pkg/systems/attributes/commands/test/attribconvert.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/pkg/systems/attributes/commands/test/attribconvert.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -9,8 +9,8 @@
 		SendSysMessage(who, "Error - no skillID or attribute name was sent.");
 		return;
 	elseif ( Len(input) <= 2 )
-		SendSysMessage(who, "SkillID ["+input+"] points to attribute "+AP_IDToAttributeName(input));
+		SendSysMessage(who, "SkillID ["+input+"] points to attribute "+AP_SkillIdToAttributeName(input));
 	else
-		SendSysMessage(who, "Attribute ["+input+"] points to skillID "+AP_AttributeNameToSkillID(input));
+		SendSysMessage(who, "Attribute ["+input+"] points to skillID "+AP_AttributeNameToSkillId(input));
 	endif
 endprogram

Modified: trunk/096/scripts/items/vendorDeed.src
===================================================================
--- trunk/096/scripts/items/vendorDeed.src	2005-11-02 19:54:11 UTC (rev 843)
+++ trunk/096/scripts/items/vendorDeed.src	2005-11-02 20:18:08 UTC (rev 844)
@@ -44,7 +44,7 @@
       if(!DestroyItem(deed))
         RevokePrivilege(place, "invul");
         SetObjProperty(place, "guardkill", 1);
-        ApplyRawDamage(place, (GetHp(place) + 5));
+        ApplyRawDamage(place, (AP_GetVital(place, HITS) + 5));
       endif
     endif
   else



From muaddiblsd at berlios.de  Wed Nov  2 21:23:42 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Wed, 2 Nov 2005 21:23:42 +0100
Subject: [Poldistro-svn] r845 - trunk/096/pkg/skills/fishing
Message-ID: <200511022023.jA2KNgJS024712@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-02 21:23:42 +0100 (Wed, 02 Nov 2005)
New Revision: 845

Modified:
   trunk/096/pkg/skills/fishing/fishing.src
   trunk/096/pkg/skills/fishing/fishingFunctions.inc
Log:
Someone broke it changing ATTRIBUTE_FISHING to FISHING.

Modified: trunk/096/pkg/skills/fishing/fishing.src
===================================================================
--- trunk/096/pkg/skills/fishing/fishing.src	2005-11-02 20:18:08 UTC (rev 844)
+++ trunk/096/pkg/skills/fishing/fishing.src	2005-11-02 20:23:42 UTC (rev 845)
@@ -86,7 +86,7 @@
 				SendSysMessage(who, "There doesn't seem to be any fish here.");
 				return 0;
 			endif
-			if( SkillCheck(who, FISHING, difficulty) > 0)
+			if( SkillCheck(who, ATTRIBUTE_FISHING, difficulty) > 0)
 				var fishreturned := HarvestResource("fish", targetsquare.x, targetsquare.y, 1, 1, who.realm);
 				if( !fishreturned )
 					SendSysMessage(who, "Oops, you let that one get away!");
@@ -111,7 +111,7 @@
 function GetTheCatch(who, targetsquare, fishingpole)
 
 	var fishtype;
-	var currentskill := AP_GetSkill(who, FISHING);
+	var currentskill := AP_GetSkill(who, ATTRIBUTE_FISHING);
 	var thisone := RandomInt(100)+ 1;
 	if(thisone <= 94)
 		fishtype := RandomInt(UOBJ_FISH_END - UOBJ_FISH_START)+ UOBJ_FISH_START;
@@ -161,7 +161,7 @@
 		endif
 	else
 		if( CreateItemInContainer(who.backpack, fishtype, 1) )
-			CheckToolWear (who, fishingpole, FISHING);
+			CheckToolWear (who, fishingpole, ATTRIBUTE_FISHING);
 		endif
         endif
 

Modified: trunk/096/pkg/skills/fishing/fishingFunctions.inc
===================================================================
--- trunk/096/pkg/skills/fishing/fishingFunctions.inc	2005-11-02 20:18:08 UTC (rev 844)
+++ trunk/096/pkg/skills/fishing/fishingFunctions.inc	2005-11-02 20:23:42 UTC (rev 845)
@@ -188,7 +188,7 @@
 function GetSOSTreasure(who, targetsquare, sosmsg)
 
 	targetsquare := targetsquare;
-	if( SkillCheck(who, FISHING, 80, 200) > 0 )
+	if( SkillCheck(who, ATTRIBUTE_FISHING, 80, 200) > 0 )
 		var itemcfg := ReadConfigFile(":*:itemdesc");
 		var it, oldname;
 		if( RandomInt(100) < 75 )



From muaddiblsd at berlios.de  Wed Nov  2 21:25:08 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Wed, 2 Nov 2005 21:25:08 +0100
Subject: [Poldistro-svn] r846 - trunk/096/pkg/items/ministatues
Message-ID: <200511022025.jA2KP8ow024974@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-02 21:25:08 +0100 (Wed, 02 Nov 2005)
New Revision: 846

Modified:
   trunk/096/pkg/items/ministatues/statueDeed.src
Log:


Modified: trunk/096/pkg/items/ministatues/statueDeed.src
===================================================================
--- trunk/096/pkg/items/ministatues/statueDeed.src	2005-11-02 20:23:42 UTC (rev 845)
+++ trunk/096/pkg/items/ministatues/statueDeed.src	2005-11-02 20:25:08 UTC (rev 846)
@@ -28,7 +28,11 @@
 
 	if( ReleaseItem(deed) )
 		if( DestroyItem(deed) )
+			SetName(mini_statue, statue_elem.Name);
+			mini_statue.graphic := statue_elem.Graphic;
+			mini_statue.usescript := ":ministatues:useStatue";
 			MoveItemToContainer(mini_statue, who.backpack);
+			SendSysMessage(who, "You have redeemed your ticket for a mini statue.");
 		else
 			DestroyItem(mini_statue);
 		endif



From austin at berlios.de  Wed Nov  2 21:39:33 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 21:39:33 +0100
Subject: [Poldistro-svn] r847 - trunk/096/pkg/systems/attributes/include
Message-ID: <200511022039.jA2KdX5e027001@sheep.berlios.de>

Author: austin
Date: 2005-11-02 21:39:33 +0100 (Wed, 02 Nov 2005)
New Revision: 847

Modified:
   trunk/096/pkg/systems/attributes/include/skills.inc
   trunk/096/pkg/systems/attributes/include/stats.inc
Log:
Added ModifySkillMod() and ModifyStatMod()

Takes current modifier and adjusts it.

Modified: trunk/096/pkg/systems/attributes/include/skills.inc
===================================================================
--- trunk/096/pkg/systems/attributes/include/skills.inc	2005-11-02 20:25:08 UTC (rev 846)
+++ trunk/096/pkg/systems/attributes/include/skills.inc	2005-11-02 20:39:33 UTC (rev 847)
@@ -107,6 +107,31 @@
 endfunction
 
 /*
+ * AP_ModifySkillMod(mobile, skill_name, points)
+ *
+ * Purpose
+ * Modifies the modifier value for the skill.
+ * Example: 	AP_SetStatMod(mobile, "alchemy", -15.3)
+ *
+ * Parameters
+ * mobile:	Mobile reference to adjust the modifier points on.
+ * stat_name:	Name of the skill to adjust the modifier points on.
+ * points:	Number of points to adjust the modifier by.
+ *
+ * Return value
+ * Returns the previous value
+ *
+ */
+function AP_ModifySkillMod(mobile, stat_name, points)
+	var orig_mod := AP_GetStatMod(mobile, stat_name);
+	var new_mod := CDbl(points)+orig_mod;
+	SetAttributeTemporaryMod(mobile, stat_name, CInt(CDbl(new_mod) * 10.0));
+	
+	return orig_mod;
+endfunction
+
+
+/*
  * AP_SetSkillScript(attribute_name)
  *
  * Purpose

Modified: trunk/096/pkg/systems/attributes/include/stats.inc
===================================================================
--- trunk/096/pkg/systems/attributes/include/stats.inc	2005-11-02 20:25:08 UTC (rev 846)
+++ trunk/096/pkg/systems/attributes/include/stats.inc	2005-11-02 20:39:33 UTC (rev 847)
@@ -107,6 +107,30 @@
 endfunction
 
 /*
+ * AP_ModifyStatMod(mobile, stat_name, points)
+ *
+ * Purpose
+ * Modifies the modifier value for the stat.
+ * Example: 	AP_SetStatMod(mobile, "strength", -15.3)
+ *
+ * Parameters
+ * mobile:	Mobile reference to adjust the modifier points on.
+ * stat_name:	Name of the stat to adjust the modifier points on.
+ * points:	Number of points to adjust the modifier by.
+ *
+ * Return value
+ * Returns the previous value
+ *
+ */
+function AP_ModifyStatMod(mobile, stat_name, points)
+	var orig_mod := AP_GetStatMod(mobile, stat_name);
+	var new_mod := CDbl(points)+orig_mod;
+	SetAttributeTemporaryMod(mobile, stat_name, CInt(CDbl(new_mod) * 10.0));
+	
+	return orig_mod;
+endfunction
+
+/*
  * AP_GetStatCap(stat_name)
  *
  * Purpose



From austin at berlios.de  Wed Nov  2 21:54:39 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 21:54:39 +0100
Subject: [Poldistro-svn] r848 - in trunk/096/pkg/systems: attributes/include combat/old
Message-ID: <200511022054.jA2KsdeO028456@sheep.berlios.de>

Author: austin
Date: 2005-11-02 21:54:39 +0100 (Wed, 02 Nov 2005)
New Revision: 848

Modified:
   trunk/096/pkg/systems/attributes/include/skills.inc
   trunk/096/pkg/systems/attributes/include/stats.inc
   trunk/096/pkg/systems/combat/old/chargeUpkeep.src
   trunk/096/pkg/systems/combat/old/destroy.src
   trunk/096/pkg/systems/combat/old/earthElemental.src
   trunk/096/pkg/systems/combat/old/equip.inc
   trunk/096/pkg/systems/combat/old/hitScriptInc.inc
   trunk/096/pkg/systems/combat/old/unequip.src
   trunk/096/pkg/systems/combat/old/vortexHit.src
   trunk/096/pkg/systems/combat/old/wrestlingHitScript.src
Log:
Attribute updates.

Modified: trunk/096/pkg/systems/attributes/include/skills.inc
===================================================================
--- trunk/096/pkg/systems/attributes/include/skills.inc	2005-11-02 20:39:33 UTC (rev 847)
+++ trunk/096/pkg/systems/attributes/include/skills.inc	2005-11-02 20:54:39 UTC (rev 848)
@@ -124,9 +124,10 @@
  */
 function AP_ModifySkillMod(mobile, stat_name, points)
 	var orig_mod := AP_GetStatMod(mobile, stat_name);
-	var new_mod := CDbl(points)+orig_mod;
-	SetAttributeTemporaryMod(mobile, stat_name, CInt(CDbl(new_mod) * 10.0));
+	var new_mod := CDbl(points)+CDbl(orig_mod);
 	
+	AP_SetSkillMod(mobile, stat_name, new_mod);
+	
 	return orig_mod;
 endfunction
 

Modified: trunk/096/pkg/systems/attributes/include/stats.inc
===================================================================
--- trunk/096/pkg/systems/attributes/include/stats.inc	2005-11-02 20:39:33 UTC (rev 847)
+++ trunk/096/pkg/systems/attributes/include/stats.inc	2005-11-02 20:54:39 UTC (rev 848)
@@ -124,9 +124,10 @@
  */
 function AP_ModifyStatMod(mobile, stat_name, points)
 	var orig_mod := AP_GetStatMod(mobile, stat_name);
-	var new_mod := CDbl(points)+orig_mod;
-	SetAttributeTemporaryMod(mobile, stat_name, CInt(CDbl(new_mod) * 10.0));
+	var new_mod := CDbl(points)+Cdbl(orig_mod);
 	
+	AP_SetStatMod(mobile, stat_name, new_mod);
+	
 	return orig_mod;
 endfunction
 

Modified: trunk/096/pkg/systems/combat/old/chargeUpkeep.src
===================================================================
--- trunk/096/pkg/systems/combat/old/chargeUpkeep.src	2005-11-02 20:39:33 UTC (rev 847)
+++ trunk/096/pkg/systems/combat/old/chargeUpkeep.src	2005-11-02 20:54:39 UTC (rev 848)
@@ -41,15 +41,15 @@
     return;
   endif
   case(type)
-    "strength":     ModifyAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH, gain);
+    "strength":     AP_ModifyStatMod(who, STRENGTH, gain);
     "invisibility": who.hidden := 1;
     "sight":        who.setlightlevel(0, 70);
-    "protection":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_PARRY, gain);
+    "protection":   AP_ModifySkillMod(who, PARRY, gain);
     "reflect":      SetObjProperty(who, "mr", 2);
-    "bless":        ModifyAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH,     gain);
-                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_INTELLIGENCE, gain);
-                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_DEXTERITY,    gain);
-                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_PARRY,        (gain *3 ));
+    "bless":        AP_ModifySkillMod(who, STRENGTH,     gain);
+                    AP_ModifySkillMod(who, INTELLIGENCE, gain);
+                    AP_ModifySkillMod(who, DEXTERITY,    gain);
+                    AP_ModifySkillMod(who, PARRY,        (gain *3 ));
   endcase
   RecalcVitals(who);
   EraseObjProperty(item, "HoldMods");
@@ -117,15 +117,15 @@
     who := SystemFindObjectBySerial(who.serial, SYSFIND_SEARCH_OFFLINE_MOBILES);
   endif
   case(type)
-    "strength":     ModifyAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH, (0 - gain));
+    "strength":     AP_ModifyStatMod(who, STRENGTH, (0 - gain));
     "invisibility": who.hidden := 0;
     "sight":        who.setlightlevel(0, 1);
-    "protection":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_PARRY, (0 - gain));
+    "protection":   AP_ModifySkillMod(who, PARRY, (0 - gain));
     "reflect":      EraseObjProperty(who, "mr");
-    "bless":        ModifyAttributeTemporaryMod(who, ATTRIBUTEID_STRENGTH,     (0 - gain));
-                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_INTELLIGENCE, (0 - gain));
-                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_DEXTERITY,    (0 - gain));
-                    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_PARRY,        (0 - (gain *3)));
+    "bless":        AP_ModifySkillMod(who, STRENGTH,     (0 - gain));
+                    AP_ModifySkillMod(who, INTELLIGENCE, (0 - gain));
+                    AP_ModifySkillMod(who, DEXTERITY,    (0 - gain));
+                    AP_ModifySkillMod(who, PARRY,        (0 - (gain *3)));
   endcase
   RecalcVitals(who);
   EraseObjProperty(item, "HoldMods");

Modified: trunk/096/pkg/systems/combat/old/destroy.src
===================================================================
--- trunk/096/pkg/systems/combat/old/destroy.src	2005-11-02 20:39:33 UTC (rev 847)
+++ trunk/096/pkg/systems/combat/old/destroy.src	2005-11-02 20:54:39 UTC (rev 848)
@@ -16,7 +16,7 @@
   var penalty := CInt(itemdesc[item.objtype].DexPenalty);
   if(penalty)
     EraseObjProperty(item, "#equipped");
-    SetDexterityMod(who, GetDexterityMod(who) + penalty);
+    AP_SetStatMod(who, DEXTERITY, AP_GetStatMod(who, DEXTERITY) + penalty);
   endif
   var type := GetObjProperty(item,"type");
   var val := 0;
@@ -27,7 +27,7 @@
     "reflect":      val := reflect(who,item);
     "protection":   val := protection(who,item);
     "wizzohat":     val := wizzohat(who,item);
-    "strength":     val := strength(who,item);
+    "strength":     val := ModifyStrength(who,item);
     "invisibility": val := invisibility(who, item);
     default:        val := 1;
   endcase
@@ -35,16 +35,16 @@
   set_critical(0);
 endprogram
 
-function strength(who,item)
+function ModifyStrength(who,item)
   who := who;
   item := item;
   return 1;
 endfunction
 
 function wizzohat(who,item)
-  SetIntelligenceMod(who, GetIntelligenceMod(who) - 10);
-  SetStrengthMod(who, GetStrengthMod(who) + 5);
-  SetDexterityMod(who, GetDexterityMod(who) + 5);
+  AP_SetStatMod(who, INTELLIGENCE, AP_GetStatMod(who, INTELLIGENCE) - 10);
+  AP_SetStatMod(who, STRENGTH, AP_GetStatMod(who, STRENGTH) + 5);
+  AP_SetStatMod(who, DEXTERITY, AP_GetStatMod(who, DEXTERITY) + 5);
   EraseObjProperty(item, "#equipped");
   return 1;
 endfunction
@@ -79,11 +79,11 @@
   var cfg := ReadConfigFile(":combat:itemdesc");
   var attrib := cfg[item.objtype].Attribute;
   case(attrib)
-    "Wrestling": ModifyAttributeTemporaryMod(who, ATTRIBUTEID_WRESTLING,     amt);
-    "Fencing":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_FENCING,       amt);
-    "Archery":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_ARCHERY,       amt);
-    "Swords":    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_SWORDSMANSHIP, amt);
-    "Mace":      ModifyAttributeTemporaryMod(who, ATTRIBUTEID_MACEFIGHTING,  amt);
+    "Wrestling": AP_ModifySkillMod(who, WRESTLING,     amt);
+    "Fencing":   AP_ModifySkillMod(who, FENCING,       amt);
+    "Archery":   AP_ModifySkillMod(who, ARCHERY,       amt);
+    "Swords":    AP_ModifySkillMod(who, SWORDSMANSHIP, amt);
+    "Mace":      AP_ModifySkillMod(who, MACE_FIGHTING,  amt);
   endcase
   EraseObjProperty(item, "#equipped");
   return 1;

Modified: trunk/096/pkg/systems/combat/old/earthElemental.src
===================================================================
--- trunk/096/pkg/systems/combat/old/earthElemental.src	2005-11-02 20:39:33 UTC (rev 847)
+++ trunk/096/pkg/systems/combat/old/earthElemental.src	2005-11-02 20:54:39 UTC (rev 848)
@@ -23,10 +23,10 @@
     endif
   endif
   var sdr := RandomInt(3) + 3;
-  if(GetStamina(defender) >= sdr)
-    SetStamina(defender, GetStamina(defender) - sdr);
+  if(AP_GetVital(defender, STAMINA) >= sdr)
+    AP_SetVital(defender, STAMINA, AP_GetVital(defender, STAMINA) - sdr);
   else
-    SetStamina(defender, 0);
+    AP_SetVital(defender, STAMINA, 0);
   endif
 endprogram
 

Modified: trunk/096/pkg/systems/combat/old/equip.inc
===================================================================
--- trunk/096/pkg/systems/combat/old/equip.inc	2005-11-02 20:39:33 UTC (rev 847)
+++ trunk/096/pkg/systems/combat/old/equip.inc	2005-11-02 20:54:39 UTC (rev 848)
@@ -1,4 +1,6 @@
+use uo;
 
+include ":attributes:attributes";
 
 
 function HandleMods(who, item)
@@ -12,7 +14,7 @@
   endif
   if(penalty)
     SetObjProperty(item, "#equipped", who.serial);
-    SetDexterityMod(who, GetDexterityMod(who) - penalty);
+    AP_SetStatMod(who, DEXTERITY, AP_GetStatMod(who, DEXTERITY) - penalty);
   endif
   var type := GetObjProperty(item, "type");
   if(!type)
@@ -29,7 +31,7 @@
     "reflect":      val := reflect(who,item);
     "protection":   val := protection(who,item);
     "wizzohat":     val := wizzohat(who,item);
-    "strength":     val := strength(who,item);
+    "strength":     val := ModifyStrength(who,item);
     "invisibility": val := invisibility(who,item);
     default:        val := 1;
   endcase
@@ -37,7 +39,7 @@
   set_critical(0);
 endfunction
 
-function strength(who,item)
+function ModifyStrength(who,item)
   var gain := GetObjProperty(item, "gain");
   if(!gain)
     gain := 5;
@@ -49,9 +51,9 @@
 endfunction
 
 function wizzohat(who,item)
-  SetIntelligenceMod(who, GetIntelligenceMod(who) + 10);
-  SetStrengthMod(who, GetStrengthMod(who) - 5);
-  SetDexterityMod(who, GetDexterityMod(who) - 5);
+  AP_SetStatMod(who, INTELLIGENCE,  AP_GetStatMod(who, INTELLIGENCE) + 10);
+  AP_SetStatMod(who, STRENGTH, AP_GetStatMod(who, STRENGTH) - 5);
+  AP_SetStatMod(who, DEXTERITY, AP_GetStatMod(who, DEXTERITY) - 5);
   SetObjProperty(item, "#equipped", who.serial);
   return 1;
 endfunction
@@ -64,11 +66,11 @@
   var cfg := ReadConfigFile(":combat:itemdesc");
   var attrib := cfg[item.objtype].Attribute;
   case(attrib)
-    "Wrestling": ModifyAttributeTemporaryMod(who, ATTRIBUTEID_WRESTLING,     amt);
-    "Fencing":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_FENCING,       amt);
-    "Archery":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_ARCHERY,       amt);
-    "Swords":    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_SWORDSMANSHIP, amt);
-    "Mace":      ModifyAttributeTemporaryMod(who, ATTRIBUTEID_MACEFIGHTING,  amt);
+    "Wrestling": AP_ModifySkillMod(who, WRESTLING,    amt);
+    "Fencing":  AP_ModifySkillMod(who, FENCING,      amt);
+    "Archery":   AP_ModifySkillMod(who, ARCHERY,      amt);
+    "Swords":   AP_ModifySkillMod(who, SWORDSMANSHIP, amt);
+    "Mace":      AP_ModifySkillMod(who, MACE_FIGHTING, amt);
   endcase
   SetObjProperty(item, "#equipped", who.serial);
   return 1;

Modified: trunk/096/pkg/systems/combat/old/hitScriptInc.inc
===================================================================
--- trunk/096/pkg/systems/combat/old/hitScriptInc.inc	2005-11-02 20:39:33 UTC (rev 847)
+++ trunk/096/pkg/systems/combat/old/hitScriptInc.inc	2005-11-02 20:54:39 UTC (rev 848)
@@ -4,6 +4,6 @@
 include ":attributes:attributes";
 
 function DealDamage(defender, attacker, rawdamage)
-  rawdamage := rawdamage + RandomInt( (GetEffectiveSkill(attacker, 1) ) / 20);
+  rawdamage := rawdamage + RandomInt( (AP_GetSkill(attacker, ANATOMY) ) / 20);
   ApplyRawDamage(defender, rawdamage);
 endfunction
\ No newline at end of file

Modified: trunk/096/pkg/systems/combat/old/unequip.src
===================================================================
--- trunk/096/pkg/systems/combat/old/unequip.src	2005-11-02 20:39:33 UTC (rev 847)
+++ trunk/096/pkg/systems/combat/old/unequip.src	2005-11-02 20:54:39 UTC (rev 848)
@@ -14,7 +14,7 @@
   var penalty := CInt(itemdesc[item.objtype].DexPenalty);
   if(penalty)
     EraseObjProperty(item, "#equipped");
-    SetDexterityMod(who, GetDexterityMod(who) + penalty);
+    AP_SetStatMod(who, DEXTERITY,  AP_GetStatMod(who, DEXTERITY) + penalty);
   endif
   var type := GetObjProperty(item,"type");
   var val := 0;
@@ -25,7 +25,7 @@
     "reflect":      val := reflect(who,item);
     "protection":   val := protection(who,item);
     "wizzohat":     val := wizzohat(who,item);
-    "strength":     val := strength(who,item);
+    "strength":     val := ModifyStrength(who,item);
     "invisibility": val := invisibility(who, item);
     default:        val := 1;
   endcase
@@ -33,15 +33,15 @@
   set_critical(0);
 endprogram
 
-function strength(who,item)
+function ModifyStrength(who,item)
   RemoveMods(who, item);
   return 1;
 endfunction
 
 function wizzohat(who,item)
-  SetIntelligenceMod(who, GetIntelligenceMod(who) - 10);
-  SetStrengthMod(who, GetStrengthMod(who) + 5);
-  SetDexterityMod(who, GetDexterityMod(who) + 5);
+  AP_SetStatMod(who, INTELLIGENCE, AP_GetStatMod(who, INTELLIGENCE) - 10);
+  AP_SetStatMod(who, STRENGTH, AP_GetStatMod(who, STRENGTH) + 5);
+  AP_SetStatMod(who, DEXTERITY,  AP_GetStatMod(who, DEXTERITY) + 5);
   EraseObjProperty(item, "#equipped");
   return 1;
 endfunction
@@ -77,11 +77,11 @@
     var cfg := ReadConfigFile(":combat:itemdesc");
     var attrib := cfg[item.objtype].Attribute;
     case(attrib)
-      "Wrestling": ModifyAttributeTemporaryMod(who, ATTRIBUTEID_WRESTLING,     amt);
-      "Fencing":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_FENCING,       amt);
-      "Archery":   ModifyAttributeTemporaryMod(who, ATTRIBUTEID_ARCHERY,       amt);
-      "Swords":    ModifyAttributeTemporaryMod(who, ATTRIBUTEID_SWORDSMANSHIP, amt);
-      "Mace":      ModifyAttributeTemporaryMod(who, ATTRIBUTEID_MACEFIGHTING,  amt);
+      "Wrestling": AP_ModifySkillMod(who, WRESTLING,     amt);
+      "Fencing":   AP_ModifySkillMod(who, FENCING,       amt);
+      "Archery":   AP_ModifySkillMod(who, ARCHERY,       amt);
+      "Swords":    AP_ModifySkillMod(who, SWORDSMANSHIP, amt);
+      "Mace":      AP_ModifySkillMod(who, MACE_FIGHTING,  amt);
     endcase
     EraseObjProperty(item, "#equipped");
     return 1;

Modified: trunk/096/pkg/systems/combat/old/vortexHit.src
===================================================================
--- trunk/096/pkg/systems/combat/old/vortexHit.src	2005-11-02 20:39:33 UTC (rev 847)
+++ trunk/096/pkg/systems/combat/old/vortexHit.src	2005-11-02 20:54:39 UTC (rev 848)
@@ -15,7 +15,7 @@
 		return;
 	endif
 
-	var dmg := RandomInt(CInt(GetIntelligence(defender) / 10));
+	var dmg := RandomInt(CInt(AP_GetStat(defender, INTELLIGENCE) / 10));
 	
 	if(dmg > 40)
 		dmg := 12;

Modified: trunk/096/pkg/systems/combat/old/wrestlingHitScript.src
===================================================================
--- trunk/096/pkg/systems/combat/old/wrestlingHitScript.src	2005-11-02 20:39:33 UTC (rev 847)
+++ trunk/096/pkg/systems/combat/old/wrestlingHitScript.src	2005-11-02 20:54:39 UTC (rev 848)
@@ -39,7 +39,7 @@
     else
       bd := basedamage;
     endif
-    if(RandomInt(Cint(GetEffectiveSkill(defender, SKILLID_PARRY) / 2)) >= bd)
+    if(RandomInt(Cint(AP_GetSkill(defender, PARRY) / 2)) >= bd)
       armor := shield;
     endif
   endif
@@ -58,7 +58,7 @@
       if(rawdamage < 1)
         rawdamage := 1;
       endif
-      anat := Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20);
+      anat := Cint(AP_GetSkill(attacker, ANATOMY) / 20);
       rawdamage := Cint(rawdamage + anat);
       DealDamage(defender, attacker, rawdamage);
       SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon });
@@ -77,7 +77,7 @@
       if(rawdamage < 1)
         rawdamage := 1;
       endif
-      anat := Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20);
+      anat := Cint(AP_GetSkill(attacker, ANATOMY) / 20);
       rawdamage := Cint(rawdamage + anat);
       DealDamage(defender, attacker, rawdamage);
       SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon });
@@ -100,7 +100,7 @@
     if(rawdamage < 1)
       rawdamage := 1;
     endif
-    anat := Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20);
+    anat := Cint(AP_GetSkill(attacker, ANATOMY) / 20);
     rawdamage := Cint(rawdamage + anat);
     DealDamage(defender, attacker, rawdamage);
     SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon});



From austin at berlios.de  Wed Nov  2 22:09:08 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Wed, 2 Nov 2005 22:09:08 +0100
Subject: [Poldistro-svn] r849 - in trunk/096: pkg/systems/combat/old pkg/systems/housing pkg/systems/spellcasting scripts/items scripts/misc
Message-ID: <200511022109.jA2L98R0029509@sheep.berlios.de>

Author: austin
Date: 2005-11-02 22:09:07 +0100 (Wed, 02 Nov 2005)
New Revision: 849

Removed:
   trunk/096/pkg/systems/combat/old/mainHitScript.src
   trunk/096/scripts/items/dungTele.src
   trunk/096/scripts/items/makeDTele.src
Modified:
   trunk/096/pkg/systems/combat/old/maceHit.src
   trunk/096/pkg/systems/combat/old/poisonHit.src
   trunk/096/pkg/systems/housing/signControl.src
   trunk/096/pkg/systems/spellcasting/spellcast.src
   trunk/096/pkg/systems/spellcasting/spellcastFunctions.inc
   trunk/096/scripts/items/moongate.src
   trunk/096/scripts/items/pickLock.src
   trunk/096/scripts/misc/demod.src
   trunk/096/scripts/misc/unmod.src
Log:
Last of the attribute updates!!!

I dont guarantee everything works though

There is a lot of redundant code to delete too let me tell you.

Modified: trunk/096/pkg/systems/combat/old/maceHit.src
===================================================================
--- trunk/096/pkg/systems/combat/old/maceHit.src	2005-11-02 20:54:39 UTC (rev 848)
+++ trunk/096/pkg/systems/combat/old/maceHit.src	2005-11-02 21:09:07 UTC (rev 849)
@@ -21,10 +21,10 @@
     endif
   endif
   var sdr := RandomInt(3) + 3;
-  if(GetStamina(defender) >= sdr)
-    SetStamina(defender, GetStamina(defender) - sdr);
+  if(AP_GetVital(defender, STAMINA) >= sdr)
+    AP_SetVital(defender, STAMINA, AP_GetVital(defender, STAMINA) - sdr);
   else
-    SetStamina(defender, 0);
+    AP_SetVital(defender, STAMINA, 0);
   endif
 endprogram
 

Deleted: trunk/096/pkg/systems/combat/old/mainHitScript.src
===================================================================
--- trunk/096/pkg/systems/combat/old/mainHitScript.src	2005-11-02 20:54:39 UTC (rev 848)
+++ trunk/096/pkg/systems/combat/old/mainHitScript.src	2005-11-02 21:09:07 UTC (rev 849)
@@ -1,120 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-include "hitScriptInc";
-
-var npccfgfile := ReadConfigFile("::npcdesc");
-
-program MainHitScript(attacker, defender, weapon, armor, basedamage, rawdamage)
-  if(defender == attacker)
-    SendSysMessage(attacker, "No cheating!");
-    ApplyRawDamage(attacker, 1000);
-    return;
-  endif
-  if((defender.npctemplate == "townguard") or (defender.npctemplate == "playervendor"))
-    ApplyRawDamage(attacker, 1000);
-    return;
-  endif
-  if((attacker.npctemplate == "townguard") or (attacker.npctemplate == "playervendor"))
-    ApplyRawDamage(defender, 1000);
-    return;
-  endif
-  if(defender.isA(POLCLASS_NPC))
-    var damagedsound := CInt(npccfgfile[defender.npctemplate].damagedsound);
-    if(damagedsound)
-      PlaySoundEffect(defender, damagedsound);
-    endif
-    PerformAction(defender, 0xa);
-    basedamage := basedamage * 2;
-    rawdamage := rawdamage * 2;
-  else
-    if(attacker.acctname && defender.acctname)
-      basedamage := basedamage / 2;
-      rawdamage := rawdamage / 2;
-    endif
-  endif
-  if(attacker.npctemplate == "employee")
-    basedamage := basedamage / 2;
-    rawdamage := rawdamage / 2;
-  endif
-  SetObjProperty(defender, "LastHit", {attacker.name, attacker.serial, weapon.name });
-  var shield := GetEquipmentByLayer(defender, 2);
-  if(shield)
-    var bd;
-    if(basedamage > 100)
-      bd := 100;
-    else
-      bd := basedamage;
-    endif
-    if(RandomInt(Cint(GetEffectiveSkill(defender, SKILLID_PARRY) / 2)) >= bd)
-      armor := shield;
-    endif
-  endif
-  var weaponhit := GetObjProperty(weapon, "OnHit");
-  if(weapon.hp > weapon.maxhp)
-    DestroyItem(weapon);
-    rawdamage := 0;
-  endif
-  var armorhit;
-  if(armor == 0)
-    armorhit := GetObjProperty(defender, "ArmorHit");
-  else
-    armorhit := GetObjProperty(armor, "ArmorHit");
-  endif
-  if(!weaponhit)
-    if(!armorhit)
-      run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-      rawdamage := GetObjProperty(defender, "TempDamage");
-      if(GetObjProperty(weapon, "SilverHit"))
-        run_script_to_completion("silverHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-        rawdamage := GetObjProperty(defender, "TempDamage");
-      endif
-      rawdamage := Cint(rawdamage + Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20));
-      if(rawdamage < 1)
-        rawdamage := 1;
-      endif
-      DealDamage(defender, attacker, rawdamage);
-      return;
-    else
-      SetObjProperty(defender, "TempDamage", rawdamage);
-      foreach x in armorhit
-        Detach();
-        run_script_to_completion(x, { attacker, defender, weapon, armor, basedamage, rawdamage } );
-        rawdamage := CInt(GetObjProperty(defender, "TempDamage") );
-      endforeach
-      run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-      rawdamage := GetObjProperty(defender, "TempDamage");
-      EraseObjProperty(defender, "TempDamage");
-      if(GetObjProperty(weapon, "SilverHit"))
-        run_script_to_completion("silverHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-        rawdamage := GetObjProperty(defender, "TempDamage");
-      endif
-      rawdamage := Cint(rawdamage + Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20));
-      if(rawdamage < 1)
-        rawdamage := 1;
-      endif
-      DealDamage(defender, attacker, rawdamage);
-      return;
-    endif
-  else
-    SetObjProperty(defender, "TempDamage", rawdamage);
-    foreach x in weaponhit
-      Detach();
-      run_script_to_completion(CStr(x), { attacker, defender, weapon, armor, basedamage, rawdamage } );
-      rawdamage := GetObjProperty(defender, "TempDamage");
-    endforeach
-    EraseObjProperty(defender, "TempDamage");
-    run_script_to_completion("reactiveArmorHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-    rawdamage := GetObjProperty(defender, "TempDamage");
-    if(GetObjProperty(weapon, "SilverHit"))
-      run_script_to_completion("silverHit", { attacker, defender, weapon, armor, basedamage, rawdamage } );
-      rawdamage := GetObjProperty(defender, "TempDamage");
-    endif
-    rawdamage := Cint(rawdamage + Cint(GetEffectiveSkill(attacker, SKILLID_ANATOMY) / 20));
-    if(rawdamage < 1)
-      rawdamage := 1;
-    endif
-    DealDamage(defender, attacker, rawdamage);
-    return;
-  endif
-endprogram

Modified: trunk/096/pkg/systems/combat/old/poisonHit.src
===================================================================
--- trunk/096/pkg/systems/combat/old/poisonHit.src	2005-11-02 20:54:39 UTC (rev 848)
+++ trunk/096/pkg/systems/combat/old/poisonHit.src	2005-11-02 21:09:07 UTC (rev 849)
@@ -35,7 +35,7 @@
     duration := duration - 1;
     SetObjProperty(weapon, "d", duration);
     var level := GetObjProperty(weapon, "poison_level");
-    if(CheckSkill(attacker, SKILLID_POISONING, 20, 20))
+    if( SkillCheck(attacker, POISONING, 20) >0)
       foreach mobile in ListMobilesInLineOfSight(defender, 8)
         if(mobile != defender)
           PrintTextAbovePrivate(defender, defender.name + " has been poisoned!", mobile);

Modified: trunk/096/pkg/systems/housing/signControl.src
===================================================================
--- trunk/096/pkg/systems/housing/signControl.src	2005-11-02 20:54:39 UTC (rev 848)
+++ trunk/096/pkg/systems/housing/signControl.src	2005-11-02 21:09:07 UTC (rev 849)
@@ -104,7 +104,7 @@
     if (!idiot)
       SendSysMessage(who, "Cancelled.");
       return;
-    elseif (GetMana(idiot) == error)
+    elseif (AP_GetVital(idiot, MANA) == error)
       SendSysMessage(who,"You cannot eject items.");
       return;
     endif
@@ -467,7 +467,7 @@
   var holder := 0;
   foreach thing in lists
     foreach thing in ListObjectsInBox(thing[1], thing[2], thing[3], thing[4], thing[5],thing[6], house.realm)
-      if((GetStrength(thing)) and (thing.hidden))
+      if((AP_GetStat(thing, STRENGTH)) and (thing.hidden))
         thing.hidden := 0;
         holder := holder + 1;
       endif

Modified: trunk/096/pkg/systems/spellcasting/spellcast.src
===================================================================
--- trunk/096/pkg/systems/spellcasting/spellcast.src	2005-11-02 20:54:39 UTC (rev 848)
+++ trunk/096/pkg/systems/spellcasting/spellcast.src	2005-11-02 21:09:07 UTC (rev 849)
@@ -28,11 +28,11 @@
   var castSkill;
   var circlecfg := ReadConfigFile(":*:magiccircles");
   if (spellid < 101)
-    castSkill := SKILLID_MAGERY;
+    castSkill := MAGERY;
   elseif (spellid < 201)
-    castSkill := SKILLID_NECROMANCY;
+    castSkill := NECROMANCY;
   elseif (spellid < 301)
-    castSkill := SKILLID_CHIVALRY;
+    castSkill := CHIVALRY;
   endif   
   EraseObjProperty(who, "IsMeditating");
   EraseObjProperty(who, "HealTimer");
@@ -52,7 +52,7 @@
 
   // Record starting conditions- if the caster is damaged or moves
   // we can choose to interrupt the spell
-  var starthp := GetHp(who);
+  var starthp := AP_GetVital(who, HITS);
   var startx := who.x;
   var starty := who.y;
   var startz := who.z;
@@ -61,9 +61,9 @@
   var animation := spellcfg[spellid].Animation;
   
   if (!animation)
-    animation := ANIM_CAST_DIR;
+    //animation := ANIM_CAST_DIR;
   endif
-  if (requiredMana > GetMana(who))
+  if (requiredMana > AP_GetVital(who, MANA))
 //    who.frozen := 1;
 //    PerformAction(who,animation);
 //    sleepms(1200);
@@ -91,7 +91,7 @@
   var n;
   PrintTextAbove(who, spellcfg[spellid].PowerWords);
   for (n := 1; n <= animReps; n := n+1)
-    if ((starthp > GetHp(who)) && ((RandomInt(99)+1) > (GetEffectiveSkill(who, SKILLID_WRESTLING)/2)))
+    if ((starthp > AP_GetVital(who, HITS)) && ((RandomInt(99)+1) > (AP_GetSkill(who, WRESTLING)/2)))
       SendSysMessage(who,"You lost your concentration.", 3, 40);
       // This costs you no mana or regs... should it?
       PlaySoundEffect(who,0x005d);
@@ -99,7 +99,7 @@
       who.frozen :=0;
       return 0;
     endif
-    PerformAction(who,ANIM_CAST_DIR);
+    //PerformAction(who,ANIM_CAST_DIR);
     if (n < animReps)
       sleepms(750);
     endif
@@ -115,7 +115,7 @@
   
   var diff := circlecfg[circle].Difficulty;
   if (CheckSkill(who,castSkill, diff, 0))
-    if((starthp > GetHp(who)) && ((RandomInt(99)+1) > (GetEffectiveSkill(who, SKILLID_WRESTLING)/2)))
+    if((starthp > AP_GetVital(who, HITS)) && ((RandomInt(99)+1) > (AP_GetSkill(who, WRESTLING)/2)))
       SendSysMessage(who,"You lost your concentration.", 3, 40);
       return 0;
     endif
@@ -134,7 +134,7 @@
       return 0;
     endif
   endif
-  if (GetMana(who) < requiredMana)
+  if (AP_GetVital(who, MANA) < requiredMana)
     SendSysMessage(who, "You do not have sufficient mana to cast this spell.", 3, 40);
   endif
   
@@ -189,7 +189,7 @@
   
   // Now we consume regs and mana, award points, and go home.
   set_critical(1);
-    if (requiredMana > GetMana(who))
+    if (requiredMana > AP_GetVital(who, MANA))
       SendSysMessage(who,"You do not have enough mana to cast that.", 3, 40);
       PlaySoundEffect(who,0x005d);
       PlayObjectCenteredEffect(who, 0x3735,0x0a, 0x1e);
@@ -205,14 +205,14 @@
       endif
       ConsumeReagents(who, spellid);    
     endif
-    SetMana(who, GetMana(who) - requiredMana);
+    AP_SetVital(who, MANA, AP_GetVital(who, MANA) - requiredMana);
   set_critical(0);
   if (scroll)
     if (!subtractAmount(scroll, 1))
       return 0;
     endif
   endif
-  AwardRawSkillPoints(who, castSkill, getPointValue(who, (circlecfg[circle].PointValue), (spellcfg[spellid].Difficulty), castSkill));
+  //AwardRawSkillPoints(who, castSkill, getPointValue(who, (circlecfg[circle].PointValue), (spellcfg[spellid].Difficulty), castSkill));
   var parms := struct;
   parms.+caster;
   parms.+castOn;

Modified: trunk/096/pkg/systems/spellcasting/spellcastFunctions.inc
===================================================================
--- trunk/096/pkg/systems/spellcasting/spellcastFunctions.inc	2005-11-02 20:54:39 UTC (rev 848)
+++ trunk/096/pkg/systems/spellcasting/spellcastFunctions.inc	2005-11-02 21:09:07 UTC (rev 849)
@@ -1,4 +1,7 @@
+use uo;
 
+include ":attributes:attributes";
+
 function mobspellcast(me, circle)
   var diff, points, umana;
   // replace case with cfg pulls
@@ -12,12 +15,12 @@
     7:   diff := 85;     points := 190;    umana :=  40;
     8:   diff := 95;     points := 210;    umana :=  50;
   endcase
-  if(umana > GetMana(me))
+  if(umana > AP_GetVital(me, MANA))
     return 0;
   endif
   if(CheckHands(me))
-    if(CheckSkill(me, SKILLID_MAGERY, (diff - 10), points))
-      SetMana(me, GetMana(me)-umana);
+    if( SkillCheck(me, MAGERY, (diff - 10)) > 0 )
+      AP_SetVital(me, MANA, AP_GetVital(me, MANA)-umana);
       return 1;
     else
       return 0;
@@ -48,7 +51,7 @@
 // challenging it is to the caster
 // I'm not convinced all of it is necessary, but it was in the old system, so here it is.
 function getPointValue(caster, points, diff, skill)
-  skill := GetEffectiveSkill(caster, skill);
+  skill := AP_GetSkill(caster, skill);
   if (skill > (diff - 20))
     if ((skill - diff) <= 5)
       return points;

Deleted: trunk/096/scripts/items/dungTele.src
===================================================================
--- trunk/096/scripts/items/dungTele.src	2005-11-02 20:54:39 UTC (rev 848)
+++ trunk/096/scripts/items/dungTele.src	2005-11-02 21:09:07 UTC (rev 849)
@@ -1,37 +0,0 @@
-use os;
-use uo;
-
-include "include/client";
-include ":attributes:attributes";
-
-program walk_on_moongate(mobile, gate)
-  if((mobile.npctemplate) && (mobile.script != "employed") && (mobile.script != "tamed") && (mobile.script != "escortee"))
-    return;
-  endif
-  var magery := CInt(GetObjProperty(gate,"magery"));
-  if((magery) && (mobile.acctname))
-    if(GetEffectiveSkill(mobile, SKILLID_MAGERY) < magery)
-      SendSysMessage(mobile,"Your knowledge of the arcane arts is too low to traverse this gate.");
-      return;
-    endif
-  endif
-  set_critical(1);
-  if(GetObjProperty(mobile, "#justgated"))
-	return;
-  endif
-  var x, y, z;
-  x := GetObjProperty( gate, "DestX" );
-  y := GetObjProperty( gate, "DestY" );
-  z := GetObjProperty( gate, "DestZ" );
-  foreach critter in ListMobilesNearLocation( gate.x, gate.y, gate.z, 8, gate.realm);
-    if(((critter.script == "employed") && (CInt(GetObjProperty(critter, "master")) == mobile.serial)) || ((critter.script == "escortee") && (CInt(GetObjProperty(critter, "Escortee")) == mobile.serial)) || ((critter.script == "tamed") && (CInt(GetObjProperty(critter, "master")) == mobile.serial)))
-      SetObjProperty(critter, "Pause", 1);
-      MoveCharacterToLocation( critter, gate.x, gate.y, gate.z, MOVECHAR_FORCELOCATION);
-      EraseObjProperty(critter, "Pause");
-    endif
-  endforeach
-  SetObjProperty(mobile,"#justgated",1);
-  MoveCharacterToLocation(mobile, x, y, z );
-  sleep(1);
-  EraseObjProperty(mobile,"#justgated");
-endprogram
\ No newline at end of file

Deleted: trunk/096/scripts/items/makeDTele.src
===================================================================
--- trunk/096/scripts/items/makeDTele.src	2005-11-02 20:54:39 UTC (rev 848)
+++ trunk/096/scripts/items/makeDTele.src	2005-11-02 21:09:07 UTC (rev 849)
@@ -1,34 +0,0 @@
-use os;
-use uo;
-
-include "include/client";
-include ":attributes:attributes";
-
-program walk_on_moongate( mobile, gate )
-  var magery := CInt(GetObjProperty(gate,"magery"));
-  if((magery) && (mobile.acctname))
-    if(GetEffectiveSkill(mobile, SKILLID_MAGERY) < magery)
-      SendSysMessage(mobile,"Your knowledge of the arcane arts is too low to traverse this gate.");
-      return;
-    endif
-  endif
-  set_critical(1);
-  if(GetObjProperty(mobile,"#justgated") )
-	return;
-  endif
-  var x, y, z;
-  x := GetObjProperty( gate, "DestX" );
-  y := GetObjProperty( gate, "DestY" );
-  z := GetObjProperty( gate, "DestZ" );
-  foreach critter in ListMobilesNearLocation( gate.x, gate.y, gate.z, 8, gate.realm);
-    if(((critter.script == "employed") && (CInt(GetObjProperty(critter, "master")) == mobile.serial)) || ((critter.script == "escortee") && (CInt(GetObjProperty(critter, "Escortee")) == mobile.serial)) || ((critter.script == "tamed") && (CInt(GetObjProperty(critter, "master")) == mobile.serial)))
-      SetObjProperty(critter, "Pause", 1);
-      MoveCharacterToLocation( critter, gate.x, gate.y, gate.z, MOVECHAR_FORCELOCATION);
-      EraseObjProperty(critter, "Pause");
-    endif
-  endforeach
-  SetObjProperty(mobile,"#justgated",1);
-  MoveCharacterToLocation(mobile, x, y, z );
-  sleep(1);
-  EraseObjProperty(mobile,"#justgated");
-endprogram
\ No newline at end of file

Modified: trunk/096/scripts/items/moongate.src
===================================================================
--- trunk/096/scripts/items/moongate.src	2005-11-02 20:54:39 UTC (rev 848)
+++ trunk/096/scripts/items/moongate.src	2005-11-02 21:09:07 UTC (rev 849)
@@ -10,7 +10,7 @@
   endif
   var magery := CInt(GetObjProperty(gate,"magery"));
   if((magery) && (mobile.acctname))
-    if(GetEffectiveSkill(mobile, SKILLID_MAGERY) < magery)
+    if(AP_GetSkill(mobile, MAGERY) < magery)
       SendSysMessage(mobile,"Your knowledge of the arcane arts is too low to traverse this gate.");
       return;
     endif

Modified: trunk/096/scripts/items/pickLock.src
===================================================================
--- trunk/096/scripts/items/pickLock.src	2005-11-02 20:54:39 UTC (rev 848)
+++ trunk/096/scripts/items/pickLock.src	2005-11-02 21:09:07 UTC (rev 849)
@@ -4,8 +4,8 @@
 
 include "include/client";
 include "include/sound";
+include ":attributes:attributes";
 
-
 program picklock(who, lockpick)
 	EraseObjProperty(who, "IsMeditating");
 	EraseObjProperty(who, "HealTimer");
@@ -55,7 +55,7 @@
 	endif
 	PlaySoundEffect(me, SFX_242);
   sleep(1);
-  if(CheckSkill(me, SKILLID_LOCKPICKING, diff,(diff * 2)))
+  if(CheckSkill(me, LOCKPICKING, diff,(diff * 2)))
     PrintTextAbovePrivate(chest,"*Unlocked!*",me);
     EraseObjProperty(chest, "MLockPickDiff");
     chest.locked := 0;
@@ -66,7 +66,7 @@
     else
       diff := diff -10;
     endif
-    if(!CheckSkill(me,SKILLID_LOCKPICKING,diff,0))
+    if(!CheckSkill(me,LOCKPICKING,diff,0))
       PlaySoundEffect(chest,0xef);
       SendSysMessage(me,"Your pick breaks!");
       SubtractAmount(lockpick,1);
@@ -83,7 +83,7 @@
   endif
   PlaySoundEffect(me, SFX_242);
   sleep(1);
-  if(CheckSkill(me, SKILLID_LOCKPICKING, diff,(diff * 2)))
+  if( SkillCheck(me, LOCKPICKING, diff) > 0 )
     PrintTextAbovePrivate(chest,"*Unlocked!*",me);
   else
     PrintTextAbovePrivate(chest,"You fail to pick the lock.",me);
@@ -92,7 +92,7 @@
     else
       diff := diff -10;
     endif
-    if(!CheckSkill(me,SKILLID_LOCKPICKING,diff,0))
+    if( SkillCheck(me,LOCKPICKING,diff) < 0 )
       PlaySoundEffect(chest,0xef);
       SendSysMessage(me,"Your pick breaks!");
       SubtractAmount(lockpick,1);
@@ -116,7 +116,7 @@
   PlaySoundEffect(me, SFX_242);
   sleep(1);
   var diff :=(lvl * 20)+10;
-  if(CheckSkill(me,SKILLID_LOCKPICKING,diff,(diff * 2)))
+  if(CheckSkill(me,LOCKPICKING,diff,(diff * 2)))
     PlaySoundEffect(chest,SFX_200);
     PrintTextAbovePrivate(chest,"*Unlocked!*",me);
     chest.locked := 0;
@@ -127,7 +127,7 @@
     else
       diff := diff -10;
     endif
-    if(!CheckSkill(me,SKILLID_LOCKPICKING,diff,0))
+    if(!CheckSkill(me,LOCKPICKING,diff,0))
       PlaySoundEffect(chest,0xef);
       SendSysMessage(me,"Your pick breaks!");
       SubtractAmount(lockpick,1);

Modified: trunk/096/scripts/misc/demod.src
===================================================================
--- trunk/096/scripts/misc/demod.src	2005-11-02 20:54:39 UTC (rev 848)
+++ trunk/096/scripts/misc/demod.src	2005-11-02 21:09:07 UTC (rev 849)
@@ -19,9 +19,9 @@
     who := SystemFindObjectBySerial(serial, SYSFIND_SEARCH_OFFLINE_MOBILES);
   endif
   case(mod)
-    "str": 	SetStrengthMod(who, GetStrengthMod(who) - amt);
-    "dex": 	SetDexterityMod(who, GetDexterityMod(who) - amt);
-    "int": 	SetIntelligenceMod(who, GetIntelligenceMod(who) - amt);
+    "str": 	AP_SetStatMod(who, STRENGTH, AP_GetStatMod(who, STRENGTH) - amt);
+    "dex": 	AP_SetStatMod(who, DEXTERITY, AP_GetStatMod(who, DEXTERITY) - amt);
+    "int": 	AP_SetStatMod(who, INTELLIGENCE, AP_GetStatMod(who, DEXTERITY) - amt);
     "ar" : 	who.ar_mod           := who.ar_mod - amt;
     "p"  : 	who.frozen           := 0;
             who.paralyzed        := 0;

Modified: trunk/096/scripts/misc/unmod.src
===================================================================
--- trunk/096/scripts/misc/unmod.src	2005-11-02 20:54:39 UTC (rev 848)
+++ trunk/096/scripts/misc/unmod.src	2005-11-02 21:09:07 UTC (rev 849)
@@ -17,9 +17,9 @@
     who := SystemFindObjectBySerial(serial, SYSFIND_SEARCH_OFFLINE_MOBILES);
   endif
   case(mod)
-    "str": SetStrengthMod(who, GetStrengthMod(who) - amt);
-    "dex": SetDexterityMod(who, GetDexterityMod(who) - amt);
-    "int": SetIntelligenceMod(who, GetIntelligenceMod(who) - amt);
+    "str": 	AP_SetStatMod(who, STRENGTH, AP_GetStatMod(who, STRENGTH) - amt);
+    "dex": 	AP_SetStatMod(who, DEXTERITY, AP_GetStatMod(who, DEXTERITY) - amt);
+    "int": 	AP_SetStatMod(who, INTELLIGENCE, AP_GetStatMod(who, DEXTERITY) - amt);
     "ar":  who.ar_mod := who.ar_mod - amt;
     "p" :  who.setParalyzed(0);
   endcase



From austin at berlios.de  Thu Nov  3 03:20:46 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 03:20:46 +0100
Subject: [Poldistro-svn] r850 - in trunk/096/scripts: include misc
Message-ID: <200511030220.jA32KkZP023274@sheep.berlios.de>

Author: austin
Date: 2005-11-03 03:20:29 +0100 (Thu, 03 Nov 2005)
New Revision: 850

Added:
   trunk/096/scripts/include/equipment.inc
   trunk/096/scripts/misc/equipTest.src
   trunk/096/scripts/misc/unequipTest.src
Log:
Equipment system.
Used for setting and removing attribute modifier values on a piece of equipment.inc

Used for modifying modifiers when a mobile equips and un-equips an item.



Added: trunk/096/scripts/include/equipment.inc
===================================================================
--- trunk/096/scripts/include/equipment.inc	2005-11-02 21:09:07 UTC (rev 849)
+++ trunk/096/scripts/include/equipment.inc	2005-11-03 02:20:29 UTC (rev 850)
@@ -0,0 +1,224 @@
+/*
+ * $Id$
+ *
+ * Purpose
+ * Allows modifiers to be easily set and removed.
+ * Supports itemdesc.cfg modifiers and custom modifiers.
+ *
+ * Note:
+ * AP_GetStatMod() and AP_GetSkillMod()
+ * Will work on skills as well. They're more-so formalities.
+ * Mostly we expect objects to edit stats so that is why that function name
+ * was chosen to be used in this script.
+ *
+ */
+
+use uo;
+use cfgfile;
+
+include ":attributes:attributes";
+
+CONST	EQUIP_ITEMDESC_MODS	:= 0x1;
+CONST	EQUIP_CUSTOM_MODS	:= 0x2;
+CONST	EQUIP_BOTH_MODS		:= 0x3;
+CONST	EQUIP_CSTM_OR_ITEMDESC	:= 0x4;
+
+/* 
+ * GetEquipmentModifiers(item, flags:=EQUIP_CSTM_OR_ITEMDESC)
+ *
+ * Purpose
+ * Retrieves the attribute modifiers for an item.
+ *
+ * Parameters
+ * item:	Item to retrieve modifier information for.
+ * flags:	Where to retrieve the modifiers from.
+ *		EQUIP_ITEMDESC_MODS	- Retrieve modifiers from the item's itemdesc.cfg entry.
+ *		EQUIP_CUSTOM_MODS	- Retrieve custom modifiers set on the item.
+ *		EQUIP_ALL_MODS		- Merge dictionaries and use them all.
+ *		EQUIP_CUSTM_OR_ITEMDESC	- Uses custom modifiers. If none exist, uses itemdesc.cfg entries.
+ *
+ * Return value
+ * Returns a dictionary.
+ *
+ */
+function GetEquipmentModifiers(item, flags:=EQUIP_CSTM_OR_ITEMDESC)
+	var cstm_mods;
+	if ( flags & EQUIP_CUSTOM_MODS || flags & EQUIP_CSTM_OR_ITEMDESC )
+		cstm_mods := GetObjProperty(item, "AttribMods");
+		if ( Lower(TypeOf(cstm_mods)) != "dictionary" )
+			cstm_mods := dictionary;
+		endif
+		
+		if ( flags & EQUIP_CSTM_OR_ITEMDESC )
+			// Custom mods found, so don't use itemdesc.cfg ones.
+			return cstm_mods;
+		endif
+	endif
+	
+	var itemdesc_mods;
+	if ( flags & EQUIP_ITEMDESC_MODS || flags & EQUIP_CSTM_OR_ITEMDESC )
+		var item_cfg := ReadConfigFile(":*:itemdesc");
+		item_cfg := item_cfg[item.objtype];
+		itemdesc_mods := GetConfigStringDictionary(item_cfg, "AttribMod");
+	endif
+	
+	if ( flags & EQUIP_BOTH_MODS )
+		// Note: Custom mods override itemdesc.cfg ones here.
+		foreach modifier in ( cstm_mods )
+			modifier := modifier; // So the compiler does not issue a warning.
+			itemdesc_mods.Insert(_modifier_iter, modifier);
+			sleepms(2);
+		endforeach
+	endif
+	
+	if ( itemdesc_mods.Size() > 0 )
+		return itemdesc_mods;
+	else
+		return cstm_mods;
+	endif
+endfunction
+	
+/*
+ * AddModifierToEquipment(item, attrib_name, modifier)
+ *
+ * Purpose
+ * Adds a custom modifier to a piece of equipment.
+ * Useful for making an item magic and as a result effects
+ * attributes when equipped / unequipped.
+ * 
+ * Parameters
+ * item:	Item to set the attribute modifier on.
+ * attrib_name:	Name of the attribute to modify when equipped / un-equipped.
+ * modifier:	Amount to raise or lower the attribute.
+ * 
+ * Return value
+ * Returns 1 on success
+ * Returns error on failure.
+ */
+function AddModifierToEquipment(item, attrib_name, modifier)
+	if ( !item.IsA(POLCLASS_EQUIPMENT) )
+		return error{"errortext":="That is not a member of the equipment class."};
+	endif
+	
+	var cstm_mods := GetObjProperty(item, "AttribMods");
+	if ( Lower(TypeOf(cstm_mods)) != "dictionary" )
+		cstm_mods := dictionary;
+	endif
+	
+	modifier := CDbl(modifier);
+	if ( modifier == 0.0 )
+		return error{"errortext":="No modifier value was set."};
+	elseif ( !AP_GetAttributeCfgElem(attrib_name) )
+		return error{"errortext":="That is not a valid attribute name."};
+	endif
+	
+	cstm_mods[attrib_name] := modifier;
+	
+	return SetObjProperty(item, "AttribMods", cstm_mods);
+endfunction
+
+/*
+ * RemoveModifierFromEquipment(item, attrib_name)
+ *
+ * Purpose
+ * Removes a custom modifier from a piece of equipment.
+ * Useful for removing effects that it places on
+ * attributes when equipped / unequipped.
+ * 
+ * Parameters
+ * item:	Item to remove the attribute modifier from.
+ * attrib_name:	Name of the attribute modifier to remove.
+ * 
+ * Return value
+ * Returns 1 on success
+ * Returns error on failure.
+ */
+function RemoveModifierFromEquipment(item, attrib_name)
+	if ( !item.IsA(POLCLASS_EQUIPMENT) )
+		return error{"errortext":="That is not a member of the equipment class."};
+	endif
+	
+	var cstm_mods := GetObjProperty(item, "AttribMods");
+	cstm_mods.Erase(attrib_name);
+	
+	if ( cstm_mods > 0 )
+		return SetObjProperty(item, "AttribMods", cstm_mods);
+	else
+		// No point in keeping an empty dictionary cprop.
+		return EraseObjProperty(item, "AttribMods");
+	endif
+endfunction
+
+/* 
+ * ApplyEquipmentMods(mobile, item)
+ *
+ * Purpose
+ * Applies skill and stat mods onto a mobile equipping something.
+ *
+ * Parameters
+ * mobile:	Mobile equipping the item.
+ * item:	Item being equipped.
+ * flags:	Where to retrieve the modifiers from.
+ *		EQUIP_ITEMDESC_MODS	- Retrieve modifiers from the item's itemdesc.cfg entry.
+ *		EQUIP_CUSTOM_MODS	- Retrieve custom modifiers set on the item.
+ *		EQUIP_ALL_MODS		- Merge dictionaries and use them all.
+ *		EQUIP_CUSTM_OR_ITEMDESC	- Uses custom modifiers. If none exist, uses itemdesc.cfg entries.
+ *
+ * Return value
+ * Returns 1
+ *
+ */
+function ApplyEquipmentMods(mobile, item, flags := EQUIP_CSTM_OR_ITEMDESC)
+	var attrib_mods := GetEquipmentModifiers(item, flags);
+			
+	foreach modifier in ( attrib_mods )
+		modifier := modifier; // Stops compiler warnings.
+		var attrib_name := _modifier_iter;
+		var amount := CDbl(modifier);
+		
+		var cur_val := AP_GetStatMod(mobile, attrib_name);
+		var new_val := cur_val + amount;
+		
+		//SendSysMessage(mobile, "Attrib["+attrib+"] Amount["+new_val+"]");
+		AP_SetStatMod(mobile, attrib_name, new_val);
+	endforeach
+	
+	return 1;
+endfunction
+
+/* 
+ * RemoveEquipmentMods(mobile, item)
+ *
+ * Purpose
+ * Removes skill and stat mods onto a mobile equipping something.
+ *
+ * Parameters
+ * mobile:	Mobile un-equipping the item.
+ * item:	Item being un-equipped.
+ * flags:	Where to retrieve the modifiers from.
+ *		EQUIP_ITEMDESC_MODS	- Retrieve modifiers from the item's itemdesc.cfg entry.
+ *		EQUIP_CUSTOM_MODS	- Retrieve custom modifiers set on the item.
+ *		EQUIP_ALL_MODS		- Merge dictionaries and use them all.
+ *		EQUIP_CUSTM_OR_ITEMDESC	- Uses custom modifiers. If none exist, uses itemdesc.cfg entries.
+ *
+ * Return value
+ * Returns 1
+ *
+ */
+function RemoveEquipmentMods(mobile, item, flags:=EQUIP_CSTM_OR_ITEMDESC)
+	var attrib_mods := GetEquipmentModifiers(item, flags);
+	
+	foreach modifier in ( attrib_mods )
+		modifier := modifier; // Stops compiler warnings.
+		var attrib_name := _modifier_iter;
+		var amount := CDbl(modifier);
+		
+		var cur_val := AP_GetStatMod(mobile, attrib_name);
+		var new_val := cur_val - amount;
+		
+		//SendSysMessage(mobile, "Attrib["+attrib+"] Amount["+amount+"]");
+		AP_SetStatMod(mobile, attrib_name, new_val);
+	endforeach
+	
+	return 1;
+endfunction

Added: trunk/096/scripts/misc/equipTest.src
===================================================================
--- trunk/096/scripts/misc/equipTest.src	2005-11-02 21:09:07 UTC (rev 849)
+++ trunk/096/scripts/misc/equipTest.src	2005-11-03 02:20:29 UTC (rev 850)
@@ -0,0 +1,38 @@
+use uo;
+use os;
+
+include "include/equipment";
+
+program EquipTest(mobile, item, start_up)
+	var retval;
+	
+	if ( start_up )
+		// POL is starting up, yes the mobile can equip it
+		retval := 1;
+	elseif ( mobile.npctemplate )
+		// NPCs can wear anything
+		retval := 1;
+	elseif ( mobile.cmdlevel )
+		// CmdLevel > 0 can equip anything.
+		retval := 1;
+	elseif ( item.isa(POLCLASS_CONTAINER) )	
+		// Makes backpacks always equippable.
+		retval := 1;
+	elseif ( (mobile.frozen) || (mobile.paralyzed) )
+		// Frozen players cant equip stuff
+		SendSysMessage(mobile, "You are unable to move in order to equip that.");
+		retval := 0;
+	else
+		retval := 1;
+	endif
+	
+	if ( retval )
+		SetObjProperty(item, "#EquippedOn", mobile.serial);
+		ApplyEquipmentMods(mobile, item);
+	else
+		// Unable to equip but no reaso was given above. 
+		SendSysMessage(mobile, "Unable to equip ->"+item.desc);
+	endif
+	
+	return retval;
+endprogram

Added: trunk/096/scripts/misc/unequipTest.src
===================================================================
--- trunk/096/scripts/misc/unequipTest.src	2005-11-02 21:09:07 UTC (rev 849)
+++ trunk/096/scripts/misc/unequipTest.src	2005-11-03 02:20:29 UTC (rev 850)
@@ -0,0 +1,19 @@
+use uo;
+use os;
+
+include "include/equipment";
+
+program UnequipTest(mobile, item)
+	if ( mobile.cmdlevel ) 
+		return 1;
+	elseif ( (mobile.frozen) || (mobile.paralyzed))
+		SendSysMessage(mobile, "You are unable to move in order to unequip that.");
+		return 0;
+	elseif ( GetObjProperty(item, "cursed") )
+		return 0;
+	else
+		RemoveEquipmentMods(mobile, item);
+		EraseObjProperty(item, "#EquippedOn");
+		return 1;
+	endif
+endprogram
\ No newline at end of file



From austin at berlios.de  Thu Nov  3 03:46:57 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 03:46:57 +0100
Subject: [Poldistro-svn] r851 - trunk/096/pkg/systems/combat
Message-ID: <200511030246.jA32kvMm017203@sheep.berlios.de>

Author: austin
Date: 2005-11-03 03:46:57 +0100 (Thu, 03 Nov 2005)
New Revision: 851

Modified:
   trunk/096/pkg/systems/combat/itemdesc.cfg
Log:
Updated to have HitScript entries.
Removed equip script entries because the new equipTest and unequipTest.src scripts are implemented.

Modified: trunk/096/pkg/systems/combat/itemdesc.cfg
===================================================================
--- trunk/096/pkg/systems/combat/itemdesc.cfg	2005-11-03 02:20:29 UTC (rev 850)
+++ trunk/096/pkg/systems/combat/itemdesc.cfg	2005-11-03 02:46:57 UTC (rev 851)
@@ -29,8 +29,7 @@
 	HitSound	0x13E
 	MaxHP		1
 	Intrinsic	1
-	controlscript	wrestleControl
-	HitScript	wrestlingHitScript
+	HitScript	mainHitScript
 	SaveOnExit	0
 }
 
@@ -50,10 +49,7 @@
 	MaxHP		35
 	strrequired	10
 	medloss		100
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13CD
@@ -66,10 +62,7 @@
 	MaxHP		35
 	strrequired	10
 	medloss		200
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13C6
@@ -83,10 +76,7 @@
 	MaxHP		35
 	strrequired	10
 	medloss		100
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1DB9
@@ -100,10 +90,7 @@
 	MaxHP		35
 	strrequired	15
 	medloss		400
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13CB
@@ -117,10 +104,7 @@
 	MaxHP		35
 	strrequired	10
 	medloss		200
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13CC
@@ -134,10 +118,7 @@
 	MaxHP		35
 	strrequired	15
 	medloss		300
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 Armor 0x13D3
 {
@@ -150,10 +131,7 @@
 	MaxHP		35
 	strrequired	15
 	medloss		300
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 # STUDDED LEATHER
@@ -168,10 +146,7 @@
 	MaxHP		40
 	strrequired	25
 	medloss		100
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 
 }
 
@@ -186,10 +161,7 @@
 	MaxHP		40
 	strrequired	25
 	medloss		100
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13D4
@@ -203,10 +175,7 @@
 	MaxHP		40
 	strrequired	25
 	medloss		150
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13DA
@@ -220,10 +189,7 @@
 	MaxHP		40
 	strrequired	35
 	medloss		400
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13DB
@@ -237,10 +203,7 @@
 	MaxHP		40
 	strrequired	35
 	medloss		500
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 
 }
 
@@ -261,10 +224,7 @@
 	strrequired	35
 	medloss		100
 	repairable	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 	Cprop		type sranger
 }
 
@@ -282,10 +242,7 @@
 	strrequired	35
 	medloss		100
 	repairable	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 	Cprop		type sranger
 }
 
@@ -303,10 +260,7 @@
 	strrequired	35
 	medloss		150
 	repairable	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 	Cprop		type sranger
 }
 
@@ -324,10 +278,7 @@
 	strrequired	35
 	medloss		400
 	repairable	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 	Cprop		type sranger
 }
 
@@ -345,10 +296,7 @@
 	strrequired	45
 	medloss		500
 	repairable	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 	Cprop		type sranger
 }
 #####################
@@ -366,10 +314,7 @@
 	strrequired	35
 	medloss		500
 	GenderSpecific	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1c04
@@ -386,10 +331,7 @@
 	medloss		nomed
 	DexPenalty	5
 	GenderSpecific	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 
@@ -405,10 +347,7 @@
 	strrequired	15
 	medloss		300
 	GenderSpecific	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1C08
@@ -423,10 +362,7 @@
 	strrequired	10
 	medloss		200
 	GenderSpecific	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1C0A
@@ -441,10 +377,7 @@
 	strrequired	10
 	medloss		300
 	GenderSpecific	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 
 }
 
@@ -460,10 +393,7 @@
 	strrequired	25
 	medloss		400
 	GenderSpecific	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1C00
@@ -478,10 +408,7 @@
 	strrequired	10
 	medloss		200
 	GenderSpecific	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x170B
@@ -495,10 +422,7 @@
 	MaxHP		50
 	dyeable		1
 	medloss		0
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1711
@@ -512,10 +436,7 @@
 	MaxHP		50
 	dyeable		1
 	medloss		0
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 # CHAIN MAIL
@@ -532,10 +453,7 @@
 	strrequired	20
 	repairable	1
 	medloss		1000
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13C0
@@ -551,10 +469,7 @@
 	strrequired	20
 	repairable	1
 	medloss		1000
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13BE
@@ -570,10 +485,7 @@
 	repairable	1
 	medloss		1000
 	DexPenalty	3
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13C3
@@ -588,10 +500,7 @@
 	strrequired	20
 	repairable	1
 	medloss		1000
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13BF
@@ -608,10 +517,7 @@
 	repairable	1
 	medloss		2000
 	DexPenalty	5
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13C4
@@ -627,10 +533,7 @@
 	strrequired	20
 	repairable	1
 	medloss		2000
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 # Plate Helms
@@ -646,10 +549,7 @@
 	strrequired	40
 	repairable	1
 	medloss		1200
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1409
@@ -664,10 +564,7 @@
 	strrequired	40
 	repairable	1
 	medloss		1200
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x140A
@@ -682,10 +579,7 @@
 	strrequired	40
 	repairable	1
 	medloss		1200
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x140B
@@ -700,10 +594,7 @@
 	strrequired	40
 	repairable	1
 	medloss		1200
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x140C
@@ -718,10 +609,7 @@
 	strrequired	10
 	repairable	1
 	medloss		1200
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 
 }
 Armor 0x140D
@@ -736,10 +624,7 @@
 	strrequired	10
 	repairable	1
 	medloss		1200
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x140E
@@ -754,10 +639,7 @@
 	strrequired	40
 	repairable	1
 	medloss		1200
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 Armor 0x140F
 {
@@ -771,10 +653,7 @@
 	strrequired	40
 	repairable	1
 	medloss		1200
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1412
@@ -790,10 +669,7 @@
 	repairable	1
 	DexPenalty	1
 	medloss		1500
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1419
@@ -809,10 +685,7 @@
 	repairable	1
 	DexPenalty	1
 	medloss		1500
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 # SHIELDS
@@ -827,10 +700,7 @@
 	strrequired	20
 	repairable	1
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1B73
@@ -844,10 +714,7 @@
 	strrequired	15
 	repairable	1
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 
 }
 
@@ -862,10 +729,7 @@
 	strrequired	30
 	repairable	1
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 Armor 0x1B75
 {
@@ -878,10 +742,7 @@
 	strrequired	30
 	repairable	1
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1B76
@@ -895,10 +756,7 @@
 	strrequired	30
 	repairable	1
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 
 }
 Armor 0x1B77
@@ -912,10 +770,7 @@
 	strrequired	30
 	repairable	1
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1B78
@@ -929,10 +784,7 @@
 	strrequired	15
 	repairable	1
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1B79
@@ -946,10 +798,7 @@
 	strrequired	15
 	repairable	1
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1B7A
@@ -962,10 +811,7 @@
 	MaxHP		22
 	strrequired	5
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1B7B
@@ -979,10 +825,7 @@
 	strrequired	10
 	repairable	1
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1bc4
@@ -993,10 +836,7 @@
 	MaxHP		110
 	repairable	1
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1bc3
@@ -1007,10 +847,7 @@
 	MaxHP		110
 	repairable	1
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 #RINGMAIL
@@ -1027,10 +864,7 @@
 	repairable	1
 	medloss		1000
 	DexPenalty	2
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13ed
@@ -1046,10 +880,7 @@
 	repairable	1
 	medloss		1000
 	DexPenalty	2
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13ee
@@ -1064,10 +895,7 @@
 	repairable	1
 	medloss		500
 	DexPenalty	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 Armor 0x13ef
 {
@@ -1080,10 +908,7 @@
 	strrequired	20
 	repairable	1
 	medloss		500
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13f0
@@ -1099,10 +924,7 @@
 	repairable	1
 	medloss		700
 	DexPenalty	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13f1
@@ -1118,10 +940,7 @@
 	repairable	1
 	medloss		700
 	DexPenalty	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x13f2
@@ -1137,10 +956,7 @@
 	repairable	1
 	medloss		250
 	DexPenalty	1
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 # PLATE
@@ -1157,10 +973,7 @@
 	repairable	1
 	DexPenalty	8
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 Armor 0x1416
 {
@@ -1175,10 +988,7 @@
 	repairable	1
 	DexPenalty	8
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1410
@@ -1194,10 +1004,7 @@
 	repairable	1
 	DexPenalty	2
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 Armor 0x1417
 {
@@ -1212,10 +1019,7 @@
 	repairable	1
 	DexPenalty	2
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1411
@@ -1231,10 +1035,7 @@
 	repairable	1
 	DexPenalty	6
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 Armor 0x141A
 {
@@ -1249,10 +1050,7 @@
 	repairable	1
 	DexPenalty	6
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1414
@@ -1269,10 +1067,7 @@
 	DexPenalty	2
 	medloss		nomed
 	DexPenalty	2
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 Armor 0x1418
 {
@@ -1288,10 +1083,7 @@
 	DexPenalty	2
 	medloss		nomed
 	DexPenalty	2
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1413
@@ -1307,10 +1099,7 @@
 	repairable	1
 	DexPenalty	1
 	medloss		nomed
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x144e
@@ -1323,10 +1112,7 @@
 	strrequired	40
 	medloss		700
 	DexPenalty	2
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x144f
@@ -1339,10 +1125,7 @@
 	strrequired	40
 	medloss		2000
 	DexPenalty	6
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1450
@@ -1354,10 +1137,7 @@
 	MaxHP		25
 	strrequired	40
 	medloss		500
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1451
@@ -1369,10 +1149,7 @@
 	MaxHP		25
 	strrequired	40
 	medloss		750
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1452
@@ -1385,10 +1162,7 @@
 	strrequired	40
 	medloss		1000
 	DexPenalty	4
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 Armor 0x1f0b
@@ -1399,10 +1173,7 @@
 	Coverage	Head
 	MaxHP		55
 	medloss		500
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
 }
 
 #################
@@ -1428,10 +1199,8 @@
 	repairable	1
 	MinDam		5
 	MaxDam		33
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x13AF
@@ -1445,18 +1214,17 @@
 	HitSound	0x23D
 	MissSound	0x233
 	MaxHP		55
-	Script		:lumberjacking:lumberjack
 	VendorSellsFor	38
 	VendorBuysFor	19
 	strrequired	45
 	repairable	1
 	MinDam		9
 	MaxDam		27
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
 	CProp		OnHit a1:S15::combat:maceHit
+	
+	Script		:lumberjacking:lumberjack
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x13B2
@@ -1482,10 +1250,9 @@
 	MaxDam		41
 	minrange		0
 	maxrange		20
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x0f4f
@@ -1511,10 +1278,9 @@
 	MaxDam		43
 	minrange		0
 	maxrange		20
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x13fd
@@ -1541,10 +1307,9 @@
 	MaxDam		56
 	minrange		0
 	maxrange		20
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x0f49
@@ -1556,7 +1321,6 @@
 	Attribute	Swordsmanship
 	Anim		0x000d
 	MaxHP		65
-	Script		:lumberjacking:lumberjack
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	48
@@ -1566,10 +1330,10 @@
 	repairable	1
 	MinDam		6
 	MaxDam		33
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	DestroyScript	destroy
+	HitScript	mainHitScript
+	Script		:lumberjacking:lumberjack
 }
 
 Weapon 0x0f47
@@ -1581,7 +1345,6 @@
 	Attribute	Swordsmanship
 	Anim		0x000d
 	MaxHP		55
-	Script		:lumberjacking:lumberjack
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	38
@@ -1591,10 +1354,9 @@
 	strrequired	25
 	MinDam		6
 	MaxDam		38
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		:lumberjacking:lumberjack
+	DestroyScript	destroy
 }
 
 Weapon 0x0f4b
@@ -1606,7 +1368,6 @@
 	Attribute	Swordsmanship
 	Anim		0x000d
 	MaxHP		65
-	Script		:lumberjacking:lumberjack
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	32
@@ -1616,10 +1377,9 @@
 	repairable	1
 	MinDam		5
 	MaxDam		35
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		:lumberjacking:lumberjack
+	DestroyScript	destroy
 }
 
 Weapon 0x0f45
@@ -1631,7 +1391,6 @@
 	Attribute	Swordsmanship
 	Anim		0x000d
 	MaxHP		60
-	Script		:lumberjacking:lumberjack
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	38
@@ -1641,10 +1400,10 @@
 	repairable	1
 	MinDam		6
 	MaxDam		33
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		:lumberjacking:lumberjack
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x13fa
@@ -1656,7 +1415,6 @@
 	Attribute	Swordsmanship
 	Anim		0x000d
 	MaxHP		70
-	Script		:lumberjacking:lumberjack
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	32
@@ -1666,10 +1424,10 @@
 	repairable	1
 	MinDam		6
 	MaxDam		38
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		:lumberjacking:lumberjack
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x1442
@@ -1681,7 +1439,6 @@
 	Attribute	Swordsmanship
 	Anim		0x000d
 	MaxHP		50
-	Script		:lumberjacking:lumberjack
 	HitSound	0x23C
 	MissSound	0x23A
 	Anim		0xD
@@ -1692,10 +1449,10 @@
 	repairable	1
 	MinDam		5
 	MaxDam		39
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		:lumberjacking:lumberjack
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x143c
@@ -1707,7 +1464,7 @@
 	Attribute	Macefighting
 	Anim		0x000b
 	MaxHP		50
-	Script		:mining:mining
+	
 	HitSound	0x13C
 	MissSound	0x234
 	VendorSellsFor	31
@@ -1716,10 +1473,10 @@
 	repairable	1
 	MinDam		6
 	MaxDam		33
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		:mining:mining
+	DestroyScript	destroy
+	HitScript	mainHitScript
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -1740,10 +1497,10 @@
 	repairable	1
 	MinDam		8
 	MaxDam		32
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+
+	DestroyScript	destroy
+	HitScript	mainHitScript
+
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -1764,10 +1521,10 @@
 	repairable	1
 	MinDam		7
 	MaxDam		27
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	DestroyScript	destroy
+	HitScript	mainHitScript
+
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -1789,10 +1546,10 @@
 	repairable	1
 	MinDam		8
 	MaxDam		36
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	DestroyScript	destroy
+	HitScript	mainHitScript
+	
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -1813,10 +1570,10 @@
 	repairable	1
 	MinDam		10
 	MaxDam		30
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	DestroyScript	destroy
+	HitScript	mainHitScript
+	
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -1831,7 +1588,6 @@
 	HitSound	0x237
 	MissSound	0x233
 	MaxHP		65
-	Script		:lumberjacking:lumberjack
 	VendorSellsFor	68
 	VendorBuysFor	34
 	TwoHanded	1
@@ -1839,10 +1595,10 @@
 	repairable	1
 	MinDam		5
 	MaxDam		43
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		:lumberjacking:lumberjack
+	HitScript	mainHitScript
+	DestroyScript	destroy
 }
 
 Weapon 0x143e
@@ -1856,7 +1612,6 @@
 	HitSound	0x238
 	MissSound	0x233
 	MaxHP		55
-	Script		:lumberjacking:lumberjack
 	VendorSellsFor	50
 	VendorBuysFor	25
 	TwoHanded	1
@@ -1865,10 +1620,10 @@
 	repairable	1
 	MinDam		5
 	MaxDam		49
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		:lumberjacking:lumberjack
+	HitScript	mainHitScript
+	DestroyScript	destroy
 }
 
 Weapon 0x1402
@@ -1889,10 +1644,9 @@
 	repairable	1
 	MinDam		4
 	MaxDam		32
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x0f63
@@ -1913,10 +1667,9 @@
 	repairable	1
 	MinDam		2
 	MaxDam		36
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x1404
@@ -1936,10 +1689,9 @@
 	repairable	1
 	MinDam		4
 	MaxDam		32
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x0f5e
@@ -1960,10 +1712,9 @@
 	repairable	1
 	MinDam		7
 	MaxDam		31
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x1440
@@ -1984,10 +1735,9 @@
 	repairable	1
 	MinDam		6
 	MaxDam		28
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x0f51
@@ -1999,7 +1749,6 @@
 	Attribute	Fencing
 	Anim		0x000a
 	MaxHP		40
-	Script		bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	33
@@ -2008,10 +1757,10 @@
 	repairable	1
 	MinDam		3
 	MaxDam		15
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		bladed
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x13fe
@@ -2023,7 +1772,6 @@
 	Attribute	Swordsmanship
 	Anim		0x0009
 	MaxHP		60
-	Script		bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	42
@@ -2032,10 +1780,10 @@
 	repairable	1
 	MinDam		5
 	MaxDam		26
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		bladed
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x1401
@@ -2047,7 +1795,6 @@
 	Attribute	Fencing
 	Anim		0x000a
 	MaxHP		60
-	Script		bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	42
@@ -2056,10 +1803,10 @@
 	repairable	1
 	MinDam		3
 	MaxDam		28
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		bladed
+	HitScript	mainHitScript
+	DestroyScript	destroy
 }
 
 Weapon 0x13b5
@@ -2071,7 +1818,6 @@
 	Attribute	Swordsmanship
 	Anim		0x0009
 	MaxHP		50
-	Script		bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	43
@@ -2080,10 +1826,10 @@
 	repairable	1
 	MinDam		4
 	MaxDam		30
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		bladed
+	DestroyScript	destroy
+	HitScript	mainHitScript
 }
 
 Weapon 0x13b9
@@ -2095,7 +1841,6 @@
 	Attribute	Swordsmanship
 	Anim		0x0009
 	MaxHP		50
-	Script		bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	66
@@ -2105,10 +1850,10 @@
 	repairable	1
 	MinDam		8
 	MaxDam		36
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		bladed
+	HitScript	mainHitScript
+	DestroyScript	destroy
 }
 
 Weapon 0x0f43
@@ -2120,7 +1865,6 @@
 	Attribute	Swordsmanship
 	Anim		0x0009
 	MaxHP		55
-	Script		:lumberjacking:lumberjack
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	20
@@ -2129,10 +1873,10 @@
 	repairable	1
 	MinDam		2
 	MaxDam		17
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		:lumberjacking:lumberjack
+	HitScript	mainHitScript
+	DestroyScript	destroy
 }
 
 Weapon 0x0e85
@@ -2144,7 +1888,6 @@
 	Attribute	Macefighting
 	Anim		0x000c
 	MaxHP		45
-	Script		:mining:mining
 	VendorSellsFor	32
 	VendorBuysFor	16
 	TwoHanded	1
@@ -2152,10 +1895,11 @@
 	repairable	1
 	MinDam		1
 	MaxDam		15
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		:mining:mining
+	HitScript	mainHitScript
+	DestroyScript	destroy
+	
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -2168,7 +1912,6 @@
 	Attribute	Swordsmanship
 	Anim		0x0009
 	MaxHP		35
-	Script		bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	21
@@ -2177,10 +1920,10 @@
 	repairable	1
 	MinDam		2
 	MaxDam		14
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		bladed
+	HitScript	mainHitScript
+	DestroyScript	destroy
 }
 
 Weapon 0x0ec2
@@ -2192,7 +1935,6 @@
 	Attribute	Swordsmanship
 	Anim		0x0009
 	MaxHP		40
-	Script		bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	24
@@ -2201,10 +1943,10 @@
 	repairable	1
 	MinDam		2
 	MaxDam		13
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		bladed
+	HitScript	mainHitScript
+	DestroyScript	destroy
 }
 
 Weapon 0x0ec4
@@ -2216,7 +1958,6 @@
 	Attribute	Swordsmanship
 	Anim		0x0009
 	MaxHP		35
-	Script		bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	26
@@ -2225,10 +1966,10 @@
 	repairable	1
 	MinDam		1
 	MaxDam		4
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	Script		bladed
+	HitScript	mainHitScript
+	DestroyScript	destroy
 }
 
 Weapon 0x13b3
@@ -2247,10 +1988,10 @@
 	strrequired	10
 	MinDam		8
 	MaxDam		24
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	HitScript	mainHitScript
+	DestroyScript	destroy
+	
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -2273,10 +2014,10 @@
 	repairable	1
 	MinDam		4
 	MaxDam		16
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	HitScript	mainHitScript
+	DestroyScript	destroy
+	
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -2299,10 +2040,9 @@
 	Anim		0x000d
 	MinDam		8
 	MaxDam		33
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	HitScript	mainHitScript
+	DestroyScript	destroy
 }
 
 Weapon 0x13f9
@@ -2323,10 +2063,9 @@
 	Anim		0x000d
 	MinDam		10
 	MaxDam		30
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	HitScript	mainHitScript
+	DestroyScript	destroy
 }
 
 Weapon 0x0e8a
@@ -2347,17 +2086,15 @@
 	Anim		0x000d
 	MinDam		8
 	MaxDam		43
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	HitScript	mainHitScript
+	DestroyScript	destroy
 }
 
 Weapon 0x0e81
 {
 	Name		ShepherdsCrook
 	desc		shepherd's crook
-	script		:herding:herd
 	Speed		30
 	Damage		3d4
 	Attribute	Macefighting
@@ -2372,10 +2109,10 @@
 	Anim		0x000d
 	MinDam		2
 	MaxDam		8
-	equipscript	equip
-	unequipscript	unequip
-	controlscript	itemControl
-	destroyscript	destroy
+	
+	script		:herding:herd
+	HitScript	mainHitScript
+	DestroyScript	destroy
 }
 ############################
 #-----------------Newbie Equipment-------------------#
@@ -2410,7 +2147,8 @@
 	repairable	0
 	MinDam		1
 	MaxDam		4
-	controlscript	itemControl
+	
+	HitScript	mainHitScript
 }
 
 Weapon 0x988b
@@ -2429,7 +2167,8 @@
 	repairable	0
 	MinDam		1
 	MaxDam		4
-	controlscript	itemControl
+	
+	HitScript	mainHitScript
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -2450,7 +2189,8 @@
 	repairable	0
 	MinDam		1
 	MaxDam		4
-	controlscript	itemControl
+	
+	HitScript	mainHitScript
 }
 
 Weapon 0x9889
@@ -2473,7 +2213,8 @@
 	TwoHanded	1
 	MinDam		1
 	MaxDam		4
-	controlscript	itemControl
+	
+	HitScript	mainHitScript
 }
 
 Weapon 0x13e3
@@ -2485,15 +2226,15 @@
 	Attribute	Macefighting
 	Anim		0x000b
 	MaxHP		60
-	Script		:blacksmithy:makeBlacksmithItems
 	HitSound	0x13C
 	MissSound	0x234
 	VendorSellsFor	24
 	VendorBuysFor	12
-	equipscript	:combat:equip
-	unequipscript	:combat:unequip
-	controlscript	:combat:itemControl
-	destroyscript	:combat:destroy
+	
+	Script		:blacksmithy:makeBlacksmithItems
+	HitScript	mainHitScript
+	DestroyScript	:combat:destroy
+	
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -2506,15 +2247,15 @@
 	Attribute	Macefighting
 	Anim		0x000b
 	MaxHP		60
-	Script		:blacksmithy:makeBlacksmithItems
 	HitSound	0x13C
 	MissSound	0x234
 	VendorSellsFor	24
 	VendorBuysFor	12
-	equipscript	:combat:equip
-	unequipscript	:combat:unequip
-	controlscript	:combat:itemControl
-	destroyscript	:combat:destroy
+	
+	Script		:blacksmithy:makeBlacksmithItems
+	HitScript	mainHitScript
+	DestroyScript	:combat:destroy
+	
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -2526,15 +2267,14 @@
 	Attribute	Macefighting
 	Anim		0x000b
 	MaxHP		80
-	Script		:blacksmithy:makeBlacksmithItems
 	HitSound	0x13C
 	MissSound	0x234
 	VendorSellsFor	36
 	VendorBuysFor	18
-	equipscript	:combat:equip
-	unequipscript	:combat:unequip
-	controlscript	:combat:itemControl
-	destroyscript	:combat:destroy
+	
+	Script		:blacksmithy:makeBlacksmithItems
+	DestroyScript	:combat:destroy
+		
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -2546,15 +2286,15 @@
 	Attribute	Macefighting
 	Anim		0x000b
 	MaxHP		80
-	Script		:blacksmithy:makeBlacksmithItems
 	HitSound	0x13C
 	MissSound	0x234
 	VendorSellsFor	36
 	VendorBuysFor	18
-	equipscript	:combat:equip
-	unequipscript	:combat:unequip
-	controlscript	:combat:itemControl
-	destroyscript	:combat:destroy
+	
+	Script		:blacksmithy:makeBlacksmithItems
+	HitScript	mainHitScript
+	DestroyScript	:combat:destroy
+	
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -2572,7 +2312,8 @@
 	MissSound	0x234
 	VendorSellsFor	20
 	VendorBuysFor	8
-	controlscript	:combat:itemControl
+	
+	HitScript	mainHitScript
 }
 
 Weapon 0xdf3
@@ -2589,7 +2330,8 @@
 	MissSound	0x234
 	VendorSellsFor	20
 	VendorBuysFor	8
-	controlscript	:combat:itemControl
+	
+	HitScript	mainHitScript
 }
 
 Weapon 0xdf4
@@ -2606,7 +2348,8 @@
 	MissSound	0x234
 	VendorSellsFor	20
 	VendorBuysFor	8
-	controlscript	:combat:itemControl
+	
+	HitScript	mainHitScript
 }
 
 Weapon 0xdf5
@@ -2623,5 +2366,6 @@
 	MissSound	0x234
 	VendorSellsFor	20
 	VendorBuysFor	8
-	controlscript	:combat:itemControl
+	
+	HitScript	mainHitScript
 }
\ No newline at end of file



From austin at berlios.de  Thu Nov  3 04:03:26 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 04:03:26 +0100
Subject: [Poldistro-svn] r852 - trunk/096/config
Message-ID: <200511030303.jA333QxO020246@sheep.berlios.de>

Author: austin
Date: 2005-11-03 04:03:22 +0100 (Thu, 03 Nov 2005)
New Revision: 852

Modified:
   trunk/096/config/npcdesc.cfg
Log:
Updated to use mainHitScript rather than wrestleHit

Modified: trunk/096/config/npcdesc.cfg
===================================================================
--- trunk/096/config/npcdesc.cfg	2005-11-03 02:46:57 UTC (rev 851)
+++ trunk/096/config/npcdesc.cfg	2005-11-03 03:03:22 UTC (rev 852)
@@ -30,7 +30,7 @@
 	CProp MerchantType	sbarber
 	CProp Equipt		sPeasant1
 	NameTemplate		Human
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	playervendor
@@ -59,7 +59,7 @@
 	CProp  MerchantType	sNone
 	CProp  Equipt		sPlayerVendor
 	NameTemplate		Human
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 
@@ -89,7 +89,7 @@
 	CProp  MerchantType	sNone
 	CProp  Equipt		sPlayerVendor
 	NameTemplate		Human
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	peasant2
@@ -122,7 +122,7 @@
 	CProp  Equipt		speasant2
 	CProp  Karma		i5
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	NameTemplate		Human
 }
 
@@ -156,7 +156,7 @@
 	CProp  Equipt		speasant1
 	CProp  Karma		i50
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	NameTemplate		Human
 }
 
@@ -189,7 +189,7 @@
 	Wealth			upper
 	CProp  Karma		i50
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	NameTemplate		Human
 }
 
@@ -235,7 +235,7 @@
 	Wealth			upper
 	CProp  Karma		i50
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	NameTemplate		Human
 }
 
@@ -274,7 +274,7 @@
 	CProp  Equipt		sPaladin
 	CProp  Karma		i150
 	CProp  Fame		i150
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	NameTemplate		Human
 }
 
@@ -308,7 +308,7 @@
 	CProp  Equipt		speasant1
 	CProp  Karma		i50
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -344,7 +344,7 @@
 	CProp  Equipt		speasant2
 	CProp  Karma		i50
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -381,7 +381,7 @@
 	CProp  Equipt		sFullPlate
 	CProp  Karma		i500
 	CProp  Fame		i500
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -419,7 +419,7 @@
 	CProp  Equipt		sEvilMage
 	CProp  Karma		i500
 	CProp  Fame		i500
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -451,7 +451,7 @@
 	Wealth			middle
 	CProp  MerchantType	shealer
 	CProp  Equipt		sHealer
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -483,7 +483,7 @@
 	Wealth			poor
 	CProp  MerchantType	shealer
 	CProp  Equipt		sHealer
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -517,7 +517,7 @@
 	CProp  Equipt		sHealer
 	CProp  Karma		i50
 	CProp  Fame		i5
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -552,7 +552,7 @@
 	Wealth			poor
 	CProp  Equipt		sStableMaster
 	CProp  MerchantType	sstable
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -586,7 +586,7 @@
 	Wealth			upper
 	CProp  MerchantType	sshipwright
 	CProp  Equipt		sShipWright
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -620,7 +620,7 @@
 	Wealth			middle
 	CProp  MerchantType	smapmaker
 	CProp  Equipt		sShipWright
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -654,7 +654,7 @@
 	Wealth			poor
 	CProp MerchantType	sfisherman
 	CProp Equipt		sfisherman
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -687,7 +687,7 @@
 	Wealth			poor
 	CProp  MerchantType	sinnkeeper
 	CProp  Equipt		sclothes
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -720,7 +720,7 @@
 	Wealth			poor
 	CProp  MerchantType	sfarmer
 	CProp  Equipt		speasant1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -752,7 +752,7 @@
 	Wealth			middle
 	CProp  MerchantType	sWeaponsmith
 	CProp  Equipt		sBlacksmith
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -784,7 +784,7 @@
 	Wealth			middle
 	CProp  MerchantType	sBlacksmith
 	CProp  Equipt		sBlacksmith
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -815,7 +815,7 @@
 	Wealth			middle
 	CProp  MerchantType	sArmorer
 	CProp  Equipt		sBlacksmith
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -846,7 +846,7 @@
 	Wealth			poor
 	CProp  MerchantType	sbarkeep
 	CProp  Equipt		sbarkeep
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -877,7 +877,7 @@
 	Wealth			poor
 	CProp  MerchantType	sbarmaid
 	CProp  Equipt		sBarmaid
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -908,7 +908,7 @@
 	Wealth			poor
 	CProp  MerchantType	sbaker
 	CProp  Equipt		sbaker
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -939,7 +939,7 @@
 	Wealth			middle
 	CProp  MerchantType	stinker
 	CProp  Equipt		stinker
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -970,7 +970,7 @@
 	Wealth			upper
 	CProp  MerchantType	sbard
 	CProp  Equipt		sPeasant2
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	NameTemplate		Human
 	OpensDoors		1
 }
@@ -1001,7 +1001,7 @@
 	Wealth			middle
 	CProp  MerchantType	sbutcher
 	CProp  Equipt		sbutcher
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1032,7 +1032,7 @@
 	Wealth			poor
 	CProp  MerchantType	scobbler
 	CProp  Equipt		sclothes
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1063,7 +1063,7 @@
 	Wealth			upper
 	CProp  MerchantType	sjeweler
 	CProp  Equipt		stinker
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1094,7 +1094,7 @@
 	Wealth			upper
 	CProp  MerchantType	sMage
 	CProp  Equipt		sMage
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1125,7 +1125,7 @@
 	Wealth			upper
 	CProp  MerchantType	sAlchemist
 	CProp  Equipt		sMage
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }	NameTemplate		Human
 
@@ -1156,7 +1156,7 @@
 	Wealth			middle
 	CProp  MerchantType	sHerbalist
 	CProp  Equipt		sMage
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1187,7 +1187,7 @@
 	Wealth			middle
 	CProp  MerchantType	sTailor
 	CProp  Equipt		sTailor
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1218,7 +1218,7 @@
 	Wealth			middle
 	CProp  MerchantType	sWeaver
 	CProp  Equipt		sTailor
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1249,7 +1249,7 @@
 	Wealth			middle
 	CProp  MerchantType	sLeatherworker
 	CProp  Equipt		sLeatherworker
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1280,7 +1280,7 @@
 	Wealth			middle
 	CProp  MerchantType	sProvisioner
 	CProp  Equipt		sProvisioner
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1311,7 +1311,7 @@
 	Wealth			middle
 	CProp  MerchantType	sCarpenter
 	CProp  Equipt		sCarpenter
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1342,7 +1342,7 @@
 	Wealth			middle
 	CProp  MerchantType	sBowyer
 	CProp  Equipt		sBowyer
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1373,7 +1373,7 @@
 	Wealth			upper
 	CProp  MerchantType	sArchitect
 	CProp  Equipt		sArchitect
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1404,7 +1404,7 @@
 	Wealth			middle
 	CProp  MerchantType	sScribe
 	CProp  Equipt		sScribe
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1434,7 +1434,7 @@
 	Alignment		good
 	Wealth			poor
 	CProp  Equipt		scrier
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1464,7 +1464,7 @@
 	Alignment		good
 	Wealth			poor
 	CProp  Equipt		sbanker
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1494,7 +1494,7 @@
 	Alignment		good
 	Wealth			poor
 	CProp  Equipt		sbanker
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -1541,7 +1541,7 @@
 	NoLoot			1
 	CProp  Karma		i5
 	CProp  Fame		i5
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	walrus
@@ -1587,7 +1587,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i5
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	rabbit
@@ -1630,7 +1630,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	deer
@@ -1673,7 +1673,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i2
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	ettin
@@ -1721,7 +1721,7 @@
 	CProp  Karma		i-18
 	CProp  Fame		i18
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -1771,7 +1771,7 @@
 	CProp  Fame		i18
 	CProp  Equipt		settinmace
 	CProp  OnHit		a1:S15::combat:maceHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -1816,7 +1816,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i2
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	blackbear
@@ -1859,7 +1859,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i2
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	bird
@@ -1906,7 +1906,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	NameTemplate		Bird_Small
 }
 
@@ -1951,7 +1951,7 @@
 	NoLoot			1
 	CProp  Karma		i-1
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	pig
@@ -1996,7 +1996,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	eagle
@@ -2041,7 +2041,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	dog
@@ -2087,7 +2087,7 @@
 	NoLoot			1
 	CProp  Karma		i1
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	bull
@@ -2132,7 +2132,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i3
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	chicken
@@ -2177,7 +2177,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	cat
@@ -2223,7 +2223,7 @@
 	NoLoot			1
 	CProp  Karma		i1
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	horse
@@ -2268,7 +2268,7 @@
 	NoLoot			1
 	CProp  Karma		i5
 	CProp  Fame		i4
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	horse2
@@ -2313,7 +2313,7 @@
 	NoLoot			1
 	CProp  Karma		i5
 	CProp  Fame		i4
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	horse3
@@ -2357,7 +2357,7 @@
 	NoLoot			1
 	CProp  Karma		i5
 	CProp  Fame		i4
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	horse4
@@ -2402,7 +2402,7 @@
 	NoLoot			1
 	CProp  Karma		i5
 	CProp  Fame		i4
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	horsepack
@@ -2443,7 +2443,7 @@
 	NoLoot			1
 	CProp  Karma		i5
 	CProp  Fame		i4
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	Llamapack
@@ -2482,7 +2482,7 @@
 	NoLoot			1
 	CProp  Karma		i5
 	CProp  Fame		i4
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	gorilla
@@ -2524,7 +2524,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	alligator
@@ -2566,7 +2566,7 @@
 	NoLoot			1
 	CProp  Karma		i-4
 	CProp  Fame		i4
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 
@@ -2608,7 +2608,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	goat
@@ -2650,7 +2650,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	grizzly
@@ -2691,7 +2691,7 @@
 	NoLoot			1
 	CProp  Karma		i-1
 	CProp  Fame		i5
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	polar
@@ -2732,7 +2732,7 @@
 	NoLoot			1
 	CProp  Karma		i-5
 	CProp  Fame		i5
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	panther
@@ -2772,7 +2772,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i2
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	grat
@@ -2813,7 +2813,7 @@
 	NoLoot			1
 	CProp  Karma		i-2
 	CProp  Fame		i2
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	ghart
@@ -2851,7 +2851,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i3
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	llama
@@ -2891,7 +2891,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i3
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	ogrelord
@@ -2932,7 +2932,7 @@
 	CProp  Karma		i-39
 	CProp  Fame		i39
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Ogre
 }
@@ -2974,7 +2974,7 @@
 	CProp  Karma		i-18
 	CProp  Fame		i18
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Ogre
 }
@@ -3021,7 +3021,7 @@
 	CProp  Karma		i-19
 	CProp  Fame		i19
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	direwolf
@@ -3062,7 +3062,7 @@
 	NoLoot			1
 	CProp  Karma		i-17
 	CProp  Fame		i17
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	frostwolf
@@ -3104,7 +3104,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i7
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	whitewolf
@@ -3145,7 +3145,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i7
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	greywolf
@@ -3185,7 +3185,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i3
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	wolf
@@ -3225,7 +3225,7 @@
 	NoLoot			1
 	CProp  Karma		i0
 	CProp  Fame		i2
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	fireelemental
@@ -3278,7 +3278,7 @@
 	CProp  Karma		i-26
 	CProp  Fame		i26
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -3336,7 +3336,7 @@
 	CProp  Karma		i-26
 	CProp  Fame		i26
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -3376,7 +3376,7 @@
 	CProp  Fame		i18
 	CProp  Equipt		sbackpack
 	CProp  OnHit		a1:S22::combat:earthElemental
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -3433,7 +3433,7 @@
 	CProp  Karma		i-26
 	CProp  Fame		i26
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -3493,7 +3493,7 @@
 	CProp  Karma		i-700
 	CProp  Fame		i700
 	CProp  Equipt		sdaemonsword
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Daemon
 }
@@ -3530,7 +3530,7 @@
 	CProp  Karma		i0
 	CProp  Fame		i0
 	CProp  OnHit		a1:S22::combat:bladeSpiritHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	vortex
@@ -3566,7 +3566,7 @@
 	CProp  Karma		i0
 	CProp  Fame		i0
 	CProp  OnHit		a1:S17::combat:vortexHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -3606,7 +3606,7 @@
 	NoLoot			1
 	CProp  Karma		i-26
 	CProp  Fame		i26
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	ratman1
@@ -3645,7 +3645,7 @@
 	CProp  Karma		i-7
 	CProp  Fame		i7
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Ratman
 }
@@ -3686,7 +3686,7 @@
 	CProp  Karma		i-7
 	CProp  Fame		i7
 	CProp  Equipt		sratmanaxe
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Ratman
 }
@@ -3727,7 +3727,7 @@
 	CProp  Karma		i-7
 	CProp  Fame		i7
 	CProp  Equipt		sratmansword
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Ratman
 }
@@ -3768,7 +3768,7 @@
 	CProp  Karma		i-7
 	CProp  Fame		i7
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	eldergazer
@@ -3824,7 +3824,7 @@
 	CProp  Karma		i-35
 	CProp  Fame		i35
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -3876,7 +3876,7 @@
 	CProp  Karma		i-21
 	CProp  Fame		i21
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -3916,7 +3916,7 @@
 	NoLoot			1
 	CProp  Karma		i-1
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	slime
@@ -3955,7 +3955,7 @@
 	NoLoot			1
 	CProp  Karma		i-1
 	CProp  Fame		i1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	corpser
@@ -3993,7 +3993,7 @@
 	CProp  Karma		i-1
 	CProp  Fame		i1
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	mongbat
@@ -4033,7 +4033,7 @@
 	CProp  Karma		i-1
 	CProp  Fame		i1
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	reaper
@@ -4085,7 +4085,7 @@
 	CProp  Karma		i-21
 	CProp  Fame		i21
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	wisp
@@ -4139,7 +4139,7 @@
 	NoLoot			1
 	CProp  Karma		i50
 	CProp  Fame		i70
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -4203,7 +4203,7 @@
 	CProp  Karma		i-60
 	CProp  Fame		i60
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -4266,7 +4266,7 @@
 	CProp  Karma		i-42
 	CProp  Fame		i42
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -4329,7 +4329,7 @@
 	CProp  Karma		i-42
 	CProp  Fame		i42
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -4377,7 +4377,7 @@
 	CProp  Karma		i-26
 	CProp  Fame		i26
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	drake2
@@ -4424,7 +4424,7 @@
 	CProp  Karma		i-26
 	CProp  Fame		i26
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	gargoyle
@@ -4479,7 +4479,7 @@
 	CProp  Karma		i-21
 	CProp  Fame		i21
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -4522,7 +4522,7 @@
 	CProp  Fame		i7
 	Cprop  poison_strength i3
 	CProp  OnHit		a1:S20::combat:mobPoisonHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	dreadspider
@@ -4577,7 +4577,7 @@
 	CProp  OnHit		a1:S20::combat:mobPoisonHit
 	Cprop  poison_strength i5
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	giantspider
@@ -4621,7 +4621,7 @@
 	CProp  Fame		i3
 	Cprop  poison_strength i2
 	CProp  OnHit		a1:S20::combat:mobPoisonHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	headless
@@ -4661,7 +4661,7 @@
 	CProp  Karma		i-2
 	CProp  Fame		i2
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -4704,7 +4704,7 @@
 	CProp  Fame		i17
 	Cprop  poison_strength  i3
 	CProp  OnHit		a1:S20::combat:mobPoisonHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	snake
@@ -4746,7 +4746,7 @@
 	CProp  Fame		i1
 	Cprop  poison_strength i1
 	CProp  OnHit		a1:S20::combat:mobPoisonHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	lavalizard
@@ -4789,7 +4789,7 @@
 	CProp  Karma		i-17
 	CProp  Fame		i17
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 
@@ -4832,7 +4832,7 @@
 	CProp  Karma		i-16
 	CProp  Fame		i16
 	CProp  Equipt		strollaxe
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -4872,7 +4872,7 @@
 	CProp  Karma		i-16
 	CProp  Fame		i16
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -4913,7 +4913,7 @@
 	CProp  Fame		i16
 	CProp  Equipt		strollmace
 	CProp  OnHit		a1:S15::combat:maceHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 ###########################
@@ -4969,7 +4969,7 @@
 	CProp  Equipt		sEvilMage
 	CProp  Karma		i-35
 	CProp  Fame		i35
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human_Evil_Mage
 }
@@ -5022,7 +5022,7 @@
 	CProp  Equipt		sEvilMage
 	CProp  Karma		i-17
 	CProp  Fame		i17
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human_Evil_Mage
 }
@@ -5089,7 +5089,7 @@
 	CProp  Karma		i-47
 	CProp  Fame		i47
 	CProp  Equipt		sliche
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -5150,7 +5150,7 @@
 	CProp  Karma		i-30
 	CProp  Fame		i30
 	CProp  Equipt		sliche
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -5193,7 +5193,7 @@
 	CProp  Karma		i-20
 	CProp  Fame		i20
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	spectre
@@ -5248,7 +5248,7 @@
 	CProp  Karma		i-18
 	CProp  Fame		i18
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	skeletalmage
@@ -5304,7 +5304,7 @@
 	CProp  Karma		i-20
 	CProp  Fame		i20
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	bonemage
@@ -5361,7 +5361,7 @@
 	CProp  Karma		i-17
 	CProp  Fame		i17
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	boneknight
@@ -5403,7 +5403,7 @@
 	CProp  Karma		i-16
 	CProp  Fame		i16
 	CProp  Equipt		sboneknight
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	skeletonknight
@@ -5445,7 +5445,7 @@
 	CProp  Karma		i-18
 	CProp  Fame		i18
 	CProp  Equipt		sboneknight
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	shade
@@ -5486,7 +5486,7 @@
 	CProp  Karma		i-16
 	CProp  Fame		i16
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	ghoul
@@ -5541,7 +5541,7 @@
 	CProp  Karma		i-80
 	CProp  Fame		i80
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	skeleton
@@ -5583,7 +5583,7 @@
 	CProp  Karma		i-2
 	CProp  Fame		i2
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	zombie
@@ -5624,7 +5624,7 @@
 	CProp  Karma		i-1
 	CProp  Fame		i1
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 ###########################
 #				Orcs				#
@@ -5666,7 +5666,7 @@
 	CProp  Karma		i-16
 	CProp  Fame		i16
 	CProp  Equipt		sorclord
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Orc
 }
@@ -5724,7 +5724,7 @@
 	CProp  Karma		i-19
 	CProp  Fame		i19
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Orc
 }
@@ -5765,7 +5765,7 @@
 	CProp  Karma		i-7
 	CProp  Fame		i7
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Orc
 }
@@ -5808,7 +5808,7 @@
 	CProp  Fame		i7
 	CProp  Equipt		sorcclub
 	CProp  OnHit		a1:S15::combat:maceHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Orc
 }
@@ -5846,7 +5846,7 @@
 	CProp  Equipt		sBrigand
 	CProp  Karma		i-6
 	CProp  Fame		i6
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Human
 }
@@ -5890,7 +5890,7 @@
 	CProp  Karma		i-7
 	CProp  Fame		i7
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Lizardman
 }
@@ -5931,7 +5931,7 @@
 	CProp  Karma		i-7
 	CProp  Fame		i7
 	CProp  Equipt		slizspear
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Lizardman
 }
@@ -5973,7 +5973,7 @@
 	CProp  Fame		i7
 	CProp  Equipt		slizmace
 	CProp  OnHit		a1:S15::combat:maceHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 	NameTemplate		Lizardman
 }
@@ -6032,7 +6032,7 @@
 	CProp  Equipt		sbackpack
 	Cprop  poison_strength i5
 	CProp  OnHit		a1:S20::combat:mobPoisonHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -6099,7 +6099,7 @@
 	CProp  Karma		i-55
 	CProp  Fame		i55
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -6160,7 +6160,7 @@
 	CProp  Karma		i-37
 	CProp  Fame		i37
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -6219,7 +6219,7 @@
 	Cprop  guardkill	i1
 	CProp  Karma		i0
 	CProp  Fame		i0
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 ############################
@@ -6265,7 +6265,7 @@
 	CProp  Karma		i-1
 	CProp  Fame		i1
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	cyclopse
@@ -6306,7 +6306,7 @@
 	CProp  Fame		i26
 	CProp  Equipt		sbackpack
 	CProp  OnHit		a1:S15::combat:maceHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -6363,7 +6363,7 @@
 	CProp  Karma		i-35
 	CProp  Fame		i35
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -6418,7 +6418,7 @@
 	CProp  Karma		i-35
 	CProp  Fame		i35
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -6456,7 +6456,7 @@
 	CProp  Karma		i-18
 	CProp  Fame		i18
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -6495,7 +6495,7 @@
 	NoLoot			1
 	CProp  Karma		i-2
 	CProp  Fame		i2
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	frostspider
@@ -6536,7 +6536,7 @@
 	CProp  Karma		i-5
 	CProp  Fame		i5
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 
@@ -6576,7 +6576,7 @@
 	CProp  Fame		i16
 	Cprop  poison_strength i3
 	CProp  OnHit		a1:S20::combat:mobPoisonHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	gianttoad
@@ -6619,7 +6619,7 @@
 	CProp  Karma		i-3
 	CProp  Fame		i3
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	iceelemental
@@ -6667,7 +6667,7 @@
 	CProp  Karma		i-24
 	CProp  Fame		i24
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -6729,7 +6729,7 @@
 	CProp  Karma		i-47
 	CProp  Fame		i47
 	CProp  Equipt		sdaemonsword
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -6770,7 +6770,7 @@
 	CProp  Fame		i3
 	Cprop  poison_strength i1
 	CProp  OnHit		a1:S20::combat:mobPoisonHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	imp
@@ -6826,7 +6826,7 @@
 	CProp  Karma		i-16
 	CProp  Fame		i16
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -6870,7 +6870,7 @@
 	CProp  Karma		i-21
 	CProp  Fame		i21
 	CProp  Equipt		sboneknight
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	nightmare
@@ -6933,7 +6933,7 @@
 	CProp  Karma		i-43
 	CProp  Fame		i43
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	desertostard
@@ -6974,7 +6974,7 @@
 	NoLoot			1
 	CProp  Karma		i5
 	CProp  Fame		i4
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	forestostard
@@ -7013,7 +7013,7 @@
 	CorpseItm		rawribs
 	CorpseAmt		1
 	NoLoot			1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	frenziedostard
@@ -7052,7 +7052,7 @@
 	CorpseItm		rawribs
 	CorpseAmt		1
 	NoLoot			1
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 ###########################
 #			Ophidians				#
@@ -7116,7 +7116,7 @@
 	CProp  Karma		i-45
 	CProp  Fame		i45
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -7161,7 +7161,7 @@
 	CProp  OnHit		a1:S20::combat:mobPoisonHit
 	Cprop  poison_strength i5
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 
 }
@@ -7206,7 +7206,7 @@
 	CProp  OnHit		a1:S20::combat:mobPoisonHit
 	Cprop  poison_strength i5
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -7264,7 +7264,7 @@
 	CProp  Karma		i-19
 	CProp  Fame		i19
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -7320,7 +7320,7 @@
 	CProp			Karma i-19
 	CProp			Fame  i19
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -7362,7 +7362,7 @@
 	CProp  Karma		i-17
 	CProp  Fame		i17
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -7404,7 +7404,7 @@
 	CProp  Karma		i-16
 	CProp  Fame		i16
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -7445,7 +7445,7 @@
 	CProp  Karma		i-28
 	CProp  Fame		i28
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -7487,7 +7487,7 @@
 	CProp  Karma		i-22
 	CProp  Fame		i22
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -7527,7 +7527,7 @@
 	CProp  Karma		i-26
 	CProp  Fame		i26
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	swamptentacle
@@ -7565,7 +7565,7 @@
 	CProp  Karma		i-18
 	CProp  Fame		i18
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 ###########################
 #			Terathans
@@ -7624,7 +7624,7 @@
 	CProp  Karma		i-45
 	CProp  Fame		i45
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -7680,7 +7680,7 @@
 	CProp  OnHit		a1:S20::combat:mobPoisonHit
 	Cprop  poison_strength i5
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -7722,7 +7722,7 @@
 	CProp  Karma		i-16
 	CProp  Fame		i16
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -7764,7 +7764,7 @@
 	CProp  Karma		i-8
 	CProp  Fame		i8
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 ###########################
@@ -7827,7 +7827,7 @@
 	CProp  Karma		i-44
 	CProp  Fame		i44
 	CProp  Equipt		sbackpack
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }
 
@@ -7876,7 +7876,7 @@
 	CProp  Equipt		sbackpack
 	Cprop  poison_strength i4
 	CProp  OnHit		a1:S20::combat:mobPoisonHit
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 NPCTemplate	blackliche
@@ -7935,6 +7935,6 @@
 	CProp  Karma		i-1750
 	CProp  Fame		i950
 	CProp  Equipt		sliche
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 	OpensDoors		1
 }



From austin at berlios.de  Thu Nov  3 04:05:12 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 04:05:12 +0100
Subject: [Poldistro-svn] r853 - trunk/096/pkg/mobiles/brainAI
Message-ID: <200511030305.jA335CGe020364@sheep.berlios.de>

Author: austin
Date: 2005-11-03 04:05:09 +0100 (Thu, 03 Nov 2005)
New Revision: 853

Modified:
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
Log:
Updated hitscript entries.

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-03 03:03:22 UTC (rev 852)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-03 03:05:09 UTC (rev 853)
@@ -62,7 +62,7 @@
 	Gender			0
 	AR			1
 	RunSpeed		25
-	Category		Monster
+	Category		Austin
 
 	// Attributes
 	Strength		15
@@ -91,7 +91,7 @@
 	AIScript	Sleep		:brainAI:scripts/sleep/generic
 	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/targetPlayers
 
-	AttackHitScript		:combat:mainhitscript
+	AttackHitScript		:combat:mainHutScript
 }
 
 ##########################################
@@ -150,7 +150,7 @@
 	CProp  Karma		i0
 	CProp  Fame		i10
 
-	AISetting	FleeLevel	i50		// 50%
+	AISetting	FleeLevel	i50 // 50%
 	AISetting	IdleTicks	i5
 	AISetting	SleepWait	i1000
 	AISetting	ListenRange	i10
@@ -166,5 +166,5 @@
 	AIScript	Sleep		:brainAI:scripts/sleep/generic
 	AIScript	EndFight	:brainAI:scripts/endFight/endFightAnimal
 
-	AttackHitScript		:combat:wrestlingHitScript
+	AttackHitScript		:combat:mainHitScript
 }



From austin at berlios.de  Thu Nov  3 04:09:07 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 04:09:07 +0100
Subject: [Poldistro-svn] r854 - in trunk/096/pkg: mobiles/brainAI skills/tailoring
Message-ID: <200511030309.jA3397gH020554@sheep.berlios.de>

Author: austin
Date: 2005-11-03 04:09:05 +0100 (Thu, 03 Nov 2005)
New Revision: 854

Modified:
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
   trunk/096/pkg/skills/tailoring/itemdesc.cfg
Log:
Removed equipt scripts for armor entries in tailoring/itemdesc.cfg
(Shouldnt all armor and weapon entries be in the combat package?)



Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-03 03:05:09 UTC (rev 853)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-03 03:09:05 UTC (rev 854)
@@ -91,7 +91,7 @@
 	AIScript	Sleep		:brainAI:scripts/sleep/generic
 	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/targetPlayers
 
-	AttackHitScript		:combat:mainHutScript
+	AttackHitScript		:combat:mainHitScript
 }
 
 ##########################################

Modified: trunk/096/pkg/skills/tailoring/itemdesc.cfg
===================================================================
--- trunk/096/pkg/skills/tailoring/itemdesc.cfg	2005-11-03 03:05:09 UTC (rev 853)
+++ trunk/096/pkg/skills/tailoring/itemdesc.cfg	2005-11-03 03:09:05 UTC (rev 854)
@@ -26,9 +26,7 @@
     newbie          1
     maxhp           10
     dyeable         1
-    equipscript     :combat:equip
-    unequipscript   :combat:unequip
-    controlscript   :combat:deathrobe
+    
     destroyscript   :combat:destroy
 }
 Armor 0x9945
@@ -43,9 +41,7 @@
     VendorBuysFor   34
     maxhp           20
     dyeable         1
-    equipscript     :combat:equip
-    unequipscript   :combat:unequip
-    controlscript   :combat:itemControl
+    
     destroyscript   :combat:destroy
 }
 Item 0xF9D
@@ -78,9 +74,6 @@
     AR              2
     Coverage        Legs/feet
     maxhp           20
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x170F
@@ -92,9 +85,6 @@
     AR              1
     maxhp           20
     Coverage        Legs/feet
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1EFD
@@ -107,9 +97,6 @@
     maxhp 20
     Coverage Body
     Coverage Arms
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1EFF
@@ -123,9 +110,6 @@
     Coverage Body
     Coverage Legs/feet
     Coverage Arms
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1F01
@@ -139,9 +123,6 @@
     Coverage Body
     Coverage Legs/feet
     Coverage Arms
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1F7B
@@ -153,9 +134,6 @@
     AR     3
     maxhp 20
     Coverage Body
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1F9F
@@ -168,9 +146,6 @@
     maxhp 20
     Coverage Body
     Coverage Arms
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1FA1
@@ -183,9 +158,6 @@
     maxhp 20
     Coverage Body
     Coverage Arms
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1FFD
@@ -197,9 +169,6 @@
     AR     2
     maxhp 20
     Coverage Body
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1517
@@ -212,9 +181,6 @@
     maxhp 20
     Coverage Body
     Coverage Arms
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1515
@@ -225,9 +191,6 @@
     dyeable         1
     AR     2
     maxhp 20
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1516
@@ -239,9 +202,6 @@
     AR     2
     maxhp 20
     Coverage Body
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x152E
@@ -253,9 +213,6 @@
     AR     1
     maxhp 20
     Coverage Legs/feet
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1537
@@ -267,9 +224,6 @@
     AR     1
     maxhp 20
     Coverage Legs/feet
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1539
@@ -281,9 +235,6 @@
     AR     3
     maxhp 20
     Coverage Legs/feet
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x153B
@@ -295,9 +246,6 @@
     AR     2
     maxhp 20
     Coverage Legs/feet
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x153D
@@ -310,9 +258,6 @@
     maxhp 20
     Coverage Body
     Coverage Legs/feet
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x153F
@@ -324,9 +269,6 @@
     AR     1
     maxhp 20
     Coverage Head
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1541
@@ -338,9 +280,6 @@
     AR     1
     maxhp 20
     Coverage Body
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1543
@@ -352,9 +291,6 @@
     AR     1
     maxhp 20
     Coverage Head
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1713
@@ -366,9 +302,6 @@
     AR     2
     maxhp 20
     Coverage Head
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1714
@@ -380,9 +313,6 @@
     AR     2
     maxhp 20
     Coverage Head
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1715
@@ -394,9 +324,6 @@
     AR     1
     maxhp 20
     Coverage Head
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1719
@@ -408,9 +335,6 @@
     AR     1
     maxhp 20
     Coverage Head
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x171A
@@ -422,9 +346,6 @@
     AR     2
     maxhp 20
     Coverage Head
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x171B
@@ -436,9 +357,6 @@
     AR     2
     maxhp 20
     Coverage Head
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x171C
@@ -450,9 +368,6 @@
     AR     1
     maxhp 20
     Coverage Head
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 Armor 0x1716
@@ -464,9 +379,6 @@
     AR     1
     maxhp 20
     Coverage Head
-    equipscript    :combat:equip
-    unequipscript  :combat:unequip
-    controlscript  :combat:itemControl
     destroyscript  :combat:destroy
 }
 



From austin at berlios.de  Thu Nov  3 04:10:29 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 04:10:29 +0100
Subject: [Poldistro-svn] r855 - trunk/096/pkg/skills/tailoring
Message-ID: <200511030310.jA33ATmo020692@sheep.berlios.de>

Author: austin
Date: 2005-11-03 04:10:28 +0100 (Thu, 03 Nov 2005)
New Revision: 855

Modified:
   trunk/096/pkg/skills/tailoring/itemdesc.cfg
Log:
Guess there were a few entries I missed ;-p

Modified: trunk/096/pkg/skills/tailoring/itemdesc.cfg
===================================================================
--- trunk/096/pkg/skills/tailoring/itemdesc.cfg	2005-11-03 03:09:05 UTC (rev 854)
+++ trunk/096/pkg/skills/tailoring/itemdesc.cfg	2005-11-03 03:10:28 UTC (rev 855)
@@ -10,9 +10,6 @@
     AR              2
     maxhp           20
     Coverage        Head
-    equipscript     :combat:equip
-    unequipscript   :combat:unequip
-    controlscript   :combat:itemControl
     destroyscript   :combat:destroy
     Cprop type      swizzohat
 }
@@ -60,9 +57,6 @@
     AR              3
     maxhp           20
     Coverage        Legs/feet
-    equipscript     :combat:equip
-    unequipscript   :combat:unequip
-    controlscript   :combat:itemControl
     destroyscript   :combat:destroy
 }
 Armor 0x170D



From austin at berlios.de  Thu Nov  3 04:20:16 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 04:20:16 +0100
Subject: [Poldistro-svn] r856 - in trunk/096/pkg: skills/tailoring systems/combat
Message-ID: <200511030320.jA33KGem022435@sheep.berlios.de>

Author: austin
Date: 2005-11-03 04:20:10 +0100 (Thu, 03 Nov 2005)
New Revision: 856

Added:
   trunk/096/pkg/systems/combat/onDestroy.src
Modified:
   trunk/096/pkg/skills/tailoring/itemdesc.cfg
   trunk/096/pkg/systems/combat/itemdesc.cfg
Log:
Added onDestroy script that supports the new equipment attribute modifiers.

Edited itemdesc.cfg files to use it.

Modified: trunk/096/pkg/skills/tailoring/itemdesc.cfg
===================================================================
--- trunk/096/pkg/skills/tailoring/itemdesc.cfg	2005-11-03 03:10:28 UTC (rev 855)
+++ trunk/096/pkg/skills/tailoring/itemdesc.cfg	2005-11-03 03:20:10 UTC (rev 856)
@@ -3,506 +3,507 @@
 #
 Armor 0x1718
 {
-    Name            wizardhat
-    vendorbuysfor   10
-    vendorsellsfor  30
-    dyeable         1
-    AR              2
-    maxhp           20
-    Coverage        Head
-    destroyscript   :combat:destroy
-    Cprop type      swizzohat
+	Name			wizardhat
+	VendorBuysFor		10
+	VendorSellsFor		30
+	CanDye			1
+	AR			2
+	MaxHP			20
+	Coverage		Head
+	DestroyScript		:combat:onDestroy
+	
+	CProp	type	swizzohat
 }
 Armor 0x1F03
 {
-    Name            deathrobe
-    AR              2
-    Coverage        Body
-    Coverage        Legs/feet
-    Coverage        Arms
-    newbie          1
-    maxhp           10
-    dyeable         1
-    
-    destroyscript   :combat:destroy
+	Name			deathrobe
+	AR			2
+	Coverage		Body
+	Coverage		Legs/feet
+	Coverage		Arms
+	Newbie			1
+	MaxHP			10
+	CanDye			1
+	
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x9945
 {
-    Name            Robe
-    Graphic         0x1f03
-    AR              4
-    Coverage        Body
-    Coverage        Legs/feet
-    Coverage        Arms
-    VendorSellsFor  68
-    VendorBuysFor   34
-    maxhp           20
-    dyeable         1
-    
-    destroyscript   :combat:destroy
+	Name			Robe
+	Graphic			0x1F03
+	AR			4
+	Coverage		Body
+	Coverage		Legs/feet
+	Coverage		Arms
+	VendorSellsFor		68
+	VendorBuysFor		34
+	MaxHP			20
+	CanDye			1
+	
+	DestroyScript		:combat:onDestroy
 }
 Item 0xF9D
 {
-    Name            SewingKit
-    Script          makeClothItems
-    VendorSellsFor  3
-    VendorBuysFor   1
+	Name			SewingKit
+	Script			makeClothItems
+	VendorSellsFor		3
+	VendorBuysFor		1
 }
 Armor 0x153A
 {
-    Name            LongPants1
-    VendorSellsFor  34
-    VendorBuysFor   17
-    dyeable         1
-    AR              3
-    maxhp           20
-    Coverage        Legs/feet
-    destroyscript   :combat:destroy
+	Name			LongPants1
+	VendorSellsFor		34
+	VendorBuysFor		17
+	CanDye			1
+	AR			3
+	MaxHP			20
+	Coverage		Legs/feet
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x170D
 {
-    Name            Sandals
-    VendorSellsFor  24
-    VendorBuysFor   12
-    dyeable         1
-    AR              2
-    Coverage        Legs/feet
-    maxhp           20
-    destroyscript  :combat:destroy
+	Name			Sandals
+	VendorSellsFor		24
+	VendorBuysFor		12
+	CanDye			1
+	AR			2
+	Coverage		Legs/feet
+	MaxHP			20
+	DestroyScript		:combat:destroy
 }
 Armor 0x170F
 {
-    Name            Shoes
-    VendorSellsFor  27
-    VendorBuysFor   13
-    dyeable         1
-    AR              1
-    maxhp           20
-    Coverage        Legs/feet
-    destroyscript  :combat:destroy
+	Name			Shoes
+	VendorSellsFor		27
+	VendorBuysFor		13
+	CanDye			1
+	AR			1
+	MaxHP			20
+	Coverage		Legs/feet
+	DestroyScript		:combat:destroy
 }
 Armor 0x1EFD
 {
-    Name            Fancy Shirt
-    VendorSellsFor  55
-    VendorBuysFor   27
-    dyeable         1
-    AR     4
-    maxhp 20
-    Coverage Body
-    Coverage Arms
-    destroyscript  :combat:destroy
+	Name			Fancy Shirt
+	VendorSellsFor		55
+	VendorBuysFor		27
+	CanDye			1
+	AR			4
+	MaxHP			20
+	Coverage		Body
+	Coverage		Arms
+	DestroyScript		:combat:destroy
 }
 Armor 0x1EFF
 {
-    Name            Fancy Dress
-    VendorSellsFor  25
-    VendorBuysFor   12
-    dyeable         1
-    AR     4
-    maxhp 20
-    Coverage Body
-    Coverage Legs/feet
-    Coverage Arms
-    destroyscript  :combat:destroy
+	Name			Fancy Dress
+	VendorSellsFor		25
+	VendorBuysFor		12
+	CanDye			1
+	AR			4
+	MaxHP			20
+	Coverage		Body
+	Coverage		Legs/feet
+	Coverage		Arms
+	DestroyScript		:combat:destroy
 }
 Armor 0x1F01
 {
-    Name            Plain Dress
-    VendorSellsFor  56
-    VendorBuysFor   28
-    dyeable         1
-    AR     3
-    maxhp 20
-    Coverage Body
-    Coverage Legs/feet
-    Coverage Arms
-    destroyscript  :combat:destroy
+	Name			Plain Dress
+	VendorSellsFor		56
+	VendorBuysFor		28
+	CanDye			1
+	AR			3
+	MaxHP			20
+	Coverage		Body
+	Coverage		Legs/feet
+	Coverage		Arms
+	DestroyScript		:combat:destroy
 }
 Armor 0x1F7B
 {
-    Name            Doublet
-    VendorSellsFor  25
-    VendorBuysFor   12
-    dyeable         1
-    AR     3
-    maxhp 20
-    Coverage Body
-    destroyscript  :combat:destroy
+	Name			Doublet
+	VendorSellsFor		25
+	VendorBuysFor		12
+	CanDye			1
+	AR			3
+	MaxHP			20
+	Coverage		Body
+	DestroyScript		:combat:destroy
 }
 Armor 0x1F9F
 {
-    Name            JesterSuit
-    VendorSellsFor  51
-    VendorBuysFor   25
-    dyeable         1
-    AR     4
-    maxhp 20
-    Coverage Body
-    Coverage Arms
-    destroyscript  :combat:destroy
+	Name			JesterSuit
+	VendorSellsFor		51
+	VendorBuysFor		25
+	CanDye			1
+	AR			4
+	MaxHP			20
+	Coverage		Body
+	Coverage		Arms
+	DestroyScript		:combat:destroy
 }
 Armor 0x1FA1
 {
-    Name            Tunic
-    VendorSellsFor  33
-    VendorBuysFor   16
-    dyeable         1
-    AR     3
-    maxhp 20
-    Coverage Body
-    Coverage Arms
-    destroyscript  :combat:destroy
+	Name			Tunic
+	VendorSellsFor		33
+	VendorBuysFor		16
+	CanDye			1
+	AR			3
+	MaxHP			20
+	Coverage		Body
+	Coverage		Arms
+	DestroyScript		:combat:destroy
 }
 Armor 0x1FFD
 {
-    Name            Surcoat
-    VendorSellsFor  40
-    VendorBuysFor   22
-    dyeable         1
-    AR     2
-    maxhp 20
-    Coverage Body
-    destroyscript  :combat:destroy
+	Name			Surcoat
+	VendorSellsFor		40
+	VendorBuysFor		22
+	CanDye			1
+	AR			2
+	MaxHP			20
+	Coverage		Body
+	DestroyScript		:combat:destroy
 }
 Armor 0x1517
 {
-    Name            Shirt
-    VendorSellsFor  37
-    VendorBuysFor   18
-    dyeable         1
-    AR     2
-    maxhp 20
-    Coverage Body
-    Coverage Arms
-    destroyscript  :combat:destroy
+	Name			Shirt
+	VendorSellsFor		37
+	VendorBuysFor		18
+	CanDye			1
+	AR			2
+	MaxHP			20
+	Coverage		Body
+	Coverage		Arms
+	DestroyScript		:combat:destroy
 }
 Armor 0x1515
 {
-    Name            Cloak
-    VendorSellsFor  43
-    VendorBuysFor   21
-    dyeable         1
-    AR     2
-    maxhp 20
-    destroyscript  :combat:destroy
+	Name			Cloak
+	VendorSellsFor		43
+	VendorBuysFor		21
+	CanDye			1
+	AR			2
+	MaxHP			20
+	DestroyScript		:combat:destroy
 }
 Armor 0x1516
 {
-    Name            Skirt
-    VendorSellsFor  33
-    VendorBuysFor   16
-    dyeable         1
-    AR     2
-    maxhp 20
-    Coverage Body
-    destroyscript  :combat:destroy
+	Name			Skirt
+	VendorSellsFor		33
+	VendorBuysFor		16
+	CanDye			1
+	AR			2
+	MaxHP			20
+	Coverage		Body
+	DestroyScript		:combat:destroy
 }
 Armor 0x152E
 {
-    Name            ShortPants
-    VendorSellsFor  24
-    VendorBuysFor   12
-    dyeable         1
-    AR     1
-    maxhp 20
-    Coverage Legs/feet
-    destroyscript  :combat:destroy
+	Name			ShortPants
+	VendorSellsFor		24
+	VendorBuysFor		12
+	CanDye			1
+	AR			1
+	MaxHP			20
+	Coverage		Legs/feet
+	DestroyScript		:combat:destroy
 }
 Armor 0x1537
 {
-    Name            Kilt
-    VendorSellsFor  31
-    VendorBuysFor   15
-    dyeable         1
-    AR     1
-    maxhp 20
-    Coverage Legs/feet
-    destroyscript  :combat:destroy
+	Name			Kilt
+	VendorSellsFor		31
+	VendorBuysFor		15
+	CanDye			1
+	AR			1
+	MaxHP			20
+	Coverage		Legs/feet
+	DestroyScript		:combat:destroy
 }
 Armor 0x1539
 {
-    Name            LongPants2
-    VendorSellsFor  34
-    VendorBuysFor   17
-    dyeable         1
-    AR     3
-    maxhp 20
-    Coverage Legs/feet
-    destroyscript  :combat:destroy
+	Name			LongPants2
+	VendorSellsFor		34
+	VendorBuysFor		17
+	CanDye			1
+	AR			3
+	MaxHP			20
+	Coverage		Legs/feet
+	DestroyScript		:combat:destroy
 }
 Armor 0x153B
 {
-    Name            HalfApron
-    VendorSellsFor  26
-    VendorBuysFor   13
-    dyeable         1
-    AR     2
-    maxhp 20
-    Coverage Legs/feet
-    destroyscript  :combat:destroy
+	Name			HalfApron
+	VendorSellsFor		26
+	VendorBuysFor		13
+	CanDye			1
+	AR			2
+	MaxHP			20
+	Coverage		Legs/feet
+	DestroyScript		:combat:destroy
 }
 Armor 0x153D
 {
-    Name            FullApron
-    VendorSellsFor  26
-    VendorBuysFor   13
-    dyeable         1
-    AR     3
-    maxhp 20
-    Coverage Body
-    Coverage Legs/feet
-    destroyscript  :combat:destroy
+	Name			FullApron
+	VendorSellsFor		26
+	VendorBuysFor		13
+	CanDye			1
+	AR			3
+	MaxHP			20
+	Coverage		Body
+	Coverage		Legs/feet
+	DestroyScript		:combat:destroy
 }
 Armor 0x153F
 {
-    Name            Bandana
-    VendorSellsFor  14
-    VendorBuysFor   6
-    dyeable         1
-    AR     1
-    maxhp 20
-    Coverage Head
-    destroyscript  :combat:destroy
+	Name			Bandana
+	VendorSellsFor		14
+	VendorBuysFor		6
+	CanDye			1
+	AR			1
+	MaxHP			20
+	Coverage		Head
+	DestroyScript		:combat:destroy
 }
 Armor 0x1541
 {
-    Name            BodySash
-    VendorSellsFor  20
-    VendorBuysFor   10
-    dyeable         1
-    AR     1
-    maxhp 20
-    Coverage Body
-    destroyscript  :combat:destroy
+	Name			BodySash
+	VendorSellsFor		20
+	VendorBuysFor		10
+	CanDye			1
+	AR			1
+	MaxHP			20
+	Coverage		Body
+	DestroyScript		:combat:destroy
 }
 Armor 0x1543
 {
-    Name            Skullcap
-    VendorSellsFor  12
-    VendorBuysFor   6
-    dyeable         1
-    AR     1
-    maxhp 20
-    Coverage Head
-    destroyscript  :combat:destroy
+	Name			Skullcap
+	VendorSellsFor		12
+	VendorBuysFor		6
+	CanDye			1
+	AR			1
+	MaxHP			20
+	Coverage		Head
+	DestroyScript		:combat:destroy
 }
 Armor 0x1713
 {
-    Name            FloppyHat
-    VendorSellsFor  25
-    VendorBuysFor   12
-    dyeable         1
-    AR     2
-    maxhp 20
-    Coverage Head
-    destroyscript  :combat:destroy
+	Name			FloppyHat
+	VendorSellsFor		25
+	VendorBuysFor		12
+	CanDye			1
+	AR			2
+	MaxHP			20
+	Coverage		Head
+	DestroyScript		:combat:destroy
 }
 Armor 0x1714
 {
-    Name            WideBrimHat
-    VendorSellsFor  26
-    VendorBuysFor   13
-    dyeable         1
-    AR     2
-    maxhp 20
-    Coverage Head
-    destroyscript  :combat:destroy
+	Name			WideBrimHat
+	VendorSellsFor		26
+	VendorBuysFor		13
+	CanDye			1
+	AR			2
+	MaxHP			20
+	Coverage		Head
+	DestroyScript		:combat:destroy
 }
 Armor 0x1715
 {
-    Name            Cap
-    VendorSellsFor  27
-    VendorBuysFor   13
-    dyeable         1
-    AR     1
-    maxhp 20
-    Coverage Head
-    destroyscript  :combat:destroy
+	Name			Cap
+	VendorSellsFor		27
+	VendorBuysFor		13
+	CanDye			1
+	AR			1
+	MaxHP			20
+	Coverage		Head
+	DestroyScript		:combat:destroy
 }
 Armor 0x1719
 {
-    Name            Bonnet
-    VendorSellsFor  26
-    VendorBuysFor   13
-    dyeable         1
-    AR     1
-    maxhp 20
-    Coverage Head
-    destroyscript  :combat:destroy
+	Name			Bonnet
+	VendorSellsFor		26
+	VendorBuysFor		13
+	CanDye			1
+	AR			1
+	MaxHP			20
+	Coverage		Head
+	DestroyScript		:combat:destroy
 }
 Armor 0x171A
 {
-    Name            FeatheredHat
-    VendorSellsFor  27
-    VendorBuysFor   13
-    dyeable         1
-    AR     2
-    maxhp 20
-    Coverage Head
-    destroyscript  :combat:destroy
+	Name			FeatheredHat
+	VendorSellsFor		27
+	VendorBuysFor		13
+	CanDye			1
+	AR			2
+	MaxHP			20
+	Coverage		Head
+	DestroyScript		:combat:destroy
 }
 Armor 0x171B
 {
-    Name            TricorneHat
-    VendorSellsFor  26
-    VendorBuysFor   13
-    dyeable         1
-    AR     2
-    maxhp 20
-    Coverage Head
-    destroyscript  :combat:destroy
+	Name			TricorneHat
+	VendorSellsFor		26
+	VendorBuysFor		13
+	CanDye			1
+	AR			2
+	MaxHP			20
+	Coverage		Head
+	DestroyScript		:combat:destroy
 }
 Armor 0x171C
 {
-    Name            Jesterhat
-    VendorSellsFor  31
-    VendorBuysFor   15
-    dyeable         1
-    AR     1
-    maxhp 20
-    Coverage Head
-    destroyscript  :combat:destroy
+	Name			Jesterhat
+	VendorSellsFor		31
+	VendorBuysFor		15
+	CanDye			1
+	AR			1
+	MaxHP			20
+	Coverage		Head
+	DestroyScript		:combat:destroy
 }
 Armor 0x1716
 {
-    Name            strawhat
-    VendorSellsFor  31
-    VendorBuysFor   15
-    dyeable         1
-    AR     1
-    maxhp 20
-    Coverage Head
-    destroyscript  :combat:destroy
+	Name			strawhat
+	VendorSellsFor		31
+	VendorBuysFor		15
+	CanDye			1
+	AR			1
+	MaxHP			20
+	Coverage		Head
+	DestroyScript		:combat:destroy
 }
 
 Item 0xe1f
 {
-    Name    yarn
-    Script  tailoring
-    VendorSellsFor  10
-    VendorBuysFor   7
+	Name			yarn
+	Script			tailoring
+	VendorSellsFor		10
+	VendorBuysFor		7
 }
 
 Item 0xFA0
 {
-    Name    Thread1
-    Script  tailoring
-    VendorSellsFor  10
-    VendorBuysFor   7
+	Name			Thread1
+	Script			tailoring
+	VendorSellsFor		10
+	VendorBuysFor		7
 }
 
 Item 0xfa1
 {
-    Name    Thread2
-    script  tailoring
-    VendorSellsFor  10
-    VendorBuysFor   7
+	Name			Thread2
+	Script			tailoring
+	VendorSellsFor		10
+	VendorBuysFor		7
 }
 
 Item 0xf9e
 {
-    Name Scissors
-    script scissors
-    VendorSellsFor 10
-    VendorBuysFor 5
+	Name			Scissors
+	Script			scissors
+	VendorSellsFor		10
+	VendorBuysFor		5
 }
 
 Item 0xf125
 {
-    Name            wool
-    desc            pile%s% of wool
-    Weight          1
-    script          spinning
-    graphic         0xdf8
-    VendorSellsFor  30
-    VendorBuysFor   15
+	Name			wool
+	desc			pile%s% of wool
+	Weight			1
+	Script			spinning
+	Graphic			0xdf8
+	VendorSellsFor		30
+	VendorBuysFor		15
 }
 
 Item 0xf95
 {
-    Name            bolt1
-    Color           0
-    Desc            bolt%s% of cloth
-    Weight          5
-    VendorSellsFor  60
-    VendorBuysFor   30
+	Name			bolt1
+	Color			0
+	Desc			bolt%s% of cloth
+	Weight			5
+	VendorSellsFor		60
+	VendorBuysFor		30
 }
 
 Item 0xf96
 {
-    Name            bolt2
-    Color           0
-    Desc            bolt%s% of cloth
-    Weight          5
-    VendorSellsFor  60
-    VendorBuysFor   30
+	Name			bolt2
+	Color			0
+	Desc			bolt%s% of cloth
+	Weight			5
+	VendorSellsFor		60
+	VendorBuysFor		30
 }
 
 Item 0xf97
 {
-    Name            bolt3
-    Color           0
-    Desc            bolt%s% of cloth
-    Weight          5
-    VendorSellsFor  60
-    VendorBuysFor   30
+	Name			bolt3
+	Color			0
+	Desc			bolt%s% of cloth
+	Weight			5
+	VendorSellsFor		60
+	VendorBuysFor		30
 }
 
 Item 0xf98
 {
-    Name            bolt4
-    Color           0
-    Desc            bolt%s% of cloth
-    Weight          5
-    VendorSellsFor  60
-    VendorBuysFor   30
+	Name			bolt4
+	Color			0
+	Desc			bolt%s% of cloth
+	Weight			5
+	VendorSellsFor		60
+	VendorBuysFor		30
 }
 
 Item 0xf99
 {
-    Name            bolt5
-    Color           0
-    Desc            bolt%s% of cloth
-    Weight          5
-    VendorSellsFor  60
-    VendorBuysFor   30
+	Name			bolt5
+	Color			0
+	Desc			bolt%s% of cloth
+	Weight			5
+	VendorSellsFor		60
+	VendorBuysFor		30
 }
 
 Item 0xf9a
 {
-    Name            bolt6
-    Color           0
-    Desc            bolt%s% of cloth
-    Weight          5
-    VendorSellsFor  60
-    VendorBuysFor   30
+	Name			bolt6
+	Color			0
+	Desc			bolt%s% of cloth
+	Weight			5
+	VendorSellsFor		60
+	VendorBuysFor		30
 }
 Item 0xf9b
 {
-    Name            bolt7
-    Color           0
-    Desc            bolt%s% of cloth
-    Weight          5
-    VendorSellsFor  60
-    VendorBuysFor   30
+	Name			bolt7
+	Color			0
+	Desc			bolt%s% of cloth
+	Weight			5
+	VendorSellsFor		60
+	VendorBuysFor		30
 }
 Item 0xf9c
 {
-    Name            bolt8
-    Color           0
-    Desc            bolt%s% of cloth
-    Weight          5
-    VendorSellsFor  60
-    VendorBuysFor   30
+	Name			bolt8
+	Color			0
+	Desc			bolt%s% of cloth
+	Weight			5
+	VendorSellsFor		60
+	VendorBuysFor		30
 }
 
 Item 0x1766
 {
-    Name            clothpiece
-    Color           0
-    Desc            cut cloth
-    Weight          1/10
-    VendorSellsFor  2
-    VendorBuysFor   0
+	Name			clothpiece
+	Color			0
+	Desc			cut cloth
+	Weight			1/10
+	VendorSellsFor		2
+	VendorBuysFor		0
 }
\ No newline at end of file

Modified: trunk/096/pkg/systems/combat/itemdesc.cfg
===================================================================
--- trunk/096/pkg/systems/combat/itemdesc.cfg	2005-11-03 03:10:28 UTC (rev 855)
+++ trunk/096/pkg/systems/combat/itemdesc.cfg	2005-11-03 03:20:10 UTC (rev 856)
@@ -49,7 +49,7 @@
 	MaxHP		35
 	strrequired	10
 	medloss		100
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13CD
@@ -62,7 +62,7 @@
 	MaxHP		35
 	strrequired	10
 	medloss		200
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13C6
@@ -76,7 +76,7 @@
 	MaxHP		35
 	strrequired	10
 	medloss		100
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1DB9
@@ -90,7 +90,7 @@
 	MaxHP		35
 	strrequired	15
 	medloss		400
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13CB
@@ -104,7 +104,7 @@
 	MaxHP		35
 	strrequired	10
 	medloss		200
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13CC
@@ -118,7 +118,7 @@
 	MaxHP		35
 	strrequired	15
 	medloss		300
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 Armor 0x13D3
 {
@@ -131,7 +131,7 @@
 	MaxHP		35
 	strrequired	15
 	medloss		300
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 # STUDDED LEATHER
@@ -146,7 +146,7 @@
 	MaxHP		40
 	strrequired	25
 	medloss		100
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 
 }
 
@@ -161,7 +161,7 @@
 	MaxHP		40
 	strrequired	25
 	medloss		100
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13D4
@@ -175,7 +175,7 @@
 	MaxHP		40
 	strrequired	25
 	medloss		150
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13DA
@@ -189,7 +189,7 @@
 	MaxHP		40
 	strrequired	35
 	medloss		400
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13DB
@@ -203,7 +203,7 @@
 	MaxHP		40
 	strrequired	35
 	medloss		500
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 
 }
 
@@ -224,7 +224,7 @@
 	strrequired	35
 	medloss		100
 	repairable	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	Cprop		type sranger
 }
 
@@ -242,7 +242,7 @@
 	strrequired	35
 	medloss		100
 	repairable	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	Cprop		type sranger
 }
 
@@ -260,7 +260,7 @@
 	strrequired	35
 	medloss		150
 	repairable	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	Cprop		type sranger
 }
 
@@ -278,7 +278,7 @@
 	strrequired	35
 	medloss		400
 	repairable	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	Cprop		type sranger
 }
 
@@ -296,7 +296,7 @@
 	strrequired	45
 	medloss		500
 	repairable	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	Cprop		type sranger
 }
 #####################
@@ -314,7 +314,7 @@
 	strrequired	35
 	medloss		500
 	GenderSpecific	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1c04
@@ -331,7 +331,7 @@
 	medloss		nomed
 	DexPenalty	5
 	GenderSpecific	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 
@@ -347,7 +347,7 @@
 	strrequired	15
 	medloss		300
 	GenderSpecific	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1C08
@@ -362,7 +362,7 @@
 	strrequired	10
 	medloss		200
 	GenderSpecific	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1C0A
@@ -377,7 +377,7 @@
 	strrequired	10
 	medloss		300
 	GenderSpecific	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 
 }
 
@@ -393,7 +393,7 @@
 	strrequired	25
 	medloss		400
 	GenderSpecific	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1C00
@@ -408,7 +408,7 @@
 	strrequired	10
 	medloss		200
 	GenderSpecific	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x170B
@@ -422,7 +422,7 @@
 	MaxHP		50
 	dyeable		1
 	medloss		0
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1711
@@ -436,7 +436,7 @@
 	MaxHP		50
 	dyeable		1
 	medloss		0
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 # CHAIN MAIL
@@ -453,7 +453,7 @@
 	strrequired	20
 	repairable	1
 	medloss		1000
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13C0
@@ -469,7 +469,7 @@
 	strrequired	20
 	repairable	1
 	medloss		1000
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13BE
@@ -485,7 +485,7 @@
 	repairable	1
 	medloss		1000
 	DexPenalty	3
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13C3
@@ -500,7 +500,7 @@
 	strrequired	20
 	repairable	1
 	medloss		1000
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13BF
@@ -517,7 +517,7 @@
 	repairable	1
 	medloss		2000
 	DexPenalty	5
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13C4
@@ -533,7 +533,7 @@
 	strrequired	20
 	repairable	1
 	medloss		2000
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 # Plate Helms
@@ -549,7 +549,7 @@
 	strrequired	40
 	repairable	1
 	medloss		1200
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1409
@@ -564,7 +564,7 @@
 	strrequired	40
 	repairable	1
 	medloss		1200
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x140A
@@ -579,7 +579,7 @@
 	strrequired	40
 	repairable	1
 	medloss		1200
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x140B
@@ -594,7 +594,7 @@
 	strrequired	40
 	repairable	1
 	medloss		1200
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x140C
@@ -609,7 +609,7 @@
 	strrequired	10
 	repairable	1
 	medloss		1200
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 
 }
 Armor 0x140D
@@ -624,7 +624,7 @@
 	strrequired	10
 	repairable	1
 	medloss		1200
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x140E
@@ -639,7 +639,7 @@
 	strrequired	40
 	repairable	1
 	medloss		1200
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 Armor 0x140F
 {
@@ -653,7 +653,7 @@
 	strrequired	40
 	repairable	1
 	medloss		1200
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1412
@@ -669,7 +669,7 @@
 	repairable	1
 	DexPenalty	1
 	medloss		1500
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1419
@@ -685,7 +685,7 @@
 	repairable	1
 	DexPenalty	1
 	medloss		1500
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 # SHIELDS
@@ -700,7 +700,7 @@
 	strrequired	20
 	repairable	1
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1B73
@@ -714,7 +714,7 @@
 	strrequired	15
 	repairable	1
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 
 }
 
@@ -729,7 +729,7 @@
 	strrequired	30
 	repairable	1
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 Armor 0x1B75
 {
@@ -742,7 +742,7 @@
 	strrequired	30
 	repairable	1
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1B76
@@ -756,7 +756,7 @@
 	strrequired	30
 	repairable	1
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 
 }
 Armor 0x1B77
@@ -770,7 +770,7 @@
 	strrequired	30
 	repairable	1
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1B78
@@ -784,7 +784,7 @@
 	strrequired	15
 	repairable	1
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1B79
@@ -798,7 +798,7 @@
 	strrequired	15
 	repairable	1
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1B7A
@@ -811,7 +811,7 @@
 	MaxHP		22
 	strrequired	5
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1B7B
@@ -825,7 +825,7 @@
 	strrequired	10
 	repairable	1
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1bc4
@@ -836,7 +836,7 @@
 	MaxHP		110
 	repairable	1
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1bc3
@@ -847,7 +847,7 @@
 	MaxHP		110
 	repairable	1
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 #RINGMAIL
@@ -864,7 +864,7 @@
 	repairable	1
 	medloss		1000
 	DexPenalty	2
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13ed
@@ -880,7 +880,7 @@
 	repairable	1
 	medloss		1000
 	DexPenalty	2
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13ee
@@ -895,7 +895,7 @@
 	repairable	1
 	medloss		500
 	DexPenalty	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 Armor 0x13ef
 {
@@ -908,7 +908,7 @@
 	strrequired	20
 	repairable	1
 	medloss		500
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13f0
@@ -924,7 +924,7 @@
 	repairable	1
 	medloss		700
 	DexPenalty	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13f1
@@ -940,7 +940,7 @@
 	repairable	1
 	medloss		700
 	DexPenalty	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x13f2
@@ -956,7 +956,7 @@
 	repairable	1
 	medloss		250
 	DexPenalty	1
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 # PLATE
@@ -973,7 +973,7 @@
 	repairable	1
 	DexPenalty	8
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 Armor 0x1416
 {
@@ -988,7 +988,7 @@
 	repairable	1
 	DexPenalty	8
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1410
@@ -1004,7 +1004,7 @@
 	repairable	1
 	DexPenalty	2
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 Armor 0x1417
 {
@@ -1019,7 +1019,7 @@
 	repairable	1
 	DexPenalty	2
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1411
@@ -1035,7 +1035,7 @@
 	repairable	1
 	DexPenalty	6
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 Armor 0x141A
 {
@@ -1050,7 +1050,7 @@
 	repairable	1
 	DexPenalty	6
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1414
@@ -1067,7 +1067,7 @@
 	DexPenalty	2
 	medloss		nomed
 	DexPenalty	2
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 Armor 0x1418
 {
@@ -1083,7 +1083,7 @@
 	DexPenalty	2
 	medloss		nomed
 	DexPenalty	2
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1413
@@ -1099,7 +1099,7 @@
 	repairable	1
 	DexPenalty	1
 	medloss		nomed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x144e
@@ -1112,7 +1112,7 @@
 	strrequired	40
 	medloss		700
 	DexPenalty	2
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x144f
@@ -1125,7 +1125,7 @@
 	strrequired	40
 	medloss		2000
 	DexPenalty	6
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1450
@@ -1137,7 +1137,7 @@
 	MaxHP		25
 	strrequired	40
 	medloss		500
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1451
@@ -1149,7 +1149,7 @@
 	MaxHP		25
 	strrequired	40
 	medloss		750
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1452
@@ -1162,7 +1162,7 @@
 	strrequired	40
 	medloss		1000
 	DexPenalty	4
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Armor 0x1f0b
@@ -1173,7 +1173,7 @@
 	Coverage	Head
 	MaxHP		55
 	medloss		500
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 #################
@@ -1199,7 +1199,7 @@
 	repairable	1
 	MinDam		5
 	MaxDam		33
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1223,7 +1223,7 @@
 	CProp		OnHit a1:S15::combat:maceHit
 	
 	Script		:lumberjacking:lumberjack
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1251,7 +1251,7 @@
 	minrange		0
 	maxrange		20
 	
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1279,7 +1279,7 @@
 	minrange		0
 	maxrange		20
 	
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1308,7 +1308,7 @@
 	minrange		0
 	maxrange		20
 	
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1331,7 +1331,7 @@
 	MinDam		6
 	MaxDam		33
 	
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 	Script		:lumberjacking:lumberjack
 }
@@ -1356,7 +1356,7 @@
 	MaxDam		38
 	
 	Script		:lumberjacking:lumberjack
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x0f4b
@@ -1379,7 +1379,7 @@
 	MaxDam		35
 	
 	Script		:lumberjacking:lumberjack
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x0f45
@@ -1402,7 +1402,7 @@
 	MaxDam		33
 	
 	Script		:lumberjacking:lumberjack
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1426,7 +1426,7 @@
 	MaxDam		38
 	
 	Script		:lumberjacking:lumberjack
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1451,7 +1451,7 @@
 	MaxDam		39
 	
 	Script		:lumberjacking:lumberjack
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1475,7 +1475,7 @@
 	MaxDam		33
 	
 	Script		:mining:mining
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -1498,7 +1498,7 @@
 	MinDam		8
 	MaxDam		32
 
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 
 	CProp		OnHit a1:S15::combat:maceHit
@@ -1522,7 +1522,7 @@
 	MinDam		7
 	MaxDam		27
 	
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 
 	CProp		OnHit a1:S15::combat:maceHit
@@ -1547,7 +1547,7 @@
 	MinDam		8
 	MaxDam		36
 	
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 	
 	CProp		OnHit a1:S15::combat:maceHit
@@ -1571,7 +1571,7 @@
 	MinDam		10
 	MaxDam		30
 	
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 	
 	CProp		OnHit a1:S15::combat:maceHit
@@ -1598,7 +1598,7 @@
 	
 	Script		:lumberjacking:lumberjack
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x143e
@@ -1623,7 +1623,7 @@
 	
 	Script		:lumberjacking:lumberjack
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x1402
@@ -1645,7 +1645,7 @@
 	MinDam		4
 	MaxDam		32
 	
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1668,7 +1668,7 @@
 	MinDam		2
 	MaxDam		36
 	
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1690,7 +1690,7 @@
 	MinDam		4
 	MaxDam		32
 	
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1713,7 +1713,7 @@
 	MinDam		7
 	MaxDam		31
 	
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1736,7 +1736,7 @@
 	MinDam		6
 	MaxDam		28
 	
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1759,7 +1759,7 @@
 	MaxDam		15
 	
 	Script		bladed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1782,7 +1782,7 @@
 	MaxDam		26
 	
 	Script		bladed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1806,7 +1806,7 @@
 	
 	Script		bladed
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x13b5
@@ -1828,7 +1828,7 @@
 	MaxDam		30
 	
 	Script		bladed
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
 
@@ -1853,7 +1853,7 @@
 	
 	Script		bladed
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x0f43
@@ -1876,7 +1876,7 @@
 	
 	Script		:lumberjacking:lumberjack
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x0e85
@@ -1898,7 +1898,7 @@
 	
 	Script		:mining:mining
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -1923,7 +1923,7 @@
 	
 	Script		bladed
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x0ec2
@@ -1946,7 +1946,7 @@
 	
 	Script		bladed
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x0ec4
@@ -1969,7 +1969,7 @@
 	
 	Script		bladed
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x13b3
@@ -1990,7 +1990,7 @@
 	MaxDam		24
 	
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -2016,7 +2016,7 @@
 	MaxDam		16
 	
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 	
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -2042,7 +2042,7 @@
 	MaxDam		33
 	
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x13f9
@@ -2065,7 +2065,7 @@
 	MaxDam		30
 	
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x0e8a
@@ -2088,7 +2088,7 @@
 	MaxDam		43
 	
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 
 Weapon 0x0e81
@@ -2112,7 +2112,7 @@
 	
 	script		:herding:herd
 	HitScript	mainHitScript
-	DestroyScript	destroy
+	DestroyScript	onDestroy
 }
 ############################
 #-----------------Newbie Equipment-------------------#
@@ -2233,7 +2233,7 @@
 	
 	Script		:blacksmithy:makeBlacksmithItems
 	HitScript	mainHitScript
-	DestroyScript	:combat:destroy
+	DestroyScript	onDestroy
 	
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -2254,7 +2254,7 @@
 	
 	Script		:blacksmithy:makeBlacksmithItems
 	HitScript	mainHitScript
-	DestroyScript	:combat:destroy
+	DestroyScript	onDestroy
 	
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -2273,7 +2273,7 @@
 	VendorBuysFor	18
 	
 	Script		:blacksmithy:makeBlacksmithItems
-	DestroyScript	:combat:destroy
+	DestroyScript	onDestroy
 		
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -2293,7 +2293,7 @@
 	
 	Script		:blacksmithy:makeBlacksmithItems
 	HitScript	mainHitScript
-	DestroyScript	:combat:destroy
+	DestroyScript	onDestroy
 	
 	CProp		OnHit a1:S15::combat:maceHit
 }

Added: trunk/096/pkg/systems/combat/onDestroy.src
===================================================================
--- trunk/096/pkg/systems/combat/onDestroy.src	2005-11-03 03:10:28 UTC (rev 855)
+++ trunk/096/pkg/systems/combat/onDestroy.src	2005-11-03 03:20:10 UTC (rev 856)
@@ -0,0 +1,20 @@
+/*
+ * $Id$
+ *
+ */
+ 
+use uo;
+
+include "include/equipment";
+
+program OnDestroy(item)
+	var equipped := CInt(GetObjProperty(item, "#EquippedOn"));
+	if ( !equipped )
+		return 1;
+	endif
+	
+	var mobile := SystemFindObjectBySerial(equipped);
+	
+	RemoveEquipmentMods(mobile, item);
+endprogram
+		
\ No newline at end of file



From austin at berlios.de  Thu Nov  3 04:21:42 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 04:21:42 +0100
Subject: [Poldistro-svn] r857 - trunk/096/pkg/skills/tailoring
Message-ID: <200511030321.jA33Lg8f022607@sheep.berlios.de>

Author: austin
Date: 2005-11-03 04:21:33 +0100 (Thu, 03 Nov 2005)
New Revision: 857

Modified:
   trunk/096/pkg/skills/tailoring/itemdesc.cfg
Log:
Hate tailoring! >_<
Keep missing entries.

onDestroy lines fixed.

Modified: trunk/096/pkg/skills/tailoring/itemdesc.cfg
===================================================================
--- trunk/096/pkg/skills/tailoring/itemdesc.cfg	2005-11-03 03:20:10 UTC (rev 856)
+++ trunk/096/pkg/skills/tailoring/itemdesc.cfg	2005-11-03 03:21:33 UTC (rev 857)
@@ -69,7 +69,7 @@
 	AR			2
 	Coverage		Legs/feet
 	MaxHP			20
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x170F
 {
@@ -80,7 +80,7 @@
 	AR			1
 	MaxHP			20
 	Coverage		Legs/feet
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1EFD
 {
@@ -92,7 +92,7 @@
 	MaxHP			20
 	Coverage		Body
 	Coverage		Arms
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1EFF
 {
@@ -105,7 +105,7 @@
 	Coverage		Body
 	Coverage		Legs/feet
 	Coverage		Arms
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1F01
 {
@@ -118,7 +118,7 @@
 	Coverage		Body
 	Coverage		Legs/feet
 	Coverage		Arms
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1F7B
 {
@@ -129,7 +129,7 @@
 	AR			3
 	MaxHP			20
 	Coverage		Body
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1F9F
 {
@@ -141,7 +141,7 @@
 	MaxHP			20
 	Coverage		Body
 	Coverage		Arms
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1FA1
 {
@@ -153,7 +153,7 @@
 	MaxHP			20
 	Coverage		Body
 	Coverage		Arms
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1FFD
 {
@@ -164,7 +164,7 @@
 	AR			2
 	MaxHP			20
 	Coverage		Body
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1517
 {
@@ -176,7 +176,7 @@
 	MaxHP			20
 	Coverage		Body
 	Coverage		Arms
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1515
 {
@@ -186,7 +186,7 @@
 	CanDye			1
 	AR			2
 	MaxHP			20
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1516
 {
@@ -197,7 +197,7 @@
 	AR			2
 	MaxHP			20
 	Coverage		Body
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x152E
 {
@@ -208,7 +208,7 @@
 	AR			1
 	MaxHP			20
 	Coverage		Legs/feet
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1537
 {
@@ -219,7 +219,7 @@
 	AR			1
 	MaxHP			20
 	Coverage		Legs/feet
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1539
 {
@@ -230,7 +230,7 @@
 	AR			3
 	MaxHP			20
 	Coverage		Legs/feet
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x153B
 {
@@ -241,7 +241,7 @@
 	AR			2
 	MaxHP			20
 	Coverage		Legs/feet
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x153D
 {
@@ -253,7 +253,7 @@
 	MaxHP			20
 	Coverage		Body
 	Coverage		Legs/feet
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x153F
 {
@@ -264,7 +264,7 @@
 	AR			1
 	MaxHP			20
 	Coverage		Head
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1541
 {
@@ -275,7 +275,7 @@
 	AR			1
 	MaxHP			20
 	Coverage		Body
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1543
 {
@@ -286,7 +286,7 @@
 	AR			1
 	MaxHP			20
 	Coverage		Head
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1713
 {
@@ -297,7 +297,7 @@
 	AR			2
 	MaxHP			20
 	Coverage		Head
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1714
 {
@@ -308,7 +308,7 @@
 	AR			2
 	MaxHP			20
 	Coverage		Head
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1715
 {
@@ -319,7 +319,7 @@
 	AR			1
 	MaxHP			20
 	Coverage		Head
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1719
 {
@@ -330,7 +330,7 @@
 	AR			1
 	MaxHP			20
 	Coverage		Head
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x171A
 {
@@ -341,7 +341,7 @@
 	AR			2
 	MaxHP			20
 	Coverage		Head
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x171B
 {
@@ -352,7 +352,7 @@
 	AR			2
 	MaxHP			20
 	Coverage		Head
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x171C
 {
@@ -363,7 +363,7 @@
 	AR			1
 	MaxHP			20
 	Coverage		Head
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 Armor 0x1716
 {
@@ -374,7 +374,7 @@
 	AR			1
 	MaxHP			20
 	Coverage		Head
-	DestroyScript		:combat:destroy
+	DestroyScript		:combat:onDestroy
 }
 
 Item 0xe1f



From austin at berlios.de  Thu Nov  3 04:25:43 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 04:25:43 +0100
Subject: [Poldistro-svn] r858 - in trunk/096/pkg: skills/tinkering systems/combat
Message-ID: <200511030325.jA33PhkY023192@sheep.berlios.de>

Author: austin
Date: 2005-11-03 04:25:43 +0100 (Thu, 03 Nov 2005)
New Revision: 858

Modified:
   trunk/096/pkg/skills/tinkering/itemdesc.cfg
   trunk/096/pkg/systems/combat/itemdesc.cfg
Log:
Found... more equip lines pointing to combat.

Modified: trunk/096/pkg/skills/tinkering/itemdesc.cfg
===================================================================
--- trunk/096/pkg/skills/tinkering/itemdesc.cfg	2005-11-03 03:21:33 UTC (rev 857)
+++ trunk/096/pkg/skills/tinkering/itemdesc.cfg	2005-11-03 03:25:43 UTC (rev 858)
@@ -1,215 +1,203 @@
 Item 0x1ebc
-{
-    Name            TinkerTools
-    Script          tinkering
-    VendorSellsFor  8
-    VendorBuysFor   4
+{	
+	Name			TinkerTools
+	Script			tinkering
+	VendorSellsFor		8
+	VendorBuysFor		4
 }
 
 Item 0x1eb9
 {
-    Name            TinkerTools2
-    Script          tinkering
-    VendorSellsFor  8
-    VendorBuysFor   4
+	Name			TinkerTools2
+	Script			tinkering
+	VendorSellsFor		8
+	VendorBuysFor		4
 }
 
 Item 0x1851
 {
-    Name            scales
-    VendorSellsFor  2
-    VendorBuysFor   1
-    movable         1
+	Name			scales
+	VendorSellsFor		2
+	VendorBuysFor		1
+	Movable			1
 }
 
 Item 0x1053
 {
-    Name            Gears
-    Script          makeComplexItem
-    VendorSellsFor  2
-    VendorBuysFor   1
+	Name			Gears
+	Script			makeComplexItem
+	VendorSellsFor		2
+	VendorBuysFor		1
 }
 
 Item 0x1051
 {
-    Name            Axleandgears
-    Script          makeComplexItem
-    VendorSellsFor  3
-    VendorBuysFor   1
+	Name			Axleandgears
+	Script			makeComplexItem
+	VendorSellsFor		3
+	VendorBuysFor		1
 }
 
 Item 0x1059
 {
-    Name            Sextantparts
-    Script          makeComplexItem
-    VendorSellsFor  6
-    VendorBuysFor   3
+	Name			Sextantparts
+	Script			makeComplexItem
+	VendorSellsFor		6
+	VendorBuysFor		3
 }
 
 Item 0x104d
 {
-    Name            Clockframe
-    Script          makeComplexItem
-    VendorSellsFor  3
-    VendorBuysFor   1
+	Name			Clockframe
+	Script			makeComplexItem
+	VendorSellsFor		3
+	VendorBuysFor		1
 }
 
 Item 0x104e
 {
-    Name            Clockframe2
-    Script          makeComplexItem
-    VendorSellsFor  3
-    VendorBuysFor   1
+	Name			Clockframe2
+	Script			makeComplexItem
+	VendorSellsFor		3
+	VendorBuysFor		1
 }
 
 Item 0x104c
 {
-    Name            clock
-    desc            clock
-    Script          :tinkering:time
-    VendorSellsFor  24
-    VendorBuysFor   12
+	Name			clock
+	desc			clock
+	Script			:tinkering:time
+	VendorSellsFor		24
+	VendorBuysFor		12
 }
 
 Item 0x1055
 {
-    Name            Hinge
-    Script          makeComplexItem
-    VendorSellsFor  2
-    VendorBuysFor   1
+	Name			Hinge
+	Script			makeComplexItem
+	VendorSellsFor		2
+	VendorBuysFor		1
 }
 
 Item 0x1085
 {
-    Name            silvernecklace
-    desc            silver necklace
-    equipscript     :combat:equip
-    unequipscript   :combat:unequip
-    destroyscript   :combat:destroy
-    VendorSellsFor  38
-    VendorBuysFor   19
+	Name			silvernecklace
+	desc			silver necklace
+	DestroyScript		:combat:onDestroy
+	VendorSellsFor		38
+	VendorBuysFor		19
 }
 
 Item 0x1086
 {
-    Name            bracelet
-    Desc            bracelet
-    equipscript     :combat:equip
-    unequipscript   :combat:unequip
-    destroyscript   :combat:destroy
-    VendorSellsFor  31
-    VendorBuysFor   15
+	Name			bracelet
+	Desc			bracelet
+	DestroyScript		:combat:onDestroy
+	VendorSellsFor		31
+	VendorBuysFor		15
 }
 
 Item 0x1087
 {
-    Name            earrings
-    Desc            earrings
-    equipscript     :combat:equip
-    unequipscript   :combat:unequip
-    destroyscript   :combat:destroy
-    VendorSellsFor  38
-    VendorBuysFor   19
+	Name			earrings
+	Desc			earrings
+	DestroyScript		:combat:onDestroy
+	VendorSellsFor		38
+	VendorBuysFor		19
 }
 
 Item 0x1088
 {
-    Name            roundnecklace
-    Desc            gold necklace
-    equipscript     :combat:equip
-    unequipscript   :combat:unequip
-    destroyscript   :combat:destroy
-    VendorSellsFor  31
-    VendorBuysFor   15
+	Name			roundnecklace
+	Desc			gold necklace
+	DestroyScript		:combat:onDestroy
+	VendorSellsFor		31
+	VendorBuysFor		15
 }
 
 Item 0x1089
 {
-    Name            longnecklace
-    Desc            gold necklace
-    equipscript     :combat:equip
-    unequipscript   :combat:unequip
-    destroyscript   :combat:destroy
-    VendorSellsFor  31
-    VendorBuysFor   15
+	Name			longnecklace
+	Desc			gold necklace
+	DestroyScript		:combat:onDestroy
+	VendorSellsFor		31
+	VendorBuysFor		15
 }
 
 Item 0x108a
 {
-    Name            ring
-    Desc            ring
-    equipscript     :combat:equip
-    unequipscript   :combat:unequip
-    destroyscript   :combat:destroy
-    VendorSellsFor  38
-    VendorBuysFor   19
+	Name			ring
+	Desc			ring
+	DestroyScript		:combat:onDestroy
+	VendorSellsFor		38
+	VendorBuysFor		19
 }
 
 Item 0x9f9
 {
-    Name            spoonw
-    VendorSellsFor  1
-    VendorBuysFor   1
+	Name			spoonw
+	VendorSellsFor		1
+	VendorBuysFor		1
 }
 
 
 Item 0x9f8
 {
-    Name            spoonn
-    VendorSellsFor  1
-    VendorBuysFor   1
+	Name			spoonn
+	VendorSellsFor		1
+	VendorBuysFor		1
 }
 
 
 Item 0x9d7
 {
-    Name            plate
-    VendorSellsFor  1
-    VendorBuysFor   1
+	Name			plate
+	VendorSellsFor		1
+	VendorBuysFor		1
 }
 
 Item 0x1000
 {
-    Name            pewter mug
-    VendorSellsFor  1
-    VendorBuysFor   1
+	Name			pewter mug
+	VendorSellsFor		1
+	VendorBuysFor		1
 }
 
 Item 0x9f7
 {
-    Name            knifew
-    VendorSellsFor  1
-    VendorBuysFor   1
+	Name			knifew
+	VendorSellsFor		1
+	VendorBuysFor		1
 }
 
 Item 0x9f6
 {
-    Name            knifen
-    VendorSellsFor  1
-    VendorBuysFor   1
+	Name			knifen
+	VendorSellsFor		1
+	VendorBuysFor		1
 }
 
 
 Item 0x99a
 {
-    Name            goblet
-    VendorSellsFor  1
-    VendorBuysFor   1
+	Name			goblet
+	VendorSellsFor		1
+	VendorBuysFor		1
 }
 
 Item 0x9f5
 {
-    Name            forkw
+	Name			forkw
 }
 
 Item 0x9f4
 {
-    Name            forkn
+	Name			forkn
 }
 
 
 Item 0x1047
 {
-    Name            globe
-    movable         1
+	Name			globe
+	Movable			1
 }
\ No newline at end of file

Modified: trunk/096/pkg/systems/combat/itemdesc.cfg
===================================================================
--- trunk/096/pkg/systems/combat/itemdesc.cfg	2005-11-03 03:21:33 UTC (rev 857)
+++ trunk/096/pkg/systems/combat/itemdesc.cfg	2005-11-03 03:25:43 UTC (rev 858)
@@ -3,10 +3,10 @@
 #
 #####################################
 #
-# pkg/std/combat/itemdesc.cfg - Weapons and Armor
+# pkg/std/combat/itemDesc.cfg - Weapons and Armor
 #
-# see pol/config/armrdesc.cfg for descriptions of armor entry formats
-# see pol/config/wepndesc.cfg for descriptions of weapon entry formats
+# see pol/config/armrDesc.cfg for Descriptions of armor entry formats
+# see pol/config/wepnDesc.cfg for Descriptions of weapon entry formats
 #
 #####################################
 
@@ -41,7 +41,7 @@
 Armor 0x13C7
 {
 	Name		LeatherGorget
-	desc		leather gorget
+	Desc		leather gorget
 	AR		13
 	Coverage	Neck
 	VendorSellsFor	74
@@ -55,7 +55,7 @@
 Armor 0x13CD
 {
 	Name		LeatherSleeves
-	desc		leather sleeves
+	Desc		leather sleeves
 	AR		13
 	VendorSellsFor	80
 	VendorBuysFor	40
@@ -68,7 +68,7 @@
 Armor 0x13C6
 {
 	Name		LeatherGloves
-	desc		leather gloves
+	Desc		leather gloves
 	AR		13
 	Coverage	Hands
 	VendorSellsFor	60
@@ -82,7 +82,7 @@
 Armor 0x1DB9
 {
 	Name		LeatherCap
-	desc		leather cap
+	Desc		leather cap
 	AR		13
 	Coverage	Head
 	VendorSellsFor	60
@@ -96,7 +96,7 @@
 Armor 0x13CB
 {
 	Name		LeatherLeggings
-	desc		leather leggings
+	Desc		leather leggings
 	AR		13
 	Coverage	Legs/feet
 	VendorSellsFor	80
@@ -110,7 +110,7 @@
 Armor 0x13CC
 {
 	Name		LeatherTunic
-	desc		leather tunic
+	Desc		leather tunic
 	AR		13
 	Coverage	Body
 	VendorSellsFor	101
@@ -123,7 +123,7 @@
 Armor 0x13D3
 {
 	Name		LeatherTunic2
-	desc		leather tunic
+	Desc		leather tunic
 	AR		13
 	Coverage	Body
 	VendorSellsFor	101
@@ -138,7 +138,7 @@
 Armor 0x13D6
 {
 	Name		StuddedGorget
-	desc		studded leather gorget
+	Desc		studded leather gorget
 	AR		16
 	Coverage	Neck
 	VendorSellsFor	73
@@ -153,7 +153,7 @@
 Armor 0x13D5
 {
 	Name		StuddedGloves
-	desc		studded leather gloves
+	Desc		studded leather gloves
 	AR		16
 	Coverage	Hands
 	VendorSellsFor	79
@@ -167,7 +167,7 @@
 Armor 0x13D4
 {
 	Name		StuddedSleeves
-	desc		studded leather sleeves
+	Desc		studded leather sleeves
 	AR		16
 	Coverage	Arms
 	VendorSellsFor	87
@@ -181,7 +181,7 @@
 Armor 0x13DA
 {
 	Name		StuddedLeggings
-	desc		studded leather leggings
+	Desc		studded leather leggings
 	AR		16
 	Coverage	Legs/feet
 	VendorSellsFor	103
@@ -195,7 +195,7 @@
 Armor 0x13DB
 {
 	Name		StuddedTunic
-	desc		studded leather tunic
+	Desc		studded leather tunic
 	AR		16
 	Coverage	Body
 	VendorSellsFor	128
@@ -213,7 +213,7 @@
 Armor 0x8100
 {
 	Name		RangerGorget
-	desc		studded gorget, ranger armor
+	Desc		studded gorget, ranger armor
 	graphic		0x13D6
 	AR		20
 	Coverage	Neck
@@ -231,7 +231,7 @@
 Armor 0x8101
 {
 	Name		RangerGloves
-	desc		studded gloves, ranger armor
+	Desc		studded gloves, ranger armor
 	graphic		0x13D5
 	color		34202
 	AR		20
@@ -249,7 +249,7 @@
 Armor 0x8102
 {
 	Name		RangerSleeves
-	desc		studded sleeves, ranger armor
+	Desc		studded sleeves, ranger armor
 	graphic		0x13D4
 	color		34202
 	AR		20
@@ -267,7 +267,7 @@
 Armor 0x8103
 {
 	Name		RangerLeggings
-	desc		studded leggings, ranger armor
+	Desc		studded leggings, ranger armor
 	graphic		0x13DA
 	color		34202
 	AR		20
@@ -285,7 +285,7 @@
 Armor 0x8104
 {
 	Name		RangerTunic
-	desc		studded tunic, ranger armor
+	Desc		studded tunic, ranger armor
 	graphic		0x13DB
 	color		34202
 	AR		20
@@ -305,7 +305,7 @@
 Armor 0x1C02
 {
 	Name		FemaleStudded
-	desc		female studded armor
+	Desc		female studded armor
 	AR		16
 	Coverage	Body
 	VendorSellsFor	142
@@ -320,7 +320,7 @@
 Armor 0x1c04
 {
 	Name		FemalePlate
-	desc		female plate armor
+	Desc		female plate armor
 	AR		30
 	Coverage	body
 	VendorSellsFor	245
@@ -338,7 +338,7 @@
 Armor 0x1C06
 {
 	Name		FemaleLeather
-	desc		female leather armor
+	Desc		female leather armor
 	AR		13
 	Coverage	Body
 	VendorSellsFor	116
@@ -353,7 +353,7 @@
 Armor 0x1C08
 {
 	Name		LeatherSkirt
-	desc		leather skirt
+	Desc		leather skirt
 	AR		13
 	Coverage	Legs/feet
 	VendorSellsFor	87
@@ -368,7 +368,7 @@
 Armor 0x1C0A
 {
 	Name		LeatherBustier
-	desc		leather bustier
+	Desc		leather bustier
 	AR		13
 	Coverage	Body
 	VendorSellsFor	97
@@ -384,7 +384,7 @@
 Armor 0x1C0C
 {
 	Name		StuddedBustier
-	desc		studded bustier
+	Desc		studded bustier
 	AR		16
 	Coverage	Body
 	VendorSellsFor	120
@@ -399,7 +399,7 @@
 Armor 0x1C00
 {
 	Name		LeatherShorts
-	desc		leather shorts
+	Desc		leather shorts
 	AR		13
 	Coverage	Legs/feet
 	VendorSellsFor	86
@@ -414,7 +414,7 @@
 Armor 0x170B
 {
 	Name		LeatherBoots
-	desc		boots
+	Desc		boots
 	AR		1
 	Coverage	Legs/feet
 	VendorSellsFor	43
@@ -428,7 +428,7 @@
 Armor 0x1711
 {
 	Name		ThighBoots
-	desc		thigh boots
+	Desc		thigh boots
 	AR		1
 	Coverage	Legs/feet
 	VendorSellsFor	56
@@ -443,7 +443,7 @@
 Armor 0x13BB
 {
 	Name		ChainmailCoif
-	desc		chainmail coif
+	Desc		chainmail coif
 	AR		23
 	Coverage	Head
 	Coverage	Neck
@@ -459,7 +459,7 @@
 Armor 0x13C0
 {
 	Name		ChainmailCoif2
-	desc		chainmail coif
+	Desc		chainmail coif
 	AR		23
 	Coverage	Head
 	Coverage	Neck
@@ -475,7 +475,7 @@
 Armor 0x13BE
 {
 	Name		ChainmailLeggings
-	desc		chainmail leggings
+	Desc		chainmail leggings
 	AR		23
 	Coverage	Legs/feet
 	VendorSellsFor	166
@@ -491,7 +491,7 @@
 Armor 0x13C3
 {
 	Name		ChainmailLeggings2
-	desc		chainmail leggings
+	Desc		chainmail leggings
 	AR		23
 	Coverage	Legs/feet
 	VendorSellsFor	166
@@ -506,7 +506,7 @@
 Armor 0x13BF
 {
 	Name		ChainmailTunic
-	desc		chainmail tunic
+	Desc		chainmail tunic
 	AR		23
 	Coverage	Arms
 	Coverage	Body
@@ -523,7 +523,7 @@
 Armor 0x13C4
 {
 	Name		ChainmailTunic2
-	desc		chainmail tunic
+	Desc		chainmail tunic
 	AR		23
 	Coverage	Arms
 	Coverage	Body
@@ -540,7 +540,7 @@
 Armor 0x1408
 {
 	Name		CloseHelm
-	desc		closed helm
+	Desc		closed helm
 	AR		30
 	Coverage	Head
 	VendorSellsFor	145
@@ -555,7 +555,7 @@
 Armor 0x1409
 {
 	Name		CloseHelm2
-	desc		closed helm
+	Desc		closed helm
 	AR		30
 	Coverage	Head
 	VendorSellsFor	145
@@ -570,7 +570,7 @@
 Armor 0x140A
 {
 	Name		Helmet
-	desc		helmet
+	Desc		helmet
 	AR		30
 	Coverage	Head
 	VendorSellsFor	145
@@ -585,7 +585,7 @@
 Armor 0x140B
 {
 	Name		Helmet2
-	desc		helmet
+	Desc		helmet
 	AR		30
 	Coverage	Head
 	VendorSellsFor	145
@@ -600,7 +600,7 @@
 Armor 0x140C
 {
 	Name		Bascinet
-	desc		bascinet
+	Desc		bascinet
 	AR		30
 	Coverage	Head
 	VendorSellsFor	127
@@ -615,7 +615,7 @@
 Armor 0x140D
 {
 	Name		Bascinet2
-	desc		bascinet
+	Desc		bascinet
 	AR		30
 	Coverage	Head
 	VendorSellsFor	127
@@ -630,7 +630,7 @@
 Armor 0x140E
 {
 	Name		NoseHelm
-	desc		nose helm
+	Desc		nose helm
 	AR		30
 	Coverage	Head
 	VendorSellsFor	145
@@ -644,7 +644,7 @@
 Armor 0x140F
 {
 	Name		NoseHelm2
-	desc		nose helm
+	Desc		nose helm
 	AR		30
 	Coverage	Head
 	VendorSellsFor	145
@@ -659,7 +659,7 @@
 Armor 0x1412
 {
 	Name		PlateHelm
-	desc		platemail helm
+	Desc		platemail helm
 	AR		30
 	Coverage	Head
 	VendorSellsFor	170
@@ -675,7 +675,7 @@
 Armor 0x1419
 {
 	Name		PlateHelm2
-	desc		platemail helm
+	Desc		platemail helm
 	AR		30
 	Coverage	Head
 	VendorSellsFor	170
@@ -692,7 +692,7 @@
 Armor 0x1B72
 {
 	Name		BronzeShield
-	desc		round shield
+	Desc		round shield
 	AR		10
 	VendorSellsFor	91
 	VendorBuysFor	45
@@ -706,7 +706,7 @@
 Armor 0x1B73
 {
 	Name		Buckler
-	desc		buckler
+	Desc		buckler
 	AR		7
 	VendorSellsFor	66
 	VendorBuysFor	33
@@ -721,7 +721,7 @@
 Armor 0x1B74
 {
 	Name		KiteShield
-	desc		metal kite shield
+	Desc		metal kite shield
 	AR		16
 	VendorSellsFor	135
 	VendorBuysFor	67
@@ -734,7 +734,7 @@
 Armor 0x1B75
 {
 	Name		KiteShield2
-	desc		metal kite shield
+	Desc		metal kite shield
 	AR		16
 	VendorSellsFor	135
 	VendorBuysFor	67
@@ -748,7 +748,7 @@
 Armor 0x1B76
 {
 	Name		HeaterShield
-	desc		heater shield
+	Desc		heater shield
 	AR		23
 	VendorSellsFor	175
 	VendorBuysFor	87
@@ -762,7 +762,7 @@
 Armor 0x1B77
 {
 	Name		HeaterShield2
-	desc		heater shield
+	Desc		heater shield
 	AR		23
 	VendorSellsFor	175
 	VendorBuysFor	87
@@ -776,7 +776,7 @@
 Armor 0x1B78
 {
 	Name		KiteShieldB1
-	desc		tear kite shield
+	Desc		tear kite shield
 	AR		7
 	VendorSellsFor	121
 	VendorBuysFor	60
@@ -790,7 +790,7 @@
 Armor 0x1B79
 {
 	Name		KiteShieldB2
-	desc		tear kite shield
+	Desc		tear kite shield
 	AR		7
 	VendorSellsFor	121
 	VendorBuysFor	60
@@ -804,7 +804,7 @@
 Armor 0x1B7A
 {
 	Name		WoodenShield
-	desc		wooden shield
+	Desc		wooden shield
 	AR		8
 	VendorSellsFor	64
 	VendorBuysFor	32
@@ -817,7 +817,7 @@
 Armor 0x1B7B
 {
 	Name		MetalShield
-	desc		metal shield
+	Desc		metal shield
 	AR		9
 	VendorSellsFor	98
 	VendorBuysFor	49
@@ -831,7 +831,7 @@
 Armor 0x1bc4
 {
 	Name		Ordershield
-	desc		an order shield
+	Desc		an order shield
 	AR		30
 	MaxHP		110
 	repairable	1
@@ -842,7 +842,7 @@
 Armor 0x1bc3
 {
 	Name		Chaosshield
-	desc		chaos shield
+	Desc		chaos shield
 	AR		32
 	MaxHP		110
 	repairable	1
@@ -854,7 +854,7 @@
 Armor 0x13ec
 {
 	Name		RingmailTunic
-	desc		ringmail tunic
+	Desc		ringmail tunic
 	AR		20
 	Coverage	Body
 	VendorSellsFor	218
@@ -870,7 +870,7 @@
 Armor 0x13ed
 {
 	Name		RingmailTunic2
-	desc		ringmail tunic
+	Desc		ringmail tunic
 	AR		20
 	Coverage	Body
 	VendorSellsFor	218
@@ -886,7 +886,7 @@
 Armor 0x13ee
 {
 	Name		RingmailSleeves
-	desc		ringmail sleeves
+	Desc		ringmail sleeves
 	AR		20
 	VendorSellsFor	127
 	VendorBuysFor	63
@@ -900,7 +900,7 @@
 Armor 0x13ef
 {
 	Name		RingmailSleeves2
-	desc		ringmail sleeves
+	Desc		ringmail sleeves
 	AR		20
 	VendorSellsFor	127
 	VendorBuysFor	63
@@ -914,7 +914,7 @@
 Armor 0x13f0
 {
 	Name		RingmailLeggings
-	desc		ringmail leggings
+	Desc		ringmail leggings
 	AR		20
 	Coverage	Legs/Feet
 	VendorSellsFor	147
@@ -930,7 +930,7 @@
 Armor 0x13f1
 {
 	Name		RingmailLeggings2
-	desc		ringmail leggings
+	Desc		ringmail leggings
 	AR		20
 	Coverage	Legs/Feet
 	VendorSellsFor	147
@@ -946,7 +946,7 @@
 Armor 0x13f2
 {
 	Name		RingmailGloves
-	desc		ringmail gloves
+	Desc		ringmail gloves
 	AR		20
 	Coverage	Hands
 	VendorSellsFor	79
@@ -963,7 +963,7 @@
 Armor 0x1415
 {
 	Name		PlatemailBreastplate
-	desc		platemail breastplate
+	Desc		platemail breastplate
 	AR		30
 	Coverage	Body
 	VendorSellsFor	273
@@ -978,7 +978,7 @@
 Armor 0x1416
 {
 	Name		PlatemailBreastplate2
-	desc		platemail breastplate
+	Desc		platemail breastplate
 	AR		30
 	Coverage	Body
 	VendorSellsFor	273
@@ -994,7 +994,7 @@
 Armor 0x1410
 {
 	Name		PlatemailArms
-	desc		platemail arms
+	Desc		platemail arms
 	AR		30
 	Coverage	Arms
 	VendorSellsFor	181
@@ -1009,7 +1009,7 @@
 Armor 0x1417
 {
 	Name		PlatemailArms2
-	desc		platemail arms
+	Desc		platemail arms
 	AR		30
 	Coverage	Arms
 	VendorSellsFor	181
@@ -1025,7 +1025,7 @@
 Armor 0x1411
 {
 	Name		PlatemailLegs
-	desc		platemail leggings
+	Desc		platemail leggings
 	AR		30
 	Coverage	Legs/Feet
 	VendorSellsFor	218
@@ -1040,7 +1040,7 @@
 Armor 0x141A
 {
 	Name		PlatemailLegs2
-	desc		platemail leggings
+	Desc		platemail leggings
 	AR		30
 	Coverage	Legs/Feet
 	VendorSellsFor	218
@@ -1056,7 +1056,7 @@
 Armor 0x1414
 {
 	Name		PlatemailGloves
-	desc		platemail gloves
+	Desc		platemail gloves
 	AR		30
 	Coverage	Hands
 	VendorSellsFor	122
@@ -1072,7 +1072,7 @@
 Armor 0x1418
 {
 	Name		PlatemailGloves2
-	desc		platemail gloves
+	Desc		platemail gloves
 	AR		30
 	Coverage	Hands
 	VendorSellsFor	122
@@ -1089,7 +1089,7 @@
 Armor 0x1413
 {
 	Name		PlatemailGorget
-	desc		platemail gorget
+	Desc		platemail gorget
 	AR		30
 	Coverage	Neck
 	VendorSellsFor	124
@@ -1105,7 +1105,7 @@
 Armor 0x144e
 {
 	Name		Bonearms
-	desc		bone arms
+	Desc		bone arms
 	AR		30
 	Coverage	Arms
 	MaxHP		25
@@ -1118,7 +1118,7 @@
 Armor 0x144f
 {
 	Name		Bonetunic
-	desc		bone tunic
+	Desc		bone tunic
 	AR		30
 	Coverage	Body
 	MaxHP		25
@@ -1131,7 +1131,7 @@
 Armor 0x1450
 {
 	Name		Bonegloves
-	desc		bone gloves
+	Desc		bone gloves
 	AR		30
 	Coverage	Hands
 	MaxHP		25
@@ -1143,7 +1143,7 @@
 Armor 0x1451
 {
 	Name		Bonehelm
-	desc		bone helm
+	Desc		bone helm
 	AR		30
 	Coverage	Head
 	MaxHP		25
@@ -1155,7 +1155,7 @@
 Armor 0x1452
 {
 	Name		Bonelegs
-	desc		bone leggings
+	Desc		bone leggings
 	AR		30
 	Coverage	Legs/feet
 	MaxHP		25
@@ -1168,7 +1168,7 @@
 Armor 0x1f0b
 {
 	Name		Orchelm
-	desc		an orc helm
+	Desc		an orc helm
 	AR		20
 	Coverage	Head
 	MaxHP		55
@@ -1183,7 +1183,7 @@
 Weapon 0x0F60
 {
 	Name		longsword
-	desc		longsword
+	Desc		longsword
 	Default		1
 	Speed		35
 	Damage		2d15+3
@@ -1206,7 +1206,7 @@
 Weapon 0x13AF
 {
 	Name		WarAxe
-	desc		war axe
+	Desc		war axe
 	Speed		40
 	Damage		6d4+3
 	Attribute	Macefighting
@@ -1230,7 +1230,7 @@
 Weapon 0x13B2
 {
 	Name		Bow
-	desc		bow
+	Desc		bow
 	Speed		20
 	Damage		4d9+5
 	Attribute	Archery
@@ -1258,7 +1258,7 @@
 Weapon 0x0f4f
 {
 	Name		Crossbow
-	desc		crossbow
+	Desc		crossbow
 	Speed		18
 	Damage		5d8+3
 	Attribute	Archery
@@ -1286,7 +1286,7 @@
 Weapon 0x13fd
 {
 	Name		HeavyCrossbow
-	desc		heavy crossbow
+	Desc		heavy crossbow
 	Speed		10
 	Damage		5d10+6
 	Attribute	Archery
@@ -1315,7 +1315,7 @@
 Weapon 0x0f49
 {
 	Name		Axe
-	desc		axe
+	Desc		axe
 	Speed		37
 	Damage		3d10+3
 	Attribute	Swordsmanship
@@ -1339,7 +1339,7 @@
 Weapon 0x0f47
 {
 	Name		BattleAxe
-	desc		battle axe
+	Desc		battle axe
 	Speed		30
 	Damage		2d17+4
 	Attribute	Swordsmanship
@@ -1362,7 +1362,7 @@
 Weapon 0x0f4b
 {
 	Name		DoubleAxe
-	desc		double axe
+	Desc		double axe
 	Speed		37
 	Damage		1d31+4
 	Attribute	Swordsmanship
@@ -1385,7 +1385,7 @@
 Weapon 0x0f45
 {
 	Name		ExecutionersAxe
-	desc		executioner's axe
+	Desc		executioner's axe
 	Speed		37
 	Damage		3d10+3
 	Attribute	Swordsmanship
@@ -1409,7 +1409,7 @@
 Weapon 0x13fa
 {
 	Name		LargeBattleAxe
-	desc		large battle axe
+	Desc		large battle axe
 	Speed		30
 	Damage		2d17+4
 	Attribute	Swordsmanship
@@ -1433,7 +1433,7 @@
 Weapon 0x1442
 {
 	Name		TwoHandedAxe
-	desc		two handed axe
+	Desc		two handed axe
 	Speed		30
 	Damage		2d18+3
 	Attribute	Swordsmanship
@@ -1458,7 +1458,7 @@
 Weapon 0x143c
 {
 	Name		HammerPick
-	desc		hammer pick
+	Desc		hammer pick
 	Speed		30
 	Damage		3d10+3
 	Attribute	Macefighting
@@ -1483,7 +1483,7 @@
 Weapon 0x0f5c
 {
 	Name		Mace
-	desc		mace
+	Desc		mace
 	Speed		30
 	Damage		6d5+2
 	Anim		0x000b
@@ -1507,7 +1507,7 @@
 Weapon 0x143a
 {
 	Name		Maul
-	desc		maul
+	Desc		maul
 	Speed		30
 	Damage		5d5+5
 	Attribute	Macefighting
@@ -1531,7 +1531,7 @@
 Weapon 0x1438
 {
 	Name		WarHammer
-	desc		war hammer
+	Desc		war hammer
 	Speed		31
 	Damage		7d5+1
 	Attribute	Macefighting
@@ -1556,7 +1556,7 @@
 Weapon 0x1406
 {
 	Name		WarMace
-	desc		war mace
+	Desc		war mace
 	Speed		32
 	Damage		5d5+5
 	Attribute	Macefighting
@@ -1580,7 +1580,7 @@
 Weapon 0x0f4e
 {
 	Name		Bardiche
-	desc		bardiche
+	Desc		bardiche
 	Speed		26
 	Damage		2d18+3
 	Attribute	Swordsmanship
@@ -1604,7 +1604,7 @@
 Weapon 0x143e
 {
 	Name		Halberd
-	desc		halberd
+	Desc		halberd
 	Speed		25
 	Damage		8d5+3
 	Attribute	Swordsmanship
@@ -1629,7 +1629,7 @@
 Weapon 0x1402
 {
 	Name		ShortSpear
-	desc		short spear
+	Desc		short spear
 	Speed		50
 	Damage		2d15+2
 	Attribute	Fencing
@@ -1652,7 +1652,7 @@
 Weapon 0x0f63
 {
 	Name		Spear
-	desc		spear
+	Desc		spear
 	Speed		46
 	Damage		2d18
 	Attribute	Fencing
@@ -1675,7 +1675,7 @@
 Weapon 0x1404
 {
 	Name		WarFork
-	desc		war fork
+	Desc		war fork
 	Speed		45
 	Damage		1d29+3
 	Attribute	Fencing
@@ -1697,7 +1697,7 @@
 Weapon 0x0f5e
 {
 	Name		BroadSword
-	desc		broadsword
+	Desc		broadsword
 	Speed		45
 	Damage		2d13+3
 	Attribute	Swordsmanship
@@ -1720,7 +1720,7 @@
 Weapon 0x1440
 {
 	Name		Cutlass
-	desc		cutlass
+	Desc		cutlass
 	Speed		45
 	Damage		2d12+4
 	Attribute	Swordsmanship
@@ -1743,7 +1743,7 @@
 Weapon 0x0f51
 {
 	Name		Dagger
-	desc		dagger
+	Desc		dagger
 	Speed		55
 	Damage		2d4
 	Attribute	Fencing
@@ -1766,7 +1766,7 @@
 Weapon 0x13fe
 {
 	Name		Katana
-	desc		katana
+	Desc		katana
 	Speed		58
 	Damage		3d8+2
 	Attribute	Swordsmanship
@@ -1789,7 +1789,7 @@
 Weapon 0x1401
 {
 	Name		Kryss
-	desc		kryss
+	Desc		kryss
 	Speed		53
 	Damage		1d26+2
 	Attribute	Fencing
@@ -1812,7 +1812,7 @@
 Weapon 0x13b5
 {
 	Name		Scimitar
-	desc		scimitar
+	Desc		scimitar
 	Speed		43
 	Damage		2d14+2
 	Attribute	Swordsmanship
@@ -1835,7 +1835,7 @@
 Weapon 0x13b9
 {
 	Name		VikingSword
-	desc		viking sword
+	Desc		viking sword
 	Speed		30
 	Damage		4d8+2
 	Attribute	Swordsmanship
@@ -1859,7 +1859,7 @@
 Weapon 0x0f43
 {
 	Name		Hatchet
-	desc		hatchet
+	Desc		hatchet
 	Speed		40
 	Damage		2d8+1
 	Attribute	Swordsmanship
@@ -1882,7 +1882,7 @@
 Weapon 0x0e85
 {
 	Name		Pickaxe
-	desc		pickaxe
+	Desc		pickaxe
 	Speed		35
 	Damage		1d15
 	Attribute	Macefighting
@@ -1906,7 +1906,7 @@
 Weapon 0x13f6
 {
 	Name		ButcherKnife
-	desc		butcher's knife
+	Desc		butcher's knife
 	Speed		40
 	Damage		2d2
 	Attribute	Swordsmanship
@@ -1929,7 +1929,7 @@
 Weapon 0x0ec2
 {
 	Name		Cleaver
-	desc		cleaver
+	Desc		cleaver
 	Speed		40
 	Damage		1d7
 	Attribute	Swordsmanship
@@ -1952,7 +1952,7 @@
 Weapon 0x0ec4
 {
 	Name		SkinningKnife
-	desc		skinning knife
+	Desc		skinning knife
 	Speed		40
 	Damage		1d5
 	Attribute	Swordsmanship
@@ -1975,7 +1975,7 @@
 Weapon 0x13b3
 {
 	Name		Club
-	desc		club
+	Desc		club
 	Speed		40
 	Damage		4d5+4
 	Attribute	Macefighting
@@ -1998,7 +1998,7 @@
 Weapon 0x0e87
 {
 	Name		Pitchfork
-	desc		pitchfork
+	Desc		pitchfork
 	Speed		45
 	Damage		4d4
 	Attribute	Fencing
@@ -2024,7 +2024,7 @@
 Weapon 0x0df0
 {
 	Name		BlackStaff
-	desc		black staff
+	Desc		black staff
 	Speed		35
 	Damage		5d6+3
 	Attribute	Macefighting
@@ -2048,7 +2048,7 @@
 Weapon 0x13f9
 {
 	Name		GnarledStaff
-	desc		gnarled staff
+	Desc		gnarled staff
 	Speed		33
 	Damage		5d5+5
 	Attribute	Macefighting
@@ -2071,7 +2071,7 @@
 Weapon 0x0e8a
 {
 	Name		Quarterstaff
-	desc		quarterstaff
+	Desc		quarterstaff
 	Speed		48
 	Damage		5d5+3
 	Attribute	Macefighting
@@ -2094,7 +2094,7 @@
 Weapon 0x0e81
 {
 	Name		ShepherdsCrook
-	desc		shepherd's crook
+	Desc		shepherd's crook
 	Speed		30
 	Damage		3d4
 	Attribute	Macefighting
@@ -2120,7 +2120,7 @@
 Armor 0x988d
 {
 	Name		practiceshield
-	desc		wooden shield
+	Desc		wooden shield
 	Graphic		0x1b7a
 	AR		2
 	Newbie		1
@@ -2132,7 +2132,7 @@
 Weapon 0x988c
 {
 	Name		practicelongsword
-	desc		practice longsword
+	Desc		practice longsword
 	graphic		0x0F60
 	Speed		35
 	Damage		2d4
@@ -2154,7 +2154,7 @@
 Weapon 0x988b
 {
 	Name		practicemace
-	desc		practice mace
+	Desc		practice mace
 	graphic		0x0f5c
 	Speed		30
 	Damage		2d4
@@ -2175,7 +2175,7 @@
 Weapon 0x988a
 {
 	Name		practicekryss
-	desc		practice kryss
+	Desc		practice kryss
 	graphic		0x1401
 	Speed		53
 	Damage		2d4
@@ -2196,7 +2196,7 @@
 Weapon 0x9889
 {
 	Name		practicebow
-	desc		practice bow
+	Desc		practice bow
 	graphic		0x13B2
 	Speed		20
 	Damage		2d4
@@ -2301,7 +2301,7 @@
 Weapon 0xdf2
 {
 	Name		magicwand1
-	desc		wand
+	Desc		wand
 	Weight		1
 	Speed		35
 	Damage		2d3
@@ -2319,7 +2319,7 @@
 Weapon 0xdf3
 {
 	Name		magicwand2
-	desc		wand
+	Desc		wand
 	Weight		1
 	Speed		35
 	Damage		2d3
@@ -2337,7 +2337,7 @@
 Weapon 0xdf4
 {
 	Name		magicwand3
-	desc		wand
+	Desc		wand
 	Weight		1
 	Speed		35
 	Damage		2d3
@@ -2355,7 +2355,7 @@
 Weapon 0xdf5
 {
 	Name		magicwand4
-	desc		wand
+	Desc		wand
 	Weight		1
 	Speed		35
 	Damage		2d3



From austin at berlios.de  Thu Nov  3 04:30:55 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 04:30:55 +0100
Subject: [Poldistro-svn] r859 - in trunk/096/pkg/systems/combat: . hooks useScripts
Message-ID: <200511030330.jA33Ut27023924@sheep.berlios.de>

Author: austin
Date: 2005-11-03 04:30:45 +0100 (Thu, 03 Nov 2005)
New Revision: 859

Added:
   trunk/096/pkg/systems/combat/useScripts/
   trunk/096/pkg/systems/combat/useScripts/bladed.src
Modified:
   trunk/096/pkg/systems/combat/hooks/combatAdv.src
   trunk/096/pkg/systems/combat/itemdesc.cfg
Log:
Updated itemdesc.cfg entries to point to the new location for bladed.src.

Fixed console warning for CombatAdvancementHook.

Modified: trunk/096/pkg/systems/combat/hooks/combatAdv.src
===================================================================
--- trunk/096/pkg/systems/combat/hooks/combatAdv.src	2005-11-03 03:25:43 UTC (rev 858)
+++ trunk/096/pkg/systems/combat/hooks/combatAdv.src	2005-11-03 03:30:45 UTC (rev 859)
@@ -12,9 +12,10 @@
 //
 // NOTE: This function is called EVEN IF THE ATTACK DIDN'T SUCCEED!
 //
-exported function CombatAdvancement(attacker,defender)
+exported function CombatAdvancement(attacker, weapon, defender)
 	// Eliminates compiler warnings
 	attacker := attacker;
+	weapon := weapon;
 	defender := defender;
 	
 	// Advancement currently handled in mainHitScript

Modified: trunk/096/pkg/systems/combat/itemdesc.cfg
===================================================================
--- trunk/096/pkg/systems/combat/itemdesc.cfg	2005-11-03 03:25:43 UTC (rev 858)
+++ trunk/096/pkg/systems/combat/itemdesc.cfg	2005-11-03 03:30:45 UTC (rev 859)
@@ -1190,7 +1190,7 @@
 	Attribute	Swordsmanship
 	Anim		0x0009
 	MaxHP		60
-	Script		bladed
+	Script		useScripts/bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	60
@@ -1703,7 +1703,7 @@
 	Attribute	Swordsmanship
 	Anim		0x0009
 	MaxHP		65
-	Script		bladed
+	Script		useScripts/bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	44
@@ -1726,7 +1726,7 @@
 	Attribute	Swordsmanship
 	Anim		0x0009
 	MaxHP		55
-	Script		bladed
+	Script		useScripts/bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	VendorSellsFor	32
@@ -1758,7 +1758,7 @@
 	MinDam		3
 	MaxDam		15
 	
-	Script		bladed
+	Script		useScripts/bladed
 	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
@@ -1781,7 +1781,7 @@
 	MinDam		5
 	MaxDam		26
 	
-	Script		bladed
+	Script		useScripts/bladed
 	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
@@ -1804,7 +1804,7 @@
 	MinDam		3
 	MaxDam		28
 	
-	Script		bladed
+	Script		useScripts/bladed
 	HitScript	mainHitScript
 	DestroyScript	onDestroy
 }
@@ -1827,7 +1827,7 @@
 	MinDam		4
 	MaxDam		30
 	
-	Script		bladed
+	Script		useScripts/bladed
 	DestroyScript	onDestroy
 	HitScript	mainHitScript
 }
@@ -1851,7 +1851,7 @@
 	MinDam		8
 	MaxDam		36
 	
-	Script		bladed
+	Script		useScripts/bladed
 	HitScript	mainHitScript
 	DestroyScript	onDestroy
 }
@@ -1921,7 +1921,7 @@
 	MinDam		2
 	MaxDam		14
 	
-	Script		bladed
+	Script		useScripts/bladed
 	HitScript	mainHitScript
 	DestroyScript	onDestroy
 }
@@ -1944,7 +1944,7 @@
 	MinDam		2
 	MaxDam		13
 	
-	Script		bladed
+	Script		useScripts/bladed
 	HitScript	mainHitScript
 	DestroyScript	onDestroy
 }
@@ -1967,7 +1967,7 @@
 	MinDam		1
 	MaxDam		4
 	
-	Script		bladed
+	Script		useScripts/bladed
 	HitScript	mainHitScript
 	DestroyScript	onDestroy
 }
@@ -2139,7 +2139,7 @@
 	Attribute	Swordsmanship
 	Anim		0x0009
 	MaxHP		60
-	Script		bladed
+	Script		useScripts/bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	newbie		1
@@ -2182,7 +2182,7 @@
 	Attribute	Fencing
 	Anim		0x000a
 	MaxHP		60
-	Script		bladed
+	Script		useScripts/bladed
 	HitSound	0x23C
 	MissSound	0x23A
 	newbie		1

Added: trunk/096/pkg/systems/combat/useScripts/bladed.src
===================================================================
--- trunk/096/pkg/systems/combat/useScripts/bladed.src	2005-11-03 03:25:43 UTC (rev 858)
+++ trunk/096/pkg/systems/combat/useScripts/bladed.src	2005-11-03 03:30:45 UTC (rev 859)
@@ -0,0 +1,93 @@
+// //$Id: bladed.src 806 2005-11-01 21:56:02Z austin $
+
+
+use cfgfile;
+use uo;
+use os;
+use util;
+
+include "include/client";
+include "include/sound";
+include ":attributes:attributes";
+include "include/string";
+include "include/objtype";
+include "include/canAccess";
+include "include/dist";
+include "include/toolWear";
+include "include/noto";
+include ":tailoring:tailoringFunctions";
+include ":fishing:fishingFunctions";
+include ":containers:corpse/corpseFunctions";
+
+var bowcraftconfigfile := ReadConfigFile(":bowcraft:bowcraft");
+
+
+program use_blade(who, blade )
+
+	EraseObjProperty(who, "IsMeditating");
+	EraseObjProperty(who, "HealTimer");
+
+	if ( !can_access(who, blade) )
+		return 0;
+	endif
+	if ( !ReserveItem(blade) )
+		return 0;
+	endif
+
+	SendSysMessage(who, "What would you like to use that on?");
+	var use_on := TargetCoordinates(who);
+	if ( !use_on )
+		return 0;
+	endif
+	if ( use_on.item )
+		if ( !can_access(who, use_on.item, "unmovable") )
+			return 0;
+		endif
+	endif
+	var checkme := use_on.item.objtype;
+	if ( use_on.mobile.npctemplate == "sheep" )
+		process_wool(who, blade, use_on.mobile);
+	elseif ( use_on.item.objtype == UOBJ_CORPSE )
+		ReleaseItem(blade);
+		Carve_Corpse(who, use_on.item);
+	elseif ( is_fish(checkme) )
+		CarveFish(who, blade, use_on.item);
+	elseif ( is_tree(use_on.objtype ) )
+		CarveTree(who, blade, use_on.item);
+	else
+		SendSysMessage(who, "I don't know how to use those items together.");
+	endif
+
+endprogram
+
+
+function is_tree(theobj )
+
+	if ( (theobj == 0x0c9e) || (theobj == 0x0ca8) || (theobj == 0x0caa) )
+		return 1;
+	elseif (theobj == 0x0cab )
+		return 1;
+	elseif ((theobj >= 0x0c99) && (theobj <= 0x0cea) )
+		return 1;
+	elseif ((theobj >= 0x0cf3) && (theobj <= 0x0d03) )
+		return 1;
+	elseif ((theobj >= 0x0d41) && (theobj <= 0x0dab) )
+		return 1;
+	else
+		return 0;
+	endif
+
+endfunction
+
+
+function CarveTree(who, blade, use_on )
+
+	if ( dist(who, use_on) > 2 )
+		SendSysMessage(who, "You cannot use that");
+		return 0;
+	endif
+	CreateItemInBackpack(who, UOBJ_KINDLING, 1);
+	DestroyItem(use_on);
+	SendSysMessage(who, "You chip off some kindling and put it in your backpack.");
+
+endfunction
\ No newline at end of file



From austin at berlios.de  Thu Nov  3 04:38:09 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 04:38:09 +0100
Subject: [Poldistro-svn] r860 - trunk/096/data
Message-ID: <200511030338.jA33c9oW025041@sheep.berlios.de>

Author: austin
Date: 2005-11-03 04:38:00 +0100 (Thu, 03 Nov 2005)
New Revision: 860

Modified:
   trunk/096/data/npcs.txt
Log:
Existing cow AI updated so POL will start ;-)

Modified: trunk/096/data/npcs.txt
===================================================================
--- trunk/096/data/npcs.txt	2005-11-03 03:30:45 UTC (rev 859)
+++ trunk/096/data/npcs.txt	2005-11-03 03:38:00 UTC (rev 860)
@@ -59107,7 +59107,7 @@
 	Stamina	15
 	CreatedAt	0
 	AR	9
-	script	:oldAI:cow
+	script	:brainAI:brain
 	SpeechColor	63
 }
 
@@ -59274,7 +59274,7 @@
 	Stamina	15
 	CreatedAt	0
 	AR	9
-	script	:oldAI:cow
+	script	:brainAI:brain
 	SpeechColor	18
 }
 
@@ -59344,7 +59344,7 @@
 	Stamina	15
 	CreatedAt	0
 	AR	9
-	script	:oldAI:cow
+	script	:brainAI:brain
 	SpeechColor	97
 }
 
@@ -59463,7 +59463,7 @@
 	Stamina	15
 	CreatedAt	0
 	AR	9
-	script	:oldAI:cow
+	script	:brainAI:brain
 	SpeechColor	442
 }
 
@@ -59603,7 +59603,7 @@
 	Stamina	15
 	CreatedAt	0
 	AR	9
-	script	:oldAI:cow
+	script	:brainAI:brain
 	SpeechColor	63
 }
 
@@ -60374,7 +60374,7 @@
 	Stamina	15
 	CreatedAt	0
 	AR	9
-	script	:oldAI:cow
+	script	:brainAI:brain
 	SpeechColor	348
 }
 
@@ -60636,7 +60636,7 @@
 	Stamina	15
 	CreatedAt	0
 	AR	9
-	script	:oldAI:cow
+	script	:brainAI:brain
 	SpeechColor	53
 }
 
@@ -61086,7 +61086,7 @@
 	Stamina	15
 	CreatedAt	0
 	AR	9
-	script	:oldAI:cow
+	script	:brainAI:brain
 	SpeechColor	243
 }
 
@@ -61121,7 +61121,7 @@
 	Stamina	15
 	CreatedAt	0
 	AR	9
-	script	:oldAI:cow
+	script	:brainAI:brain
 	SpeechColor	7
 }
 
@@ -61636,7 +61636,7 @@
 	Stamina	15
 	CreatedAt	0
 	AR	9
-	script	:oldAI:cow
+	script	:brainAI:brain
 	SpeechColor	37
 }
 



From austin at berlios.de  Thu Nov  3 04:42:20 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 04:42:20 +0100
Subject: [Poldistro-svn] r861 - trunk/096/data
Message-ID: <200511030342.jA33gKjm025345@sheep.berlios.de>

Author: austin
Date: 2005-11-03 04:42:17 +0100 (Thu, 03 Nov 2005)
New Revision: 861

Modified:
   trunk/096/data/items.txt
Log:
Removed 0x888B entries (not sure what it was, but its no longer in an itemdesc.cfg and I wanna start pol)

Modified: trunk/096/data/items.txt
===================================================================
--- trunk/096/data/items.txt	2005-11-03 03:38:00 UTC (rev 860)
+++ trunk/096/data/items.txt	2005-11-03 03:42:17 UTC (rev 861)
@@ -22935,24 +22935,6 @@
 
 Item
 {
-	Serial	0x41a7226b
-	ObjType	0x888b
-	Graphic	0x1
-	X	852
-	Y	1688
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i2
-	CProp	chestarray a2:i1768589078i1768601218
-	CProp	duration i1800
-	CProp	level i1
-	CProp	range i3
-	DecayAt	3138356
-}
-
-Item
-{
 	Serial	0x6ae1231f
 	ObjType	0xe77
 	Graphic	0xe77
@@ -120357,24 +120339,6 @@
 
 Item
 {
-	Serial	0x4a1ae91f
-	ObjType	0x888b
-	Graphic	0x1
-	X	2442
-	Y	1088
-	Z	28
-	Revision	0
-	Realm	britannia
-	CProp	amount i2
-	CProp	chestarray a2:i1768593806i1768651661
-	CProp	duration i1800
-	CProp	level i5
-	CProp	range i5
-	DecayAt	11138689
-}
-
-Item
-{
 	Name	Beware the dangers that lie within... this is your only warning
 	Serial	0x4a1ae92e
 	ObjType	0x1172
@@ -197752,24 +197716,6 @@
 
 Item
 {
-	Serial	0x4a63d390
-	ObjType	0x888b
-	Graphic	0x1
-	X	5146
-	Y	619
-	Z	-50
-	Revision	0
-	Realm	britannia
-	CProp	amount i3
-	CProp	chestarray a3:i1768592748i1768604820i1768632834
-	CProp	duration i1800
-	CProp	level i1
-	CProp	range i6
-	DecayAt	11319498
-}
-
-Item
-{
 	Serial	0x6ae12325
 	ObjType	0xe42
 	Graphic	0xe42
@@ -198005,24 +197951,6 @@
 
 Item
 {
-	Serial	0x4a6433ef
-	ObjType	0x888b
-	Graphic	0x1
-	X	5151
-	Y	743
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i2
-	CProp	chestarray a2:i1775951654i1776129615
-	CProp	duration i1800
-	CProp	level i3
-	CProp	range i3
-	DecayAt	11319694
-}
-
-Item
-{
 	Serial	0x6ae12320
 	ObjType	0xe40
 	Graphic	0xe40
@@ -214327,23 +214255,6 @@
 	DecayAt	2683643
 }
 
-Item
-{
-	Serial	0x41b36f1a
-	ObjType	0x888b
-	Graphic	0x1
-	X	5267
-	Y	691
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i5
-	CProp	chestarray a5:i1768590658i1768610455i1768652672i1768656512i1768656622
-	CProp	duration i1800
-	CProp	level i3
-	CProp	range i3
-	DecayAt	3395571
-}
 
 Item
 {
@@ -215941,24 +215852,6 @@
 
 Item
 {
-	Serial	0x4a63d3b9
-	ObjType	0x888b
-	Graphic	0x1
-	X	5323
-	Y	571
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i4
-	CProp	chestarray a4:i1768589854i1768601408i1768629830i1768648578
-	CProp	duration i1800
-	CProp	level i2
-	CProp	range i3
-	DecayAt	11319561
-}
-
-Item
-{
 	Serial	0x6ae1232a
 	ObjType	0xe77
 	Graphic	0xe77
@@ -218744,24 +218637,6 @@
 
 Item
 {
-	Serial	0x425d899e
-	ObjType	0x888b
-	Graphic	0x1
-	X	5423
-	Y	1853
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i2
-	CProp	chestarray a2:i1768589079i1768601170
-	CProp	duration i1800
-	CProp	level i2
-	CProp	range i2
-	DecayAt	5397614
-}
-
-Item
-{
 	Serial	0x6ae12321
 	ObjType	0xe40
 	Graphic	0xe40
@@ -218963,23 +218838,6 @@
 	DecayAt	25191073
 }
 
-Item
-{
-	Serial	0x425d89cb
-	ObjType	0x888b
-	Graphic	0x1
-	X	5427
-	Y	1906
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i2
-	CProp	chestarray a2:i1768589080i1768605727
-	CProp	duration i1800
-	CProp	level i2
-	CProp	range i2
-	DecayAt	5397708
-}
 
 Item
 {
@@ -219951,24 +219809,6 @@
 
 Item
 {
-	Serial	0x425d94e8
-	ObjType	0x888b
-	Graphic	0x1
-	X	5465
-	Y	1797
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i2
-	CProp	chestarray a2:i1768589081i1768633655
-	CProp	duration i1800
-	CProp	level i4
-	CProp	range i2
-	DecayAt	5401011
-}
-
-Item
-{
 	Serial	0x6ae12322
 	ObjType	0xe43
 	Graphic	0xe43
@@ -220506,24 +220346,6 @@
 
 Item
 {
-	Serial	0x425d8b01
-	ObjType	0x888b
-	Graphic	0x1
-	X	5482
-	Y	1983
-	Z	1
-	Revision	0
-	Realm	britannia
-	CProp	amount i2
-	CProp	chestarray a2:i1768589082i1768601168
-	CProp	duration i1800
-	CProp	level i2
-	CProp	range i2
-	DecayAt	5398434
-}
-
-Item
-{
 	Serial	0x6ae12323
 	ObjType	0xe42
 	Graphic	0xe42
@@ -220619,24 +220441,6 @@
 
 Item
 {
-	Serial	0x425d8a83
-	ObjType	0x888b
-	Graphic	0x1
-	X	5474
-	Y	2035
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i2
-	CProp	chestarray a2:i1768589083i1768601169
-	CProp	duration i1800
-	CProp	level i1
-	CProp	range i2
-	DecayAt	5398279
-}
-
-Item
-{
 	Serial	0x6ae12324
 	ObjType	0xe43
 	Graphic	0xe43
@@ -223518,24 +223322,6 @@
 
 Item
 {
-	Serial	0x425d8f9f
-	ObjType	0x888b
-	Graphic	0x1
-	X	5614
-	Y	1838
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i6
-	CProp	chestarray a6:i1768591003i1768602829i1768630613i1768648859i1768656669i1768656701
-	CProp	duration i1800
-	CProp	level i1
-	CProp	range i6
-	DecayAt	5399218
-}
-
-Item
-{
 	Serial	0x425d9081
 	ObjType	0x6c5
 	Graphic	0x6c5
@@ -224593,24 +224379,6 @@
 
 Item
 {
-	Serial	0x425d89f9
-	ObjType	0x888b
-	Graphic	0x1
-	X	5575
-	Y	2005
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i2
-	CProp	chestarray a2:i1768589084i1768601171
-	CProp	duration i1800
-	CProp	level i1
-	CProp	range i2
-	DecayAt	5397941
-}
-
-Item
-{
 	Serial	0x6ae1232d
 	ObjType	0xe40
 	Graphic	0xe40
@@ -225552,24 +225320,6 @@
 
 Item
 {
-	Serial	0x4143123e
-	ObjType	0x888b
-	Graphic	0x1
-	X	5740
-	Y	51
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i3
-	CProp	chestarray a3:i1768589475i1768640436i1768656248
-	CProp	duration i1800
-	CProp	level i4
-	CProp	range i2
-	DecayAt	1099977
-}
-
-Item
-{
 	Serial	0x6ae12326
 	ObjType	0xe43
 	Graphic	0xe43
@@ -225916,24 +225666,6 @@
 
 Item
 {
-	Serial	0x414311f5
-	ObjType	0x888b
-	Graphic	0x1
-	X	5699
-	Y	83
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i3
-	CProp	chestarray a3:i1768589608i1768609369i1768638307
-	CProp	duration i1800
-	CProp	level i3
-	CProp	range i4
-	DecayAt	1099923
-}
-
-Item
-{
 	Serial	0x6ae12329
 	ObjType	0xe42
 	Graphic	0xe42
@@ -227051,24 +226783,6 @@
 
 Item
 {
-	Serial	0x414313e0
-	ObjType	0x888b
-	Graphic	0x1
-	X	5783
-	Y	24
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i3
-	CProp	chestarray a3:i1768589609i1768636177i1768656410
-	CProp	duration i1800
-	CProp	level i4
-	CProp	range i5
-	DecayAt	1100127
-}
-
-Item
-{
 	Serial	0x6ae12327
 	ObjType	0xe42
 	Graphic	0xe42
@@ -239868,24 +239582,6 @@
 
 Item
 {
-	Serial	0x43e150f9
-	ObjType	0x888b
-	Graphic	0x1
-	X	6091
-	Y	184
-	Z	0
-	Revision	0
-	Realm	britannia
-	CProp	amount i3
-	CProp	chestarray a3:i1768589610i1768651146i1768656443
-	CProp	duration i1800
-	CProp	level i5
-	CProp	range i5
-	DecayAt	7088482
-}
-
-Item
-{
 	Serial	0x47125510
 	ObjType	0x242
 	Graphic	0x242



From austin at berlios.de  Thu Nov  3 04:46:52 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 04:46:52 +0100
Subject: [Poldistro-svn] r862 - trunk/096/pkg/commands/gm
Message-ID: <200511030346.jA33kqSu025587@sheep.berlios.de>

Author: austin
Date: 2005-11-03 04:46:52 +0100 (Thu, 03 Nov 2005)
New Revision: 862

Modified:
   trunk/096/pkg/commands/gm/ekill.src
   trunk/096/pkg/commands/gm/kill.src
   trunk/096/pkg/commands/gm/lkill.src
Log:
I didnt put CInt() around AP_GetVitalMaximumValue() but needed to!


Modified: trunk/096/pkg/commands/gm/ekill.src
===================================================================
--- trunk/096/pkg/commands/gm/ekill.src	2005-11-03 03:42:17 UTC (rev 861)
+++ trunk/096/pkg/commands/gm/ekill.src	2005-11-03 03:46:52 UTC (rev 862)
@@ -21,7 +21,7 @@
 	endif
 	
 	PlayMovingEffect(who, targ, CInt(text), 5, 1);
-	ApplyRawDamage(targ, AP_GetVitalMaximumValue(targ, "Hits"));
+	ApplyRawDamage(targ, CInt(AP_GetVitalMaximumValue(targ, "Hits")));
 	
 	return 1;
 endprogram

Modified: trunk/096/pkg/commands/gm/kill.src
===================================================================
--- trunk/096/pkg/commands/gm/kill.src	2005-11-03 03:42:17 UTC (rev 861)
+++ trunk/096/pkg/commands/gm/kill.src	2005-11-03 03:46:52 UTC (rev 862)
@@ -17,7 +17,7 @@
 	
 	targ.Disable("Invul");
 	SetObjProperty(targ, "GuardKill", 1);	
-	ApplyRawDamage(targ, AP_GetVitalMaximumValue(targ, "Hits"));
+	ApplyRawDamage(targ, CInt(AP_GetVitalMaximumValue(targ, "Hits")));
 	
 	return 1;
 endprogram

Modified: trunk/096/pkg/commands/gm/lkill.src
===================================================================
--- trunk/096/pkg/commands/gm/lkill.src	2005-11-03 03:42:17 UTC (rev 861)
+++ trunk/096/pkg/commands/gm/lkill.src	2005-11-03 03:46:52 UTC (rev 862)
@@ -20,7 +20,7 @@
 	SetObjProperty(targ, "GuardKill", 1);
 	PlayLightningBoltEffect(targ);
 	PlaySoundEffect(targ, SFX_SPELL_LIGHTNING);	
-	ApplyRawDamage(targ, AP_GetVitalMaximumValue(targ, "Hits"));
+	ApplyRawDamage(targ, CInt(AP_GetVitalMaximumValue(targ, "Hits")));
 	
 	return 1;
 endprogram



From austin at berlios.de  Thu Nov  3 04:56:52 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 04:56:52 +0100
Subject: [Poldistro-svn] r863 - in trunk/096: config pkg/skills/lumberjacking
Message-ID: <200511030356.jA33uqp5027477@sheep.berlios.de>

Author: austin
Date: 2005-11-03 04:56:48 +0100 (Thu, 03 Nov 2005)
New Revision: 863

Modified:
   trunk/096/config/itemdesc.cfg
   trunk/096/pkg/skills/lumberjacking/lumberJack.src
Log:
Added "log" name line to 0x1BDD (it is just 1 log.. why logs? :p)
Logs still exists though. It has two names! Hoorah

Adjusted difficulty line for wood amount..
Ranges from 5-100 :)


Modified: trunk/096/config/itemdesc.cfg
===================================================================
--- trunk/096/config/itemdesc.cfg	2005-11-03 03:46:52 UTC (rev 862)
+++ trunk/096/config/itemdesc.cfg	2005-11-03 03:56:48 UTC (rev 863)
@@ -291,6 +291,7 @@
 
 Item 0x1BDD
 {
+	Name			log
 	Name			logs
 	Desc			log%s%
 	VendorSellsFor		5

Modified: trunk/096/pkg/skills/lumberjacking/lumberJack.src
===================================================================
--- trunk/096/pkg/skills/lumberjacking/lumberJack.src	2005-11-03 03:46:52 UTC (rev 862)
+++ trunk/096/pkg/skills/lumberjacking/lumberJack.src	2005-11-03 03:56:48 UTC (rev 863)
@@ -39,7 +39,7 @@
 endprogram
 
 function ChopTree(who, tool, targ, orig_x, orig_y)
-	var i:=RandomDiceRoll("3d4");
+	var i:=RandomDiceRoll("1d1");
 	for ( i; i>=0; i:=i-1 )
 		if ( !CanChop(who, tool, targ, orig_x, orig_y) )
 			return 0;
@@ -53,24 +53,26 @@
 	var wood_type := LJ_GetWoodType(who.realm, targ.x, targ.y);
 	var wood_amount := LJ_GetWoodAmount(who.realm, targ.x, targ.y);
 
-	var material_cfg := ReadConfigFile(":crafting:configs/materials");
-	var diff_mod := material_cfg[wood_type].Difficulty;
-	if ( material_cfg.errortext )
-		SendSysMessage(who, "Error - Unable to open :crafting:configs/materials.cfg ->"+material_cfg.errortext);
-		return 0;
-	endif
-
 	var max_wood := CInt(LJ_GetSettingsCfgElem("Settings").MaxWood);
 	// The less wood there is, the more difficult it becomes.
-	var difficulty := CInt( 40 + ( diff_mod - 0.4 ) * 100 - 40 * wood_amount / max_wood );
+	var difficulty := CInt( 100 - 5 * wood_amount / max_wood );
 	
+	if ( who.cmdlevel )
+		SendSysMessage(who, "MaxWood="+max_wood+"    CurWood="+wood_amount);
+		SendSysMessage(who, "Difficulty ->"+difficulty);
+	endif
 	wood_amount := wood_amount - 1;
 	LJ_SetWoodAmount(who.realm, targ.x, targ.y, wood_amount);
 
 	if ( SkillCheck(who, LUMBERJACKING, difficulty) > 0 )
-		CreateItemInBackPack(who, wood_type, 1);
-		SendSysMessage(who, "You place the log in your pack.");
-		return 1;
+		var item := CreateItemInBackPack(who, wood_type, 1);
+		if ( item.errortext )
+			SendSysMessage(who, "Unable to create "+wood_type+" ->"+item.errortext);
+			return 0;
+		else
+			SendSysMessage(who, "You place the log in your pack.");
+			return 1;
+		endif
 	endif
 
 	SendSysMessage(who, "You are unable to produce a useable log from this tree.");



From austin at berlios.de  Thu Nov  3 05:01:44 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 05:01:44 +0100
Subject: [Poldistro-svn] r864 - trunk/096/pkg/skills/lumberjacking
Message-ID: <200511030401.jA341igG028479@sheep.berlios.de>

Author: austin
Date: 2005-11-03 05:01:42 +0100 (Thu, 03 Nov 2005)
New Revision: 864

Modified:
   trunk/096/pkg/skills/lumberjacking/lumberJack.src
Log:
Adjusted formula a little more.

Modified: trunk/096/pkg/skills/lumberjacking/lumberJack.src
===================================================================
--- trunk/096/pkg/skills/lumberjacking/lumberJack.src	2005-11-03 03:56:48 UTC (rev 863)
+++ trunk/096/pkg/skills/lumberjacking/lumberJack.src	2005-11-03 04:01:42 UTC (rev 864)
@@ -55,7 +55,7 @@
 
 	var max_wood := CInt(LJ_GetSettingsCfgElem("Settings").MaxWood);
 	// The less wood there is, the more difficult it becomes.
-	var difficulty := CInt( 100 - 5 * wood_amount / max_wood );
+	var difficulty := CInt( 100 - (95 * (wood_amount / max_wood)) );
 	
 	if ( who.cmdlevel )
 		SendSysMessage(who, "MaxWood="+max_wood+"    CurWood="+wood_amount);



From austin at berlios.de  Thu Nov  3 05:54:35 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 05:54:35 +0100
Subject: [Poldistro-svn] r865 - trunk/096/pkg/skills/lumberjacking
Message-ID: <200511030454.jA34sZ4F007146@sheep.berlios.de>

Author: austin
Date: 2005-11-03 05:54:31 +0100 (Thu, 03 Nov 2005)
New Revision: 865

Modified:
   trunk/096/pkg/skills/lumberjacking/lumberJack.src
   trunk/096/pkg/skills/lumberjacking/start.src
Log:
Okay this difficulty formula seems to work best for being able to adjust to increasing MaxWood and ranging from 5%-100% difficulty checks.

Modified: trunk/096/pkg/skills/lumberjacking/lumberJack.src
===================================================================
--- trunk/096/pkg/skills/lumberjacking/lumberJack.src	2005-11-03 04:01:42 UTC (rev 864)
+++ trunk/096/pkg/skills/lumberjacking/lumberJack.src	2005-11-03 04:54:31 UTC (rev 865)
@@ -4,6 +4,7 @@
  */
 use uo;
 use os;
+use math;
 
 include ":attributes:attributes";
 include ":datafile:datafile";
@@ -39,7 +40,7 @@
 endprogram
 
 function ChopTree(who, tool, targ, orig_x, orig_y)
-	var i:=RandomDiceRoll("1d1");
+	var i:=1;//RandomDiceRoll("3d3");
 	for ( i; i>=0; i:=i-1 )
 		if ( !CanChop(who, tool, targ, orig_x, orig_y) )
 			return 0;
@@ -55,8 +56,9 @@
 
 	var max_wood := CInt(LJ_GetSettingsCfgElem("Settings").MaxWood);
 	// The less wood there is, the more difficult it becomes.
-	var difficulty := CInt( 100 - (95 * (wood_amount / max_wood)) );
 	
+	var difficulty := CInt(105 - (100 * wood_amount / max_wood));
+	
 	if ( who.cmdlevel )
 		SendSysMessage(who, "MaxWood="+max_wood+"    CurWood="+wood_amount);
 		SendSysMessage(who, "Difficulty ->"+difficulty);

Modified: trunk/096/pkg/skills/lumberjacking/start.src
===================================================================
--- trunk/096/pkg/skills/lumberjacking/start.src	2005-11-03 04:01:42 UTC (rev 864)
+++ trunk/096/pkg/skills/lumberjacking/start.src	2005-11-03 04:54:31 UTC (rev 865)
@@ -1,6 +1,6 @@
 use os;
 
-var script := start_script("regen/WoodRegen");
+var script := start_script("treeRegen/control");
 if ( script.errortext )
 	SysLog("Error starting tree regen ->"+script.errortext);
 else



From austin at berlios.de  Thu Nov  3 06:36:43 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 06:36:43 +0100
Subject: [Poldistro-svn] r866 - trunk/096/scripts/include
Message-ID: <200511030536.jA35ahjl020002@sheep.berlios.de>

Author: austin
Date: 2005-11-03 06:36:05 +0100 (Thu, 03 Nov 2005)
New Revision: 866

Modified:
   trunk/096/scripts/include/client.inc
Log:
Soooo many sounds to add >:(

Modified: trunk/096/scripts/include/client.inc
===================================================================
--- trunk/096/scripts/include/client.inc	2005-11-03 04:54:31 UTC (rev 865)
+++ trunk/096/scripts/include/client.inc	2005-11-03 05:36:05 UTC (rev 866)
@@ -102,6 +102,9 @@
 
 
 enum DIRECTIONS
+	MIN_DIR	:=  0x00,
+	MAX_DIR :=  0x07,
+
 	DIR_N	:=  0x00,   // North.
 	DIR_NE	:=  0x01,   // Northeast.
 	DIR_E	:=  0x02,   // East.
@@ -112,59 +115,47 @@
 	DIR_NW	:=  0x07    // Northwest.
 endenum
 
-
-// * Colors *
-// This is not suposed to be a "complete" colorchart, but a
-// quick way to access normal colors.
-const COLOR_DEFAULT         := 0x0000;
-const COLOR_BLACK           := 0x0001;
-const COLOR_INDIGO_DARK     := 0x0007;
-const COLOR_INDIGO          := 0x0008;
-const COLOR_INDIGO_LIGHT    := 0x0009;
-
-const COLOR_VIOLET_DARK     := 0x000c;
-const COLOR_VIOLET          := 0x000d;
-const COLOR_VIOLET_LIGHT    := 0x000e;
-const COLOR_MAGENTA_DARK    := 0x0011;
-const COLOR_MAGENTA         := 0x0012;
-const COLOR_MAGENTA_LIGHT   := 0x0013;
-const COLOR_RED_DARK        := 0x0020;
-const COLOR_RED             := 0x0022;
-const COLOR_RED_LIGHT       := 0x0023;
-const COLOR_ORANGE_DARK     := 0x002a;
-const COLOR_ORANGE          := 0x002b;
-const COLOR_ORANGE_LIGHT    := 0x002c;
-const COLOR_YELLOW_DARK     := 0x0034;
-const COLOR_YELLOW          := 0x0035;
-const COLOR_YELLOW_LIGHT    := 0x0036;
-const COLOR_GREEN_DARK      := 0x003e;
-const COLOR_GREEN           := 0x003f;
-const COLOR_GREEN_LIGHT     := 0x0040;
-const COLOR_CYAN_DARK       := 0x0057;
-const COLOR_CYAN            := 0x0058;
-const COLOR_CYAN_LIGHT      := 0x0059;
-const COLOR_BLUE_DARK       := 0x0061;
-const COLOR_BLUE            := 0x0062;
-const COLOR_BLUE_LIGHT      := 0x0063;
-const COLOR_GRAY_DARK       := 0x0386;
-const COLOR_GRAY            := 0x0387;
-const COLOR_GRAY_LIGHT      := 0x0388;
-const COLOR_BLACKMETAL      := 0x044e;
-const COLOR_GOLDMETAL       := 0x046e;
-const COLOR_BSHIMMER        := 0x0480;	// T2A Only : Waterelemental color.
-const COLOR_WHITE           := 0x0481;	// T2A Only : True white.
-const COLOR_STONE           := 0x0482;	// T2A Only : Rock ( stoneharpy?)
-const COLOR_SPECTRAL        := 0x4631;  // Spectral
-const COLOR_TRANSLUCENT     := 0x7cf8;  // Translucent
-
-////
-// Font Colours.
-////
-const FONTCOLOR_RED := 38;
-const FONTCOLOR_GREEN :=68;
-const FONTCOLOR_BLUE := 90;
-const FONTCOLOR_MAUVE := 30;
-const FONTCOLOR_LAVENDER := 20;
-const FONTCOLOR_BLACK := 1;
-const FONTCOLOR_BROWN := 46;
-const FONTCOLOR_YELLOW := 53;
+// SOUNDS ABC order by insideUO
+// NOTE: Any number over 0xFF (255) will not work in older clients.
+enum SOUNDS
+	SFX_AGILITY		:= 0x1E8,
+	SFX_AGILITY2		:= 0x28F,
+	SFX_AIR_1		:= 0x291,
+	SFX_AIR_2		:= 0x292,
+	SFX_AIR_3		:= 0x293,
+	SFX_AIR_4		:= 0x294,
+	SFX_AIR_5		:= 0x295,
+	SFX_AIRELEMENTAL_1	:= 0x108,
+	SFX_AIRELEMENTAL_2	:= 0x109,
+	SFX_AIRELEMENTAL_3	:= 0x10A,
+	SFX_AIRELEMENTAL_4	:= 0x10B,
+	SFX_AIRELEMENTAL_5	:= 0x10C,
+	SFX_ALIGATOR_1		:= 0x5B,
+	SFX_ALIGATOR_2		:= 0x5C,
+	SFX_ALIGATOR_3		:= 0x5D,
+	SFX_ALIGATOR_4		:= 0x5E,
+	SFX_ALIGATOR_5		:= 0x5F,
+	SFX_ALIGATORB_1		:= 0x295,
+	SFX_ALIGATORB_2		:= 0x296,
+	SFX_ALIGATORB_3		:= 0x297,
+	SFX_ALIGATORB_4		:= 0x298,
+	SFX_ALIGATORB_5		:= 0x299,
+	SFX_ANVIL		:= 0x2B,
+	SFX_ARCH_PROTECT	:= 0x1F8,
+	SFX_AQUARIUM_DEADFISH	:= 0x5A3,
+	SFX_AQUARIUM_REWARDS	:= 0x5A4,
+	SFX_AQUARIUM_USE	:= 0x5A5,
+	SFX_ARCANE_CIRCLE	:= 0x5A6
+	SFX_ARCANE_EMPOWERMENT	:= 0x5C2,
+	SFX_ARCANE_EMPOWER_END	:= 0x5C3,
+	SFX_ARCH_CURE		:= 0x1E9,
+	SFX_ARCH_CURE2		:= 0x29A,
+	SFX_ATTUNE_WEAPON	:= 0x5C4,
+	SFX_AXE_01		:= 0x233,
+	SFX_BEAR_1		:= 0x60,
+	SFX_BEAR_2		:= 0x61,
+	SFX_BEAR_3		:= 0x62,
+	SFX_BEAR_4		:= 0x63,
+	SFX_BEAR_5		:= 0x64,
+endenum
+	
\ No newline at end of file



From austin at berlios.de  Thu Nov  3 06:41:19 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 06:41:19 +0100
Subject: [Poldistro-svn] r867 - trunk/096/scripts/include
Message-ID: <200511030541.jA35fJtw022536@sheep.berlios.de>

Author: austin
Date: 2005-11-03 06:40:05 +0100 (Thu, 03 Nov 2005)
New Revision: 867

Modified:
   trunk/096/scripts/include/client.inc
Log:


Modified: trunk/096/scripts/include/client.inc
===================================================================
--- trunk/096/scripts/include/client.inc	2005-11-03 05:36:05 UTC (rev 866)
+++ trunk/096/scripts/include/client.inc	2005-11-03 05:40:05 UTC (rev 867)
@@ -145,7 +145,7 @@
 	SFX_AQUARIUM_DEADFISH	:= 0x5A3,
 	SFX_AQUARIUM_REWARDS	:= 0x5A4,
 	SFX_AQUARIUM_USE	:= 0x5A5,
-	SFX_ARCANE_CIRCLE	:= 0x5A6
+	SFX_ARCANE_CIRCLE	:= 0x5A6,
 	SFX_ARCANE_EMPOWERMENT	:= 0x5C2,
 	SFX_ARCANE_EMPOWER_END	:= 0x5C3,
 	SFX_ARCH_CURE		:= 0x1E9,
@@ -157,5 +157,12 @@
 	SFX_BEAR_3		:= 0x62,
 	SFX_BEAR_4		:= 0x63,
 	SFX_BEAR_5		:= 0x64,
+	SFX_BEAR_6		:= 0x29B,
+	SFX_BEAR_1B		:= 0x4C3,
+	SFX_BEAR_1C		:= 0x4C4,
+	SFX_BEAR_2C		:= 0x4C5,
+	SFX_BEAR_3C		:= 0x4C6,
+	SFX_BEAR_4C		:= 0x4C7,
+	SFX_BEAR_5C		:= 0x4C8
 endenum
 	
\ No newline at end of file



From austin at berlios.de  Thu Nov  3 07:03:19 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 07:03:19 +0100
Subject: [Poldistro-svn] r869 - in trunk/096/pkg/skills/magery: . OLD commands config include spellScripts
Message-ID: <200511030603.jA363JRY030062@sheep.berlios.de>

Author: austin
Date: 2005-11-03 07:02:07 +0100 (Thu, 03 Nov 2005)
New Revision: 869

Added:
   trunk/096/pkg/skills/magery/commands/
   trunk/096/pkg/skills/magery/commands/player/
   trunk/096/pkg/skills/magery/commands/seer/
   trunk/096/pkg/skills/magery/config/
   trunk/096/pkg/skills/magery/config/icp.cfg
   trunk/096/pkg/skills/magery/config/settings.cfg
   trunk/096/pkg/skills/magery/config/spells.cfg
   trunk/096/pkg/skills/magery/hooks/
   trunk/096/pkg/skills/magery/include/
   trunk/096/pkg/skills/magery/include/settings.inc
   trunk/096/pkg/skills/magery/include/spells.inc
   trunk/096/pkg/skills/magery/itemdesc.cfg
   trunk/096/pkg/skills/magery/movementCheck.src
   trunk/096/pkg/skills/magery/pkg.cfg
   trunk/096/pkg/skills/magery/spellScripts/
   trunk/096/pkg/skills/magery/spellScripts/circle1/
   trunk/096/pkg/skills/magery/spellScripts/circle2/
   trunk/096/pkg/skills/magery/spellScripts/circle3/
   trunk/096/pkg/skills/magery/spellScripts/circle4/
   trunk/096/pkg/skills/magery/spellScripts/circle5/
   trunk/096/pkg/skills/magery/spellScripts/circle6/
   trunk/096/pkg/skills/magery/spellScripts/circle7/
   trunk/096/pkg/skills/magery/spellScripts/circle8/
   trunk/096/pkg/skills/magery/spellStarter.src
Removed:
   trunk/096/pkg/skills/magery/OLD/pkg.cfg
Log:
Okay this is mostly a carry over from what I did on TSSE.
Itll get a lot of changes of course.. but the concepts will remain as the spellstarter system is extremely flexible.



Deleted: trunk/096/pkg/skills/magery/OLD/pkg.cfg
===================================================================
--- trunk/096/pkg/skills/magery/OLD/pkg.cfg	2005-11-03 05:44:14 UTC (rev 868)
+++ trunk/096/pkg/skills/magery/OLD/pkg.cfg	2005-11-03 06:02:07 UTC (rev 869)
@@ -1,8 +0,0 @@
-# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
-#
-#
-Enabled         1
-Name		magery
-maintainer      Distro Team
-email           distro at polserver.com
-Version         1.0

Added: trunk/096/pkg/skills/magery/config/icp.cfg
===================================================================
--- trunk/096/pkg/skills/magery/config/icp.cfg	2005-11-03 05:44:14 UTC (rev 868)
+++ trunk/096/pkg/skills/magery/config/icp.cfg	2005-11-03 06:02:07 UTC (rev 869)
@@ -0,0 +1,13 @@
+ICP Register
+{
+	Name		Magery
+	Version		1.0
+
+	Description	Handles mage related scripts.
+
+	Creator		Austin
+	C_Email		AustinHeilman at gmail.com
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+}
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/config/settings.cfg
===================================================================
--- trunk/096/pkg/skills/magery/config/settings.cfg	2005-11-03 05:44:14 UTC (rev 868)
+++ trunk/096/pkg/skills/magery/config/settings.cfg	2005-11-03 06:02:07 UTC (rev 869)
@@ -0,0 +1,8 @@
+Elem Settings
+{
+	// Maximum distance a spell can be cast
+	MaxRange	16
+	
+	// Does MuadDib wear little girl undies?
+	MuadDibUndies	1
+}
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/config/spells.cfg
===================================================================

Added: trunk/096/pkg/skills/magery/include/settings.inc
===================================================================
--- trunk/096/pkg/skills/magery/include/settings.inc	2005-11-03 05:44:14 UTC (rev 868)
+++ trunk/096/pkg/skills/magery/include/settings.inc	2005-11-03 06:02:07 UTC (rev 869)
@@ -0,0 +1,56 @@
+//$Id: settings.inc 264 2005-09-27 21:55:42Z austin $
+
+use uo;
+use os;
+use cfgfile;
+
+/*
+ * MS_GetSettingsCfgFile(engine_name)
+ *
+ * Purpose
+ * Reads in :lumberjacking:config/settings.cfg
+ *
+ * Parameters
+ *
+ * Return value
+ * A config file reference.
+ *
+ */
+function MS_GetSettingsCfgFile()
+	var cfg := ReadConfigFile(":magery:config/settings");
+
+	if ( cfg.errortext )
+		SysLog("Error::MS_GetSettingsCfgFile() - Unable to open [:magery:config/settings.cfg] ->"+cfg.errortext);
+	endif
+
+	return cfg;
+endfunction
+
+/*
+ * MS_GetSettingsCfgElem(elem_name, cfg_file)
+ *
+ * Purpose
+ * Retrieves an elem from a config file. 
+ *
+ * Parameters
+ * elem_name:	A string matching the elem name to be retrieved.
+ * cfg_file:	Optional parameter - reference to a config already read in by MS_GetSettingsCfgFile()
+ *
+ * Return value
+ * A config file elem reference.
+ *
+ */
+function MS_GetSettingsCfgElem(elem_name, byref cfg_file:=0)
+	if ( !cfg_file )
+		cfg_file := MS_GetSettingsCfgFile();
+	endif
+	
+	var elem := cfg_file[elem_name];
+
+	if ( elem.errortext )
+		SysLog("Error::MS_GetSettingsCfgElem() - Unable to find elem ["+elem_name+"] ->"+elem.errortext);
+	endif
+
+	return elem;
+endfunction
+

Added: trunk/096/pkg/skills/magery/include/spells.inc
===================================================================
--- trunk/096/pkg/skills/magery/include/spells.inc	2005-11-03 05:44:14 UTC (rev 868)
+++ trunk/096/pkg/skills/magery/include/spells.inc	2005-11-03 06:02:07 UTC (rev 869)
@@ -0,0 +1,119 @@
+use uo;
+use os;
+use util;
+use cfgfile;
+
+include ":attributes:attributes";
+include "include/client";
+
+const MAX_RANGE	:= 16;
+
+function SpellDebug(who, text)
+	if ( who.cmdlevel )
+		SendSysMessage(who, text, SSM_INFO_DEBUG);
+	endif
+endfunction
+
+function UseMana(who, amount)
+	if ( GetManaPoints(who) >= amount )
+		SetManaPoints(who, GetManaPoints(who)-amount);
+		return 1;
+	else
+		return 0;
+	endif
+endfunction
+
+function Reflection(who, targ, spell_strength, info)
+	// Lower targ's defense
+	// Apply some of spell_strength to target if reflected.
+	// Lower spell_strength by how much was not reflected.
+	// Start the spell again and point it at who from targ.
+	
+endfunction
+
+function SpellTarget(byref who, byref npctarget:=0, prompt := "Select a target.", ops:=TGTOPT_CHECK_LOS+TGTOPT_NEUTRAL)
+	var x := who.x;
+	var y := who.y;
+	who.hidden := 0;
+	
+	if ( npctarget )
+		return npctarget;
+	elseif ( who.npctemplate )
+		return;
+	endif
+	
+	SendSysMessage(who, prompt);
+	
+	var targ := Target(who, ops);
+	if ( Distance(who, targ) > MAX_RANGE )
+		SendSysMessage(who, "That is too far away.");
+		return 0;
+	elseif ( who.x == x && who.y == y )
+		return targ;
+	else
+		SendSysMessage(who, "You break your concentration.");
+		return 0;
+	endif
+endfunction
+
+function SpellTargetCoordinates(byref who, byref npctarget:=0, prompt := "Select a target.", range := MAX_RANGE)
+	var x := who.x;
+	var y := who.y;
+	who.hidden := 0;
+	
+	if ( npctarget )
+		return npctarget;
+	elseif ( who.npctemplate )
+		return;
+	endif
+	
+	SendSysMessage(who, prompt);
+	var targ := TargetCoordinates(who);
+	if ( !targ )
+		SendSysMessage(who, "Cancelled.");
+		return 0;
+	elseif ( CoordDistance(who.x, who.y, targ.x, targ.y) > range )
+		SendSysMessage(who, "That is too far away.");
+		return 0;
+	elseif ( who.x == x && who.y == y )
+		return targ;
+	else
+		SendSysMessage(who, "You lose concentration.");
+		return 0;
+	endif
+endfunction
+
+function GetSpellPoints(mage, targ, points)
+	var mage_skill := GetSkill(mage, "Magery");
+	var defense := GetSkill(targ, "Magic_Resistance");
+
+	// Failed MR check results in only half your resistance being used!
+	if ( SkillCheck(targ, "Magic_Resistance", -1) < 0 )
+		defense := CInt(defense / 2);
+	endif
+
+	// Old formulas
+	// CInt(points * (mage_skill - defense) / 100);
+	// CInt(points * ((mage_skill * 1.3) - defense) / ( mage_skill * 1.3 ))
+	var effect_level := CInt(points * (mage_skill-defense) / mage_skill );
+	return effect_level;
+endfunction
+
+function GetSpellWords(spell_name)
+	var cfg := ReadConfigFile(":magic:configs/spell_info");
+	if ( cfg.errortext )
+		return "Error - GetSpellWords(). Unable to open :magic:configs/spell_info.cfg ->"+cfg.errortext;
+	endif
+	
+	cfg := cfg[spell_name];
+	if ( cfg.errortext )
+		return "Error - GetSpellWords(). Unable to find elem ["+spell_name+"] ->"+cfg.errortext;
+	endif
+	
+	return cfg.SpellWords;
+endfunction
+
+function ReleaseScript(pid)
+	var process := GetProcess(pid);
+	process.SendEvent("done");
+endfunction

Added: trunk/096/pkg/skills/magery/itemdesc.cfg
===================================================================
--- trunk/096/pkg/skills/magery/itemdesc.cfg	2005-11-03 05:44:14 UTC (rev 868)
+++ trunk/096/pkg/skills/magery/itemdesc.cfg	2005-11-03 06:02:07 UTC (rev 869)
@@ -0,0 +1,25 @@
+Spellbook 0xEFA
+{
+	Name			Spellbook
+	Desc			spellbook
+	
+	Gump			0xFFFF
+	MinX			40
+	MaxX			60
+	MinY			20
+	MaxY			80
+	
+	SpellType		Magic
+	
+	Newbie			1
+	BlocksCastingIfInHand	0
+	RequiresAttention	0
+	
+	VendorSellsFor		22
+	VendorBuysFor		11
+	
+	Weight			1
+	
+	CanRemoveScript		:containers:container/noRemove
+}
+

Added: trunk/096/pkg/skills/magery/movementCheck.src
===================================================================
--- trunk/096/pkg/skills/magery/movementCheck.src	2005-11-03 05:44:14 UTC (rev 868)
+++ trunk/096/pkg/skills/magery/movementCheck.src	2005-11-03 06:02:07 UTC (rev 869)
@@ -0,0 +1,17 @@
+use uo;
+use os;
+
+program MovementChecker(params)
+	var who := params[1];
+	var spell_starter := GetProcess(params[2]);
+	var my_x := params[3];
+	var my_y := params[4];
+	
+	while ( spell_starter.pid )
+		if ( who.x != my_x || who.y != my_y )
+			spell_starter.SendEvent("moved");
+			return;
+		endif
+		sleepms(50);
+	endwhile
+endprogram

Added: trunk/096/pkg/skills/magery/pkg.cfg
===================================================================
--- trunk/096/pkg/skills/magery/pkg.cfg	2005-11-03 05:44:14 UTC (rev 868)
+++ trunk/096/pkg/skills/magery/pkg.cfg	2005-11-03 06:02:07 UTC (rev 869)
@@ -0,0 +1,17 @@
+# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+Enabled		1
+Name		magery
+
+Version		1.0
+
+CoreRequired	96
+
+Creator		Austin Heilman
+Email		AustinHeilman at gmail.com
+Maintainer	Distro Team
+Email		distro at polserver.com
+
+#Requires none
+#conflicts	none

Added: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-03 05:44:14 UTC (rev 868)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-03 06:02:07 UTC (rev 869)
@@ -0,0 +1,214 @@
+use uo;
+use os;
+use cfgfile;
+
+include ":attributes:attributes";
+include "include/client";
+include ":magery:spells";
+include "include/string";
+
+set_script_option(SCRIPTOPT_CAN_ACCESS_OFFLINE_MOBILES, 1);
+
+program SpellStarter(params)
+	var who := params[1];
+	var words_of_power := params[2];
+	var parent_pid := params[3];
+	
+	Attach(who);
+	
+	//Remove trailing space
+	words_of_power := RemoveSpaces(words_of_power, CLR_LEADING_SPACES+CLR_DOUBLE_SPACES+CLR_TRAILING_SPACES);
+	
+	var spell_info := ReadConfigFile("configs/spell_info");
+	spell_info := spell_info[words_of_power];
+
+	// If spell is set to 'TestOnly 1', then it requires GM-cmdlevel or #TestSpell CProp
+	// before it can be used.
+	var can_cast := 1;
+	if ( spell_info.TestOnly && (!who.cmdlevel) )
+		// They need #TestSpell to cast it
+		if ( GetObjProperty(who, "#TestSpell") == error )
+			can_cast := 0;
+		endif
+	elseif ( spell_info.NPCOnly && !who.npctemplate )
+		PrintTextAbove(who, "Unable to cast - NPC only spell.");
+		return 0;
+	endif
+
+	var attribute		:= spell_info.Attribute;
+	var delay		:= spell_info.BaseDelay;
+	var difficulty		:= spell_info.Difficulty;
+	var mana		:= spell_info.ManaCost;
+	if ( !attribute )
+		attribute := "Magery";
+	endif
+
+	if ( GetObjProperty(who, "#medding") )
+		SendSysMessage(who, "You can not cast right now.");
+		return;
+	else
+		SetObjProperty(who, "#medding", 1);
+	endif
+
+	if ( !spell_info || !can_cast )
+		SendSysMessage(who, "Your words seem to have no meaning.");
+		if ( who.npctemplate )
+			PrintTextAbove(who, "Your words seem to have no meaning.");
+		endif
+		FailSpell(who);
+	elseif ( who.squelched && !who.npctemplate )
+		SendSysMessage(who, "Something prevents you from casting.");
+		FailSpell(who);
+	elseif ( !UseMana(who, mana) )
+		SendSysMessage(who, "You are too tired to cast.");
+		FailSpell(who);
+	elseif ( !CheckRegs(who, spell_info) )
+		FailSpell(who);
+	elseif ( !EquipmentCheck(who) )
+		FailSpell(who);
+	elseif ( !CheckDelay(who, attribute, difficulty, delay) )
+		FailSpell(who);
+		SendSysMessage(who, "You break your concentration.");
+	else
+		var skill_check := SkillCheck(who, attribute, difficulty);
+		if ( skill_check > 0 )
+			var info := struct;
+			info.+script := spell_info.script;
+			info.+attribute := attribute;
+			info.+skill_check := skill_check;
+			info.+spell_words := words_of_power;
+			info.+target := params[4];
+			info.+pid := GetPid();
+
+			var script := start_script(spell_info.script, {who, info});
+			if ( script.errortext )
+				PrintTextAbove(who, "Unable to start ["+spell_info.script+"] -> "+script.errortext);
+				SendSysMessage(who, script.errortext);
+			endif
+
+			var ev;
+			while( script.pid && !ev )
+				ev := wait_for_event(1);
+			endwhile
+		else
+			SendSysMessage(who, "You are unable to build the concentration needed to cast.");
+		endif
+	endif
+
+	EraseObjProperty(who, "#medding");
+	ReleaseScript(parent_pid);
+endprogram
+
+function CheckDelay(who, attribute, difficulty, base_delay)
+	
+	SendSysMessage(who, "You begin building the concentration needed to cast.");
+	var equip_delay := GetEquipmentDelay(who);
+		
+	var my_x := who.x;
+	var my_y := who.y;
+	
+	var skill := AP_GetSkill(who, attribute);
+	var delay := CInt(CDbl(base_delay) * (CDbl(difficulty) / CDbl(skill)));
+	delay := delay+equip_delay;
+	
+	if ( delay < 50 )
+		delay := 50;
+	endif
+	
+	var script;
+	if ( !who.npctemplate )
+		script := start_script("movementcheck", {who, GetPid(), my_x, my_y});
+	endif
+	
+	SpellDebug(who, "Cast delay ->"+delay);
+	sleepms(delay);
+	
+	script.kill();
+	
+	if ( who.npctemplate )
+		return 1;
+	elseif ( Events_Waiting() > 0 )
+		return 0;
+	elseif ( who.x != my_x || who.y != my_y )
+		return 0;
+	else
+		return 1;
+	endif
+endfunction
+
+function GetEquipmentDelay(who)
+	/*
+	var weight := 0;
+	var ar := 0;
+	foreach item in EnumeratePhysicalItems(who)
+		weight := weight+item.weight;
+		ar := ar+item.ar;
+	endforeach
+	
+	return {weight, ar};
+	*/
+	
+	var cfg := ReadConfigFile(":*:itemdesc");
+	var delay := 0;
+	foreach item in EnumeratePhysicalItems(who)
+		delay := delay+CInt(cfg[item.objtype].CastDelay);
+		sleepms(2);
+	endforeach
+	
+	return delay;
+endfunction
+
+function EquipmentCheck(who)
+	var item_cfg := ReadConfigFile(":*:itemdesc");
+	foreach item in ListEquippedItems(who)
+		if ( item_cfg[item.objtype].BlocksCastingIfInHand ) // God thats long!
+			return 0;
+		endif
+		sleepms(2);
+	endforeach
+	return 1;
+endfunction
+
+function CheckRegs(who, byref spell_info)
+	if ( who.npctemplate )
+		return 1;
+	endif
+	
+	var reg_list := dictionary;
+
+	foreach line in GetConfigStringArray(spell_info, "Reagent")
+		line := SplitWords(line);
+		var objtype := GetObjTypeByName(line[1]);
+		var amount := CInt(line[2]);
+
+		if ( reg_list[objtype] )
+			reg_list[objtype] := reg_list[objtype] + amount;
+		else
+			reg_list[objtype] := amount;
+		endif
+
+		if ( AmountInPack(who, objtype) < reg_list[objtype] )
+			SendSysMessage(who, "You do not have enough " + GetName(objtype, 1));
+			return 0;
+		endif
+		sleepms(1);
+	endforeach
+
+	foreach key in (reg_list.keys())
+		ConsumeSubstance(who.backpack, key, reg_list[key]);
+		sleepms(1);
+	endforeach
+
+	return 1;
+endfunction
+
+function FailSpell(who)
+/*
+Simple function for handling effects when a caster
+fails the casting.
+*/
+	EraseObjProperty(who, "#medding");
+	PlayObjectCenteredEffect(who, FX_SPELL_FAIL, 5, 50);
+	PlaySoundEffect(who, SFX_SPELL_FAIL);
+
+endfunction



From muaddiblsd at berlios.de  Thu Nov  3 07:30:45 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Thu, 3 Nov 2005 07:30:45 +0100
Subject: [Poldistro-svn] r870 - in trunk/096: config pkg/mobiles/brainAI pkg/mobiles/brainAI/config
Message-ID: <200511030630.jA36Ujkl005109@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-03 07:30:08 +0100 (Thu, 03 Nov 2005)
New Revision: 870

Modified:
   trunk/096/config/npcdesc.cfg
   trunk/096/pkg/mobiles/brainAI/config/hatelist.cfg
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
Log:
Moved sheep to brainAI pkg.

Modified: trunk/096/config/npcdesc.cfg
===================================================================
--- trunk/096/config/npcdesc.cfg	2005-11-03 06:02:07 UTC (rev 869)
+++ trunk/096/config/npcdesc.cfg	2005-11-03 06:30:08 UTC (rev 870)
@@ -2569,48 +2569,6 @@
 	AttackHitScript		:combat:mainHitScript
 }
 
-
-NPCTemplate	sheep
-{
-	Name			a sheep
-	Script			:oldAI:sheep
-	ObjType			0xcf
-	Color			0
-	TrueColor		33784
-	Gender			0
-	Strength		19
-	Intelligence		5
-	Dexterity		25
-	HITS			19
-	MANA			0
-	STAM			25
-	Tactics			6
-	Wrestling		5
-	MagicResistance		5
-	AttackSpeed		30
-	AttackDamage		1d4
-	AttackAttribute		Wrestling
-	AttackHitSound		0xD9
-	AttackMissSound		0x239
-	DeathSound		0xdb
-	DamagedSound		0xda
-	IdleSound1		0xd7
-	IdleSound2		0xd8
-	AR			3
-	tameskill		11
-	herdskill		11
-	food			veggie
-	GuardIgnore		1
-	provoke			15
-	DStart			10
-	CorpseItm		rawribs wool
-	CorpseAmt		3 1
-	NoLoot			1
-	CProp  Karma		i0
-	CProp  Fame		i1
-	AttackHitScript		:combat:mainHitScript
-}
-
 NPCTemplate	goat
 {
 	Name			a goat

Modified: trunk/096/pkg/mobiles/brainAI/config/hatelist.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/config/hatelist.cfg	2005-11-03 06:02:07 UTC (rev 869)
+++ trunk/096/pkg/mobiles/brainAI/config/hatelist.cfg	2005-11-03 06:30:08 UTC (rev 870)
@@ -1,4 +1,4 @@
-HateList Dog
+HateList dog
 {
 	Hates	cat
 	Hates	bird
@@ -16,7 +16,7 @@
 	Fears	greywolf
 }
 
-HateList Wolf
+HateList wolf
 {
 	Hates	dog
 	Hates	cat
@@ -30,7 +30,7 @@
 	Hates	deer
 }
 
-HateList Cow
+HateList cow
 {
 	Hates	snake
 	Hates	icesnake
@@ -40,4 +40,14 @@
 	Fears	frostwolf
 	Fears	whitewolf
 	Fears	greywolf
+}
+
+HateList sheep
+{
+	Fears	dog
+	Fears	wolf
+	Fears	direwolf
+	Fears	frostwolf
+	Fears	whitewolf
+	Fears	greywolf
 }
\ No newline at end of file

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-03 06:02:07 UTC (rev 869)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-03 06:30:08 UTC (rev 870)
@@ -130,7 +130,7 @@
 	AttackSpeed		30
 	AttackDamage		1d4
 	AttackHitSounds		a1:i123
-	AttackMissSounds	a1:i0x239
+	AttackMissSounds	a1:i569
 	DeathSounds		a1:i125
 	DamagedSounds		a1:i124
 	IdleSounds		a2:i121i122		// Sounds stored in Packed Array form
@@ -168,3 +168,70 @@
 
 	AttackHitScript		:combat:mainHitScript
 }
+
+NPCTemplate	sheep
+{
+	Name			a sheep
+	Script			:brainAI:brain
+	ObjType			0xcf
+	Color			0
+	TrueColor		33784
+	Gender			0
+	runspeed		17
+
+	Strength		19
+	Intelligence		5
+	Dexterity		25
+
+	HITS			12
+	MANA			0
+	STAM			25
+
+	Anatomy			0.0
+	EvaluatingIntelligence	0.0
+	Magery			0.0
+	Meditation		0.0
+	Poisoning		0.0
+	ResistingSpells		5.0
+	Tactics			6.0
+	Wrestling		5.0
+
+	AttackSpeed		30
+	AttackDamage		1d2
+	AttackAttribute		Wrestling
+	AttackHitSounds		a1:i217
+	AttackMissSounds	a1:i569
+	DeathSounds		a1:i219
+	DamagedSounds		a1:i218
+	IdleSounds		a2:i215i216
+
+	AR			8
+
+	food			veggie
+	foodtype		veggie
+	packinstinct		none
+
+	GuardIgnore		1
+	DStart			10
+	CorpseItm		rawribs wool
+	CorpseAmt		3 3
+	NoLoot			1
+	CProp  Karma		i0
+	CProp  Fame		i1
+
+	AISetting	FleeLevel	i50 // 50%
+	AISetting	IdleTicks	i5
+	AISetting	SleepWait	i1000
+	AISetting	ListenRange	i7
+	AISetting	AreaSize	i5
+
+	AIScript	Combat		:brainAI:scripts/combat/genericAnimal
+	AIScript	EnterArea	:brainAI:scripts/enterArea/generic
+	AIScript	LeftArea	:brainAI:scripts/leftArea/generic
+	AIScript	LookAround	:brainAI:scripts/lookAround/findFeared
+	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/watchFeared
+	AIScript	Sleep		:brainAI:scripts/sleep/generic
+	AIScript	EndFight	:brainAI:scripts/endFight/endFightAnimal
+
+	AttackHitScript		:combat:mainHitScript
+}
\ No newline at end of file



From muaddiblsd at berlios.de  Thu Nov  3 07:33:11 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Thu, 3 Nov 2005 07:33:11 +0100
Subject: [Poldistro-svn] r871 - in trunk/096: data pkg/mobiles/oldAI
Message-ID: <200511030633.jA36XB60005944@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-03 07:32:57 +0100 (Thu, 03 Nov 2005)
New Revision: 871

Removed:
   trunk/096/pkg/mobiles/oldAI/sheep.src
Modified:
   trunk/096/data/npcs.txt
Log:
Updated npcs.txt for distro, to fix sheep script.
Removed Sheep AI from oldAI

Modified: trunk/096/data/npcs.txt
===================================================================
--- trunk/096/data/npcs.txt	2005-11-03 06:30:08 UTC (rev 870)
+++ trunk/096/data/npcs.txt	2005-11-03 06:32:57 UTC (rev 871)
@@ -59058,7 +59058,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -59142,7 +59142,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -59191,7 +59191,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -59379,7 +59379,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -59638,7 +59638,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -59722,7 +59722,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -60670,7 +60670,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -60788,7 +60788,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -60836,7 +60836,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -60919,7 +60919,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -60968,7 +60968,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -61156,7 +61156,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -61205,7 +61205,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -61254,7 +61254,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -61303,7 +61303,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -64018,7 +64018,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item
@@ -64067,7 +64067,7 @@
 	Stamina	25
 	CreatedAt	0
 	AR	3
-	script	:oldAI:sheep
+	script	:brainAI:brain
 }
 
 Item

Deleted: trunk/096/pkg/mobiles/oldAI/sheep.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/sheep.src	2005-11-03 06:30:08 UTC (rev 870)
+++ trunk/096/pkg/mobiles/oldAI/sheep.src	2005-11-03 06:32:57 UTC (rev 871)
@@ -1,38 +0,0 @@
-use npc;
-use os;
-use uo;
-use cfgfile;
-
-include "include/eventID";
-include "include/sysEvent";
-include ":npcutils:names";
-include ":npcutils:NPCUtil";
-include "include/objtype";
-include "include/dist";
-include ":npcutils:anchors";
-include ":oldAI:main/mainLoopSheep";
-include ":oldAI:combat/fight";
-include ":oldAI:combat/defaultCombatEvent";
-include ":oldAI:setup/sheepSetup";
-include ":oldAI:main/sleepModeSheep";
-
-
-const HALT_THRESHOLD := 5; // how close before he attacks?
-var npccfgfile := ReadConfigFile( "::npcdesc" );
-var idlesnd1 := CInt(npccfgfile[me.npctemplate].idlesound1);
-var idlesnd2 := CInt(npccfgfile[me.npctemplate].idlesound2);
-var waittime := 0;
-var ev := 0;
-
-program KillPlayers()
-  SetWarMode( 0 );
-  main_AI_loop();
-endprogram
-
-function CloseDistance( opponent )
-  case (Distance( me, opponent ))
-    1:
-    0: return 1;
-    default: WalkToward(opponent);  return 0;
-  endcase
-endfunction
\ No newline at end of file



From muaddiblsd at berlios.de  Thu Nov  3 07:41:56 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Thu, 3 Nov 2005 07:41:56 +0100
Subject: [Poldistro-svn] r872 - trunk/096/pkg/systems/combat/old
Message-ID: <200511030641.jA36fuBF011434@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-03 07:41:46 +0100 (Thu, 03 Nov 2005)
New Revision: 872

Modified:
   trunk/096/pkg/systems/combat/old/itemdesc.cfg
   trunk/096/pkg/systems/combat/old/wrestleControl.src
Log:
Updated itemdesc.cfg in combat package to point to :combat:old/itemcontrol for now, to fix the controlscript reports during POL start and such.

Modified: trunk/096/pkg/systems/combat/old/itemdesc.cfg
===================================================================
--- trunk/096/pkg/systems/combat/old/itemdesc.cfg	2005-11-03 06:32:57 UTC (rev 871)
+++ trunk/096/pkg/systems/combat/old/itemdesc.cfg	2005-11-03 06:41:46 UTC (rev 872)
@@ -52,7 +52,7 @@
 	medloss		100
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -68,7 +68,7 @@
 	medloss		200
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -85,7 +85,7 @@
 	medloss		100
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -102,7 +102,7 @@
 	medloss		400
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -119,7 +119,7 @@
 	medloss		200
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -136,7 +136,7 @@
 	medloss		300
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 Armor 0x13D3
@@ -152,7 +152,7 @@
 	medloss		300
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -170,7 +170,7 @@
 	medloss		100
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 
 }
@@ -188,7 +188,7 @@
 	medloss		100
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -205,7 +205,7 @@
 	medloss		150
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -222,7 +222,7 @@
 	medloss		400
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -239,7 +239,7 @@
 	medloss		500
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 
 }
@@ -263,7 +263,7 @@
 	repairable	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	Cprop		type sranger
 }
@@ -284,7 +284,7 @@
 	repairable	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	Cprop		type sranger
 }
@@ -305,7 +305,7 @@
 	repairable	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	Cprop		type sranger
 }
@@ -326,7 +326,7 @@
 	repairable	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	Cprop		type sranger
 }
@@ -347,7 +347,7 @@
 	repairable	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	Cprop		type sranger
 }
@@ -368,7 +368,7 @@
 	GenderSpecific	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -388,7 +388,7 @@
 	GenderSpecific	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -407,7 +407,7 @@
 	GenderSpecific	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -425,7 +425,7 @@
 	GenderSpecific	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -443,7 +443,7 @@
 	GenderSpecific	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 
 }
@@ -462,7 +462,7 @@
 	GenderSpecific	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -480,7 +480,7 @@
 	GenderSpecific	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -497,7 +497,7 @@
 	medloss		0
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -514,7 +514,7 @@
 	medloss		0
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -534,7 +534,7 @@
 	medloss		1000
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -553,7 +553,7 @@
 	medloss		1000
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -572,7 +572,7 @@
 	DexPenalty	3
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -590,7 +590,7 @@
 	medloss		1000
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -610,7 +610,7 @@
 	DexPenalty	5
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -629,7 +629,7 @@
 	medloss		2000
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -648,7 +648,7 @@
 	medloss		1200
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -666,7 +666,7 @@
 	medloss		1200
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -684,7 +684,7 @@
 	medloss		1200
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -702,7 +702,7 @@
 	medloss		1200
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -720,7 +720,7 @@
 	medloss		1200
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 
 }
@@ -738,7 +738,7 @@
 	medloss		1200
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -756,7 +756,7 @@
 	medloss		1200
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 Armor 0x140F
@@ -773,7 +773,7 @@
 	medloss		1200
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -792,7 +792,7 @@
 	medloss		1500
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -811,7 +811,7 @@
 	medloss		1500
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -829,7 +829,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -846,7 +846,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 
 }
@@ -864,7 +864,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 Armor 0x1B75
@@ -880,7 +880,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -897,7 +897,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 
 }
@@ -914,7 +914,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -931,7 +931,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -948,7 +948,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -964,7 +964,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -981,7 +981,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -995,7 +995,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1009,7 +1009,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1029,7 +1029,7 @@
 	DexPenalty	2
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1048,7 +1048,7 @@
 	DexPenalty	2
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1066,7 +1066,7 @@
 	DexPenalty	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 Armor 0x13ef
@@ -1082,7 +1082,7 @@
 	medloss		500
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1101,7 +1101,7 @@
 	DexPenalty	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1120,7 +1120,7 @@
 	DexPenalty	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1139,7 +1139,7 @@
 	DexPenalty	1
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1159,7 +1159,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 Armor 0x1416
@@ -1177,7 +1177,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1196,7 +1196,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 Armor 0x1417
@@ -1214,7 +1214,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1233,7 +1233,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 Armor 0x141A
@@ -1251,7 +1251,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1271,7 +1271,7 @@
 	DexPenalty	2
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 Armor 0x1418
@@ -1290,7 +1290,7 @@
 	DexPenalty	2
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1309,7 +1309,7 @@
 	medloss		nomed
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1325,7 +1325,7 @@
 	DexPenalty	2
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1341,7 +1341,7 @@
 	DexPenalty	6
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1356,7 +1356,7 @@
 	medloss		500
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1371,7 +1371,7 @@
 	medloss		750
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1387,7 +1387,7 @@
 	DexPenalty	4
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1401,7 +1401,7 @@
 	medloss		500
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1430,7 +1430,7 @@
 	MaxDam		33
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1454,7 +1454,7 @@
 	MaxDam		27
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -1484,7 +1484,7 @@
 	maxrange		20
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1513,7 +1513,7 @@
 	maxrange		20
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1543,7 +1543,7 @@
 	maxrange		20
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1568,7 +1568,7 @@
 	MaxDam		33
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1593,7 +1593,7 @@
 	MaxDam		38
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1618,7 +1618,7 @@
 	MaxDam		35
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1643,7 +1643,7 @@
 	MaxDam		33
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1668,7 +1668,7 @@
 	MaxDam		38
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1694,7 +1694,7 @@
 	MaxDam		39
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1718,7 +1718,7 @@
 	MaxDam		33
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -1742,7 +1742,7 @@
 	MaxDam		32
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -1766,7 +1766,7 @@
 	MaxDam		27
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -1791,7 +1791,7 @@
 	MaxDam		36
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -1815,7 +1815,7 @@
 	MaxDam		30
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -1841,7 +1841,7 @@
 	MaxDam		43
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1867,7 +1867,7 @@
 	MaxDam		49
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1891,7 +1891,7 @@
 	MaxDam		32
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1915,7 +1915,7 @@
 	MaxDam		36
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1938,7 +1938,7 @@
 	MaxDam		32
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1962,7 +1962,7 @@
 	MaxDam		31
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -1986,7 +1986,7 @@
 	MaxDam		28
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2010,7 +2010,7 @@
 	MaxDam		15
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2034,7 +2034,7 @@
 	MaxDam		26
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2058,7 +2058,7 @@
 	MaxDam		28
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2082,7 +2082,7 @@
 	MaxDam		30
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2107,7 +2107,7 @@
 	MaxDam		36
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2131,7 +2131,7 @@
 	MaxDam		17
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2154,7 +2154,7 @@
 	MaxDam		15
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -2179,7 +2179,7 @@
 	MaxDam		14
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2203,7 +2203,7 @@
 	MaxDam		13
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2227,7 +2227,7 @@
 	MaxDam		4
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2249,7 +2249,7 @@
 	MaxDam		24
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -2275,7 +2275,7 @@
 	MaxDam		16
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 	CProp		OnHit a1:S15::combat:maceHit
 }
@@ -2301,7 +2301,7 @@
 	MaxDam		33
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2325,7 +2325,7 @@
 	MaxDam		30
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2349,7 +2349,7 @@
 	MaxDam		43
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 
@@ -2374,7 +2374,7 @@
 	MaxDam		8
 	equipscript	equip
 	unequipscript	unequip
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	destroyscript	destroy
 }
 ############################
@@ -2410,7 +2410,7 @@
 	repairable	0
 	MinDam		1
 	MaxDam		4
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 }
 
 Weapon 0x988b
@@ -2429,7 +2429,7 @@
 	repairable	0
 	MinDam		1
 	MaxDam		4
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 	CProp		OnHit a1:S15::combat:maceHit
 }
 
@@ -2450,7 +2450,7 @@
 	repairable	0
 	MinDam		1
 	MaxDam		4
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 }
 
 Weapon 0x9889
@@ -2473,7 +2473,7 @@
 	TwoHanded	1
 	MinDam		1
 	MaxDam		4
-	controlscript	itemControl
+	controlscript	:combat:old/itemControl
 }
 
 Weapon 0x13e3

Modified: trunk/096/pkg/systems/combat/old/wrestleControl.src
===================================================================
--- trunk/096/pkg/systems/combat/old/wrestleControl.src	2005-11-03 06:32:57 UTC (rev 871)
+++ trunk/096/pkg/systems/combat/old/wrestleControl.src	2005-11-03 06:41:46 UTC (rev 872)
@@ -1,3 +1,6 @@
+/* $Id$
+ *
+ */
 use uo;
 use os;
 use cfgfile;
@@ -3,5 +6,5 @@
 
 
-program itemcontrol(item)
+program control_Wrestle(item)
 	var cfgfile := ReadConfigFile(":combat:itemdesc");
 	var dmg := cfgfile[item.objtype].damage;



From austin at berlios.de  Thu Nov  3 07:51:27 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 07:51:27 +0100
Subject: [Poldistro-svn] r873 - in trunk/096/pkg/skills/magery: . include
Message-ID: <200511030651.jA36pRwK015851@sheep.berlios.de>

Author: austin
Date: 2005-11-03 07:50:55 +0100 (Thu, 03 Nov 2005)
New Revision: 873

Modified:
   trunk/096/pkg/skills/magery/include/settings.inc
   trunk/096/pkg/skills/magery/include/spells.inc
   trunk/096/pkg/skills/magery/movementCheck.src
   trunk/096/pkg/skills/magery/spellStarter.src
Log:
Little more progress.. Need to add some functions to the core.

Modified: trunk/096/pkg/skills/magery/include/settings.inc
===================================================================
--- trunk/096/pkg/skills/magery/include/settings.inc	2005-11-03 06:41:46 UTC (rev 872)
+++ trunk/096/pkg/skills/magery/include/settings.inc	2005-11-03 06:50:55 UTC (rev 873)
@@ -8,7 +8,7 @@
  * MS_GetSettingsCfgFile(engine_name)
  *
  * Purpose
- * Reads in :lumberjacking:config/settings.cfg
+ * Reads in :magery:config/settings.cfg
  *
  * Parameters
  *

Modified: trunk/096/pkg/skills/magery/include/spells.inc
===================================================================
--- trunk/096/pkg/skills/magery/include/spells.inc	2005-11-03 06:41:46 UTC (rev 872)
+++ trunk/096/pkg/skills/magery/include/spells.inc	2005-11-03 06:50:55 UTC (rev 873)
@@ -5,18 +5,19 @@
 
 include ":attributes:attributes";
 include "include/client";
+include "include/dist";
 
 const MAX_RANGE	:= 16;
 
 function SpellDebug(who, text)
 	if ( who.cmdlevel )
-		SendSysMessage(who, text, SSM_INFO_DEBUG);
+		SendSysMessage(who, ""+text);
 	endif
 endfunction
 
 function UseMana(who, amount)
-	if ( GetManaPoints(who) >= amount )
-		SetManaPoints(who, GetManaPoints(who)-amount);
+	if ( AP_GetVital(who, MANA) >= amount )
+		AP_SetVital(who, MANA, AP_GetVital(who, MANA)-amount);
 		return 1;
 	else
 		return 0;
@@ -84,8 +85,8 @@
 endfunction
 
 function GetSpellPoints(mage, targ, points)
-	var mage_skill := GetSkill(mage, "Magery");
-	var defense := GetSkill(targ, "Magic_Resistance");
+	var mage_skill := AP_GetSkill(mage, MAGERY);
+	var defense := AP_GetSkill(targ, RESISTING_SPELLS);
 
 	// Failed MR check results in only half your resistance being used!
 	if ( SkillCheck(targ, "Magic_Resistance", -1) < 0 )

Modified: trunk/096/pkg/skills/magery/movementCheck.src
===================================================================
--- trunk/096/pkg/skills/magery/movementCheck.src	2005-11-03 06:41:46 UTC (rev 872)
+++ trunk/096/pkg/skills/magery/movementCheck.src	2005-11-03 06:50:55 UTC (rev 873)
@@ -4,14 +4,17 @@
 program MovementChecker(params)
 	var who := params[1];
 	var spell_starter := GetProcess(params[2]);
-	var my_x := params[3];
-	var my_y := params[4];
+	var orig_x := params[3];
+	var orig_y := params[4];
+	params := 0; // not needed anymore
 	
 	while ( spell_starter.pid )
-		if ( who.x != my_x || who.y != my_y )
+		if ( who.x != orig_x || who.y != orig_y )
 			spell_starter.SendEvent("moved");
-			return;
+			return 1;
 		endif
 		sleepms(50);
 	endwhile
+	
+	return 1;
 endprogram

Modified: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-03 06:41:46 UTC (rev 872)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-03 06:50:55 UTC (rev 873)
@@ -100,6 +100,10 @@
 endprogram
 
 function CheckDelay(who, attribute, difficulty, base_delay)
+	if ( who.npctemplate )
+		// NPCs are allowed to move.
+		return 1;
+	endif
 	
 	SendSysMessage(who, "You begin building the concentration needed to cast.");
 	var equip_delay := GetEquipmentDelay(who);
@@ -114,24 +118,20 @@
 	if ( delay < 50 )
 		delay := 50;
 	endif
+	var script := start_script("movementCheck", {who, GetPid(), my_x, my_y});
 	
-	var script;
-	if ( !who.npctemplate )
-		script := start_script("movementcheck", {who, GetPid(), my_x, my_y});
-	endif
-	
 	SpellDebug(who, "Cast delay ->"+delay);
+	
 	sleepms(delay);
 	
+	// Delay is over, stop the movement checker.
 	script.kill();
 	
-	if ( who.npctemplate )
-		return 1;
-	elseif ( Events_Waiting() > 0 )
+	if ( Events_Waiting() > 0 )
+		// movementCheck.ecl sent a "moved" event.
 		return 0;
-	elseif ( who.x != my_x || who.y != my_y )
-		return 0;
 	else
+		// Player stood still and can move on.
 		return 1;
 	endif
 endfunction
@@ -150,7 +150,7 @@
 	
 	var cfg := ReadConfigFile(":*:itemdesc");
 	var delay := 0;
-	foreach item in EnumeratePhysicalItems(who)
+	foreach item in ListEquippedItems(who)
 		delay := delay+CInt(cfg[item.objtype].CastDelay);
 		sleepms(2);
 	endforeach
@@ -171,6 +171,7 @@
 
 function CheckRegs(who, byref spell_info)
 	if ( who.npctemplate )
+		// NPCs don't need reagents to cast.
 		return 1;
 	endif
 	
@@ -187,10 +188,10 @@
 			reg_list[objtype] := amount;
 		endif
 
-		if ( AmountInPack(who, objtype) < reg_list[objtype] )
-			SendSysMessage(who, "You do not have enough " + GetName(objtype, 1));
-			return 0;
-		endif
+		//if ( AmountInPack(who, objtype) < reg_list[objtype] )
+		//	SendSysMessage(who, "You do not have enough " + GetName(objtype, 1));
+		//	return 0;
+		//endif
 		sleepms(1);
 	endforeach
 
@@ -203,12 +204,9 @@
 endfunction
 
 function FailSpell(who)
-/*
-Simple function for handling effects when a caster
-fails the casting.
-*/
+	// Simple function for handling effects when a caster
+	// fails the casting.
 	EraseObjProperty(who, "#medding");
-	PlayObjectCenteredEffect(who, FX_SPELL_FAIL, 5, 50);
+	PlayObjectCenteredEffect(who, GFX_SPELL_FAIL, 5, 50);
 	PlaySoundEffect(who, SFX_SPELL_FAIL);
-
 endfunction



From austin at berlios.de  Thu Nov  3 07:53:40 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 07:53:40 +0100
Subject: [Poldistro-svn] r874 - trunk/096/scripts/include
Message-ID: <200511030653.jA36rejo016662@sheep.berlios.de>

Author: austin
Date: 2005-11-03 07:52:37 +0100 (Thu, 03 Nov 2005)
New Revision: 874

Modified:
   trunk/096/scripts/include/client.inc
Log:


Modified: trunk/096/scripts/include/client.inc
===================================================================
--- trunk/096/scripts/include/client.inc	2005-11-03 06:50:55 UTC (rev 873)
+++ trunk/096/scripts/include/client.inc	2005-11-03 06:52:37 UTC (rev 874)
@@ -163,6 +163,11 @@
 	SFX_BEAR_2C		:= 0x4C5,
 	SFX_BEAR_3C		:= 0x4C6,
 	SFX_BEAR_4C		:= 0x4C7,
-	SFX_BEAR_5C		:= 0x4C8
+	SFX_BEAR_5C		:= 0x4C8,
+	
+	SFX_SPELL_FAIL		:= 0x5D,
 endenum
-	
\ No newline at end of file
+
+enum GRAPHIC_EFFECTS
+	GFX_SPELL_FAIL		:= 0x3735
+endenum
\ No newline at end of file



From austin at berlios.de  Thu Nov  3 07:57:37 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 07:57:37 +0100
Subject: [Poldistro-svn] r875 - trunk/096/config
Message-ID: <200511030657.jA36vbkW017581@sheep.berlios.de>

Author: austin
Date: 2005-11-03 07:56:01 +0100 (Thu, 03 Nov 2005)
New Revision: 875

Modified:
   trunk/096/config/itemdesc.cfg
Log:
Spellbook is moved to magery package. Hooray for organization.
Probably need to move reagents and spell scrolls there too.

Modified: trunk/096/config/itemdesc.cfg
===================================================================
--- trunk/096/config/itemdesc.cfg	2005-11-03 06:52:37 UTC (rev 874)
+++ trunk/096/config/itemdesc.cfg	2005-11-03 06:56:01 UTC (rev 875)
@@ -129,25 +129,6 @@
 	RequiresAttention	0
 }
 
-Spellbook 0xEFA
-{
-	Name			Spellbook
-	Desc			spellbook
-	Gump			0xFFFF
-	MinX			40
-	MaxX			60
-	MinY			20
-	MaxY			80
-	SpellType		Magic
-	Newbie			1
-	BlocksCastingIfInHand	0
-	RequiresAttention	0
-	VendorSellsFor		22
-	VendorBuysFor		11
-	Weight			1
-	CanRemoveScript		:containers:container/noRemove
-}
-
 Spellbook 0x2252
 {
 	Name			PaladinSpellbook



From muaddiblsd at berlios.de  Thu Nov  3 08:03:24 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Thu, 3 Nov 2005 08:03:24 +0100
Subject: [Poldistro-svn] r876 - trunk/096/pkg/skills/tailoring
Message-ID: <200511030703.jA373Oll018713@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-03 08:03:10 +0100 (Thu, 03 Nov 2005)
New Revision: 876

Modified:
   trunk/096/pkg/skills/tailoring/itemdesc.cfg
Log:


Modified: trunk/096/pkg/skills/tailoring/itemdesc.cfg
===================================================================
--- trunk/096/pkg/skills/tailoring/itemdesc.cfg	2005-11-03 06:56:01 UTC (rev 875)
+++ trunk/096/pkg/skills/tailoring/itemdesc.cfg	2005-11-03 07:03:10 UTC (rev 876)
@@ -1,509 +1,588 @@
 # $Id$
 #
 #
+# Used as a placeholder only. No real use/item.
+Container 0xeef0
+{
+	Name		CombineCloth
+	Graphic		0x1018
+	Gump		0x003C
+	MinX		0
+	MaxX		66
+	MinY		0
+	MaxY		33
+	Weight		0
+	MaxItems	65535
+	Maxweight	65535
+}
+
 Armor 0x1718
 {
-	Name			wizardhat
-	VendorBuysFor		10
-	VendorSellsFor		30
-	CanDye			1
-	AR			2
-	MaxHP			20
-	Coverage		Head
-	DestroyScript		:combat:onDestroy
-	
-	CProp	type	swizzohat
+	Name		wizardhat
+	VendorBuysFor	10
+	VendorSellsFor	30
+	CanDye		1
+	AR		2
+	maxhp		20
+	Coverage	Head
+	destroyscript	:combat:onDestroy
+	Cprop		type	swizzohat
 }
+
 Armor 0x1F03
 {
-	Name			deathrobe
-	AR			2
-	Coverage		Body
-	Coverage		Legs/feet
-	Coverage		Arms
-	Newbie			1
-	MaxHP			10
-	CanDye			1
-	
+	Name		deathrobe
+	AR		2
+	Coverage	Body
+	Coverage	Legs/feet
+	Coverage	Arms
+	newbie		1
+	maxhp		10
+	CanDye		1
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x9945
 {
-	Name			Robe
-	Graphic			0x1F03
-	AR			4
-	Coverage		Body
-	Coverage		Legs/feet
-	Coverage		Arms
-	VendorSellsFor		68
-	VendorBuysFor		34
-	MaxHP			20
-	CanDye			1
-	
+	Name		Robe
+	Graphic		0x1f03
+	AR		4
+	Coverage	Body
+	Coverage	Legs/feet
+	Coverage	Arms
+	VendorSellsFor	68
+	VendorBuysFor	34
+	maxhp		20
+	CanDye		1
 	DestroyScript		:combat:onDestroy
 }
+
 Item 0xF9D
 {
-	Name			SewingKit
-	Script			makeClothItems
-	VendorSellsFor		3
-	VendorBuysFor		1
+	Name		SewingKit
+	Script		makeClothItems
+	VendorSellsFor	3
+	VendorBuysFor	1
 }
+
 Armor 0x153A
 {
-	Name			LongPants1
-	VendorSellsFor		34
-	VendorBuysFor		17
-	CanDye			1
-	AR			3
-	MaxHP			20
-	Coverage		Legs/feet
+	Name		LongPants1
+	VendorSellsFor	34
+	VendorBuysFor	17
+	CanDye		1
+	AR		3
+	maxhp		20
+	Coverage	Legs/feet
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x170D
 {
-	Name			Sandals
-	VendorSellsFor		24
-	VendorBuysFor		12
-	CanDye			1
-	AR			2
-	Coverage		Legs/feet
-	MaxHP			20
+	Name		Sandals
+	VendorSellsFor	24
+	VendorBuysFor	12
+	CanDye		1
+	AR		2
+	Coverage	Legs/feet
+	maxhp		20
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x170F
 {
-	Name			Shoes
-	VendorSellsFor		27
-	VendorBuysFor		13
-	CanDye			1
-	AR			1
-	MaxHP			20
-	Coverage		Legs/feet
+	Name		Shoes
+	VendorSellsFor	27
+	VendorBuysFor	13
+	CanDye		1
+	AR		1
+	maxhp		20
+	Coverage	Legs/feet
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1EFD
 {
-	Name			Fancy Shirt
-	VendorSellsFor		55
-	VendorBuysFor		27
-	CanDye			1
-	AR			4
-	MaxHP			20
-	Coverage		Body
-	Coverage		Arms
+	Name		Fancy Shirt
+	VendorSellsFor	55
+	VendorBuysFor	27
+	CanDye		1
+	AR		4
+	maxhp		20
+	Coverage	Body
+	Coverage	Arms
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1EFF
 {
-	Name			Fancy Dress
-	VendorSellsFor		25
-	VendorBuysFor		12
-	CanDye			1
-	AR			4
-	MaxHP			20
-	Coverage		Body
-	Coverage		Legs/feet
-	Coverage		Arms
+	Name		Fancy Dress
+	VendorSellsFor	25
+	VendorBuysFor	12
+	CanDye		1
+	AR		4
+	maxhp		20
+	Coverage	Body
+	Coverage	Legs/feet
+	Coverage	Arms
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1F01
 {
-	Name			Plain Dress
-	VendorSellsFor		56
-	VendorBuysFor		28
-	CanDye			1
-	AR			3
-	MaxHP			20
-	Coverage		Body
-	Coverage		Legs/feet
-	Coverage		Arms
+	Name		Plain Dress
+	VendorSellsFor	56
+	VendorBuysFor	28
+	CanDye		1
+	AR		3
+	maxhp		20
+	Coverage	Body
+	Coverage	Legs/feet
+	Coverage	Arms
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1F7B
 {
-	Name			Doublet
-	VendorSellsFor		25
-	VendorBuysFor		12
-	CanDye			1
-	AR			3
-	MaxHP			20
-	Coverage		Body
+	Name		Doublet
+	VendorSellsFor	25
+	VendorBuysFor	12
+	CanDye		1
+	AR		3
+	maxhp		20
+	Coverage	Body
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1F9F
 {
-	Name			JesterSuit
-	VendorSellsFor		51
-	VendorBuysFor		25
-	CanDye			1
-	AR			4
-	MaxHP			20
-	Coverage		Body
-	Coverage		Arms
+	Name		JesterSuit
+	VendorSellsFor	51
+	VendorBuysFor	25
+	CanDye		1
+	AR		4
+	maxhp		20
+	Coverage	Body
+	Coverage	Arms
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1FA1
 {
-	Name			Tunic
-	VendorSellsFor		33
-	VendorBuysFor		16
-	CanDye			1
-	AR			3
-	MaxHP			20
-	Coverage		Body
-	Coverage		Arms
+	Name		Tunic
+	VendorSellsFor	33
+	VendorBuysFor	16
+	CanDye		1
+	AR		3
+	maxhp		20
+	Coverage	Body
+	Coverage	Arms
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1FFD
 {
-	Name			Surcoat
-	VendorSellsFor		40
-	VendorBuysFor		22
-	CanDye			1
-	AR			2
-	MaxHP			20
-	Coverage		Body
+	Name		Surcoat
+	VendorSellsFor	40
+	VendorBuysFor	22
+	CanDye		1
+	AR		2
+	maxhp		20
+	Coverage	Body
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1517
 {
-	Name			Shirt
-	VendorSellsFor		37
-	VendorBuysFor		18
-	CanDye			1
-	AR			2
-	MaxHP			20
-	Coverage		Body
-	Coverage		Arms
+	Name		Shirt
+	VendorSellsFor	37
+	VendorBuysFor	18
+	CanDye		1
+	AR		2
+	maxhp		20
+	Coverage	Body
+	Coverage	Arms
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1515
 {
-	Name			Cloak
-	VendorSellsFor		43
-	VendorBuysFor		21
-	CanDye			1
-	AR			2
-	MaxHP			20
+	Name		Cloak
+	VendorSellsFor	43
+	VendorBuysFor	21
+	CanDye		1
+	AR		2
+	maxhp		20
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1516
 {
-	Name			Skirt
-	VendorSellsFor		33
-	VendorBuysFor		16
-	CanDye			1
-	AR			2
-	MaxHP			20
-	Coverage		Body
+	Name		Skirt
+	VendorSellsFor	33
+	VendorBuysFor	16
+	CanDye		1
+	AR		2
+	maxhp		20
+	Coverage	Body
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x152E
 {
-	Name			ShortPants
-	VendorSellsFor		24
-	VendorBuysFor		12
-	CanDye			1
-	AR			1
-	MaxHP			20
-	Coverage		Legs/feet
+	Name		ShortPants
+	VendorSellsFor	24
+	VendorBuysFor	12
+	CanDye		1
+	AR		1
+	maxhp		20
+	Coverage	Legs/feet
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1537
 {
-	Name			Kilt
-	VendorSellsFor		31
-	VendorBuysFor		15
-	CanDye			1
-	AR			1
-	MaxHP			20
-	Coverage		Legs/feet
+	Name		Kilt
+	VendorSellsFor	31
+	VendorBuysFor	15
+	CanDye		1
+	AR		1
+	maxhp		20
+	Coverage	Legs/feet
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1539
 {
-	Name			LongPants2
-	VendorSellsFor		34
-	VendorBuysFor		17
-	CanDye			1
-	AR			3
-	MaxHP			20
-	Coverage		Legs/feet
+	Name		LongPants2
+	VendorSellsFor	34
+	VendorBuysFor	17
+	CanDye		1
+	AR		3
+	maxhp		20
+	Coverage	Legs/feet
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x153B
 {
-	Name			HalfApron
-	VendorSellsFor		26
-	VendorBuysFor		13
-	CanDye			1
-	AR			2
-	MaxHP			20
-	Coverage		Legs/feet
+	Name		HalfApron
+	VendorSellsFor	26
+	VendorBuysFor	13
+	CanDye		1
+	AR		2
+	maxhp		20
+	Coverage	Legs/feet
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x153D
 {
-	Name			FullApron
-	VendorSellsFor		26
-	VendorBuysFor		13
-	CanDye			1
-	AR			3
-	MaxHP			20
-	Coverage		Body
-	Coverage		Legs/feet
+	Name		FullApron
+	VendorSellsFor	26
+	VendorBuysFor	13
+	CanDye		1
+	AR		3
+	maxhp		20
+	Coverage	Body
+	Coverage	Legs/feet
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x153F
 {
-	Name			Bandana
-	VendorSellsFor		14
-	VendorBuysFor		6
-	CanDye			1
-	AR			1
-	MaxHP			20
-	Coverage		Head
+	Name		Bandana
+	VendorSellsFor	14
+	VendorBuysFor	6
+	CanDye		1
+	AR		1
+	maxhp		20
+	Coverage	Head
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1541
 {
-	Name			BodySash
-	VendorSellsFor		20
-	VendorBuysFor		10
-	CanDye			1
-	AR			1
-	MaxHP			20
-	Coverage		Body
+	Name		BodySash
+	VendorSellsFor	20
+	VendorBuysFor	10
+	CanDye		1
+	AR		1
+	maxhp		20
+	Coverage	Body
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1543
 {
-	Name			Skullcap
-	VendorSellsFor		12
-	VendorBuysFor		6
-	CanDye			1
-	AR			1
-	MaxHP			20
-	Coverage		Head
+	Name		Skullcap
+	VendorSellsFor	12
+	VendorBuysFor	6
+	CanDye		1
+	AR		1
+	maxhp		20
+	Coverage	Head
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1713
 {
-	Name			FloppyHat
-	VendorSellsFor		25
-	VendorBuysFor		12
-	CanDye			1
-	AR			2
-	MaxHP			20
-	Coverage		Head
+	Name		FloppyHat
+	VendorSellsFor	25
+	VendorBuysFor	12
+	CanDye		1
+	AR		2
+	maxhp		20
+	Coverage	Head
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1714
 {
-	Name			WideBrimHat
-	VendorSellsFor		26
-	VendorBuysFor		13
-	CanDye			1
-	AR			2
-	MaxHP			20
-	Coverage		Head
+	Name		WideBrimHat
+	VendorSellsFor	26
+	VendorBuysFor	13
+	CanDye		1
+	AR		2
+	maxhp		20
+	Coverage	Head
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1715
 {
-	Name			Cap
-	VendorSellsFor		27
-	VendorBuysFor		13
-	CanDye			1
-	AR			1
-	MaxHP			20
-	Coverage		Head
+	Name		Cap
+	VendorSellsFor	27
+	VendorBuysFor	13
+	CanDye		1
+	AR		1
+	maxhp		20
+	Coverage	Head
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1719
 {
-	Name			Bonnet
-	VendorSellsFor		26
-	VendorBuysFor		13
-	CanDye			1
-	AR			1
-	MaxHP			20
-	Coverage		Head
+	Name		Bonnet
+	VendorSellsFor	26
+	VendorBuysFor	13
+	CanDye		1
+	AR		1
+	maxhp		20
+	Coverage	Head
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x171A
 {
-	Name			FeatheredHat
-	VendorSellsFor		27
-	VendorBuysFor		13
-	CanDye			1
-	AR			2
-	MaxHP			20
-	Coverage		Head
+	Name		FeatheredHat
+	VendorSellsFor	27
+	VendorBuysFor	13
+	CanDye		1
+	AR		2
+	maxhp		20
+	Coverage	Head
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x171B
 {
-	Name			TricorneHat
-	VendorSellsFor		26
-	VendorBuysFor		13
-	CanDye			1
-	AR			2
-	MaxHP			20
-	Coverage		Head
+	Name		TricorneHat
+	VendorSellsFor	26
+	VendorBuysFor	13
+	CanDye		1
+	AR		2
+	maxhp		20
+	Coverage	Head
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x171C
 {
-	Name			Jesterhat
-	VendorSellsFor		31
-	VendorBuysFor		15
-	CanDye			1
-	AR			1
-	MaxHP			20
-	Coverage		Head
+	Name		Jesterhat
+	VendorSellsFor	31
+	VendorBuysFor	15
+	CanDye		1
+	AR		1
+	maxhp		20
+	Coverage	Head
 	DestroyScript		:combat:onDestroy
 }
+
 Armor 0x1716
 {
-	Name			strawhat
-	VendorSellsFor		31
-	VendorBuysFor		15
-	CanDye			1
-	AR			1
-	MaxHP			20
-	Coverage		Head
+	Name		strawhat
+	VendorSellsFor	31
+	VendorBuysFor	15
+	CanDye		1
+	AR		1
+	maxhp		20
+	Coverage	Head
 	DestroyScript		:combat:onDestroy
 }
 
 Item 0xe1f
 {
-	Name			yarn
-	Script			tailoring
-	VendorSellsFor		10
-	VendorBuysFor		7
+	Name		yarn
+	Script		tailoring
+	VendorSellsFor	10
+	VendorBuysFor	7
 }
 
 Item 0xFA0
 {
-	Name			Thread1
-	Script			tailoring
-	VendorSellsFor		10
-	VendorBuysFor		7
+	Name		Thread1
+	Script		tailoring
+	VendorSellsFor	10
+	VendorBuysFor	7
 }
 
 Item 0xfa1
 {
-	Name			Thread2
-	Script			tailoring
-	VendorSellsFor		10
-	VendorBuysFor		7
+	Name		Thread2
+	Script		tailoring
+	VendorSellsFor	10
+	VendorBuysFor	7
 }
 
 Item 0xf9e
 {
-	Name			Scissors
-	Script			scissors
-	VendorSellsFor		10
-	VendorBuysFor		5
+	Name		Scissors
+	Script		scissors
+	VendorSellsFor	10
+	VendorBuysFor	5
 }
 
 Item 0xf125
 {
-	Name			wool
-	desc			pile%s% of wool
-	Weight			1
-	Script			spinning
-	Graphic			0xdf8
-	VendorSellsFor		30
-	VendorBuysFor		15
+	Name		wool
+	desc		pile%s% of wool
+	Weight		1
+	Script		spinning
+	Graphic		0xdf8
+	VendorSellsFor	30
+	VendorBuysFor	15
 }
 
 Item 0xf95
 {
-	Name			bolt1
-	Color			0
-	Desc			bolt%s% of cloth
-	Weight			5
-	VendorSellsFor		60
-	VendorBuysFor		30
+	Name		bolt1
+	Color		0
+	Desc		bolt%s% of cloth
+	Weight		5
+	VendorSellsFor	60
+	VendorBuysFor	30
 }
 
 Item 0xf96
 {
-	Name			bolt2
-	Color			0
-	Desc			bolt%s% of cloth
-	Weight			5
-	VendorSellsFor		60
-	VendorBuysFor		30
+	Name		bolt2
+	Color		0
+	Desc		bolt%s% of cloth
+	Weight		5
+	VendorSellsFor	60
+	VendorBuysFor	30
 }
 
 Item 0xf97
 {
-	Name			bolt3
-	Color			0
-	Desc			bolt%s% of cloth
-	Weight			5
-	VendorSellsFor		60
-	VendorBuysFor		30
+	Name		bolt3
+	Color		0
+	Desc		bolt%s% of cloth
+	Weight		5
+	VendorSellsFor	60
+	VendorBuysFor	30
 }
 
 Item 0xf98
 {
-	Name			bolt4
-	Color			0
-	Desc			bolt%s% of cloth
-	Weight			5
-	VendorSellsFor		60
-	VendorBuysFor		30
+	Name		bolt4
+	Color		0
+	Desc		bolt%s% of cloth
+	Weight		5
+	VendorSellsFor	60
+	VendorBuysFor	30
 }
 
 Item 0xf99
 {
-	Name			bolt5
-	Color			0
-	Desc			bolt%s% of cloth
-	Weight			5
-	VendorSellsFor		60
-	VendorBuysFor		30
+	Name		bolt5
+	Color		0
+	Desc		bolt%s% of cloth
+	Weight		5
+	VendorSellsFor	60
+	VendorBuysFor	30
 }
 
 Item 0xf9a
 {
-	Name			bolt6
-	Color			0
-	Desc			bolt%s% of cloth
-	Weight			5
-	VendorSellsFor		60
-	VendorBuysFor		30
+	Name		bolt6
+	Color		0
+	Desc		bolt%s% of cloth
+	Weight		5
+	VendorSellsFor	60
+	VendorBuysFor	30
 }
+
 Item 0xf9b
 {
-	Name			bolt7
-	Color			0
-	Desc			bolt%s% of cloth
-	Weight			5
-	VendorSellsFor		60
-	VendorBuysFor		30
+	Name		bolt7
+	Color		0
+	Desc		bolt%s% of cloth
+	Weight		5
+	VendorSellsFor	60
+	VendorBuysFor	30
 }
+
 Item 0xf9c
 {
-	Name			bolt8
-	Color			0
-	Desc			bolt%s% of cloth
-	Weight			5
-	VendorSellsFor		60
-	VendorBuysFor		30
+	Name		bolt8
+	Color		0
+	Desc		bolt%s% of cloth
+	Weight		5
+	VendorSellsFor	60
+	VendorBuysFor	30
 }
 
 Item 0x1766
 {
-	Name			clothpiece
-	Color			0
-	Desc			cut cloth
-	Weight			1/10
-	VendorSellsFor		2
-	VendorBuysFor		0
+	Name		clothpiece
+	Color		0
+	Desc		cut cloth
+	Weight		1/10
+	VendorSellsFor	2
+	VendorBuysFor	0
+}
+
+Item 0x702e
+{
+	Name		spinedhides
+	Desc		spined hide%s
+	Weight		1/2
+	Graphic		0x1078
+	Color		1337
+	VendorSellsFor	4
+	VendorBuysFor	2
+}
+
+Item 0x702f
+{
+	Name		barbedhides
+	Desc		barbed hide%s
+	Weight	 	1/2
+	Graphic		0x1078
+	Color		1425
+	VendorSellsFor 	4
+	VendorBuysFor 	2
+}
+
+Item 0x7030
+{
+	Name		hornedhides
+	Desc		horned hide%s
+	Weight 		1/2
+	Graphic		0x1078
+	Color		1653
+	VendorSellsFor 	4
+	VendorBuysFor 	2
 }
\ No newline at end of file



From muaddiblsd at berlios.de  Thu Nov  3 08:33:24 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Thu, 3 Nov 2005 08:33:24 +0100
Subject: [Poldistro-svn] r877 - in trunk/096/pkg: . other packetHooks packetHooks/CharProfile packetHooks/CharProfile/config packetHooks/OpenDoor packetHooks/OpenDoor/config packetHooks/RequestAttack packetHooks/RequestAttack/config packetHooks/WarAndPeace packetHooks/WarAndPeace/config
Message-ID: <200511030733.jA37XOAU029157@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-03 08:33:13 +0100 (Thu, 03 Nov 2005)
New Revision: 877

Added:
   trunk/096/pkg/packetHooks/
   trunk/096/pkg/packetHooks/CharProfile/
   trunk/096/pkg/packetHooks/CharProfile/charprofile.src
   trunk/096/pkg/packetHooks/CharProfile/config/
   trunk/096/pkg/packetHooks/CharProfile/config/icp.cfg
   trunk/096/pkg/packetHooks/CharProfile/onDelete.src
   trunk/096/pkg/packetHooks/CharProfile/parseCharProfile.src
   trunk/096/pkg/packetHooks/CharProfile/pkg.cfg
   trunk/096/pkg/packetHooks/CharProfile/uopacket.cfg
   trunk/096/pkg/packetHooks/OpenDoor/
   trunk/096/pkg/packetHooks/OpenDoor/config/
   trunk/096/pkg/packetHooks/OpenDoor/config/icp.cfg
   trunk/096/pkg/packetHooks/OpenDoor/openDoor.src
   trunk/096/pkg/packetHooks/OpenDoor/pkg.cfg
   trunk/096/pkg/packetHooks/OpenDoor/uopacket.cfg
   trunk/096/pkg/packetHooks/RequestAttack/
   trunk/096/pkg/packetHooks/RequestAttack/config/
   trunk/096/pkg/packetHooks/RequestAttack/config/icp.cfg
   trunk/096/pkg/packetHooks/RequestAttack/pkg.cfg
   trunk/096/pkg/packetHooks/RequestAttack/requestAttack.src
   trunk/096/pkg/packetHooks/RequestAttack/uopacket.cfg
   trunk/096/pkg/packetHooks/WarAndPeace/
   trunk/096/pkg/packetHooks/WarAndPeace/config/
   trunk/096/pkg/packetHooks/WarAndPeace/config/icp.cfg
   trunk/096/pkg/packetHooks/WarAndPeace/pkg.cfg
   trunk/096/pkg/packetHooks/WarAndPeace/readme.txt
   trunk/096/pkg/packetHooks/WarAndPeace/requestWar.src
   trunk/096/pkg/packetHooks/WarAndPeace/uopacket.cfg
Removed:
   trunk/096/pkg/other/packetHooks/
Log:
Moved packetHooks pkgs from /pkg/other/packetHooks to pkg/packetHooks for better dir layout.

Any packetHooks pkgs that are Expansion sensitive will be here also, but make use of Conflicts entry in pkg.cfg so they are only useable under compatible expansions. That way I don't have to tell 5000 different tards why StatLocking won't work with 2.x clients.

Added: trunk/096/pkg/packetHooks/CharProfile/charprofile.src
===================================================================
--- trunk/096/pkg/packetHooks/CharProfile/charprofile.src	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/CharProfile/charprofile.src	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,22 @@
+/* $Id: charprofile.src 688 2005-10-28 13:04:01Z panosl $
+ *
+ */
+use os;
+
+program charprofile()
+	Print( "INSTALLING: Character Profile PH..." );
+	return 1;
+endprogram
+
+CONST PROFILE_UPDATE_MODE := 1;
+CONST PROFILE_REQUEST_MODE := 0;
+CONST OFFSET_MODE := 3;
+
+exported function HandleCharProfileRequest( character, byref packet )
+
+
+	start_script("parseCharProfile", { character, packet });
+
+	return 1;
+
+endfunction

Added: trunk/096/pkg/packetHooks/CharProfile/config/icp.cfg
===================================================================
--- trunk/096/pkg/packetHooks/CharProfile/config/icp.cfg	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/CharProfile/config/icp.cfg	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,19 @@
+# $Id: icp.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+ICP Register
+{
+	Name		Character Profile Handler
+	Version		1.0
+	Description	PacketHook for handling Character Profile.
+
+	Creator		Racalac
+	C_Email		racalac at burdell.org
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}

Added: trunk/096/pkg/packetHooks/CharProfile/onDelete.src
===================================================================
--- trunk/096/pkg/packetHooks/CharProfile/onDelete.src	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/CharProfile/onDelete.src	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,17 @@
+/* $Id: onDelete.src 661 2005-10-26 15:39:23Z muaddiblsd $
+ *
+ */
+use datafile;
+
+include ":datafile:datafile";
+
+program charProfile_onDelete(who)
+
+	var cp_data_file  := DFOpenDataFile(":charprofile:CPFile", DF_NO_CREATE);
+	if( cp_data_file )
+		return cp_data_file.DeleteElement(who.serial);
+	endif
+
+	return 1;
+
+endprogram

Added: trunk/096/pkg/packetHooks/CharProfile/parseCharProfile.src
===================================================================
--- trunk/096/pkg/packetHooks/CharProfile/parseCharProfile.src	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/CharProfile/parseCharProfile.src	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,100 @@
+/* $Id: parseCharProfile.src 661 2005-10-26 15:39:23Z muaddiblsd $
+ *
+ */
+use uo;
+use os;
+use polsys;
+use datafile;
+
+include ":datafile:datafile";
+
+CONST PROFILE_MSGTYPE := 0xB8;
+CONST PROFILE_TITLE := "Profile for ";
+CONST PROFILE_UPDATE_MODE := 1;
+CONST PROFILE_REQUEST_MODE := 0;
+CONST HEADER_SIZE := 7;
+CONST NULL_SIZE := 1;
+CONST UNULL_SIZE := 2;
+CONST UCHAR_SIZE := 2;
+
+CONST OFFSET_MSGTYPE := 0;
+CONST OFFSET_MSGLEN := 1;
+CONST OFFSET_MODE := 3;
+CONST OFFSET_SERIAL_OUT := 3;
+CONST OFFSET_SERIAL_IN := 4;
+CONST OFFSET_TITLE_STR := 7;
+CONST OFFSET_CMDTYPE := 8;
+CONST OFFSET_NEW_PROFILE_TEXTLEN := 10;
+CONST OFFSET_NEW_PROFILE := 12;
+
+program runScript_CharProfileRequest( who, packet )
+
+	var mode := packet.GetInt8(OFFSET_MODE); //mode 0 for request, 1 for update
+	var id := packet.GetInt32(OFFSET_SERIAL_IN);  //serial of requested profile
+                                                //who
+	var chr := SystemFindObjectBySerial(id);
+	if(!chr || !chr.isa(POLCLASS_MOBILE))
+		return; //don't bother working on nonexistant or items :P
+	endif
+
+	var cp_data_file  := DFOpenDataFile(":charprofile:CPFile", DF_CREATE);
+	var cp_elem       := DFFindElement(cp_data_file, who.serial, DF_CREATE);
+	var cp_profile    := DFGetProp(cp_elem, "Profile", DF_CREATE);
+
+	if(mode == PROFILE_UPDATE_MODE)
+		//number of unicode whos
+		var msglen := packet.GetInt16(OFFSET_NEW_PROFILE_TEXTLEN);
+
+		//updated profile str
+		var uctext := packet.GetUnicodeString(OFFSET_NEW_PROFILE,msglen);
+		if(chr.serial == who.serial) // don't allow setting profile for others
+			cp_elem.SetProp("Profile", uctext); // set my profile
+		endif
+	elseif(mode == PROFILE_REQUEST_MODE)
+		//profile request, send profile back
+		if(cp_profile == error)
+			cp_profile := array; //empty array if no profile was set prev.
+		endif
+
+		//create the response packet
+		var title_str := PROFILE_TITLE + chr.name; //goes at the top of scroll
+		var outpkt := CreatePacket(PROFILE_MSGTYPE, MSGLEN_VARIABLE);
+
+		outpkt.SetInt16(OFFSET_MSGLEN, outpkt.GetSize()); //set the size of the packet
+		outpkt.SetInt32(OFFSET_SERIAL_OUT, chr.serial); //set the serial of the who
+		outpkt.SetString(OFFSET_TITLE_STR,title_str,1); //set the title string+terminator
+
+		//profile packet includes an uneditable string and an editable one.
+		//if this is "my" profile, put the profile text in the editable
+		//location. if this is another who's profile, put it in the
+		//uneditable location. This is why we reserved 2 bytes twice for the
+		//terminators. only one of the strings will be filled, the other will
+		//only include a 2-byte terminator.
+		var uneditable_profile_offset := OFFSET_TITLE_STR+len(title_str)+NULL_SIZE; //edit comes first
+		var editable_profile_offset;
+
+		if(chr.serial != who.serial)
+			//not me, set the string at the uneditable offset
+			outpkt.SetUnicodeString(uneditable_profile_offset,cp_profile,1);
+			//calculate the editable string offset
+			editable_profile_offset := uneditable_profile_offset + (cp_profile.size()*UCHAR_SIZE);
+			//set just a double terminator at the editable offset
+			outpkt.SetInt16(editable_profile_offset,0);
+		else
+			//it's my profile, no text at uneditable
+			outpkt.SetInt16(uneditable_profile_offset,0);
+			//editable offset past the 2 byte terminator
+			editable_profile_offset := uneditable_profile_offset + UNULL_SIZE;
+			//set the unicode text
+			outpkt.SetUnicodeString(editable_profile_offset,cp_profile,1);
+		endif
+		//send the packet to the _requesting_ who, not the who
+		//whose profile this is.
+		outpkt.SendPacket(who);
+	else
+		SysLog("Unknown profile mode: " + mode);
+	endif
+
+	return 1;
+
+endprogram

Added: trunk/096/pkg/packetHooks/CharProfile/pkg.cfg
===================================================================
--- trunk/096/pkg/packetHooks/CharProfile/pkg.cfg	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/CharProfile/pkg.cfg	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,9 @@
+# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+Enabled		1
+Name		charprofile
+Maintainer	Distro Team
+Email		distro at polserver.com
+CoreRequired	96
+Version		1.0

Added: trunk/096/pkg/packetHooks/CharProfile/uopacket.cfg
===================================================================
--- trunk/096/pkg/packetHooks/CharProfile/uopacket.cfg	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/CharProfile/uopacket.cfg	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,5 @@
+Packet 0xB8
+{
+  Length variable
+  ReceiveFunction charprofile:HandleCharProfileRequest
+}

Added: trunk/096/pkg/packetHooks/OpenDoor/config/icp.cfg
===================================================================
--- trunk/096/pkg/packetHooks/OpenDoor/config/icp.cfg	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/OpenDoor/config/icp.cfg	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,19 @@
+# $Id: icp.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+ICP Register
+{
+	Name		OpenDoor Macro Handler
+	Version		1.0
+	Description	PacketHook for handling OpenDoor Action Macro.
+
+	Creator		MuadDib
+	C_Email		muaddib at lostsoulsshard.org
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}

Added: trunk/096/pkg/packetHooks/OpenDoor/openDoor.src
===================================================================
--- trunk/096/pkg/packetHooks/OpenDoor/openDoor.src	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/OpenDoor/openDoor.src	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,73 @@
+////////////////////////////////////////////////////////////////////////////////////////////////////
+//
+//  name:    OpenDoor Action Hook
+//  version: 1.0
+//  author:  MuadDib
+//
+//  Purpose: The OpenDoor Client macro is never used on freeshards for lack of support. However,
+//           those familiar with OSI know and use this a lot. This hook was made to show the purpose
+//           of the macro and for learning a bit on packets.
+//
+//  Notes:   The script will check for doors the player can access. However, it will check them and
+//           open them only if the player is 1 tile away, and facing the door. As per the OSI method
+//
+//  To Do:   Integrate ability to use this to "close" the door also. To tired to do so now.
+//
+//  Const Settings:
+//  DOOR_TIMER = # The value in seconds, that the player must wait before the macro will work again.
+//
+////////////////////////////////////////////////////////////////////////////////////////////////////
+use uo;
+use os;
+
+program openDoor()
+	Print( "INSTALLING: OpenDoor Action Macro PH..." );
+	return 1;
+endprogram
+
+CONST DOOR_TIMER := 5;
+
+exported function HandleOpenDoorMacro( character, byref packet )
+
+ 	// Done to stop the "unused variable" report in ecompile.
+ 	packet := packet;
+ 	// To stop mad spamming of the macro, we check a temp cprop for the timer. If the timer is not
+ 	// set to a time less than the current Game Clock, it exits now.
+ 	if(GetObjProperty(character, "#DoorMacro") > ReadGameClock())
+ 		return 0;
+ 	endif
+ 	// Set the Temp Cprop to the Game Clock + the timer for the wait period.
+ 	SetObjProperty(character, "#DoorMacro", ReadGameClock() + DOOR_TIMER);
+ 	// Record the player's direction. This is used to look ONLY in the direction the player is facing.
+ 	var direction := character.facing;
+ 	var item := 0;
+ 	// Facing is always 0-7 for a player, so let's just do this in a case.
+ 	// The only exception is while they are running, which who cares about
+ 	// those trying to run non-stop through a door eh? ;)
+ 	case(direction)
+ 		0: item := ListItemsNearLocationWithFlag((character.x),(character.y-1),(character.z),0,TILEDATA_FLAG_DOOR);
+ 		1: item := ListItemsNearLocationWithFlag((character.x+1),(character.y-1),(character.z),0,TILEDATA_FLAG_DOOR);
+ 		2: item := ListItemsNearLocationWithFlag((character.x+1),(character.y),(character.z),0,TILEDATA_FLAG_DOOR);
+ 		3: item := ListItemsNearLocationWithFlag((character.x+1),(character.y+1),(character.z),0,TILEDATA_FLAG_DOOR);
+ 		4: item := ListItemsNearLocationWithFlag((character.x),(character.y+1),(character.z),0,TILEDATA_FLAG_DOOR);
+ 		5: item := ListItemsNearLocationWithFlag((character.x-1),(character.y+1),(character.z),0,TILEDATA_FLAG_DOOR);
+ 		6: item := ListItemsNearLocationWithFlag((character.x-1),(character.y),(character.z),0,TILEDATA_FLAG_DOOR);
+ 		7: item := ListItemsNearLocationWithFlag((character.x-1),(character.y-1),(character.z),0,TILEDATA_FLAG_DOOR);
+ 	endcase
+ 	// See if item found is a Door. Check if the player has Line Of Sight to the door. Make sure they
+ 	// Are ALIVE!
+ 	if(item[1].isA(POLCLASS_DOOR))
+ 		if(!CheckLineOfSight(character,item[1]))
+ 			return 1;
+ 		elseif(character.dead)
+ 			return 1;
+ 		endif
+ 		// THis needs to be upgraded to use a new command that will fire the script as though it was
+ 		// fired by the item it belongs to being double clicked. Was added in recent Test Cores.
+ 		UseItem(item[1], character);
+ 	endif
+
+  // Since the core ignores this packet, might as well block it from the core anyway.
+  return 1;
+
+endfunction

Added: trunk/096/pkg/packetHooks/OpenDoor/pkg.cfg
===================================================================
--- trunk/096/pkg/packetHooks/OpenDoor/pkg.cfg	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/OpenDoor/pkg.cfg	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,9 @@
+# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+Enabled		1
+Name		opendoor
+Maintainer	Distro Team
+Email		distro at polserver.com
+CoreRequired	96
+Version		1.0

Added: trunk/096/pkg/packetHooks/OpenDoor/uopacket.cfg
===================================================================
--- trunk/096/pkg/packetHooks/OpenDoor/uopacket.cfg	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/OpenDoor/uopacket.cfg	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,12 @@
+Packet 0x12
+{
+  Length variable
+  SubCommandOffset 3
+  SubCommandLength 1
+}
+
+SubPacket 0x12
+{
+  SubCommandID 0x58
+  ReceiveFunction openDoor:HandleOpenDoorMacro
+}

Added: trunk/096/pkg/packetHooks/RequestAttack/config/icp.cfg
===================================================================
--- trunk/096/pkg/packetHooks/RequestAttack/config/icp.cfg	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/RequestAttack/config/icp.cfg	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,19 @@
+# $Id: icp.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+ICP Register
+{
+	Name		Request Attack
+	Version		1.0
+	Description	PacketHook for handling Request Attack (dbl click in war mode).
+
+	Creator		MuadDib
+	C_Email		muaddib at lostsoulsshard.org
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}

Added: trunk/096/pkg/packetHooks/RequestAttack/pkg.cfg
===================================================================
--- trunk/096/pkg/packetHooks/RequestAttack/pkg.cfg	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/RequestAttack/pkg.cfg	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,9 @@
+# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+Enabled         1
+Name		requestattack
+Maintainer	Distro Team
+Email		distro at polserver.com
+CoreRequired	96
+Version		1.0

Added: trunk/096/pkg/packetHooks/RequestAttack/requestAttack.src
===================================================================
--- trunk/096/pkg/packetHooks/RequestAttack/requestAttack.src	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/RequestAttack/requestAttack.src	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,40 @@
+/* $Id: requestAttack.src 677 2005-10-27 04:44:34Z muaddiblsd $
+ *
+ */
+////////////////////////////////////////////////////////////////////////////////////////////////////
+//
+//  name:    Request Attack Packet Hook
+//  version: 1.0
+//  author:  MuadDib
+//
+//  Purpose: This hook will allow you to check LOS, Distance, or whatever you wish, when someone
+//		DoubleClicks another mob while in war mode.
+//
+// Const settings:
+// BYTE_DEFENDER = 1  Position in the packet for the Defender's Serial.
+//
+////////////////////////////////////////////////////////////////////////////////////////////////////
+use uo;
+use polsys;
+
+CONST BYTE_DEFENDER := 1;
+
+program requestAttack()
+	Print( "INSTALLING: Request Attack PH..." );
+	return 1;
+endprogram
+
+
+exported function HandleAttackRequest( who, byref packet )
+
+	var defender := SystemFindObjectBySerial(packet.GetInt32(BYTE_DEFENDER));
+
+	if( distance(who, defender) >= 20 )
+		return 1;
+	elseif( !CheckLineOfSight(who, defender) )
+		return 1;
+	endif
+
+	return 0;
+
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/packetHooks/RequestAttack/uopacket.cfg
===================================================================
--- trunk/096/pkg/packetHooks/RequestAttack/uopacket.cfg	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/RequestAttack/uopacket.cfg	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,5 @@
+Packet 0x05
+{
+  Length 0x5
+  ReceiveFunction requestAttack:HandleAttackRequest
+}

Added: trunk/096/pkg/packetHooks/WarAndPeace/config/icp.cfg
===================================================================
--- trunk/096/pkg/packetHooks/WarAndPeace/config/icp.cfg	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/WarAndPeace/config/icp.cfg	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,19 @@
+# $Id: icp.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+ICP Register
+{
+	Name		War And Peace Handler
+	Version		1.0
+	Description	PacketHook for handling Toggle of War Mode.
+
+	Creator		MuadDib
+	C_Email		muaddib at lostsoulsshard.org
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}

Added: trunk/096/pkg/packetHooks/WarAndPeace/pkg.cfg
===================================================================
--- trunk/096/pkg/packetHooks/WarAndPeace/pkg.cfg	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/WarAndPeace/pkg.cfg	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,9 @@
+# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+Enabled         1
+Name		handlewarmode
+Maintainer	Distro Team
+Email		distro at polserver.com
+CoreRequired	96
+Version		1.0
\ No newline at end of file

Added: trunk/096/pkg/packetHooks/WarAndPeace/readme.txt
===================================================================
--- trunk/096/pkg/packetHooks/WarAndPeace/readme.txt	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/WarAndPeace/readme.txt	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,40 @@
+===================================
+  War Request Packet Hook
+  Written By MuadDib
+===================================
+
+  1) Requirements
+  2) How to Install
+  3) Thanks To...
+
+===================================
+    Requirements
+===================================
+  To use these scripts, you will need the following:
+    A working and installed copy of POL v.096 or newer
+
+===================================
+    How To Install
+===================================
+  1) Extract the zip to somewhere in your pkg directory in POL
+  2) Making sure pkg.cfg has Enabled set to 1.
+  3) Compile the package with eCompile.
+  4) Start POL and begin using it.
+
+===================================
+    Notes
+===================================
+  1) If you want to block entering war mode in certain areas, or
+     if any circumstances exist, simply modify the ProcessWarMode(who)
+     function. If it returns 0, it will block entering war mode. If
+     it returns 1, it will allow it. 
+
+	For Example. In the ProcessWarMode(who) function, you can check
+        X and Y, to see if they are in a certain area (box), and if so,
+        return 0, and they will not be able to enter mode.
+
+===================================
+    Thanks To...
+===================================
+  Thanks to the POL dev team for continually developing the best 
+    Ultima Online server emulator around.

Added: trunk/096/pkg/packetHooks/WarAndPeace/requestWar.src
===================================================================
--- trunk/096/pkg/packetHooks/WarAndPeace/requestWar.src	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/WarAndPeace/requestWar.src	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,79 @@
+/* $Id: requestWar.src 688 2005-10-28 13:04:01Z panosl $
+ *
+ */
+////////////////////////////////////////////////////////////////////////////////////////////////////
+//
+//  name:    Request War Mode Packet Hook
+//  version: 1.0
+//  author:  MuadDib
+//
+//  Purpose: This can allow you to disable entering war mode based on criteria set forth in this
+//           hook. Like for example, if they are in town, cannot enter war mode, or in certain
+//           areas, if they are mounted, whatever you like.
+//
+// Const settings:
+// BYTE_FLAG = 1  Position in the packet for the Status Flag. Can be 0x0 (in peace mode) or
+//                0x1 (in war mode, trying to leave war mode).
+//
+////////////////////////////////////////////////////////////////////////////////////////////////////
+use uo;
+use polsys;
+
+include "include/client";
+
+CONST BYTE_FLAG := 1;
+
+program requestWar()
+	Print( "INSTALLING: Request War Mode Change PH..." );
+	return 1;
+endprogram
+
+
+exported function HandleWarRequest( who, byref packet )
+
+	// Let's see which mode the are requesting.
+	var flag := CInt(packet.GetInt8(BYTE_FLAG));
+	var allowWar := 1;
+
+	case(flag)
+		// Requesting Peace Mode. Should never block this in my opinion.
+		0: return 0;
+		// Let's call the function that will decide to block entering
+		// war mode or not.
+		1: allowWar := ProcessWarMode(who);
+		default: return 0;
+	endcase
+
+	// If allowWar is 1 or higher, allow the core to handle this
+	// packet. Else, create a denial packet, send it, and then block
+	// the request from the core.
+	if(allowWar)
+		return 0;
+	else
+		var denyPacket := CreatePacket(0x72, 5);
+		denyPacket.SetInt8(BYTE_FLAG, 0);
+		denyPacket.SetInt8(3, 0x32);
+		denyPacket.SendPacket(who);
+		return 1;
+	endif
+
+	return 0;
+
+endfunction
+
+
+// By returning 1 in this function, it means "Allow them to
+// enter war mode". If you return 0, it will BLOCK and deny them
+// entering war mode. The packet will NOT be sent to the core to
+// let the core decide if they can, and they will be sent a packet
+// to let the client know it was not allowed.
+function ProcessWarMode(who)
+
+	// Used to stop ecompile error messages for unused variables
+	who := who;
+	if( CInt(GetObjProperty(who, "#Peaced")) > ReadGameClock() )
+		return 0;
+	endif
+	return 1;
+
+endfunction

Added: trunk/096/pkg/packetHooks/WarAndPeace/uopacket.cfg
===================================================================
--- trunk/096/pkg/packetHooks/WarAndPeace/uopacket.cfg	2005-11-03 07:03:10 UTC (rev 876)
+++ trunk/096/pkg/packetHooks/WarAndPeace/uopacket.cfg	2005-11-03 07:33:13 UTC (rev 877)
@@ -0,0 +1,5 @@
+Packet 0x72
+{
+	Length 0x5
+	ReceiveFunction requestWar:HandleWarRequest
+}



From muaddiblsd at berlios.de  Thu Nov  3 09:09:28 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Thu, 3 Nov 2005 09:09:28 +0100
Subject: [Poldistro-svn] r878 - in trunk/096/pkg/packetHooks: . BFCommand BFCommand/config StatHook StatHook/config
Message-ID: <200511030809.jA389SQF012117@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-03 09:08:29 +0100 (Thu, 03 Nov 2005)
New Revision: 878

Added:
   trunk/096/pkg/packetHooks/BFCommand/
   trunk/096/pkg/packetHooks/BFCommand/config/
   trunk/096/pkg/packetHooks/BFCommand/config/icp.cfg
   trunk/096/pkg/packetHooks/BFCommand/pkg.cfg
   trunk/096/pkg/packetHooks/BFCommand/rScreenSize.src
   trunk/096/pkg/packetHooks/BFCommand/receiveStatLock.src
   trunk/096/pkg/packetHooks/BFCommand/setUCLang.src
   trunk/096/pkg/packetHooks/BFCommand/unknownOne.src
   trunk/096/pkg/packetHooks/BFCommand/uopacket.cfg
   trunk/096/pkg/packetHooks/StatHook/
   trunk/096/pkg/packetHooks/StatHook/config/
   trunk/096/pkg/packetHooks/StatHook/config/icp.cfg
   trunk/096/pkg/packetHooks/StatHook/pkg.cfg
   trunk/096/pkg/packetHooks/StatHook/sendStats.src
   trunk/096/pkg/packetHooks/StatHook/uopacket.cfg
Log:
Initial addition of packet hooks for 0xBF and 0x11.

0xBF is for saving screen size, UC language, and recieving stat lock state changes from client.
0x11 is for AOS status bar. Settings are defaulted to off, so it doesn't add the AOS stuff unless they modify the src and recompile.

Added: trunk/096/pkg/packetHooks/BFCommand/config/icp.cfg
===================================================================
--- trunk/096/pkg/packetHooks/BFCommand/config/icp.cfg	2005-11-03 07:33:13 UTC (rev 877)
+++ trunk/096/pkg/packetHooks/BFCommand/config/icp.cfg	2005-11-03 08:08:29 UTC (rev 878)
@@ -0,0 +1,19 @@
+# $Id$
+#
+#
+ICP Register
+{
+	Name		0xBF Packet Hook
+	Version		1.0
+	Description	PacketHook for handling 0xBF Subcommands.
+
+	Creator		MuadDib
+	C_Email		muaddib at lostsoulsshard.org
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}


Property changes on: trunk/096/pkg/packetHooks/BFCommand/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/packetHooks/BFCommand/pkg.cfg
===================================================================
--- trunk/096/pkg/packetHooks/BFCommand/pkg.cfg	2005-11-03 07:33:13 UTC (rev 877)
+++ trunk/096/pkg/packetHooks/BFCommand/pkg.cfg	2005-11-03 08:08:29 UTC (rev 878)
@@ -0,0 +1,6 @@
+Enabled		1
+Name		bfcommand
+Maintainer	Distro Team
+Email		distro at polserver.com
+CoreRequired	96
+Version		1.0


Property changes on: trunk/096/pkg/packetHooks/BFCommand/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/packetHooks/BFCommand/rScreenSize.src
===================================================================
--- trunk/096/pkg/packetHooks/BFCommand/rScreenSize.src	2005-11-03 07:33:13 UTC (rev 877)
+++ trunk/096/pkg/packetHooks/BFCommand/rScreenSize.src	2005-11-03 08:08:29 UTC (rev 878)
@@ -0,0 +1,37 @@
+/* $Id$
+ *
+ */
+////////////////////////////////////////////////////////////////////////////////////////////////////
+//
+//  name:    0xBF Hook: Screen Size of Client play window Subcommand 0x5
+//  version: 1.0
+//  author:  MuadDib
+//
+//  Purpose: Currently people may deem this Useless. You COULD use this in a system to auto
+//           center gumps etc, automatically via scripts dependant on the player's screen resolution
+//           at login.
+//
+////////////////////////////////////////////////////////////////////////////////////////////////////
+use uo;
+
+program rScreenSize()
+  Print( "Installing Screen Size Setup PH..." );
+  return 1;
+endprogram
+
+exported function HandleReceiveScreenSize( who, byref packet )
+	// Get the X resolution
+	var x := packet.GetInt16(7);
+	// Get the Y resolution
+	var y := packet.GetInt16(9);
+	// Store the CProp on the player. Since each of their characters could be a
+	// different resolution is why we store it per character, instead of per account.
+	// We use a "temp" cprop, since there is no need to store this perm. It is sent at
+	// login, so would always be refreshed anyway.
+	// We store it as an array to make it easy to access. Such as "var[1] and var[2]"
+	// after reading the cprop.
+	SetObjProperty(who, "#Resolution", (dictionary {"X" -> x, "Y" -> y}));
+
+	// No need for the core to see this packet.
+	return 1;
+endfunction


Property changes on: trunk/096/pkg/packetHooks/BFCommand/rScreenSize.src
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/packetHooks/BFCommand/receiveStatLock.src
===================================================================
--- trunk/096/pkg/packetHooks/BFCommand/receiveStatLock.src	2005-11-03 07:33:13 UTC (rev 877)
+++ trunk/096/pkg/packetHooks/BFCommand/receiveStatLock.src	2005-11-03 08:08:29 UTC (rev 878)
@@ -0,0 +1,81 @@
+/* $Id$
+ *
+ */
+////////////////////////////////////////////////////////////////////////////////////////////////////
+//
+//  name:    0xBF Hook: Stat Lock Recieve Subcommand 0x1A
+//  version: 1.0
+//  author:  MuadDib
+//
+//  Purpose: Handles the Stat Lock state change when the client clicks on the Stat Locks on the
+//           status bar in AOS and up clients.
+//
+// Const settings:
+// OFFSET_STAT = 5 		DO NOT CHANGE
+// OFFSET_MODE = 6 		DO NOT CHANGE
+// CLEAR_STR_MASK = 0xCF 	DO NOT CHANGE
+// CLEAR_DEX_MASK = 0xF3 	DO NOT CHANGE
+// CLEAR_INT_MASK = 0xFC 	DO NOT CHANGE
+//
+////////////////////////////////////////////////////////////////////////////////////////////////////
+use uo;
+use polsys;
+use math;
+
+program receiveStatLock()
+	Print( "Installing Statlock Recieving PH..." );
+	return 1;
+endprogram
+
+CONST OFFSET_STAT := 5;
+CONST OFFSET_MODE := 6;
+CONST CLEAR_STR_MASK := 0xCF;
+CONST CLEAR_DEX_MASK := 0xF3;
+CONST CLEAR_INT_MASK := 0xFC;
+
+exported function HandleReceiveStatLock( character, byref packet )
+	// Stat ID of the adjusted stat
+	var stat := packet.GetInt8(OFFSET_STAT);
+	// Lock state of the stat
+	var mode := packet.GetInt8(OFFSET_MODE);
+
+	// lockBits - Bits: XXSS DDII (s=strength, d=dex, i=int), 0 = up, 1 = down, 2 = locked
+	var statBit := GetObjProperty( character, "%StatLock%" );
+	if( statBit.errortext )
+		statBit := 0x00000000;
+	endif
+
+	// & CLEAR... will clear out the old states.
+	// | lsh() sets the new state cleanly. Not clearing before this will break the Bit
+	// when set to Locked state.
+	// Example: statbit AND CLEAR_STR_MASK OR leftshift(mode, 4 to the left)
+	// Remember, we are dealing with BITS, a Byte, hex or integer, consists of
+	// 8 Bits. A 1 is 00000001 in bit form. Using lsh we can move them to the left
+	// and obtain the format the lockBit shows. the |, or OR command, will match 2
+	// different bits up and "combine them". So example:
+	// 00100100 |
+	// 00100101    becomes 00100101, because it checks if there is a 1 in EITHER bit,
+	// and if there is, it makes a 1 in the new bit it creates. AND requires there
+	// to be a 1 in both of them at the position. Hence is why we must Clean the
+	// states when we change them. Going from Down to Lock will create a 11 entry
+	// instead of 10 for the lock state, because of the OR command. Cleaning these
+	// with AND (&) will make them 00 so the new state can be set cleanly.
+	case(stat)
+		0: statBit := statBit & CLEAR_STR_MASK | lsh(mode, 4);
+		1: statBit := statBit & CLEAR_DEX_MASK | lsh(mode, 2);
+		2: statBit := statBit & CLEAR_INT_MASK | mode;
+		default: return 1;
+	endcase
+
+	// Record the bit for stat locks onto the character.
+	SetObjProperty(character, "%StatLock%", statBit);
+
+	return 1;
+endfunction
+
+// This function is used to give POL the ability of << (left shift) in eScript since
+// it does not natively support it.
+function lsh(x, n)
+	return Cint(x * pow(2, n));
+endfunction
+


Property changes on: trunk/096/pkg/packetHooks/BFCommand/receiveStatLock.src
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/packetHooks/BFCommand/setUCLang.src
===================================================================
--- trunk/096/pkg/packetHooks/BFCommand/setUCLang.src	2005-11-03 07:33:13 UTC (rev 877)
+++ trunk/096/pkg/packetHooks/BFCommand/setUCLang.src	2005-11-03 08:08:29 UTC (rev 878)
@@ -0,0 +1,33 @@
+/* $Id$
+ *
+ */
+////////////////////////////////////////////////////////////////////////////////////////////////////
+//
+//  name:    0xBF Hook: UniCode Language of Client Subcommand 0x0B
+//  version: 1.0
+//  author:  MuadDib
+//
+//  Purpose: Can be used to set the client's language code for Unicode upon login. This can
+//           later be accessed via scripts when sending Unicode to send them the right Lang Code.
+//           If that is your intent, you may prefer setting the language cprop on the character
+//           itself for a much faster and cleaner accessing of it.
+//
+////////////////////////////////////////////////////////////////////////////////////////////////////
+use uo;
+
+program setUCLang()
+	Print( "Installing Language Selection PH..." );
+	return 1;
+endprogram
+
+exported function HandleSetUCLang( who, byref packet )
+	// Get the Language the client is sending from the packet.
+	var lang := packet.GetString(5,4);
+	// Find the player's account reference.
+	var acct := FindAccount(who.acctname);
+	// Add a Cprop to the account for using later.
+	acct.SetProp("%UCLang%", lang);
+
+	// No need for the core to see this packet.
+	return 1;
+endfunction


Property changes on: trunk/096/pkg/packetHooks/BFCommand/setUCLang.src
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/packetHooks/BFCommand/unknownOne.src
===================================================================
--- trunk/096/pkg/packetHooks/BFCommand/unknownOne.src	2005-11-03 07:33:13 UTC (rev 877)
+++ trunk/096/pkg/packetHooks/BFCommand/unknownOne.src	2005-11-03 08:08:29 UTC (rev 878)
@@ -0,0 +1,26 @@
+/* $Id$
+ *
+ */
+////////////////////////////////////////////////////////////////////////////////////////////////////
+//
+//  name:    0xBF Hook: Unknown 0xF Subcommand
+//  version: 1.0
+//  author:  MuadDib
+//
+//  Purpose: Client sends this at login. So far no reason or description has been given for this
+//           subcommand, so to please POL setups that report bad packets from the client, we hook
+//           this here and just ignore it with the return of 1.
+//
+////////////////////////////////////////////////////////////////////////////////////////////////////
+program unknownOne()
+	return 1;
+endprogram
+
+exported function HandleUnknownOne( character, byref packet )
+	// These 2 lines are used to fix unused var reports during compile.
+	character := character;
+	packet := packet;
+
+	// No need for core to see this packet, block it.
+	return 1;
+endfunction


Property changes on: trunk/096/pkg/packetHooks/BFCommand/unknownOne.src
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/packetHooks/BFCommand/uopacket.cfg
===================================================================
--- trunk/096/pkg/packetHooks/BFCommand/uopacket.cfg	2005-11-03 07:33:13 UTC (rev 877)
+++ trunk/096/pkg/packetHooks/BFCommand/uopacket.cfg	2005-11-03 08:08:29 UTC (rev 878)
@@ -0,0 +1,33 @@
+# $Id$
+#
+#
+Packet 0xBF
+{
+  Length variable
+  SubCommandOffset 4
+  SubCommandLength 1
+}
+
+SubPacket 0xBF
+{
+  SubCommandID 0x0B
+  ReceiveFunction setUCLang:HandleSetUCLang
+}
+
+SubPacket 0xBF
+{
+  SubCommandID 0x1A
+  ReceiveFunction receiveStatLock:HandleReceiveStatLock
+}
+
+SubPacket 0xBF
+{
+  SubCommandID 0x5
+  ReceiveFunction rScreenSize:HandleReceiveScreenSize
+}
+
+SubPacket 0xBF
+{
+  SubCommandID 0xF
+  ReceiveFunction unknownOne:HandleUnknownOne
+}
\ No newline at end of file


Property changes on: trunk/096/pkg/packetHooks/BFCommand/uopacket.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/packetHooks/StatHook/config/icp.cfg
===================================================================
--- trunk/096/pkg/packetHooks/StatHook/config/icp.cfg	2005-11-03 07:33:13 UTC (rev 877)
+++ trunk/096/pkg/packetHooks/StatHook/config/icp.cfg	2005-11-03 08:08:29 UTC (rev 878)
@@ -0,0 +1,19 @@
+# $Id$
+#
+#
+ICP Register
+{
+	Name		Status Packet Hook
+	Version		1.0
+	Description	PacketHook for handling 0x11 Status Packets.
+
+	Creator		MuadDib
+	C_Email		muaddib at lostsoulsshard.org
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}


Property changes on: trunk/096/pkg/packetHooks/StatHook/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/packetHooks/StatHook/pkg.cfg
===================================================================
--- trunk/096/pkg/packetHooks/StatHook/pkg.cfg	2005-11-03 07:33:13 UTC (rev 877)
+++ trunk/096/pkg/packetHooks/StatHook/pkg.cfg	2005-11-03 08:08:29 UTC (rev 878)
@@ -0,0 +1,6 @@
+Enabled		1
+Name		statushook
+Maintainer	Distro Team
+Email		distro at polserver.com
+CoreRequired	96
+Version		1.0


Property changes on: trunk/096/pkg/packetHooks/StatHook/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/packetHooks/StatHook/sendStats.src
===================================================================
--- trunk/096/pkg/packetHooks/StatHook/sendStats.src	2005-11-03 07:33:13 UTC (rev 877)
+++ trunk/096/pkg/packetHooks/StatHook/sendStats.src	2005-11-03 08:08:29 UTC (rev 878)
@@ -0,0 +1,285 @@
+////////////////////////////////////////////////////////////////////////////////////////////////////
+//
+//  name:    Send Stats Packet Hook
+//  version: 1.0a
+//  author:  MuadDib
+//
+//  Purpose:  This hooks the core 0x11 stats packet, and rewrites it for sending the char all the
+//            extended stats for Age of Shadows like Pet Count, Min/Max Damage, statcap, etc. 2
+//            Flags used per a CONST in order to decide which of the type to send.
+//
+//  Notes:    This is done only for example functionality. Pet Count, Damage Reports, etc is NOT
+//            implemented into anything nor is the resists and luck. You can also change the global
+//            var STATCAP to be a variable if required for special rising stat cap systems.
+//
+// Const settings:
+// MODE      = 0 Ignore this, and send the packet unmodified for old style stats.
+//             3 Send simple AoS stats. Standard plus statcap, pet count, and pets max.
+//             4 All above, plus the elemental resists, luck, damage max/min, and thithing points.
+// STATLOCK:   0/1 Flagging. 1=Enabled. Send stat lock states with packet.
+// BIT_MASK  = 0x00000003 DO NOT CHANGE!
+//
+// Global Variables:
+// STATCAP = Set this to your shard's Stat Cap. If based on age, race, etc, just add a function
+//           at the beginning of the exported function to check and set the statcap variable.
+//
+///////////////////////////////////////////////////////////////////////////////////////////////
+use polsys;
+
+include ":attributes:attributeConstants";
+include ":attributes:attributes";
+
+program sendStats()
+	Print( "Installing Outgoing Status PH..." );
+	return 1;
+endprogram
+
+CONST MODE     := 0;
+CONST STATLOCK := 1;
+CONST BIT_MASK := 0x00000003;
+
+var STATCAP := 225;
+
+exported function HandleSendStats( character, byref packet )
+	// Easiest method to decide which way to handle the packet. We could do this based on
+	// a Client version check too, but that would not be recommended since versions can be
+	// spoofed with software.
+	case(MODE)
+		0: return 0;
+		3: HandleStatPet(character, packet); if( STATLOCK ) SendStatLock(character); endif
+		4: HandleExtended(character, packet); if( STATLOCK ) SendStatLock(character); endif
+		default: return 0;
+	endcase
+
+	return 0;
+endfunction
+
+// If (MODE == 3)
+//   BYTE[2]  statcap
+//   BYTE pets current
+//   BYTE pets max
+// Total increase in size, 4.
+// Increase Packet Size, change the MODE in the packet string, and add the information.
+// Position 42 (0 Indexed) is for the MODE. If MODE in packet is already 01, sending the
+// Stat info etc, then do this, otherwise simply ignore.
+function HandleStatPet(character, byref packet)
+
+	// Increase by 4 for the new info to be added
+	packet.SetSize(((packet.GetSize())+4));
+	// We do this to make sure it is the correct packet form. Otherwise it is for someone else
+	// and there is no need to send the additional info.
+	var packet_mode := packet.GetInt8(42);
+	var chk := 0;
+	case(packet_mode)
+		0: return;    // Base packet, so not needed
+		1: chk := 1;  // Ok, let's continue processing this
+		3: return 0;    // In case we messed up, do nothing
+		4: return 0;    // In case we messed up, do nothing
+		default: return 0;   // OHHHH, mommy :o
+	endcase
+
+	if( chk )
+		// I do not recommend pet count stuff. Should just change code
+		// to always send 0 for them, useless unless you have some form
+		// of Pet control system on your shard.
+
+		// We use the #temp cprop type, because if you implement pet counts on
+		// worldly existing (not stabled) pets, then you should always double check
+		// at logon/reconnect, and logoff. Would be wise to also set it in the tamed ai
+		// script too when they go tamed, and when they disband. It may even be advisable
+		// to use a cprop that is a Struct. Using the serials of each pet, and just counting
+		// the struct. OHHHHHH the options.
+		var petcnt := GetObjProperty(character, "#PetCount");
+		if( !petcnt )
+			petcnt := 0;
+		endif
+		// Change this to your liking. This is what decides how many pets they can have
+		// at one time unstabled.
+		var petmax := AP_GetSkill(character, ANIMAL_TAMING)/15;
+		// May want higher, if you have horses and llamas counting as more than 1. That way they
+		// can always at least have a horse or llama.
+		if( !petmax )
+			petmax := 1;
+		endif
+		// Sets the packet to MODE 3
+		packet.SetInt8(42, 3);
+		// Done this way due to reverse padding expected by the client
+		// Due to some backward settings, this check is required to set the Statcap
+		// in the packet.
+		if( STATCAP <= 255 )
+		// Set the STATCAP in the packet
+			packet.SetInt8(67, STATCAP);
+		else
+			// Set the STATCAP in the packet
+			packet.SetInt16(66, STATCAP);
+		endif
+		// Sets their current pet count
+		packet.SetInt8(68, petcnt);
+		// Sets their current pet max count based on taming
+		packet.SetInt8(69, petmax);
+	endif
+
+	return 0;
+endfunction
+
+
+//  If (MODE==4 )
+//    BYTE[2]  statcap
+//    BYTE     pets current
+//    BYTE     pets max
+//    BYTE[2]  fireresist
+//    BYTE[2]  coldresist
+//    BYTE[2]  poisonresist
+//    BYTE[2]  energyresist
+//    BYTE[2]  luck
+//    BYTE[2]  damage max
+//    BYTE[2]  damage min
+//    BYTE[4]  titching points
+function HandleExtended(character, byref packet)
+	// Increase by 22 for the new info to be added
+	packet.SetSize(((packet.GetSize())+22));
+	// We do this to make sure it is the correct packet form. Otherwise it is for someone else
+	// and there is no need to send the additional info.
+	var packet_mode := packet.GetInt8(42);
+	var chk := 0;
+	case(packet_mode)
+		0: return 0;    // Base packet, so not needed
+		1: chk := 1;  // Ok, let's continue processing this
+		3: return 0;    // In case we messed up, do nothing
+		4: return 0;    // In case we messed up, do nothing
+		default: return 0;   // OHHHH, mommy :o
+	endcase
+
+	if(chk)
+		// I do not recommend pet count stuff. Should just change code
+		// to always send 0 for them, useless unless you have some form
+		// of Pet control system on your shard.
+
+		// We use the #temp cprop type, because if you implement pet counts on
+		// worldly existing (not stabled) pets, then you should always double check
+		// at logon/reconnect, and logoff. Would be wise to also set it in the tamed ai
+		// script too when they go tamed, and when they disband. It may even be advisable
+		// to use a cprop that is a Struct. Using the serials of each pet, and just counting
+		// the struct. OHHHHHH the options.
+		var petcnt := GetObjProperty(character, "#PetCount");
+		if( !petcnt )
+			petcnt := 0;
+		endif
+		// Change this to your liking. This is what decides how many pets they can have
+		// at one time unstabled.
+		var petmax := AP_GetSkill(character, ANIMAL_TAMING)/15;
+		// May want higher, if you have horses and llamas counting as more than 1. That way they
+		// can always at least have a horse or llama.
+		if( !petmax )
+			petmax := 1;
+		endif
+		// Sets it to MODE 4
+		packet.SetInt8(42, 4);
+		// Done this way due to reverse padding expected by the client
+		// Due to some backward settings, this check is required to set the Statcap
+		// in the packet.
+		if( STATCAP <= 255 )
+			// Set the STATCAP in the packet
+			packet.SetInt8(67, STATCAP);
+		else
+			// Set the STATCAP in the packet
+			packet.SetInt16(66, STATCAP);
+		endif
+		// Sets their current pet count in packet
+		packet.SetInt8(68, petcnt);
+		// Sets their current pet max count based on taming in packet
+		packet.SetInt8(69, petmax);
+
+		// These SHOULD be 1 lower for position, and using 16 not 8, but it does it wrong with core >:(
+		// Tithing should be a 32, position 84 also. SetInt16 will not pad the packet correctly is why.
+		// Instead of SetInt16(70, 5) making it 0005, it makes it 0500 if I remember right. BOOOOO
+
+		// Be sure to make your own functions for these. But since they are NOT used with Distro, will
+		// just have the core set them to 0 for it all.
+		// NOTE**** Just like the statcap, if it is over 255, have the if check statcap uses!!
+		packet.SetInt8(71, 0);  // Set the fireresist in the packet
+		packet.SetInt8(73, 0);  // Set the coldresist in the packet
+		packet.SetInt8(75, 0);  // Set the poisonresist in the packet
+		packet.SetInt8(77, 0);  // Set the energyresist in the packet
+		packet.SetInt8(79, 0);  // Set the luck in the packet
+		packet.SetInt8(87, 0);  // Set the tithing points in the packet
+
+		// Now let's set up the Max and Min damage entries of the packet.
+
+		// Get the weapons they are holding if any.
+		var weaponone := GetEquipmentByLayer (character, 0x01);
+		var weapontwo := GetEquipmentByLayer (character, 0x02);
+		// Set the max and min to that of the wrestling (change if you changed your
+		// wrestle intrinsic in the combat package)
+		var maxdmg := 8, mindmg := 1;
+		// Let's make sure the items in hand are weapons and process them correctly.
+		if( weaponone.isA(POLCLASS_WEAPON) )
+			var cfg := ReadConfigFile(":*:itemdesc");
+			// Read the settings from the config file, and add the mods.
+			mindmg := CInt(cfg[weaponone.objtype].MinDam) + weaponone.dmg_mod;
+			maxdmg := CInt(cfg[weaponone.objtype].MaxDam) + weaponone.dmg_mod;
+		elseif( weapontwo.isA(POLCLASS_WEAPON) )
+			var cfg := ReadConfigFile(":*:itemdesc");
+			// Read the settings from the config file, and add the mods.
+			mindmg := CInt(cfg[weapontwo.objtype].MinDam) + weaponone.dmg_mod;
+			maxdmg := CInt(cfg[weapontwo.objtype].MaxDam) + weaponone.dmg_mod;
+		endif
+		// Set the min damage in the packet
+		packet.SetInt8(81, mindmg);
+		// Set the max damage in the packet
+		packet.SetInt8(83, maxdmg);
+	endif
+
+	return 0;
+endfunction
+
+
+//  Packet 0xBF
+//  General Info (5 bytes, plus specific message)
+//    BYTE[1]     cmd
+//    BYTE[2]     len
+//    BYTE[2]     subcmd
+//    BYTE[len-5] submessage
+//
+//  Subcommand: 0x19: Extended stats
+//    BYTE[1] type - always 2 ? never seen other value
+//    BYTE[4] serial
+//    BYTE[1] unknown - always 0. why?
+//    BYTE[1] lockBits - Bits: XXSS DDII (s=strength, d=dex, i=int), 0 = up, 1 = down, 2 = locked
+// Bits explanation and help from Folko, since I knew zero about working with the bit
+// format the packet requires. lsh function by folko since EScript lacks the >> and << abilities.
+// For this to work correctly, You will also need a hook for the 0xBF packet and the 0x19 Sub to
+// accept the state changes of the locks.
+function SendStatLock(character)
+	if( CInt(character.clientversion[1]) < 3 )
+		return 0;
+	endif
+	// Let's create the new packet to send them. This is to send the command that will make the
+	// locks show up on the status bar. Even though the packet is variable length, the command we
+	// are sending is always 12, so let's just make it that length to shorten the code.
+	var newpacket := CreatePacket(0xBF, 12);
+	// Sets the length of the packet.
+	newpacket.SetInt8(2, 0x0C);
+	// Subcmd for the packet
+	newpacket.SetInt8(4, 0x19);
+	// 02 - Is always this, never changes
+	newpacket.setInt8(5, 2);
+	// The person's Serial gets added also.
+	newpacket.setInt32(6, (character.serial));
+	// Now let's read off the stat lock cprop and set those in the packet
+	var statBit := GetObjProperty( character, "%StatLock%" );
+	// If it doesn't exist, it makes the bit 0, means nothing locked or down.
+	// Then records it on the player.
+	if( (statbit.errortext) )
+		statBit := 0;
+		SetObjProperty(character, "%StatLock%", statBit);
+	endif
+
+	// Inserts the stat lock states into the packet, which are stored on the character
+	// already converted to Bit form, see the NewCommand pkg for info.
+	newpacket.setInt16(10, statBit);
+	// Sends the new packet to the character.
+	newpacket.SendPacket(character);
+
+	return 1;
+endfunction


Property changes on: trunk/096/pkg/packetHooks/StatHook/sendStats.src
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/packetHooks/StatHook/uopacket.cfg
===================================================================
--- trunk/096/pkg/packetHooks/StatHook/uopacket.cfg	2005-11-03 07:33:13 UTC (rev 877)
+++ trunk/096/pkg/packetHooks/StatHook/uopacket.cfg	2005-11-03 08:08:29 UTC (rev 878)
@@ -0,0 +1,5 @@
+Packet 0x11
+{
+  Length variable
+  SendFunction sendStats:HandleSendStats
+}


Property changes on: trunk/096/pkg/packetHooks/StatHook/uopacket.cfg
___________________________________________________________________
Name: svn:keywords
   + Id



From muaddiblsd at berlios.de  Thu Nov  3 09:23:49 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Thu, 3 Nov 2005 09:23:49 +0100
Subject: [Poldistro-svn] r879 - in trunk/096/pkg/packetHooks: BFCommand StatHook
Message-ID: <200511030823.jA38NnIR024908@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-03 09:23:47 +0100 (Thu, 03 Nov 2005)
New Revision: 879

Modified:
   trunk/096/pkg/packetHooks/BFCommand/rScreenSize.src
   trunk/096/pkg/packetHooks/BFCommand/receiveStatLock.src
   trunk/096/pkg/packetHooks/BFCommand/setUCLang.src
   trunk/096/pkg/packetHooks/StatHook/sendStats.src
Log:
Changed "Installing" in new packetHook program lines to "INSTALLING" to match the others already installed.

Modified: trunk/096/pkg/packetHooks/BFCommand/rScreenSize.src
===================================================================
--- trunk/096/pkg/packetHooks/BFCommand/rScreenSize.src	2005-11-03 08:08:29 UTC (rev 878)
+++ trunk/096/pkg/packetHooks/BFCommand/rScreenSize.src	2005-11-03 08:23:47 UTC (rev 879)
@@ -15,7 +15,7 @@
 use uo;
 
 program rScreenSize()
-  Print( "Installing Screen Size Setup PH..." );
+  Print( "INSTALLING Screen Size Setup PH..." );
   return 1;
 endprogram
 

Modified: trunk/096/pkg/packetHooks/BFCommand/receiveStatLock.src
===================================================================
--- trunk/096/pkg/packetHooks/BFCommand/receiveStatLock.src	2005-11-03 08:08:29 UTC (rev 878)
+++ trunk/096/pkg/packetHooks/BFCommand/receiveStatLock.src	2005-11-03 08:23:47 UTC (rev 879)
@@ -23,7 +23,7 @@
 use math;
 
 program receiveStatLock()
-	Print( "Installing Statlock Recieving PH..." );
+	Print( "INSTALLING Statlock Recieving PH..." );
 	return 1;
 endprogram
 

Modified: trunk/096/pkg/packetHooks/BFCommand/setUCLang.src
===================================================================
--- trunk/096/pkg/packetHooks/BFCommand/setUCLang.src	2005-11-03 08:08:29 UTC (rev 878)
+++ trunk/096/pkg/packetHooks/BFCommand/setUCLang.src	2005-11-03 08:23:47 UTC (rev 879)
@@ -16,7 +16,7 @@
 use uo;
 
 program setUCLang()
-	Print( "Installing Language Selection PH..." );
+	Print( "INSTALLING Language Selection PH..." );
 	return 1;
 endprogram
 

Modified: trunk/096/pkg/packetHooks/StatHook/sendStats.src
===================================================================
--- trunk/096/pkg/packetHooks/StatHook/sendStats.src	2005-11-03 08:08:29 UTC (rev 878)
+++ trunk/096/pkg/packetHooks/StatHook/sendStats.src	2005-11-03 08:23:47 UTC (rev 879)
@@ -30,7 +30,7 @@
 include ":attributes:attributes";
 
 program sendStats()
-	Print( "Installing Outgoing Status PH..." );
+	Print( "INSTALLING Outgoing Status PH..." );
 	return 1;
 endprogram
 



From austin at berlios.de  Thu Nov  3 06:44:50 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 06:44:50 +0100
Subject: [Poldistro-svn] r868 - in trunk/096/pkg/skills/magery: . OLD OLD/config
Message-ID: <200511030544.jA35ioek024381@sheep.berlios.de>

Author: austin
Date: 2005-11-03 06:44:14 +0100 (Thu, 03 Nov 2005)
New Revision: 868

Added:
   trunk/096/pkg/skills/magery/OLD/
   trunk/096/pkg/skills/magery/OLD/agility.src
   trunk/096/pkg/skills/magery/OLD/archCure.src
   trunk/096/pkg/skills/magery/OLD/archProt.src
   trunk/096/pkg/skills/magery/OLD/bladeSpirit.src
   trunk/096/pkg/skills/magery/OLD/bless.src
   trunk/096/pkg/skills/magery/OLD/chainLightning.src
   trunk/096/pkg/skills/magery/OLD/clumsy.src
   trunk/096/pkg/skills/magery/OLD/config/
   trunk/096/pkg/skills/magery/OLD/config/icp.cfg
   trunk/096/pkg/skills/magery/OLD/createFood.src
   trunk/096/pkg/skills/magery/OLD/cunning.src
   trunk/096/pkg/skills/magery/OLD/cure.src
   trunk/096/pkg/skills/magery/OLD/curse.src
   trunk/096/pkg/skills/magery/OLD/dispel.src
   trunk/096/pkg/skills/magery/OLD/dispelField.src
   trunk/096/pkg/skills/magery/OLD/eBolt.src
   trunk/096/pkg/skills/magery/OLD/earthquake.src
   trunk/096/pkg/skills/magery/OLD/energyField.src
   trunk/096/pkg/skills/magery/OLD/explosion.src
   trunk/096/pkg/skills/magery/OLD/feeblemind.src
   trunk/096/pkg/skills/magery/OLD/fireField.src
   trunk/096/pkg/skills/magery/OLD/fireball.src
   trunk/096/pkg/skills/magery/OLD/flameStrike.src.temp
   trunk/096/pkg/skills/magery/OLD/gHeal.src
   trunk/096/pkg/skills/magery/OLD/gate.src
   trunk/096/pkg/skills/magery/OLD/harm.src
   trunk/096/pkg/skills/magery/OLD/heal.src
   trunk/096/pkg/skills/magery/OLD/incognito.cfg
   trunk/096/pkg/skills/magery/OLD/incognito.src
   trunk/096/pkg/skills/magery/OLD/invisibility.src
   trunk/096/pkg/skills/magery/OLD/lightning.src
   trunk/096/pkg/skills/magery/OLD/magicArrow.src
   trunk/096/pkg/skills/magery/OLD/magicLock.src
   trunk/096/pkg/skills/magery/OLD/magicTrap.src
   trunk/096/pkg/skills/magery/OLD/magicUntrap.src
   trunk/096/pkg/skills/magery/OLD/magiccircles.cfg
   trunk/096/pkg/skills/magery/OLD/manaDrain.src
   trunk/096/pkg/skills/magery/OLD/manaVamp.src
   trunk/096/pkg/skills/magery/OLD/mark.src
   trunk/096/pkg/skills/magery/OLD/massCurse.src
   trunk/096/pkg/skills/magery/OLD/massDispel.src
   trunk/096/pkg/skills/magery/OLD/meteorSwarm.src
   trunk/096/pkg/skills/magery/OLD/mindBlast.src
   trunk/096/pkg/skills/magery/OLD/nightSight.src
   trunk/096/pkg/skills/magery/OLD/pField.src
   trunk/096/pkg/skills/magery/OLD/paraField.src
   trunk/096/pkg/skills/magery/OLD/paralyze.src
   trunk/096/pkg/skills/magery/OLD/pkg.cfg
   trunk/096/pkg/skills/magery/OLD/poison.src
   trunk/096/pkg/skills/magery/OLD/poisonField.src
   trunk/096/pkg/skills/magery/OLD/polymorph.src
   trunk/096/pkg/skills/magery/OLD/protection.src
   trunk/096/pkg/skills/magery/OLD/reactiveArmor.src
   trunk/096/pkg/skills/magery/OLD/recall.src
   trunk/096/pkg/skills/magery/OLD/reflect.inc
   trunk/096/pkg/skills/magery/OLD/reflect.src
   trunk/096/pkg/skills/magery/OLD/resurrect.src
   trunk/096/pkg/skills/magery/OLD/reveal.src
   trunk/096/pkg/skills/magery/OLD/spells.cfg
   trunk/096/pkg/skills/magery/OLD/strength.src
   trunk/096/pkg/skills/magery/OLD/summon.inc
   trunk/096/pkg/skills/magery/OLD/summonAir.src
   trunk/096/pkg/skills/magery/OLD/summonCreature.src
   trunk/096/pkg/skills/magery/OLD/summonDaemon.src
   trunk/096/pkg/skills/magery/OLD/summonEarth.src
   trunk/096/pkg/skills/magery/OLD/summonFire.src
   trunk/096/pkg/skills/magery/OLD/summonWater.src
   trunk/096/pkg/skills/magery/OLD/telekinesis.src
   trunk/096/pkg/skills/magery/OLD/teleport.src
   trunk/096/pkg/skills/magery/OLD/unlock.src
   trunk/096/pkg/skills/magery/OLD/vortex.src
   trunk/096/pkg/skills/magery/OLD/wallOfStone.src
   trunk/096/pkg/skills/magery/OLD/weaken.src
Removed:
   trunk/096/pkg/skills/magery/agility.src
   trunk/096/pkg/skills/magery/archCure.src
   trunk/096/pkg/skills/magery/archProt.src
   trunk/096/pkg/skills/magery/bladeSpirit.src
   trunk/096/pkg/skills/magery/bless.src
   trunk/096/pkg/skills/magery/chainLightning.src
   trunk/096/pkg/skills/magery/clumsy.src
   trunk/096/pkg/skills/magery/config/
   trunk/096/pkg/skills/magery/createFood.src
   trunk/096/pkg/skills/magery/cunning.src
   trunk/096/pkg/skills/magery/cure.src
   trunk/096/pkg/skills/magery/curse.src
   trunk/096/pkg/skills/magery/dispel.src
   trunk/096/pkg/skills/magery/dispelField.src
   trunk/096/pkg/skills/magery/eBolt.src
   trunk/096/pkg/skills/magery/earthquake.src
   trunk/096/pkg/skills/magery/energyField.src
   trunk/096/pkg/skills/magery/explosion.src
   trunk/096/pkg/skills/magery/feeblemind.src
   trunk/096/pkg/skills/magery/fireField.src
   trunk/096/pkg/skills/magery/fireball.src
   trunk/096/pkg/skills/magery/flameStrike.src.temp
   trunk/096/pkg/skills/magery/gHeal.src
   trunk/096/pkg/skills/magery/gate.src
   trunk/096/pkg/skills/magery/harm.src
   trunk/096/pkg/skills/magery/heal.src
   trunk/096/pkg/skills/magery/incognito.cfg
   trunk/096/pkg/skills/magery/incognito.src
   trunk/096/pkg/skills/magery/invisibility.src
   trunk/096/pkg/skills/magery/lightning.src
   trunk/096/pkg/skills/magery/magicArrow.src
   trunk/096/pkg/skills/magery/magicLock.src
   trunk/096/pkg/skills/magery/magicTrap.src
   trunk/096/pkg/skills/magery/magicUntrap.src
   trunk/096/pkg/skills/magery/magiccircles.cfg
   trunk/096/pkg/skills/magery/manaDrain.src
   trunk/096/pkg/skills/magery/manaVamp.src
   trunk/096/pkg/skills/magery/mark.src
   trunk/096/pkg/skills/magery/massCurse.src
   trunk/096/pkg/skills/magery/massDispel.src
   trunk/096/pkg/skills/magery/meteorSwarm.src
   trunk/096/pkg/skills/magery/mindBlast.src
   trunk/096/pkg/skills/magery/nightSight.src
   trunk/096/pkg/skills/magery/pField.src
   trunk/096/pkg/skills/magery/paraField.src
   trunk/096/pkg/skills/magery/paralyze.src
   trunk/096/pkg/skills/magery/pkg.cfg
   trunk/096/pkg/skills/magery/poison.src
   trunk/096/pkg/skills/magery/poisonField.src
   trunk/096/pkg/skills/magery/polymorph.src
   trunk/096/pkg/skills/magery/protection.src
   trunk/096/pkg/skills/magery/reactiveArmor.src
   trunk/096/pkg/skills/magery/recall.src
   trunk/096/pkg/skills/magery/reflect.inc
   trunk/096/pkg/skills/magery/reflect.src
   trunk/096/pkg/skills/magery/resurrect.src
   trunk/096/pkg/skills/magery/reveal.src
   trunk/096/pkg/skills/magery/spells.cfg
   trunk/096/pkg/skills/magery/strength.src
   trunk/096/pkg/skills/magery/summon.inc
   trunk/096/pkg/skills/magery/summonAir.src
   trunk/096/pkg/skills/magery/summonCreature.src
   trunk/096/pkg/skills/magery/summonDaemon.src
   trunk/096/pkg/skills/magery/summonEarth.src
   trunk/096/pkg/skills/magery/summonFire.src
   trunk/096/pkg/skills/magery/summonWater.src
   trunk/096/pkg/skills/magery/telekinesis.src
   trunk/096/pkg/skills/magery/teleport.src
   trunk/096/pkg/skills/magery/unlock.src
   trunk/096/pkg/skills/magery/vortex.src
   trunk/096/pkg/skills/magery/wallOfStone.src
   trunk/096/pkg/skills/magery/weaken.src
Log:
Moved everything to an OLD folder so Muad and I can start on the new magery system using my spell starter concept.

Added: trunk/096/pkg/skills/magery/OLD/agility.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/agility.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/agility.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,21 @@
+use uo;
+use os;
+use util;
+
+include "include/statMod";
+include ":attributes:attributes";
+
+program agility( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  PlaySoundEffect(caster, 0x1e8);
+  PlayObjectCenteredEffect(caster, 0x373a, 7,7);
+  if(!CanMod(castOn, "dex"))
+    SendSysMessage(caster,"Another existing effect negates your spell!");
+    return;
+  endif
+  var magery := AP_GetSkill(caster, MAGERY);
+  var modAmount := GetModAmount( magery );
+  var duration := GetModDuration( magery );
+  DoTempMod(castOn, "dex", modAmount, duration);
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/archCure.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/archCure.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/archCure.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,48 @@
+use uo;
+use cfgfile;
+
+include "include/eventID";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+include ":timedscripts:timedScripts";
+include ":timedscripts:poisonUtil";
+
+program archCure(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var npccfg := ReadConfigFile("::npcdesc");
+  PlaySoundEffect(caster, SFX_SPELL_ARCH_CURE);
+  var magery := AP_GetSkill(caster, MAGERY);
+  var potency := CInt(AP_GetSkill( caster, MAGERY ) /33)+1;
+  foreach castOn in ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, CInt(magery/15), caster.realm );
+    if((CheckLineOfSight(castOn, caster)) and (castOn.cmdlevel < 2))
+	  PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 10,10);
+      if(castOn.isA(POLCLASS_NPC))
+        var element := npccfg[castOn.npctemplate].elemental;
+        if(element == "poison")
+          var ev := array;
+          ev.+ type;
+          ev.+ source;
+          ev.type := EVID_PEACEMADE;
+          SendEvent(castOn, ev);
+          ev.source := caster;
+          SendEvent(castOn, ev);
+          ev.type := EVID_ENGAGED;
+          SendEvent(castOn, ev);
+          ApplyRawDamage(castOn, potency);
+        endif
+      endif
+      if (TS_GetTimerNames(castOn, "P").size() > 0)
+        TS_CurePoison(castOn, 180, "P", potency);
+        if (TS_GetTimerNames(castOn, "P").size() > 0)
+          SendSysMessage(caster, "You cure some poison.");  
+          SendSysMessage(castOn, caster.name + " has partially cured you!");
+        else
+          SendSysMessage(caster, castOn.name + " cured.");
+          SendSysMessage(castOn, caster.name + " has cured you completely!");
+        endif
+      endif
+    endif
+  endforeach
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/archProt.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/archProt.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/archProt.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,27 @@
+use uo;
+use os;
+
+include "include/sound";
+include "include/tileEffects";
+include "include/statMod";
+include ":attributes:attributes";
+
+
+program archProtection(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+	PlaySoundEffect(caster, SFX_SPELL_PROTECTION);
+	var magery := AP_GetSkill(caster, MAGERY);
+	var modAmount := CInt(RandomInt(6) + 5);
+	var duration := GetModDuration( magery );
+	foreach castOn in ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, CInt(magery/15), caster.realm );
+		if ((CheckLineOfSight(castOn, caster)) and (castOn.cmdlevel < 2))
+			if (CanMod(castOn, "ar"))
+				PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 7,7);
+				DoTempMod(castOn, "ar", modAmount, duration);
+			endif
+		endif
+	endforeach
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/bladeSpirit.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/bladeSpirit.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/bladeSpirit.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,23 @@
+use uo;
+use os;
+use util;
+
+include ":attributes:attributes";
+include "include/tileEffects";
+include "include/sound";
+
+
+program bladeSpirit(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var thecritter := CreateNpcFromTemplate("bladespirit", castOn.x, castOn.y, castOn.z, 0, caster.realm);
+  PlaySoundEffect(thecritter, SFX_SPELL_BLADE_SPIRITS);
+  SetObjProperty(thecritter, "summoned", 1);
+  SetObjProperty(thecritter, "master", caster.serial);
+  Detach();
+  sleep( (AP_GetSkill( caster, MAGERY ) ) );
+  PlaySoundEffect( thecritter, SFX_SPELL_MANA_VAMPIRE );
+  PlayStationaryEffect( thecritter.x, thecritter.y, thecritter.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
+  MoveCharacterToLocation(thecritter,0,0,0,MOVECHAR_FORCELOCATION);
+  ApplyRawDamage(thecritter, AP_GetVital(thecritter, "Hits") + 3);
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/bless.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/bless.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/bless.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,28 @@
+use uo;
+use os;
+use util;
+
+include "include/statMod";
+include ":attributes:attributes";
+include "include/sound";
+include "include/tileEffects";
+
+
+program bless(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  PlaySoundEffect(castOn, SFX_SPELL_BLESS);
+  PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 10,10);
+  var magery := AP_GetSkill(caster, MAGERY);
+  var modAmount := GetModAmount(magery);
+  var duration := GetModDuration(magery);
+  if(CanMod(castOn, "str"))
+	DoTempMod(castOn, "str", modAmount, duration);
+  endif
+  if(CanMod(castOn, "dex"))
+	DoTempMod(castOn, "dex", modAmount, duration);
+  endif
+  if(CanMod(castOn, "int"))
+	DoTempMod(castOn, "int", modAmount, duration);
+  endif
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/chainLightning.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/chainLightning.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/chainLightning.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,40 @@
+use uo;
+use os;
+use util;
+use cfgfile;
+
+include ":magery:reflect";
+include "include/spellAttack";
+include "include/sound";
+include "include/tileEffects";
+include "include/magic";
+
+program chainLightning( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+
+  var dmg;
+  var range := 2;
+  var victims := ListMobilesNearLocationEx( castOn.x, castOn.y, castOn.z, range, 0x03, caster.realm);
+  Detach();
+  foreach mobile in victims
+    if((CheckLineOfSight(mobile, caster)) and (mobile.cmdlevel < 2))
+      SetObjProperty(mobile, "LastHit", {caster.name, caster.serial, "chain lightning"});
+      if(spell_reflect(mobile))
+        mobile := caster;
+      endif
+      dmg := RandomDiceRoll("6d8");
+      send_attack(mobile,caster, 49);
+      PlayLightningBoltEffect( mobile );
+      PlaySoundEffect(mobile, SFX_SPELL_LIGHTNING);
+      if(mobile.isA(POLCLASS_NPC))
+        dmg := dmg * 2;
+      endif
+      ApplyRawDamage( mobile, Resisted(circle,caster,mobile,dmg) );
+      sleepms(600);
+    endif
+  endforeach
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/clumsy.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/clumsy.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/clumsy.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,34 @@
+use uo;
+use os;
+use util;
+use cfgfile;
+
+include "include/statMod";
+include ":attributes:attributes";
+include "include/sound";
+include "include/tileEffects";
+include "reflect";
+include "include/magic";
+
+program clumsy( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+
+  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "clumsy" });
+  if(spell_reflect(castOn))
+	castOn := caster;
+  endif
+  PlaySoundEffect(castOn, SFX_SPELL_CURE);
+  PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 7,7);
+  if(!CanMod(castOn, "dex"))
+	SendSysMessage(caster,"Already under the influence!");
+	return;
+  endif
+  var magery := AP_GetSkill(caster, MAGERY);
+  var modAmount := Resisted(circle,caster,castOn,(GetModAmount( magery )));
+  var duration := GetModDuration( magery );
+  DoTempMod(castOn, "dex", 0 - modAmount, duration);
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/config/icp.cfg
===================================================================
--- trunk/096/pkg/skills/magery/OLD/config/icp.cfg	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/config/icp.cfg	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,12 @@
+ICP Register
+{
+        Name            Magery
+        Version         1.0
+        Description     Magery Skill
+
+        Creator         Distro Team
+        C_Email         distro at polserver.com
+
+        Maintainer      Distro Team
+        M_Email         distro at polserver.com
+}

Added: trunk/096/pkg/skills/magery/OLD/createFood.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/createFood.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/createFood.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,25 @@
+use uo;
+use os;
+use util;
+
+include "include/client";
+
+
+program spell_createFood(parms)
+	var caster := parms.caster;
+	var food;
+	case (RandomInt(8))
+		0:	food := 0x09c9;
+		1:	food := 0x09ea;
+		2:	food := 0x1040;
+		3:	food := 0x09b7;
+		4: 	food := 0x1608;
+		5: 	food := 0x09e9;
+		6: 	food := 0x1044;
+		7: 	food := 0x0c77;
+	endcase
+	PlaySoundEffect(caster, 0x01e3);
+	CreateItemInBackpack(caster, food, 1);
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/cunning.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/cunning.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/cunning.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,28 @@
+use uo;
+use os;
+use util;
+
+include "include/statMod";
+include "include/client";
+include ":attributes:attributes";
+include "include/sound";
+include "include/tileEffects";
+
+
+program spell_cunning(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+
+	PlaySoundEffect(castOn, SFX_SPELL_CUNNING);
+	PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 7,7);
+	if (!CanMod(castOn, "int"))
+		SendSysMessage(caster,"Already under the influence!");
+		return;
+	endif
+	var magery := AP_GetSkill(caster, MAGERY);
+	var modAmount := GetModAmount( magery );
+	var duration := GetModDuration( magery );
+	DoTempMod(castOn, "int", modAmount, duration);
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/cure.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/cure.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/cure.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,44 @@
+use uo;
+use cfgfile;
+
+include "include/eventID";
+include ":attributes:attributes";
+include "include/sound";
+include "include/tileEffects";
+include ":timedscripts:timedScripts";
+include ":timedscripts:poisonUtil";
+
+
+program cure( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var npccfg := ReadConfigFile("::npcdesc");
+  PlaySoundEffect(caster, SFX_SPELL_CURE);
+  PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 10,10);
+  var potency := CInt(AP_GetSkill(caster, MAGERY) / 33) +1;
+  if(castOn.isA(POLCLASS_NPC))
+    var element := npccfg[castOn.npctemplate].elemental;
+    if(element == "poison")
+      var ev := array;
+      ev.+ type;
+      ev.+ source;
+      ev.type := EVID_PEACEMADE;
+      SendEvent(castOn, ev);
+      ev.source := caster;
+      SendEvent(castOn, ev);
+      ev.type := EVID_ENGAGED;
+      SendEvent(castOn, ev);
+      ApplyRawDamage(castOn, potency);
+    endif
+  endif
+  if (TS_GetTimerNames(castOn, "P").size() > 0)
+    TS_CurePoison(castOn, 120, "P", potency);
+    if (TS_GetTimerNames(castOn, "P").size() > 0)
+      SendSysMessage(caster, "You cure some poison.");  
+      SendSysMessage(castOn, caster.name + " has partially cured you!");
+    else
+      SendSysMessage(caster, castOn.name + " cured.");
+      SendSysMessage(castOn, caster.name + " has cured you completely!");
+    endif
+  endif
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/curse.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/curse.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/curse.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,37 @@
+use os;
+use uo;
+use util;
+
+include "include/statMod";
+include ":attributes:attributes";
+include "include/sound";
+include "include/tileEffects";
+include "include/magic";
+include "reflect";
+
+program curse( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+
+  PlaySoundEffect(castOn, SFX_SPELL_CURSE);
+  PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 10,10);
+  var magery := AP_GetSkill(caster, MAGERY);
+  var modAmount := Resisted(circle,caster,castOn,GetModAmount( magery ));
+  var duration := GetModDuration( magery );
+	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "curse" });
+  if(spell_reflect(castOn))
+	castOn := caster;
+  endif
+  if (CanMod(castOn, "str"))
+	DoTempMod(castOn, "str", 0- modAmount, duration);
+  endif
+  if (CanMod(castOn, "dex"))
+	DoTempMod(castOn, "dex", 0- modAmount, duration);
+  endif
+  if (CanMod(castOn, "int"))
+	DoTempMod(castOn, "int", 0- modAmount, duration);
+  endif
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/dispel.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/dispel.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/dispel.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,53 @@
+use uo;
+use cfgfile;
+
+include "include/eventID";
+include ":attributes:attributes";
+include "include/sound";
+include "include/tileEffects";
+include "include/spellAttack";
+include "include/magic";
+
+program dispel( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+  var npccfg := ReadConfigFile("::npcdesc");
+
+  var summoned := GetObjProperty( castOn, "summoned");
+  if(summoned == 1)
+    PlaySoundEffect( caster, 0x202 );
+    PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_HEAL_EFFECT, 0xa, 0xa,0 , caster.realm );
+    var master := SystemFindObjectBySerial(CInt(GetObjProperty(castOn, "master")));
+    if(master)
+      var resist := AP_GetSkill(master, RESISTING_SPELLS);
+      if((RandomInt(99) + 1) < resist)
+        MoveCharacterToLocation(castOn,0,0,0,MOVECHAR_FORCELOCATION);
+        ApplyRawDamage(castOn, AP_GetVitalMaximumValue(caston, HITS) + 3);
+      endif
+      send_attack(caster, castOn, 41);
+    endif
+  else
+    if(castOn.isA(POLCLASS_NPC))
+      var element := npccfg[castOn.npctemplate].elemental;
+      if(element == "undead")
+        PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_HEAL_EFFECT, 0xa, 0xa, 0, caster.realm );
+        var ev := array;
+        ev.+ type;
+        ev.+ source;
+        ev.type := EVID_PEACEMADE;
+        SendEvent(castOn, ev);
+        ev.source := caster;
+        SendEvent(castOn, ev);
+        ev.type := EVID_ENGAGED;
+        SendEvent(castOn, ev);
+        PlaySoundEffect(caster, 0x202);
+        PlayObjectCenteredEffect(castOn, 0x37b9, 0x03, 0x0a);
+        var dmg := CalcSpellDamage(circle, caster) + (RandomInt(20));
+        ApplyRawDamage(castOn, Resisted(circle, caster, castOn, dmg));
+      endif
+    endif
+  endif
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/dispelField.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/dispelField.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/dispelField.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,22 @@
+use uo;
+use os;
+
+include ":attributes:attributes";
+include "include/sound";
+include "include/tileEffects";
+
+
+program dispelField( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var magery := AP_GetSkill(caster, MAGERY);
+  var therange := CInt(magery / 15 );
+  var items := ListItemsNearLocation(castOn.x, castOn.y, castOn.z, therange, caster.realm);
+  PlaySoundEffect( caster, SFX_SPELL_DISPEL );
+  foreach item in items
+	if (GetObjProperty(item, "f") == "1")
+	  PlayStationaryEffect( item.x, item.y, item.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
+      DestroyItem(item);
+	endif
+  endforeach
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/eBolt.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/eBolt.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/eBolt.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,48 @@
+use uo;
+use os;
+use util;
+use cfgfile;
+
+include "include/client";
+include "include/sound";
+include "include/tileEffects";
+include "include/spellAttack";
+include ":magery:reflect";
+include "include/magic";
+
+
+program spell_eBolt(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+	var spellid := parms.spellid;
+	var spellcfg := ReadConfigFile(":*:spells");
+	var circle := spellcfg[spellid].circle;
+
+	if (!castOn.container)
+		PlayMovingEffect( caster, castOn, FX_ENERGY_BOLT, 0xa, 0x1e );
+	endif
+	PlaySoundEffect( caster, SFX_SPELL_ENERGY_BOLT );
+	SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "ebolt" } );
+	if (spell_reflect(castOn))
+		castOn := caster;
+		PlayMovingEffect( caster, castOn, FX_ENERGY_BOLT, 0xa, 0x1e );
+		PlaySoundEffect( caster, SFX_SPELL_ENERGY_BOLT );
+	endif
+	var dmg := RandomDiceRoll("5d8");
+	if (spell_reflect(castOn))
+		PlayMovingEffect( castOn, caster, FX_ENERGY_BOLT, 0xa, 0x1e );
+		PlaySoundEffect( castOn, SFX_SPELL_ENERGY_BOLT );
+		castOn := caster;
+		if (GetObjProperty( caster, "mr") == "1")
+			EraseObjProperty(caster, "mr");
+			SendSysMessage(caster, "Your magic reflect spell saved you!");
+			return;
+		endif
+  	endif
+	if (castOn.isA(POLCLASS_NPC))
+		dmg := dmg * 2;
+	endif
+	ApplyRawDamage(castOn, Resisted(circle, caster, castOn, dmg));
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/earthquake.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/earthquake.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/earthquake.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,40 @@
+use uo;
+use util;
+
+include "include/client";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+include "include/spellAttack";
+include "include/magic";
+
+
+program spell_earthquake(parms)
+	var caster := parms.caster;
+	var spellid := parms.spellid;
+	var spellcfg := ReadConfigFile(":*:spells");
+	var circle := spellcfg[spellid].circle;
+	var range := 12;
+	var victims := ListMobilesNearLocationEx( caster.x, caster.y, caster.z, range, LISTEX_FLAG_NORMAL + LISTEX_FLAG_HIDDEN, caster.realm );
+	var dmg;
+
+	PlaySoundEffect( caster, SFX_220 );
+	foreach mobile in victims
+		if ((mobile.serial != caster.serial) and (mobile.cmdlevel < 2))
+			SetObjProperty(mobile, "LastHit", {caster.name,caster.serial, "earthquake" });
+			send_attack(mobile,caster, 57);
+			dmg := RandomDiceRoll("7d7");
+			PrintTextAbovePrivate( mobile,"You are tossed about as the earth trembles below your feet!", mobile );
+			PlaySoundEffect( mobile, SFX_SPELL_EARTHQUAKE );
+			PlayObjectCenteredEffect( mobile, FX_SMOKE, 7, 7);
+			if (mobile.isA(POLCLASS_NPC))
+				dmg := dmg * 2;
+			endif
+	  		ApplyRawDamage( mobile, Resisted(circle,caster,mobile,dmg) );
+		endif
+	endforeach
+	sleep(2);
+	PlaySoundEffect(caster, SFX_223);
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/energyField.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/energyField.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/energyField.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,28 @@
+use os;
+use uo;
+use util;
+
+include "include/fields";
+include ":attributes:attributes";
+include "include/objtype";
+
+
+program spell_energyField( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var fields := {};
+  var x := castOn.x;
+  var y := castOn.y;
+  var z := castOn.z;
+  case(get_direction(caster))
+	"NS" : fields := CreateNorthSouthField(caster, UOBJ_EFIELD_NS, x, y, z, 5);
+	"EW" : fields := CreateEastWestField(caster, UOBJ_EFIELD_EW, x, y, z, 5);
+  endcase
+  PlaySoundEffect(caster,0x20c);
+  Detach();
+  var duration := 20 + ( CInt(AP_GetSkill(caster, MAGERY) ) / 3 );
+  sleep(duration);
+  foreach fieldpart in fields
+    DestroyItem(fieldpart);
+  endforeach
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/explosion.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/explosion.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/explosion.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,36 @@
+use os;
+use uo;
+use cfgfile;
+
+include ":attributes:attributes";
+include "include/sound";
+include "include/tileEffects";
+include "include/spellAttack";
+include ":magery:reflect";
+include "include/magic";
+
+program spell_explosion(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+	var spellid := parms.spellid;
+	var spellcfg := ReadConfigFile(":*:spells");
+	var circle := spellcfg[spellid].circle;
+	var dmg;
+
+	SetObjProperty(castOn, "LastHit", ( {caster.name, caster.serial, "explosion" } ) );
+	if(spell_reflect(castOn))
+		castOn := caster;
+	endif
+  dmg := RandomDiceRoll("7d6");
+  Detach();
+  sleep(4);
+  send_attack(castOn,caster, 43);
+  PlaySoundEffect( castOn, SFX_SPELL_EXPLOSION );
+  PlayStationaryEffect( castOn.x,castOn.y,castOn.z, FX_EXPLODE_3, 7, 0x10, 0 , caster.realm );
+  if(AP_GetVital(castOn, HITS) >= 1)
+    if(castOn.npctemplate)
+      dmg := dmg * 2;
+    endif
+    ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
+  endif
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/feeblemind.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/feeblemind.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/feeblemind.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,35 @@
+use uo;
+use os;
+use util;
+use cfgfile;
+
+include "include/statMod";
+include ":attributes:attributes";
+include "include/sound";
+include "include/tileEffects";
+include ":magery:reflect";
+include "include/magic";
+
+
+program spell_feeblemind(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+
+  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "feeblemind" });
+  if (spell_reflect(castOn))
+	castOn := caster;
+  endif
+  PlaySoundEffect(castOn, SFX_SPELL_FEEBLEMIND);
+  PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 7, 7 );
+  if (!CanMod(castOn, "int"))
+	SendSysMessage(caster,"Already under the influence!");
+	return;
+  endif
+  var magery := AP_GetSkill(caster, MAGERY);
+  var modAmount := Resisted(circle,caster,castOn,(GetModAmount( magery )));
+  var duration := GetModDuration( magery );
+  DoTempMod(castOn, "int", 0 - modAmount, duration);
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/fireField.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/fireField.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/fireField.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,27 @@
+include "include/fields";
+include ":attributes:attributes";
+include "include/client";
+include "include/firewall";
+
+
+program spell_fireField(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+	var fields := {};
+	var x := castOn.x;
+	var y := castOn.y;
+	var z := castOn.z;
+	case (get_direction(caster))
+		"NS" : fields := CreateNorthSouthField(caster, UOBJ_FIREFIELD_NS, x, y, z, 5);
+		"EW" : fields := CreateEastWestField(caster, UOBJ_FIREFIELD_EW, x, y, z, 5);
+	endcase
+	PlaySoundEffect(caster, 0x20d);
+	Detach();
+	var duration := 20 + ( CInt(AP_GetSkill(caster, MAGERY) ) / 3 );
+	sleep(duration);
+	foreach fieldpart in fields
+		DestroyItem(fieldpart);
+	endforeach
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/fireball.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/fireball.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/fireball.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,33 @@
+use uo;
+use cfgfile;
+
+include "include/magic";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+include ":magery:reflect";
+
+
+program spell_fireball(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+
+  PlayMovingEffect(caster, castOn, FX_FIREBALL, 5, 1);
+  PlaySoundEffect(caster, 0x15f);
+  var dmg := RandomDiceRoll("3d6");
+  SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "fireball"});
+  if (spell_reflect(castOn))
+    PlayMovingEffect(castOn, caster, FX_FIREBALL, 5, 1);
+    PlaySoundEffect(castOn, 0x15f);
+    castOn := caster;
+  endif
+  if (AP_GetVital(castOn, HITS) >= 1)
+    if(castOn.npctemplate)
+      dmg := dmg * 2;
+    endif
+    ApplyRawDamage(castOn, Resisted(circle,caster,castOn, dmg));
+  endif
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/flameStrike.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/flameStrike.src.temp	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/flameStrike.src.temp	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,31 @@
+use uo;
+use cfgfile;
+
+include ":magery:reflect";
+include "include/sound";
+include "include/magic";
+include "include/attributes";
+
+
+program spell_flameStrike(parms)
+	var caster := parms.caster;
+  	var spellid := parms.spellid;
+	var spellcfg := ReadConfigFile(":*:spells");
+	var circle := spellcfg[spellid].circle;
+	var dmg := RandomDiceRoll("6d8");
+
+	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "flame strike" });
+	if (Reflected(castOn))
+		castOn := caster;
+	endif
+	PlayObjectCenteredEffect(castOn, 0x3709, 0x0a, 0x1e );
+	PlaySoundEffect( caster, SFX_SPELL_FLAME_STRIKE );
+	if (GetHp(castOn) >= 1)
+		if (castOn.npctemplate)
+			dmg := dmg * 2;
+		endif
+		ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
+	endif
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/gHeal.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/gHeal.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/gHeal.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,25 @@
+use uo;
+use os;
+use util;
+
+include ":attributes:attributes";
+include "include/client";
+include "include/sound";
+include "include/tileEffects";
+
+
+program spell_greaterHeal(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+	var healed := RandomDiceRoll("1d3");
+	healed := CInt(AP_GetSkill(caster, MAGERY)/2) + healed;
+	SendSysMessage(caster, "You healed " + healed + " damage.");
+	if (castOn.isA(POLCLASS_NPC))
+		healed := healed * 2;
+	endif
+	HealDamage(castOn, healed);
+	PlayObjectCenteredEffect( castOn, FX_SPARK_EFFECT, 7, 0x10 );
+	PlaySoundEffect( castOn, SFX_SPELL_GREATER_HEAL );
+
+	return;
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/gate.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/gate.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/gate.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,130 @@
+use os;
+use uo;
+
+include "include/isValidLoc";
+include "include/objtype";
+include "include/client";
+include "include/sound";
+
+
+program spell_gate(parms)
+  var caster := parms.caster;
+  var castOn := Target(caster);
+  if((castOn.objtype != UOBJ_RUNE) && (castOn.objtype != 0x6100))
+    SendSysMessage(caster, "You can only cast that on a recall rune!");
+    return;
+  endif
+  var tox := CInt(GetObjProperty( castOn, "x" ));
+  var toy := CInt(GetObjProperty( castOn, "y" ));
+  var toz := CInt(GetObjProperty( castOn, "z" ));
+  var torealm := GetObjProperty( castOn, "realm" );
+  if(!tox)
+    SendSysMessage(caster, "The rune must be marked.");
+    return;
+  endif
+  if(!torealm)
+  	torealm := "britannia";
+  endif  
+  if(!ReserveItem(castOn))
+    return;
+  endif
+  if(GetObjProperty(castOn, "Vendored"))
+    SendSysMessage(caster, "You cannot gate off of runes on a vendor.");
+    return;
+  endif
+  if(!isValidLoc(tox,toy))
+    SendSysMessage(caster, "You may not gate into Green Acres.");
+    ReleaseItem(castOn);
+    DestroyItem(castOn);
+    return;
+  endif
+  PlaySoundEffect( caster, SFX_SPELL_GATE_TRAVEL );
+  var chk := 0;
+  if((caster.x >= 5120) && (caster.x <= 5375) && (caster.y >= 0) && (caster.y <= 255))
+    SendSysMessage(caster, "Your spell fails and consumes the rune!");
+    if(castOn.objtype == UOBJ_RUNE)
+      DestroyItem(castOn);
+    elseif(castOn.objtype == 0x6100)
+      removeentry(castOn);
+    endif
+    chk := 1;
+  endif
+  var multicheck := CreateItemAtLocation(1, 1, 0, 0xeed, 1, torealm);
+  multicheck.hidden := 1;
+  if(!MoveItemToLocation(multicheck, tox, toy, toz, MOVEITEM_NORMAL))
+    SendSysMessage(caster, "Something is blocking the location.");
+    if(castOn.objtype == UOBJ_RUNE)
+      DestroyItem(castOn);
+    elseif(castOn.objtype == 0x6100)
+      removeentry(castOn);
+    endif
+    chk := 1;
+  endif
+  if(multicheck.multi)
+    SendSysMessage(caster,"Something is blocking the location.");
+    if(castOn.objtype == UOBJ_RUNE)
+      DestroyItem(castOn);
+    elseif(castOn.objtype == 0x6100)
+      removeentry(castOn);
+    endif
+    chk := 1;
+  endif
+  DestroyItem(multicheck);
+  if(chk == 1)
+    return;
+  endif
+  var wx := caster.x;
+  var wy := caster.y;
+  var wz := caster.z;
+  PlayStationaryEffect( wx, wy, wz, 6899, 1, 30, 0, caster.realm );
+  PlayStationaryEffect( tox, toy, toz, 6899, 1, 30, 0, caster.realm );
+  sleepms(2800);
+  set_critical( 1 );
+  var gate1 := CreateItemAtLocation( wx, wy, wz, UOBJ_BLUE_MOONGATE, 1, caster.realm );
+  gate1.movable := 0;
+  var gate2 := CreateItemAtLocation( tox, toy, toz, UOBJ_BLUE_MOONGATE, 1, torealm );
+  gate2.movable := 0;
+  if(!gate1)
+    DestroyItem(gate2);
+    SendSysMessage(caster, "Something is interfering with the spell.");
+    return;
+  endif
+  if (!gate2)
+    DestroyItem(gate1);
+    SendSysMessage(caster, "Something is interfering with the spell.");
+    return;
+  endif
+  set_critical(0);
+  SetObjProperty( gate1, "GateDestX", gate2.x );
+  SetObjProperty( gate1, "GateDestY", gate2.y );
+  SetObjProperty( gate1, "GateDestZ", gate2.z );
+  SetObjProperty( gate1, "GateDestRealm", gate2.realm );
+  SetObjProperty( gate2, "GateDestX", gate1.x );
+  SetObjProperty( gate2, "GateDestY", gate1.y );
+  SetObjProperty( gate2, "GateDestZ", gate1.z );
+  SetObjProperty( gate2, "GateDestRealm", gate1.realm );
+  Detach();
+  sleep(30);
+  set_critical(1);
+  DestroyItem( gate1 );
+  DestroyItem( gate2 );
+  set_critical(0);
+endprogram
+
+function removeentry(castOn)
+  var tox := CInt(GetObjProperty( castOn, "x" ));
+  var toy := CInt(GetObjProperty( castOn, "y" ));
+  var toz := CInt(GetObjProperty( castOn, "z" ));
+  var defs := GetObjProperty(castOn, "runedefs");
+  var holder := {};
+  foreach thing in defs
+    if((Cint(thing[2]) != tox) or (Cint(thing[3]) != toy) or (Cint(thing[4]) != toz))
+      holder.append(thing);
+    endif
+  endforeach
+  SetObjProperty(castOn, "runedefs", holder);
+  EraseObjProperty(castOn, "x");
+  EraseObjProperty(castOn, "y");
+  EraseObjProperty(castOn, "z");
+  return;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/harm.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/harm.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/harm.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,36 @@
+use os;
+use uo;
+use util;
+use cfgfile;
+
+include "include/client";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+include ":magery:reflect";
+include "include/magic";
+
+
+program spell_harm(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+	var spellid := parms.spellid;
+	var spellcfg := ReadConfigFile(":*:spells");
+	var circle := spellcfg[spellid].circle;
+	var dmg := RandomDiceRoll("1d12");
+
+	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "harm" });
+	if (spell_reflect(castOn))
+		castOn := caster;
+	endif
+	PlaySoundEffect(castOn, SFX_SPELL_HARM);
+	PlayObjectCenteredEffect( castOn, FX_GLOW_SPIKE, 0x0a,0x1e);
+	if(AP_GetVital(castOn, HITS) >= 1)
+		if(castOn.npctemplate)
+			dmg := dmg * 2;
+		endif
+		ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
+	endif
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/heal.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/heal.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/heal.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,25 @@
+use uo;
+use os;
+use util;
+
+include "include/client";
+include ":attributes:attributes";
+include "include/sound";
+include "include/tileEffects";
+
+
+program spell_heal(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var healed := CInt(AP_GetSkill(caster, MAGERY) / 20) + 5;
+  if(healed > 20)
+	healed := 20;
+  endif
+  if(castOn.isA(POLCLASS_NPC))
+    healed := healed * 2;
+  endif
+  HealDamage(castOn, healed);
+  PlayObjectCenteredEffect(castOn, FX_SPARK_EFFECT, 7, 0x10);
+  PlaySoundEffect(castOn, SFX_SPELL_HEAL);
+  SendSysMessage(caster, "You healed " + healed + " damage.");
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/incognito.cfg
===================================================================
--- trunk/096/pkg/skills/magery/OLD/incognito.cfg	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/incognito.cfg	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,3733 @@
+Names MALE
+{
+        Count 1518
+        Name1           Aaron
+        Name2           Aasin
+        Name3           Abbott
+        Name4           Abdel
+        Name5           Abdiel
+        Name6           Abel
+        Name7           Abijah
+        Name8           Abner
+        Name9           Abraham
+        Name10          Abran
+        Name11          Ace
+        Name12          Achilles
+        Name13          Ackerley
+        Name14          Adair
+        Name15          Adam
+        Name16          Adan
+        Name17          Addison
+        Name18          Adeben
+        Name19          Adem
+        Name20          Adiran
+        Name21          Adlai
+        Name22          Adler
+        Name23          Adley
+        Name24          Admon
+        Name25          Adolph
+        Name26          Adon
+        Name27          Adonis
+        Name28          Adrian
+        Name29          Adriel
+        Name30          Aeneas
+        Name31          Agustin
+        Name32          Ahearn
+        Name33          Ahmik
+        Name34          Ahren
+        Name35          Aidan
+        Name36          Aiken
+        Name37          Aimery
+        Name38          Aitan
+        Name39          Ajayi
+        Name40          Akando
+        Name41          Akbaar
+        Name42          Akello
+        Name43          Akil
+        Name44          Akshay
+        Name45          Alan
+        Name46          Aland
+        Name47          Alano
+        Name48          Alaric
+        Name49          Alastair
+        Name50          Alben
+        Name51          Albert
+        Name52          Alcander
+        Name53          Alcott
+        Name54          Alden
+        Name55          Alder
+        Name56          Aldrick
+        Name57          Alec
+        Name58          Alek
+        Name59          Aleksy
+        Name60          Aleron
+        Name61          Aleser
+        Name62          Alex
+        Name63          Alexander
+        Name64          Alfred
+        Name65          Alger
+        Name66          Alim
+        Name67          Alistair
+        Name68          Allaard
+        Name69          Allan
+        Name70          Allard
+        Name71          Allen
+        Name72          Alonzo
+        Name73          Alphonse
+        Name74          Alphonso
+        Name75          Alston
+        Name76          Altair
+        Name77          Alton
+        Name78          Alvin
+        Name79          Amadeo
+        Name80          Amadi
+        Name81          Amado
+        Name82          Ambrose
+        Name83          Amiel
+        Name84          Ammon
+        Name85          Amos
+        Name86          Amsden
+        Name87          Anders
+        Name88          Andre
+        Name89          Andreus
+        Name90          Andrew
+        Name91          Andrey
+        Name92          Andries
+        Name93          Andrio
+        Name94          Angelo
+        Name95          Angus
+        Name96          Anker
+        Name97          Anoki
+        Name98          Ansel
+        Name99          Anselme
+        Name100         Ansley
+        Name101         Anson
+        Name102         Anthony
+        Name103         Antonio
+        Name104         Anwar
+        Name105         Archer
+        Name106         Archibald
+        Name107         Ardon
+        Name108         Aren
+        Name109         Ares
+        Name110         Argus
+        Name111         Ari
+        Name112         Aricin
+        Name113         Arion
+        Name114         Aristo
+        Name115         Aristotle
+        Name116         Arkin
+        Name117         Arlen
+        Name118         Arley
+        Name119         Arlin
+        Name120         Arlo
+        Name121         Arman
+        Name122         Armen
+        Name123         Armon
+        Name124         Armstrong
+        Name125         Arne
+        Name126         Arnold
+        Name127         Arnon
+        Name128         Aron
+        Name129         Arpiar
+        Name130         Arsen
+        Name131         Arsenio
+        Name132         Arthur
+        Name133         Ashby
+        Name134         Asher
+        Name135         Ashford
+        Name136         Ashlin
+        Name137         Ashon
+        Name138         Ashur
+        Name139         Athan
+        Name140         Atheron
+        Name141         Atman
+        Name142         Audric
+        Name143         Audun
+        Name144         Augustin
+        Name145         Augustus
+        Name146         Aurek
+        Name147         Austin
+        Name148         Averill
+        Name149         Avery
+        Name150         Axel
+        Name151         Bae
+        Name152         Bailey
+        Name153         Baingana
+        Name154         Bakari
+        Name155         Balbo
+        Name156         Balder
+        Name157         Baldwin
+        Name158         Bale
+        Name159         Balendin
+        Name160         Bali
+        Name161         Balin
+        Name162         Balint
+        Name163         Bancroft
+        Name164         Bandele
+        Name165         Bane
+        Name166         Banning
+        Name167         Baran
+        Name168         Barclay
+        Name169         Barden
+        Name170         Bardo
+        Name171         Bardon
+        Name172         Barnabas
+        Name173         Barnaby
+        Name174         Barnett
+        Name175         Barney
+        Name176         Baron
+        Name177         Barrett
+        Name178         Barry
+        Name179         Barse
+        Name180         Bart
+        Name181         Barth
+        Name182         Bartholomew
+        Name183         Barton
+        Name184         Basil
+        Name185         Bastiaan
+        Name186         Baul
+        Name187         Bavol
+        Name188         Baxter
+        Name189         Bay
+        Name190         Bayani
+        Name191         Bayard
+        Name192         Baylor
+        Name193         Bazyli
+        Name194         Beacan
+        Name195         Beagan
+        Name196         Beaman
+        Name197         Beau
+        Name198         Beaumont
+        Name199         Beauregard
+        Name200         Beck
+        Name201         Beldon
+        Name202         Belen
+        Name203         Bem
+        Name204         Beman
+        Name205         Ben
+        Name206         Benedict
+        Name207         Benen
+        Name208         Benjamin
+        Name209         Bennett
+        Name210         Benson
+        Name211         Bent
+        Name212         Bentley
+        Name213         Benton
+        Name214         Berenger
+        Name215         Bergren
+        Name216         Berk
+        Name217         Berkeley
+        Name218         Bernard
+        Name219         Bersh
+        Name220         Bert
+        Name221         Bert
+        Name222         Berthold
+        Name223         Berton
+        Name224         Bertram
+        Name225         Beval
+        Name226         Bevan
+        Name227         Bialy
+        Name228         Bilal
+        Name229         Bishop
+        Name230         Bitalo
+        Name231         Bjorn
+        Name232         Blade
+        Name233         Blaine
+        Name234         Blair
+        Name235         Blaise
+        Name236         Blake
+        Name237         Blaz
+        Name238         Blorn
+        Name239         Bo
+        Name240         Boden
+        Name241         Bogart
+        Name242         Bohdan
+        Name243         Bolton
+        Name244         Bond
+        Name245         Booker
+        Name246         Boone
+        Name247         Borden
+        Name248         Boris
+        Name249         Botan
+        Name250         Bowie
+        Name251         Bowman
+        Name252         Boyce
+        Name253         Boyd
+        Name254         Boyden
+        Name255         Brad
+        Name256         Braden
+        Name257         Bradford
+        Name258         Bradney
+        Name259         Brady
+        Name260         Bram
+        Name261         Bran
+        Name262         Brand
+        Name263         Brandeis
+        Name264         Brandon
+        Name265         Brant
+        Name266         Braxton
+        Name267         Bray
+        Name268         Braz
+        Name269         Brazil
+        Name270         Bren
+        Name271         Brencis
+        Name272         Brendan
+        Name273         Brendon
+        Name274         Brennan
+        Name275         Brent
+        Name276         Brentan
+        Name277         Bret
+        Name278         Brett
+        Name279         Brewster
+        Name280         Briac
+        Name281         Brian
+        Name282         Briand
+        Name283         Brice
+        Name284         Brieg
+        Name285         Brinley
+        Name286         Brishen
+        Name287         Brock
+        Name288         Broderick
+        Name289         Brodny
+        Name290         Brody
+        Name291         Bronson
+        Name292         Bront
+        Name293         Bruce
+        Name294         Bruno
+        Name295         Brutus
+        Name296         Bryan
+        Name297         Bryant
+        Name298         Bryce
+        Name299         Bryson
+        Name300         Buck
+        Name301         Bud
+        Name302         Budo
+        Name303         Burgess
+        Name304         Burhan
+        Name305         Burian
+        Name306         Burke
+        Name307         Burl
+        Name308         Burr
+        Name309         Burton
+        Name310         Byran
+        Name311         Byron
+        Name312         Cadeo
+        Name313         Cador
+        Name314         Caedmon
+        Name315         Cailan
+        Name316         Cain
+        Name317         Caine
+        Name318         Calder
+        Name319         Caldwell
+        Name320         Caleb
+        Name321         Calvin
+        Name322         Cam
+        Name323         Camden
+        Name324         Cameron
+        Name325         Candan
+        Name326         Canton
+        Name327         Canute
+        Name328         Carden
+        Name329         Carey
+        Name330         Carl
+        Name331         Carlin
+        Name332         Carlo
+        Name333         Carlos
+        Name334         Carlton
+        Name335         Carr
+        Name336         Carrick
+        Name337         Carrocio
+        Name338         Carroll
+        Name339         Carson
+        Name340         Carson
+        Name341         Carter
+        Name342         Carver
+        Name343         Casey
+        Name344         Casper
+        Name345         Cassidy
+        Name346         Cassius
+        Name347         Castel
+        Name348         Cato
+        Name349         Caton
+        Name350         Cavan
+        Name351         Ceasar
+        Name352         Cecil
+        Name353         Cedric
+        Name354         Cemal
+        Name355         Chad
+        Name356         Chadwick
+        Name357         Chaim
+        Name358         Chal
+        Name359         Chale
+        Name360         Chalmers
+        Name361         Chander
+        Name362         Chandler
+        Name363         Chane
+        Name364         Chaney
+        Name365         Channing
+        Name366         Chapin
+        Name367         Chapman
+        Name368         Charles
+        Name369         Charlton
+        Name370         Chase
+        Name371         Chatha
+        Name372         Chauncy
+        Name373         Chayton
+        Name374         Chen
+        Name375         Cheney
+        Name376         Chester
+        Name377         Chet
+        Name378         Chevalier
+        Name379         Chike
+        Name380         Chin
+        Name381         Christian
+        Name382         Christoph
+        Name383         Christopher
+        Name384         Christos
+        Name385         Chuck
+        Name386         Ciceron
+        Name387         Ciro
+        Name388         Clarence
+        Name389         Clark
+        Name390         Claude
+        Name391         Clay
+        Name392         Clay
+        Name393         Clayton
+        Name394         Clement
+        Name395         Cleveland
+        Name396         Clifford
+        Name397         Clifton
+        Name398         Clint
+        Name399         Clinton
+        Name400         Clive
+        Name401         Clyde
+        Name402         Cody
+        Name403         Colby
+        Name404         Cole
+        Name405         Coleman
+        Name406         Colin
+        Name407         Collin
+        Name408         Colon
+        Name409         Colton
+        Name410         Coman
+        Name411         Conan
+        Name412         Condon
+        Name413         Connor
+        Name414         Conrad
+        Name415         Conway
+        Name416         Corbett
+        Name417         Corbin
+        Name418         Corcoran
+        Name419         Cordell
+        Name420         Corey
+        Name421         Cornelius
+        Name422         Cort
+        Name423         Coty
+        Name424         Courtland
+        Name425         Craig
+        Name426         Crandall
+        Name427         Creighton
+        Name428         Crispin
+        Name429         Crosby
+        Name430         Cullen
+        Name431         Cullin
+        Name432         Culver
+        Name433         Curran
+        Name434         Curtis
+        Name435         Cynric
+        Name436         Cyrano
+        Name437         Cyril
+        Name438         Cyrus
+        Name439         Dag
+        Name440         Dagan
+        Name441         Dakarai
+        Name442         Dakota
+        Name443         Dale
+        Name444         Dallin
+        Name445         Dalton
+        Name446         Daly
+        Name447         Damek
+        Name448         Damen
+        Name449         Damian
+        Name450         Damien
+        Name451         Damion
+        Name452         Damon
+        Name453         Dana
+        Name454         Dane
+        Name455         Daniel
+        Name456         Danior
+        Name457         Dannik
+        Name458         Dante
+        Name459         Daren
+        Name460         Darien
+        Name461         Dario
+        Name462         Darnell
+        Name463         Darrel
+        Name464         Darrell
+        Name465         Darren
+        Name466         Daryl
+        Name467         David
+        Name468         Davin
+        Name469         Davis
+        Name470         Deacon
+        Name471         Dean
+        Name472         Decker
+        Name473         Delaney
+        Name474         Delano
+        Name475         Delbert
+        Name476         Dellan
+        Name477         Delmore
+        Name478         Delsin
+        Name479         Deman
+        Name480         Dempsey
+        Name481         Dempster
+        Name482         Denby
+        Name483         Dennis
+        Name484         Dennys
+        Name485         Denton
+        Name486         Denver
+        Name487         Der
+        Name488         Derek
+        Name489         Derrick
+        Name490         Derry
+        Name491         Desmond
+        Name492         Deverell
+        Name493         Devin
+        Name494         Devlin
+        Name495         Dewey
+        Name496         Dexter
+        Name497         Diederik
+        Name498         Diego
+        Name499         Dieter
+        Name500         Dillon
+        Name501         Dimitri
+        Name502         Dirk
+        Name503         Dobry
+        Name504         Dominic
+        Name505         Dominick
+        Name506         Donald
+        Name507         Donatien
+        Name508         Donato
+        Name509         Donnelley
+        Name510         Donnelly
+        Name511         Donovan
+        Name512         Doron
+        Name513         Dougie
+        Name514         Douglas
+        Name515         Douglass
+        Name516         Dov
+        Name517         Doyle
+        Name518         Drake
+        Name519         Drew
+        Name520         Duane
+        Name521         Dugan
+        Name522         Duglas
+        Name523         Duncan
+        Name524         Dunstan
+        Name525         Durand
+        Name526         Durriken
+        Name527         Dusan
+        Name528         Dustin
+        Name529         Dutch
+        Name530         Dwayne
+        Name531         Dwight
+        Name532         Dyami
+        Name533         Dyastro
+        Name534         Dylan
+        Name535         Dymas
+        Name536         Eamon
+        Name537         Earl
+        Name538         Earle
+        Name539         Eaton
+        Name540         Edan
+        Name541         Edgan
+        Name542         Edgar
+        Name543         Edison
+        Name544         Edmund
+        Name545         Edrin
+        Name546         Edward
+        Name547         Edwin
+        Name548         Edwin
+        Name549         Egan
+        Name550         Einar
+        Name551         Elad
+        Name552         Elden
+        Name553         Eldroth
+        Name554         Elek
+        Name555         Eli
+        Name556         Elias
+        Name557         Elijah
+        Name558         Elkan
+        Name559         Ellery
+        Name560         Elliot
+        Name561         Elliott
+        Name562         Ellis
+        Name563         Ellsworth
+        Name564         Elmer
+        Name565         Elmo
+        Name566         Elston
+        Name567         Elton
+        Name568         Elwood
+        Name569         Emanuel
+        Name570         Emil
+        Name571         Emilio
+        Name572         Emmett
+        Name573         Emo
+        Name574         Enoch
+        Name575         Enrico
+        Name576         Enrique
+        Name577         Ephraim
+        Name578         Erek
+        Name579         Eric
+        Name580         Erik
+        Name581         Ernest
+        Name582         Erol
+        Name583         Errol
+        Name584         Erskine
+        Name585         Erwin
+        Name586         Eryx
+        Name587         Essien
+        Name588         Esteban
+        Name589         Ethan
+        Name590         Eugene
+        Name591         Evan
+        Name592         Evander
+        Name593         Everett
+        Name594         Evzen
+        Name595         Ezekial
+        Name596         Ezra
+        Name597         Fabio
+        Name598         Fairfax
+        Name599         Farley
+        Name600         Farrell
+        Name601         Faxon
+        Name602         Felix
+        Name603         Felix
+        Name604         Fenn
+        Name605         Fenton
+        Name606         Fergus
+        Name607         Ferran
+        Name608         Ferris
+        Name609         Fielding
+        Name610         Filbert
+        Name611         Filmore
+        Name612         Finlay
+        Name613         Finley
+        Name614         Finn
+        Name615         Finnigan
+        Name616         Fisk
+        Name617         Fitzgerald
+        Name618         Fletcher
+        Name619         Flindo
+        Name620         Flint
+        Name621         Floyd
+        Name622         Flynn
+        Name623         Forbes
+        Name624         Forrest
+        Name625         Forsythe
+        Name626         Foster
+        Name627         Foster
+        Name628         Francis
+        Name629         Franek
+        Name630         Frank
+        Name631         Franklin
+        Name632         Frasier
+        Name633         Frazer
+        Name634         Frazier
+        Name635         Fred
+        Name636         Frederick
+        Name637         Fremont
+        Name638         Fritz
+        Name639         Fuller
+        Name640         Fulton
+        Name641         Gabe
+        Name642         Gabriel
+        Name643         Gage
+        Name644         Galen
+        Name645         Galeno
+        Name646         Galvin
+        Name647         Gamble
+        Name648         Gannon
+        Name649         Gareth
+        Name650         Garfield
+        Name651         Gargan
+        Name652         Garner
+        Name653         Garrett
+        Name654         Garrick
+        Name655         Garridan
+        Name656         Garrison
+        Name657         Garritt
+        Name658         Garth
+        Name659         Garvin
+        Name660         Gary
+        Name661         Gaspar
+        Name662         Gaston
+        Name663         Gavin
+        Name664         Gavrie
+        Name665         Gaylord
+        Name666         Gaynor
+        Name667         Geoff
+        Name668         Geoffrey
+        Name669         Geoffry
+        Name670         George
+        Name671         Gerard
+        Name672         Gerik
+        Name673         Germain
+        Name674         Gerry
+        Name675         Gideon
+        Name676         Gilberto
+        Name677         Giles
+        Name678         Ginton
+        Name679         Givon
+        Name680         Glen
+        Name681         Glenn
+        Name682         Glenno
+        Name683         Godfrey
+        Name684         Gordon
+        Name685         Gordy
+        Name686         Gorman
+        Name687         Grady
+        Name688         Graham
+        Name689         Gram
+        Name690         Granger
+        Name691         Grant
+        Name692         Granville
+        Name693         Grayson
+        Name694         Greg
+        Name695         Greger
+        Name696         Gregor
+        Name697         Gregory
+        Name698         Gresham
+        Name699         Griffen
+        Name700         Griffith
+        Name701         Guilhem
+        Name702         Gunnar
+        Name703         Gunther
+        Name704         Gus
+        Name705         Gustave
+        Name706         Guthrie
+        Name707         Guy
+        Name708         Hackett
+        Name709         Hadden
+        Name710         Hadi
+        Name711         Hadley
+        Name712         Hadrian
+        Name713         Hagan
+        Name714         Hal
+        Name715         Halden
+        Name716         Hale
+        Name717         Halian
+        Name718         Halsey
+        Name719         Hamilton
+        Name720         Hamlin
+        Name721         Hank
+        Name722         Hans
+        Name723         Harden
+        Name724         Hardy
+        Name725         Harith
+        Name726         Harlan
+        Name727         Harman
+        Name728         Harold
+        Name729         Harper
+        Name730         Harrison
+        Name731         Harry
+        Name732         Hart
+        Name733         Hartley
+        Name734         Harvey
+        Name735         Hassan
+        Name736         Hastin
+        Name737         Hastings
+        Name738         Hayden
+        Name739         Hayes
+        Name740         Haynes
+        Name741         Heath
+        Name742         Hector
+        Name743         Helaku
+        Name744         Henning
+        Name745         Henry
+        Name746         Herbert
+        Name747         Herman
+        Name748         Herschel
+        Name749         Hilliard
+        Name750         Hilton
+        Name751         Hiroshi
+        Name752         Hobart
+        Name753         Hogan
+        Name754         Holden
+        Name755         Holt
+        Name756         Homes
+        Name757         Horace
+        Name758         Horton
+        Name759         Houston
+        Name760         Howard
+        Name761         Howrence
+        Name762         Hoyt
+        Name763         Hugh
+        Name764         Hugo
+        Name765         Humphrey
+        Name766         Hunter
+        Name767         Huntley
+        Name768         Hyman
+        Name769         Iain
+        Name770         Ian
+        Name771         Ian
+        Name772         Ilias
+        Name773         Ingmar
+        Name774         Ingram
+        Name775         Ira
+        Name776         Irvin
+        Name777         Irving
+        Name778         Irwin
+        Name779         Isaac
+        Name780         Isaiah
+        Name781         Israel
+        Name782         Itzak
+        Name783         Ivan
+        Name784         Ivar
+        Name785         Jabari
+        Name786         Jabir
+        Name787         Jack
+        Name788         Jacob
+        Name789         Jacobe
+        Name790         Jacques
+        Name791         Jacson
+        Name792         Jacy
+        Name793         Jafar
+        Name794         Jagger
+        Name795         Jake
+        Name796         Jal
+        Name797         Jaleel
+        Name798         Jamal
+        Name799         James
+        Name800         Jamison
+        Name801         Jared
+        Name802         Jarek
+        Name803         Jarman
+        Name804         Jaron
+        Name805         Jarrod
+        Name806         Jarvis
+        Name807         Jason
+        Name808         Jasper
+        Name809         Javan
+        Name810         Javier
+        Name811         Jay
+        Name812         Jebidiah
+        Name813         Jed
+        Name814         Jedidiah
+        Name815         Jedidiah
+        Name816         Jedrek
+        Name817         Jeff
+        Name818         Jeffrey
+        Name819         Jelani
+        Name820         Jeremiah
+        Name821         Jeremy
+        Name822         Jerolin
+        Name823         Jerome
+        Name824         Jeromy
+        Name825         Jerzy
+        Name826         Jesse
+        Name827         Jessee
+        Name828         Jethro
+        Name829         Jibril
+        Name830         Jin
+        Name831         Jiro
+        Name832         Jivin
+        Name833         Joel
+        Name834         Johann
+        Name835         John
+        Name836         Jolon
+        Name837         Jonah
+        Name838         Jonathan
+        Name839         Jonathon
+        Name840         Jordan
+        Name841         Jordon
+        Name842         Jorgen
+        Name843         Jorvin
+        Name844         Joseph
+        Name845         Joshua
+        Name846         Judd
+        Name847         Jude
+        Name848         Julian
+        Name849         Julius
+        Name850         Juma
+        Name851         Jung
+        Name852         Justin
+        Name853         Kadin
+        Name854         Kai
+        Name855         Kaikara
+        Name856         Kaladin
+        Name857         Kalb
+        Name858         Kale
+        Name859         Kalil
+        Name860         Kalkin
+        Name861         Kalman
+        Name862         Kamal
+        Name863         Kane
+        Name864         Kaniel
+        Name865         Kardal
+        Name866         Karl
+        Name867         Karsten
+        Name868         Kasch
+        Name869         Kasen
+        Name870         Kaspar
+        Name871         Kateb
+        Name872         Kayin
+        Name873         Keane
+        Name874         Kearney
+        Name875         Kedar
+        Name876         Keefe
+        Name877         Keelan
+        Name878         Keenan
+        Name879         Kegan
+        Name880         Keir
+        Name881         Keir
+        Name882         Keith
+        Name883         Kelby
+        Name884         Keleman
+        Name885         Kell
+        Name886         Kellen
+        Name887         Kelvin
+        Name888         Ken
+        Name889         Kenan
+        Name890         Kendall
+        Name891         Kendrick
+        Name892         Kenelm
+        Name893         Kenley
+        Name894         Kennard
+        Name895         Kennedy
+        Name896         Kenneth
+        Name897         Kent
+        Name898         Kenton
+        Name899         Kenyon
+        Name900         Keona
+        Name901         Ker
+        Name902         Kerby
+        Name903         Kern
+        Name904         Kerry
+        Name905         Kers
+        Name906         Kersen
+        Name907         Kerwin
+        Name908         Kester
+        Name909         Kevin
+        Name910         Khalil
+        Name911         Khoury
+        Name912         Kiefer
+        Name913         Kieran
+        Name914         Kiernan
+        Name915         Killian
+        Name916         Kin
+        Name917         Kinnel
+        Name918         Kinsey
+        Name919         Kintan
+        Name920         Kip
+        Name921         Kipp
+        Name922         Kirby
+        Name923         Kirk
+        Name924         Kiyoshi
+        Name925         Kliftin
+        Name926         Klog
+        Name927         Komor
+        Name928         Kontar
+        Name929         Krischan
+        Name930         Krister
+        Name931         Kurt
+        Name932         Kyle
+        Name933         Kyler
+        Name934         Laethan
+        Name935         Laird
+        Name936         Lamar
+        Name937         Lamont
+        Name938         Lance
+        Name939         Lander
+        Name940         Landon
+        Name941         Lane
+        Name942         Lang
+        Name943         Larry
+        Name944         Lars
+        Name945         Lawler
+        Name946         Lawrence
+        Name947         Lazarus
+        Name948         Lear
+        Name949         Lee
+        Name950         Leif
+        Name951         Leighton
+        Name952         Leland
+        Name953         Len
+        Name954         Lennon
+        Name955         Lennor
+        Name956         Lennox
+        Name957         Lensar
+        Name958         Leo
+        Name959         Leon
+        Name960         Leonard
+        Name961         Leron
+        Name962         Leroy
+        Name963         Lester
+        Name964         Lev
+        Name965         Levi
+        Name966         Lewis
+        Name967         Lewis
+        Name968         Li
+        Name969         Liam
+        Name970         Like
+        Name971         Lincoln
+        Name972         Lindsey
+        Name973         Lionel
+        Name974         Llewellyn
+        Name975         Lloyd
+        Name976         Logan
+        Name977         Loren
+        Name978         Lorenzo
+        Name979         Lorne
+        Name980         Louis
+        Name981         Lowell
+        Name982         Lucas
+        Name983         Lucian
+        Name984         Luis
+        Name985         Luke
+        Name986         Lukyan
+        Name987         Lunt
+        Name988         Luther
+        Name989         Lyle
+        Name990         Lyndon
+        Name991         Lysander
+        Name992         Mac
+        Name993         Macer
+        Name994         Mack
+        Name995         Mackenzie
+        Name996         Magnus
+        Name997         Malcolm
+        Name998         Malik
+        Name999         Manco
+        Name1000                Mandek
+        Name1001                Mander
+        Name1002                Manfred
+        Name1003                Manning
+        Name1004                Mansur
+        Name1005                Manuel
+        Name1006                Marc
+        Name1007                Marcos
+        Name1008                Marcus
+        Name1009                Marden
+        Name1010                Marek
+        Name1011                Mario
+        Name1012                Mark
+        Name1013                Markham
+        Name1014                Markos
+        Name1015                Marlin
+        Name1016                Marlon
+        Name1017                Marlon
+        Name1018                Marshal
+        Name1019                Marshall
+        Name1020                Marsten
+        Name1021                Martin
+        Name1022                Martingo
+        Name1023                Marvin
+        Name1024                Mason
+        Name1025                Matai
+        Name1026                Mateo
+        Name1027                Mather
+        Name1028                Matthew
+        Name1029                Matthias
+        Name1030                Maurice
+        Name1031                Max
+        Name1032                Maximillian
+        Name1033                Maxwell
+        Name1034                Maynard
+        Name1035                Mayon
+        Name1036                Mead
+        Name1037                Meka
+        Name1038                Melvin
+        Name1039                Mercer
+        Name1040                Merill
+        Name1041                Merle
+        Name1042                Merlin
+        Name1043                Merrick
+        Name1044                Merrik
+        Name1045                Meyer
+        Name1046                Micael
+        Name1047                Michael
+        Name1048                Migon
+        Name1049                Miguel
+        Name1050                Mike
+        Name1051                Mikkel
+        Name1052                Mikos
+        Name1053                Miles
+        Name1054                Miles
+        Name1055                Milo
+        Name1056                Milton
+        Name1057                Miner
+        Name1058                Mitchell
+        Name1059                Monroe
+        Name1060                Monte
+        Name1061                Morgan
+        Name1062                Morley
+        Name1063                Morris
+        Name1064                Mortimer
+        Name1065                Morton
+        Name1066                Morven
+        Name1067                Morz
+        Name1068                Motega
+        Name1069                Mukasa
+        Name1070                Murdoch
+        Name1071                Murdock
+        Name1072                Murphy
+        Name1073                Myles
+        Name1074                Myron
+        Name1075                Naeem
+        Name1076                Nalren
+        Name1077                Nantan
+        Name1078                Nathan
+        Name1079                Nathaniel
+        Name1080                Neal
+        Name1081                Neale
+        Name1082                Neil
+        Name1083                Nelek
+        Name1084                Nelson
+        Name1085                Neron
+        Name1086                Nestor
+        Name1087                Nevan
+        Name1088                Neville
+        Name1089                Nevin
+        Name1090                Nevin
+        Name1091                Nicanor
+        Name1092                Nicholas
+        Name1093                Nigel
+        Name1094                Nikolos
+        Name1095                Nils
+        Name1096                Noah
+        Name1097                Nodin
+        Name1098                Noe
+        Name1099                Nolan
+        Name1100                Norbert
+        Name1101                Norman
+        Name1102                Norris
+        Name1103                Norton
+        Name1104                Nuri
+        Name1105                Nyle
+        Name1106                Oakes
+        Name1107                Oakley
+        Name1108                Ochen
+        Name1109                Octavius
+        Name1110                Odell
+        Name1111                Odin
+        Name1112                Odion
+        Name1113                Odon
+        Name1114                Ogden
+        Name1115                Olaf
+        Name1116                Olin
+        Name1117                Oliver
+        Name1118                Omar
+        Name1119                Ordano
+        Name1120                Oren
+        Name1121                Orion
+        Name1122                Orman
+        Name1123                Ormand
+        Name1124                Orrin
+        Name1125                Orson
+        Name1126                Orville
+        Name1127                Oscar
+        Name1128                Osgood
+        Name1129                Osmond
+        Name1130                Otis
+        Name1131                Otto
+        Name1132                Owen
+        Name1133                Paco
+        Name1134                Palmer
+        Name1135                Paolo
+        Name1136                Paris
+        Name1137                Parker
+        Name1138                Parnell
+        Name1139                Pascal
+        Name1140                Patamon
+        Name1141                Patrick
+        Name1142                Patterson
+        Name1143                Patton
+        Name1144                Paul
+        Name1145                Paulin
+        Name1146                Pavel
+        Name1147                Paxton
+        Name1148                Payton
+        Name1149                Pearce
+        Name1150                Peder
+        Name1151                Pembroke
+        Name1152                Penn
+        Name1153                Percival
+        Name1154                Perry
+        Name1155                Peter
+        Name1156                Peyton
+        Name1157                Phearcy
+        Name1158                Philip
+        Name1159                Phillip
+        Name1160                Phillippe
+        Name1161                Phoenix
+        Name1162                Pierce
+        Name1163                Pierre
+        Name1164                Pierson
+        Name1165                Pilan
+        Name1166                Platon
+        Name1167                Porter
+        Name1168                Prentice
+        Name1169                Prescot
+        Name1170                Prescott
+        Name1171                Preston
+        Name1172                Quentin
+        Name1173                Quenton
+        Name1174                Quillan
+        Name1175                Quincy
+        Name1176                Quinlan
+        Name1177                Quinn
+        Name1178                Rad
+        Name1179                Radcliffe
+        Name1180                Radman
+        Name1181                Rafael
+        Name1182                Rafferty
+        Name1183                Ragnar
+        Name1184                Raidon
+        Name1185                Raleigh
+        Name1186                Ralph
+        Name1187                Ramiro
+        Name1188                Ramon
+        Name1189                Ramsay
+        Name1190                Ramsey
+        Name1191                Ranard
+        Name1192                Rance
+        Name1193                Randall
+        Name1194                Randolph
+        Name1195                Ranen
+        Name1196                Ranger
+        Name1197                Rankin
+        Name1198                Raoul
+        Name1199                Raphael
+        Name1200                Raul
+        Name1201                Ravi
+        Name1202                Ravi
+        Name1203                Ravid
+        Name1204                Ray
+        Name1205                Raymond
+        Name1206                Raynor
+        Name1207                Reade
+        Name1208                Redford
+        Name1209                Redmond
+        Name1210                Reed
+        Name1211                Reese
+        Name1212                Reeve
+        Name1213                Regan
+        Name1214                Reginald
+        Name1215                Regis
+        Name1216                Remington
+        Name1217                Remington
+        Name1218                Renaldo
+        Name1219                Rendor
+        Name1220                Renfry
+        Name1221                Renny
+        Name1222                Reuben
+        Name1223                Rex
+        Name1224                Reyhan
+        Name1225                Rhett
+        Name1226                Rhett
+        Name1227                Rhys
+        Name1228                Ricardo
+        Name1229                Richard
+        Name1230                Richter
+        Name1231                Rico
+        Name1232                Rider
+        Name1233                Ridgley
+        Name1234                Rigby
+        Name1235                Riley
+        Name1236                Rimon
+        Name1237                Ringo
+        Name1238                Ringo
+        Name1239                Riodan
+        Name1240                Riordan
+        Name1241                Roarke
+        Name1242                Robert
+        Name1243                Roberto
+        Name1244                Robi
+        Name1245                Rockwell
+        Name1246                Rod
+        Name1247                Roderick
+        Name1248                Rodman
+        Name1249                Rodney
+        Name1250                Rodrigo
+        Name1251                Roger
+        Name1252                Roi
+        Name1253                Roland
+        Name1254                Roldan
+        Name1255                Rolf
+        Name1256                Ronald
+        Name1257                Ronan
+        Name1258                Rooney
+        Name1259                Rory
+        Name1260                Roscoe
+        Name1261                Ross
+        Name1262                Roth
+        Name1263                Rowan
+        Name1264                Rowland
+        Name1265                Roy
+        Name1266                Royce
+        Name1267                Ruben
+        Name1268                Rudd
+        Name1269                Rudi
+        Name1270                Rudyard
+        Name1271                Rufus
+        Name1272                Runako
+        Name1273                Ruskin
+        Name1274                Russ
+        Name1275                Russell
+        Name1276                Rusty
+        Name1277                Rutherford
+        Name1278                Rutledge
+        Name1279                Ryan
+        Name1280                Ryder
+        Name1281                Rylan
+        Name1282                Sahale
+        Name1283                Sahen
+        Name1284                Salim
+        Name1285                Saloman
+        Name1286                Sam
+        Name1287                Samien
+        Name1288                Sammon
+        Name1289                Samson
+        Name1290                Samuel
+        Name1291                Sanders
+        Name1292                Sandon
+        Name1293                Sandor
+        Name1294                Sanford
+        Name1295                Sargent
+        Name1296                Sarngin
+        Name1297                Sarojin
+        Name1298                Saul
+        Name1299                Saunders
+        Name1300                Sawyer
+        Name1301                Saxon
+        Name1302                Schuyler
+        Name1303                Scott
+        Name1304                Seamus
+        Name1305                Sean
+        Name1306                Sebastian
+        Name1307                Sebastien
+        Name1308                Seif
+        Name1309                Selby
+        Name1310                Senon
+        Name1311                Sergio
+        Name1312                Seth
+        Name1313                Seung
+        Name1314                Severin
+        Name1315                Sevilin
+        Name1316                Seward
+        Name1317                Seymour
+        Name1318                Shane
+        Name1319                Shawn
+        Name1320                Shea
+        Name1321                Sheffield
+        Name1322                Sheldon
+        Name1323                Shen
+        Name1324                Sheridan
+        Name1325                Sherman
+        Name1326                Sherwin
+        Name1327                Sherwood
+        Name1328                Shing
+        Name1329                Shunnar
+        Name1330                Sidney
+        Name1331                Siegfried
+        Name1332                Silas
+        Name1333                Simon
+        Name1334                Sivan
+        Name1335                Skip
+        Name1336                Skyler
+        Name1337                Slade
+        Name1338                Slade
+        Name1339                Slevin
+        Name1340                Smith
+        Name1341                Solomon
+        Name1342                Sorgan
+        Name1343                Soterios
+        Name1344                Spalding
+        Name1345                Spencer
+        Name1346                Spenser
+        Name1347                Standford
+        Name1348                Stanley
+        Name1349                Stanton
+        Name1350                Stasio
+        Name1351                Stefan
+        Name1352                Stephan
+        Name1353                Stephen
+        Name1354                Sterling
+        Name1355                Stevan
+        Name1356                Steve
+        Name1357                Steven
+        Name1358                Stewart
+        Name1359                Stoke
+        Name1360                Stoyan
+        Name1361                Strom
+        Name1362                Stuart
+        Name1363                Subrey
+        Name1364                Sulaiman
+        Name1365                Sullican
+        Name1366                Sumner
+        Name1367                Sutherland
+        Name1368                Sutton
+        Name1369                Sven
+        Name1370                Sylvester
+        Name1371                Tab
+        Name1372                Tabari
+        Name1373                Tad
+        Name1374                Tadi
+        Name1375                Tai
+        Name1376                Tajo
+        Name1377                Talbart
+        Name1378                Talbot
+        Name1379                Talman
+        Name1380                Talos
+        Name1381                Tanek
+        Name1382                Tanner
+        Name1383                Tano
+        Name1384                Taro
+        Name1385                Tate
+        Name1386                Taurin
+        Name1387                Taylor
+        Name1388                Tem
+        Name1389                Terence
+        Name1390                Terrence
+        Name1391                Terrill
+        Name1392                Terry
+        Name1393                Thaddeus
+        Name1394                Thai
+        Name1395                Thaman
+        Name1396                Thane
+        Name1397                Thanos
+        Name1398                Theobald
+        Name1399                Theodore
+        Name1400                Theron
+        Name1401                Thierry
+        Name1402                Thomas
+        Name1403                Thorpe
+        Name1404                Thurston
+        Name1405                Thurston
+        Name1406                Tibalt
+        Name1407                Tiernan
+        Name1408                Timothy
+        Name1409                Titus
+        Name1410                Tobias
+        Name1411                Toby
+        Name1412                Tod
+        Name1413                Todd
+        Name1414                Tomas
+        Name1415                Tong
+        Name1416                Tor
+        Name1417                Torin
+        Name1418                Torrance
+        Name1419                Tovi
+        Name1420                Townsend
+        Name1421                Travers
+        Name1422                Travis
+        Name1423                Tremain
+        Name1424                Tremaine
+        Name1425                Trent
+        Name1426                Trevor
+        Name1427                Trey
+        Name1428                Tristan
+        Name1429                Troy
+        Name1430                Tryon
+        Name1431                Tucker
+        Name1432                Tully
+        Name1433                Tyee
+        Name1434                Tyler
+        Name1435                Tymon
+        Name1436                Tyrone
+        Name1437                Ulysses
+        Name1438                Upton
+        Name1439                Uriah
+        Name1440                Urian
+        Name1441                Van
+        Name1442                Vance
+        Name1443                Vaughn
+        Name1444                Vern
+        Name1445                Vernon
+        Name1446                Victor
+        Name1447                Vincent
+        Name1448                Vinson
+        Name1449                Virgil
+        Name1450                Vito
+        Name1451                Vlad
+        Name1452                Vladimir
+        Name1453                Vokes
+        Name1454                Volf
+        Name1455                Wade
+        Name1456                Wagner
+        Name1457                Walden
+        Name1458                Waldo
+        Name1459                Walker
+        Name1460                Wallace
+        Name1461                Wally
+        Name1462                Walter
+        Name1463                Ward
+        Name1464                Warner
+        Name1465                Warren
+        Name1466                Watson
+        Name1467                Waylan
+        Name1468                Wayland
+        Name1469                Waylon
+        Name1470                Wayne
+        Name1471                Webb
+        Name1472                Webster
+        Name1473                Wendell
+        Name1474                Wesley
+        Name1475                Weston
+        Name1476                Weylin
+        Name1477                Whitaker
+        Name1478                Wilfen
+        Name1479                Will
+        Name1480                Willard
+        Name1481                Willem
+        Name1482                William
+        Name1483                Wilson
+        Name1484                Winston
+        Name1485                Winthrop
+        Name1486                Wlby
+        Name1487                Woody
+        Name1488                Wyatt
+        Name1489                Xavier
+        Name1490                Xenos
+        Name1491                Xerxes
+        Name1492                Ximen
+        Name1493                Yakecan
+        Name1494                Yale
+        Name1495                Yancey
+        Name1496                Yardley
+        Name1497                Yarin
+        Name1498                Yerik
+        Name1499                Yero
+        Name1500                Yervant
+        Name1501                York
+        Name1502                Yusuf
+        Name1503                Yves
+        Name1504                Zachariah
+        Name1505                Zachary
+        Name1506                Zackery
+        Name1507                Zaid
+        Name1508                Zaide
+        Name1509                Zane
+        Name1510                Zaniel
+        Name1511                Zann
+        Name1512                Zared
+        Name1513                Zarek
+        Name1514                Zeke
+        Name1515                Zenon
+        Name1516                Zion
+        Name1517                Ziven
+        Name1518                Zorn
+}
+
+Names FEMALE
+{
+        Count 2206
+        Name1           Aba
+        Name2           Abby
+        Name3           Abella
+        Name4           Abey
+        Name5           Abigail
+        Name6           Abina
+        Name7           Abiona
+        Name8           Abira
+        Name9           Abra
+        Name10          Abrah
+        Name11          Absinthe
+        Name12          Acacia
+        Name13          Acanit
+        Name14          Acantha
+        Name15          Accalia
+        Name16          Acelin
+        Name17          Achen
+        Name18          Ada
+        Name19          Adalia
+        Name20          Adamina
+        Name21          Adara
+        Name22          Addi
+        Name23          Adelaide
+        Name24          Adele
+        Name25          Adelia
+        Name26          Adeline
+        Name27          Adelle
+        Name28          Adena
+        Name29          Aderes
+        Name30          Adesina
+        Name31          Adie
+        Name32          Aditi
+        Name33          Adiva
+        Name34          Adoncia
+        Name35          Adonia
+        Name36          Adora
+        Name37          Adrienne
+        Name38          Aelina
+        Name39          Afina
+        Name40          Afra
+        Name41          Afrika
+        Name42          Afton
+        Name43          Agate
+        Name44          Agatha
+        Name45          Agnes
+        Name46          Ahara
+        Name47          Ahava
+        Name48          Ahimsa
+        Name49          Aida
+        Name50          Aiella
+        Name51          Aiko
+        Name52          Aila
+        Name53          Aileen
+        Name54          Ailsa
+        Name55          Aimee
+        Name56          Ain
+        Name57          Aina
+        Name58          Aine
+        Name59          Ainhoa
+        Name60          Ainsley
+        Name61          Aintzane
+        Name62          Airlia
+        Name63          Aisling
+        Name64          Aislinn
+        Name65          Aithne
+        Name66          Aiyana
+        Name67          Ajara
+        Name68          Ajay
+        Name69          Ajinora
+        Name70          Akako
+        Name71          Akala
+        Name72          Akanke
+        Name73          Akasma
+        Name74          Akela
+        Name75          Akilah
+        Name76          Akili
+        Name77          Akilina
+        Name78          Akina
+        Name79          Alaina
+        Name80          Alake
+        Name81          Alala
+        Name82          Alamanda
+        Name83          Alana
+        Name84          Alani
+        Name85          Alanna
+        Name86          Alaqua
+        Name87          Alavda
+        Name88          Alazne
+        Name89          Alberta
+        Name90          Albinka
+        Name91          Alcina
+        Name92          Aldea
+        Name93          Aldercy
+        Name94          Aleka
+        Name95          Alenne
+        Name96          Alesia
+        Name97          Alessa
+        Name98          Alethea
+        Name99          Alexa
+        Name100         Alexandra
+        Name101         Alexandria
+        Name102         Alexandrina
+        Name103         Alexis
+        Name104         Alexis
+        Name105         Ali
+        Name106         Alia
+        Name107         Alice
+        Name108         Alicia
+        Name109         Alida
+        Name110         Alidia
+        Name111         Alike
+        Name112         Alima
+        Name113         Alina
+        Name114         Alison
+        Name115         Alita
+        Name116         Alix
+        Name117         Aliz
+        Name118         Aliza
+        Name119         Allegra
+        Name120         Allele
+        Name121         Allinora
+        Name122         Allison
+        Name123         Allyn
+        Name124         Alma
+        Name125         Alodie
+        Name126         Aloysia
+        Name127         Altair
+        Name128         Althea
+        Name129         Alula
+        Name130         Alumit
+        Name131         Alvina
+        Name132         Alvita
+        Name133         Alysa
+        Name134         Alyssa
+        Name135         Alyssand
+        Name136         Alzena
+        Name137         Ama
+        Name138         Amabel
+        Name139         Amadi
+        Name140         Amadika
+        Name141         Amadis
+        Name142         Amaia
+        Name143         Amala
+        Name144         Amalia
+        Name145         Amanda
+        Name146         Amandine
+        Name147         Amara
+        Name148         Amarande
+        Name149         Amarante
+        Name150         Amaris
+        Name151         Amata
+        Name152         Ambar
+        Name153         Amber
+        Name154         Ambika
+        Name155         Amdis
+        Name156         Ameerah
+        Name157         Amelia
+        Name158         Amelina
+        Name159         Amethyst
+        Name160         Amie
+        Name161         Amiella
+        Name162         Amina
+        Name163         Aminta
+        Name164         Amira
+        Name165         Amissa
+        Name166         Amity
+        Name167         Amoke
+        Name168         Amy
+        Name169         An
+        Name170         Ana
+        Name171         Anana
+        Name172         Ananda
+        Name173         Anastasia
+        Name174         Ancelin
+        Name175         Andi
+        Name176         Andra
+        Name177         Andraianna
+        Name178         Andras
+        Name179         Andrea
+        Name180         Andreana
+        Name181         Andromeda
+        Name182         Aneida
+        Name183         Anella
+        Name184         Anemone
+        Name185         Anezka
+        Name186         Angela
+        Name187         Angelica
+        Name188         Angeline
+        Name189         Angelique
+        Name190         Angeni
+        Name191         Ani
+        Name192         Anica
+        Name193         Anieli
+        Name194         Anisa
+        Name195         Anita
+        Name196         Anke
+        Name197         Ann
+        Name198         Anna
+        Name199         Annabel
+        Name200         Annabelle
+        Name201         Annamarie
+        Name202         Anne
+        Name203         Annette
+        Name204         Annikka
+        Name205         Annora
+        Name206         Anorah
+        Name207         Anoush
+        Name208         Anteia
+        Name209         Anthea
+        Name210         Antje
+        Name211         Antoinette
+        Name212         Antonia
+        Name213         Aolani
+        Name214         Apara
+        Name215         Apirka
+        Name216         Apolline
+        Name217         Apollonia
+        Name218         Aponi
+        Name219         April
+        Name220         Aprille
+        Name221         Aqua
+        Name222         Aquene
+        Name223         Ara
+        Name224         Arabella
+        Name225         Arabelle
+        Name226         Araceli
+        Name227         Araminta
+        Name228         Araxie
+        Name229         Arcadia
+        Name230         Ardath
+        Name231         Ardelia
+        Name232         Arden
+        Name233         Ardis
+        Name234         Ardith
+        Name235         Areiela
+        Name236         Arella
+        Name237         Aretha
+        Name238         Aretina
+        Name239         Ariadne
+        Name240         Ariana
+        Name241         Aricia
+        Name242         Ariel
+        Name243         Ariene
+        Name244         Arista
+        Name245         Arlene
+        Name246         Arlinda
+        Name247         Armina
+        Name248         Arminda
+        Name249         Artemisia
+        Name250         Aruna
+        Name251         Arziki
+        Name252         Asaria
+        Name253         Asenka
+        Name254         Ash
+        Name255         Asha
+        Name256         Ashlan
+        Name257         Ashleigh
+        Name258         Ashley
+        Name259         Asia
+        Name260         Asisa
+        Name261         Aslinda
+        Name262         Aspasia
+        Name263         Asta
+        Name264         Aster
+        Name265         Astera
+        Name266         Astra
+        Name267         Astrea
+        Name268         Astrid
+        Name269         Atalanta
+        Name270         Atara
+        Name271         Atenne
+        Name272         Ateri
+        Name273         Athalia
+        Name274         Athara
+        Name275         Athena
+        Name276         Athene
+        Name277         Athla
+        Name278         Atifa
+        Name279         Atta
+        Name280         Aubrey
+        Name281         Auda
+        Name282         Audny
+        Name283         Audrey
+        Name284         Audrianna
+        Name285         Audun
+        Name286         Augustina
+        Name287         Aura
+        Name288         Aure
+        Name289         Aurelia
+        Name290         Aurilia
+        Name291         Aurina
+        Name292         Aurkene
+        Name293         Aurora
+        Name294         Autumn
+        Name295         Ava
+        Name296         Avana
+        Name297         Avasa
+        Name298         Avella
+        Name299         Avena
+        Name300         Avie
+        Name301         Avis
+        Name302         Aviva
+        Name303         Axella
+        Name304         Aya
+        Name305         Ayaluna
+        Name306         Ayame
+        Name307         Ayana
+        Name308         Ayasha
+        Name309         Ayda
+        Name310         Aydee
+        Name311         Ayela
+        Name312         Ayiana
+        Name313         Ayila
+        Name314         Ayisha
+        Name315         Ayita
+        Name316         Ayla
+        Name317         Aynora
+        Name318         Ayuna
+        Name319         Azaleah
+        Name320         Azalia
+        Name321         Azarael
+        Name322         Azeline
+        Name323         Azera
+        Name324         Azha
+        Name325         Azilea
+        Name326         Azina
+        Name327         Azize
+        Name328         Azora
+        Name329         Azura
+        Name330         Babette
+        Name331         Bacia
+        Name332         Baka
+        Name333         Bakarne
+        Name334         Balayna
+        Name335         Balia
+        Name336         Bambi
+        Name337         Banan
+        Name338         Banella
+        Name339         Bara
+        Name340         Barakah
+        Name341         Barbara
+        Name342         Barika
+        Name343         Basha
+        Name344         Basia
+        Name345         Basimah
+        Name346         Bathsheba
+        Name347         Batya
+        Name348         Bay
+        Name349         Bayana
+        Name350         Baylea
+        Name351         Bayo
+        Name352         Bayta
+        Name353         Bea
+        Name354         Beatrice
+        Name355         Beatrix
+        Name356         Beauvina
+        Name357         Becca
+        Name358         Becky
+        Name359         Bedelia
+        Name360         Bel
+        Name361         Belana
+        Name362         Belina
+        Name363         Belinda
+        Name364         Belita
+        Name365         Bella
+        Name366         Bellanca
+        Name367         Belle
+        Name368         Belora
+        Name369         Bente
+        Name370         Beradine
+        Name371         Berilla
+        Name372         Berit
+        Name373         Bernadette
+        Name374         Bernice
+        Name375         Beryl
+        Name376         Bess
+        Name377         Bessine
+        Name378         Beta
+        Name379         Beth
+        Name380         Bethana
+        Name381         Bethany
+        Name382         Betony
+        Name383         Bette
+        Name384         Betty
+        Name385         Beulah
+        Name386         Beverlea
+        Name387         Beverly
+        Name388         Bevin
+        Name389         Bian
+        Name390         Bianca
+        Name391         Billie
+        Name392         Bina
+        Name393         Bindy
+        Name394         Binti
+        Name395         Birdie
+        Name396         Birget
+        Name397         Birkita
+        Name398         Bixenta
+        Name399         Blanche
+        Name400         Blanda
+        Name401         Blenda
+        Name402         Bliss
+        Name403         Bly
+        Name404         Blythe
+        Name405         Bo
+        Name406         Bohdana
+        Name407         Bonamy
+        Name408         Bonita
+        Name409         Bonnie
+        Name410         Bonny
+        Name411         Borgny
+        Name412         Brandi
+        Name413         Brandy
+        Name414         Bren
+        Name415         Brenda
+        Name416         Brenna
+        Name417         Bretta
+        Name418         Briana
+        Name419         Bridget
+        Name420         Brie
+        Name421         Brier
+        Name422         Brietta
+        Name423         Brigit
+        Name424         Brigitte
+        Name425         Brina
+        Name426         Briona
+        Name427         Briony
+        Name428         Brites
+        Name429         Britta
+        Name430         Brittany
+        Name431         Bronwyn
+        Name432         Brooke
+        Name433         Brynn
+        Name434         Bucia
+        Name435         Cadence
+        Name436         Cai
+        Name437         Caimile
+        Name438         Caitlin
+        Name439         Caitrin
+        Name440         Cala
+        Name441         Calandia
+        Name442         Calandra
+        Name443         Calantha
+        Name444         Caledonia
+        Name445         Caley
+        Name446         Calida
+        Name447         Calista
+        Name448         Calla
+        Name449         Callan
+        Name450         Callia
+        Name451         Callidora
+        Name452         Callie
+        Name453         Calliope
+        Name454         Caltha
+        Name455         Calypso
+        Name456         Cam
+        Name457         Camelai
+        Name458         Camilia
+        Name459         Camilla
+        Name460         Camille
+        Name461         Canace
+        Name462         Candace
+        Name463         Candice
+        Name464         Candida
+        Name465         Candide
+        Name466         Candra
+        Name467         Candra
+        Name468         Cantara
+        Name469         Caoimhe
+        Name470         Capri
+        Name471         Caprice
+        Name472         Cara
+        Name473         Caradoc
+        Name474         Caresse
+        Name475         Cari
+        Name476         Carina
+        Name477         Carine
+        Name478         Carissa
+        Name479         Carita
+        Name480         Carla
+        Name481         Carleen
+        Name482         Carlen
+        Name483         Carling
+        Name484         Carlota
+        Name485         Carlotta
+        Name486         Carly
+        Name487         Carma
+        Name488         Carmel
+        Name489         Carmela
+        Name490         Carmelina
+        Name491         Carmelita
+        Name492         Carmen
+        Name493         Carna
+        Name494         Carnelian
+        Name495         Carol
+        Name496         Carolina
+        Name497         Caroline
+        Name498         Carolyn
+        Name499         Caron
+        Name500         Carrie
+        Name501         Caryn
+        Name502         Casey
+        Name503         Casilda
+        Name504         Cassandra
+        Name505         Cassia
+        Name506         Cassiel
+        Name507         Casta
+        Name508         Castalia
+        Name509         Catalin
+        Name510         Catalina
+        Name511         Catava
+        Name512         Caterina
+        Name513         Catherine
+        Name514         Cathleen
+        Name515         Cathy
+        Name516         Catriona
+        Name517         Cayla
+        Name518         Ceara
+        Name519         Cecania
+        Name520         Cecilia
+        Name521         Celandine
+        Name522         Celeste
+        Name523         Celia
+        Name524         Celina
+        Name525         Cellia
+        Name526         Cerelia
+        Name527         Chaitra
+        Name528         Chanah
+        Name529         Chanda
+        Name530         Chandi
+        Name531         Chandra
+        Name532         Chandra
+        Name533         Chane
+        Name534         Chanel
+        Name535         Channa
+        Name536         Chantal
+        Name537         Charis
+        Name538         Charissa
+        Name539         Charity
+        Name540         Charlotte
+        Name541         Charmaine
+        Name542         Charmian
+        Name543         Chastity
+        Name544         Chava
+        Name545         Chavi
+        Name546         Chaviva
+        Name547         Chay
+        Name548         Chaya
+        Name549         Chelsea
+        Name550         Chenoa
+        Name551         Cherice
+        Name552         Cherie
+        Name553         Cherise
+        Name554         Cheryl
+        Name555         Chesna
+        Name556         Chiara
+        Name557         Chika
+        Name558         Chilali
+        Name559         Chimalis
+        Name560         Chipo
+        Name561         Chloe
+        Name562         Chloris
+        Name563         Cho
+        Name564         Christa
+        Name565         Christable
+        Name566         Christina
+        Name567         Christine
+        Name568         Christy
+        Name569         Chyou
+        Name570         Ciannait
+        Name571         Ciar
+        Name572         Cicely
+        Name573         Cindy
+        Name574         Claire
+        Name575         Clara
+        Name576         Clarinda
+        Name577         Clarissa
+        Name578         Claudette
+        Name579         Claudia
+        Name580         Claudine
+        Name581         Clementina
+        Name582         Clementine
+        Name583         Cleo
+        Name584         Cliantha
+        Name585         Clio
+        Name586         Clorinda
+        Name587         Clover
+        Name588         Cochiti
+        Name589         Coleen
+        Name590         Colette
+        Name591         Colleen
+        Name592         Connie
+        Name593         Constance
+        Name594         Constanza
+        Name595         Consuela
+        Name596         Cora
+        Name597         Coralie
+        Name598         Corazon
+        Name599         Corbey
+        Name600         Cordelia
+        Name601         Coretta
+        Name602         Cori
+        Name603         Corinna
+        Name604         Coris
+        Name605         Corliss
+        Name606         Cornelia
+        Name607         Corrine
+        Name608         Courtney
+        Name609         Crescent
+        Name610         Cressida
+        Name611         Crystal
+        Name612         Cybele
+        Name613         Cybil
+        Name614         Cynara
+        Name615         Cynthia
+        Name616         Cyprien
+        Name617         Cyrene
+        Name618         Cyrilla
+        Name619         Cytheria
+        Name620         Dabria
+        Name621         Dacey
+        Name622         Dacia
+        Name623         Dacio
+        Name624         Dae
+        Name625         Dagmar
+        Name626         Dagna
+        Name627         Dagny
+        Name628         Dahlia
+        Name629         Dai
+        Name630         Daily
+        Name631         Daisel
+        Name632         Daisy
+        Name633         Dakota
+        Name634         Dale
+        Name635         Dalila
+        Name636         Dalilia
+        Name637         Damalis
+        Name638         Damara
+        Name639         Damaris
+        Name640         Damita
+        Name641         Dana
+        Name642         Danett
+        Name643         Dania
+        Name644         Danica
+        Name645         Daniella
+        Name646         Danielle
+        Name647         Danyelle
+        Name648         Daphene
+        Name649         Daphne
+        Name650         Daphnie
+        Name651         Dar
+        Name652         Dara
+        Name653         Daralis
+        Name654         Darby
+        Name655         Darcie
+        Name656         Darcy
+        Name657         Daria
+        Name658         Darla
+        Name659         Darlene
+        Name660         Dasha
+        Name661         Davine
+        Name662         Davita
+        Name663         Dawn
+        Name664         Daya
+        Name665         Dayna
+        Name666         Deandra
+        Name667         Deanna
+        Name668         Deanne
+        Name669         Deb
+        Name670         Deborah
+        Name671         Debra
+        Name672         Dede
+        Name673         Dedra
+        Name674         Dee
+        Name675         Deedee
+        Name676         Deianira
+        Name677         Deiene
+        Name678         Deirdre
+        Name679         Delana
+        Name680         Delaney
+        Name681         Delbin
+        Name682         Delia
+        Name683         Delicia
+        Name684         Delilah
+        Name685         Della
+        Name686         Delphine
+        Name687         Dembe
+        Name688         Demi
+        Name689         Demitria
+        Name690         Dena
+        Name691         Denby
+        Name692         Denise
+        Name693         Desa
+        Name694         Desdemona
+        Name695         Desiree
+        Name696         Deva
+        Name697         Devaki
+        Name698         Deval
+        Name699         Devi
+        Name700         Devin
+        Name701         Devnet
+        Name702         Devon
+        Name703         Diamanta
+        Name704         Diana
+        Name705         Diane
+        Name706         Dianthe
+        Name707         Diedre
+        Name708         Diella
+        Name709         Dillian
+        Name710         Dilys
+        Name711         Dinah
+        Name712         Dionne
+        Name713         Dirdre
+        Name714         Disa
+        Name715         Dita
+        Name716         Dixie
+        Name717         Dodie
+        Name718         Dolly
+        Name719         Dolores
+        Name720         Dominique
+        Name721         Dona
+        Name722         Donata
+        Name723         Donielle
+        Name724         Donna
+        Name725         Donner
+        Name726         Dooriya
+        Name727         Dophina
+        Name728         Dora
+        Name729         Doreen
+        Name730         Dorinda
+        Name731         Doris
+        Name732         Dorothea
+        Name733         Dorothy
+        Name734         Dory
+        Name735         Drew
+        Name736         Drina
+        Name737         Drucilla
+        Name738         Dulcie
+        Name739         Dulcinea
+        Name740         Dusty
+        Name741         Dyan
+        Name742         Dyani
+        Name743         Dymphna
+        Name744         Dyna
+        Name745         Eartha
+        Name746         Easter
+        Name747         Ebony
+        Name748         Echo
+        Name749         Edana
+        Name750         Eden
+        Name751         Edie
+        Name752         Edith
+        Name753         Edlyn
+        Name754         Edna
+        Name755         Edna
+        Name756         Edolie
+        Name757         Edria
+        Name758         Edwina
+        Name759         Efia
+        Name760         Eileen
+        Name761         Eirene
+        Name762         Elaine
+        Name763         Elana
+        Name764         Eleanor
+        Name765         Elena
+        Name766         Eleora
+        Name767         Elina
+        Name768         Elisa
+        Name769         Elise
+        Name770         Eliska
+        Name771         Elissa
+        Name772         Elita
+        Name773         Eliza
+        Name774         Elizabeth
+        Name775         Elke
+        Name776         Ella
+        Name777         Elle
+        Name778         Ellen
+        Name779         Elly
+        Name780         Elodie
+        Name781         Eloise
+        Name782         Elsa
+        Name783         Else
+        Name784         Elsie
+        Name785         Elynor
+        Name786         Elyse
+        Name787         Elysia
+        Name788         Ema
+        Name789         Emajane
+        Name790         Emalia
+        Name791         Ember
+        Name792         Emelie
+        Name793         Emelyne
+        Name794         Emily
+        Name795         Emma
+        Name796         Endora
+        Name797         Engracia
+        Name798         Enid
+        Name799         Enola
+        Name800         Enye
+        Name801         Eranthe
+        Name802         Erasma
+        Name803         Erianthe
+        Name804         Erica
+        Name805         Erika
+        Name806         Erin
+        Name807         Erlina
+        Name808         Erwand
+        Name809         Eskarne
+        Name810         Esmerelda
+        Name811         Esperanza
+        Name812         Esta
+        Name813         Estelle
+        Name814         Esther
+        Name815         Etain
+        Name816         Etania
+        Name817         Etsu
+        Name818         Etta
+        Name819         Eudocia
+        Name820         Eugenia
+        Name821         Eulalia
+        Name822         Eustacia
+        Name823         Eva
+        Name824         Evacsa
+        Name825         Evadine
+        Name826         Evadne
+        Name827         Evangeline
+        Name828         Evanthe
+        Name829         Eve
+        Name830         Evelyn
+        Name831         Evita
+        Name832         Evonne
+        Name833         Eyota
+        Name834         Fabienne        
+        Name835         Fainche 
+        Name836         Fairuza 
+        Name837         Faith   
+        Name838         Faizah  
+        Name839         Fallon
+        Name840         Fantine
+        Name841         Farha
+        Name842         Farrah
+        Name843         Fatima
+        Name844         Fatin
+        Name845         Fawne
+        Name846         Fay
+        Name847         Faye
+        Name848         Fayina
+        Name849         Fayme
+        Name850         Felcia
+        Name851         Felicia
+        Name852         Felicite
+        Name853         Felicity
+        Name854         Femi
+        Name855         Feridwyn
+        Name856         Fern
+        Name857         Feronia
+        Name858         Filinda
+        Name859         Fina
+        Name860         Finola
+        Name861         Fiona
+        Name862         Fiorenza
+        Name863         Flavia
+        Name864         Fleta
+        Name865         Flora
+        Name866         Florence
+        Name867         Frances
+        Name868         Francesca
+        Name869         Francine
+        Name870         Francisca
+        Name871         Freda
+        Name872         Frederica
+        Name873         Freya
+        Name874         Frida
+        Name875         Frieda
+        Name876         Fuscienne
+        Name877         Gabriella
+        Name878         Gabrielle
+        Name879         Gaia
+        Name880         Gail
+        Name881         Gala
+        Name882         Galatea
+        Name883         Gali
+        Name884         Galina
+        Name885         Galya
+        Name886         Gana
+        Name887         Ganesa
+        Name888         Gauri
+        Name889         Gaye
+        Name890         Gayle
+        Name891         Gelasia
+        Name892         Gemma
+        Name893         Genevieve
+        Name894         Geogia
+        Name895         Georgeanne
+        Name896         Georgetta
+        Name897         Georgette
+        Name898         Georgiana
+        Name899         Geradline
+        Name900         Geraldine
+        Name901         Gerda
+        Name902         Gerri
+        Name903         Gertrude
+        Name904         Geva
+        Name905         Ghislaine
+        Name906         Giacinta
+        Name907         Gianina
+        Name908         Gigi
+        Name909         Gilana
+        Name910         Gilda
+        Name911         Gilen
+        Name912         Gillian
+        Name913         Gin
+        Name914         Gina
+        Name915         Ginger
+        Name916         Giselle
+        Name917         Gitana
+        Name918         Githa
+        Name919         Gizane
+        Name920         Gleda
+        Name921         Glenna
+        Name922         Glennys
+        Name923         Gloria
+        Name924         Golda
+        Name925         Goldie
+        Name926         Gotzone
+        Name927         Grace
+        Name928         Gracie
+        Name929         Grainne
+        Name930         Grazia
+        Name931         Grear
+        Name932         Greta
+        Name933         Gretchen
+        Name934         Grette
+        Name935         Gwen
+        Name936         Gwendolyn
+        Name937         Gweneth
+        Name938         Gwynne
+        Name939         Gytha
+        Name940         Hadara
+        Name941         Hadassa
+        Name942         Hadiya
+        Name943         Haidee
+        Name944         Hailey
+        Name945         Haimi
+        Name946         Haldis
+        Name947         Hale
+        Name948         Haley
+        Name949         Hali
+        Name950         Hali
+        Name951         Halima
+        Name952         Halle
+        Name953         Hallie
+        Name954         Hana
+        Name955         Hanan
+        Name956         Hannah
+        Name957         Hanne
+        Name958         Harmoni
+        Name959         Harriet
+        Name960         Hasna
+        Name961         Hava
+        Name962         Haya
+        Name963         Haylee
+        Name964         Hazel
+        Name965         Hea
+        Name966         Heather
+        Name967         Hei
+        Name968         Heidi
+        Name969         Heldegarde
+        Name970         Helen
+        Name971         Helena
+        Name972         Helene
+        Name973         Helki
+        Name974         Henka
+        Name975         Henrietta
+        Name976         Hesper
+        Name977         Hester
+        Name978         Hilary
+        Name979         Hilda
+        Name980         Hinda
+        Name981         Hisa
+        Name982         Holly
+        Name983         Hope
+        Name984         Hoshi
+        Name985         Huyana
+        Name986         Hyacinth
+        Name987         Hye
+        Name988         Hypatia
+        Name989         Ianthe
+        Name990         Ida
+        Name991         Idola
+        Name992         Idonia
+        Name993         Ilene
+        Name994         Ilona
+        Name995         Iman
+        Name996         Imogene
+        Name997         India
+        Name998         Indira
+        Name999         Indra
+        Name1000                Ines
+        Name1001                Inez
+        Name1002                Inga
+        Name1003                Ingrid
+        Name1004                Iolana
+        Name1005                Iolanthe
+        Name1006                Iona
+        Name1007                Iratze
+        Name1008                Irena
+        Name1009                Irene
+        Name1010                Iris
+        Name1011                Irma
+        Name1012                Isabeau
+        Name1013                Isabel
+        Name1014                Isabella
+        Name1015                Isadora
+        Name1016                Isaura
+        Name1017                Isis
+        Name1018                Isleta
+        Name1019                Isobel
+        Name1020                Isoke
+        Name1021                Istas
+        Name1022                Ivana
+        Name1023                Ivory
+        Name1024                Ivy
+        Name1025                Jacelyn
+        Name1026                Jacinda
+        Name1027                Jacinthe
+        Name1028                Jacqueline
+        Name1029                Jada
+        Name1030                Jael
+        Name1031                Jaen
+        Name1032                Jaimie
+        Name1033                Jaione
+        Name1034                Jakinda
+        Name1035                Jala
+        Name1036                Jamie
+        Name1037                Jamila
+        Name1038                Jamilah
+        Name1039                Jan
+        Name1040                Jana
+        Name1041                Jane
+        Name1042                Janelle
+        Name1043                Janet
+        Name1044                Janice
+        Name1045                Janis
+        Name1046                Janna
+        Name1047                Jannelle
+        Name1048                Jardena
+        Name1049                Jarvia
+        Name1050                Jarvinia
+        Name1051                Jasmine
+        Name1052                Jaya
+        Name1053                Jayne
+        Name1054                Jean
+        Name1055                Jean
+        Name1056                Jeanette
+        Name1057                Jeanine
+        Name1058                Jelena
+        Name1059                Jena
+        Name1060                Jenay
+        Name1061                Jendayi
+        Name1062                Jendyose
+        Name1063                Jenica
+        Name1064                Jennettia
+        Name1065                Jennifer
+        Name1066                Jensine
+        Name1067                Jerrilyn
+        Name1068                Jessamine
+        Name1069                Jessica
+        Name1070                Jewel
+        Name1071                Jezebel
+        Name1072                Jihan
+        Name1073                Jillian
+        Name1074                Jin
+        Name1075                Jina
+        Name1076                Jinny
+        Name1077                Jinx
+        Name1078                Joakima
+        Name1079                Joan
+        Name1080                Joanne
+        Name1081                Jobey
+        Name1082                Jobihna
+        Name1083                Jocasa
+        Name1084                Jocelyn
+        Name1085                Jodi
+        Name1086                Jody
+        Name1087                Joelle
+        Name1088                Joelliane
+        Name1089                Johanna
+        Name1090                Joia
+        Name1091                Jolan
+        Name1092                Jolanta
+        Name1093                Jolene
+        Name1094                Jolie
+        Name1095                Joline
+        Name1096                Jonina
+        Name1097                Jora
+        Name1098                Jordane
+        Name1099                Josephine
+        Name1100                Josie
+        Name1101                Jotha
+        Name1102                Joy
+        Name1103                Joyce
+        Name1104                Joye
+        Name1105                Juanita
+        Name1106                Judith
+        Name1107                Juditha
+        Name1108                Julia
+        Name1109                Juliana
+        Name1110                Juliane
+        Name1111                Julie
+        Name1112                Julietta
+        Name1113                Julinka
+        Name1114                Julita
+        Name1115                Jumoke
+        Name1116                Jun
+        Name1117                June
+        Name1118                Justine
+        Name1119                Kaatje
+        Name1120                Kachine
+        Name1121                Kaclyn
+        Name1122                Kaede
+        Name1123                Kaethe
+        Name1124                Kai
+        Name1125                Kaia
+        Name1126                Kaie
+        Name1127                Kaili
+        Name1128                Kaimi
+        Name1129                Kairos
+        Name1130                Kaiya
+        Name1131                Kakra
+        Name1132                Kala
+        Name1133                Kalama
+        Name1134                Kalanit
+        Name1135                Kalare
+        Name1136                Kalea
+        Name1137                Kali
+        Name1138                Kalika
+        Name1139                Kalila
+        Name1140                Kalinda
+        Name1141                Kalle
+        Name1142                Kalli
+        Name1143                Kalonice
+        Name1144                Kalyca
+        Name1145                Kama
+        Name1146                Kamala
+        Name1147                Kamali
+        Name1148                Kamaria
+        Name1149                Kambo
+        Name1150                Kameko
+        Name1151                Kamilah
+        Name1152                Kamilia
+        Name1153                Kanda
+        Name1154                Kane
+        Name1155                Kanene
+        Name1156                Kanika
+        Name1157                Kantha
+        Name1158                Kanya
+        Name1159                Kapera
+        Name1160                Kara
+        Name1161                Karan
+        Name1162                Karayan
+        Name1163                Karel
+        Name1164                Karen
+        Name1165                Karida
+        Name1166                Karimah
+        Name1167                Karisa
+        Name1168                Karka
+        Name1169                Karla
+        Name1170                Karlenne
+        Name1171                Karli
+        Name1172                Karlyn
+        Name1173                Karmina
+        Name1174                Karol
+        Name1175                Karylin
+        Name1176                Karyn
+        Name1177                Kasa
+        Name1178                Kasen
+        Name1179                Kasia
+        Name1180                Kasinda
+        Name1181                Kassia
+        Name1182                Kate
+        Name1183                Katherine
+        Name1184                Kathleen
+        Name1185                Katie
+        Name1186                Katja
+        Name1187                Katoka
+        Name1188                Katrien
+        Name1189                Katrina
+        Name1190                Kaula
+        Name1191                Kaveri
+        Name1192                Kavindra
+        Name1193                Kay
+        Name1194                Kaya
+        Name1195                Kaye
+        Name1196                Kayla
+        Name1197                Kaysa
+        Name1198                Kazia
+        Name1199                Keara
+        Name1200                Keelin
+        Name1201                Keely
+        Name1202                Kefira
+        Name1203                Kehinde
+        Name1204                Kei
+        Name1205                Keiko
+        Name1206                Keisha
+        Name1207                Kekona
+        Name1208                Kelda
+        Name1209                Kelia
+        Name1210                Kelley
+        Name1211                Kelli
+        Name1212                Kellie
+        Name1213                Kelly
+        Name1214                Kelsey
+        Name1215                Kendra
+        Name1216                Kennis
+        Name1217                Kenyangi
+        Name1218                Kepa
+        Name1219                Kerani
+        Name1220                Kerensa
+        Name1221                Kerstan
+        Name1222                Kesare
+        Name1223                Kesi
+        Name1224                Kesia
+        Name1225                Kessie
+        Name1226                Keturah
+        Name1227                Ketzia
+        Name1228                Khalida
+        Name1229                Kichi
+        Name1230                Kiele
+        Name1231                Kim
+        Name1232                Kimberly
+        Name1233                Kimmie
+        Name1234                Kimmy
+        Name1235                Kineta
+        Name1236                Kiona
+        Name1237                Kira
+        Name1238                Kiran
+        Name1239                Kirby
+        Name1240                Kirima
+        Name1241                Kirsten
+        Name1242                Kirti
+        Name1243                Kisa
+        Name1244                Kiska
+        Name1245                Kismet
+        Name1246                Kissa
+        Name1247                Kita
+        Name1248                Kohana
+        Name1249                Koko
+        Name1250                Kolina
+        Name1251                Koren
+        Name1252                Koressa
+        Name1253                Kristen
+        Name1254                Kyly
+        Name1255                Kyna
+        Name1256                Kynthia
+        Name1257                Kyoko
+        Name1258                Lacey
+        Name1259                Lacie
+        Name1260                Laila
+        Name1261                Lailie
+        Name1262                Lakeisha
+        Name1263                Lala
+        Name1264                Lalasa
+        Name1265                Lan
+        Name1266                Lana
+        Name1267                Landra
+        Name1268                Lane
+        Name1269                Lani
+        Name1270                Lara
+        Name1271                Laraine
+        Name1272                Laralee
+        Name1273                Lari
+        Name1274                Larissa
+        Name1275                Lark
+        Name1276                Latika
+        Name1277                Latonia
+        Name1278                Laura
+        Name1279                Laurana
+        Name1280                Laurel
+        Name1281                Laurie
+        Name1282                Laurinda
+        Name1283                Lauryn
+        Name1284                Laveda
+        Name1285                Lavern
+        Name1286                Laverne
+        Name1287                Lavinia
+        Name1288                Lea
+        Name1289                Leah
+        Name1290                Leah
+        Name1291                Leala
+        Name1292                Leandra
+        Name1293                Leba
+        Name1294                Ledah
+        Name1295                Lee
+        Name1296                Leigh
+        Name1297                Leiko
+        Name1298                Leila
+        Name1299                Leilana
+        Name1300                Lena
+        Name1301                Lene
+        Name1302                Lenor
+        Name1303                Lenora
+        Name1304                Lenore
+        Name1305                Leona
+        Name1306                Leora
+        Name1307                Leslie
+        Name1308                Letha
+        Name1309                Letitia
+        Name1310                Levana
+        Name1311                Lexine
+        Name1312                Lia
+        Name1313                Liadan
+        Name1314                Lian
+        Name1315                Liana
+        Name1316                Liane
+        Name1317                Libby
+        Name1318                Lien
+        Name1319                Lila
+        Name1320                Lilith
+        Name1321                Lillian
+        Name1322                Lillie
+        Name1323                Lily
+        Name1324                Limber
+        Name1325                Lina
+        Name1326                Linda
+        Name1327                Lindsay
+        Name1328                Lindsey
+        Name1329                Linette
+        Name1330                Linnae
+        Name1331                Linnea
+        Name1332                Lisa
+        Name1333                Lisette
+        Name1334                Litsa
+        Name1335                Liv
+        Name1336                Liza
+        Name1337                Lois
+        Name1338                Lokelani
+        Name1339                Lola
+        Name1340                Loni
+        Name1341                Lora
+        Name1342                Lore
+        Name1343                Lorelei
+        Name1344                Lorelle
+        Name1345                Loretta
+        Name1346                Lori
+        Name1347                Lorraine
+        Name1348                Lotus
+        Name1349                Louise
+        Name1350                Lucia
+        Name1351                Lucille
+        Name1352                Lucinda
+        Name1353                Lucine
+        Name1354                Lucretia
+        Name1355                Lucy
+        Name1356                Ludia
+        Name1357                Luela
+        Name1358                Luisa
+        Name1359                Lukene
+        Name1360                Lukina
+        Name1361                Lulu
+        Name1362                Luna
+        Name1363                Lydia
+        Name1364                Lynda
+        Name1365                Lynelle
+        Name1366                Lynn
+        Name1367                Lynnda
+        Name1368                Lynnette
+        Name1369                Lyris
+        Name1370                Lysel
+        Name1371                Lysnadra
+        Name1372                Mabel
+        Name1373                Macaria
+        Name1374                Machi
+        Name1375                Maddy
+        Name1376                Madelaine
+        Name1377                Madelina
+        Name1378                Madeline
+        Name1379                Madelon
+        Name1380                Madelyn
+        Name1381                Mady
+        Name1382                Mae
+        Name1383                Magan
+        Name1384                Magara
+        Name1385                Magdalen
+        Name1386                Magdalena
+        Name1387                Magdaline
+        Name1388                Magena
+        Name1389                Magenta
+        Name1390                Maggie
+        Name1391                Mahala
+        Name1392                Mahalia
+        Name1393                Mai
+        Name1394                Maia
+        Name1395                Maida
+        Name1396                Maisie
+        Name1397                Maitane
+        Name1398                Maizah
+        Name1399                Maj
+        Name1400                Malaya
+        Name1401                Malila
+        Name1402                Malina
+        Name1403                Malinda
+        Name1404                Malka
+        Name1405                Mallory
+        Name1406                Malu
+        Name1407                Mamie
+        Name1408                Manda
+        Name1409                Mandara
+        Name1410                Mandisa
+        Name1411                Mandy
+        Name1412                Mangena
+        Name1413                Manon
+        Name1414                Mansi
+        Name1415                Manya
+        Name1416                Mara
+        Name1417                Marcella
+        Name1418                Marcia
+        Name1419                Marcy
+        Name1420                Maren
+        Name1421                Margaret
+        Name1422                Margaret
+        Name1423                Margarita
+        Name1424                Margo
+        Name1425                Margot
+        Name1426                Marguirte
+        Name1427                Maria
+        Name1428                Mariah
+        Name1429                Mariam
+        Name1430                Mariama
+        Name1431                Marian
+        Name1432                Mariana
+        Name1433                Marianna
+        Name1434                Marianne
+        Name1435                Maribel
+        Name1436                Marie
+        Name1437                Mariel
+        Name1438                Marietta
+        Name1439                Marily
+        Name1440                Marilyn
+        Name1441                Marina
+        Name1442                Maris
+        Name1443                Marisa
+        Name1444                Marisha
+        Name1445                Marissa
+        Name1446                Marjani
+        Name1447                Marjeta
+        Name1448                Marjorie
+        Name1449                Marlene
+        Name1450                Marlo
+        Name1451                Marmara
+        Name1452                Marnie
+        Name1453                Marnina
+        Name1454                Marsha
+        Name1455                Marta
+        Name1456                Martha
+        Name1457                Marti
+        Name1458                Martina
+        Name1459                Mary
+        Name1460                Maryann
+        Name1461                Marybeth
+        Name1462                Marylou
+        Name1463                Marzia
+        Name1464                Matana
+        Name1465                Mathea
+        Name1466                Matilda
+        Name1467                Matrika
+        Name1468                Maud
+        Name1469                Maude
+        Name1470                Maura
+        Name1471                Maureen
+        Name1472                Maurita
+        Name1473                Mavis
+        Name1474                Maxine
+        Name1475                May
+        Name1476                Maya
+        Name1477                Meara
+        Name1478                Meara
+        Name1479                Meda
+        Name1480                Medea
+        Name1481                Meg
+        Name1482                Megan
+        Name1483                Megara
+        Name1484                Meghan
+        Name1485                Mei
+        Name1486                Meira
+        Name1487                Mela
+        Name1488                Melanie
+        Name1489                Melantha
+        Name1490                Melba
+        Name1491                Melia
+        Name1492                Melian
+        Name1493                Melina
+        Name1494                Melinda
+        Name1495                Melisenda
+        Name1496                Melissa
+        Name1497                Mellinio
+        Name1498                Melodie
+        Name1499                Melody
+        Name1500                Melosa
+        Name1501                Melva
+        Name1502                Mercedes
+        Name1503                Meredith
+        Name1504                Merele
+        Name1505                Mesha
+        Name1506                Meta
+        Name1507                Mia
+        Name1508                Miakoda
+        Name1509                Michaela
+        Name1510                Michele
+        Name1511                Michelle
+        Name1512                Midori
+        Name1513                Migina
+        Name1514                Mignon
+        Name1515                Mika
+        Name1516                Millicent
+        Name1517                Millie
+        Name1518                Min
+        Name1519                Mina
+        Name1520                Minda
+        Name1521                Mindel
+        Name1522                Mindy
+        Name1523                Minerva
+        Name1524                Minka
+        Name1525                Minna
+        Name1526                Minnie
+        Name1527                Mira
+        Name1528                Miranda
+        Name1529                Mirem
+        Name1530                Miremba
+        Name1531                Mireya
+        Name1532                Miriam
+        Name1533                Mirielle
+        Name1534                Missy
+        Name1535                Misty
+        Name1536                Mitena
+        Name1537                Mitexi
+        Name1538                Mitzi
+        Name1539                Miyoko
+        Name1540                Moira
+        Name1541                Mollie
+        Name1542                Molly
+        Name1543                Mona
+        Name1544                Monica
+        Name1545                Monique
+        Name1546                Moon
+        Name1547                Morena
+        Name1548                Morgan
+        Name1549                Morgana
+        Name1550                Morgance
+        Name1551                Moria
+        Name1552                Moriah
+        Name1553                Muriel
+        Name1554                Myra
+        Name1555                Nada
+        Name1556                Nadia
+        Name1557                Nadine
+        Name1558                Nadya
+        Name1559                Naia
+        Name1560                Nailah
+        Name1561                Naimah
+        Name1562                Nalini
+        Name1563                Namazzi
+        Name1564                Nami
+        Name1565                Nan
+        Name1566                Nana
+        Name1567                Nancy
+        Name1568                Nanette
+        Name1569                Nantale
+        Name1570                Naomi
+        Name1571                Napea
+        Name1572                Nara
+        Name1573                Narda
+        Name1574                Narmada
+        Name1575                Nasiche
+        Name1576                Nastassia
+        Name1577                Natalie
+        Name1578                Natane
+        Name1579                Natasha
+        Name1580                Natesa
+        Name1581                Naysa
+        Name1582                Nazirqah
+        Name1583                Neala
+        Name1584                Neci
+        Name1585                Nediva
+        Name1586                Neely
+        Name1587                Nekane
+        Name1588                Nell
+        Name1589                Neola
+        Name1590                Neoma
+        Name1591                Neona
+        Name1592                Neria
+        Name1593                Nerine
+        Name1594                Nerissa
+        Name1595                Netti
+        Name1596                Neva
+        Name1597                Nevada
+        Name1598                Neysa
+        Name1599                Nicia
+        Name1600                Nicola
+        Name1601                Nicole
+        Name1602                Nicolette
+        Name1603                Nika
+        Name1604                Nikki
+        Name1605                Nimah
+        Name1606                Nina
+        Name1607                Niobe
+        Name1608                Niola
+        Name1609                Nira
+        Name1610                Nirvelli
+        Name1611                Nissa
+        Name1612                Nita
+        Name1613                Nitara
+        Name1614                Nitzana
+        Name1615                Nixie
+        Name1616                Noel
+        Name1617                Noelani
+        Name1618                Noella
+        Name1619                Nolita
+        Name1620                Nona
+        Name1621                Nona
+        Name1622                Nora
+        Name1623                Norah
+        Name1624                Noreen
+        Name1625                Nori
+        Name1626                Noriko
+        Name1627                Norma
+        Name1628                Nydia
+        Name1629                Nyrna
+        Name1630                Nyssa
+        Name1631                Nyx
+        Name1632                Obelia
+        Name1633                Octavia
+        Name1634                Odelia
+        Name1635                Odelia
+        Name1636                Odera
+        Name1637                Odessa
+        Name1638                Odetta
+        Name1639                Odette
+        Name1640                Odile
+        Name1641                Ohanna
+        Name1642                Okelani
+        Name1643                Olathe
+        Name1644                Olayinka
+        Name1645                Olesia
+        Name1646                Olga
+        Name1647                Oliana
+        Name1648                Olinda
+        Name1649                Olive
+        Name1650                Olivette
+        Name1651                Olivia
+        Name1652                Ona
+        Name1653                Onida
+        Name1654                Opal
+        Name1655                Ophelia
+        Name1656                Oralie
+        Name1657                Orane
+        Name1658                Orenda
+        Name1659                Oriana
+        Name1660                Orianna
+        Name1661                Oriel
+        Name1662                Oriole
+        Name1663                Orlantha
+        Name1664                Ornidaa
+        Name1665                Paige
+        Name1666                Pakuna
+        Name1667                Palmiera
+        Name1668                Paloma
+        Name1669                Pamela
+        Name1670                Pandita
+        Name1671                Pandora
+        Name1672                Panthea
+        Name1673                Pantzike
+        Name1674                Panya
+        Name1675                Panyin
+        Name1676                Pascale
+        Name1677                Patia
+        Name1678                Patience
+        Name1679                Patricia
+        Name1680                Patsy
+        Name1681                Paula
+        Name1682                Paulette
+        Name1683                Pauline
+        Name1684                Pavla
+        Name1685                Pazia
+        Name1686                Pearl
+        Name1687                Peg
+        Name1688                Peggy
+        Name1689                Pelagia
+        Name1690                Pemba
+        Name1691                Penda
+        Name1692                Penelope
+        Name1693                Peninna
+        Name1694                Penny
+        Name1695                Penthea
+        Name1696                Peony
+        Name1697                Perdita
+        Name1698                Perouze
+        Name1699                Persis
+        Name1700                Petra
+        Name1701                Phaedra
+        Name1702                Phedra
+        Name1703                Philomena
+        Name1704                Phoebe
+        Name1705                Phylis
+        Name1706                Phyllis
+        Name1707                Pia
+        Name1708                Pier
+        Name1709                Pila
+        Name1710                Piper
+        Name1711                Polly
+        Name1712                Poloma
+        Name1713                Porche
+        Name1714                Portia
+        Name1715                Priscilla
+        Name1716                Prudence
+        Name1717                Prudy
+        Name1718                Pyrena
+        Name1719                Pythia
+        Name1720                Qamra
+        Name1721                Queena
+        Name1722                Quella
+        Name1723                Quenby
+        Name1724                Quintina
+        Name1725                Quiterie
+        Name1726                Rachel
+        Name1727                Radella
+        Name1728                Radinka
+        Name1729                Rae
+        Name1730                Rai
+        Name1731                Raisa
+        Name1732                Raizel
+        Name1733                Ramla
+        Name1734                Ramona
+        Name1735                Ramya
+        Name1736                Randie
+        Name1737                Rane
+        Name1738                Ranee
+        Name1739                Rani
+        Name1740                Raquel
+        Name1741                Rashida
+        Name1742                Rasine
+        Name1743                Ratri
+        Name1744                Raven
+        Name1745                Rawnie
+        Name1746                Rayna
+        Name1747                Raynell
+        Name1748                Raziya
+        Name1749                Reba
+        Name1750                Rebecca
+        Name1751                Regan
+        Name1752                Regina
+        Name1753                Rei
+        Name1754                Reidun
+        Name1755                Remy
+        Name1756                Rena
+        Name1757                Renata
+        Name1758                Rene
+        Name1759                Renee
+        Name1760                Rhea
+        Name1761                Rhiamon
+        Name1762                Rhianne
+        Name1763                Rhiannon
+        Name1764                Rhoda
+        Name1765                Rhodanthe
+        Name1766                Rhonda
+        Name1767                Rhonna
+        Name1768                Rhyssa
+        Name1769                Ria
+        Name1770                Riane
+        Name1771                Rica
+        Name1772                Rihana
+        Name1773                Rikki
+        Name1774                Rio
+        Name1775                Risa
+        Name1776                Rita
+        Name1777                Riva
+        Name1778                Roanna
+        Name1779                Roberta
+        Name1780                Robin
+        Name1781                Robyn
+        Name1782                Rochelle
+        Name1783                Rohanna
+        Name1784                Rona
+        Name1785                Rorie
+        Name1786                Rosa
+        Name1787                Rosalind
+        Name1788                Rosalinda
+        Name1789                Rosalinde
+        Name1790                Rosaline
+        Name1791                Rosanne
+        Name1792                Rose
+        Name1793                Roseanne
+        Name1794                Rosemarie
+        Name1795                Rosemary
+        Name1796                Rowena
+        Name1797                Roxana
+        Name1798                Roxanne
+        Name1799                Ruby
+        Name1800                Rumer
+        Name1801                Ruth
+        Name1802                Ruthann
+        Name1803                Ryann
+        Name1804                Ryanne
+        Name1805                Ryba
+        Name1806                Ryssa
+        Name1807                Saba
+        Name1808                Sabina
+        Name1809                Sabiny
+        Name1810                Sabirah
+        Name1811                Sabra
+        Name1812                Sabrina
+        Name1813                Sacha
+        Name1814                Sachi
+        Name1815                Sade
+        Name1816                Sadira
+        Name1817                Saffi
+        Name1818                Safiya
+        Name1819                Sagara
+        Name1820                Saidah
+        Name1821                Sakari
+        Name1822                Sakinah
+        Name1823                Sakti
+        Name1824                Sakura
+        Name1825                Salihah
+        Name1826                Salimah
+        Name1827                Salina
+        Name1828                Sally
+        Name1829                Salome
+        Name1830                Samantha
+        Name1831                Samara
+        Name1832                Samirah
+        Name1833                Sancia
+        Name1834                Sandia
+        Name1835                Sandra
+        Name1836                Sandrine
+        Name1837                Sandya
+        Name1838                Sara
+        Name1839                Sarah
+        Name1840                Sarai
+        Name1841                Saraid
+        Name1842                Saree
+        Name1843                Sarena
+        Name1844                Sari
+        Name1845                Sarisha
+        Name1846                Sasha
+        Name1847                Sashenka
+        Name1848                Satinka
+        Name1849                Savanna
+        Name1850                Saxon
+        Name1851                Scotia
+        Name1852                Searlait
+        Name1853                Season
+        Name1854                Sebasten
+        Name1855                Seema
+        Name1856                Sela
+        Name1857                Selena
+        Name1858                Selina
+        Name1859                Selma
+        Name1860                Semele
+        Name1861                Senta
+        Name1862                Serafina
+        Name1863                Serilda
+        Name1864                Sesha
+        Name1865                Shaine
+        Name1866                Shakira
+        Name1867                Shako
+        Name1868                Shammara
+        Name1869                Shana
+        Name1870                Shanata
+        Name1871                Shandra
+        Name1872                Shandy
+        Name1873                Shani
+        Name1874                Shanley
+        Name1875                Shanna
+        Name1876                Shannon
+        Name1877                Shantay
+        Name1878                Shantha
+        Name1879                Sharman
+        Name1880                Sharon
+        Name1881                Sharri
+        Name1882                Shashi
+        Name1883                Shawn
+        Name1884                Shayndel
+        Name1885                Sheba
+        Name1886                Sheena
+        Name1887                Sheila
+        Name1888                Shela
+        Name1889                Shelby
+        Name1890                Shelley
+        Name1891                Shelly
+        Name1892                Sherri
+        Name1893                Sherry
+        Name1894                Shika
+        Name1895                Shin
+        Name1896                Shina
+        Name1897                Shira
+        Name1898                Shirley
+        Name1899                Shobi
+        Name1900                Shoshana
+        Name1901                Sibley
+        Name1902                Sibongile
+        Name1903                Sibyl
+        Name1904                Sidonia
+        Name1905                Sidra
+        Name1906                Sierra
+        Name1907                Sigourney
+        Name1908                Siham
+        Name1909                Sileas
+        Name1910                Silva
+        Name1911                Silvia
+        Name1912                Simba
+        Name1913                Simone
+        Name1914                Sine
+        Name1915                Sinead
+        Name1916                Siobhan
+        Name1917                Siran
+        Name1918                Sirena
+        Name1919                Siroun
+        Name1920                Sitara
+        Name1921                Sitembile
+        Name1922                Siv
+        Name1923                Sive
+        Name1924                Skyler
+        Name1925                Sofi
+        Name1926                Solana
+        Name1927                Solange
+        Name1928                Soledad
+        Name1929                Solita
+        Name1930                Sondra
+        Name1931                Sonia
+        Name1932                Sonja
+        Name1933                Sonya
+        Name1934                Soo
+        Name1935                Sophia
+        Name1936                Sophie
+        Name1937                Sophronia
+        Name1938                Spica
+        Name1939                Stacey
+        Name1940                Stacia
+        Name1941                Stacy
+        Name1942                Stefania
+        Name1943                Stella
+        Name1944                Stephani
+        Name1945                Stephanie
+        Name1946                Ster
+        Name1947                Stesha
+        Name1948                Stockard
+        Name1949                Storm
+        Name1950                Sukatai
+        Name1951                Suki
+        Name1952                Sumi
+        Name1953                Summer
+        Name1954                Sun
+        Name1955                Susan
+        Name1956                Susanna
+        Name1957                Suzanne
+        Name1958                Svetlana
+        Name1959                Sybil
+        Name1960                Sydelle
+        Name1961                Sydney
+        Name1962                Syeira
+        Name1963                Sylvia
+        Name1964                Syna
+        Name1965                Synia
+        Name1966                Tabitha
+        Name1967                Taci
+        Name1968                Tacita
+        Name1969                Tadi
+        Name1970                Taffy
+        Name1971                Tahirah
+        Name1972                Tai
+        Name1973                Taima
+        Name1974                Tainn
+        Name1975                Taipa
+        Name1976                Taite
+        Name1977                Taka
+        Name1978                Takara
+        Name1979                Takiyah
+        Name1980                Takoda
+        Name1981                Talasi
+        Name1982                Tale
+        Name1983                Talia
+        Name1984                Talia
+        Name1985                Talitha
+        Name1986                Tallulah
+        Name1987                Tam
+        Name1988                Tama
+        Name1989                Tamara
+        Name1990                Tamary
+        Name1991                Tamma
+        Name1992                Tammy
+        Name1993                Tanaka
+        Name1994                Tani
+        Name1995                Tansy
+        Name1996                Tanya
+        Name1997                Tao
+        Name1998                Tara
+        Name1999                Tate
+        Name2000                Tatyana
+        Name2001                Tawnie
+        Name2002                Tawny
+        Name2003                Tayce
+        Name2004                Taylor
+        Name2005                Teague
+        Name2006                Tehya
+        Name2007                Tekla
+        Name2008                Temina
+        Name2009                Terentia
+        Name2010                Teresa
+        Name2011                Terese
+        Name2012                Terrilyn
+        Name2013                Tertia
+        Name2014                Teryn
+        Name2015                Tesia
+        Name2016                Tess
+        Name2017                Tessa
+        Name2018                Thadea
+        Name2019                Thais
+        Name2020                Thalassa
+        Name2021                Thalia
+        Name2022                Than
+        Name2023                Thana
+        Name2024                Thara
+        Name2025                Thea
+        Name2026                Thekla
+        Name2027                Thelma
+        Name2028                Theodosia
+        Name2029                Theone
+        Name2030                Thera
+        Name2031                Therese
+        Name2032                Thirza
+        Name2033                Thora
+        Name2034                Thyra
+        Name2035                Tia
+        Name2036                Tiara
+        Name2037                Tienette
+        Name2038                Tierney
+        Name2039                Tierra
+        Name2040                Tiffany
+        Name2041                Tilda
+        Name2042                Timandra
+        Name2043                Tina
+        Name2044                Tiponya
+        Name2045                Tirza
+        Name2046                Tivona
+        Name2047                Tobey
+        Name2048                Tola
+        Name2049                Tora
+        Name2050                Tori
+        Name2051                Tory
+        Name2052                Tosia
+        Name2053                Tove
+        Name2054                Tracey
+        Name2055                Tracy
+        Name2056                Treasa
+        Name2057                Tresa
+        Name2058                Treva
+        Name2059                Trianon
+        Name2060                Tricia
+        Name2061                Trilby
+        Name2062                Trina
+        Name2063                Trind
+        Name2064                Trish
+        Name2065                Trisha
+        Name2066                Trudy
+        Name2067                Tryne
+        Name2068                Tryphena
+        Name2069                Tuesday
+        Name2070                Tyne
+        Name2071                Ula
+        Name2072                Ulani
+        Name2073                Ultima
+        Name2074                Uma
+        Name2075                Una
+        Name2076                Undine
+        Name2077                Undine
+        Name2078                Urania
+        Name2079                Uria
+        Name2080                Uriana
+        Name2081                Ursula
+        Name2082                Uta
+        Name2083                Vala
+        Name2084                Valda
+        Name2085                Valentina
+        Name2086                Valeria
+        Name2087                Valerie
+        Name2088                Valeska
+        Name2089                Valonia
+        Name2090                Valora
+        Name2091                Vanda
+        Name2092                Vanessa
+        Name2093                Vanora
+        Name2094                Vanya
+        Name2095                Vashti
+        Name2096                Veda
+        Name2097                Velika
+        Name2098                Velma
+        Name2099                Venesssa
+        Name2100                Vera
+        Name2101                Verena
+        Name2102                Verity
+        Name2103                Veronica
+        Name2104                Vesta
+        Name2105                Vevila
+        Name2106                Victoria
+        Name2107                Vidonia
+        Name2108                Violet
+        Name2109                Violet
+        Name2110                Violetta
+        Name2111                Virginia
+        Name2112                Viridis
+        Name2113                Viveka
+        Name2114                Vivian
+        Name2115                Voleta
+        Name2116                Vrinda
+        Name2117                Wakanda
+        Name2118                Wanda
+        Name2119                Waneta
+        Name2120                Wapeka
+        Name2121                Wendy
+        Name2122                Whilhelmina
+        Name2123                Whitney
+        Name2124                Wijdan
+        Name2125                Willow
+        Name2126                Wilma
+        Name2127                Wilona
+        Name2128                Winda
+        Name2129                Winema
+        Name2130                Winifred
+        Name2131                Winna
+        Name2132                Winona
+        Name2133                Wynee
+        Name2134                Wynn
+        Name2135                Wynona
+        Name2136                Xanthe
+        Name2137                Xaveria
+        Name2138                Xaviera
+        Name2139                Xena
+        Name2140                Xenia
+        Name2141                Ximena
+        Name2142                Xylia
+        Name2143                Xylona
+        Name2144                Yachne
+        Name2145                Yanice
+        Name2146                Yarmilla
+        Name2147                Yasmeen
+        Name2148                Yasmin
+        Name2149                Yelinda
+        Name2150                Yenene
+        Name2151                Yesmina
+        Name2152                Yetta
+        Name2153                Yeva
+        Name2154                Yokiko
+        Name2155                Yoko
+        Name2156                Yolanda
+        Name2157                Yolie
+        Name2158                Yonina
+        Name2159                Yoshi
+        Name2160                Yovela
+        Name2161                Yvella
+        Name2162                Yvette
+        Name2163                Yvonne
+        Name2164                Zada
+        Name2165                Zahara
+        Name2166                Zahirah
+        Name2167                Zahra
+        Name2168                Zakia
+        Name2169                Zalea
+        Name2170                Zalika
+        Name2171                Zaltana
+        Name2172                Zandra
+        Name2173                Zara
+        Name2174                Zarah
+        Name2175                Zaza
+        Name2176                Zehava
+        Name2177                Zelda
+        Name2178                Zelenka
+        Name2179                Zelia
+        Name2180                Zella
+        Name2181                Zena
+        Name2182                Zenaide
+        Name2183                Zenia
+        Name2184                Zenobia
+        Name2185                Zerlinda
+        Name2186                Zeva
+        Name2187                Zevida
+        Name2188                Zia
+        Name2189                Ziazan
+        Name2190                Zigana
+        Name2191                Zila
+        Name2192                Zina
+        Name2193                Zinnia
+        Name2194                Zinnia
+        Name2195                Zita
+        Name2196                Zoe
+        Name2197                Zola
+        Name2198                Zona
+        Name2199                Zora
+        Name2200                Zorah
+        Name2201                Zorda
+        Name2202                Zosia
+        Name2203                Zuleika
+        Name2204                Zulema
+        Name2205                Zuza
+        Name2206                Zuzanny
+}

Added: trunk/096/pkg/skills/magery/OLD/incognito.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/incognito.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/incognito.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,57 @@
+use uo;
+use os;
+use util;
+use cfgfile;
+
+include ":attributes:attributes";
+
+
+program spell_incognito(parms)
+  var caster := parms.caster;
+  if (!GetObjProperty( caster, "realname"))
+    SetObjProperty( caster, "realname", caster.name );
+  endif
+  var newName := AssignName(caster);
+  SetName( caster, newName );
+  PlaySoundEffect(caster, 0x1e1);
+  Detach();
+  set_critical(1);
+  sleep( 60 * CInt(AP_GetSkill(caster, MAGERY)/10 ) );
+  SetName( caster, GetObjProperty( caster, "realname" ) );
+  EraseObjProperty( caster, "realname" );
+endprogram
+
+function AssignName( me )
+  var index := "MALE";
+  if (me.graphic == 401)
+	index := "FEMALE";
+  endif
+  var cfg := ReadConfigFile( "incognito" );
+  if (!cfg)
+	SendSysMessage(me,"Unable to read incognito.cfg");
+	Syslog("Unable to read incognito.cfg");
+	return;
+  endif
+  var elem := FindConfigElem( cfg, index );
+  var number := GetConfigInt( elem, "Count" );
+  var dice_str := "1d" + CStr(number);
+  var choice := RandomDiceRoll( dice_str );
+  var entry := "Name" + choice;
+  var str := GetConfigString( elem, entry );
+  var title := PreserveTitle( me );
+  str := str + title;
+  return( str );
+endfunction
+
+function PreserveTitle( me )
+  var myname := me.name;
+  var start := find( myname, ">", 1 );
+  if( !start )
+    return;
+  endif
+  var title := myname[ start+1, (len( myname ) - 8) ];
+  if( !title )
+    return("");
+  endif
+  return( title );
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/invisibility.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/invisibility.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/invisibility.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,20 @@
+use uo;
+use os;
+
+include "include/client";
+include "include/sound";
+include ":attributes:attributes";
+
+
+program spell_invisibility(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+
+	PlaySoundEffect(castOn, SFX_SPELL_INVISIBILITY);
+	castOn.hidden := 1;
+	Detach();
+	sleep(CInt(AP_GetSkill(caster, MAGERY)));
+	castOn.hidden := 0;
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/lightning.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/lightning.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/lightning.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,34 @@
+use uo;
+use util;
+use os;
+
+include "include/magic";
+include "include/sound";
+include "include/tileEffects";
+include ":magery:reflect";
+
+
+program spell_lightning( parms )
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+	var spellid := parms.spellid;
+	var spellcfg := ReadConfigFile(":*:spells");
+	var circle := spellcfg[spellid].circle;
+	var dmg := RandomDiceRoll("3d7");
+
+	if (dmg < 1)
+		dmg := 1;
+	endif
+  PlaySoundEffect(castOn, SFX_SPELL_LIGHTNING);
+  PlayLightningBoltEffect( castOn);
+  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "lightning bolt"});
+  if(spell_reflect(castOn))
+	castOn := caster;
+    PlaySoundEffect(castOn, SFX_SPELL_LIGHTNING);
+    PlayLightningBoltEffect( castOn);
+  endif
+  if(castOn.isA(POLCLASS_NPC))
+    dmg := dmg * 2;
+  endif
+  ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/magicArrow.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magicArrow.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/magicArrow.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,36 @@
+use uo;
+use cfgfile;
+
+include "include/magic";
+include "include/sound";
+include "include/tileEffects";
+include ":magery:reflect";
+include ":attributes:attributes";
+
+
+program spell_magicArrow( parms )
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+	var spellid := parms.spellid;
+	var spellcfg := ReadConfigFile(":*:spells");
+	var circle := spellcfg[spellid].circle;
+
+	PlayMovingEffect( caster, castOn, FX_MAGIC_ARROW, 5, 1 );
+	PlaySoundEffect( caster, SFX_SPELL_MAGIC_ARROW );
+	var dmg := RandomDiceRoll("1d8");
+	if (spell_reflect(castOn))
+		PlayMovingEffect( castOn, caster, FX_MAGIC_ARROW, 5, 1 );
+		PlaySoundEffect( castOn, SFX_SPELL_MAGIC_ARROW );
+		ApplyRawDamage( caster, Resisted(circle,caster,castOn,dmg) );
+	else
+		if (AP_GetVital(castOn, HITS) >= 1)
+			SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "magic arrow" });
+			if (castOn.isA(POLCLASS_NPC))
+				dmg := dmg * 2;
+			endif
+			ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
+		endif
+	endif
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/magicLock.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magicLock.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/magicLock.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,45 @@
+use os;
+use uo;
+use util;
+
+include "include/client";
+include "include/sound";
+include ":attributes:attributes";
+include "include/findCity";
+include "util/key";
+
+
+program spell_magicLock( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  if((castOn.multi) ||(GetObjProperty(castOn,"houseserial")) ||(GetObjProperty(castOn,"house_serial")))
+    SendSysMessage(caster, "That cannot be magically locked!");
+    return;
+  endif
+  if(castOn.locked)
+    SendSysMessage(caster,"That is already locked!");
+    return;
+  endif
+  if((CheckForDoors(castOn)) && ((FindCity(castOn) != "no city") || (FindCity(caster) != "no city")))
+    SendSysMessage(caster, "That cannot be magically locked!");
+    return;
+  endif
+  if(((castOn.graphic<=0x9ab) &&(castOn.graphic>=0x9a8)) ||((castOn.graphic<=0xe43) &&(castOn.graphic>=0xe3c)) ||((castOn.graphic<=0xe80) &&(castOn.graphic>=0xe7c)) ||(checkfordoors(castOn)))
+    PlaySoundEffect(caster, SFX_SPELL_MAGIC_LOCK);
+    PrintTextAbovePrivate(castOn, "*Locked!*", caster);
+    var magery := CInt(AP_GetSkill(caster, MAGERY) / 4);
+    SetObjProperty(castOn, "MLockPickDiff", magery);
+    castOn.locked := 1;
+  else
+    SendSysMessage(caster, "That cannot be magically locked!");
+  endif
+endprogram
+
+
+function CheckForDoors(castOn)
+	if (((castOn.graphic<=0x1ffc) &&(castOn.graphic>=0x1fed)) ||((castOn.graphic<=0x6f4) &&(castOn.graphic>=0x675)))
+		return 1;
+	endif
+
+	return 0;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/magicTrap.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magicTrap.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/magicTrap.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,41 @@
+use os;
+use uo;
+use util;
+
+include "include/client";
+include ":attributes:attributes";
+include "include/sound";
+include "include/findCity";
+
+
+program spell_magicTrap(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+
+	if ((castOn.isa(POLCLASS_DOOR)) || (castOn.objtype == 0xe79) || ((castOn.graphic<=0x9ab) &&(castOn.graphic>=0x9a8)) ||((castOn.graphic<=0xe43) &&(castOn.graphic>=0xe3c)) ||((castOn.graphic<=0xe80) &&(castOn.graphic>=0xe7c)))
+		var magery := AP_GetSkill(caster, MAGERY);
+		var trapstr := CInt(magery/5);
+		if (findcity(castOn) != "no city")
+			caster.setCriminal(1);
+		endif
+		if (findcity(caster) != "no city")
+			caster.setCriminal(1);
+		endif
+		if (trapstr < 1)
+			trapstr := 1;
+		endif
+		if (trapstr > 5)
+			trapstr:=5;
+		endif
+		PlaySoundEffect(caster, SFX_SPELL_MAGIC_TRAP);
+		PlayStationaryEffect(castOn.x, castOn.y, castOn.z, 0x376a, 30, 30, 0, caster.realm);
+		SetObjProperty(castOn, "trap_strength", trapstr);
+		SetObjProperty(castOn, "trap_type", 4);
+		SetObjProperty(castOn, "oldscript", castOn.usescript);
+		castOn.usescript := ":tinkering:tinkerTraps";
+	else
+		SendSysMessage(caster, "That cannot be magically trapped!");
+	endif
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/magicUntrap.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magicUntrap.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/magicUntrap.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,27 @@
+// $Id: magicUntrap.src 806 2005-11-01 21:56:02Z austin $
+
+use os;
+use uo;
+use util;
+
+include "include/client";
+include "include/sound";
+include ":attributes:attributes";
+
+program spell_magicUntrap(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+
+	if (GetObjProperty(castOn, "trap_strength") > 25)
+		SendSysMessage(caster, "You couldn't disarm the trap.");
+	else
+		var oldscript := GetObjProperty(castOn, "oldscript");
+		PlaySoundEffect(caster, SFX_SPELL_MAGIC_UNTRAP);
+		PlayStationaryEffect(castOn.x, castOn.y, castOn.z, 0x376a, 30, 30,0 , caster.realm);
+		EraseObjProperty(castOn, "trap_type");
+		EraseObjProperty(castOn, "trap_strength");
+		castOn.usescript := oldscript;
+	endif
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/magiccircles.cfg
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magiccircles.cfg	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/magiccircles.cfg	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,87 @@
+Circle 1
+{
+    Mana        4
+    Difficulty  20
+    PointValue  20
+    animReps	1
+    extraWait	500
+}
+
+Circle 2
+{
+    Mana        6
+    Difficulty  30
+    PointValue  40
+    animReps	2 
+    extraWait	0
+}
+
+Circle 3
+{
+    Mana        9
+    Difficulty  40
+    PointValue  80
+    animReps	2
+    extraWait	250
+}
+
+Circle 4
+{
+    Mana        11
+    Difficulty  50
+    PointValue  100
+    animReps	2
+    extraWait	500
+}
+
+Circle 5
+{
+    Mana        14
+    Difficulty  60
+    PointValue  120
+    animReps	3
+    extraWait	0
+}
+
+Circle 6
+{
+    Mana        20
+    Difficulty  70
+    PointValue  140
+    animReps	3
+    extraWait	250
+}
+
+Circle 7
+{
+    Mana        40
+    Difficulty  80
+    PointValue  160
+    animReps	3
+    extraWait	500
+}
+
+Circle 8
+{
+    Mana        50
+    Difficulty  90
+    PointValue  180
+    animReps	4
+    extraWait	0
+}
+
+Circle 9
+{
+    Mana        75
+    Difficulty  100
+    PointValue  300
+    Delay       5000
+}
+
+Circle 10
+{
+    Mana        100
+    Difficulty  100
+    PointValue  300
+    Delay       7000
+}

Added: trunk/096/pkg/skills/magery/OLD/manaDrain.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/manaDrain.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/manaDrain.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,37 @@
+use uo;
+use util;
+
+include "include/magic";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+include ":magery:reflect";
+
+
+program spell_manaDrain(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+	var spellid := parms.spellid;
+	var spellcfg := ReadConfigFile(":*:spells");
+	var circle := spellcfg[spellid].circle;
+
+	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "mana drain" });
+	if (spell_reflect(castOn))
+		var tmp := castOn;
+		castOn := caster;
+		caster := tmp;
+	endif
+	var dmg := Cint(GetAttribute(caster, "magery") / 2);
+	var diff := Resisted(circle, caster, castOn, dmg);
+	if (diff)
+		PlaySoundEffect( caster, SFX_SPELL_MANA_DRAIN );
+		PlayObjectCenteredEffect( castOn, FX_HEAL_EFFECT, 7,0x10 );
+		if (diff > AP_GetVital(castOn, MANA))
+			AP_SetVital(castOn, MANA, 0);
+		else
+			AP_SetVital(castOn, MANA, AP_GetVital(castOn, MANA) - diff);
+		endif
+	endif
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/manaVamp.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/manaVamp.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/manaVamp.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,44 @@
+use uo;
+
+include "include/magic";
+include "include/sound";
+include "include/tileEffects";
+include ":magery:reflect";
+include ":attributes:attributes";
+
+
+program spell_manaVamp(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+
+  SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "mana vampire"});
+  if(spell_reflect(castOn))
+    castOn := caster;
+  endif
+  if(!castOn.isA(POLCLASS_MOBILE))
+    return;
+  endif
+  var dmg := Cint(GetAttribute(caster, "magery") / 3);
+  var diff := Resisted(circle, caster, castOn, dmg);
+  if(diff)
+    PlaySoundEffect(caster, SFX_SPELL_MANA_VAMPIRE);
+    PlayObjectCenteredEffect(castOn, FX_GLOW, 7,0x10);
+    var gain := 0;
+	if(diff > AP_GetVital(castOn, MANA))
+	  gain := AP_GetVital(castOn, MANA);
+	  AP_SetVital(castOn, MANA, 0);
+	else
+	  gain := diff;
+	  AP_SetVital(castOn, MANA, AP_GetVital(castOn, MANA) - diff);
+	endif
+	AP_SetVital(caster, MANA, AP_GetVital(caster, MANA) + gain);
+	if(AP_GetVital(caster, MANA) > AP_GetVitalMaximumValue(caster, MANA))
+	  AP_SetVital(caster, MANA, AP_GetVitalMaximumValue(caster, MANA));
+	endif
+  endif
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/mark.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/mark.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/mark.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,46 @@
+use uo;
+use util;
+
+include "include/objtype";
+include "include/sound";
+include "include/tileEffects";
+
+
+program mark(parms)
+  var caster := parms.caster;
+  var castOn := Target(caster);
+  if (castOn.objtype != UOBJ_RUNE)
+    SendSysMessage(caster, "You can only cast that on a recall rune!");
+	return;
+  endif
+  if(caster.multi)
+    SendSysMessage(caster,"You cannot mark runes here.");
+    PlaySoundEffect(caster,0x005d);
+    PlayObjectCenteredEffect(caster, 0x3735,0x0a, 0x1e);
+    return;
+  endif
+  if(((caster.x >= 5120) && (caster.x <= 5375) && (caster.y >= 0) && (caster.y <= 255)) or (caster.multi))
+    SendSysMessage(caster, "You cannot mark runes here.");
+    return;
+  endif
+  if (!Accessible(caster, castOn))
+	SendSysMessage(caster, "You can't reach that!");
+  endif
+  if (castOn.objtype != UOBJ_RUNE)
+	SendSysMessage(caster, "You can only cast that on a recall rune!");
+	return;
+  endif
+  if(!ReserveItem(castOn))
+    SendSysMessage(caster,"Your spell fizzles.");
+    return;
+  endif
+  PlayObjectCenteredEffect(caster, FX_MARK_EFFECT, 10, 10);
+  PlaySoundEffect(caster, SFX_SPELL_MARK);
+  SetObjProperty(castOn, "x", caster.x);
+  SetObjProperty(castOn, "y", caster.y);
+  SetObjProperty(castOn, "z", caster.z);
+  SetObjProperty(castOn, "realm", caster.realm);
+  SetName(castOn, "a marked recall rune");
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/massCurse.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/massCurse.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/massCurse.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,47 @@
+use os;
+use uo;
+use util;
+
+include "include/statMod";
+include ":attributes:attributes";
+include "include/sound";
+include "include/tileEffects";
+include "include/spellAttack";
+include ":magery:reflect";
+include "include/magic";
+
+program massCurse( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+
+  PlaySoundEffect(caster, SFX_SPELL_MASS_CURSE);
+  var magery := AP_GetSkill(caster, MAGERY);
+  var modAmount := GetModAmount( magery );
+  var duration := GetModDuration( magery );
+  Detach();
+  foreach castOn in ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, 4, caster.realm );
+	SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "mass curse"});
+    if(spell_reflect(castOn))
+	  castOn := caster;
+    endif
+    PlaySoundEffect(castOn, SFX_SPELL_MASS_CURSE);
+    PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 10,10);
+	send_attack(castOn,caster, 46);
+    if(castOn.criminal == 0)
+      caster.setCriminal(1);
+    endif
+    modAmount := Resisted(circle,caster,castOn, GetModAmount( magery ));
+	if (CanMod(castOn, "str"))
+	  DoTempMod(castOn, "str", 0- modAmount, duration);
+	endif
+	if (CanMod(castOn, "dex"))
+	  DoTempMod(castOn, "dex", 0- modAmount, duration);
+	endif
+	if (CanMod(castOn, "int"))
+	  DoTempMod(castOn, "int", 0- modAmount, duration);
+	endif
+  endforeach
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/massDispel.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/massDispel.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/massDispel.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,64 @@
+use uo;
+
+include "include/eventID";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+include ":magery:reflect";
+include "include/spellAttack";
+include "include/magic";
+
+
+program spell_massDispel(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+
+  var npccfg := ReadConfigFile("::npcdesc");
+  var magery := AP_GetSkill(caster, MAGERY);
+  var range := CInt(magery / 20);
+  var targets := ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, range, caster.realm );
+  PlaySoundEffect( caster, 0x202 );
+  foreach mobile in targets
+	SetObjProperty(mobile, "LastHit", {caster.name, caster.serial, "mass dispel"});
+    if(spell_reflect(mobile))
+	  mobile := caster;
+    endif
+    var summoned := GetObjProperty( mobile, "summoned");
+	if (summoned == 1)
+      PlaySoundEffect(caster, 0x202 );
+      PlayStationaryEffect( mobile.x, mobile.y, mobile.z, FX_HEAL_EFFECT, 0xa, 0xa,0 , caster.realm );
+      var master := SystemFindObjectBySerial(CInt(GetObjProperty(mobile, "master")));
+      if(master)
+        var resist := AP_GetSkill(master, RESISTING_SPELLS);
+        if((RandomInt(99) + 1) < resist)
+          MoveCharacterToLocation(mobile,0,0,0,MOVECHAR_FORCELOCATION);
+          ApplyRawDamage(mobile, AP_GetVitalMaximumValue(mobile, HITS) + 3);
+        endif
+        send_attack(caster, mobile, 41);
+    endif
+    else
+      if(mobile.isA(POLCLASS_NPC))
+        var element := npccfg[mobile.npctemplate].elemental;
+        if(element == "undead")
+          PlayStationaryEffect( mobile.x, mobile.y, mobile.z, FX_HEAL_EFFECT, 0xa, 0xa,0, caster.realm );
+          var ev := array;
+          ev.+ type;
+          ev.+ source;
+          ev.type := EVID_PEACEMADE;
+          SendEvent(mobile, ev);
+          ev.source := caster;
+          SendEvent(mobile, ev);
+          ev.type := EVID_ENGAGED;
+          SendEvent(mobile, ev);
+	      PlaySoundEffect( caster, 0x202 );
+          PlayObjectCenteredEffect(mobile, 0x37b9,0x03, 0x0a);
+          var dmg := CalcSpellDamage(circle,caster) + (RandomInt(20));
+          ApplyRawDamage(mobile, Resisted(circle,caster,mobile,dmg));
+        endif
+      endif
+    endif
+  endforeach
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/meteorSwarm.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/meteorSwarm.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/meteorSwarm.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,41 @@
+use cfgfile;
+use uo;
+
+include "include/magic";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+include ":magery:reflect";
+include "include/spellAttack";
+
+
+program spell_meteorSwarm( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+
+  Detach();
+  var dmg;
+  var victims := ListMobilesNearLocationEx( castOn.x, castOn.y, castOn.z, 3, 0x03, caster.realm);
+  foreach mobile in victims
+	PlaySoundEffect( mobile, SFX_SPELL_FIREBALL );
+	PlayMovingEffect( caster, mobile, FX_FIREBALL, 5, 1 );
+	SetObjProperty(mobile, "LastHit", {caster.name, caster.serial, "meteor swarm"});
+    if(spell_reflect(mobile))
+	  mobile := caster;
+	  PlaySoundEffect( mobile, SFX_SPELL_FIREBALL );
+	  PlayMovingEffect( caster, mobile, FX_FIREBALL, 5, 1 );
+    endif
+	dmg := RandomDiceRoll("6d8");
+	send_attack(mobile,caster, 55);
+    if(AP_GetVital(mobile, HITS) > 1)
+      if(castOn.npctemplate)
+        dmg := dmg * 2;
+      endif
+      ApplyRawDamage(mobile, Resisted(circle,caster,mobile,dmg));
+    endif
+	sleep(1);
+  endforeach
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/mindBlast.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/mindBlast.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/mindBlast.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,42 @@
+use os;
+use uo;
+
+include "include/magic";
+include "include/sound";
+include "include/tileEffects";
+include ":magery:reflect";
+include ":attributes:attributes";
+
+
+program spell_mindBlast( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+
+  var myInt := CInt(AP_GetStat(caster, INTELLIGENCE));
+  var hisInt := CInt(AP_GetStat(castOn, INTELLIGENCE));
+  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "mind blast" });
+  var modif := myInt - hisInt;
+  if(hisInt > myInt)
+    modif := hisInt - myInt;
+	castOn := caster;
+  elseif(hisInt == myInt)
+	return;
+  endif
+  if(modif > 20)
+    modif:= 20;
+  endif
+  if(spell_reflect(castOn))
+	castOn := caster;
+  endif
+  PlaySoundEffect(castOn, SFX_SPELL_MIND_BLAST);
+  PlayObjectCenteredEffect(castOn, FX_CURSE_EFFECT, 7,0x10);
+  var dmg := RandomDiceRoll("3d7");
+  var diff := Resisted(circle, caster, castOn, dmg);
+  if(castOn.isA(POLCLASS_NPC))
+    diff := diff * 2;
+  endif
+  ApplyRawDamage(castOn, diff);
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/nightSight.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/nightSight.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/nightSight.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,24 @@
+use uo;
+use util;
+
+include "include/client";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+
+
+program nightSight(parms, spellid)
+
+	spellid := spellid;
+
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+
+	PlaySoundEffect(castOn, SFX_SPELL_NIGHT_SIGHT );
+	var magery := AP_GetSkill(caster, MAGERY);
+	castOn.setlightlevel(0, magery * 60);
+	PlayObjectCenteredEffect(castOn, FX_BLESS_EFFECT, 10,10);
+
+	return;
+
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/pField.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/pField.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/pField.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,24 @@
+use uo;
+use os;
+
+include "include/sound";
+include "include/tileEffects";
+include "include/objtype";
+
+
+program spell_pField(parms)
+	var castOn := parms.castOn;
+	var boss := parms.caster;
+	SetScriptController(boss);
+	SetObjProperty(castOn,"#pfield", 1);
+	PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_CURSE_EFFECT, 10, 0xa, 0, castOn.realm );
+	PlaySoundEffect( castOn, SFX_SPELL_PARALYZE );
+	Detach();
+	castOn.paralyzed := 1;
+	sleep(15);
+	castOn.paralyzed := 0;
+	sleepms(500);
+	EraseObjProperty(castOn,"#pfield");
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/paraField.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/paraField.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/paraField.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,38 @@
+use os;
+use uo;
+use util;
+
+include "include/fields";
+include "include/objtype";
+include "include/sound";
+include ":attributes:attributes";
+
+
+program spell_paraField(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+	var fields := {};
+	var x := castOn.x;
+	var y := castOn.y;
+	var z := castOn.z;
+	case (get_direction(caster))
+		"NS" : fields:= CreateNorthSouthField(caster, UOBJ_PARAFIELD_NS, x, y, z, 5);
+		"EW" : fields:= CreateEastWestField(caster, UOBJ_PARAFIELD_EW, x, y, z, 5);
+	endcase
+	Detach();
+	var duration := CInt(AP_GetSkill(caster, MAGERY) )/2;
+	if (duration < 20)
+		duration := 20;
+	endif
+	var i;
+	for (i := 1; i <= 5; i := i + 1)
+		SetObjProperty(fields[i], "f", 1);
+		PlaySoundEffect(fields[i], SFX_20C);
+		sleep(duration/4);
+	endfor
+	foreach fieldpart in fields
+		DestroyItem(fieldpart);
+	endforeach
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/paralyze.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/paralyze.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/paralyze.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,68 @@
+use uo;
+use os;
+
+include ":magery:reflect";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+include "include/statMod";
+include "include/magic";
+
+
+program spell_paralyze( parms )
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+
+	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "paralyze" });
+	if (spell_reflect(castOn))
+		castOn := caster;
+	endif
+	var amt := 10 + RandomInt(CInt(AP_GetSkill(caster, MAGERY)/5));
+	var duration := ParaResist(2, caster, castOn, amt);
+	PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_CURSE_EFFECT, 10, 0xa, 0, caster.realm );
+	PlaySoundEffect( castOn, SFX_SPELL_PARALYZE );
+	DoTempMod(castOn, "p", 1, duration);
+
+	return;
+endprogram
+
+
+function ParaResist(circle, caster, castOn, amt)
+  var magery := CInt(AP_GetSkill(caster, MAGERY));
+  var evalint := CInt(AP_GetSkill(caster, EVALUATING_INTELLIGENCE));
+  var resist := CInt(AP_GetSkill(castOn, RESISTING_SPELLS));
+  var chk1 := (resist / 5);
+  var chk2 := resist - (((magery - 20) / 5) + (circle * 5));
+  if(chk1 < 1)
+    chk1 := 1;
+  endif
+  if(chk2 < 1)
+    chk2 := 1;
+  endif
+  var diff := 0;
+  if(chk1 > chk2)
+    diff := chk1;
+  else
+    diff := chk2;
+  endif
+  //var points := getresistpoints(circle, castOn, RESISTING_SPELLS);
+  if(castOn.dead)
+    return 0;
+  endif
+  if((RandomInt(99) + 1) <= diff)
+	SendSysMessage(castOn, "You feel yourself resisting magical energy!");
+	PlaySoundEffect(castOn, SFX_SPELL_WEAKEN);
+	PlayObjectCenteredEffect(castOn, FX_CURSE_EFFECT, 5,5);
+	//AwardRawSkillPoints(castOn, RESISTING_SPELLS, points);
+	amt := 0;
+	return amt;
+  endif
+  var modamt := 1;
+  if(resist > evalint)
+    modamt := (1 + ((evalint - resist) / 200.0));
+  elseif(evalint > resist)
+    modamt := (1 + ((evalint - resist) / 500.0));
+  endif
+  amt := (amt * modamt);
+  return CInt(amt);
+endfunction

Added: trunk/096/pkg/skills/magery/OLD/pkg.cfg
===================================================================
--- trunk/096/pkg/skills/magery/OLD/pkg.cfg	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/pkg.cfg	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,8 @@
+# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+Enabled         1
+Name		magery
+maintainer      Distro Team
+email           distro at polserver.com
+Version         1.0

Added: trunk/096/pkg/skills/magery/OLD/poison.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/poison.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/poison.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,97 @@
+use os;
+use uo;
+use cfgfile;
+
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+include ":magery:reflect";
+include ":timedscripts:timedScripts";
+
+const EVID_DISCHARGE := 0x123457;
+
+
+program poison(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var npccfg := ReadConfigFile("::npcdesc");
+  if(spell_reflect(castOn))
+    castOn := caster;
+  endif
+  if((!castOn.isA(POLCLASS_MOBILE)) || (castOn.dead))
+    SendSysMessage(caster, "You cannot poison that.");
+    return;
+  endif
+  PlaySoundEffect(castOn, 0x206);
+  PlayObjectCenteredEffect(castOn, FX_CURSE_EFFECT, 0x0a,0x1e);
+  var pLevel :=  0;
+  var skil := AP_GetSkill(caster, MAGERY);
+  if(skil <= 50)
+    pLevel := 1;
+  elseif(skil <= 90)
+    pLevel := 2;
+  elseif(skil <= 98)
+    pLevel := 3;
+  else
+    pLevel := 4;
+  endif
+  pLevel := pLevel - RandomInt(2);
+  if(pLevel < 1)
+    pLevel := 1;
+  endif
+  var passparms, newamt;
+  if(castOn.isA(POLCLASS_NPC))
+    var element := npccfg[castOn.npctemplate].elemental;
+    if(element == "poison")
+      HealDamage(castOn, (pLevel * 50));
+    else
+      newamt := PoisonResist(caster, castOn, pLevel);
+      if(newamt > 0)
+        SendSysMessage(castOn, "You have been poisoned by " + caster.name +"!");
+        Detach();
+        passparms := {castOn, caster, "poison spell", newamt};
+        start_script(":magery:poisonDamage", passparms);
+        SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "poison spell" });
+      else
+        SendSysMessage(caster, "Your target resists the spell completely.");
+      endif
+    endif
+  else
+    newamt := poisonresist(caster, castOn, pLevel);
+    if(newamt > 0)
+      SendSysMessage(castOn, "You have been poisoned by " + caster.name +"!");
+      Detach();
+      TS_StartTimer(castOn, "defaultPoison", 20, pLevel);
+      //passparms := {castOn, caster, "poison spell", newamt};
+      //start_script(":magery:poisonDamage", passparms);
+      SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "poison spell" });
+    else
+      SendSysMessage(castOn, "You resist the spell completely.");
+      if(caster != castOn)
+        SendSysMessage(caster, "Your target resists the spell completely.");
+      endif
+    endif
+  endif
+endprogram
+
+function PoisonResist(caster, castOn, amt)
+  var diff := Cint(AP_GetSkill(caster, MAGERY) + Cint(AP_GetSkill(caster, EVALUATING_INTELLIGENCE) / 10));
+  if( SkillCheck(castOn, RESISTING_SPELLS, diff) > 0 )
+    SendSysMessage(castOn, "You feel yourself resisting magical energy!");
+    PlaySoundEffect(castOn, SFX_SPELL_WEAKEN);
+    PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 5,5);
+    if(amt == 5)
+      amt := 3;
+    elseif(amt == 4)
+      return 2;
+    elseif(amt == 3)
+      return 2;
+    elseif(amt == 2)
+      return 1;
+    elseif(amt == 1)
+      return 0;
+    endif
+  else
+    return amt;
+  endif
+endfunction

Added: trunk/096/pkg/skills/magery/OLD/poisonField.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/poisonField.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/poisonField.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,27 @@
+use os;
+use uo;
+use util;
+
+include "include/fields";
+include ":attributes:attributes";
+include "include/objtype";
+
+
+program spell_poisonField( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var fields := {};
+  var x := castOn.x;
+  var y := castOn.y;
+  var z := castOn.z;
+  case(get_direction(caster))
+	"NS" : fields:= CreateNorthSouthField(caster, UOBJ_POISONFIELD_NS, x, y, z, 5);
+	"EW" : fields:= CreateEastWestField(caster, UOBJ_POISONFIELD_EW, x, y, z, 5);
+  endcase
+  Detach();
+  var duration := 20 + ( CInt(AP_GetSkill(caster, MAGERY) ) / 3 );
+  sleep(duration);
+  foreach fieldpart in fields
+    DestroyItem(fieldpart);
+  endforeach
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/polymorph.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/polymorph.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/polymorph.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,83 @@
+use util;
+
+include ":attributes:attributes";
+
+
+program spell_polymorph( parms )
+  var caster := parms.caster;
+  var magery     := CInt(AP_GetSkill(caster, MAGERY));
+  var meditation := CInt(AP_GetSkill(caster, MEDITATION));
+  var evalint    := CInt(AP_GetSkill(caster, EVALUATING_INTELLIGENCE));
+  var critgroup;
+  var thecreature;
+  if (magery < 70)
+	critgroup := RandomInt(1);
+  elseif (magery < 80)
+	critgroup := RandomInt(1)+1;
+  elseif (magery < 90)
+	critgroup := RandomInt(1)+2;
+  else
+	critgroup := 3;
+  endif
+  var critter := RandomInt(8);
+  case (critgroup)
+	0:
+	  case (critter)
+		0: thecreature := 6;	//bird
+		1: thecreature := 51;	//slime
+		2: thecreature := 5;	//eagle
+		3: thecreature := 39;	//mongbat
+		4: thecreature := 31;	//headless
+		5: thecreature := 29;	//gorilla
+		6: thecreature := 42;	//ratman
+		7: thecreature := 28;	//giant spider
+	  endcase
+	1:
+	  case (critter)
+		0: thecreature := 48;	//scorpion
+		1: thecreature := 7;	//orc
+		2: thecreature := 3;	//zombie
+		3: thecreature := 17;	//orc
+		4: thecreature := 33;	//lizardman
+		5: thecreature := 26;	//shade
+		6: thecreature := 21;	//giant serp
+		7: thecreature := 30;	//harpy
+	  endcase
+	2:
+	  case (critter)
+	    0: thecreature := 18;	//ettin
+		1: thecreature := 8;	//corpser
+		2: thecreature := 22;	//beholder
+		3: thecreature := 14;	//earth elem
+		4: thecreature := 16;	//water elem
+		5: thecreature := 15;	//fire elem
+		6: thecreature := 13;	//air elem
+		7: thecreature := 47;	//ent
+	  endcase
+	3:
+	  case (critter)
+		0: thecreature := 1;	//ogre
+		1: thecreature := 4;	//gargoyle
+		2: thecreature := 24;	//lich
+		3: thecreature := 150;	//seaserp
+		4: thecreature := 9;	//demon
+		5: thecreature := 12;	//dragon
+		6: thecreature := 10;	//demon with sword
+		7: thecreature := 58;	//wisp
+	  endcase
+  endcase
+  caster.graphic := thecreature;
+  if ( thecreature == 150 )
+	caster.color := 233;
+  else
+	caster.color := 0;
+  endif
+  var magerydur := magery/2;
+  var meditadur := magerydur + meditation/10;
+  var duration  := meditadur + evalint/10;
+  Detach();
+  sleep(duration);
+  caster.graphic := caster.objtype;
+  caster.color := caster.truecolor;
+  EraseObjProperty(caster,"poly");
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/protection.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/protection.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/protection.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,33 @@
+use uo;
+use os;
+use cfgfile;
+
+include "include/statMod";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+
+program spell_protection(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  PlaySoundEffect(castOn, SFX_SPELL_PROTECTION);
+  PlayObjectCenteredEffect(castOn, FX_BLESS_EFFECT, 7,7);
+  if (!CanMod(castOn, "ar"))
+	SendSysMessage(caster,"Already under the influence!");
+	return;
+  endif
+  var magery := AP_GetSkill(caster, MAGERY);
+  var modAmount := (GetModAmount(magery) * 2);
+  var duration := GetModDuration(magery);
+  var itmcfg := ReadConfigFile(":*:itemdesc");
+  var arpoints := 0;
+  foreach thing in ListEquippedItems(castOn)
+    arpoints := arpoints + (CInt(itmcfg[thing.objtype].AR) / 12);
+  endforeach
+  if(modAmount > arpoints)
+    modAmount := modAmount - arpoints;
+  else
+    modAmount := 0;
+  endif
+  DoTempMod(castOn, "ar", modAmount, duration);
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/reactiveArmor.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/reactiveArmor.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/reactiveArmor.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,30 @@
+use uo;
+use os;
+
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+
+
+program spell_reactiveArmor( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  PlaySoundEffect(castOn, SFX_SPELL_REACTIVE_ARMOR);
+  PlayObjectCenteredEffect( castOn, FX_SPARK_EFFECT, 7, 0x10 );
+  if(GetObjProperty(castOn, "ar"))
+	SendSysMessage(caster,"Already under the influence!");
+	return;
+  endif
+  var magery := AP_GetSkill(caster, MAGERY);
+  var modAmount := magery / 10;
+  var duration := CInt(RandomInt(10) + (magery / 2));
+  SetObjProperty(castOn, "ReactiveArmor", modAmount);
+  Detach();
+  sleep(duration);
+  if(GetObjProperty(castOn, "ReactiveArmor"))
+    PlaySoundEffect(castOn, 0x1eb);
+    EraseObjProperty(castOn,"ReactiveArmor");
+  endif
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/recall.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/recall.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/recall.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,108 @@
+use uo;
+use os;
+use cfgfile;
+
+include "include/client";
+include "include/objtype";
+include "include/isValidLoc";
+
+
+program spell_recall(parms)
+  var caster := parms.caster;
+  var failure := 0;  
+  var castOn := Target(caster);
+  if((castOn.objtype != UOBJ_RUNE) && (castOn.objtype != 0x6100))
+    SendSysMessage(caster, "You can only cast that on a recall rune.");
+	return;
+  endif
+  if(!ReserveItem(castOn))
+    return;
+  endif
+  if(GetObjProperty(castOn, "Vendored"))
+    SendSysMessage(caster, "You cannot recall off of runes on a vendor.");
+    return;
+  endif
+  var tox := CInt(GetObjProperty( castOn, "x" ));
+  var toy := CInt(GetObjProperty( castOn, "y" ));
+  var toz := CInt(GetObjProperty( castOn, "z" ));
+  var torealm := GetObjProperty( castOn, "realm" );
+  if(!tox)
+    SendSysMessage(caster, "The rune must be marked.");
+    return;
+  endif
+  if(!torealm)
+  	torealm := "britannia";
+  endif
+  
+  if(!isValidLoc(tox,toy,torealm))
+    SendSysMessage(caster, "Invalid recall location.");
+    DestroyItem(castOn);
+    return;
+  endif
+  PlaySoundEffect(caster, 0x210);
+  Detach();
+  var chk := 0;
+  if((caster.x >= 5120) && (caster.x <= 5375) && (caster.y >= 0) && (caster.y <= 255))
+    SendSysMessage(caster, "Your spell fails and consumes the rune!");
+    if(castOn.objtype == UOBJ_RUNE)
+      DestroyItem(castOn);
+    elseif(castOn.objtype == 0x6100)
+      removeentry(castOn);
+    endif
+    chk := 1;
+  endif
+  var multicheck := CreateItemAtLocation(1, 1, 0, 0xeed, 1, torealm);
+  multicheck.hidden := 1;
+  if(!MoveItemToLocation(multicheck, tox, toy, toz, MOVEITEM_NORMAL))
+    SendSysMessage(caster, "Something is blocking the location.");
+    if(castOn.objtype == UOBJ_RUNE)
+      DestroyItem(castOn);
+    elseif(castOn.objtype == 0x6100)
+      removeentry(castOn);
+    endif
+    chk := 1;
+  endif
+  if(multicheck.multi)
+    SendSysMessage(caster,"Something is blocking the location.");
+    if(castOn.objtype == UOBJ_RUNE)
+      DestroyItem(castOn);
+    elseif(castOn.objtype == 0x6100)
+      removeentry(castOn);
+    endif
+    chk := 1;
+  endif
+  DestroyItem(multicheck);
+  if(chk == 1)
+    return;
+  endif
+  if (failure == 0);
+  	if(torealm != caster.realm)
+  		MoveObjectToRealm(caster,torealm,1,1,0,MOVECHAR_FORCELOCATION);
+  	endif
+	MoveCharacterToLocation( caster, tox, toy, toz );
+  elseif (failure == 2)
+    SendSysMessage(caster, "Your spell fails and consumes the rune!");
+    if(castOn.objtype == UOBJ_RUNE)
+      DestroyItem(castOn);
+    endif
+  endif
+  PlaySoundEffect(caster, 0x1fd);
+endprogram
+
+function removeentry(castOn)
+  var tox := CInt(GetObjProperty( castOn, "x" ));
+  var toy := CInt(GetObjProperty( castOn, "y" ));
+  var toz := CInt(GetObjProperty( castOn, "z" ));
+  var defs := GetObjProperty(castOn, "runedefs");
+  var holder := {};
+  foreach thing in defs
+    if((Cint(thing[2]) != tox) or (Cint(thing[3]) != toy) or (Cint(thing[4]) != toz))
+      holder.append(thing);
+    endif
+  endforeach
+  SetObjProperty(castOn, "runedefs", holder);
+  EraseObjProperty(castOn, "x");
+  EraseObjProperty(castOn, "y");
+  EraseObjProperty(castOn, "z");
+  return;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/reflect.inc
===================================================================
--- trunk/096/pkg/skills/magery/OLD/reflect.inc	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/reflect.inc	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,41 @@
+use uo;
+use os;
+
+include "include/eventID";
+include "include/sound";
+include "include/tileEffects";
+
+
+function spell_reflect(cast_on)
+	var mr := CInt(GetObjProperty(cast_on, "mr"));
+	if (mr >= 1)
+		PlaySoundEffect(cast_on, SFX_SPELL_MAGIC_REFLECTION);
+		PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 10,10);
+		SendSysMessage(cast_on, "Your magic reflect spell saved you!");
+		if (mr == 1)
+			EraseObjProperty(cast_on, "mr");
+		elseif (mr == 2)
+			var holder, pid;
+			var eqp := GetObjProperty(cast_on, "EquipTimers");
+			foreach thing in ListEquippedItems(cast_on)
+				foreach entry in eqp
+					if ((thing.serial == entry[1]) and (entry[2] == "ref"))
+						holder := GetObjProperty(thing, "pid");
+						break;
+					endif
+				endforeach
+			endforeach
+			pid := getprocess(holder);
+			if (pid)
+				var k := struct;
+				k.+type := EVID_DISCHARGE;
+				pid.sendevent(k);
+			else
+				EraseObjProperty(cast_on, "mr");
+			endif
+		endif
+		return 1;
+	endif
+
+	return 0;
+endfunction

Added: trunk/096/pkg/skills/magery/OLD/reflect.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/reflect.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/reflect.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,21 @@
+use uo;
+use os;
+
+include "include/tileEffects";
+
+
+program spell_reflect( parms )
+	var caster := parms.caster;
+
+	if (!(GetObjProperty(caster, "mr") == "1") )
+		PlaySoundEffect(caster, 0x1ea);
+		PlayObjectCenteredEffect(caster, FX_SPARK_EFFECT, 10,10);
+		SetObjProperty(caster, "mr","1");
+	else
+		PlaySoundEffect(caster,0x005d);
+		PlayObjectCenteredEffect(caster, 0x3735,0x0a, 0x1e);
+		SendSysMessage(caster,"You are already protected.");
+	endif
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/resurrect.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/resurrect.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/resurrect.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,63 @@
+use os;
+use uo;
+
+include "include/eventID";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+include "include/client";
+include "include/resurrection";
+include "include/magic";
+
+
+program spell_resurrect(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var npccfg := ReadConfigFile("::npcdesc");
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+  if(Distance(caster, castOn) > 1)
+	SendSysMessage(caster,"That is too far away!");
+	return;
+  endif
+  PlaySoundEffect(caster, SFX_SPELL_RESSURECTION);
+  PlaySoundEffect(castOn, SFX_SPELL_RESSURECTION);
+  if(castOn.isA(POLCLASS_NPC))
+    var element := npccfg[castOn.npctemplate].elemental;
+    if(element == "undead")
+      PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_HEAL_EFFECT, 0xa, 0xa,0, caster.realm );
+      var ev := array;
+      ev.+ type;
+      ev.+ source;
+      ev.type := EVID_PEACEMADE;
+      SendEvent(castOn, ev);
+      ev.source := caster;
+      SendEvent(castOn, ev);
+      ev.type := EVID_ENGAGED;
+      SendEvent(castOn, ev);
+      PlayObjectCenteredEffect(castOn, 0x37b9,0x03, 0x0a);
+      if( SkillCheck(castOn, RESISTING_SPELLS, 70) > 0 )
+        var dmg := CalcSpellDamage(circle,caster) + (RandomInt(20));
+        ApplyRawDamage(castOn, dmg);
+      else
+        ApplyRawDamage(castOn, AP_GetVital(castOn, HITS) +1);
+      endif
+    endif
+  else
+    if (!castOn.dead)
+	  SendSysMessage(caster,"That isn't dead!");
+	  return;
+    endif
+    if(castOn.criminal)
+      caster.setCriminal(1);
+    endif
+    detach();
+    if(ResNow(castOn)==1)
+      Resurrect(castOn);
+      MurdererStatLoss(caston);
+    endif
+  endif
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/reveal.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/reveal.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/reveal.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,43 @@
+use uo;
+
+include ":attributes:attributes";
+include "include/magic";
+include "include/sound";
+include "include/tileEffects";
+
+
+program reveal(parms)
+  var caster := parms.caster;
+  var range := ( AP_GetSkill( caster, MAGERY  )/10 ) - 5;
+  if (range < 1)
+	range := 1;
+  endif
+  var hiders := ListMobilesNearLocationEx( caster.x, caster.y, caster.z, range, LISTEX_FLAG_HIDDEN, caster.realm );
+  var numfound := 0;
+  PlaySoundEffect(caster, SFX_1FE);
+  if(len(hiders) > 0)
+	foreach mobile in hiders
+	  if( Found( caster,  mobile) )
+		numfound := 1;
+		mobile.hidden := 0;
+		PrintTextAbovePrivate( mobile, "You have been revealed!", mobile );
+		PrintTextAbovePrivate( mobile, "You have found someone!", caster );
+		PlaySoundEffect(mobile, SFX_1FE);
+	  endif
+	endforeach
+  endif
+  if (!numfound)
+    PrintTextAbovePrivate( caster, "You didn't find any anyone.", caster );
+  endif
+endprogram
+
+
+function Found(finder, hider)
+  var magic_skill := Resisted(6, finder, hider, AP_GetSkill( finder, MAGERY ));
+  var resist := (AP_GetSkill( finder,RESISTING_SPELLS)/1.5);
+  if ( magic_skill > resist )
+	return 1;
+  else
+	return 0;
+  endif
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/spells.cfg
===================================================================
--- trunk/096/pkg/skills/magery/OLD/spells.cfg	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/spells.cfg	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,1005 @@
+# $Id: spells.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+##############
+#
+# SpellID : same as the config key val- the ID of the spell
+# Name : the spells's name
+# SpellScript : the spell's SpellScript
+# Circle : the circle of the spell
+# Delivery : the mode of delivering the spell.
+#   direct : target something
+#   indirect : target an area
+#   notarget : no target necessary
+# Noto : casting a harmful spell on a blue will flag you criminal;
+#   casting a beneficial spell on a red will do the same.
+# PowerWords : the words of power for the spell
+# Animation : define a different spellcasting animation
+# animReps : caster will perform the spellcasting animation this many times,
+#   with 750ms passing in between. Overrides the default value in circles.cfg
+# extraWait : after finishing the animations, wait this many ms before spell
+#   actually goes off.  Overrides the default value in circles.cfg
+# Reagent : what regs the spell requires.
+#
+################
+
+###
+# Madman's note:
+#  All spellcasting timing notes come from the LBR/AOS hint book for UO.
+#  The old versions of these values in this file included summoning spells
+#  taking a heck of a lot longer to cast than ordinary spells.
+#  Fortunately, you can tweak these on a by-spell basis, so feel free.
+#
+
+# First circle spells take 500ms to cast.
+
+Spell 1
+{
+    SpellId     1
+    Name        Clumsy
+    SpellScript      :magery:clumsy
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Uus Jux
+    Reagent     bloodmoss
+    Reagent     nightshade
+
+}
+
+Spell 2
+{
+    SpellId     2
+    Name        Create Food
+    SpellScript      :magery:createFood
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	notarget
+    Noto	helpful
+    PowerWords  In Mani Ylem
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     MandrakeRoot
+}
+
+Spell 3
+{
+    SpellId     3
+    Name        Feeblemind
+    SpellScript      :magery:feeblemind
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Rel Wis
+    Reagent     nightshade
+    Reagent     ginseng
+}
+
+Spell 4
+{
+    SpellId     4
+    Name        Heal
+    SpellScript      :magery:heal
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	helpful
+    PowerWords  In Mani
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     spidersilk
+}
+
+Spell  5
+{
+    SpellId     5
+    Name        Magic Arrow
+    SpellScript      :magery:magicArrow
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	harmful
+    PowerWords  In Por Ylem
+    Reagent     blackpearl
+    Reagent     nightshade
+}
+
+Spell 6
+{
+    SpellId     6
+    Name        Night Sight
+    SpellScript      :magery:nightSight
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	helpful
+    PowerWords  In Lor
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 7
+{
+    SpellId     7
+    Name        Reactive Armor
+    SpellScript      :magery:reactiveArmor
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	helpful
+    PowerWords  Flam Sanct
+    Reagent     garlic
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 8
+{
+    SpellId     8
+    Name        Weaken
+    SpellScript      :magery:weaken
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Des Mani
+    Reagent     garlic
+    Reagent     nightshade
+}
+
+# Second circle spells take 750ms to cast.
+
+Spell 9
+{
+    SpellId     9
+    Name        Agility
+    SpellScript      :magery:agility
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	helpful
+    PowerWords  Ex Uus
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+}
+
+Spell 10
+{
+    SpellId     10
+    Name        Cunning
+    SpellScript      :magery:cunning
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	helpful
+    PowerWords  Uus Wis
+    Reagent     Nightshade
+    Reagent     mandrakeroot
+}
+
+Spell 11
+{
+    SpellId     11
+    Name        Cure
+    SpellScript      :magery:cure
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	helpful
+    PowerWords  An Nox
+    Reagent     garlic
+    Reagent     ginseng
+}
+
+Spell 12
+{
+    SpellId     12
+    Name        Harm
+    SpellScript      :magery:harm
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	harmful
+    PowerWords  An Mani
+    Reagent     nightshade
+    Reagent     spidersilk
+}
+
+Spell 13
+{
+    SpellId     13
+    Name        Magic Trap
+    SpellScript      :magery:magicTrap
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	harmful
+    PowerWords  In Jux
+    Reagent     garlic
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 14
+{
+    SpellId     14
+    Name        Magic Untrap
+    SpellScript      :magery:magicUntrap
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	harmful
+    PowerWords  An Jux
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     SulphurousAsh
+}
+
+Spell 15
+{
+    SpellId     15
+    Name        Protection
+    SpellScript      :magery:protection
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	helpful
+    PowerWords  Uus Sanct
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     SulphurousAsh
+}
+
+Spell 16
+{
+    SpellId     16
+    Name        Strength
+    SpellScript      :magery:strength
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	helpful
+    PowerWords  Uus Mani
+    Reagent     mandrakeroot
+    Reagent     nightshade
+}
+
+# Third circle spells take 1s to cast.
+
+Spell 17
+{
+    SpellId     17
+    Name        Bless
+    SpellScript      :magery:bless
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	direct
+    Noto	helpful
+    PowerWords  Rel Sanct
+    Reagent     garlic
+    Reagent     mandrakeroot
+}
+
+Spell 18
+{
+    SpellId     18
+    Name        Fireball
+    SpellScript      :magery:fireball
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Vas Flam
+    Reagent     blackpearl
+    Reagent     sulphurousash
+}
+
+Spell 19
+{
+    SpellId     19
+    Name        Magic Lock
+    SpellScript      :magery:magicLock
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	direct
+    Noto	neutral
+    PowerWords  An Por
+    Reagent     bloodmoss
+    Reagent     garlic
+    Reagent     SulphurousAsh
+}
+
+Spell 20
+{
+    SpellId     20
+    Name        Poison
+    SpellScript      :magery:poison
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	direct
+    Noto	harmful
+    PowerWords  In Nox
+    Reagent     nightshade
+}
+
+Spell 21
+{
+    SpellId     21
+    Name        Telekinesis
+    SpellScript      :magery:telekinesis
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery 	direct
+    Noto	harmful
+    PowerWords  Ort Por Ylem
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+}
+
+Spell 22
+{
+    SpellId     22
+    Name        Teleport
+    SpellScript      :magery:teleport
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	indirect
+    Noto	neutral
+    PowerWords  Rel Por
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+}
+
+Spell 23
+{
+    SpellId     23
+    Name        Unlock
+    SpellScript      :magery:unlock
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	direct
+    Noto	neutral
+    PowerWords  Ex Por
+    Reagent     bloodmoss
+    Reagent     garlic
+}
+
+Spell 24
+{
+    SpellId     24
+    Name        Wall of Stone
+    SpellScript      :magery:wallOfStone
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	indirect
+    Noto	neutral
+    PowerWords  In Sanct Ylem
+    Reagent     bloodmoss
+    Reagent     garlic
+}
+
+# Fourth circle spells take 1250ms to cast
+
+Spell 25
+{
+    SpellId     25
+    Name        Arch Cure
+    SpellScript      :magery:archCure
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	indirect
+    Noto	helpful
+    PowerWords  Vas An Nox
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     MandrakeRoot
+}
+
+Spell 26
+{
+    SpellId     26
+    Name        Arch Protection
+    SpellScript      :magery:archProt
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	indirect
+    Noto	helpful
+    PowerWords  Vas Uus Sanct
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     mandrakeroot
+    Reagent     SulphurousAsh
+}
+
+Spell 27
+{
+    SpellId     27
+    Name        Curse
+    SpellScript      :magery:curse
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Des Sanct
+    Reagent     garlic
+    Reagent     nightshade
+    Reagent     SulphurousAsh
+}
+
+Spell 28
+{
+    SpellId     28
+    Name        Fire Field
+    SpellScript      :magery:fireField
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  In Flam Grav
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+    Reagent     blackpearl
+}
+
+Spell 29
+{
+    SpellId     29
+    Name        Greater Heal
+    SpellScript      :magery:gHeal
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	direct
+    Noto	helpful
+    PowerWords  In Vas Mani
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 30
+{
+    SpellId     30
+    Name        Lightning
+    SpellScript      :magery:lightning
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Por Ort Grav
+    Reagent     blackpearl
+    Reagent     sulphurousash
+    Reagent 	MandrakeRoot
+}
+
+Spell 31
+{
+    SpellId     31
+    Name        Mana Drain
+    SpellScript      :magery:manaDrain
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Ort Rel
+    Reagent     blackpearl
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 32
+{
+    SpellId     32
+    Name        Recall
+    SpellScript      :magery:recall
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	notarget
+    Noto	neutral
+    PowerWords  Kal Ort Por
+    Reagent     blackpearl
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+}
+
+# Fifth circle spells take 1500ms to cast
+
+Spell 33
+{
+    SpellId     33
+    Name        Blade Spirit
+    SpellScript      :magery:bladeSpirit
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  In Jux Hur Ylem
+    Reagent     blackpearl
+    Reagent     mandrakeroot
+    Reagent     nightshade
+}
+
+Spell 34
+{
+    SpellId     34
+    Name        Dispel Field
+    SpellScript      :magery:dispelField
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	direct
+    Noto	neutral
+    PowerWords  An Grav
+    Reagent     blackpearl
+    Reagent     garlic
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 35
+{
+    SpellId     35
+    Name        Incognito
+    SpellScript      :magery:incognito
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	notarget
+    Noto	neutral
+    PowerWords  Kal In Ex
+    Reagent     bloodmoss
+    Reagent     garlic
+    Reagent     nightshade
+}
+
+Spell 36
+{
+    SpellId     36
+    Name        Magic Reflection
+    SpellScript      :magery:reflect
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	notarget
+    Noto	helpful
+    PowerWords  In Jux Sanct
+    Reagent     garlic
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 37
+{
+    SpellId     37
+    Name        Mind Blast
+    SpellScript      :magery:mindBlast
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Por Corp Wis
+    Reagent     blackpearl
+    Reagent     mandrakeroot
+    Reagent     nightshade
+    Reagent     SulphurousAsh
+}
+
+Spell 38
+{
+    SpellId     38
+    Name        Paralyze
+    SpellScript      :magery:paralyze
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	direct
+    Noto	harmful
+    PowerWords  An Ex Por
+    Reagent     garlic
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 39
+{
+    SpellId     39
+    Name        Poison Field
+    SpellScript      :magery:poisonField
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  In Nox Grav
+    Reagent     blackpearl
+    Reagent     nightshade
+    Reagent     spidersilk
+}
+
+Spell 40
+{
+    SpellId     40
+    Name        SummonCreature
+    SpellScript      :magery:summonCreature
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	indirect
+    Noto	neutral
+    PowerWords  Kal Xen
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+# Sixth circle spells take 1750ms to cast
+
+Spell 41
+{
+    SpellId     41
+    Name        Dispel
+    SpellScript      :magery:dispel
+    Script	:spellcasting:spellcast
+    Circle      6
+    PowerWords  An Ort
+    Reagent     garlic
+    Reagent     mandrakeroot
+    Reagent     SulphurousAsh
+}
+
+Spell 42
+{
+    SpellId     42
+    Name        Energy Bolt
+    SpellScript      :magery:eBolt
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Corp Por
+    Reagent     blackpearl
+    Reagent     nightshade
+}
+
+Spell 43
+{
+    SpellId     43
+    Name        Explosion
+    SpellScript      :magery:explosion
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Vas Ort Flam
+    Reagent     blackpearl
+    Reagent     mandrakeroot
+    Reagent     SulphurousAsh
+}
+
+Spell 44
+{
+    SpellId     44
+    Name        Invisibility
+    SpellScript      :magery:invisibility
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	direct
+    Noto	helpful
+    PowerWords  An Lor Xen
+    Reagent     bloodmoss
+    Reagent     nightshade
+}
+
+Spell 45
+{
+    SpellId     45
+    Name        Mark
+    SpellScript      :magery:mark
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	notarget
+    Noto	neutral
+    PowerWords  Kal Por Ylem
+    Reagent     blackpearl
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+}
+
+Spell 46
+{
+    SpellId     46
+    Name        Mass Curse
+    SpellScript      :magery:massCurse
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  Vas Des Sanct
+    Reagent     garlic
+    Reagent     mandrakeroot
+    Reagent     nightshade
+    Reagent     SulphurousAsh
+}
+
+Spell 47
+{
+    SpellId     47
+    Name        Paralyze Field
+    SpellScript      :magery:paraField
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  In Ex Grav
+    Reagent     blackpearl
+    Reagent     ginseng
+    Reagent     spidersilk
+}
+
+Spell 48
+{
+    SpellId     48
+    Name        Reveal
+    SpellScript      :magery:reveal
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	indirect
+    Noto	neutral
+    PowerWords  Wis  Quas
+    Reagent     bloodmoss
+    Reagent     SulphurousAsh
+}
+
+# Seventh circle spells take 2s to cast
+
+Spell 49
+{
+    SpellId     49
+    Name        Chain Lightning
+    SpellScript      :magery:chainLightning
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  Vas Ort Grav
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     blackpearl
+    Reagent     SulphurousAsh
+}
+
+Spell 50
+{
+    SpellId     50
+    Name        Energy Field
+    SpellScript      :magery:energyField
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	indirect
+    Noto	neutral
+    PowerWords  In Sanct Grav
+    Reagent     blackpearl
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 51
+{
+    SpellId     51
+    Name        FlameStrike
+    SpellScript      :magery:flameStrike
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Kal Vas Flam
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 52
+{
+    SpellId     52
+    Name        Gate
+    SpellScript      :magery:gate
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	notarget
+    Noto	neutral
+    PowerWords  Vas Rel Por
+    Reagent     blackpearl
+    Reagent     mandrakeroot
+    Reagent     SulphurousAsh
+}
+
+Spell 53
+{
+    SpellId     53
+    Name        Mana Vampire
+    SpellScript      :magery:manaVamp
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Ort Sanct
+    Reagent     blackpearl
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 54
+{
+    SpellId     54
+    Name        Mass Dispel
+    SpellScript      :magery:massDispel
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	indirect
+    Noto	neutral
+    PowerWords  Vas An Ort
+    Reagent     blackpearl
+    Reagent     garlic
+    Reagent     mandrakeroot
+    Reagent     SulphurousAsh
+}
+
+Spell 55
+{
+    SpellId     55
+    Name        Meteor Swarm
+    SpellScript      :magery:meteorSwarm
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  Kal Des Flam Ylem
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     SpiderSilk
+    Reagent     SulphurousAsh
+}
+
+Spell 56
+{
+    SpellId     56
+    Name        Polymorph
+    SpellScript      :magery:polymorph
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	notarget
+    Noto	helpful
+    PowerWords  Vas Ylem Rel
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+# Eighth circle spells take 2250ms to cast
+
+Spell 57
+{
+    SpellId     57
+    Name        Earthquake
+    SpellScript      :magery:earthquake
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	notarget
+    Noto	neutral
+    PowerWords  In Vas Por
+    Reagent     bloodmoss
+    Reagent     ginseng
+    Reagent     mandrakeroot
+    Reagent     SulphurousAsh
+}
+
+Spell 58
+{
+    SpellId     58
+    Name        EnergyVortex
+    SpellScript      :magery:vortex
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	indirect
+    Noto	harmful
+    Animation   0x11
+    PowerWords  Vas Corp Por
+    Reagent     blackpearl
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     nightshade
+}
+
+Spell 59
+{
+    SpellId     59
+    Name        Resurrection
+    SpellScript      :magery:resurrect
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	direct
+    Noto	neutral
+    PowerWords  An Corp
+    Reagent     bloodmoss
+    Reagent     garlic
+    Reagent     ginseng
+}
+
+Spell 60
+{
+    SpellId     60
+    Name        Summon Air Elemental
+    SpellScript      :magery:summonAir
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	indirect
+    Noto	neutral
+    Animation   0x11
+    PowerWords  Kal Vas Xen Hur
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 61
+{
+    SpellId     61
+    Name        Summon Daemon
+    SpellScript      :magery:summonDaemon
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	indirect
+    Noto	neutral
+    Animation   0x11
+    PowerWords  Kal Vas Xen Corp
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 62
+{
+    SpellId     62
+    Name        Summon Earth Elemental
+    SpellScript      :magery:summonEarth
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	indirect
+    Noto	neutral
+    Animation   0x11
+    PowerWords  Kal Vas Xen Ylem
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 63
+{
+    SpellId     63
+    Name        Summon Fire Elemental
+    SpellScript      :magery:summonFire
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	indirect
+    Noto	neutral
+    Animation   0x11
+    PowerWords  Kal Vas Xen Flam
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 64
+{
+    SpellId     64
+    Name        Summon Water Elemental
+    SpellScript      :magery:summonWater
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	indirect
+    Noto	neutral
+    Animation   0x11
+    PowerWords  Kal Vas Xen An Flam
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}

Added: trunk/096/pkg/skills/magery/OLD/strength.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/strength.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/strength.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,26 @@
+use os;
+use uo;
+use util;
+
+include "include/statMod";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+
+
+program spell_strength(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+	PlaySoundEffect(castOn, SFX_SPELL_STRENGTH);
+	PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 7,7);
+	if (!CanMod(castOn, "str"))
+		SendSysMessage(caster,"Already under the influence!");
+		return;
+	endif
+	var magery := AP_GetSkill(caster, MAGERY);
+	var mod_amount := GetModAmount( magery );
+	var duration := GetModDuration( magery );
+	DoTempMod(castOn, "str", mod_amount, duration);
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/summon.inc
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summon.inc	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/summon.inc	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,41 @@
+use uo;
+use os;
+
+include "include/client";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+
+
+function DoSummon( caster, circle, npctemplate, cast_loc )
+  var thecritter;
+  var magery := AP_GetSkill(caster, MAGERY);
+  var duration := 20 + (magery * 2);
+  var parms := {};
+  parms .+ script := "tamed";
+  Detach();
+  sleepms(100);
+  thecritter := CreateNpcFromTemplate(npctemplate, cast_loc.x, cast_loc.y,cast_loc.z, parms, caster.realm);
+  if(npctemplate == "summoneddaemon")
+    PlaySoundEffect(caster, 535);
+  else
+    if(circle == 8)
+      PlaySoundEffect(caster, 536);
+      PerformAction(thecritter, 12);
+    else
+      PlaySoundEffect(caster, 534);
+    endif
+  endif
+  SetObjProperty(thecritter,"master", caster.serial);
+  SetScriptController( thecritter);
+  SetObjProperty(thecritter, "happiness",100);
+  SetObjProperty(thecritter, "summoned",1);
+  RestartScript(thecritter);
+  //SetBaseSkillBaseValue( thecritter, SKILLID_MAGICRESISTANCE,  magery * 10  );
+  AP_SetTrueSkill(thecritter, RESISTING_SPELLS, magery*10);
+  sleep(duration);
+  PlaySoundEffect( thecritter, SFX_SPELL_MANA_VAMPIRE );
+  PlayStationaryEffect( thecritter.x, thecritter.y, thecritter.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
+  MoveCharacterToLocation(thecritter,0,0,0,MOVECHAR_FORCELOCATION);
+  ApplyRawDamage(thecritter, AP_GetVital(thecritter, HITS) + 3);
+endfunction

Added: trunk/096/pkg/skills/magery/OLD/summonAir.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summonAir.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/summonAir.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,10 @@
+include "summon";
+
+program spell_summonAirElemental(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+
+	DoSummon(caster, 8, "airelemental", castOn);
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/summonCreature.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summonCreature.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/summonCreature.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,55 @@
+use util;
+
+include "summon";
+include ":attributes:attributes";
+
+
+program spell_summonCreature( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+  
+  var thecreature;
+  var critgroup;
+  var basemagery := CInt(AP_GetSkill(caster, MAGERY));
+  if (basemagery < 70)
+	critgroup := RandomInt(1);
+  elseif (basemagery < 80)
+	critgroup := RandomInt(1)+1;
+  elseif (basemagery < 90)
+	critgroup := RandomInt(1)+2;
+  else
+	critgroup := 3;
+  endif
+  var critter := RandomInt(19);
+	  case (critter)
+		0: thecreature := "chicken";
+		1: thecreature := "cat";
+		2: thecreature := "slime";
+		3: thecreature := "sheep";
+		4: thecreature := "pig";
+		5: thecreature := "dog";
+		6: thecreature := "grat";
+		7: thecreature := "eagle";
+		8: case(RandomInt(4))
+		     0: thecreature := "horse";
+		     1: thecreature := "horse2";
+		     2: thecreature := "horse3";
+		     3: thecreature := "horse4";
+		   endcase
+	    9: thecreature := "gorilla";
+	   10: thecreature := "panther";
+	   11: thecreature := "deer";
+	   12: thecreature := "bear";
+	   13: thecreature := "ghart";
+	   14: thecreature := "blackbear";
+	   15: thecreature := "alligator";
+	   16: thecreature := "giantspider";
+	   17: thecreature := "giant_serpent";
+	   18: thecreature := "polar";
+  endcase
+ 
+  DoSummon( caster, circle, thecreature, castOn );
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/summonDaemon.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summonDaemon.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/summonDaemon.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,11 @@
+include "summon";
+
+
+program summonDaemon( parms )
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+
+	DoSummon( caster, 8, "summoneddaemon", castOn );
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/summonEarth.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summonEarth.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/summonEarth.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,11 @@
+include "summon";
+
+
+program summonEarthElemental(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+
+	DoSummon(caster, 8, "earthelemental", castOn);
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/summonFire.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summonFire.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/summonFire.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,11 @@
+include "summon";
+
+
+program spell_summonFireElemental(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+
+	DoSummon(caster, 8, "fireelemental", castOn);
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/summonWater.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summonWater.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/summonWater.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,11 @@
+include "summon";
+
+
+program spell_summonWaterElemental(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+  
+	DoSummon(caster, 8, "waterelemental", castOn);
+
+	return;
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/telekinesis.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/telekinesis.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/telekinesis.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,47 @@
+use uo;
+
+include "include/client";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+include ":magery:reflect";
+include "include/magic";
+
+
+program spell_telekinesis(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+  
+  PlaySoundEffect( caster, SFX_SPELL_TELEKINESIS );
+  if( castOn.npctemplate || castOn.acctname )
+    SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "telekinesis" });
+    if(spell_reflect(castOn))
+      castOn := caster;
+    endif
+    PlaySoundEffect(castOn, 0x144);
+    PlayObjectCenteredEffect(castOn, 0x37b9,0x03, 0x0a);
+    var dmg := RandomInt(AP_GetSkill(caster, MAGERY) / 10);
+    ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
+    if((castOn.graphic  == 0x190) or (castOn.graphic == 0x191))
+      PerformAction(castOn, 20);
+    endif
+  elseif(castOn.multi.serial)
+    SendSysMessage(caster, "You cannot use that on items inside houses.");
+    return;
+  elseif(castOn.container.serial)
+    SendSysMessage(caster, "You cannot use that on items inside containers.");
+    return;
+  elseif((castOn.isa(POLCLASS_CONTAINER)) and (GetObjProperty(castOn, "trap_type")))
+    var parms := array(caster, castOn);
+    start_script(":tinkering:tinkerTraps", parms);
+  else
+    if(MoveItemToContainer( castOn, caster.backpack, x := -1, y := -1 ))
+      PrintTextAbovePrivate(caster, "You pick up the item with your mind.", caster);
+    else
+      PrintTextAbovePrivate(caster, "You cannot will it to move.", caster);
+    endif
+  endif
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/teleport.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/teleport.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/teleport.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,35 @@
+use uo;
+use os;
+
+include "include/client";
+include "include/sound";
+include "include/tileEffects";
+include "include/isValidLoc";
+
+
+program spell_teleport( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  if (!isValidLoc(castOn.x, castOn.y))
+    SendSysMessage(caster, "You cannot teleport there.");
+    return;
+  endif
+  var sx := caster.x, sy := caster.y, sz := caster.z; 
+  var multicheck := CreateItemAtLocation(castOn.x, castOn.y, castOn.z, 0xeed, 1, caster.realm);
+  multicheck.hidden := 1;
+  if (multicheck.multi.serial != error)
+    SendSysMessage(caster,"You cannot teleport there.");
+    DestroyItem(multicheck);
+    return;
+  else
+    if((multicheck.x > 5120) && (multicheck.x < 6133) && (multicheck.y > 2063) && (multicheck.y < 2303))
+      DestroyItem(multicheck);
+      return;
+    endif
+    DestroyItem(multicheck);
+    MoveCharacterToLocation( caster, castOn.x, castOn.y, castOn.z );
+    PlayStationaryEffect( sx, sy, sz, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
+    PlayStationaryEffect( caster.x, caster.y, caster.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
+    PlaySoundEffect( caster, SFX_SPELL_TELEPORT );
+  endif
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/unlock.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/unlock.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/unlock.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,84 @@
+// $Id: unlock.src 278 2005-09-28 19:20:39Z muaddiblsd $
+
+use os;
+use uo;
+use util;
+
+include "include/sound";
+include "include/client";
+
+program spell_unlock(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  if (!castOn.locked)
+    SendSysMessage(caster,"That is not locked!");
+    return;
+  endif
+  if ((castOn.multi) || (GetObjProperty(castOn,"houseserial")) || (GetObjProperty(castOn,"house_serial")))
+    SendSysMessage(caster, "You cannot magically unlock that!");
+//    PlayLightningBoltEffect(caster);
+    return;
+  endif
+  if (GetObjProperty(castOn, "#U"))
+    if (GetObjProperty(castOn, "#U") > ReadGameClock())
+      SendSysMessage(caster, "You must wait to pick this lock!");
+      return;
+    endif
+  endif
+  var diff := CInt(GetObjProperty(castOn,"MLockPickDiff"));
+  if(diff)
+    PlaySoundEffect(caster, SFX_SPELL_UNLOCK);
+    if(diff <= 25)
+      castOn.locked := 0;
+      PrintTextAbovePrivate(castOn, "*Unlocked!*", caster);
+      EraseObjProperty(castOn, "MLockPickDiff");
+      return;
+    else
+      SendSysMessage(caster, "Your spell doesn't seem to work on that lock.");
+      return;
+    endif
+  else
+    var diffi := CInt(GetObjProperty(castOn,"LockPickDiff"));
+    if(diffi)
+      PlaySoundEffect(caster, SFX_SPELL_UNLOCK);
+      if(diffi <= 25)
+        castOn.locked := 0;
+        PrintTextAbovePrivate(castOn, "*Unlocked!*", caster);
+        return;
+      else
+        SendSysMessage(caster, "Your spell doesn't seem to work on that lock.");
+        return;
+      endif
+    else
+      if(GetObjProperty(castOn, "level"))
+        PickTreasureChest(caster, castOn);
+      else
+        SendSysMessage(castOn, "You can't seem to unlock that!");
+        return;
+      endif
+    endif
+  endif
+endprogram
+
+function PickTreasureChest(me, chest)
+  var lvl := GetObjProperty(chest,"level");
+  if(!lvl)
+    SendSysMessage(me, "You cannot pick that.");
+    return;
+  endif
+  if(!chest.locked)
+    SendSysMessage(me,"That doesn't appear to be locked.");
+    return;
+  endif
+  PlaySoundEffect(me, SFX_242);
+  sleep(1);
+  var diff := (lvl * 25) - 10;
+  if(diff <= 25)
+    PlaySoundEffect(chest,SFX_200);
+    PrintTextAbovePrivate(chest, "*Unlocked!*", me);
+    chest.locked := 0;
+  else
+    SendSysMessage(me, "Your spell doesn't seem to work on that lock.");
+    return;
+  endif
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/OLD/vortex.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/vortex.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/vortex.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,24 @@
+use os;
+use uo;
+use util;
+
+include "include/client";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+
+
+program spell_vortex( parms )
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var thecritter := CreateNpcFromTemplate("vortex", castOn.x, castOn.y,castOn.z, 0, caster.realm);
+  PlaySoundEffect(thecritter,SFX_SPELL_ENERGY_VORTEX);
+  SetObjProperty(thecritter, "summoned",1);
+  SetObjProperty(thecritter, "master", caster.serial);
+  Detach();
+  sleep( (AP_GetSkill(caster, MAGERY) ) );
+  PlaySoundEffect( thecritter, SFX_SPELL_MANA_VAMPIRE );
+  PlayStationaryEffect( thecritter.x, thecritter.y, thecritter.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
+  MoveCharacterToLocation(thecritter,0,0,0,MOVECHAR_FORCELOCATION);
+  ApplyRawDamage(thecritter, AP_GetVital(thecritter, HITS) + 3);
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/wallOfStone.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/wallOfStone.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/wallOfStone.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,35 @@
+use os;
+use uo;
+use util;
+
+include "include/fields";
+include "include/sound";
+include ":attributes:attributes";
+
+
+program spell_wallOfStone(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var fields := {};
+  var duration;
+  var x := castOn.x;
+  var y := castOn.y;
+  var z := castOn.z;
+  case(get_direction(caster))
+	"NS" : fields:= CreateNorthSouthField(caster, 0x80, x, y, z, 5);
+	"EW" : fields:= CreateEastWestField(caster, 0x80, x, y, z, 5);
+  endcase
+  Detach();
+  duration := CInt(AP_GetSkill(caster, MAGERY) )/2;
+  if (duration < 20)
+    duration := 20;
+  endif
+  var i;
+  for (i := 1; i <= 5; i := i + 1)
+    PlaySoundEffect(fields[i], SFX_SPELL_WALL_OF_STONE);
+  endfor
+  sleep(duration);
+  foreach fieldpart in fields
+    DestroyItem(fieldpart);
+  endforeach
+endprogram

Added: trunk/096/pkg/skills/magery/OLD/weaken.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/weaken.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/OLD/weaken.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -0,0 +1,33 @@
+use os;
+use uo;
+use util;
+
+include "include/statMod";
+include "include/sound";
+include "include/tileEffects";
+include ":attributes:attributes";
+include ":magery:reflect";
+include "include/magic";
+
+
+program spell_weaken(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  var spellid := parms.spellid;
+  var spellcfg := ReadConfigFile(":*:spells");
+  var circle := spellcfg[spellid].circle;
+
+  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "weaken" });
+  if(spell_reflect(castOn))
+	castOn := caster;
+  endif
+  PlaySoundEffect(castOn, SFX_SPELL_WEAKEN);
+  PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 7,7);
+  if(!CanMod(castOn, "str"))
+	return;
+  endif
+  var magery := AP_GetSkill(caster, MAGERY);
+  var modAmount := Resisted(circle,caster,castOn,(GetModAmount( magery )));
+  var duration := GetModDuration( magery );
+  DoTempMod(castOn, "str", 0 - modAmount, duration);
+endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/agility.src
===================================================================
--- trunk/096/pkg/skills/magery/agility.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/agility.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,21 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/statMod";
-include ":attributes:attributes";
-
-program agility( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  PlaySoundEffect(caster, 0x1e8);
-  PlayObjectCenteredEffect(caster, 0x373a, 7,7);
-  if(!CanMod(castOn, "dex"))
-    SendSysMessage(caster,"Another existing effect negates your spell!");
-    return;
-  endif
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := GetModAmount( magery );
-  var duration := GetModDuration( magery );
-  DoTempMod(castOn, "dex", modAmount, duration);
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/archCure.src
===================================================================
--- trunk/096/pkg/skills/magery/archCure.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/archCure.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,48 +0,0 @@
-use uo;
-use cfgfile;
-
-include "include/eventID";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":timedscripts:timedScripts";
-include ":timedscripts:poisonUtil";
-
-program archCure(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var npccfg := ReadConfigFile("::npcdesc");
-  PlaySoundEffect(caster, SFX_SPELL_ARCH_CURE);
-  var magery := AP_GetSkill(caster, MAGERY);
-  var potency := CInt(AP_GetSkill( caster, MAGERY ) /33)+1;
-  foreach castOn in ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, CInt(magery/15), caster.realm );
-    if((CheckLineOfSight(castOn, caster)) and (castOn.cmdlevel < 2))
-	  PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 10,10);
-      if(castOn.isA(POLCLASS_NPC))
-        var element := npccfg[castOn.npctemplate].elemental;
-        if(element == "poison")
-          var ev := array;
-          ev.+ type;
-          ev.+ source;
-          ev.type := EVID_PEACEMADE;
-          SendEvent(castOn, ev);
-          ev.source := caster;
-          SendEvent(castOn, ev);
-          ev.type := EVID_ENGAGED;
-          SendEvent(castOn, ev);
-          ApplyRawDamage(castOn, potency);
-        endif
-      endif
-      if (TS_GetTimerNames(castOn, "P").size() > 0)
-        TS_CurePoison(castOn, 180, "P", potency);
-        if (TS_GetTimerNames(castOn, "P").size() > 0)
-          SendSysMessage(caster, "You cure some poison.");  
-          SendSysMessage(castOn, caster.name + " has partially cured you!");
-        else
-          SendSysMessage(caster, castOn.name + " cured.");
-          SendSysMessage(castOn, caster.name + " has cured you completely!");
-        endif
-      endif
-    endif
-  endforeach
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/archProt.src
===================================================================
--- trunk/096/pkg/skills/magery/archProt.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/archProt.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,27 +0,0 @@
-use uo;
-use os;
-
-include "include/sound";
-include "include/tileEffects";
-include "include/statMod";
-include ":attributes:attributes";
-
-
-program archProtection(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	PlaySoundEffect(caster, SFX_SPELL_PROTECTION);
-	var magery := AP_GetSkill(caster, MAGERY);
-	var modAmount := CInt(RandomInt(6) + 5);
-	var duration := GetModDuration( magery );
-	foreach castOn in ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, CInt(magery/15), caster.realm );
-		if ((CheckLineOfSight(castOn, caster)) and (castOn.cmdlevel < 2))
-			if (CanMod(castOn, "ar"))
-				PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 7,7);
-				DoTempMod(castOn, "ar", modAmount, duration);
-			endif
-		endif
-	endforeach
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/bladeSpirit.src
===================================================================
--- trunk/096/pkg/skills/magery/bladeSpirit.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/bladeSpirit.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,23 +0,0 @@
-use uo;
-use os;
-use util;
-
-include ":attributes:attributes";
-include "include/tileEffects";
-include "include/sound";
-
-
-program bladeSpirit(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var thecritter := CreateNpcFromTemplate("bladespirit", castOn.x, castOn.y, castOn.z, 0, caster.realm);
-  PlaySoundEffect(thecritter, SFX_SPELL_BLADE_SPIRITS);
-  SetObjProperty(thecritter, "summoned", 1);
-  SetObjProperty(thecritter, "master", caster.serial);
-  Detach();
-  sleep( (AP_GetSkill( caster, MAGERY ) ) );
-  PlaySoundEffect( thecritter, SFX_SPELL_MANA_VAMPIRE );
-  PlayStationaryEffect( thecritter.x, thecritter.y, thecritter.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
-  MoveCharacterToLocation(thecritter,0,0,0,MOVECHAR_FORCELOCATION);
-  ApplyRawDamage(thecritter, AP_GetVital(thecritter, "Hits") + 3);
-endprogram

Deleted: trunk/096/pkg/skills/magery/bless.src
===================================================================
--- trunk/096/pkg/skills/magery/bless.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/bless.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,28 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/statMod";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-
-
-program bless(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  PlaySoundEffect(castOn, SFX_SPELL_BLESS);
-  PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 10,10);
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := GetModAmount(magery);
-  var duration := GetModDuration(magery);
-  if(CanMod(castOn, "str"))
-	DoTempMod(castOn, "str", modAmount, duration);
-  endif
-  if(CanMod(castOn, "dex"))
-	DoTempMod(castOn, "dex", modAmount, duration);
-  endif
-  if(CanMod(castOn, "int"))
-	DoTempMod(castOn, "int", modAmount, duration);
-  endif
-endprogram

Deleted: trunk/096/pkg/skills/magery/chainLightning.src
===================================================================
--- trunk/096/pkg/skills/magery/chainLightning.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/chainLightning.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,40 +0,0 @@
-use uo;
-use os;
-use util;
-use cfgfile;
-
-include ":magery:reflect";
-include "include/spellAttack";
-include "include/sound";
-include "include/tileEffects";
-include "include/magic";
-
-program chainLightning( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  var dmg;
-  var range := 2;
-  var victims := ListMobilesNearLocationEx( castOn.x, castOn.y, castOn.z, range, 0x03, caster.realm);
-  Detach();
-  foreach mobile in victims
-    if((CheckLineOfSight(mobile, caster)) and (mobile.cmdlevel < 2))
-      SetObjProperty(mobile, "LastHit", {caster.name, caster.serial, "chain lightning"});
-      if(spell_reflect(mobile))
-        mobile := caster;
-      endif
-      dmg := RandomDiceRoll("6d8");
-      send_attack(mobile,caster, 49);
-      PlayLightningBoltEffect( mobile );
-      PlaySoundEffect(mobile, SFX_SPELL_LIGHTNING);
-      if(mobile.isA(POLCLASS_NPC))
-        dmg := dmg * 2;
-      endif
-      ApplyRawDamage( mobile, Resisted(circle,caster,mobile,dmg) );
-      sleepms(600);
-    endif
-  endforeach
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/clumsy.src
===================================================================
--- trunk/096/pkg/skills/magery/clumsy.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/clumsy.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,34 +0,0 @@
-use uo;
-use os;
-use util;
-use cfgfile;
-
-include "include/statMod";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include "reflect";
-include "include/magic";
-
-program clumsy( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "clumsy" });
-  if(spell_reflect(castOn))
-	castOn := caster;
-  endif
-  PlaySoundEffect(castOn, SFX_SPELL_CURE);
-  PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 7,7);
-  if(!CanMod(castOn, "dex"))
-	SendSysMessage(caster,"Already under the influence!");
-	return;
-  endif
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := Resisted(circle,caster,castOn,(GetModAmount( magery )));
-  var duration := GetModDuration( magery );
-  DoTempMod(castOn, "dex", 0 - modAmount, duration);
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/createFood.src
===================================================================
--- trunk/096/pkg/skills/magery/createFood.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/createFood.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,25 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/client";
-
-
-program spell_createFood(parms)
-	var caster := parms.caster;
-	var food;
-	case (RandomInt(8))
-		0:	food := 0x09c9;
-		1:	food := 0x09ea;
-		2:	food := 0x1040;
-		3:	food := 0x09b7;
-		4: 	food := 0x1608;
-		5: 	food := 0x09e9;
-		6: 	food := 0x1044;
-		7: 	food := 0x0c77;
-	endcase
-	PlaySoundEffect(caster, 0x01e3);
-	CreateItemInBackpack(caster, food, 1);
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/cunning.src
===================================================================
--- trunk/096/pkg/skills/magery/cunning.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/cunning.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,28 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/statMod";
-include "include/client";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-
-
-program spell_cunning(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	PlaySoundEffect(castOn, SFX_SPELL_CUNNING);
-	PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 7,7);
-	if (!CanMod(castOn, "int"))
-		SendSysMessage(caster,"Already under the influence!");
-		return;
-	endif
-	var magery := AP_GetSkill(caster, MAGERY);
-	var modAmount := GetModAmount( magery );
-	var duration := GetModDuration( magery );
-	DoTempMod(castOn, "int", modAmount, duration);
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/cure.src
===================================================================
--- trunk/096/pkg/skills/magery/cure.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/cure.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,44 +0,0 @@
-use uo;
-use cfgfile;
-
-include "include/eventID";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include ":timedscripts:timedScripts";
-include ":timedscripts:poisonUtil";
-
-
-program cure( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var npccfg := ReadConfigFile("::npcdesc");
-  PlaySoundEffect(caster, SFX_SPELL_CURE);
-  PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 10,10);
-  var potency := CInt(AP_GetSkill(caster, MAGERY) / 33) +1;
-  if(castOn.isA(POLCLASS_NPC))
-    var element := npccfg[castOn.npctemplate].elemental;
-    if(element == "poison")
-      var ev := array;
-      ev.+ type;
-      ev.+ source;
-      ev.type := EVID_PEACEMADE;
-      SendEvent(castOn, ev);
-      ev.source := caster;
-      SendEvent(castOn, ev);
-      ev.type := EVID_ENGAGED;
-      SendEvent(castOn, ev);
-      ApplyRawDamage(castOn, potency);
-    endif
-  endif
-  if (TS_GetTimerNames(castOn, "P").size() > 0)
-    TS_CurePoison(castOn, 120, "P", potency);
-    if (TS_GetTimerNames(castOn, "P").size() > 0)
-      SendSysMessage(caster, "You cure some poison.");  
-      SendSysMessage(castOn, caster.name + " has partially cured you!");
-    else
-      SendSysMessage(caster, castOn.name + " cured.");
-      SendSysMessage(castOn, caster.name + " has cured you completely!");
-    endif
-  endif
-endprogram

Deleted: trunk/096/pkg/skills/magery/curse.src
===================================================================
--- trunk/096/pkg/skills/magery/curse.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/curse.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,37 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/statMod";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include "include/magic";
-include "reflect";
-
-program curse( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  PlaySoundEffect(castOn, SFX_SPELL_CURSE);
-  PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 10,10);
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := Resisted(circle,caster,castOn,GetModAmount( magery ));
-  var duration := GetModDuration( magery );
-	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "curse" });
-  if(spell_reflect(castOn))
-	castOn := caster;
-  endif
-  if (CanMod(castOn, "str"))
-	DoTempMod(castOn, "str", 0- modAmount, duration);
-  endif
-  if (CanMod(castOn, "dex"))
-	DoTempMod(castOn, "dex", 0- modAmount, duration);
-  endif
-  if (CanMod(castOn, "int"))
-	DoTempMod(castOn, "int", 0- modAmount, duration);
-  endif
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/dispel.src
===================================================================
--- trunk/096/pkg/skills/magery/dispel.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/dispel.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,53 +0,0 @@
-use uo;
-use cfgfile;
-
-include "include/eventID";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include "include/spellAttack";
-include "include/magic";
-
-program dispel( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-  var npccfg := ReadConfigFile("::npcdesc");
-
-  var summoned := GetObjProperty( castOn, "summoned");
-  if(summoned == 1)
-    PlaySoundEffect( caster, 0x202 );
-    PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_HEAL_EFFECT, 0xa, 0xa,0 , caster.realm );
-    var master := SystemFindObjectBySerial(CInt(GetObjProperty(castOn, "master")));
-    if(master)
-      var resist := AP_GetSkill(master, RESISTING_SPELLS);
-      if((RandomInt(99) + 1) < resist)
-        MoveCharacterToLocation(castOn,0,0,0,MOVECHAR_FORCELOCATION);
-        ApplyRawDamage(castOn, AP_GetVitalMaximumValue(caston, HITS) + 3);
-      endif
-      send_attack(caster, castOn, 41);
-    endif
-  else
-    if(castOn.isA(POLCLASS_NPC))
-      var element := npccfg[castOn.npctemplate].elemental;
-      if(element == "undead")
-        PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_HEAL_EFFECT, 0xa, 0xa, 0, caster.realm );
-        var ev := array;
-        ev.+ type;
-        ev.+ source;
-        ev.type := EVID_PEACEMADE;
-        SendEvent(castOn, ev);
-        ev.source := caster;
-        SendEvent(castOn, ev);
-        ev.type := EVID_ENGAGED;
-        SendEvent(castOn, ev);
-        PlaySoundEffect(caster, 0x202);
-        PlayObjectCenteredEffect(castOn, 0x37b9, 0x03, 0x0a);
-        var dmg := CalcSpellDamage(circle, caster) + (RandomInt(20));
-        ApplyRawDamage(castOn, Resisted(circle, caster, castOn, dmg));
-      endif
-    endif
-  endif
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/dispelField.src
===================================================================
--- trunk/096/pkg/skills/magery/dispelField.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/dispelField.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,22 +0,0 @@
-use uo;
-use os;
-
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-
-
-program dispelField( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var magery := AP_GetSkill(caster, MAGERY);
-  var therange := CInt(magery / 15 );
-  var items := ListItemsNearLocation(castOn.x, castOn.y, castOn.z, therange, caster.realm);
-  PlaySoundEffect( caster, SFX_SPELL_DISPEL );
-  foreach item in items
-	if (GetObjProperty(item, "f") == "1")
-	  PlayStationaryEffect( item.x, item.y, item.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
-      DestroyItem(item);
-	endif
-  endforeach
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/eBolt.src
===================================================================
--- trunk/096/pkg/skills/magery/eBolt.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/eBolt.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,48 +0,0 @@
-use uo;
-use os;
-use util;
-use cfgfile;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include "include/spellAttack";
-include ":magery:reflect";
-include "include/magic";
-
-
-program spell_eBolt(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-
-	if (!castOn.container)
-		PlayMovingEffect( caster, castOn, FX_ENERGY_BOLT, 0xa, 0x1e );
-	endif
-	PlaySoundEffect( caster, SFX_SPELL_ENERGY_BOLT );
-	SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "ebolt" } );
-	if (spell_reflect(castOn))
-		castOn := caster;
-		PlayMovingEffect( caster, castOn, FX_ENERGY_BOLT, 0xa, 0x1e );
-		PlaySoundEffect( caster, SFX_SPELL_ENERGY_BOLT );
-	endif
-	var dmg := RandomDiceRoll("5d8");
-	if (spell_reflect(castOn))
-		PlayMovingEffect( castOn, caster, FX_ENERGY_BOLT, 0xa, 0x1e );
-		PlaySoundEffect( castOn, SFX_SPELL_ENERGY_BOLT );
-		castOn := caster;
-		if (GetObjProperty( caster, "mr") == "1")
-			EraseObjProperty(caster, "mr");
-			SendSysMessage(caster, "Your magic reflect spell saved you!");
-			return;
-		endif
-  	endif
-	if (castOn.isA(POLCLASS_NPC))
-		dmg := dmg * 2;
-	endif
-	ApplyRawDamage(castOn, Resisted(circle, caster, castOn, dmg));
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/earthquake.src
===================================================================
--- trunk/096/pkg/skills/magery/earthquake.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/earthquake.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,40 +0,0 @@
-use uo;
-use util;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include "include/spellAttack";
-include "include/magic";
-
-
-program spell_earthquake(parms)
-	var caster := parms.caster;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-	var range := 12;
-	var victims := ListMobilesNearLocationEx( caster.x, caster.y, caster.z, range, LISTEX_FLAG_NORMAL + LISTEX_FLAG_HIDDEN, caster.realm );
-	var dmg;
-
-	PlaySoundEffect( caster, SFX_220 );
-	foreach mobile in victims
-		if ((mobile.serial != caster.serial) and (mobile.cmdlevel < 2))
-			SetObjProperty(mobile, "LastHit", {caster.name,caster.serial, "earthquake" });
-			send_attack(mobile,caster, 57);
-			dmg := RandomDiceRoll("7d7");
-			PrintTextAbovePrivate( mobile,"You are tossed about as the earth trembles below your feet!", mobile );
-			PlaySoundEffect( mobile, SFX_SPELL_EARTHQUAKE );
-			PlayObjectCenteredEffect( mobile, FX_SMOKE, 7, 7);
-			if (mobile.isA(POLCLASS_NPC))
-				dmg := dmg * 2;
-			endif
-	  		ApplyRawDamage( mobile, Resisted(circle,caster,mobile,dmg) );
-		endif
-	endforeach
-	sleep(2);
-	PlaySoundEffect(caster, SFX_223);
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/energyField.src
===================================================================
--- trunk/096/pkg/skills/magery/energyField.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/energyField.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,28 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/fields";
-include ":attributes:attributes";
-include "include/objtype";
-
-
-program spell_energyField( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var fields := {};
-  var x := castOn.x;
-  var y := castOn.y;
-  var z := castOn.z;
-  case(get_direction(caster))
-	"NS" : fields := CreateNorthSouthField(caster, UOBJ_EFIELD_NS, x, y, z, 5);
-	"EW" : fields := CreateEastWestField(caster, UOBJ_EFIELD_EW, x, y, z, 5);
-  endcase
-  PlaySoundEffect(caster,0x20c);
-  Detach();
-  var duration := 20 + ( CInt(AP_GetSkill(caster, MAGERY) ) / 3 );
-  sleep(duration);
-  foreach fieldpart in fields
-    DestroyItem(fieldpart);
-  endforeach
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/explosion.src
===================================================================
--- trunk/096/pkg/skills/magery/explosion.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/explosion.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,36 +0,0 @@
-use os;
-use uo;
-use cfgfile;
-
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include "include/spellAttack";
-include ":magery:reflect";
-include "include/magic";
-
-program spell_explosion(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-	var dmg;
-
-	SetObjProperty(castOn, "LastHit", ( {caster.name, caster.serial, "explosion" } ) );
-	if(spell_reflect(castOn))
-		castOn := caster;
-	endif
-  dmg := RandomDiceRoll("7d6");
-  Detach();
-  sleep(4);
-  send_attack(castOn,caster, 43);
-  PlaySoundEffect( castOn, SFX_SPELL_EXPLOSION );
-  PlayStationaryEffect( castOn.x,castOn.y,castOn.z, FX_EXPLODE_3, 7, 0x10, 0 , caster.realm );
-  if(AP_GetVital(castOn, HITS) >= 1)
-    if(castOn.npctemplate)
-      dmg := dmg * 2;
-    endif
-    ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
-  endif
-endprogram

Deleted: trunk/096/pkg/skills/magery/feeblemind.src
===================================================================
--- trunk/096/pkg/skills/magery/feeblemind.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/feeblemind.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,35 +0,0 @@
-use uo;
-use os;
-use util;
-use cfgfile;
-
-include "include/statMod";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include ":magery:reflect";
-include "include/magic";
-
-
-program spell_feeblemind(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "feeblemind" });
-  if (spell_reflect(castOn))
-	castOn := caster;
-  endif
-  PlaySoundEffect(castOn, SFX_SPELL_FEEBLEMIND);
-  PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 7, 7 );
-  if (!CanMod(castOn, "int"))
-	SendSysMessage(caster,"Already under the influence!");
-	return;
-  endif
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := Resisted(circle,caster,castOn,(GetModAmount( magery )));
-  var duration := GetModDuration( magery );
-  DoTempMod(castOn, "int", 0 - modAmount, duration);
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/fireField.src
===================================================================
--- trunk/096/pkg/skills/magery/fireField.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/fireField.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,27 +0,0 @@
-include "include/fields";
-include ":attributes:attributes";
-include "include/client";
-include "include/firewall";
-
-
-program spell_fireField(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var fields := {};
-	var x := castOn.x;
-	var y := castOn.y;
-	var z := castOn.z;
-	case (get_direction(caster))
-		"NS" : fields := CreateNorthSouthField(caster, UOBJ_FIREFIELD_NS, x, y, z, 5);
-		"EW" : fields := CreateEastWestField(caster, UOBJ_FIREFIELD_EW, x, y, z, 5);
-	endcase
-	PlaySoundEffect(caster, 0x20d);
-	Detach();
-	var duration := 20 + ( CInt(AP_GetSkill(caster, MAGERY) ) / 3 );
-	sleep(duration);
-	foreach fieldpart in fields
-		DestroyItem(fieldpart);
-	endforeach
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/fireball.src
===================================================================
--- trunk/096/pkg/skills/magery/fireball.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/fireball.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,33 +0,0 @@
-use uo;
-use cfgfile;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-
-
-program spell_fireball(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  PlayMovingEffect(caster, castOn, FX_FIREBALL, 5, 1);
-  PlaySoundEffect(caster, 0x15f);
-  var dmg := RandomDiceRoll("3d6");
-  SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "fireball"});
-  if (spell_reflect(castOn))
-    PlayMovingEffect(castOn, caster, FX_FIREBALL, 5, 1);
-    PlaySoundEffect(castOn, 0x15f);
-    castOn := caster;
-  endif
-  if (AP_GetVital(castOn, HITS) >= 1)
-    if(castOn.npctemplate)
-      dmg := dmg * 2;
-    endif
-    ApplyRawDamage(castOn, Resisted(circle,caster,castOn, dmg));
-  endif
-endprogram

Deleted: trunk/096/pkg/skills/magery/flameStrike.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/flameStrike.src.temp	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/flameStrike.src.temp	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,31 +0,0 @@
-use uo;
-use cfgfile;
-
-include ":magery:reflect";
-include "include/sound";
-include "include/magic";
-include "include/attributes";
-
-
-program spell_flameStrike(parms)
-	var caster := parms.caster;
-  	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-	var dmg := RandomDiceRoll("6d8");
-
-	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "flame strike" });
-	if (Reflected(castOn))
-		castOn := caster;
-	endif
-	PlayObjectCenteredEffect(castOn, 0x3709, 0x0a, 0x1e );
-	PlaySoundEffect( caster, SFX_SPELL_FLAME_STRIKE );
-	if (GetHp(castOn) >= 1)
-		if (castOn.npctemplate)
-			dmg := dmg * 2;
-		endif
-		ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
-	endif
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/gHeal.src
===================================================================
--- trunk/096/pkg/skills/magery/gHeal.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/gHeal.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,25 +0,0 @@
-use uo;
-use os;
-use util;
-
-include ":attributes:attributes";
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-
-
-program spell_greaterHeal(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var healed := RandomDiceRoll("1d3");
-	healed := CInt(AP_GetSkill(caster, MAGERY)/2) + healed;
-	SendSysMessage(caster, "You healed " + healed + " damage.");
-	if (castOn.isA(POLCLASS_NPC))
-		healed := healed * 2;
-	endif
-	HealDamage(castOn, healed);
-	PlayObjectCenteredEffect( castOn, FX_SPARK_EFFECT, 7, 0x10 );
-	PlaySoundEffect( castOn, SFX_SPELL_GREATER_HEAL );
-
-	return;
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/gate.src
===================================================================
--- trunk/096/pkg/skills/magery/gate.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/gate.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,130 +0,0 @@
-use os;
-use uo;
-
-include "include/isValidLoc";
-include "include/objtype";
-include "include/client";
-include "include/sound";
-
-
-program spell_gate(parms)
-  var caster := parms.caster;
-  var castOn := Target(caster);
-  if((castOn.objtype != UOBJ_RUNE) && (castOn.objtype != 0x6100))
-    SendSysMessage(caster, "You can only cast that on a recall rune!");
-    return;
-  endif
-  var tox := CInt(GetObjProperty( castOn, "x" ));
-  var toy := CInt(GetObjProperty( castOn, "y" ));
-  var toz := CInt(GetObjProperty( castOn, "z" ));
-  var torealm := GetObjProperty( castOn, "realm" );
-  if(!tox)
-    SendSysMessage(caster, "The rune must be marked.");
-    return;
-  endif
-  if(!torealm)
-  	torealm := "britannia";
-  endif  
-  if(!ReserveItem(castOn))
-    return;
-  endif
-  if(GetObjProperty(castOn, "Vendored"))
-    SendSysMessage(caster, "You cannot gate off of runes on a vendor.");
-    return;
-  endif
-  if(!isValidLoc(tox,toy))
-    SendSysMessage(caster, "You may not gate into Green Acres.");
-    ReleaseItem(castOn);
-    DestroyItem(castOn);
-    return;
-  endif
-  PlaySoundEffect( caster, SFX_SPELL_GATE_TRAVEL );
-  var chk := 0;
-  if((caster.x >= 5120) && (caster.x <= 5375) && (caster.y >= 0) && (caster.y <= 255))
-    SendSysMessage(caster, "Your spell fails and consumes the rune!");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    elseif(castOn.objtype == 0x6100)
-      removeentry(castOn);
-    endif
-    chk := 1;
-  endif
-  var multicheck := CreateItemAtLocation(1, 1, 0, 0xeed, 1, torealm);
-  multicheck.hidden := 1;
-  if(!MoveItemToLocation(multicheck, tox, toy, toz, MOVEITEM_NORMAL))
-    SendSysMessage(caster, "Something is blocking the location.");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    elseif(castOn.objtype == 0x6100)
-      removeentry(castOn);
-    endif
-    chk := 1;
-  endif
-  if(multicheck.multi)
-    SendSysMessage(caster,"Something is blocking the location.");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    elseif(castOn.objtype == 0x6100)
-      removeentry(castOn);
-    endif
-    chk := 1;
-  endif
-  DestroyItem(multicheck);
-  if(chk == 1)
-    return;
-  endif
-  var wx := caster.x;
-  var wy := caster.y;
-  var wz := caster.z;
-  PlayStationaryEffect( wx, wy, wz, 6899, 1, 30, 0, caster.realm );
-  PlayStationaryEffect( tox, toy, toz, 6899, 1, 30, 0, caster.realm );
-  sleepms(2800);
-  set_critical( 1 );
-  var gate1 := CreateItemAtLocation( wx, wy, wz, UOBJ_BLUE_MOONGATE, 1, caster.realm );
-  gate1.movable := 0;
-  var gate2 := CreateItemAtLocation( tox, toy, toz, UOBJ_BLUE_MOONGATE, 1, torealm );
-  gate2.movable := 0;
-  if(!gate1)
-    DestroyItem(gate2);
-    SendSysMessage(caster, "Something is interfering with the spell.");
-    return;
-  endif
-  if (!gate2)
-    DestroyItem(gate1);
-    SendSysMessage(caster, "Something is interfering with the spell.");
-    return;
-  endif
-  set_critical(0);
-  SetObjProperty( gate1, "GateDestX", gate2.x );
-  SetObjProperty( gate1, "GateDestY", gate2.y );
-  SetObjProperty( gate1, "GateDestZ", gate2.z );
-  SetObjProperty( gate1, "GateDestRealm", gate2.realm );
-  SetObjProperty( gate2, "GateDestX", gate1.x );
-  SetObjProperty( gate2, "GateDestY", gate1.y );
-  SetObjProperty( gate2, "GateDestZ", gate1.z );
-  SetObjProperty( gate2, "GateDestRealm", gate1.realm );
-  Detach();
-  sleep(30);
-  set_critical(1);
-  DestroyItem( gate1 );
-  DestroyItem( gate2 );
-  set_critical(0);
-endprogram
-
-function removeentry(castOn)
-  var tox := CInt(GetObjProperty( castOn, "x" ));
-  var toy := CInt(GetObjProperty( castOn, "y" ));
-  var toz := CInt(GetObjProperty( castOn, "z" ));
-  var defs := GetObjProperty(castOn, "runedefs");
-  var holder := {};
-  foreach thing in defs
-    if((Cint(thing[2]) != tox) or (Cint(thing[3]) != toy) or (Cint(thing[4]) != toz))
-      holder.append(thing);
-    endif
-  endforeach
-  SetObjProperty(castOn, "runedefs", holder);
-  EraseObjProperty(castOn, "x");
-  EraseObjProperty(castOn, "y");
-  EraseObjProperty(castOn, "z");
-  return;
-endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/harm.src
===================================================================
--- trunk/096/pkg/skills/magery/harm.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/harm.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,36 +0,0 @@
-use os;
-use uo;
-use util;
-use cfgfile;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-include "include/magic";
-
-
-program spell_harm(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-	var dmg := RandomDiceRoll("1d12");
-
-	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "harm" });
-	if (spell_reflect(castOn))
-		castOn := caster;
-	endif
-	PlaySoundEffect(castOn, SFX_SPELL_HARM);
-	PlayObjectCenteredEffect( castOn, FX_GLOW_SPIKE, 0x0a,0x1e);
-	if(AP_GetVital(castOn, HITS) >= 1)
-		if(castOn.npctemplate)
-			dmg := dmg * 2;
-		endif
-		ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
-	endif
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/heal.src
===================================================================
--- trunk/096/pkg/skills/magery/heal.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/heal.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,25 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/client";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-
-
-program spell_heal(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var healed := CInt(AP_GetSkill(caster, MAGERY) / 20) + 5;
-  if(healed > 20)
-	healed := 20;
-  endif
-  if(castOn.isA(POLCLASS_NPC))
-    healed := healed * 2;
-  endif
-  HealDamage(castOn, healed);
-  PlayObjectCenteredEffect(castOn, FX_SPARK_EFFECT, 7, 0x10);
-  PlaySoundEffect(castOn, SFX_SPELL_HEAL);
-  SendSysMessage(caster, "You healed " + healed + " damage.");
-endprogram

Deleted: trunk/096/pkg/skills/magery/incognito.cfg
===================================================================
--- trunk/096/pkg/skills/magery/incognito.cfg	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/incognito.cfg	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,3733 +0,0 @@
-Names MALE
-{
-        Count 1518
-        Name1           Aaron
-        Name2           Aasin
-        Name3           Abbott
-        Name4           Abdel
-        Name5           Abdiel
-        Name6           Abel
-        Name7           Abijah
-        Name8           Abner
-        Name9           Abraham
-        Name10          Abran
-        Name11          Ace
-        Name12          Achilles
-        Name13          Ackerley
-        Name14          Adair
-        Name15          Adam
-        Name16          Adan
-        Name17          Addison
-        Name18          Adeben
-        Name19          Adem
-        Name20          Adiran
-        Name21          Adlai
-        Name22          Adler
-        Name23          Adley
-        Name24          Admon
-        Name25          Adolph
-        Name26          Adon
-        Name27          Adonis
-        Name28          Adrian
-        Name29          Adriel
-        Name30          Aeneas
-        Name31          Agustin
-        Name32          Ahearn
-        Name33          Ahmik
-        Name34          Ahren
-        Name35          Aidan
-        Name36          Aiken
-        Name37          Aimery
-        Name38          Aitan
-        Name39          Ajayi
-        Name40          Akando
-        Name41          Akbaar
-        Name42          Akello
-        Name43          Akil
-        Name44          Akshay
-        Name45          Alan
-        Name46          Aland
-        Name47          Alano
-        Name48          Alaric
-        Name49          Alastair
-        Name50          Alben
-        Name51          Albert
-        Name52          Alcander
-        Name53          Alcott
-        Name54          Alden
-        Name55          Alder
-        Name56          Aldrick
-        Name57          Alec
-        Name58          Alek
-        Name59          Aleksy
-        Name60          Aleron
-        Name61          Aleser
-        Name62          Alex
-        Name63          Alexander
-        Name64          Alfred
-        Name65          Alger
-        Name66          Alim
-        Name67          Alistair
-        Name68          Allaard
-        Name69          Allan
-        Name70          Allard
-        Name71          Allen
-        Name72          Alonzo
-        Name73          Alphonse
-        Name74          Alphonso
-        Name75          Alston
-        Name76          Altair
-        Name77          Alton
-        Name78          Alvin
-        Name79          Amadeo
-        Name80          Amadi
-        Name81          Amado
-        Name82          Ambrose
-        Name83          Amiel
-        Name84          Ammon
-        Name85          Amos
-        Name86          Amsden
-        Name87          Anders
-        Name88          Andre
-        Name89          Andreus
-        Name90          Andrew
-        Name91          Andrey
-        Name92          Andries
-        Name93          Andrio
-        Name94          Angelo
-        Name95          Angus
-        Name96          Anker
-        Name97          Anoki
-        Name98          Ansel
-        Name99          Anselme
-        Name100         Ansley
-        Name101         Anson
-        Name102         Anthony
-        Name103         Antonio
-        Name104         Anwar
-        Name105         Archer
-        Name106         Archibald
-        Name107         Ardon
-        Name108         Aren
-        Name109         Ares
-        Name110         Argus
-        Name111         Ari
-        Name112         Aricin
-        Name113         Arion
-        Name114         Aristo
-        Name115         Aristotle
-        Name116         Arkin
-        Name117         Arlen
-        Name118         Arley
-        Name119         Arlin
-        Name120         Arlo
-        Name121         Arman
-        Name122         Armen
-        Name123         Armon
-        Name124         Armstrong
-        Name125         Arne
-        Name126         Arnold
-        Name127         Arnon
-        Name128         Aron
-        Name129         Arpiar
-        Name130         Arsen
-        Name131         Arsenio
-        Name132         Arthur
-        Name133         Ashby
-        Name134         Asher
-        Name135         Ashford
-        Name136         Ashlin
-        Name137         Ashon
-        Name138         Ashur
-        Name139         Athan
-        Name140         Atheron
-        Name141         Atman
-        Name142         Audric
-        Name143         Audun
-        Name144         Augustin
-        Name145         Augustus
-        Name146         Aurek
-        Name147         Austin
-        Name148         Averill
-        Name149         Avery
-        Name150         Axel
-        Name151         Bae
-        Name152         Bailey
-        Name153         Baingana
-        Name154         Bakari
-        Name155         Balbo
-        Name156         Balder
-        Name157         Baldwin
-        Name158         Bale
-        Name159         Balendin
-        Name160         Bali
-        Name161         Balin
-        Name162         Balint
-        Name163         Bancroft
-        Name164         Bandele
-        Name165         Bane
-        Name166         Banning
-        Name167         Baran
-        Name168         Barclay
-        Name169         Barden
-        Name170         Bardo
-        Name171         Bardon
-        Name172         Barnabas
-        Name173         Barnaby
-        Name174         Barnett
-        Name175         Barney
-        Name176         Baron
-        Name177         Barrett
-        Name178         Barry
-        Name179         Barse
-        Name180         Bart
-        Name181         Barth
-        Name182         Bartholomew
-        Name183         Barton
-        Name184         Basil
-        Name185         Bastiaan
-        Name186         Baul
-        Name187         Bavol
-        Name188         Baxter
-        Name189         Bay
-        Name190         Bayani
-        Name191         Bayard
-        Name192         Baylor
-        Name193         Bazyli
-        Name194         Beacan
-        Name195         Beagan
-        Name196         Beaman
-        Name197         Beau
-        Name198         Beaumont
-        Name199         Beauregard
-        Name200         Beck
-        Name201         Beldon
-        Name202         Belen
-        Name203         Bem
-        Name204         Beman
-        Name205         Ben
-        Name206         Benedict
-        Name207         Benen
-        Name208         Benjamin
-        Name209         Bennett
-        Name210         Benson
-        Name211         Bent
-        Name212         Bentley
-        Name213         Benton
-        Name214         Berenger
-        Name215         Bergren
-        Name216         Berk
-        Name217         Berkeley
-        Name218         Bernard
-        Name219         Bersh
-        Name220         Bert
-        Name221         Bert
-        Name222         Berthold
-        Name223         Berton
-        Name224         Bertram
-        Name225         Beval
-        Name226         Bevan
-        Name227         Bialy
-        Name228         Bilal
-        Name229         Bishop
-        Name230         Bitalo
-        Name231         Bjorn
-        Name232         Blade
-        Name233         Blaine
-        Name234         Blair
-        Name235         Blaise
-        Name236         Blake
-        Name237         Blaz
-        Name238         Blorn
-        Name239         Bo
-        Name240         Boden
-        Name241         Bogart
-        Name242         Bohdan
-        Name243         Bolton
-        Name244         Bond
-        Name245         Booker
-        Name246         Boone
-        Name247         Borden
-        Name248         Boris
-        Name249         Botan
-        Name250         Bowie
-        Name251         Bowman
-        Name252         Boyce
-        Name253         Boyd
-        Name254         Boyden
-        Name255         Brad
-        Name256         Braden
-        Name257         Bradford
-        Name258         Bradney
-        Name259         Brady
-        Name260         Bram
-        Name261         Bran
-        Name262         Brand
-        Name263         Brandeis
-        Name264         Brandon
-        Name265         Brant
-        Name266         Braxton
-        Name267         Bray
-        Name268         Braz
-        Name269         Brazil
-        Name270         Bren
-        Name271         Brencis
-        Name272         Brendan
-        Name273         Brendon
-        Name274         Brennan
-        Name275         Brent
-        Name276         Brentan
-        Name277         Bret
-        Name278         Brett
-        Name279         Brewster
-        Name280         Briac
-        Name281         Brian
-        Name282         Briand
-        Name283         Brice
-        Name284         Brieg
-        Name285         Brinley
-        Name286         Brishen
-        Name287         Brock
-        Name288         Broderick
-        Name289         Brodny
-        Name290         Brody
-        Name291         Bronson
-        Name292         Bront
-        Name293         Bruce
-        Name294         Bruno
-        Name295         Brutus
-        Name296         Bryan
-        Name297         Bryant
-        Name298         Bryce
-        Name299         Bryson
-        Name300         Buck
-        Name301         Bud
-        Name302         Budo
-        Name303         Burgess
-        Name304         Burhan
-        Name305         Burian
-        Name306         Burke
-        Name307         Burl
-        Name308         Burr
-        Name309         Burton
-        Name310         Byran
-        Name311         Byron
-        Name312         Cadeo
-        Name313         Cador
-        Name314         Caedmon
-        Name315         Cailan
-        Name316         Cain
-        Name317         Caine
-        Name318         Calder
-        Name319         Caldwell
-        Name320         Caleb
-        Name321         Calvin
-        Name322         Cam
-        Name323         Camden
-        Name324         Cameron
-        Name325         Candan
-        Name326         Canton
-        Name327         Canute
-        Name328         Carden
-        Name329         Carey
-        Name330         Carl
-        Name331         Carlin
-        Name332         Carlo
-        Name333         Carlos
-        Name334         Carlton
-        Name335         Carr
-        Name336         Carrick
-        Name337         Carrocio
-        Name338         Carroll
-        Name339         Carson
-        Name340         Carson
-        Name341         Carter
-        Name342         Carver
-        Name343         Casey
-        Name344         Casper
-        Name345         Cassidy
-        Name346         Cassius
-        Name347         Castel
-        Name348         Cato
-        Name349         Caton
-        Name350         Cavan
-        Name351         Ceasar
-        Name352         Cecil
-        Name353         Cedric
-        Name354         Cemal
-        Name355         Chad
-        Name356         Chadwick
-        Name357         Chaim
-        Name358         Chal
-        Name359         Chale
-        Name360         Chalmers
-        Name361         Chander
-        Name362         Chandler
-        Name363         Chane
-        Name364         Chaney
-        Name365         Channing
-        Name366         Chapin
-        Name367         Chapman
-        Name368         Charles
-        Name369         Charlton
-        Name370         Chase
-        Name371         Chatha
-        Name372         Chauncy
-        Name373         Chayton
-        Name374         Chen
-        Name375         Cheney
-        Name376         Chester
-        Name377         Chet
-        Name378         Chevalier
-        Name379         Chike
-        Name380         Chin
-        Name381         Christian
-        Name382         Christoph
-        Name383         Christopher
-        Name384         Christos
-        Name385         Chuck
-        Name386         Ciceron
-        Name387         Ciro
-        Name388         Clarence
-        Name389         Clark
-        Name390         Claude
-        Name391         Clay
-        Name392         Clay
-        Name393         Clayton
-        Name394         Clement
-        Name395         Cleveland
-        Name396         Clifford
-        Name397         Clifton
-        Name398         Clint
-        Name399         Clinton
-        Name400         Clive
-        Name401         Clyde
-        Name402         Cody
-        Name403         Colby
-        Name404         Cole
-        Name405         Coleman
-        Name406         Colin
-        Name407         Collin
-        Name408         Colon
-        Name409         Colton
-        Name410         Coman
-        Name411         Conan
-        Name412         Condon
-        Name413         Connor
-        Name414         Conrad
-        Name415         Conway
-        Name416         Corbett
-        Name417         Corbin
-        Name418         Corcoran
-        Name419         Cordell
-        Name420         Corey
-        Name421         Cornelius
-        Name422         Cort
-        Name423         Coty
-        Name424         Courtland
-        Name425         Craig
-        Name426         Crandall
-        Name427         Creighton
-        Name428         Crispin
-        Name429         Crosby
-        Name430         Cullen
-        Name431         Cullin
-        Name432         Culver
-        Name433         Curran
-        Name434         Curtis
-        Name435         Cynric
-        Name436         Cyrano
-        Name437         Cyril
-        Name438         Cyrus
-        Name439         Dag
-        Name440         Dagan
-        Name441         Dakarai
-        Name442         Dakota
-        Name443         Dale
-        Name444         Dallin
-        Name445         Dalton
-        Name446         Daly
-        Name447         Damek
-        Name448         Damen
-        Name449         Damian
-        Name450         Damien
-        Name451         Damion
-        Name452         Damon
-        Name453         Dana
-        Name454         Dane
-        Name455         Daniel
-        Name456         Danior
-        Name457         Dannik
-        Name458         Dante
-        Name459         Daren
-        Name460         Darien
-        Name461         Dario
-        Name462         Darnell
-        Name463         Darrel
-        Name464         Darrell
-        Name465         Darren
-        Name466         Daryl
-        Name467         David
-        Name468         Davin
-        Name469         Davis
-        Name470         Deacon
-        Name471         Dean
-        Name472         Decker
-        Name473         Delaney
-        Name474         Delano
-        Name475         Delbert
-        Name476         Dellan
-        Name477         Delmore
-        Name478         Delsin
-        Name479         Deman
-        Name480         Dempsey
-        Name481         Dempster
-        Name482         Denby
-        Name483         Dennis
-        Name484         Dennys
-        Name485         Denton
-        Name486         Denver
-        Name487         Der
-        Name488         Derek
-        Name489         Derrick
-        Name490         Derry
-        Name491         Desmond
-        Name492         Deverell
-        Name493         Devin
-        Name494         Devlin
-        Name495         Dewey
-        Name496         Dexter
-        Name497         Diederik
-        Name498         Diego
-        Name499         Dieter
-        Name500         Dillon
-        Name501         Dimitri
-        Name502         Dirk
-        Name503         Dobry
-        Name504         Dominic
-        Name505         Dominick
-        Name506         Donald
-        Name507         Donatien
-        Name508         Donato
-        Name509         Donnelley
-        Name510         Donnelly
-        Name511         Donovan
-        Name512         Doron
-        Name513         Dougie
-        Name514         Douglas
-        Name515         Douglass
-        Name516         Dov
-        Name517         Doyle
-        Name518         Drake
-        Name519         Drew
-        Name520         Duane
-        Name521         Dugan
-        Name522         Duglas
-        Name523         Duncan
-        Name524         Dunstan
-        Name525         Durand
-        Name526         Durriken
-        Name527         Dusan
-        Name528         Dustin
-        Name529         Dutch
-        Name530         Dwayne
-        Name531         Dwight
-        Name532         Dyami
-        Name533         Dyastro
-        Name534         Dylan
-        Name535         Dymas
-        Name536         Eamon
-        Name537         Earl
-        Name538         Earle
-        Name539         Eaton
-        Name540         Edan
-        Name541         Edgan
-        Name542         Edgar
-        Name543         Edison
-        Name544         Edmund
-        Name545         Edrin
-        Name546         Edward
-        Name547         Edwin
-        Name548         Edwin
-        Name549         Egan
-        Name550         Einar
-        Name551         Elad
-        Name552         Elden
-        Name553         Eldroth
-        Name554         Elek
-        Name555         Eli
-        Name556         Elias
-        Name557         Elijah
-        Name558         Elkan
-        Name559         Ellery
-        Name560         Elliot
-        Name561         Elliott
-        Name562         Ellis
-        Name563         Ellsworth
-        Name564         Elmer
-        Name565         Elmo
-        Name566         Elston
-        Name567         Elton
-        Name568         Elwood
-        Name569         Emanuel
-        Name570         Emil
-        Name571         Emilio
-        Name572         Emmett
-        Name573         Emo
-        Name574         Enoch
-        Name575         Enrico
-        Name576         Enrique
-        Name577         Ephraim
-        Name578         Erek
-        Name579         Eric
-        Name580         Erik
-        Name581         Ernest
-        Name582         Erol
-        Name583         Errol
-        Name584         Erskine
-        Name585         Erwin
-        Name586         Eryx
-        Name587         Essien
-        Name588         Esteban
-        Name589         Ethan
-        Name590         Eugene
-        Name591         Evan
-        Name592         Evander
-        Name593         Everett
-        Name594         Evzen
-        Name595         Ezekial
-        Name596         Ezra
-        Name597         Fabio
-        Name598         Fairfax
-        Name599         Farley
-        Name600         Farrell
-        Name601         Faxon
-        Name602         Felix
-        Name603         Felix
-        Name604         Fenn
-        Name605         Fenton
-        Name606         Fergus
-        Name607         Ferran
-        Name608         Ferris
-        Name609         Fielding
-        Name610         Filbert
-        Name611         Filmore
-        Name612         Finlay
-        Name613         Finley
-        Name614         Finn
-        Name615         Finnigan
-        Name616         Fisk
-        Name617         Fitzgerald
-        Name618         Fletcher
-        Name619         Flindo
-        Name620         Flint
-        Name621         Floyd
-        Name622         Flynn
-        Name623         Forbes
-        Name624         Forrest
-        Name625         Forsythe
-        Name626         Foster
-        Name627         Foster
-        Name628         Francis
-        Name629         Franek
-        Name630         Frank
-        Name631         Franklin
-        Name632         Frasier
-        Name633         Frazer
-        Name634         Frazier
-        Name635         Fred
-        Name636         Frederick
-        Name637         Fremont
-        Name638         Fritz
-        Name639         Fuller
-        Name640         Fulton
-        Name641         Gabe
-        Name642         Gabriel
-        Name643         Gage
-        Name644         Galen
-        Name645         Galeno
-        Name646         Galvin
-        Name647         Gamble
-        Name648         Gannon
-        Name649         Gareth
-        Name650         Garfield
-        Name651         Gargan
-        Name652         Garner
-        Name653         Garrett
-        Name654         Garrick
-        Name655         Garridan
-        Name656         Garrison
-        Name657         Garritt
-        Name658         Garth
-        Name659         Garvin
-        Name660         Gary
-        Name661         Gaspar
-        Name662         Gaston
-        Name663         Gavin
-        Name664         Gavrie
-        Name665         Gaylord
-        Name666         Gaynor
-        Name667         Geoff
-        Name668         Geoffrey
-        Name669         Geoffry
-        Name670         George
-        Name671         Gerard
-        Name672         Gerik
-        Name673         Germain
-        Name674         Gerry
-        Name675         Gideon
-        Name676         Gilberto
-        Name677         Giles
-        Name678         Ginton
-        Name679         Givon
-        Name680         Glen
-        Name681         Glenn
-        Name682         Glenno
-        Name683         Godfrey
-        Name684         Gordon
-        Name685         Gordy
-        Name686         Gorman
-        Name687         Grady
-        Name688         Graham
-        Name689         Gram
-        Name690         Granger
-        Name691         Grant
-        Name692         Granville
-        Name693         Grayson
-        Name694         Greg
-        Name695         Greger
-        Name696         Gregor
-        Name697         Gregory
-        Name698         Gresham
-        Name699         Griffen
-        Name700         Griffith
-        Name701         Guilhem
-        Name702         Gunnar
-        Name703         Gunther
-        Name704         Gus
-        Name705         Gustave
-        Name706         Guthrie
-        Name707         Guy
-        Name708         Hackett
-        Name709         Hadden
-        Name710         Hadi
-        Name711         Hadley
-        Name712         Hadrian
-        Name713         Hagan
-        Name714         Hal
-        Name715         Halden
-        Name716         Hale
-        Name717         Halian
-        Name718         Halsey
-        Name719         Hamilton
-        Name720         Hamlin
-        Name721         Hank
-        Name722         Hans
-        Name723         Harden
-        Name724         Hardy
-        Name725         Harith
-        Name726         Harlan
-        Name727         Harman
-        Name728         Harold
-        Name729         Harper
-        Name730         Harrison
-        Name731         Harry
-        Name732         Hart
-        Name733         Hartley
-        Name734         Harvey
-        Name735         Hassan
-        Name736         Hastin
-        Name737         Hastings
-        Name738         Hayden
-        Name739         Hayes
-        Name740         Haynes
-        Name741         Heath
-        Name742         Hector
-        Name743         Helaku
-        Name744         Henning
-        Name745         Henry
-        Name746         Herbert
-        Name747         Herman
-        Name748         Herschel
-        Name749         Hilliard
-        Name750         Hilton
-        Name751         Hiroshi
-        Name752         Hobart
-        Name753         Hogan
-        Name754         Holden
-        Name755         Holt
-        Name756         Homes
-        Name757         Horace
-        Name758         Horton
-        Name759         Houston
-        Name760         Howard
-        Name761         Howrence
-        Name762         Hoyt
-        Name763         Hugh
-        Name764         Hugo
-        Name765         Humphrey
-        Name766         Hunter
-        Name767         Huntley
-        Name768         Hyman
-        Name769         Iain
-        Name770         Ian
-        Name771         Ian
-        Name772         Ilias
-        Name773         Ingmar
-        Name774         Ingram
-        Name775         Ira
-        Name776         Irvin
-        Name777         Irving
-        Name778         Irwin
-        Name779         Isaac
-        Name780         Isaiah
-        Name781         Israel
-        Name782         Itzak
-        Name783         Ivan
-        Name784         Ivar
-        Name785         Jabari
-        Name786         Jabir
-        Name787         Jack
-        Name788         Jacob
-        Name789         Jacobe
-        Name790         Jacques
-        Name791         Jacson
-        Name792         Jacy
-        Name793         Jafar
-        Name794         Jagger
-        Name795         Jake
-        Name796         Jal
-        Name797         Jaleel
-        Name798         Jamal
-        Name799         James
-        Name800         Jamison
-        Name801         Jared
-        Name802         Jarek
-        Name803         Jarman
-        Name804         Jaron
-        Name805         Jarrod
-        Name806         Jarvis
-        Name807         Jason
-        Name808         Jasper
-        Name809         Javan
-        Name810         Javier
-        Name811         Jay
-        Name812         Jebidiah
-        Name813         Jed
-        Name814         Jedidiah
-        Name815         Jedidiah
-        Name816         Jedrek
-        Name817         Jeff
-        Name818         Jeffrey
-        Name819         Jelani
-        Name820         Jeremiah
-        Name821         Jeremy
-        Name822         Jerolin
-        Name823         Jerome
-        Name824         Jeromy
-        Name825         Jerzy
-        Name826         Jesse
-        Name827         Jessee
-        Name828         Jethro
-        Name829         Jibril
-        Name830         Jin
-        Name831         Jiro
-        Name832         Jivin
-        Name833         Joel
-        Name834         Johann
-        Name835         John
-        Name836         Jolon
-        Name837         Jonah
-        Name838         Jonathan
-        Name839         Jonathon
-        Name840         Jordan
-        Name841         Jordon
-        Name842         Jorgen
-        Name843         Jorvin
-        Name844         Joseph
-        Name845         Joshua
-        Name846         Judd
-        Name847         Jude
-        Name848         Julian
-        Name849         Julius
-        Name850         Juma
-        Name851         Jung
-        Name852         Justin
-        Name853         Kadin
-        Name854         Kai
-        Name855         Kaikara
-        Name856         Kaladin
-        Name857         Kalb
-        Name858         Kale
-        Name859         Kalil
-        Name860         Kalkin
-        Name861         Kalman
-        Name862         Kamal
-        Name863         Kane
-        Name864         Kaniel
-        Name865         Kardal
-        Name866         Karl
-        Name867         Karsten
-        Name868         Kasch
-        Name869         Kasen
-        Name870         Kaspar
-        Name871         Kateb
-        Name872         Kayin
-        Name873         Keane
-        Name874         Kearney
-        Name875         Kedar
-        Name876         Keefe
-        Name877         Keelan
-        Name878         Keenan
-        Name879         Kegan
-        Name880         Keir
-        Name881         Keir
-        Name882         Keith
-        Name883         Kelby
-        Name884         Keleman
-        Name885         Kell
-        Name886         Kellen
-        Name887         Kelvin
-        Name888         Ken
-        Name889         Kenan
-        Name890         Kendall
-        Name891         Kendrick
-        Name892         Kenelm
-        Name893         Kenley
-        Name894         Kennard
-        Name895         Kennedy
-        Name896         Kenneth
-        Name897         Kent
-        Name898         Kenton
-        Name899         Kenyon
-        Name900         Keona
-        Name901         Ker
-        Name902         Kerby
-        Name903         Kern
-        Name904         Kerry
-        Name905         Kers
-        Name906         Kersen
-        Name907         Kerwin
-        Name908         Kester
-        Name909         Kevin
-        Name910         Khalil
-        Name911         Khoury
-        Name912         Kiefer
-        Name913         Kieran
-        Name914         Kiernan
-        Name915         Killian
-        Name916         Kin
-        Name917         Kinnel
-        Name918         Kinsey
-        Name919         Kintan
-        Name920         Kip
-        Name921         Kipp
-        Name922         Kirby
-        Name923         Kirk
-        Name924         Kiyoshi
-        Name925         Kliftin
-        Name926         Klog
-        Name927         Komor
-        Name928         Kontar
-        Name929         Krischan
-        Name930         Krister
-        Name931         Kurt
-        Name932         Kyle
-        Name933         Kyler
-        Name934         Laethan
-        Name935         Laird
-        Name936         Lamar
-        Name937         Lamont
-        Name938         Lance
-        Name939         Lander
-        Name940         Landon
-        Name941         Lane
-        Name942         Lang
-        Name943         Larry
-        Name944         Lars
-        Name945         Lawler
-        Name946         Lawrence
-        Name947         Lazarus
-        Name948         Lear
-        Name949         Lee
-        Name950         Leif
-        Name951         Leighton
-        Name952         Leland
-        Name953         Len
-        Name954         Lennon
-        Name955         Lennor
-        Name956         Lennox
-        Name957         Lensar
-        Name958         Leo
-        Name959         Leon
-        Name960         Leonard
-        Name961         Leron
-        Name962         Leroy
-        Name963         Lester
-        Name964         Lev
-        Name965         Levi
-        Name966         Lewis
-        Name967         Lewis
-        Name968         Li
-        Name969         Liam
-        Name970         Like
-        Name971         Lincoln
-        Name972         Lindsey
-        Name973         Lionel
-        Name974         Llewellyn
-        Name975         Lloyd
-        Name976         Logan
-        Name977         Loren
-        Name978         Lorenzo
-        Name979         Lorne
-        Name980         Louis
-        Name981         Lowell
-        Name982         Lucas
-        Name983         Lucian
-        Name984         Luis
-        Name985         Luke
-        Name986         Lukyan
-        Name987         Lunt
-        Name988         Luther
-        Name989         Lyle
-        Name990         Lyndon
-        Name991         Lysander
-        Name992         Mac
-        Name993         Macer
-        Name994         Mack
-        Name995         Mackenzie
-        Name996         Magnus
-        Name997         Malcolm
-        Name998         Malik
-        Name999         Manco
-        Name1000                Mandek
-        Name1001                Mander
-        Name1002                Manfred
-        Name1003                Manning
-        Name1004                Mansur
-        Name1005                Manuel
-        Name1006                Marc
-        Name1007                Marcos
-        Name1008                Marcus
-        Name1009                Marden
-        Name1010                Marek
-        Name1011                Mario
-        Name1012                Mark
-        Name1013                Markham
-        Name1014                Markos
-        Name1015                Marlin
-        Name1016                Marlon
-        Name1017                Marlon
-        Name1018                Marshal
-        Name1019                Marshall
-        Name1020                Marsten
-        Name1021                Martin
-        Name1022                Martingo
-        Name1023                Marvin
-        Name1024                Mason
-        Name1025                Matai
-        Name1026                Mateo
-        Name1027                Mather
-        Name1028                Matthew
-        Name1029                Matthias
-        Name1030                Maurice
-        Name1031                Max
-        Name1032                Maximillian
-        Name1033                Maxwell
-        Name1034                Maynard
-        Name1035                Mayon
-        Name1036                Mead
-        Name1037                Meka
-        Name1038                Melvin
-        Name1039                Mercer
-        Name1040                Merill
-        Name1041                Merle
-        Name1042                Merlin
-        Name1043                Merrick
-        Name1044                Merrik
-        Name1045                Meyer
-        Name1046                Micael
-        Name1047                Michael
-        Name1048                Migon
-        Name1049                Miguel
-        Name1050                Mike
-        Name1051                Mikkel
-        Name1052                Mikos
-        Name1053                Miles
-        Name1054                Miles
-        Name1055                Milo
-        Name1056                Milton
-        Name1057                Miner
-        Name1058                Mitchell
-        Name1059                Monroe
-        Name1060                Monte
-        Name1061                Morgan
-        Name1062                Morley
-        Name1063                Morris
-        Name1064                Mortimer
-        Name1065                Morton
-        Name1066                Morven
-        Name1067                Morz
-        Name1068                Motega
-        Name1069                Mukasa
-        Name1070                Murdoch
-        Name1071                Murdock
-        Name1072                Murphy
-        Name1073                Myles
-        Name1074                Myron
-        Name1075                Naeem
-        Name1076                Nalren
-        Name1077                Nantan
-        Name1078                Nathan
-        Name1079                Nathaniel
-        Name1080                Neal
-        Name1081                Neale
-        Name1082                Neil
-        Name1083                Nelek
-        Name1084                Nelson
-        Name1085                Neron
-        Name1086                Nestor
-        Name1087                Nevan
-        Name1088                Neville
-        Name1089                Nevin
-        Name1090                Nevin
-        Name1091                Nicanor
-        Name1092                Nicholas
-        Name1093                Nigel
-        Name1094                Nikolos
-        Name1095                Nils
-        Name1096                Noah
-        Name1097                Nodin
-        Name1098                Noe
-        Name1099                Nolan
-        Name1100                Norbert
-        Name1101                Norman
-        Name1102                Norris
-        Name1103                Norton
-        Name1104                Nuri
-        Name1105                Nyle
-        Name1106                Oakes
-        Name1107                Oakley
-        Name1108                Ochen
-        Name1109                Octavius
-        Name1110                Odell
-        Name1111                Odin
-        Name1112                Odion
-        Name1113                Odon
-        Name1114                Ogden
-        Name1115                Olaf
-        Name1116                Olin
-        Name1117                Oliver
-        Name1118                Omar
-        Name1119                Ordano
-        Name1120                Oren
-        Name1121                Orion
-        Name1122                Orman
-        Name1123                Ormand
-        Name1124                Orrin
-        Name1125                Orson
-        Name1126                Orville
-        Name1127                Oscar
-        Name1128                Osgood
-        Name1129                Osmond
-        Name1130                Otis
-        Name1131                Otto
-        Name1132                Owen
-        Name1133                Paco
-        Name1134                Palmer
-        Name1135                Paolo
-        Name1136                Paris
-        Name1137                Parker
-        Name1138                Parnell
-        Name1139                Pascal
-        Name1140                Patamon
-        Name1141                Patrick
-        Name1142                Patterson
-        Name1143                Patton
-        Name1144                Paul
-        Name1145                Paulin
-        Name1146                Pavel
-        Name1147                Paxton
-        Name1148                Payton
-        Name1149                Pearce
-        Name1150                Peder
-        Name1151                Pembroke
-        Name1152                Penn
-        Name1153                Percival
-        Name1154                Perry
-        Name1155                Peter
-        Name1156                Peyton
-        Name1157                Phearcy
-        Name1158                Philip
-        Name1159                Phillip
-        Name1160                Phillippe
-        Name1161                Phoenix
-        Name1162                Pierce
-        Name1163                Pierre
-        Name1164                Pierson
-        Name1165                Pilan
-        Name1166                Platon
-        Name1167                Porter
-        Name1168                Prentice
-        Name1169                Prescot
-        Name1170                Prescott
-        Name1171                Preston
-        Name1172                Quentin
-        Name1173                Quenton
-        Name1174                Quillan
-        Name1175                Quincy
-        Name1176                Quinlan
-        Name1177                Quinn
-        Name1178                Rad
-        Name1179                Radcliffe
-        Name1180                Radman
-        Name1181                Rafael
-        Name1182                Rafferty
-        Name1183                Ragnar
-        Name1184                Raidon
-        Name1185                Raleigh
-        Name1186                Ralph
-        Name1187                Ramiro
-        Name1188                Ramon
-        Name1189                Ramsay
-        Name1190                Ramsey
-        Name1191                Ranard
-        Name1192                Rance
-        Name1193                Randall
-        Name1194                Randolph
-        Name1195                Ranen
-        Name1196                Ranger
-        Name1197                Rankin
-        Name1198                Raoul
-        Name1199                Raphael
-        Name1200                Raul
-        Name1201                Ravi
-        Name1202                Ravi
-        Name1203                Ravid
-        Name1204                Ray
-        Name1205                Raymond
-        Name1206                Raynor
-        Name1207                Reade
-        Name1208                Redford
-        Name1209                Redmond
-        Name1210                Reed
-        Name1211                Reese
-        Name1212                Reeve
-        Name1213                Regan
-        Name1214                Reginald
-        Name1215                Regis
-        Name1216                Remington
-        Name1217                Remington
-        Name1218                Renaldo
-        Name1219                Rendor
-        Name1220                Renfry
-        Name1221                Renny
-        Name1222                Reuben
-        Name1223                Rex
-        Name1224                Reyhan
-        Name1225                Rhett
-        Name1226                Rhett
-        Name1227                Rhys
-        Name1228                Ricardo
-        Name1229                Richard
-        Name1230                Richter
-        Name1231                Rico
-        Name1232                Rider
-        Name1233                Ridgley
-        Name1234                Rigby
-        Name1235                Riley
-        Name1236                Rimon
-        Name1237                Ringo
-        Name1238                Ringo
-        Name1239                Riodan
-        Name1240                Riordan
-        Name1241                Roarke
-        Name1242                Robert
-        Name1243                Roberto
-        Name1244                Robi
-        Name1245                Rockwell
-        Name1246                Rod
-        Name1247                Roderick
-        Name1248                Rodman
-        Name1249                Rodney
-        Name1250                Rodrigo
-        Name1251                Roger
-        Name1252                Roi
-        Name1253                Roland
-        Name1254                Roldan
-        Name1255                Rolf
-        Name1256                Ronald
-        Name1257                Ronan
-        Name1258                Rooney
-        Name1259                Rory
-        Name1260                Roscoe
-        Name1261                Ross
-        Name1262                Roth
-        Name1263                Rowan
-        Name1264                Rowland
-        Name1265                Roy
-        Name1266                Royce
-        Name1267                Ruben
-        Name1268                Rudd
-        Name1269                Rudi
-        Name1270                Rudyard
-        Name1271                Rufus
-        Name1272                Runako
-        Name1273                Ruskin
-        Name1274                Russ
-        Name1275                Russell
-        Name1276                Rusty
-        Name1277                Rutherford
-        Name1278                Rutledge
-        Name1279                Ryan
-        Name1280                Ryder
-        Name1281                Rylan
-        Name1282                Sahale
-        Name1283                Sahen
-        Name1284                Salim
-        Name1285                Saloman
-        Name1286                Sam
-        Name1287                Samien
-        Name1288                Sammon
-        Name1289                Samson
-        Name1290                Samuel
-        Name1291                Sanders
-        Name1292                Sandon
-        Name1293                Sandor
-        Name1294                Sanford
-        Name1295                Sargent
-        Name1296                Sarngin
-        Name1297                Sarojin
-        Name1298                Saul
-        Name1299                Saunders
-        Name1300                Sawyer
-        Name1301                Saxon
-        Name1302                Schuyler
-        Name1303                Scott
-        Name1304                Seamus
-        Name1305                Sean
-        Name1306                Sebastian
-        Name1307                Sebastien
-        Name1308                Seif
-        Name1309                Selby
-        Name1310                Senon
-        Name1311                Sergio
-        Name1312                Seth
-        Name1313                Seung
-        Name1314                Severin
-        Name1315                Sevilin
-        Name1316                Seward
-        Name1317                Seymour
-        Name1318                Shane
-        Name1319                Shawn
-        Name1320                Shea
-        Name1321                Sheffield
-        Name1322                Sheldon
-        Name1323                Shen
-        Name1324                Sheridan
-        Name1325                Sherman
-        Name1326                Sherwin
-        Name1327                Sherwood
-        Name1328                Shing
-        Name1329                Shunnar
-        Name1330                Sidney
-        Name1331                Siegfried
-        Name1332                Silas
-        Name1333                Simon
-        Name1334                Sivan
-        Name1335                Skip
-        Name1336                Skyler
-        Name1337                Slade
-        Name1338                Slade
-        Name1339                Slevin
-        Name1340                Smith
-        Name1341                Solomon
-        Name1342                Sorgan
-        Name1343                Soterios
-        Name1344                Spalding
-        Name1345                Spencer
-        Name1346                Spenser
-        Name1347                Standford
-        Name1348                Stanley
-        Name1349                Stanton
-        Name1350                Stasio
-        Name1351                Stefan
-        Name1352                Stephan
-        Name1353                Stephen
-        Name1354                Sterling
-        Name1355                Stevan
-        Name1356                Steve
-        Name1357                Steven
-        Name1358                Stewart
-        Name1359                Stoke
-        Name1360                Stoyan
-        Name1361                Strom
-        Name1362                Stuart
-        Name1363                Subrey
-        Name1364                Sulaiman
-        Name1365                Sullican
-        Name1366                Sumner
-        Name1367                Sutherland
-        Name1368                Sutton
-        Name1369                Sven
-        Name1370                Sylvester
-        Name1371                Tab
-        Name1372                Tabari
-        Name1373                Tad
-        Name1374                Tadi
-        Name1375                Tai
-        Name1376                Tajo
-        Name1377                Talbart
-        Name1378                Talbot
-        Name1379                Talman
-        Name1380                Talos
-        Name1381                Tanek
-        Name1382                Tanner
-        Name1383                Tano
-        Name1384                Taro
-        Name1385                Tate
-        Name1386                Taurin
-        Name1387                Taylor
-        Name1388                Tem
-        Name1389                Terence
-        Name1390                Terrence
-        Name1391                Terrill
-        Name1392                Terry
-        Name1393                Thaddeus
-        Name1394                Thai
-        Name1395                Thaman
-        Name1396                Thane
-        Name1397                Thanos
-        Name1398                Theobald
-        Name1399                Theodore
-        Name1400                Theron
-        Name1401                Thierry
-        Name1402                Thomas
-        Name1403                Thorpe
-        Name1404                Thurston
-        Name1405                Thurston
-        Name1406                Tibalt
-        Name1407                Tiernan
-        Name1408                Timothy
-        Name1409                Titus
-        Name1410                Tobias
-        Name1411                Toby
-        Name1412                Tod
-        Name1413                Todd
-        Name1414                Tomas
-        Name1415                Tong
-        Name1416                Tor
-        Name1417                Torin
-        Name1418                Torrance
-        Name1419                Tovi
-        Name1420                Townsend
-        Name1421                Travers
-        Name1422                Travis
-        Name1423                Tremain
-        Name1424                Tremaine
-        Name1425                Trent
-        Name1426                Trevor
-        Name1427                Trey
-        Name1428                Tristan
-        Name1429                Troy
-        Name1430                Tryon
-        Name1431                Tucker
-        Name1432                Tully
-        Name1433                Tyee
-        Name1434                Tyler
-        Name1435                Tymon
-        Name1436                Tyrone
-        Name1437                Ulysses
-        Name1438                Upton
-        Name1439                Uriah
-        Name1440                Urian
-        Name1441                Van
-        Name1442                Vance
-        Name1443                Vaughn
-        Name1444                Vern
-        Name1445                Vernon
-        Name1446                Victor
-        Name1447                Vincent
-        Name1448                Vinson
-        Name1449                Virgil
-        Name1450                Vito
-        Name1451                Vlad
-        Name1452                Vladimir
-        Name1453                Vokes
-        Name1454                Volf
-        Name1455                Wade
-        Name1456                Wagner
-        Name1457                Walden
-        Name1458                Waldo
-        Name1459                Walker
-        Name1460                Wallace
-        Name1461                Wally
-        Name1462                Walter
-        Name1463                Ward
-        Name1464                Warner
-        Name1465                Warren
-        Name1466                Watson
-        Name1467                Waylan
-        Name1468                Wayland
-        Name1469                Waylon
-        Name1470                Wayne
-        Name1471                Webb
-        Name1472                Webster
-        Name1473                Wendell
-        Name1474                Wesley
-        Name1475                Weston
-        Name1476                Weylin
-        Name1477                Whitaker
-        Name1478                Wilfen
-        Name1479                Will
-        Name1480                Willard
-        Name1481                Willem
-        Name1482                William
-        Name1483                Wilson
-        Name1484                Winston
-        Name1485                Winthrop
-        Name1486                Wlby
-        Name1487                Woody
-        Name1488                Wyatt
-        Name1489                Xavier
-        Name1490                Xenos
-        Name1491                Xerxes
-        Name1492                Ximen
-        Name1493                Yakecan
-        Name1494                Yale
-        Name1495                Yancey
-        Name1496                Yardley
-        Name1497                Yarin
-        Name1498                Yerik
-        Name1499                Yero
-        Name1500                Yervant
-        Name1501                York
-        Name1502                Yusuf
-        Name1503                Yves
-        Name1504                Zachariah
-        Name1505                Zachary
-        Name1506                Zackery
-        Name1507                Zaid
-        Name1508                Zaide
-        Name1509                Zane
-        Name1510                Zaniel
-        Name1511                Zann
-        Name1512                Zared
-        Name1513                Zarek
-        Name1514                Zeke
-        Name1515                Zenon
-        Name1516                Zion
-        Name1517                Ziven
-        Name1518                Zorn
-}
-
-Names FEMALE
-{
-        Count 2206
-        Name1           Aba
-        Name2           Abby
-        Name3           Abella
-        Name4           Abey
-        Name5           Abigail
-        Name6           Abina
-        Name7           Abiona
-        Name8           Abira
-        Name9           Abra
-        Name10          Abrah
-        Name11          Absinthe
-        Name12          Acacia
-        Name13          Acanit
-        Name14          Acantha
-        Name15          Accalia
-        Name16          Acelin
-        Name17          Achen
-        Name18          Ada
-        Name19          Adalia
-        Name20          Adamina
-        Name21          Adara
-        Name22          Addi
-        Name23          Adelaide
-        Name24          Adele
-        Name25          Adelia
-        Name26          Adeline
-        Name27          Adelle
-        Name28          Adena
-        Name29          Aderes
-        Name30          Adesina
-        Name31          Adie
-        Name32          Aditi
-        Name33          Adiva
-        Name34          Adoncia
-        Name35          Adonia
-        Name36          Adora
-        Name37          Adrienne
-        Name38          Aelina
-        Name39          Afina
-        Name40          Afra
-        Name41          Afrika
-        Name42          Afton
-        Name43          Agate
-        Name44          Agatha
-        Name45          Agnes
-        Name46          Ahara
-        Name47          Ahava
-        Name48          Ahimsa
-        Name49          Aida
-        Name50          Aiella
-        Name51          Aiko
-        Name52          Aila
-        Name53          Aileen
-        Name54          Ailsa
-        Name55          Aimee
-        Name56          Ain
-        Name57          Aina
-        Name58          Aine
-        Name59          Ainhoa
-        Name60          Ainsley
-        Name61          Aintzane
-        Name62          Airlia
-        Name63          Aisling
-        Name64          Aislinn
-        Name65          Aithne
-        Name66          Aiyana
-        Name67          Ajara
-        Name68          Ajay
-        Name69          Ajinora
-        Name70          Akako
-        Name71          Akala
-        Name72          Akanke
-        Name73          Akasma
-        Name74          Akela
-        Name75          Akilah
-        Name76          Akili
-        Name77          Akilina
-        Name78          Akina
-        Name79          Alaina
-        Name80          Alake
-        Name81          Alala
-        Name82          Alamanda
-        Name83          Alana
-        Name84          Alani
-        Name85          Alanna
-        Name86          Alaqua
-        Name87          Alavda
-        Name88          Alazne
-        Name89          Alberta
-        Name90          Albinka
-        Name91          Alcina
-        Name92          Aldea
-        Name93          Aldercy
-        Name94          Aleka
-        Name95          Alenne
-        Name96          Alesia
-        Name97          Alessa
-        Name98          Alethea
-        Name99          Alexa
-        Name100         Alexandra
-        Name101         Alexandria
-        Name102         Alexandrina
-        Name103         Alexis
-        Name104         Alexis
-        Name105         Ali
-        Name106         Alia
-        Name107         Alice
-        Name108         Alicia
-        Name109         Alida
-        Name110         Alidia
-        Name111         Alike
-        Name112         Alima
-        Name113         Alina
-        Name114         Alison
-        Name115         Alita
-        Name116         Alix
-        Name117         Aliz
-        Name118         Aliza
-        Name119         Allegra
-        Name120         Allele
-        Name121         Allinora
-        Name122         Allison
-        Name123         Allyn
-        Name124         Alma
-        Name125         Alodie
-        Name126         Aloysia
-        Name127         Altair
-        Name128         Althea
-        Name129         Alula
-        Name130         Alumit
-        Name131         Alvina
-        Name132         Alvita
-        Name133         Alysa
-        Name134         Alyssa
-        Name135         Alyssand
-        Name136         Alzena
-        Name137         Ama
-        Name138         Amabel
-        Name139         Amadi
-        Name140         Amadika
-        Name141         Amadis
-        Name142         Amaia
-        Name143         Amala
-        Name144         Amalia
-        Name145         Amanda
-        Name146         Amandine
-        Name147         Amara
-        Name148         Amarande
-        Name149         Amarante
-        Name150         Amaris
-        Name151         Amata
-        Name152         Ambar
-        Name153         Amber
-        Name154         Ambika
-        Name155         Amdis
-        Name156         Ameerah
-        Name157         Amelia
-        Name158         Amelina
-        Name159         Amethyst
-        Name160         Amie
-        Name161         Amiella
-        Name162         Amina
-        Name163         Aminta
-        Name164         Amira
-        Name165         Amissa
-        Name166         Amity
-        Name167         Amoke
-        Name168         Amy
-        Name169         An
-        Name170         Ana
-        Name171         Anana
-        Name172         Ananda
-        Name173         Anastasia
-        Name174         Ancelin
-        Name175         Andi
-        Name176         Andra
-        Name177         Andraianna
-        Name178         Andras
-        Name179         Andrea
-        Name180         Andreana
-        Name181         Andromeda
-        Name182         Aneida
-        Name183         Anella
-        Name184         Anemone
-        Name185         Anezka
-        Name186         Angela
-        Name187         Angelica
-        Name188         Angeline
-        Name189         Angelique
-        Name190         Angeni
-        Name191         Ani
-        Name192         Anica
-        Name193         Anieli
-        Name194         Anisa
-        Name195         Anita
-        Name196         Anke
-        Name197         Ann
-        Name198         Anna
-        Name199         Annabel
-        Name200         Annabelle
-        Name201         Annamarie
-        Name202         Anne
-        Name203         Annette
-        Name204         Annikka
-        Name205         Annora
-        Name206         Anorah
-        Name207         Anoush
-        Name208         Anteia
-        Name209         Anthea
-        Name210         Antje
-        Name211         Antoinette
-        Name212         Antonia
-        Name213         Aolani
-        Name214         Apara
-        Name215         Apirka
-        Name216         Apolline
-        Name217         Apollonia
-        Name218         Aponi
-        Name219         April
-        Name220         Aprille
-        Name221         Aqua
-        Name222         Aquene
-        Name223         Ara
-        Name224         Arabella
-        Name225         Arabelle
-        Name226         Araceli
-        Name227         Araminta
-        Name228         Araxie
-        Name229         Arcadia
-        Name230         Ardath
-        Name231         Ardelia
-        Name232         Arden
-        Name233         Ardis
-        Name234         Ardith
-        Name235         Areiela
-        Name236         Arella
-        Name237         Aretha
-        Name238         Aretina
-        Name239         Ariadne
-        Name240         Ariana
-        Name241         Aricia
-        Name242         Ariel
-        Name243         Ariene
-        Name244         Arista
-        Name245         Arlene
-        Name246         Arlinda
-        Name247         Armina
-        Name248         Arminda
-        Name249         Artemisia
-        Name250         Aruna
-        Name251         Arziki
-        Name252         Asaria
-        Name253         Asenka
-        Name254         Ash
-        Name255         Asha
-        Name256         Ashlan
-        Name257         Ashleigh
-        Name258         Ashley
-        Name259         Asia
-        Name260         Asisa
-        Name261         Aslinda
-        Name262         Aspasia
-        Name263         Asta
-        Name264         Aster
-        Name265         Astera
-        Name266         Astra
-        Name267         Astrea
-        Name268         Astrid
-        Name269         Atalanta
-        Name270         Atara
-        Name271         Atenne
-        Name272         Ateri
-        Name273         Athalia
-        Name274         Athara
-        Name275         Athena
-        Name276         Athene
-        Name277         Athla
-        Name278         Atifa
-        Name279         Atta
-        Name280         Aubrey
-        Name281         Auda
-        Name282         Audny
-        Name283         Audrey
-        Name284         Audrianna
-        Name285         Audun
-        Name286         Augustina
-        Name287         Aura
-        Name288         Aure
-        Name289         Aurelia
-        Name290         Aurilia
-        Name291         Aurina
-        Name292         Aurkene
-        Name293         Aurora
-        Name294         Autumn
-        Name295         Ava
-        Name296         Avana
-        Name297         Avasa
-        Name298         Avella
-        Name299         Avena
-        Name300         Avie
-        Name301         Avis
-        Name302         Aviva
-        Name303         Axella
-        Name304         Aya
-        Name305         Ayaluna
-        Name306         Ayame
-        Name307         Ayana
-        Name308         Ayasha
-        Name309         Ayda
-        Name310         Aydee
-        Name311         Ayela
-        Name312         Ayiana
-        Name313         Ayila
-        Name314         Ayisha
-        Name315         Ayita
-        Name316         Ayla
-        Name317         Aynora
-        Name318         Ayuna
-        Name319         Azaleah
-        Name320         Azalia
-        Name321         Azarael
-        Name322         Azeline
-        Name323         Azera
-        Name324         Azha
-        Name325         Azilea
-        Name326         Azina
-        Name327         Azize
-        Name328         Azora
-        Name329         Azura
-        Name330         Babette
-        Name331         Bacia
-        Name332         Baka
-        Name333         Bakarne
-        Name334         Balayna
-        Name335         Balia
-        Name336         Bambi
-        Name337         Banan
-        Name338         Banella
-        Name339         Bara
-        Name340         Barakah
-        Name341         Barbara
-        Name342         Barika
-        Name343         Basha
-        Name344         Basia
-        Name345         Basimah
-        Name346         Bathsheba
-        Name347         Batya
-        Name348         Bay
-        Name349         Bayana
-        Name350         Baylea
-        Name351         Bayo
-        Name352         Bayta
-        Name353         Bea
-        Name354         Beatrice
-        Name355         Beatrix
-        Name356         Beauvina
-        Name357         Becca
-        Name358         Becky
-        Name359         Bedelia
-        Name360         Bel
-        Name361         Belana
-        Name362         Belina
-        Name363         Belinda
-        Name364         Belita
-        Name365         Bella
-        Name366         Bellanca
-        Name367         Belle
-        Name368         Belora
-        Name369         Bente
-        Name370         Beradine
-        Name371         Berilla
-        Name372         Berit
-        Name373         Bernadette
-        Name374         Bernice
-        Name375         Beryl
-        Name376         Bess
-        Name377         Bessine
-        Name378         Beta
-        Name379         Beth
-        Name380         Bethana
-        Name381         Bethany
-        Name382         Betony
-        Name383         Bette
-        Name384         Betty
-        Name385         Beulah
-        Name386         Beverlea
-        Name387         Beverly
-        Name388         Bevin
-        Name389         Bian
-        Name390         Bianca
-        Name391         Billie
-        Name392         Bina
-        Name393         Bindy
-        Name394         Binti
-        Name395         Birdie
-        Name396         Birget
-        Name397         Birkita
-        Name398         Bixenta
-        Name399         Blanche
-        Name400         Blanda
-        Name401         Blenda
-        Name402         Bliss
-        Name403         Bly
-        Name404         Blythe
-        Name405         Bo
-        Name406         Bohdana
-        Name407         Bonamy
-        Name408         Bonita
-        Name409         Bonnie
-        Name410         Bonny
-        Name411         Borgny
-        Name412         Brandi
-        Name413         Brandy
-        Name414         Bren
-        Name415         Brenda
-        Name416         Brenna
-        Name417         Bretta
-        Name418         Briana
-        Name419         Bridget
-        Name420         Brie
-        Name421         Brier
-        Name422         Brietta
-        Name423         Brigit
-        Name424         Brigitte
-        Name425         Brina
-        Name426         Briona
-        Name427         Briony
-        Name428         Brites
-        Name429         Britta
-        Name430         Brittany
-        Name431         Bronwyn
-        Name432         Brooke
-        Name433         Brynn
-        Name434         Bucia
-        Name435         Cadence
-        Name436         Cai
-        Name437         Caimile
-        Name438         Caitlin
-        Name439         Caitrin
-        Name440         Cala
-        Name441         Calandia
-        Name442         Calandra
-        Name443         Calantha
-        Name444         Caledonia
-        Name445         Caley
-        Name446         Calida
-        Name447         Calista
-        Name448         Calla
-        Name449         Callan
-        Name450         Callia
-        Name451         Callidora
-        Name452         Callie
-        Name453         Calliope
-        Name454         Caltha
-        Name455         Calypso
-        Name456         Cam
-        Name457         Camelai
-        Name458         Camilia
-        Name459         Camilla
-        Name460         Camille
-        Name461         Canace
-        Name462         Candace
-        Name463         Candice
-        Name464         Candida
-        Name465         Candide
-        Name466         Candra
-        Name467         Candra
-        Name468         Cantara
-        Name469         Caoimhe
-        Name470         Capri
-        Name471         Caprice
-        Name472         Cara
-        Name473         Caradoc
-        Name474         Caresse
-        Name475         Cari
-        Name476         Carina
-        Name477         Carine
-        Name478         Carissa
-        Name479         Carita
-        Name480         Carla
-        Name481         Carleen
-        Name482         Carlen
-        Name483         Carling
-        Name484         Carlota
-        Name485         Carlotta
-        Name486         Carly
-        Name487         Carma
-        Name488         Carmel
-        Name489         Carmela
-        Name490         Carmelina
-        Name491         Carmelita
-        Name492         Carmen
-        Name493         Carna
-        Name494         Carnelian
-        Name495         Carol
-        Name496         Carolina
-        Name497         Caroline
-        Name498         Carolyn
-        Name499         Caron
-        Name500         Carrie
-        Name501         Caryn
-        Name502         Casey
-        Name503         Casilda
-        Name504         Cassandra
-        Name505         Cassia
-        Name506         Cassiel
-        Name507         Casta
-        Name508         Castalia
-        Name509         Catalin
-        Name510         Catalina
-        Name511         Catava
-        Name512         Caterina
-        Name513         Catherine
-        Name514         Cathleen
-        Name515         Cathy
-        Name516         Catriona
-        Name517         Cayla
-        Name518         Ceara
-        Name519         Cecania
-        Name520         Cecilia
-        Name521         Celandine
-        Name522         Celeste
-        Name523         Celia
-        Name524         Celina
-        Name525         Cellia
-        Name526         Cerelia
-        Name527         Chaitra
-        Name528         Chanah
-        Name529         Chanda
-        Name530         Chandi
-        Name531         Chandra
-        Name532         Chandra
-        Name533         Chane
-        Name534         Chanel
-        Name535         Channa
-        Name536         Chantal
-        Name537         Charis
-        Name538         Charissa
-        Name539         Charity
-        Name540         Charlotte
-        Name541         Charmaine
-        Name542         Charmian
-        Name543         Chastity
-        Name544         Chava
-        Name545         Chavi
-        Name546         Chaviva
-        Name547         Chay
-        Name548         Chaya
-        Name549         Chelsea
-        Name550         Chenoa
-        Name551         Cherice
-        Name552         Cherie
-        Name553         Cherise
-        Name554         Cheryl
-        Name555         Chesna
-        Name556         Chiara
-        Name557         Chika
-        Name558         Chilali
-        Name559         Chimalis
-        Name560         Chipo
-        Name561         Chloe
-        Name562         Chloris
-        Name563         Cho
-        Name564         Christa
-        Name565         Christable
-        Name566         Christina
-        Name567         Christine
-        Name568         Christy
-        Name569         Chyou
-        Name570         Ciannait
-        Name571         Ciar
-        Name572         Cicely
-        Name573         Cindy
-        Name574         Claire
-        Name575         Clara
-        Name576         Clarinda
-        Name577         Clarissa
-        Name578         Claudette
-        Name579         Claudia
-        Name580         Claudine
-        Name581         Clementina
-        Name582         Clementine
-        Name583         Cleo
-        Name584         Cliantha
-        Name585         Clio
-        Name586         Clorinda
-        Name587         Clover
-        Name588         Cochiti
-        Name589         Coleen
-        Name590         Colette
-        Name591         Colleen
-        Name592         Connie
-        Name593         Constance
-        Name594         Constanza
-        Name595         Consuela
-        Name596         Cora
-        Name597         Coralie
-        Name598         Corazon
-        Name599         Corbey
-        Name600         Cordelia
-        Name601         Coretta
-        Name602         Cori
-        Name603         Corinna
-        Name604         Coris
-        Name605         Corliss
-        Name606         Cornelia
-        Name607         Corrine
-        Name608         Courtney
-        Name609         Crescent
-        Name610         Cressida
-        Name611         Crystal
-        Name612         Cybele
-        Name613         Cybil
-        Name614         Cynara
-        Name615         Cynthia
-        Name616         Cyprien
-        Name617         Cyrene
-        Name618         Cyrilla
-        Name619         Cytheria
-        Name620         Dabria
-        Name621         Dacey
-        Name622         Dacia
-        Name623         Dacio
-        Name624         Dae
-        Name625         Dagmar
-        Name626         Dagna
-        Name627         Dagny
-        Name628         Dahlia
-        Name629         Dai
-        Name630         Daily
-        Name631         Daisel
-        Name632         Daisy
-        Name633         Dakota
-        Name634         Dale
-        Name635         Dalila
-        Name636         Dalilia
-        Name637         Damalis
-        Name638         Damara
-        Name639         Damaris
-        Name640         Damita
-        Name641         Dana
-        Name642         Danett
-        Name643         Dania
-        Name644         Danica
-        Name645         Daniella
-        Name646         Danielle
-        Name647         Danyelle
-        Name648         Daphene
-        Name649         Daphne
-        Name650         Daphnie
-        Name651         Dar
-        Name652         Dara
-        Name653         Daralis
-        Name654         Darby
-        Name655         Darcie
-        Name656         Darcy
-        Name657         Daria
-        Name658         Darla
-        Name659         Darlene
-        Name660         Dasha
-        Name661         Davine
-        Name662         Davita
-        Name663         Dawn
-        Name664         Daya
-        Name665         Dayna
-        Name666         Deandra
-        Name667         Deanna
-        Name668         Deanne
-        Name669         Deb
-        Name670         Deborah
-        Name671         Debra
-        Name672         Dede
-        Name673         Dedra
-        Name674         Dee
-        Name675         Deedee
-        Name676         Deianira
-        Name677         Deiene
-        Name678         Deirdre
-        Name679         Delana
-        Name680         Delaney
-        Name681         Delbin
-        Name682         Delia
-        Name683         Delicia
-        Name684         Delilah
-        Name685         Della
-        Name686         Delphine
-        Name687         Dembe
-        Name688         Demi
-        Name689         Demitria
-        Name690         Dena
-        Name691         Denby
-        Name692         Denise
-        Name693         Desa
-        Name694         Desdemona
-        Name695         Desiree
-        Name696         Deva
-        Name697         Devaki
-        Name698         Deval
-        Name699         Devi
-        Name700         Devin
-        Name701         Devnet
-        Name702         Devon
-        Name703         Diamanta
-        Name704         Diana
-        Name705         Diane
-        Name706         Dianthe
-        Name707         Diedre
-        Name708         Diella
-        Name709         Dillian
-        Name710         Dilys
-        Name711         Dinah
-        Name712         Dionne
-        Name713         Dirdre
-        Name714         Disa
-        Name715         Dita
-        Name716         Dixie
-        Name717         Dodie
-        Name718         Dolly
-        Name719         Dolores
-        Name720         Dominique
-        Name721         Dona
-        Name722         Donata
-        Name723         Donielle
-        Name724         Donna
-        Name725         Donner
-        Name726         Dooriya
-        Name727         Dophina
-        Name728         Dora
-        Name729         Doreen
-        Name730         Dorinda
-        Name731         Doris
-        Name732         Dorothea
-        Name733         Dorothy
-        Name734         Dory
-        Name735         Drew
-        Name736         Drina
-        Name737         Drucilla
-        Name738         Dulcie
-        Name739         Dulcinea
-        Name740         Dusty
-        Name741         Dyan
-        Name742         Dyani
-        Name743         Dymphna
-        Name744         Dyna
-        Name745         Eartha
-        Name746         Easter
-        Name747         Ebony
-        Name748         Echo
-        Name749         Edana
-        Name750         Eden
-        Name751         Edie
-        Name752         Edith
-        Name753         Edlyn
-        Name754         Edna
-        Name755         Edna
-        Name756         Edolie
-        Name757         Edria
-        Name758         Edwina
-        Name759         Efia
-        Name760         Eileen
-        Name761         Eirene
-        Name762         Elaine
-        Name763         Elana
-        Name764         Eleanor
-        Name765         Elena
-        Name766         Eleora
-        Name767         Elina
-        Name768         Elisa
-        Name769         Elise
-        Name770         Eliska
-        Name771         Elissa
-        Name772         Elita
-        Name773         Eliza
-        Name774         Elizabeth
-        Name775         Elke
-        Name776         Ella
-        Name777         Elle
-        Name778         Ellen
-        Name779         Elly
-        Name780         Elodie
-        Name781         Eloise
-        Name782         Elsa
-        Name783         Else
-        Name784         Elsie
-        Name785         Elynor
-        Name786         Elyse
-        Name787         Elysia
-        Name788         Ema
-        Name789         Emajane
-        Name790         Emalia
-        Name791         Ember
-        Name792         Emelie
-        Name793         Emelyne
-        Name794         Emily
-        Name795         Emma
-        Name796         Endora
-        Name797         Engracia
-        Name798         Enid
-        Name799         Enola
-        Name800         Enye
-        Name801         Eranthe
-        Name802         Erasma
-        Name803         Erianthe
-        Name804         Erica
-        Name805         Erika
-        Name806         Erin
-        Name807         Erlina
-        Name808         Erwand
-        Name809         Eskarne
-        Name810         Esmerelda
-        Name811         Esperanza
-        Name812         Esta
-        Name813         Estelle
-        Name814         Esther
-        Name815         Etain
-        Name816         Etania
-        Name817         Etsu
-        Name818         Etta
-        Name819         Eudocia
-        Name820         Eugenia
-        Name821         Eulalia
-        Name822         Eustacia
-        Name823         Eva
-        Name824         Evacsa
-        Name825         Evadine
-        Name826         Evadne
-        Name827         Evangeline
-        Name828         Evanthe
-        Name829         Eve
-        Name830         Evelyn
-        Name831         Evita
-        Name832         Evonne
-        Name833         Eyota
-        Name834         Fabienne        
-        Name835         Fainche 
-        Name836         Fairuza 
-        Name837         Faith   
-        Name838         Faizah  
-        Name839         Fallon
-        Name840         Fantine
-        Name841         Farha
-        Name842         Farrah
-        Name843         Fatima
-        Name844         Fatin
-        Name845         Fawne
-        Name846         Fay
-        Name847         Faye
-        Name848         Fayina
-        Name849         Fayme
-        Name850         Felcia
-        Name851         Felicia
-        Name852         Felicite
-        Name853         Felicity
-        Name854         Femi
-        Name855         Feridwyn
-        Name856         Fern
-        Name857         Feronia
-        Name858         Filinda
-        Name859         Fina
-        Name860         Finola
-        Name861         Fiona
-        Name862         Fiorenza
-        Name863         Flavia
-        Name864         Fleta
-        Name865         Flora
-        Name866         Florence
-        Name867         Frances
-        Name868         Francesca
-        Name869         Francine
-        Name870         Francisca
-        Name871         Freda
-        Name872         Frederica
-        Name873         Freya
-        Name874         Frida
-        Name875         Frieda
-        Name876         Fuscienne
-        Name877         Gabriella
-        Name878         Gabrielle
-        Name879         Gaia
-        Name880         Gail
-        Name881         Gala
-        Name882         Galatea
-        Name883         Gali
-        Name884         Galina
-        Name885         Galya
-        Name886         Gana
-        Name887         Ganesa
-        Name888         Gauri
-        Name889         Gaye
-        Name890         Gayle
-        Name891         Gelasia
-        Name892         Gemma
-        Name893         Genevieve
-        Name894         Geogia
-        Name895         Georgeanne
-        Name896         Georgetta
-        Name897         Georgette
-        Name898         Georgiana
-        Name899         Geradline
-        Name900         Geraldine
-        Name901         Gerda
-        Name902         Gerri
-        Name903         Gertrude
-        Name904         Geva
-        Name905         Ghislaine
-        Name906         Giacinta
-        Name907         Gianina
-        Name908         Gigi
-        Name909         Gilana
-        Name910         Gilda
-        Name911         Gilen
-        Name912         Gillian
-        Name913         Gin
-        Name914         Gina
-        Name915         Ginger
-        Name916         Giselle
-        Name917         Gitana
-        Name918         Githa
-        Name919         Gizane
-        Name920         Gleda
-        Name921         Glenna
-        Name922         Glennys
-        Name923         Gloria
-        Name924         Golda
-        Name925         Goldie
-        Name926         Gotzone
-        Name927         Grace
-        Name928         Gracie
-        Name929         Grainne
-        Name930         Grazia
-        Name931         Grear
-        Name932         Greta
-        Name933         Gretchen
-        Name934         Grette
-        Name935         Gwen
-        Name936         Gwendolyn
-        Name937         Gweneth
-        Name938         Gwynne
-        Name939         Gytha
-        Name940         Hadara
-        Name941         Hadassa
-        Name942         Hadiya
-        Name943         Haidee
-        Name944         Hailey
-        Name945         Haimi
-        Name946         Haldis
-        Name947         Hale
-        Name948         Haley
-        Name949         Hali
-        Name950         Hali
-        Name951         Halima
-        Name952         Halle
-        Name953         Hallie
-        Name954         Hana
-        Name955         Hanan
-        Name956         Hannah
-        Name957         Hanne
-        Name958         Harmoni
-        Name959         Harriet
-        Name960         Hasna
-        Name961         Hava
-        Name962         Haya
-        Name963         Haylee
-        Name964         Hazel
-        Name965         Hea
-        Name966         Heather
-        Name967         Hei
-        Name968         Heidi
-        Name969         Heldegarde
-        Name970         Helen
-        Name971         Helena
-        Name972         Helene
-        Name973         Helki
-        Name974         Henka
-        Name975         Henrietta
-        Name976         Hesper
-        Name977         Hester
-        Name978         Hilary
-        Name979         Hilda
-        Name980         Hinda
-        Name981         Hisa
-        Name982         Holly
-        Name983         Hope
-        Name984         Hoshi
-        Name985         Huyana
-        Name986         Hyacinth
-        Name987         Hye
-        Name988         Hypatia
-        Name989         Ianthe
-        Name990         Ida
-        Name991         Idola
-        Name992         Idonia
-        Name993         Ilene
-        Name994         Ilona
-        Name995         Iman
-        Name996         Imogene
-        Name997         India
-        Name998         Indira
-        Name999         Indra
-        Name1000                Ines
-        Name1001                Inez
-        Name1002                Inga
-        Name1003                Ingrid
-        Name1004                Iolana
-        Name1005                Iolanthe
-        Name1006                Iona
-        Name1007                Iratze
-        Name1008                Irena
-        Name1009                Irene
-        Name1010                Iris
-        Name1011                Irma
-        Name1012                Isabeau
-        Name1013                Isabel
-        Name1014                Isabella
-        Name1015                Isadora
-        Name1016                Isaura
-        Name1017                Isis
-        Name1018                Isleta
-        Name1019                Isobel
-        Name1020                Isoke
-        Name1021                Istas
-        Name1022                Ivana
-        Name1023                Ivory
-        Name1024                Ivy
-        Name1025                Jacelyn
-        Name1026                Jacinda
-        Name1027                Jacinthe
-        Name1028                Jacqueline
-        Name1029                Jada
-        Name1030                Jael
-        Name1031                Jaen
-        Name1032                Jaimie
-        Name1033                Jaione
-        Name1034                Jakinda
-        Name1035                Jala
-        Name1036                Jamie
-        Name1037                Jamila
-        Name1038                Jamilah
-        Name1039                Jan
-        Name1040                Jana
-        Name1041                Jane
-        Name1042                Janelle
-        Name1043                Janet
-        Name1044                Janice
-        Name1045                Janis
-        Name1046                Janna
-        Name1047                Jannelle
-        Name1048                Jardena
-        Name1049                Jarvia
-        Name1050                Jarvinia
-        Name1051                Jasmine
-        Name1052                Jaya
-        Name1053                Jayne
-        Name1054                Jean
-        Name1055                Jean
-        Name1056                Jeanette
-        Name1057                Jeanine
-        Name1058                Jelena
-        Name1059                Jena
-        Name1060                Jenay
-        Name1061                Jendayi
-        Name1062                Jendyose
-        Name1063                Jenica
-        Name1064                Jennettia
-        Name1065                Jennifer
-        Name1066                Jensine
-        Name1067                Jerrilyn
-        Name1068                Jessamine
-        Name1069                Jessica
-        Name1070                Jewel
-        Name1071                Jezebel
-        Name1072                Jihan
-        Name1073                Jillian
-        Name1074                Jin
-        Name1075                Jina
-        Name1076                Jinny
-        Name1077                Jinx
-        Name1078                Joakima
-        Name1079                Joan
-        Name1080                Joanne
-        Name1081                Jobey
-        Name1082                Jobihna
-        Name1083                Jocasa
-        Name1084                Jocelyn
-        Name1085                Jodi
-        Name1086                Jody
-        Name1087                Joelle
-        Name1088                Joelliane
-        Name1089                Johanna
-        Name1090                Joia
-        Name1091                Jolan
-        Name1092                Jolanta
-        Name1093                Jolene
-        Name1094                Jolie
-        Name1095                Joline
-        Name1096                Jonina
-        Name1097                Jora
-        Name1098                Jordane
-        Name1099                Josephine
-        Name1100                Josie
-        Name1101                Jotha
-        Name1102                Joy
-        Name1103                Joyce
-        Name1104                Joye
-        Name1105                Juanita
-        Name1106                Judith
-        Name1107                Juditha
-        Name1108                Julia
-        Name1109                Juliana
-        Name1110                Juliane
-        Name1111                Julie
-        Name1112                Julietta
-        Name1113                Julinka
-        Name1114                Julita
-        Name1115                Jumoke
-        Name1116                Jun
-        Name1117                June
-        Name1118                Justine
-        Name1119                Kaatje
-        Name1120                Kachine
-        Name1121                Kaclyn
-        Name1122                Kaede
-        Name1123                Kaethe
-        Name1124                Kai
-        Name1125                Kaia
-        Name1126                Kaie
-        Name1127                Kaili
-        Name1128                Kaimi
-        Name1129                Kairos
-        Name1130                Kaiya
-        Name1131                Kakra
-        Name1132                Kala
-        Name1133                Kalama
-        Name1134                Kalanit
-        Name1135                Kalare
-        Name1136                Kalea
-        Name1137                Kali
-        Name1138                Kalika
-        Name1139                Kalila
-        Name1140                Kalinda
-        Name1141                Kalle
-        Name1142                Kalli
-        Name1143                Kalonice
-        Name1144                Kalyca
-        Name1145                Kama
-        Name1146                Kamala
-        Name1147                Kamali
-        Name1148                Kamaria
-        Name1149                Kambo
-        Name1150                Kameko
-        Name1151                Kamilah
-        Name1152                Kamilia
-        Name1153                Kanda
-        Name1154                Kane
-        Name1155                Kanene
-        Name1156                Kanika
-        Name1157                Kantha
-        Name1158                Kanya
-        Name1159                Kapera
-        Name1160                Kara
-        Name1161                Karan
-        Name1162                Karayan
-        Name1163                Karel
-        Name1164                Karen
-        Name1165                Karida
-        Name1166                Karimah
-        Name1167                Karisa
-        Name1168                Karka
-        Name1169                Karla
-        Name1170                Karlenne
-        Name1171                Karli
-        Name1172                Karlyn
-        Name1173                Karmina
-        Name1174                Karol
-        Name1175                Karylin
-        Name1176                Karyn
-        Name1177                Kasa
-        Name1178                Kasen
-        Name1179                Kasia
-        Name1180                Kasinda
-        Name1181                Kassia
-        Name1182                Kate
-        Name1183                Katherine
-        Name1184                Kathleen
-        Name1185                Katie
-        Name1186                Katja
-        Name1187                Katoka
-        Name1188                Katrien
-        Name1189                Katrina
-        Name1190                Kaula
-        Name1191                Kaveri
-        Name1192                Kavindra
-        Name1193                Kay
-        Name1194                Kaya
-        Name1195                Kaye
-        Name1196                Kayla
-        Name1197                Kaysa
-        Name1198                Kazia
-        Name1199                Keara
-        Name1200                Keelin
-        Name1201                Keely
-        Name1202                Kefira
-        Name1203                Kehinde
-        Name1204                Kei
-        Name1205                Keiko
-        Name1206                Keisha
-        Name1207                Kekona
-        Name1208                Kelda
-        Name1209                Kelia
-        Name1210                Kelley
-        Name1211                Kelli
-        Name1212                Kellie
-        Name1213                Kelly
-        Name1214                Kelsey
-        Name1215                Kendra
-        Name1216                Kennis
-        Name1217                Kenyangi
-        Name1218                Kepa
-        Name1219                Kerani
-        Name1220                Kerensa
-        Name1221                Kerstan
-        Name1222                Kesare
-        Name1223                Kesi
-        Name1224                Kesia
-        Name1225                Kessie
-        Name1226                Keturah
-        Name1227                Ketzia
-        Name1228                Khalida
-        Name1229                Kichi
-        Name1230                Kiele
-        Name1231                Kim
-        Name1232                Kimberly
-        Name1233                Kimmie
-        Name1234                Kimmy
-        Name1235                Kineta
-        Name1236                Kiona
-        Name1237                Kira
-        Name1238                Kiran
-        Name1239                Kirby
-        Name1240                Kirima
-        Name1241                Kirsten
-        Name1242                Kirti
-        Name1243                Kisa
-        Name1244                Kiska
-        Name1245                Kismet
-        Name1246                Kissa
-        Name1247                Kita
-        Name1248                Kohana
-        Name1249                Koko
-        Name1250                Kolina
-        Name1251                Koren
-        Name1252                Koressa
-        Name1253                Kristen
-        Name1254                Kyly
-        Name1255                Kyna
-        Name1256                Kynthia
-        Name1257                Kyoko
-        Name1258                Lacey
-        Name1259                Lacie
-        Name1260                Laila
-        Name1261                Lailie
-        Name1262                Lakeisha
-        Name1263                Lala
-        Name1264                Lalasa
-        Name1265                Lan
-        Name1266                Lana
-        Name1267                Landra
-        Name1268                Lane
-        Name1269                Lani
-        Name1270                Lara
-        Name1271                Laraine
-        Name1272                Laralee
-        Name1273                Lari
-        Name1274                Larissa
-        Name1275                Lark
-        Name1276                Latika
-        Name1277                Latonia
-        Name1278                Laura
-        Name1279                Laurana
-        Name1280                Laurel
-        Name1281                Laurie
-        Name1282                Laurinda
-        Name1283                Lauryn
-        Name1284                Laveda
-        Name1285                Lavern
-        Name1286                Laverne
-        Name1287                Lavinia
-        Name1288                Lea
-        Name1289                Leah
-        Name1290                Leah
-        Name1291                Leala
-        Name1292                Leandra
-        Name1293                Leba
-        Name1294                Ledah
-        Name1295                Lee
-        Name1296                Leigh
-        Name1297                Leiko
-        Name1298                Leila
-        Name1299                Leilana
-        Name1300                Lena
-        Name1301                Lene
-        Name1302                Lenor
-        Name1303                Lenora
-        Name1304                Lenore
-        Name1305                Leona
-        Name1306                Leora
-        Name1307                Leslie
-        Name1308                Letha
-        Name1309                Letitia
-        Name1310                Levana
-        Name1311                Lexine
-        Name1312                Lia
-        Name1313                Liadan
-        Name1314                Lian
-        Name1315                Liana
-        Name1316                Liane
-        Name1317                Libby
-        Name1318                Lien
-        Name1319                Lila
-        Name1320                Lilith
-        Name1321                Lillian
-        Name1322                Lillie
-        Name1323                Lily
-        Name1324                Limber
-        Name1325                Lina
-        Name1326                Linda
-        Name1327                Lindsay
-        Name1328                Lindsey
-        Name1329                Linette
-        Name1330                Linnae
-        Name1331                Linnea
-        Name1332                Lisa
-        Name1333                Lisette
-        Name1334                Litsa
-        Name1335                Liv
-        Name1336                Liza
-        Name1337                Lois
-        Name1338                Lokelani
-        Name1339                Lola
-        Name1340                Loni
-        Name1341                Lora
-        Name1342                Lore
-        Name1343                Lorelei
-        Name1344                Lorelle
-        Name1345                Loretta
-        Name1346                Lori
-        Name1347                Lorraine
-        Name1348                Lotus
-        Name1349                Louise
-        Name1350                Lucia
-        Name1351                Lucille
-        Name1352                Lucinda
-        Name1353                Lucine
-        Name1354                Lucretia
-        Name1355                Lucy
-        Name1356                Ludia
-        Name1357                Luela
-        Name1358                Luisa
-        Name1359                Lukene
-        Name1360                Lukina
-        Name1361                Lulu
-        Name1362                Luna
-        Name1363                Lydia
-        Name1364                Lynda
-        Name1365                Lynelle
-        Name1366                Lynn
-        Name1367                Lynnda
-        Name1368                Lynnette
-        Name1369                Lyris
-        Name1370                Lysel
-        Name1371                Lysnadra
-        Name1372                Mabel
-        Name1373                Macaria
-        Name1374                Machi
-        Name1375                Maddy
-        Name1376                Madelaine
-        Name1377                Madelina
-        Name1378                Madeline
-        Name1379                Madelon
-        Name1380                Madelyn
-        Name1381                Mady
-        Name1382                Mae
-        Name1383                Magan
-        Name1384                Magara
-        Name1385                Magdalen
-        Name1386                Magdalena
-        Name1387                Magdaline
-        Name1388                Magena
-        Name1389                Magenta
-        Name1390                Maggie
-        Name1391                Mahala
-        Name1392                Mahalia
-        Name1393                Mai
-        Name1394                Maia
-        Name1395                Maida
-        Name1396                Maisie
-        Name1397                Maitane
-        Name1398                Maizah
-        Name1399                Maj
-        Name1400                Malaya
-        Name1401                Malila
-        Name1402                Malina
-        Name1403                Malinda
-        Name1404                Malka
-        Name1405                Mallory
-        Name1406                Malu
-        Name1407                Mamie
-        Name1408                Manda
-        Name1409                Mandara
-        Name1410                Mandisa
-        Name1411                Mandy
-        Name1412                Mangena
-        Name1413                Manon
-        Name1414                Mansi
-        Name1415                Manya
-        Name1416                Mara
-        Name1417                Marcella
-        Name1418                Marcia
-        Name1419                Marcy
-        Name1420                Maren
-        Name1421                Margaret
-        Name1422                Margaret
-        Name1423                Margarita
-        Name1424                Margo
-        Name1425                Margot
-        Name1426                Marguirte
-        Name1427                Maria
-        Name1428                Mariah
-        Name1429                Mariam
-        Name1430                Mariama
-        Name1431                Marian
-        Name1432                Mariana
-        Name1433                Marianna
-        Name1434                Marianne
-        Name1435                Maribel
-        Name1436                Marie
-        Name1437                Mariel
-        Name1438                Marietta
-        Name1439                Marily
-        Name1440                Marilyn
-        Name1441                Marina
-        Name1442                Maris
-        Name1443                Marisa
-        Name1444                Marisha
-        Name1445                Marissa
-        Name1446                Marjani
-        Name1447                Marjeta
-        Name1448                Marjorie
-        Name1449                Marlene
-        Name1450                Marlo
-        Name1451                Marmara
-        Name1452                Marnie
-        Name1453                Marnina
-        Name1454                Marsha
-        Name1455                Marta
-        Name1456                Martha
-        Name1457                Marti
-        Name1458                Martina
-        Name1459                Mary
-        Name1460                Maryann
-        Name1461                Marybeth
-        Name1462                Marylou
-        Name1463                Marzia
-        Name1464                Matana
-        Name1465                Mathea
-        Name1466                Matilda
-        Name1467                Matrika
-        Name1468                Maud
-        Name1469                Maude
-        Name1470                Maura
-        Name1471                Maureen
-        Name1472                Maurita
-        Name1473                Mavis
-        Name1474                Maxine
-        Name1475                May
-        Name1476                Maya
-        Name1477                Meara
-        Name1478                Meara
-        Name1479                Meda
-        Name1480                Medea
-        Name1481                Meg
-        Name1482                Megan
-        Name1483                Megara
-        Name1484                Meghan
-        Name1485                Mei
-        Name1486                Meira
-        Name1487                Mela
-        Name1488                Melanie
-        Name1489                Melantha
-        Name1490                Melba
-        Name1491                Melia
-        Name1492                Melian
-        Name1493                Melina
-        Name1494                Melinda
-        Name1495                Melisenda
-        Name1496                Melissa
-        Name1497                Mellinio
-        Name1498                Melodie
-        Name1499                Melody
-        Name1500                Melosa
-        Name1501                Melva
-        Name1502                Mercedes
-        Name1503                Meredith
-        Name1504                Merele
-        Name1505                Mesha
-        Name1506                Meta
-        Name1507                Mia
-        Name1508                Miakoda
-        Name1509                Michaela
-        Name1510                Michele
-        Name1511                Michelle
-        Name1512                Midori
-        Name1513                Migina
-        Name1514                Mignon
-        Name1515                Mika
-        Name1516                Millicent
-        Name1517                Millie
-        Name1518                Min
-        Name1519                Mina
-        Name1520                Minda
-        Name1521                Mindel
-        Name1522                Mindy
-        Name1523                Minerva
-        Name1524                Minka
-        Name1525                Minna
-        Name1526                Minnie
-        Name1527                Mira
-        Name1528                Miranda
-        Name1529                Mirem
-        Name1530                Miremba
-        Name1531                Mireya
-        Name1532                Miriam
-        Name1533                Mirielle
-        Name1534                Missy
-        Name1535                Misty
-        Name1536                Mitena
-        Name1537                Mitexi
-        Name1538                Mitzi
-        Name1539                Miyoko
-        Name1540                Moira
-        Name1541                Mollie
-        Name1542                Molly
-        Name1543                Mona
-        Name1544                Monica
-        Name1545                Monique
-        Name1546                Moon
-        Name1547                Morena
-        Name1548                Morgan
-        Name1549                Morgana
-        Name1550                Morgance
-        Name1551                Moria
-        Name1552                Moriah
-        Name1553                Muriel
-        Name1554                Myra
-        Name1555                Nada
-        Name1556                Nadia
-        Name1557                Nadine
-        Name1558                Nadya
-        Name1559                Naia
-        Name1560                Nailah
-        Name1561                Naimah
-        Name1562                Nalini
-        Name1563                Namazzi
-        Name1564                Nami
-        Name1565                Nan
-        Name1566                Nana
-        Name1567                Nancy
-        Name1568                Nanette
-        Name1569                Nantale
-        Name1570                Naomi
-        Name1571                Napea
-        Name1572                Nara
-        Name1573                Narda
-        Name1574                Narmada
-        Name1575                Nasiche
-        Name1576                Nastassia
-        Name1577                Natalie
-        Name1578                Natane
-        Name1579                Natasha
-        Name1580                Natesa
-        Name1581                Naysa
-        Name1582                Nazirqah
-        Name1583                Neala
-        Name1584                Neci
-        Name1585                Nediva
-        Name1586                Neely
-        Name1587                Nekane
-        Name1588                Nell
-        Name1589                Neola
-        Name1590                Neoma
-        Name1591                Neona
-        Name1592                Neria
-        Name1593                Nerine
-        Name1594                Nerissa
-        Name1595                Netti
-        Name1596                Neva
-        Name1597                Nevada
-        Name1598                Neysa
-        Name1599                Nicia
-        Name1600                Nicola
-        Name1601                Nicole
-        Name1602                Nicolette
-        Name1603                Nika
-        Name1604                Nikki
-        Name1605                Nimah
-        Name1606                Nina
-        Name1607                Niobe
-        Name1608                Niola
-        Name1609                Nira
-        Name1610                Nirvelli
-        Name1611                Nissa
-        Name1612                Nita
-        Name1613                Nitara
-        Name1614                Nitzana
-        Name1615                Nixie
-        Name1616                Noel
-        Name1617                Noelani
-        Name1618                Noella
-        Name1619                Nolita
-        Name1620                Nona
-        Name1621                Nona
-        Name1622                Nora
-        Name1623                Norah
-        Name1624                Noreen
-        Name1625                Nori
-        Name1626                Noriko
-        Name1627                Norma
-        Name1628                Nydia
-        Name1629                Nyrna
-        Name1630                Nyssa
-        Name1631                Nyx
-        Name1632                Obelia
-        Name1633                Octavia
-        Name1634                Odelia
-        Name1635                Odelia
-        Name1636                Odera
-        Name1637                Odessa
-        Name1638                Odetta
-        Name1639                Odette
-        Name1640                Odile
-        Name1641                Ohanna
-        Name1642                Okelani
-        Name1643                Olathe
-        Name1644                Olayinka
-        Name1645                Olesia
-        Name1646                Olga
-        Name1647                Oliana
-        Name1648                Olinda
-        Name1649                Olive
-        Name1650                Olivette
-        Name1651                Olivia
-        Name1652                Ona
-        Name1653                Onida
-        Name1654                Opal
-        Name1655                Ophelia
-        Name1656                Oralie
-        Name1657                Orane
-        Name1658                Orenda
-        Name1659                Oriana
-        Name1660                Orianna
-        Name1661                Oriel
-        Name1662                Oriole
-        Name1663                Orlantha
-        Name1664                Ornidaa
-        Name1665                Paige
-        Name1666                Pakuna
-        Name1667                Palmiera
-        Name1668                Paloma
-        Name1669                Pamela
-        Name1670                Pandita
-        Name1671                Pandora
-        Name1672                Panthea
-        Name1673                Pantzike
-        Name1674                Panya
-        Name1675                Panyin
-        Name1676                Pascale
-        Name1677                Patia
-        Name1678                Patience
-        Name1679                Patricia
-        Name1680                Patsy
-        Name1681                Paula
-        Name1682                Paulette
-        Name1683                Pauline
-        Name1684                Pavla
-        Name1685                Pazia
-        Name1686                Pearl
-        Name1687                Peg
-        Name1688                Peggy
-        Name1689                Pelagia
-        Name1690                Pemba
-        Name1691                Penda
-        Name1692                Penelope
-        Name1693                Peninna
-        Name1694                Penny
-        Name1695                Penthea
-        Name1696                Peony
-        Name1697                Perdita
-        Name1698                Perouze
-        Name1699                Persis
-        Name1700                Petra
-        Name1701                Phaedra
-        Name1702                Phedra
-        Name1703                Philomena
-        Name1704                Phoebe
-        Name1705                Phylis
-        Name1706                Phyllis
-        Name1707                Pia
-        Name1708                Pier
-        Name1709                Pila
-        Name1710                Piper
-        Name1711                Polly
-        Name1712                Poloma
-        Name1713                Porche
-        Name1714                Portia
-        Name1715                Priscilla
-        Name1716                Prudence
-        Name1717                Prudy
-        Name1718                Pyrena
-        Name1719                Pythia
-        Name1720                Qamra
-        Name1721                Queena
-        Name1722                Quella
-        Name1723                Quenby
-        Name1724                Quintina
-        Name1725                Quiterie
-        Name1726                Rachel
-        Name1727                Radella
-        Name1728                Radinka
-        Name1729                Rae
-        Name1730                Rai
-        Name1731                Raisa
-        Name1732                Raizel
-        Name1733                Ramla
-        Name1734                Ramona
-        Name1735                Ramya
-        Name1736                Randie
-        Name1737                Rane
-        Name1738                Ranee
-        Name1739                Rani
-        Name1740                Raquel
-        Name1741                Rashida
-        Name1742                Rasine
-        Name1743                Ratri
-        Name1744                Raven
-        Name1745                Rawnie
-        Name1746                Rayna
-        Name1747                Raynell
-        Name1748                Raziya
-        Name1749                Reba
-        Name1750                Rebecca
-        Name1751                Regan
-        Name1752                Regina
-        Name1753                Rei
-        Name1754                Reidun
-        Name1755                Remy
-        Name1756                Rena
-        Name1757                Renata
-        Name1758                Rene
-        Name1759                Renee
-        Name1760                Rhea
-        Name1761                Rhiamon
-        Name1762                Rhianne
-        Name1763                Rhiannon
-        Name1764                Rhoda
-        Name1765                Rhodanthe
-        Name1766                Rhonda
-        Name1767                Rhonna
-        Name1768                Rhyssa
-        Name1769                Ria
-        Name1770                Riane
-        Name1771                Rica
-        Name1772                Rihana
-        Name1773                Rikki
-        Name1774                Rio
-        Name1775                Risa
-        Name1776                Rita
-        Name1777                Riva
-        Name1778                Roanna
-        Name1779                Roberta
-        Name1780                Robin
-        Name1781                Robyn
-        Name1782                Rochelle
-        Name1783                Rohanna
-        Name1784                Rona
-        Name1785                Rorie
-        Name1786                Rosa
-        Name1787                Rosalind
-        Name1788                Rosalinda
-        Name1789                Rosalinde
-        Name1790                Rosaline
-        Name1791                Rosanne
-        Name1792                Rose
-        Name1793                Roseanne
-        Name1794                Rosemarie
-        Name1795                Rosemary
-        Name1796                Rowena
-        Name1797                Roxana
-        Name1798                Roxanne
-        Name1799                Ruby
-        Name1800                Rumer
-        Name1801                Ruth
-        Name1802                Ruthann
-        Name1803                Ryann
-        Name1804                Ryanne
-        Name1805                Ryba
-        Name1806                Ryssa
-        Name1807                Saba
-        Name1808                Sabina
-        Name1809                Sabiny
-        Name1810                Sabirah
-        Name1811                Sabra
-        Name1812                Sabrina
-        Name1813                Sacha
-        Name1814                Sachi
-        Name1815                Sade
-        Name1816                Sadira
-        Name1817                Saffi
-        Name1818                Safiya
-        Name1819                Sagara
-        Name1820                Saidah
-        Name1821                Sakari
-        Name1822                Sakinah
-        Name1823                Sakti
-        Name1824                Sakura
-        Name1825                Salihah
-        Name1826                Salimah
-        Name1827                Salina
-        Name1828                Sally
-        Name1829                Salome
-        Name1830                Samantha
-        Name1831                Samara
-        Name1832                Samirah
-        Name1833                Sancia
-        Name1834                Sandia
-        Name1835                Sandra
-        Name1836                Sandrine
-        Name1837                Sandya
-        Name1838                Sara
-        Name1839                Sarah
-        Name1840                Sarai
-        Name1841                Saraid
-        Name1842                Saree
-        Name1843                Sarena
-        Name1844                Sari
-        Name1845                Sarisha
-        Name1846                Sasha
-        Name1847                Sashenka
-        Name1848                Satinka
-        Name1849                Savanna
-        Name1850                Saxon
-        Name1851                Scotia
-        Name1852                Searlait
-        Name1853                Season
-        Name1854                Sebasten
-        Name1855                Seema
-        Name1856                Sela
-        Name1857                Selena
-        Name1858                Selina
-        Name1859                Selma
-        Name1860                Semele
-        Name1861                Senta
-        Name1862                Serafina
-        Name1863                Serilda
-        Name1864                Sesha
-        Name1865                Shaine
-        Name1866                Shakira
-        Name1867                Shako
-        Name1868                Shammara
-        Name1869                Shana
-        Name1870                Shanata
-        Name1871                Shandra
-        Name1872                Shandy
-        Name1873                Shani
-        Name1874                Shanley
-        Name1875                Shanna
-        Name1876                Shannon
-        Name1877                Shantay
-        Name1878                Shantha
-        Name1879                Sharman
-        Name1880                Sharon
-        Name1881                Sharri
-        Name1882                Shashi
-        Name1883                Shawn
-        Name1884                Shayndel
-        Name1885                Sheba
-        Name1886                Sheena
-        Name1887                Sheila
-        Name1888                Shela
-        Name1889                Shelby
-        Name1890                Shelley
-        Name1891                Shelly
-        Name1892                Sherri
-        Name1893                Sherry
-        Name1894                Shika
-        Name1895                Shin
-        Name1896                Shina
-        Name1897                Shira
-        Name1898                Shirley
-        Name1899                Shobi
-        Name1900                Shoshana
-        Name1901                Sibley
-        Name1902                Sibongile
-        Name1903                Sibyl
-        Name1904                Sidonia
-        Name1905                Sidra
-        Name1906                Sierra
-        Name1907                Sigourney
-        Name1908                Siham
-        Name1909                Sileas
-        Name1910                Silva
-        Name1911                Silvia
-        Name1912                Simba
-        Name1913                Simone
-        Name1914                Sine
-        Name1915                Sinead
-        Name1916                Siobhan
-        Name1917                Siran
-        Name1918                Sirena
-        Name1919                Siroun
-        Name1920                Sitara
-        Name1921                Sitembile
-        Name1922                Siv
-        Name1923                Sive
-        Name1924                Skyler
-        Name1925                Sofi
-        Name1926                Solana
-        Name1927                Solange
-        Name1928                Soledad
-        Name1929                Solita
-        Name1930                Sondra
-        Name1931                Sonia
-        Name1932                Sonja
-        Name1933                Sonya
-        Name1934                Soo
-        Name1935                Sophia
-        Name1936                Sophie
-        Name1937                Sophronia
-        Name1938                Spica
-        Name1939                Stacey
-        Name1940                Stacia
-        Name1941                Stacy
-        Name1942                Stefania
-        Name1943                Stella
-        Name1944                Stephani
-        Name1945                Stephanie
-        Name1946                Ster
-        Name1947                Stesha
-        Name1948                Stockard
-        Name1949                Storm
-        Name1950                Sukatai
-        Name1951                Suki
-        Name1952                Sumi
-        Name1953                Summer
-        Name1954                Sun
-        Name1955                Susan
-        Name1956                Susanna
-        Name1957                Suzanne
-        Name1958                Svetlana
-        Name1959                Sybil
-        Name1960                Sydelle
-        Name1961                Sydney
-        Name1962                Syeira
-        Name1963                Sylvia
-        Name1964                Syna
-        Name1965                Synia
-        Name1966                Tabitha
-        Name1967                Taci
-        Name1968                Tacita
-        Name1969                Tadi
-        Name1970                Taffy
-        Name1971                Tahirah
-        Name1972                Tai
-        Name1973                Taima
-        Name1974                Tainn
-        Name1975                Taipa
-        Name1976                Taite
-        Name1977                Taka
-        Name1978                Takara
-        Name1979                Takiyah
-        Name1980                Takoda
-        Name1981                Talasi
-        Name1982                Tale
-        Name1983                Talia
-        Name1984                Talia
-        Name1985                Talitha
-        Name1986                Tallulah
-        Name1987                Tam
-        Name1988                Tama
-        Name1989                Tamara
-        Name1990                Tamary
-        Name1991                Tamma
-        Name1992                Tammy
-        Name1993                Tanaka
-        Name1994                Tani
-        Name1995                Tansy
-        Name1996                Tanya
-        Name1997                Tao
-        Name1998                Tara
-        Name1999                Tate
-        Name2000                Tatyana
-        Name2001                Tawnie
-        Name2002                Tawny
-        Name2003                Tayce
-        Name2004                Taylor
-        Name2005                Teague
-        Name2006                Tehya
-        Name2007                Tekla
-        Name2008                Temina
-        Name2009                Terentia
-        Name2010                Teresa
-        Name2011                Terese
-        Name2012                Terrilyn
-        Name2013                Tertia
-        Name2014                Teryn
-        Name2015                Tesia
-        Name2016                Tess
-        Name2017                Tessa
-        Name2018                Thadea
-        Name2019                Thais
-        Name2020                Thalassa
-        Name2021                Thalia
-        Name2022                Than
-        Name2023                Thana
-        Name2024                Thara
-        Name2025                Thea
-        Name2026                Thekla
-        Name2027                Thelma
-        Name2028                Theodosia
-        Name2029                Theone
-        Name2030                Thera
-        Name2031                Therese
-        Name2032                Thirza
-        Name2033                Thora
-        Name2034                Thyra
-        Name2035                Tia
-        Name2036                Tiara
-        Name2037                Tienette
-        Name2038                Tierney
-        Name2039                Tierra
-        Name2040                Tiffany
-        Name2041                Tilda
-        Name2042                Timandra
-        Name2043                Tina
-        Name2044                Tiponya
-        Name2045                Tirza
-        Name2046                Tivona
-        Name2047                Tobey
-        Name2048                Tola
-        Name2049                Tora
-        Name2050                Tori
-        Name2051                Tory
-        Name2052                Tosia
-        Name2053                Tove
-        Name2054                Tracey
-        Name2055                Tracy
-        Name2056                Treasa
-        Name2057                Tresa
-        Name2058                Treva
-        Name2059                Trianon
-        Name2060                Tricia
-        Name2061                Trilby
-        Name2062                Trina
-        Name2063                Trind
-        Name2064                Trish
-        Name2065                Trisha
-        Name2066                Trudy
-        Name2067                Tryne
-        Name2068                Tryphena
-        Name2069                Tuesday
-        Name2070                Tyne
-        Name2071                Ula
-        Name2072                Ulani
-        Name2073                Ultima
-        Name2074                Uma
-        Name2075                Una
-        Name2076                Undine
-        Name2077                Undine
-        Name2078                Urania
-        Name2079                Uria
-        Name2080                Uriana
-        Name2081                Ursula
-        Name2082                Uta
-        Name2083                Vala
-        Name2084                Valda
-        Name2085                Valentina
-        Name2086                Valeria
-        Name2087                Valerie
-        Name2088                Valeska
-        Name2089                Valonia
-        Name2090                Valora
-        Name2091                Vanda
-        Name2092                Vanessa
-        Name2093                Vanora
-        Name2094                Vanya
-        Name2095                Vashti
-        Name2096                Veda
-        Name2097                Velika
-        Name2098                Velma
-        Name2099                Venesssa
-        Name2100                Vera
-        Name2101                Verena
-        Name2102                Verity
-        Name2103                Veronica
-        Name2104                Vesta
-        Name2105                Vevila
-        Name2106                Victoria
-        Name2107                Vidonia
-        Name2108                Violet
-        Name2109                Violet
-        Name2110                Violetta
-        Name2111                Virginia
-        Name2112                Viridis
-        Name2113                Viveka
-        Name2114                Vivian
-        Name2115                Voleta
-        Name2116                Vrinda
-        Name2117                Wakanda
-        Name2118                Wanda
-        Name2119                Waneta
-        Name2120                Wapeka
-        Name2121                Wendy
-        Name2122                Whilhelmina
-        Name2123                Whitney
-        Name2124                Wijdan
-        Name2125                Willow
-        Name2126                Wilma
-        Name2127                Wilona
-        Name2128                Winda
-        Name2129                Winema
-        Name2130                Winifred
-        Name2131                Winna
-        Name2132                Winona
-        Name2133                Wynee
-        Name2134                Wynn
-        Name2135                Wynona
-        Name2136                Xanthe
-        Name2137                Xaveria
-        Name2138                Xaviera
-        Name2139                Xena
-        Name2140                Xenia
-        Name2141                Ximena
-        Name2142                Xylia
-        Name2143                Xylona
-        Name2144                Yachne
-        Name2145                Yanice
-        Name2146                Yarmilla
-        Name2147                Yasmeen
-        Name2148                Yasmin
-        Name2149                Yelinda
-        Name2150                Yenene
-        Name2151                Yesmina
-        Name2152                Yetta
-        Name2153                Yeva
-        Name2154                Yokiko
-        Name2155                Yoko
-        Name2156                Yolanda
-        Name2157                Yolie
-        Name2158                Yonina
-        Name2159                Yoshi
-        Name2160                Yovela
-        Name2161                Yvella
-        Name2162                Yvette
-        Name2163                Yvonne
-        Name2164                Zada
-        Name2165                Zahara
-        Name2166                Zahirah
-        Name2167                Zahra
-        Name2168                Zakia
-        Name2169                Zalea
-        Name2170                Zalika
-        Name2171                Zaltana
-        Name2172                Zandra
-        Name2173                Zara
-        Name2174                Zarah
-        Name2175                Zaza
-        Name2176                Zehava
-        Name2177                Zelda
-        Name2178                Zelenka
-        Name2179                Zelia
-        Name2180                Zella
-        Name2181                Zena
-        Name2182                Zenaide
-        Name2183                Zenia
-        Name2184                Zenobia
-        Name2185                Zerlinda
-        Name2186                Zeva
-        Name2187                Zevida
-        Name2188                Zia
-        Name2189                Ziazan
-        Name2190                Zigana
-        Name2191                Zila
-        Name2192                Zina
-        Name2193                Zinnia
-        Name2194                Zinnia
-        Name2195                Zita
-        Name2196                Zoe
-        Name2197                Zola
-        Name2198                Zona
-        Name2199                Zora
-        Name2200                Zorah
-        Name2201                Zorda
-        Name2202                Zosia
-        Name2203                Zuleika
-        Name2204                Zulema
-        Name2205                Zuza
-        Name2206                Zuzanny
-}

Deleted: trunk/096/pkg/skills/magery/incognito.src
===================================================================
--- trunk/096/pkg/skills/magery/incognito.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/incognito.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,57 +0,0 @@
-use uo;
-use os;
-use util;
-use cfgfile;
-
-include ":attributes:attributes";
-
-
-program spell_incognito(parms)
-  var caster := parms.caster;
-  if (!GetObjProperty( caster, "realname"))
-    SetObjProperty( caster, "realname", caster.name );
-  endif
-  var newName := AssignName(caster);
-  SetName( caster, newName );
-  PlaySoundEffect(caster, 0x1e1);
-  Detach();
-  set_critical(1);
-  sleep( 60 * CInt(AP_GetSkill(caster, MAGERY)/10 ) );
-  SetName( caster, GetObjProperty( caster, "realname" ) );
-  EraseObjProperty( caster, "realname" );
-endprogram
-
-function AssignName( me )
-  var index := "MALE";
-  if (me.graphic == 401)
-	index := "FEMALE";
-  endif
-  var cfg := ReadConfigFile( "incognito" );
-  if (!cfg)
-	SendSysMessage(me,"Unable to read incognito.cfg");
-	Syslog("Unable to read incognito.cfg");
-	return;
-  endif
-  var elem := FindConfigElem( cfg, index );
-  var number := GetConfigInt( elem, "Count" );
-  var dice_str := "1d" + CStr(number);
-  var choice := RandomDiceRoll( dice_str );
-  var entry := "Name" + choice;
-  var str := GetConfigString( elem, entry );
-  var title := PreserveTitle( me );
-  str := str + title;
-  return( str );
-endfunction
-
-function PreserveTitle( me )
-  var myname := me.name;
-  var start := find( myname, ">", 1 );
-  if( !start )
-    return;
-  endif
-  var title := myname[ start+1, (len( myname ) - 8) ];
-  if( !title )
-    return("");
-  endif
-  return( title );
-endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/invisibility.src
===================================================================
--- trunk/096/pkg/skills/magery/invisibility.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/invisibility.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,20 +0,0 @@
-use uo;
-use os;
-
-include "include/client";
-include "include/sound";
-include ":attributes:attributes";
-
-
-program spell_invisibility(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	PlaySoundEffect(castOn, SFX_SPELL_INVISIBILITY);
-	castOn.hidden := 1;
-	Detach();
-	sleep(CInt(AP_GetSkill(caster, MAGERY)));
-	castOn.hidden := 0;
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/lightning.src
===================================================================
--- trunk/096/pkg/skills/magery/lightning.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/lightning.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,34 +0,0 @@
-use uo;
-use util;
-use os;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":magery:reflect";
-
-
-program spell_lightning( parms )
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-	var dmg := RandomDiceRoll("3d7");
-
-	if (dmg < 1)
-		dmg := 1;
-	endif
-  PlaySoundEffect(castOn, SFX_SPELL_LIGHTNING);
-  PlayLightningBoltEffect( castOn);
-  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "lightning bolt"});
-  if(spell_reflect(castOn))
-	castOn := caster;
-    PlaySoundEffect(castOn, SFX_SPELL_LIGHTNING);
-    PlayLightningBoltEffect( castOn);
-  endif
-  if(castOn.isA(POLCLASS_NPC))
-    dmg := dmg * 2;
-  endif
-  ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
-endprogram

Deleted: trunk/096/pkg/skills/magery/magicArrow.src
===================================================================
--- trunk/096/pkg/skills/magery/magicArrow.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/magicArrow.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,36 +0,0 @@
-use uo;
-use cfgfile;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":magery:reflect";
-include ":attributes:attributes";
-
-
-program spell_magicArrow( parms )
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-
-	PlayMovingEffect( caster, castOn, FX_MAGIC_ARROW, 5, 1 );
-	PlaySoundEffect( caster, SFX_SPELL_MAGIC_ARROW );
-	var dmg := RandomDiceRoll("1d8");
-	if (spell_reflect(castOn))
-		PlayMovingEffect( castOn, caster, FX_MAGIC_ARROW, 5, 1 );
-		PlaySoundEffect( castOn, SFX_SPELL_MAGIC_ARROW );
-		ApplyRawDamage( caster, Resisted(circle,caster,castOn,dmg) );
-	else
-		if (AP_GetVital(castOn, HITS) >= 1)
-			SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "magic arrow" });
-			if (castOn.isA(POLCLASS_NPC))
-				dmg := dmg * 2;
-			endif
-			ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
-		endif
-	endif
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/magicLock.src
===================================================================
--- trunk/096/pkg/skills/magery/magicLock.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/magicLock.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,45 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/client";
-include "include/sound";
-include ":attributes:attributes";
-include "include/findCity";
-include "util/key";
-
-
-program spell_magicLock( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  if((castOn.multi) ||(GetObjProperty(castOn,"houseserial")) ||(GetObjProperty(castOn,"house_serial")))
-    SendSysMessage(caster, "That cannot be magically locked!");
-    return;
-  endif
-  if(castOn.locked)
-    SendSysMessage(caster,"That is already locked!");
-    return;
-  endif
-  if((CheckForDoors(castOn)) && ((FindCity(castOn) != "no city") || (FindCity(caster) != "no city")))
-    SendSysMessage(caster, "That cannot be magically locked!");
-    return;
-  endif
-  if(((castOn.graphic<=0x9ab) &&(castOn.graphic>=0x9a8)) ||((castOn.graphic<=0xe43) &&(castOn.graphic>=0xe3c)) ||((castOn.graphic<=0xe80) &&(castOn.graphic>=0xe7c)) ||(checkfordoors(castOn)))
-    PlaySoundEffect(caster, SFX_SPELL_MAGIC_LOCK);
-    PrintTextAbovePrivate(castOn, "*Locked!*", caster);
-    var magery := CInt(AP_GetSkill(caster, MAGERY) / 4);
-    SetObjProperty(castOn, "MLockPickDiff", magery);
-    castOn.locked := 1;
-  else
-    SendSysMessage(caster, "That cannot be magically locked!");
-  endif
-endprogram
-
-
-function CheckForDoors(castOn)
-	if (((castOn.graphic<=0x1ffc) &&(castOn.graphic>=0x1fed)) ||((castOn.graphic<=0x6f4) &&(castOn.graphic>=0x675)))
-		return 1;
-	endif
-
-	return 0;
-endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/magicTrap.src
===================================================================
--- trunk/096/pkg/skills/magery/magicTrap.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/magicTrap.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,41 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/client";
-include ":attributes:attributes";
-include "include/sound";
-include "include/findCity";
-
-
-program spell_magicTrap(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	if ((castOn.isa(POLCLASS_DOOR)) || (castOn.objtype == 0xe79) || ((castOn.graphic<=0x9ab) &&(castOn.graphic>=0x9a8)) ||((castOn.graphic<=0xe43) &&(castOn.graphic>=0xe3c)) ||((castOn.graphic<=0xe80) &&(castOn.graphic>=0xe7c)))
-		var magery := AP_GetSkill(caster, MAGERY);
-		var trapstr := CInt(magery/5);
-		if (findcity(castOn) != "no city")
-			caster.setCriminal(1);
-		endif
-		if (findcity(caster) != "no city")
-			caster.setCriminal(1);
-		endif
-		if (trapstr < 1)
-			trapstr := 1;
-		endif
-		if (trapstr > 5)
-			trapstr:=5;
-		endif
-		PlaySoundEffect(caster, SFX_SPELL_MAGIC_TRAP);
-		PlayStationaryEffect(castOn.x, castOn.y, castOn.z, 0x376a, 30, 30, 0, caster.realm);
-		SetObjProperty(castOn, "trap_strength", trapstr);
-		SetObjProperty(castOn, "trap_type", 4);
-		SetObjProperty(castOn, "oldscript", castOn.usescript);
-		castOn.usescript := ":tinkering:tinkerTraps";
-	else
-		SendSysMessage(caster, "That cannot be magically trapped!");
-	endif
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/magicUntrap.src
===================================================================
--- trunk/096/pkg/skills/magery/magicUntrap.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/magicUntrap.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,27 +0,0 @@
-// $Id$
-
-use os;
-use uo;
-use util;
-
-include "include/client";
-include "include/sound";
-include ":attributes:attributes";
-
-program spell_magicUntrap(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	if (GetObjProperty(castOn, "trap_strength") > 25)
-		SendSysMessage(caster, "You couldn't disarm the trap.");
-	else
-		var oldscript := GetObjProperty(castOn, "oldscript");
-		PlaySoundEffect(caster, SFX_SPELL_MAGIC_UNTRAP);
-		PlayStationaryEffect(castOn.x, castOn.y, castOn.z, 0x376a, 30, 30,0 , caster.realm);
-		EraseObjProperty(castOn, "trap_type");
-		EraseObjProperty(castOn, "trap_strength");
-		castOn.usescript := oldscript;
-	endif
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/magiccircles.cfg
===================================================================
--- trunk/096/pkg/skills/magery/magiccircles.cfg	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/magiccircles.cfg	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,87 +0,0 @@
-Circle 1
-{
-    Mana        4
-    Difficulty  20
-    PointValue  20
-    animReps	1
-    extraWait	500
-}
-
-Circle 2
-{
-    Mana        6
-    Difficulty  30
-    PointValue  40
-    animReps	2 
-    extraWait	0
-}
-
-Circle 3
-{
-    Mana        9
-    Difficulty  40
-    PointValue  80
-    animReps	2
-    extraWait	250
-}
-
-Circle 4
-{
-    Mana        11
-    Difficulty  50
-    PointValue  100
-    animReps	2
-    extraWait	500
-}
-
-Circle 5
-{
-    Mana        14
-    Difficulty  60
-    PointValue  120
-    animReps	3
-    extraWait	0
-}
-
-Circle 6
-{
-    Mana        20
-    Difficulty  70
-    PointValue  140
-    animReps	3
-    extraWait	250
-}
-
-Circle 7
-{
-    Mana        40
-    Difficulty  80
-    PointValue  160
-    animReps	3
-    extraWait	500
-}
-
-Circle 8
-{
-    Mana        50
-    Difficulty  90
-    PointValue  180
-    animReps	4
-    extraWait	0
-}
-
-Circle 9
-{
-    Mana        75
-    Difficulty  100
-    PointValue  300
-    Delay       5000
-}
-
-Circle 10
-{
-    Mana        100
-    Difficulty  100
-    PointValue  300
-    Delay       7000
-}

Deleted: trunk/096/pkg/skills/magery/manaDrain.src
===================================================================
--- trunk/096/pkg/skills/magery/manaDrain.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/manaDrain.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,37 +0,0 @@
-use uo;
-use util;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-
-
-program spell_manaDrain(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-
-	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "mana drain" });
-	if (spell_reflect(castOn))
-		var tmp := castOn;
-		castOn := caster;
-		caster := tmp;
-	endif
-	var dmg := Cint(GetAttribute(caster, "magery") / 2);
-	var diff := Resisted(circle, caster, castOn, dmg);
-	if (diff)
-		PlaySoundEffect( caster, SFX_SPELL_MANA_DRAIN );
-		PlayObjectCenteredEffect( castOn, FX_HEAL_EFFECT, 7,0x10 );
-		if (diff > AP_GetVital(castOn, MANA))
-			AP_SetVital(castOn, MANA, 0);
-		else
-			AP_SetVital(castOn, MANA, AP_GetVital(castOn, MANA) - diff);
-		endif
-	endif
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/manaVamp.src
===================================================================
--- trunk/096/pkg/skills/magery/manaVamp.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/manaVamp.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,44 +0,0 @@
-use uo;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":magery:reflect";
-include ":attributes:attributes";
-
-
-program spell_manaVamp(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "mana vampire"});
-  if(spell_reflect(castOn))
-    castOn := caster;
-  endif
-  if(!castOn.isA(POLCLASS_MOBILE))
-    return;
-  endif
-  var dmg := Cint(GetAttribute(caster, "magery") / 3);
-  var diff := Resisted(circle, caster, castOn, dmg);
-  if(diff)
-    PlaySoundEffect(caster, SFX_SPELL_MANA_VAMPIRE);
-    PlayObjectCenteredEffect(castOn, FX_GLOW, 7,0x10);
-    var gain := 0;
-	if(diff > AP_GetVital(castOn, MANA))
-	  gain := AP_GetVital(castOn, MANA);
-	  AP_SetVital(castOn, MANA, 0);
-	else
-	  gain := diff;
-	  AP_SetVital(castOn, MANA, AP_GetVital(castOn, MANA) - diff);
-	endif
-	AP_SetVital(caster, MANA, AP_GetVital(caster, MANA) + gain);
-	if(AP_GetVital(caster, MANA) > AP_GetVitalMaximumValue(caster, MANA))
-	  AP_SetVital(caster, MANA, AP_GetVitalMaximumValue(caster, MANA));
-	endif
-  endif
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/mark.src
===================================================================
--- trunk/096/pkg/skills/magery/mark.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/mark.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,46 +0,0 @@
-use uo;
-use util;
-
-include "include/objtype";
-include "include/sound";
-include "include/tileEffects";
-
-
-program mark(parms)
-  var caster := parms.caster;
-  var castOn := Target(caster);
-  if (castOn.objtype != UOBJ_RUNE)
-    SendSysMessage(caster, "You can only cast that on a recall rune!");
-	return;
-  endif
-  if(caster.multi)
-    SendSysMessage(caster,"You cannot mark runes here.");
-    PlaySoundEffect(caster,0x005d);
-    PlayObjectCenteredEffect(caster, 0x3735,0x0a, 0x1e);
-    return;
-  endif
-  if(((caster.x >= 5120) && (caster.x <= 5375) && (caster.y >= 0) && (caster.y <= 255)) or (caster.multi))
-    SendSysMessage(caster, "You cannot mark runes here.");
-    return;
-  endif
-  if (!Accessible(caster, castOn))
-	SendSysMessage(caster, "You can't reach that!");
-  endif
-  if (castOn.objtype != UOBJ_RUNE)
-	SendSysMessage(caster, "You can only cast that on a recall rune!");
-	return;
-  endif
-  if(!ReserveItem(castOn))
-    SendSysMessage(caster,"Your spell fizzles.");
-    return;
-  endif
-  PlayObjectCenteredEffect(caster, FX_MARK_EFFECT, 10, 10);
-  PlaySoundEffect(caster, SFX_SPELL_MARK);
-  SetObjProperty(castOn, "x", caster.x);
-  SetObjProperty(castOn, "y", caster.y);
-  SetObjProperty(castOn, "z", caster.z);
-  SetObjProperty(castOn, "realm", caster.realm);
-  SetName(castOn, "a marked recall rune");
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/massCurse.src
===================================================================
--- trunk/096/pkg/skills/magery/massCurse.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/massCurse.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,47 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/statMod";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include "include/spellAttack";
-include ":magery:reflect";
-include "include/magic";
-
-program massCurse( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  PlaySoundEffect(caster, SFX_SPELL_MASS_CURSE);
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := GetModAmount( magery );
-  var duration := GetModDuration( magery );
-  Detach();
-  foreach castOn in ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, 4, caster.realm );
-	SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "mass curse"});
-    if(spell_reflect(castOn))
-	  castOn := caster;
-    endif
-    PlaySoundEffect(castOn, SFX_SPELL_MASS_CURSE);
-    PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 10,10);
-	send_attack(castOn,caster, 46);
-    if(castOn.criminal == 0)
-      caster.setCriminal(1);
-    endif
-    modAmount := Resisted(circle,caster,castOn, GetModAmount( magery ));
-	if (CanMod(castOn, "str"))
-	  DoTempMod(castOn, "str", 0- modAmount, duration);
-	endif
-	if (CanMod(castOn, "dex"))
-	  DoTempMod(castOn, "dex", 0- modAmount, duration);
-	endif
-	if (CanMod(castOn, "int"))
-	  DoTempMod(castOn, "int", 0- modAmount, duration);
-	endif
-  endforeach
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/massDispel.src
===================================================================
--- trunk/096/pkg/skills/magery/massDispel.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/massDispel.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,64 +0,0 @@
-use uo;
-
-include "include/eventID";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-include "include/spellAttack";
-include "include/magic";
-
-
-program spell_massDispel(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  var npccfg := ReadConfigFile("::npcdesc");
-  var magery := AP_GetSkill(caster, MAGERY);
-  var range := CInt(magery / 20);
-  var targets := ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, range, caster.realm );
-  PlaySoundEffect( caster, 0x202 );
-  foreach mobile in targets
-	SetObjProperty(mobile, "LastHit", {caster.name, caster.serial, "mass dispel"});
-    if(spell_reflect(mobile))
-	  mobile := caster;
-    endif
-    var summoned := GetObjProperty( mobile, "summoned");
-	if (summoned == 1)
-      PlaySoundEffect(caster, 0x202 );
-      PlayStationaryEffect( mobile.x, mobile.y, mobile.z, FX_HEAL_EFFECT, 0xa, 0xa,0 , caster.realm );
-      var master := SystemFindObjectBySerial(CInt(GetObjProperty(mobile, "master")));
-      if(master)
-        var resist := AP_GetSkill(master, RESISTING_SPELLS);
-        if((RandomInt(99) + 1) < resist)
-          MoveCharacterToLocation(mobile,0,0,0,MOVECHAR_FORCELOCATION);
-          ApplyRawDamage(mobile, AP_GetVitalMaximumValue(mobile, HITS) + 3);
-        endif
-        send_attack(caster, mobile, 41);
-    endif
-    else
-      if(mobile.isA(POLCLASS_NPC))
-        var element := npccfg[mobile.npctemplate].elemental;
-        if(element == "undead")
-          PlayStationaryEffect( mobile.x, mobile.y, mobile.z, FX_HEAL_EFFECT, 0xa, 0xa,0, caster.realm );
-          var ev := array;
-          ev.+ type;
-          ev.+ source;
-          ev.type := EVID_PEACEMADE;
-          SendEvent(mobile, ev);
-          ev.source := caster;
-          SendEvent(mobile, ev);
-          ev.type := EVID_ENGAGED;
-          SendEvent(mobile, ev);
-	      PlaySoundEffect( caster, 0x202 );
-          PlayObjectCenteredEffect(mobile, 0x37b9,0x03, 0x0a);
-          var dmg := CalcSpellDamage(circle,caster) + (RandomInt(20));
-          ApplyRawDamage(mobile, Resisted(circle,caster,mobile,dmg));
-        endif
-      endif
-    endif
-  endforeach
-endprogram

Deleted: trunk/096/pkg/skills/magery/meteorSwarm.src
===================================================================
--- trunk/096/pkg/skills/magery/meteorSwarm.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/meteorSwarm.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,41 +0,0 @@
-use cfgfile;
-use uo;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-include "include/spellAttack";
-
-
-program spell_meteorSwarm( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  Detach();
-  var dmg;
-  var victims := ListMobilesNearLocationEx( castOn.x, castOn.y, castOn.z, 3, 0x03, caster.realm);
-  foreach mobile in victims
-	PlaySoundEffect( mobile, SFX_SPELL_FIREBALL );
-	PlayMovingEffect( caster, mobile, FX_FIREBALL, 5, 1 );
-	SetObjProperty(mobile, "LastHit", {caster.name, caster.serial, "meteor swarm"});
-    if(spell_reflect(mobile))
-	  mobile := caster;
-	  PlaySoundEffect( mobile, SFX_SPELL_FIREBALL );
-	  PlayMovingEffect( caster, mobile, FX_FIREBALL, 5, 1 );
-    endif
-	dmg := RandomDiceRoll("6d8");
-	send_attack(mobile,caster, 55);
-    if(AP_GetVital(mobile, HITS) > 1)
-      if(castOn.npctemplate)
-        dmg := dmg * 2;
-      endif
-      ApplyRawDamage(mobile, Resisted(circle,caster,mobile,dmg));
-    endif
-	sleep(1);
-  endforeach
-endprogram

Deleted: trunk/096/pkg/skills/magery/mindBlast.src
===================================================================
--- trunk/096/pkg/skills/magery/mindBlast.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/mindBlast.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,42 +0,0 @@
-use os;
-use uo;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":magery:reflect";
-include ":attributes:attributes";
-
-
-program spell_mindBlast( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  var myInt := CInt(AP_GetStat(caster, INTELLIGENCE));
-  var hisInt := CInt(AP_GetStat(castOn, INTELLIGENCE));
-  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "mind blast" });
-  var modif := myInt - hisInt;
-  if(hisInt > myInt)
-    modif := hisInt - myInt;
-	castOn := caster;
-  elseif(hisInt == myInt)
-	return;
-  endif
-  if(modif > 20)
-    modif:= 20;
-  endif
-  if(spell_reflect(castOn))
-	castOn := caster;
-  endif
-  PlaySoundEffect(castOn, SFX_SPELL_MIND_BLAST);
-  PlayObjectCenteredEffect(castOn, FX_CURSE_EFFECT, 7,0x10);
-  var dmg := RandomDiceRoll("3d7");
-  var diff := Resisted(circle, caster, castOn, dmg);
-  if(castOn.isA(POLCLASS_NPC))
-    diff := diff * 2;
-  endif
-  ApplyRawDamage(castOn, diff);
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/nightSight.src
===================================================================
--- trunk/096/pkg/skills/magery/nightSight.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/nightSight.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,24 +0,0 @@
-use uo;
-use util;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-
-
-program nightSight(parms, spellid)
-
-	spellid := spellid;
-
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	PlaySoundEffect(castOn, SFX_SPELL_NIGHT_SIGHT );
-	var magery := AP_GetSkill(caster, MAGERY);
-	castOn.setlightlevel(0, magery * 60);
-	PlayObjectCenteredEffect(castOn, FX_BLESS_EFFECT, 10,10);
-
-	return;
-
-endprogram

Deleted: trunk/096/pkg/skills/magery/pField.src
===================================================================
--- trunk/096/pkg/skills/magery/pField.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/pField.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,24 +0,0 @@
-use uo;
-use os;
-
-include "include/sound";
-include "include/tileEffects";
-include "include/objtype";
-
-
-program spell_pField(parms)
-	var castOn := parms.castOn;
-	var boss := parms.caster;
-	SetScriptController(boss);
-	SetObjProperty(castOn,"#pfield", 1);
-	PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_CURSE_EFFECT, 10, 0xa, 0, castOn.realm );
-	PlaySoundEffect( castOn, SFX_SPELL_PARALYZE );
-	Detach();
-	castOn.paralyzed := 1;
-	sleep(15);
-	castOn.paralyzed := 0;
-	sleepms(500);
-	EraseObjProperty(castOn,"#pfield");
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/paraField.src
===================================================================
--- trunk/096/pkg/skills/magery/paraField.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/paraField.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,38 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/fields";
-include "include/objtype";
-include "include/sound";
-include ":attributes:attributes";
-
-
-program spell_paraField(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var fields := {};
-	var x := castOn.x;
-	var y := castOn.y;
-	var z := castOn.z;
-	case (get_direction(caster))
-		"NS" : fields:= CreateNorthSouthField(caster, UOBJ_PARAFIELD_NS, x, y, z, 5);
-		"EW" : fields:= CreateEastWestField(caster, UOBJ_PARAFIELD_EW, x, y, z, 5);
-	endcase
-	Detach();
-	var duration := CInt(AP_GetSkill(caster, MAGERY) )/2;
-	if (duration < 20)
-		duration := 20;
-	endif
-	var i;
-	for (i := 1; i <= 5; i := i + 1)
-		SetObjProperty(fields[i], "f", 1);
-		PlaySoundEffect(fields[i], SFX_20C);
-		sleep(duration/4);
-	endfor
-	foreach fieldpart in fields
-		DestroyItem(fieldpart);
-	endforeach
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/paralyze.src
===================================================================
--- trunk/096/pkg/skills/magery/paralyze.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/paralyze.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,68 +0,0 @@
-use uo;
-use os;
-
-include ":magery:reflect";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include "include/statMod";
-include "include/magic";
-
-
-program spell_paralyze( parms )
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "paralyze" });
-	if (spell_reflect(castOn))
-		castOn := caster;
-	endif
-	var amt := 10 + RandomInt(CInt(AP_GetSkill(caster, MAGERY)/5));
-	var duration := ParaResist(2, caster, castOn, amt);
-	PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_CURSE_EFFECT, 10, 0xa, 0, caster.realm );
-	PlaySoundEffect( castOn, SFX_SPELL_PARALYZE );
-	DoTempMod(castOn, "p", 1, duration);
-
-	return;
-endprogram
-
-
-function ParaResist(circle, caster, castOn, amt)
-  var magery := CInt(AP_GetSkill(caster, MAGERY));
-  var evalint := CInt(AP_GetSkill(caster, EVALUATING_INTELLIGENCE));
-  var resist := CInt(AP_GetSkill(castOn, RESISTING_SPELLS));
-  var chk1 := (resist / 5);
-  var chk2 := resist - (((magery - 20) / 5) + (circle * 5));
-  if(chk1 < 1)
-    chk1 := 1;
-  endif
-  if(chk2 < 1)
-    chk2 := 1;
-  endif
-  var diff := 0;
-  if(chk1 > chk2)
-    diff := chk1;
-  else
-    diff := chk2;
-  endif
-  //var points := getresistpoints(circle, castOn, RESISTING_SPELLS);
-  if(castOn.dead)
-    return 0;
-  endif
-  if((RandomInt(99) + 1) <= diff)
-	SendSysMessage(castOn, "You feel yourself resisting magical energy!");
-	PlaySoundEffect(castOn, SFX_SPELL_WEAKEN);
-	PlayObjectCenteredEffect(castOn, FX_CURSE_EFFECT, 5,5);
-	//AwardRawSkillPoints(castOn, RESISTING_SPELLS, points);
-	amt := 0;
-	return amt;
-  endif
-  var modamt := 1;
-  if(resist > evalint)
-    modamt := (1 + ((evalint - resist) / 200.0));
-  elseif(evalint > resist)
-    modamt := (1 + ((evalint - resist) / 500.0));
-  endif
-  amt := (amt * modamt);
-  return CInt(amt);
-endfunction

Deleted: trunk/096/pkg/skills/magery/pkg.cfg
===================================================================
--- trunk/096/pkg/skills/magery/pkg.cfg	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/pkg.cfg	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,8 +0,0 @@
-# $Id$
-#
-#
-Enabled         1
-Name		magery
-maintainer      Distro Team
-email           distro at polserver.com
-Version         1.0

Deleted: trunk/096/pkg/skills/magery/poison.src
===================================================================
--- trunk/096/pkg/skills/magery/poison.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/poison.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,97 +0,0 @@
-use os;
-use uo;
-use cfgfile;
-
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-include ":timedscripts:timedScripts";
-
-const EVID_DISCHARGE := 0x123457;
-
-
-program poison(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var npccfg := ReadConfigFile("::npcdesc");
-  if(spell_reflect(castOn))
-    castOn := caster;
-  endif
-  if((!castOn.isA(POLCLASS_MOBILE)) || (castOn.dead))
-    SendSysMessage(caster, "You cannot poison that.");
-    return;
-  endif
-  PlaySoundEffect(castOn, 0x206);
-  PlayObjectCenteredEffect(castOn, FX_CURSE_EFFECT, 0x0a,0x1e);
-  var pLevel :=  0;
-  var skil := AP_GetSkill(caster, MAGERY);
-  if(skil <= 50)
-    pLevel := 1;
-  elseif(skil <= 90)
-    pLevel := 2;
-  elseif(skil <= 98)
-    pLevel := 3;
-  else
-    pLevel := 4;
-  endif
-  pLevel := pLevel - RandomInt(2);
-  if(pLevel < 1)
-    pLevel := 1;
-  endif
-  var passparms, newamt;
-  if(castOn.isA(POLCLASS_NPC))
-    var element := npccfg[castOn.npctemplate].elemental;
-    if(element == "poison")
-      HealDamage(castOn, (pLevel * 50));
-    else
-      newamt := PoisonResist(caster, castOn, pLevel);
-      if(newamt > 0)
-        SendSysMessage(castOn, "You have been poisoned by " + caster.name +"!");
-        Detach();
-        passparms := {castOn, caster, "poison spell", newamt};
-        start_script(":magery:poisonDamage", passparms);
-        SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "poison spell" });
-      else
-        SendSysMessage(caster, "Your target resists the spell completely.");
-      endif
-    endif
-  else
-    newamt := poisonresist(caster, castOn, pLevel);
-    if(newamt > 0)
-      SendSysMessage(castOn, "You have been poisoned by " + caster.name +"!");
-      Detach();
-      TS_StartTimer(castOn, "defaultPoison", 20, pLevel);
-      //passparms := {castOn, caster, "poison spell", newamt};
-      //start_script(":magery:poisonDamage", passparms);
-      SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "poison spell" });
-    else
-      SendSysMessage(castOn, "You resist the spell completely.");
-      if(caster != castOn)
-        SendSysMessage(caster, "Your target resists the spell completely.");
-      endif
-    endif
-  endif
-endprogram
-
-function PoisonResist(caster, castOn, amt)
-  var diff := Cint(AP_GetSkill(caster, MAGERY) + Cint(AP_GetSkill(caster, EVALUATING_INTELLIGENCE) / 10));
-  if( SkillCheck(castOn, RESISTING_SPELLS, diff) > 0 )
-    SendSysMessage(castOn, "You feel yourself resisting magical energy!");
-    PlaySoundEffect(castOn, SFX_SPELL_WEAKEN);
-    PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 5,5);
-    if(amt == 5)
-      amt := 3;
-    elseif(amt == 4)
-      return 2;
-    elseif(amt == 3)
-      return 2;
-    elseif(amt == 2)
-      return 1;
-    elseif(amt == 1)
-      return 0;
-    endif
-  else
-    return amt;
-  endif
-endfunction

Deleted: trunk/096/pkg/skills/magery/poisonField.src
===================================================================
--- trunk/096/pkg/skills/magery/poisonField.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/poisonField.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,27 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/fields";
-include ":attributes:attributes";
-include "include/objtype";
-
-
-program spell_poisonField( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var fields := {};
-  var x := castOn.x;
-  var y := castOn.y;
-  var z := castOn.z;
-  case(get_direction(caster))
-	"NS" : fields:= CreateNorthSouthField(caster, UOBJ_POISONFIELD_NS, x, y, z, 5);
-	"EW" : fields:= CreateEastWestField(caster, UOBJ_POISONFIELD_EW, x, y, z, 5);
-  endcase
-  Detach();
-  var duration := 20 + ( CInt(AP_GetSkill(caster, MAGERY) ) / 3 );
-  sleep(duration);
-  foreach fieldpart in fields
-    DestroyItem(fieldpart);
-  endforeach
-endprogram

Deleted: trunk/096/pkg/skills/magery/polymorph.src
===================================================================
--- trunk/096/pkg/skills/magery/polymorph.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/polymorph.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,83 +0,0 @@
-use util;
-
-include ":attributes:attributes";
-
-
-program spell_polymorph( parms )
-  var caster := parms.caster;
-  var magery     := CInt(AP_GetSkill(caster, MAGERY));
-  var meditation := CInt(AP_GetSkill(caster, MEDITATION));
-  var evalint    := CInt(AP_GetSkill(caster, EVALUATING_INTELLIGENCE));
-  var critgroup;
-  var thecreature;
-  if (magery < 70)
-	critgroup := RandomInt(1);
-  elseif (magery < 80)
-	critgroup := RandomInt(1)+1;
-  elseif (magery < 90)
-	critgroup := RandomInt(1)+2;
-  else
-	critgroup := 3;
-  endif
-  var critter := RandomInt(8);
-  case (critgroup)
-	0:
-	  case (critter)
-		0: thecreature := 6;	//bird
-		1: thecreature := 51;	//slime
-		2: thecreature := 5;	//eagle
-		3: thecreature := 39;	//mongbat
-		4: thecreature := 31;	//headless
-		5: thecreature := 29;	//gorilla
-		6: thecreature := 42;	//ratman
-		7: thecreature := 28;	//giant spider
-	  endcase
-	1:
-	  case (critter)
-		0: thecreature := 48;	//scorpion
-		1: thecreature := 7;	//orc
-		2: thecreature := 3;	//zombie
-		3: thecreature := 17;	//orc
-		4: thecreature := 33;	//lizardman
-		5: thecreature := 26;	//shade
-		6: thecreature := 21;	//giant serp
-		7: thecreature := 30;	//harpy
-	  endcase
-	2:
-	  case (critter)
-	    0: thecreature := 18;	//ettin
-		1: thecreature := 8;	//corpser
-		2: thecreature := 22;	//beholder
-		3: thecreature := 14;	//earth elem
-		4: thecreature := 16;	//water elem
-		5: thecreature := 15;	//fire elem
-		6: thecreature := 13;	//air elem
-		7: thecreature := 47;	//ent
-	  endcase
-	3:
-	  case (critter)
-		0: thecreature := 1;	//ogre
-		1: thecreature := 4;	//gargoyle
-		2: thecreature := 24;	//lich
-		3: thecreature := 150;	//seaserp
-		4: thecreature := 9;	//demon
-		5: thecreature := 12;	//dragon
-		6: thecreature := 10;	//demon with sword
-		7: thecreature := 58;	//wisp
-	  endcase
-  endcase
-  caster.graphic := thecreature;
-  if ( thecreature == 150 )
-	caster.color := 233;
-  else
-	caster.color := 0;
-  endif
-  var magerydur := magery/2;
-  var meditadur := magerydur + meditation/10;
-  var duration  := meditadur + evalint/10;
-  Detach();
-  sleep(duration);
-  caster.graphic := caster.objtype;
-  caster.color := caster.truecolor;
-  EraseObjProperty(caster,"poly");
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/protection.src
===================================================================
--- trunk/096/pkg/skills/magery/protection.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/protection.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,33 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-include "include/statMod";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-
-program spell_protection(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  PlaySoundEffect(castOn, SFX_SPELL_PROTECTION);
-  PlayObjectCenteredEffect(castOn, FX_BLESS_EFFECT, 7,7);
-  if (!CanMod(castOn, "ar"))
-	SendSysMessage(caster,"Already under the influence!");
-	return;
-  endif
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := (GetModAmount(magery) * 2);
-  var duration := GetModDuration(magery);
-  var itmcfg := ReadConfigFile(":*:itemdesc");
-  var arpoints := 0;
-  foreach thing in ListEquippedItems(castOn)
-    arpoints := arpoints + (CInt(itmcfg[thing.objtype].AR) / 12);
-  endforeach
-  if(modAmount > arpoints)
-    modAmount := modAmount - arpoints;
-  else
-    modAmount := 0;
-  endif
-  DoTempMod(castOn, "ar", modAmount, duration);
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/reactiveArmor.src
===================================================================
--- trunk/096/pkg/skills/magery/reactiveArmor.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/reactiveArmor.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,30 +0,0 @@
-use uo;
-use os;
-
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-
-
-program spell_reactiveArmor( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  PlaySoundEffect(castOn, SFX_SPELL_REACTIVE_ARMOR);
-  PlayObjectCenteredEffect( castOn, FX_SPARK_EFFECT, 7, 0x10 );
-  if(GetObjProperty(castOn, "ar"))
-	SendSysMessage(caster,"Already under the influence!");
-	return;
-  endif
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := magery / 10;
-  var duration := CInt(RandomInt(10) + (magery / 2));
-  SetObjProperty(castOn, "ReactiveArmor", modAmount);
-  Detach();
-  sleep(duration);
-  if(GetObjProperty(castOn, "ReactiveArmor"))
-    PlaySoundEffect(castOn, 0x1eb);
-    EraseObjProperty(castOn,"ReactiveArmor");
-  endif
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/recall.src
===================================================================
--- trunk/096/pkg/skills/magery/recall.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/recall.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,108 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-include "include/client";
-include "include/objtype";
-include "include/isValidLoc";
-
-
-program spell_recall(parms)
-  var caster := parms.caster;
-  var failure := 0;  
-  var castOn := Target(caster);
-  if((castOn.objtype != UOBJ_RUNE) && (castOn.objtype != 0x6100))
-    SendSysMessage(caster, "You can only cast that on a recall rune.");
-	return;
-  endif
-  if(!ReserveItem(castOn))
-    return;
-  endif
-  if(GetObjProperty(castOn, "Vendored"))
-    SendSysMessage(caster, "You cannot recall off of runes on a vendor.");
-    return;
-  endif
-  var tox := CInt(GetObjProperty( castOn, "x" ));
-  var toy := CInt(GetObjProperty( castOn, "y" ));
-  var toz := CInt(GetObjProperty( castOn, "z" ));
-  var torealm := GetObjProperty( castOn, "realm" );
-  if(!tox)
-    SendSysMessage(caster, "The rune must be marked.");
-    return;
-  endif
-  if(!torealm)
-  	torealm := "britannia";
-  endif
-  
-  if(!isValidLoc(tox,toy,torealm))
-    SendSysMessage(caster, "Invalid recall location.");
-    DestroyItem(castOn);
-    return;
-  endif
-  PlaySoundEffect(caster, 0x210);
-  Detach();
-  var chk := 0;
-  if((caster.x >= 5120) && (caster.x <= 5375) && (caster.y >= 0) && (caster.y <= 255))
-    SendSysMessage(caster, "Your spell fails and consumes the rune!");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    elseif(castOn.objtype == 0x6100)
-      removeentry(castOn);
-    endif
-    chk := 1;
-  endif
-  var multicheck := CreateItemAtLocation(1, 1, 0, 0xeed, 1, torealm);
-  multicheck.hidden := 1;
-  if(!MoveItemToLocation(multicheck, tox, toy, toz, MOVEITEM_NORMAL))
-    SendSysMessage(caster, "Something is blocking the location.");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    elseif(castOn.objtype == 0x6100)
-      removeentry(castOn);
-    endif
-    chk := 1;
-  endif
-  if(multicheck.multi)
-    SendSysMessage(caster,"Something is blocking the location.");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    elseif(castOn.objtype == 0x6100)
-      removeentry(castOn);
-    endif
-    chk := 1;
-  endif
-  DestroyItem(multicheck);
-  if(chk == 1)
-    return;
-  endif
-  if (failure == 0);
-  	if(torealm != caster.realm)
-  		MoveObjectToRealm(caster,torealm,1,1,0,MOVECHAR_FORCELOCATION);
-  	endif
-	MoveCharacterToLocation( caster, tox, toy, toz );
-  elseif (failure == 2)
-    SendSysMessage(caster, "Your spell fails and consumes the rune!");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    endif
-  endif
-  PlaySoundEffect(caster, 0x1fd);
-endprogram
-
-function removeentry(castOn)
-  var tox := CInt(GetObjProperty( castOn, "x" ));
-  var toy := CInt(GetObjProperty( castOn, "y" ));
-  var toz := CInt(GetObjProperty( castOn, "z" ));
-  var defs := GetObjProperty(castOn, "runedefs");
-  var holder := {};
-  foreach thing in defs
-    if((Cint(thing[2]) != tox) or (Cint(thing[3]) != toy) or (Cint(thing[4]) != toz))
-      holder.append(thing);
-    endif
-  endforeach
-  SetObjProperty(castOn, "runedefs", holder);
-  EraseObjProperty(castOn, "x");
-  EraseObjProperty(castOn, "y");
-  EraseObjProperty(castOn, "z");
-  return;
-endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/reflect.inc
===================================================================
--- trunk/096/pkg/skills/magery/reflect.inc	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/reflect.inc	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,41 +0,0 @@
-use uo;
-use os;
-
-include "include/eventID";
-include "include/sound";
-include "include/tileEffects";
-
-
-function spell_reflect(cast_on)
-	var mr := CInt(GetObjProperty(cast_on, "mr"));
-	if (mr >= 1)
-		PlaySoundEffect(cast_on, SFX_SPELL_MAGIC_REFLECTION);
-		PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 10,10);
-		SendSysMessage(cast_on, "Your magic reflect spell saved you!");
-		if (mr == 1)
-			EraseObjProperty(cast_on, "mr");
-		elseif (mr == 2)
-			var holder, pid;
-			var eqp := GetObjProperty(cast_on, "EquipTimers");
-			foreach thing in ListEquippedItems(cast_on)
-				foreach entry in eqp
-					if ((thing.serial == entry[1]) and (entry[2] == "ref"))
-						holder := GetObjProperty(thing, "pid");
-						break;
-					endif
-				endforeach
-			endforeach
-			pid := getprocess(holder);
-			if (pid)
-				var k := struct;
-				k.+type := EVID_DISCHARGE;
-				pid.sendevent(k);
-			else
-				EraseObjProperty(cast_on, "mr");
-			endif
-		endif
-		return 1;
-	endif
-
-	return 0;
-endfunction

Deleted: trunk/096/pkg/skills/magery/reflect.src
===================================================================
--- trunk/096/pkg/skills/magery/reflect.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/reflect.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,21 +0,0 @@
-use uo;
-use os;
-
-include "include/tileEffects";
-
-
-program spell_reflect( parms )
-	var caster := parms.caster;
-
-	if (!(GetObjProperty(caster, "mr") == "1") )
-		PlaySoundEffect(caster, 0x1ea);
-		PlayObjectCenteredEffect(caster, FX_SPARK_EFFECT, 10,10);
-		SetObjProperty(caster, "mr","1");
-	else
-		PlaySoundEffect(caster,0x005d);
-		PlayObjectCenteredEffect(caster, 0x3735,0x0a, 0x1e);
-		SendSysMessage(caster,"You are already protected.");
-	endif
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/resurrect.src
===================================================================
--- trunk/096/pkg/skills/magery/resurrect.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/resurrect.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,63 +0,0 @@
-use os;
-use uo;
-
-include "include/eventID";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include "include/client";
-include "include/resurrection";
-include "include/magic";
-
-
-program spell_resurrect(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var npccfg := ReadConfigFile("::npcdesc");
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-  if(Distance(caster, castOn) > 1)
-	SendSysMessage(caster,"That is too far away!");
-	return;
-  endif
-  PlaySoundEffect(caster, SFX_SPELL_RESSURECTION);
-  PlaySoundEffect(castOn, SFX_SPELL_RESSURECTION);
-  if(castOn.isA(POLCLASS_NPC))
-    var element := npccfg[castOn.npctemplate].elemental;
-    if(element == "undead")
-      PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_HEAL_EFFECT, 0xa, 0xa,0, caster.realm );
-      var ev := array;
-      ev.+ type;
-      ev.+ source;
-      ev.type := EVID_PEACEMADE;
-      SendEvent(castOn, ev);
-      ev.source := caster;
-      SendEvent(castOn, ev);
-      ev.type := EVID_ENGAGED;
-      SendEvent(castOn, ev);
-      PlayObjectCenteredEffect(castOn, 0x37b9,0x03, 0x0a);
-      if( SkillCheck(castOn, RESISTING_SPELLS, 70) > 0 )
-        var dmg := CalcSpellDamage(circle,caster) + (RandomInt(20));
-        ApplyRawDamage(castOn, dmg);
-      else
-        ApplyRawDamage(castOn, AP_GetVital(castOn, HITS) +1);
-      endif
-    endif
-  else
-    if (!castOn.dead)
-	  SendSysMessage(caster,"That isn't dead!");
-	  return;
-    endif
-    if(castOn.criminal)
-      caster.setCriminal(1);
-    endif
-    detach();
-    if(ResNow(castOn)==1)
-      Resurrect(castOn);
-      MurdererStatLoss(caston);
-    endif
-  endif
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/reveal.src
===================================================================
--- trunk/096/pkg/skills/magery/reveal.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/reveal.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,43 +0,0 @@
-use uo;
-
-include ":attributes:attributes";
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-
-
-program reveal(parms)
-  var caster := parms.caster;
-  var range := ( AP_GetSkill( caster, MAGERY  )/10 ) - 5;
-  if (range < 1)
-	range := 1;
-  endif
-  var hiders := ListMobilesNearLocationEx( caster.x, caster.y, caster.z, range, LISTEX_FLAG_HIDDEN, caster.realm );
-  var numfound := 0;
-  PlaySoundEffect(caster, SFX_1FE);
-  if(len(hiders) > 0)
-	foreach mobile in hiders
-	  if( Found( caster,  mobile) )
-		numfound := 1;
-		mobile.hidden := 0;
-		PrintTextAbovePrivate( mobile, "You have been revealed!", mobile );
-		PrintTextAbovePrivate( mobile, "You have found someone!", caster );
-		PlaySoundEffect(mobile, SFX_1FE);
-	  endif
-	endforeach
-  endif
-  if (!numfound)
-    PrintTextAbovePrivate( caster, "You didn't find any anyone.", caster );
-  endif
-endprogram
-
-
-function Found(finder, hider)
-  var magic_skill := Resisted(6, finder, hider, AP_GetSkill( finder, MAGERY ));
-  var resist := (AP_GetSkill( finder,RESISTING_SPELLS)/1.5);
-  if ( magic_skill > resist )
-	return 1;
-  else
-	return 0;
-  endif
-endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/spells.cfg
===================================================================
--- trunk/096/pkg/skills/magery/spells.cfg	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/spells.cfg	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,1005 +0,0 @@
-# $Id$
-#
-#
-##############
-#
-# SpellID : same as the config key val- the ID of the spell
-# Name : the spells's name
-# SpellScript : the spell's SpellScript
-# Circle : the circle of the spell
-# Delivery : the mode of delivering the spell.
-#   direct : target something
-#   indirect : target an area
-#   notarget : no target necessary
-# Noto : casting a harmful spell on a blue will flag you criminal;
-#   casting a beneficial spell on a red will do the same.
-# PowerWords : the words of power for the spell
-# Animation : define a different spellcasting animation
-# animReps : caster will perform the spellcasting animation this many times,
-#   with 750ms passing in between. Overrides the default value in circles.cfg
-# extraWait : after finishing the animations, wait this many ms before spell
-#   actually goes off.  Overrides the default value in circles.cfg
-# Reagent : what regs the spell requires.
-#
-################
-
-###
-# Madman's note:
-#  All spellcasting timing notes come from the LBR/AOS hint book for UO.
-#  The old versions of these values in this file included summoning spells
-#  taking a heck of a lot longer to cast than ordinary spells.
-#  Fortunately, you can tweak these on a by-spell basis, so feel free.
-#
-
-# First circle spells take 500ms to cast.
-
-Spell 1
-{
-    SpellId     1
-    Name        Clumsy
-    SpellScript      :magery:clumsy
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Uus Jux
-    Reagent     bloodmoss
-    Reagent     nightshade
-
-}
-
-Spell 2
-{
-    SpellId     2
-    Name        Create Food
-    SpellScript      :magery:createFood
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	notarget
-    Noto	helpful
-    PowerWords  In Mani Ylem
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     MandrakeRoot
-}
-
-Spell 3
-{
-    SpellId     3
-    Name        Feeblemind
-    SpellScript      :magery:feeblemind
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Rel Wis
-    Reagent     nightshade
-    Reagent     ginseng
-}
-
-Spell 4
-{
-    SpellId     4
-    Name        Heal
-    SpellScript      :magery:heal
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	helpful
-    PowerWords  In Mani
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     spidersilk
-}
-
-Spell  5
-{
-    SpellId     5
-    Name        Magic Arrow
-    SpellScript      :magery:magicArrow
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	harmful
-    PowerWords  In Por Ylem
-    Reagent     blackpearl
-    Reagent     nightshade
-}
-
-Spell 6
-{
-    SpellId     6
-    Name        Night Sight
-    SpellScript      :magery:nightSight
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	helpful
-    PowerWords  In Lor
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 7
-{
-    SpellId     7
-    Name        Reactive Armor
-    SpellScript      :magery:reactiveArmor
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	helpful
-    PowerWords  Flam Sanct
-    Reagent     garlic
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 8
-{
-    SpellId     8
-    Name        Weaken
-    SpellScript      :magery:weaken
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Des Mani
-    Reagent     garlic
-    Reagent     nightshade
-}
-
-# Second circle spells take 750ms to cast.
-
-Spell 9
-{
-    SpellId     9
-    Name        Agility
-    SpellScript      :magery:agility
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	helpful
-    PowerWords  Ex Uus
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-}
-
-Spell 10
-{
-    SpellId     10
-    Name        Cunning
-    SpellScript      :magery:cunning
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	helpful
-    PowerWords  Uus Wis
-    Reagent     Nightshade
-    Reagent     mandrakeroot
-}
-
-Spell 11
-{
-    SpellId     11
-    Name        Cure
-    SpellScript      :magery:cure
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	helpful
-    PowerWords  An Nox
-    Reagent     garlic
-    Reagent     ginseng
-}
-
-Spell 12
-{
-    SpellId     12
-    Name        Harm
-    SpellScript      :magery:harm
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	harmful
-    PowerWords  An Mani
-    Reagent     nightshade
-    Reagent     spidersilk
-}
-
-Spell 13
-{
-    SpellId     13
-    Name        Magic Trap
-    SpellScript      :magery:magicTrap
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	harmful
-    PowerWords  In Jux
-    Reagent     garlic
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 14
-{
-    SpellId     14
-    Name        Magic Untrap
-    SpellScript      :magery:magicUntrap
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	harmful
-    PowerWords  An Jux
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     SulphurousAsh
-}
-
-Spell 15
-{
-    SpellId     15
-    Name        Protection
-    SpellScript      :magery:protection
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	helpful
-    PowerWords  Uus Sanct
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     SulphurousAsh
-}
-
-Spell 16
-{
-    SpellId     16
-    Name        Strength
-    SpellScript      :magery:strength
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	helpful
-    PowerWords  Uus Mani
-    Reagent     mandrakeroot
-    Reagent     nightshade
-}
-
-# Third circle spells take 1s to cast.
-
-Spell 17
-{
-    SpellId     17
-    Name        Bless
-    SpellScript      :magery:bless
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	direct
-    Noto	helpful
-    PowerWords  Rel Sanct
-    Reagent     garlic
-    Reagent     mandrakeroot
-}
-
-Spell 18
-{
-    SpellId     18
-    Name        Fireball
-    SpellScript      :magery:fireball
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Vas Flam
-    Reagent     blackpearl
-    Reagent     sulphurousash
-}
-
-Spell 19
-{
-    SpellId     19
-    Name        Magic Lock
-    SpellScript      :magery:magicLock
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	direct
-    Noto	neutral
-    PowerWords  An Por
-    Reagent     bloodmoss
-    Reagent     garlic
-    Reagent     SulphurousAsh
-}
-
-Spell 20
-{
-    SpellId     20
-    Name        Poison
-    SpellScript      :magery:poison
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	direct
-    Noto	harmful
-    PowerWords  In Nox
-    Reagent     nightshade
-}
-
-Spell 21
-{
-    SpellId     21
-    Name        Telekinesis
-    SpellScript      :magery:telekinesis
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery 	direct
-    Noto	harmful
-    PowerWords  Ort Por Ylem
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-}
-
-Spell 22
-{
-    SpellId     22
-    Name        Teleport
-    SpellScript      :magery:teleport
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	indirect
-    Noto	neutral
-    PowerWords  Rel Por
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-}
-
-Spell 23
-{
-    SpellId     23
-    Name        Unlock
-    SpellScript      :magery:unlock
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	direct
-    Noto	neutral
-    PowerWords  Ex Por
-    Reagent     bloodmoss
-    Reagent     garlic
-}
-
-Spell 24
-{
-    SpellId     24
-    Name        Wall of Stone
-    SpellScript      :magery:wallOfStone
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	indirect
-    Noto	neutral
-    PowerWords  In Sanct Ylem
-    Reagent     bloodmoss
-    Reagent     garlic
-}
-
-# Fourth circle spells take 1250ms to cast
-
-Spell 25
-{
-    SpellId     25
-    Name        Arch Cure
-    SpellScript      :magery:archCure
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	indirect
-    Noto	helpful
-    PowerWords  Vas An Nox
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     MandrakeRoot
-}
-
-Spell 26
-{
-    SpellId     26
-    Name        Arch Protection
-    SpellScript      :magery:archProt
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	indirect
-    Noto	helpful
-    PowerWords  Vas Uus Sanct
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     mandrakeroot
-    Reagent     SulphurousAsh
-}
-
-Spell 27
-{
-    SpellId     27
-    Name        Curse
-    SpellScript      :magery:curse
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Des Sanct
-    Reagent     garlic
-    Reagent     nightshade
-    Reagent     SulphurousAsh
-}
-
-Spell 28
-{
-    SpellId     28
-    Name        Fire Field
-    SpellScript      :magery:fireField
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  In Flam Grav
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-    Reagent     blackpearl
-}
-
-Spell 29
-{
-    SpellId     29
-    Name        Greater Heal
-    SpellScript      :magery:gHeal
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	direct
-    Noto	helpful
-    PowerWords  In Vas Mani
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 30
-{
-    SpellId     30
-    Name        Lightning
-    SpellScript      :magery:lightning
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Por Ort Grav
-    Reagent     blackpearl
-    Reagent     sulphurousash
-    Reagent 	MandrakeRoot
-}
-
-Spell 31
-{
-    SpellId     31
-    Name        Mana Drain
-    SpellScript      :magery:manaDrain
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Ort Rel
-    Reagent     blackpearl
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 32
-{
-    SpellId     32
-    Name        Recall
-    SpellScript      :magery:recall
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	notarget
-    Noto	neutral
-    PowerWords  Kal Ort Por
-    Reagent     blackpearl
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-}
-
-# Fifth circle spells take 1500ms to cast
-
-Spell 33
-{
-    SpellId     33
-    Name        Blade Spirit
-    SpellScript      :magery:bladeSpirit
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  In Jux Hur Ylem
-    Reagent     blackpearl
-    Reagent     mandrakeroot
-    Reagent     nightshade
-}
-
-Spell 34
-{
-    SpellId     34
-    Name        Dispel Field
-    SpellScript      :magery:dispelField
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	direct
-    Noto	neutral
-    PowerWords  An Grav
-    Reagent     blackpearl
-    Reagent     garlic
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 35
-{
-    SpellId     35
-    Name        Incognito
-    SpellScript      :magery:incognito
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	notarget
-    Noto	neutral
-    PowerWords  Kal In Ex
-    Reagent     bloodmoss
-    Reagent     garlic
-    Reagent     nightshade
-}
-
-Spell 36
-{
-    SpellId     36
-    Name        Magic Reflection
-    SpellScript      :magery:reflect
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	notarget
-    Noto	helpful
-    PowerWords  In Jux Sanct
-    Reagent     garlic
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 37
-{
-    SpellId     37
-    Name        Mind Blast
-    SpellScript      :magery:mindBlast
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Por Corp Wis
-    Reagent     blackpearl
-    Reagent     mandrakeroot
-    Reagent     nightshade
-    Reagent     SulphurousAsh
-}
-
-Spell 38
-{
-    SpellId     38
-    Name        Paralyze
-    SpellScript      :magery:paralyze
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	direct
-    Noto	harmful
-    PowerWords  An Ex Por
-    Reagent     garlic
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 39
-{
-    SpellId     39
-    Name        Poison Field
-    SpellScript      :magery:poisonField
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  In Nox Grav
-    Reagent     blackpearl
-    Reagent     nightshade
-    Reagent     spidersilk
-}
-
-Spell 40
-{
-    SpellId     40
-    Name        SummonCreature
-    SpellScript      :magery:summonCreature
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	indirect
-    Noto	neutral
-    PowerWords  Kal Xen
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-# Sixth circle spells take 1750ms to cast
-
-Spell 41
-{
-    SpellId     41
-    Name        Dispel
-    SpellScript      :magery:dispel
-    Script	:spellcasting:spellcast
-    Circle      6
-    PowerWords  An Ort
-    Reagent     garlic
-    Reagent     mandrakeroot
-    Reagent     SulphurousAsh
-}
-
-Spell 42
-{
-    SpellId     42
-    Name        Energy Bolt
-    SpellScript      :magery:eBolt
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Corp Por
-    Reagent     blackpearl
-    Reagent     nightshade
-}
-
-Spell 43
-{
-    SpellId     43
-    Name        Explosion
-    SpellScript      :magery:explosion
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Vas Ort Flam
-    Reagent     blackpearl
-    Reagent     mandrakeroot
-    Reagent     SulphurousAsh
-}
-
-Spell 44
-{
-    SpellId     44
-    Name        Invisibility
-    SpellScript      :magery:invisibility
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	direct
-    Noto	helpful
-    PowerWords  An Lor Xen
-    Reagent     bloodmoss
-    Reagent     nightshade
-}
-
-Spell 45
-{
-    SpellId     45
-    Name        Mark
-    SpellScript      :magery:mark
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	notarget
-    Noto	neutral
-    PowerWords  Kal Por Ylem
-    Reagent     blackpearl
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-}
-
-Spell 46
-{
-    SpellId     46
-    Name        Mass Curse
-    SpellScript      :magery:massCurse
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  Vas Des Sanct
-    Reagent     garlic
-    Reagent     mandrakeroot
-    Reagent     nightshade
-    Reagent     SulphurousAsh
-}
-
-Spell 47
-{
-    SpellId     47
-    Name        Paralyze Field
-    SpellScript      :magery:paraField
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  In Ex Grav
-    Reagent     blackpearl
-    Reagent     ginseng
-    Reagent     spidersilk
-}
-
-Spell 48
-{
-    SpellId     48
-    Name        Reveal
-    SpellScript      :magery:reveal
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	indirect
-    Noto	neutral
-    PowerWords  Wis  Quas
-    Reagent     bloodmoss
-    Reagent     SulphurousAsh
-}
-
-# Seventh circle spells take 2s to cast
-
-Spell 49
-{
-    SpellId     49
-    Name        Chain Lightning
-    SpellScript      :magery:chainLightning
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  Vas Ort Grav
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     blackpearl
-    Reagent     SulphurousAsh
-}
-
-Spell 50
-{
-    SpellId     50
-    Name        Energy Field
-    SpellScript      :magery:energyField
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	indirect
-    Noto	neutral
-    PowerWords  In Sanct Grav
-    Reagent     blackpearl
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 51
-{
-    SpellId     51
-    Name        FlameStrike
-    SpellScript      :magery:flameStrike
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Kal Vas Flam
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 52
-{
-    SpellId     52
-    Name        Gate
-    SpellScript      :magery:gate
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	notarget
-    Noto	neutral
-    PowerWords  Vas Rel Por
-    Reagent     blackpearl
-    Reagent     mandrakeroot
-    Reagent     SulphurousAsh
-}
-
-Spell 53
-{
-    SpellId     53
-    Name        Mana Vampire
-    SpellScript      :magery:manaVamp
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Ort Sanct
-    Reagent     blackpearl
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 54
-{
-    SpellId     54
-    Name        Mass Dispel
-    SpellScript      :magery:massDispel
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	indirect
-    Noto	neutral
-    PowerWords  Vas An Ort
-    Reagent     blackpearl
-    Reagent     garlic
-    Reagent     mandrakeroot
-    Reagent     SulphurousAsh
-}
-
-Spell 55
-{
-    SpellId     55
-    Name        Meteor Swarm
-    SpellScript      :magery:meteorSwarm
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  Kal Des Flam Ylem
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     SpiderSilk
-    Reagent     SulphurousAsh
-}
-
-Spell 56
-{
-    SpellId     56
-    Name        Polymorph
-    SpellScript      :magery:polymorph
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	notarget
-    Noto	helpful
-    PowerWords  Vas Ylem Rel
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-# Eighth circle spells take 2250ms to cast
-
-Spell 57
-{
-    SpellId     57
-    Name        Earthquake
-    SpellScript      :magery:earthquake
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	notarget
-    Noto	neutral
-    PowerWords  In Vas Por
-    Reagent     bloodmoss
-    Reagent     ginseng
-    Reagent     mandrakeroot
-    Reagent     SulphurousAsh
-}
-
-Spell 58
-{
-    SpellId     58
-    Name        EnergyVortex
-    SpellScript      :magery:vortex
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	indirect
-    Noto	harmful
-    Animation   0x11
-    PowerWords  Vas Corp Por
-    Reagent     blackpearl
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     nightshade
-}
-
-Spell 59
-{
-    SpellId     59
-    Name        Resurrection
-    SpellScript      :magery:resurrect
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	direct
-    Noto	neutral
-    PowerWords  An Corp
-    Reagent     bloodmoss
-    Reagent     garlic
-    Reagent     ginseng
-}
-
-Spell 60
-{
-    SpellId     60
-    Name        Summon Air Elemental
-    SpellScript      :magery:summonAir
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	indirect
-    Noto	neutral
-    Animation   0x11
-    PowerWords  Kal Vas Xen Hur
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 61
-{
-    SpellId     61
-    Name        Summon Daemon
-    SpellScript      :magery:summonDaemon
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	indirect
-    Noto	neutral
-    Animation   0x11
-    PowerWords  Kal Vas Xen Corp
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 62
-{
-    SpellId     62
-    Name        Summon Earth Elemental
-    SpellScript      :magery:summonEarth
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	indirect
-    Noto	neutral
-    Animation   0x11
-    PowerWords  Kal Vas Xen Ylem
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 63
-{
-    SpellId     63
-    Name        Summon Fire Elemental
-    SpellScript      :magery:summonFire
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	indirect
-    Noto	neutral
-    Animation   0x11
-    PowerWords  Kal Vas Xen Flam
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 64
-{
-    SpellId     64
-    Name        Summon Water Elemental
-    SpellScript      :magery:summonWater
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	indirect
-    Noto	neutral
-    Animation   0x11
-    PowerWords  Kal Vas Xen An Flam
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}

Deleted: trunk/096/pkg/skills/magery/strength.src
===================================================================
--- trunk/096/pkg/skills/magery/strength.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/strength.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,26 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/statMod";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-
-
-program spell_strength(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	PlaySoundEffect(castOn, SFX_SPELL_STRENGTH);
-	PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 7,7);
-	if (!CanMod(castOn, "str"))
-		SendSysMessage(caster,"Already under the influence!");
-		return;
-	endif
-	var magery := AP_GetSkill(caster, MAGERY);
-	var mod_amount := GetModAmount( magery );
-	var duration := GetModDuration( magery );
-	DoTempMod(castOn, "str", mod_amount, duration);
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/summon.inc
===================================================================
--- trunk/096/pkg/skills/magery/summon.inc	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/summon.inc	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,41 +0,0 @@
-use uo;
-use os;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-
-
-function DoSummon( caster, circle, npctemplate, cast_loc )
-  var thecritter;
-  var magery := AP_GetSkill(caster, MAGERY);
-  var duration := 20 + (magery * 2);
-  var parms := {};
-  parms .+ script := "tamed";
-  Detach();
-  sleepms(100);
-  thecritter := CreateNpcFromTemplate(npctemplate, cast_loc.x, cast_loc.y,cast_loc.z, parms, caster.realm);
-  if(npctemplate == "summoneddaemon")
-    PlaySoundEffect(caster, 535);
-  else
-    if(circle == 8)
-      PlaySoundEffect(caster, 536);
-      PerformAction(thecritter, 12);
-    else
-      PlaySoundEffect(caster, 534);
-    endif
-  endif
-  SetObjProperty(thecritter,"master", caster.serial);
-  SetScriptController( thecritter);
-  SetObjProperty(thecritter, "happiness",100);
-  SetObjProperty(thecritter, "summoned",1);
-  RestartScript(thecritter);
-  //SetBaseSkillBaseValue( thecritter, SKILLID_MAGICRESISTANCE,  magery * 10  );
-  AP_SetTrueSkill(thecritter, RESISTING_SPELLS, magery*10);
-  sleep(duration);
-  PlaySoundEffect( thecritter, SFX_SPELL_MANA_VAMPIRE );
-  PlayStationaryEffect( thecritter.x, thecritter.y, thecritter.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
-  MoveCharacterToLocation(thecritter,0,0,0,MOVECHAR_FORCELOCATION);
-  ApplyRawDamage(thecritter, AP_GetVital(thecritter, HITS) + 3);
-endfunction

Deleted: trunk/096/pkg/skills/magery/summonAir.src
===================================================================
--- trunk/096/pkg/skills/magery/summonAir.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/summonAir.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,10 +0,0 @@
-include "summon";
-
-program spell_summonAirElemental(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	DoSummon(caster, 8, "airelemental", castOn);
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/summonCreature.src
===================================================================
--- trunk/096/pkg/skills/magery/summonCreature.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/summonCreature.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,55 +0,0 @@
-use util;
-
-include "summon";
-include ":attributes:attributes";
-
-
-program spell_summonCreature( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-  
-  var thecreature;
-  var critgroup;
-  var basemagery := CInt(AP_GetSkill(caster, MAGERY));
-  if (basemagery < 70)
-	critgroup := RandomInt(1);
-  elseif (basemagery < 80)
-	critgroup := RandomInt(1)+1;
-  elseif (basemagery < 90)
-	critgroup := RandomInt(1)+2;
-  else
-	critgroup := 3;
-  endif
-  var critter := RandomInt(19);
-	  case (critter)
-		0: thecreature := "chicken";
-		1: thecreature := "cat";
-		2: thecreature := "slime";
-		3: thecreature := "sheep";
-		4: thecreature := "pig";
-		5: thecreature := "dog";
-		6: thecreature := "grat";
-		7: thecreature := "eagle";
-		8: case(RandomInt(4))
-		     0: thecreature := "horse";
-		     1: thecreature := "horse2";
-		     2: thecreature := "horse3";
-		     3: thecreature := "horse4";
-		   endcase
-	    9: thecreature := "gorilla";
-	   10: thecreature := "panther";
-	   11: thecreature := "deer";
-	   12: thecreature := "bear";
-	   13: thecreature := "ghart";
-	   14: thecreature := "blackbear";
-	   15: thecreature := "alligator";
-	   16: thecreature := "giantspider";
-	   17: thecreature := "giant_serpent";
-	   18: thecreature := "polar";
-  endcase
- 
-  DoSummon( caster, circle, thecreature, castOn );
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/summonDaemon.src
===================================================================
--- trunk/096/pkg/skills/magery/summonDaemon.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/summonDaemon.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,11 +0,0 @@
-include "summon";
-
-
-program summonDaemon( parms )
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	DoSummon( caster, 8, "summoneddaemon", castOn );
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/summonEarth.src
===================================================================
--- trunk/096/pkg/skills/magery/summonEarth.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/summonEarth.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,11 +0,0 @@
-include "summon";
-
-
-program summonEarthElemental(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	DoSummon(caster, 8, "earthelemental", castOn);
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/summonFire.src
===================================================================
--- trunk/096/pkg/skills/magery/summonFire.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/summonFire.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,11 +0,0 @@
-include "summon";
-
-
-program spell_summonFireElemental(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	DoSummon(caster, 8, "fireelemental", castOn);
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/summonWater.src
===================================================================
--- trunk/096/pkg/skills/magery/summonWater.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/summonWater.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,11 +0,0 @@
-include "summon";
-
-
-program spell_summonWaterElemental(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-  
-	DoSummon(caster, 8, "waterelemental", castOn);
-
-	return;
-endprogram

Deleted: trunk/096/pkg/skills/magery/telekinesis.src
===================================================================
--- trunk/096/pkg/skills/magery/telekinesis.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/telekinesis.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,47 +0,0 @@
-use uo;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-include "include/magic";
-
-
-program spell_telekinesis(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-  
-  PlaySoundEffect( caster, SFX_SPELL_TELEKINESIS );
-  if( castOn.npctemplate || castOn.acctname )
-    SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "telekinesis" });
-    if(spell_reflect(castOn))
-      castOn := caster;
-    endif
-    PlaySoundEffect(castOn, 0x144);
-    PlayObjectCenteredEffect(castOn, 0x37b9,0x03, 0x0a);
-    var dmg := RandomInt(AP_GetSkill(caster, MAGERY) / 10);
-    ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
-    if((castOn.graphic  == 0x190) or (castOn.graphic == 0x191))
-      PerformAction(castOn, 20);
-    endif
-  elseif(castOn.multi.serial)
-    SendSysMessage(caster, "You cannot use that on items inside houses.");
-    return;
-  elseif(castOn.container.serial)
-    SendSysMessage(caster, "You cannot use that on items inside containers.");
-    return;
-  elseif((castOn.isa(POLCLASS_CONTAINER)) and (GetObjProperty(castOn, "trap_type")))
-    var parms := array(caster, castOn);
-    start_script(":tinkering:tinkerTraps", parms);
-  else
-    if(MoveItemToContainer( castOn, caster.backpack, x := -1, y := -1 ))
-      PrintTextAbovePrivate(caster, "You pick up the item with your mind.", caster);
-    else
-      PrintTextAbovePrivate(caster, "You cannot will it to move.", caster);
-    endif
-  endif
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/teleport.src
===================================================================
--- trunk/096/pkg/skills/magery/teleport.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/teleport.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,35 +0,0 @@
-use uo;
-use os;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include "include/isValidLoc";
-
-
-program spell_teleport( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  if (!isValidLoc(castOn.x, castOn.y))
-    SendSysMessage(caster, "You cannot teleport there.");
-    return;
-  endif
-  var sx := caster.x, sy := caster.y, sz := caster.z; 
-  var multicheck := CreateItemAtLocation(castOn.x, castOn.y, castOn.z, 0xeed, 1, caster.realm);
-  multicheck.hidden := 1;
-  if (multicheck.multi.serial != error)
-    SendSysMessage(caster,"You cannot teleport there.");
-    DestroyItem(multicheck);
-    return;
-  else
-    if((multicheck.x > 5120) && (multicheck.x < 6133) && (multicheck.y > 2063) && (multicheck.y < 2303))
-      DestroyItem(multicheck);
-      return;
-    endif
-    DestroyItem(multicheck);
-    MoveCharacterToLocation( caster, castOn.x, castOn.y, castOn.z );
-    PlayStationaryEffect( sx, sy, sz, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
-    PlayStationaryEffect( caster.x, caster.y, caster.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
-    PlaySoundEffect( caster, SFX_SPELL_TELEPORT );
-  endif
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/unlock.src
===================================================================
--- trunk/096/pkg/skills/magery/unlock.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/unlock.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,84 +0,0 @@
-// $Id$
-
-use os;
-use uo;
-use util;
-
-include "include/sound";
-include "include/client";
-
-program spell_unlock(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  if (!castOn.locked)
-    SendSysMessage(caster,"That is not locked!");
-    return;
-  endif
-  if ((castOn.multi) || (GetObjProperty(castOn,"houseserial")) || (GetObjProperty(castOn,"house_serial")))
-    SendSysMessage(caster, "You cannot magically unlock that!");
-//    PlayLightningBoltEffect(caster);
-    return;
-  endif
-  if (GetObjProperty(castOn, "#U"))
-    if (GetObjProperty(castOn, "#U") > ReadGameClock())
-      SendSysMessage(caster, "You must wait to pick this lock!");
-      return;
-    endif
-  endif
-  var diff := CInt(GetObjProperty(castOn,"MLockPickDiff"));
-  if(diff)
-    PlaySoundEffect(caster, SFX_SPELL_UNLOCK);
-    if(diff <= 25)
-      castOn.locked := 0;
-      PrintTextAbovePrivate(castOn, "*Unlocked!*", caster);
-      EraseObjProperty(castOn, "MLockPickDiff");
-      return;
-    else
-      SendSysMessage(caster, "Your spell doesn't seem to work on that lock.");
-      return;
-    endif
-  else
-    var diffi := CInt(GetObjProperty(castOn,"LockPickDiff"));
-    if(diffi)
-      PlaySoundEffect(caster, SFX_SPELL_UNLOCK);
-      if(diffi <= 25)
-        castOn.locked := 0;
-        PrintTextAbovePrivate(castOn, "*Unlocked!*", caster);
-        return;
-      else
-        SendSysMessage(caster, "Your spell doesn't seem to work on that lock.");
-        return;
-      endif
-    else
-      if(GetObjProperty(castOn, "level"))
-        PickTreasureChest(caster, castOn);
-      else
-        SendSysMessage(castOn, "You can't seem to unlock that!");
-        return;
-      endif
-    endif
-  endif
-endprogram
-
-function PickTreasureChest(me, chest)
-  var lvl := GetObjProperty(chest,"level");
-  if(!lvl)
-    SendSysMessage(me, "You cannot pick that.");
-    return;
-  endif
-  if(!chest.locked)
-    SendSysMessage(me,"That doesn't appear to be locked.");
-    return;
-  endif
-  PlaySoundEffect(me, SFX_242);
-  sleep(1);
-  var diff := (lvl * 25) - 10;
-  if(diff <= 25)
-    PlaySoundEffect(chest,SFX_200);
-    PrintTextAbovePrivate(chest, "*Unlocked!*", me);
-    chest.locked := 0;
-  else
-    SendSysMessage(me, "Your spell doesn't seem to work on that lock.");
-    return;
-  endif
-endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/vortex.src
===================================================================
--- trunk/096/pkg/skills/magery/vortex.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/vortex.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,24 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-
-
-program spell_vortex( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var thecritter := CreateNpcFromTemplate("vortex", castOn.x, castOn.y,castOn.z, 0, caster.realm);
-  PlaySoundEffect(thecritter,SFX_SPELL_ENERGY_VORTEX);
-  SetObjProperty(thecritter, "summoned",1);
-  SetObjProperty(thecritter, "master", caster.serial);
-  Detach();
-  sleep( (AP_GetSkill(caster, MAGERY) ) );
-  PlaySoundEffect( thecritter, SFX_SPELL_MANA_VAMPIRE );
-  PlayStationaryEffect( thecritter.x, thecritter.y, thecritter.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
-  MoveCharacterToLocation(thecritter,0,0,0,MOVECHAR_FORCELOCATION);
-  ApplyRawDamage(thecritter, AP_GetVital(thecritter, HITS) + 3);
-endprogram

Deleted: trunk/096/pkg/skills/magery/wallOfStone.src
===================================================================
--- trunk/096/pkg/skills/magery/wallOfStone.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/wallOfStone.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,35 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/fields";
-include "include/sound";
-include ":attributes:attributes";
-
-
-program spell_wallOfStone(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var fields := {};
-  var duration;
-  var x := castOn.x;
-  var y := castOn.y;
-  var z := castOn.z;
-  case(get_direction(caster))
-	"NS" : fields:= CreateNorthSouthField(caster, 0x80, x, y, z, 5);
-	"EW" : fields:= CreateEastWestField(caster, 0x80, x, y, z, 5);
-  endcase
-  Detach();
-  duration := CInt(AP_GetSkill(caster, MAGERY) )/2;
-  if (duration < 20)
-    duration := 20;
-  endif
-  var i;
-  for (i := 1; i <= 5; i := i + 1)
-    PlaySoundEffect(fields[i], SFX_SPELL_WALL_OF_STONE);
-  endfor
-  sleep(duration);
-  foreach fieldpart in fields
-    DestroyItem(fieldpart);
-  endforeach
-endprogram

Deleted: trunk/096/pkg/skills/magery/weaken.src
===================================================================
--- trunk/096/pkg/skills/magery/weaken.src	2005-11-03 05:40:05 UTC (rev 867)
+++ trunk/096/pkg/skills/magery/weaken.src	2005-11-03 05:44:14 UTC (rev 868)
@@ -1,33 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/statMod";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-include "include/magic";
-
-
-program spell_weaken(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "weaken" });
-  if(spell_reflect(castOn))
-	castOn := caster;
-  endif
-  PlaySoundEffect(castOn, SFX_SPELL_WEAKEN);
-  PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 7,7);
-  if(!CanMod(castOn, "str"))
-	return;
-  endif
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := Resisted(circle,caster,castOn,(GetModAmount( magery )));
-  var duration := GetModDuration( magery );
-  DoTempMod(castOn, "str", 0 - modAmount, duration);
-endprogram
\ No newline at end of file



From austin at berlios.de  Thu Nov  3 15:42:58 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 15:42:58 +0100
Subject: [Poldistro-svn] r880 - trunk/096
Message-ID: <200511031442.jA3EgwI3007124@sheep.berlios.de>

Author: austin
Date: 2005-11-03 15:42:53 +0100 (Thu, 03 Nov 2005)
New Revision: 880

Modified:
   trunk/096/CoreChanges-096.txt
Log:


Modified: trunk/096/CoreChanges-096.txt
===================================================================
--- trunk/096/CoreChanges-096.txt	2005-11-03 08:23:47 UTC (rev 879)
+++ trunk/096/CoreChanges-096.txt	2005-11-03 14:42:53 UTC (rev 880)
@@ -1,4 +1,16 @@
 -- POL096 --
+11-03 Austin
+    Added : uo::CoordinateDistance(x1, y1, x2, y2) - Returns the distance between two coordinates.
+    
+    The following two functions were originally scripted by Myrathi:
+    Added : uo::GetCoordsInLine(x1, y1, x2, y2) - Returns an array of structs {.x, .y} for every coordinate
+            between the two points.
+    Added : uo::GetFacing(from_x, from_y, to_x, to_y) - Returns the facing number an object must have in order to 
+            face to_x and to_y from from_x and from_y.
+
+10-31 Austin
+	Fixed : Core crash with MoveCharacterToLocation() when a character was moved to the same realm.
+
 10-30 Austin
         Changed : NPC.connected will now always return 1. Before it was 0.
 



From austin at berlios.de  Thu Nov  3 16:09:27 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 16:09:27 +0100
Subject: [Poldistro-svn] r881 - in trunk/096/pkg/skills/magery: . config include
Message-ID: <200511031509.jA3F9RSW003377@sheep.berlios.de>

Author: austin
Date: 2005-11-03 16:09:26 +0100 (Thu, 03 Nov 2005)
New Revision: 881

Modified:
   trunk/096/pkg/skills/magery/config/spells.cfg
   trunk/096/pkg/skills/magery/include/spells.inc
   trunk/096/pkg/skills/magery/spellStarter.src
Log:


Modified: trunk/096/pkg/skills/magery/config/spells.cfg
===================================================================
--- trunk/096/pkg/skills/magery/config/spells.cfg	2005-11-03 14:42:53 UTC (rev 880)
+++ trunk/096/pkg/skills/magery/config/spells.cfg	2005-11-03 15:09:26 UTC (rev 881)
@@ -0,0 +1,17 @@
+#
+# Spell	Example
+# {
+#	Script		:magery:spellScripts/Circle#/fileName
+#	
+#	ManaCost	25
+#	
+#	BaseDelay	100
+#	Difficulty	35
+#	
+#	Attribute	Magery
+#	
+#	Reagent	BloodMoss	5
+#	Reagent	BlackPearl	10
+#	Reagent	Ginseng		250000
+#}
+#
\ No newline at end of file

Modified: trunk/096/pkg/skills/magery/include/spells.inc
===================================================================
--- trunk/096/pkg/skills/magery/include/spells.inc	2005-11-03 14:42:53 UTC (rev 880)
+++ trunk/096/pkg/skills/magery/include/spells.inc	2005-11-03 15:09:26 UTC (rev 881)
@@ -9,22 +9,80 @@
 
 const MAX_RANGE	:= 16;
 
-function SpellDebug(who, text)
-	if ( who.cmdlevel )
-		SendSysMessage(who, ""+text);
+/*
+ * MS_GetSpellsCfgFile()
+ *
+ * Purpose
+ * Gets the spells.cfg file from the magery package.
+ *
+ * Parameters
+ *
+ * Return value
+ * Config file
+ *
+ */
+function MS_GetSpellsCfgFile()
+	var cfg := ReadConfigFile(":magery:config/spells");
+
+	if ( cfg.errortext )
+		SysLog("Error::MS_GetSpellsCfgFile() - Unable to open [:magery:config/spells.cfg] ->"+cfg.errortext);
 	endif
+
+	return cfg;
 endfunction
 
-function UseMana(who, amount)
-	if ( AP_GetVital(who, MANA) >= amount )
-		AP_SetVital(who, MANA, AP_GetVital(who, MANA)-amount);
+/*
+ * MS_GetSpellsCfgElem(elem_name, cfg_file)
+ *
+ * Purpose
+ * Retrieves an elem from a config file. 
+ *
+ * Parameters
+ * elem_name:	A string matching the elem name to be retrieved.
+ * cfg_file:	Optional parameter - reference to a config already read in by MS_GetSpellsCfgFile()
+ *
+ * Return value
+ * A config file elem reference.
+ *
+ */
+function MS_GetSpellsCfgElem(elem_name, byref cfg_file:=0)
+	if ( !cfg_file )
+		cfg_file := MS_GetSpellsCfgFile();
+	endif
+	
+	var elem := cfg_file[elem_name];
+
+	if ( elem.errortext )
+		SysLog("Error::MS_GetSpellsCfgElem() - Unable to find elem ["+elem_name+"] ->"+elem.errortext);
+	endif
+
+	return elem;
+endfunction
+
+/* 
+ * MS_SpellDebug(who, text)
+ *
+ * Purpose
+ * Sends debug information to mobiles with a command level.
+ *
+ * Parameters
+ * who:		Mobile that will see the debug message.
+ * text:	Text to show.
+ *
+ * Return value
+ * Returns 1 if the text was sent.
+ * Returns 0 if the text was not sent.
+ */
+function MS_SpellDebug(who, text)
+	if ( who.cmdlevel )
+		SendSysMessage(who, ""+text);
 		return 1;
-	else
-		return 0;
 	endif
+	return 0;
 endfunction
 
-function Reflection(who, targ, spell_strength, info)
+function MS_Reflection()
+	// Not sure what params it would need yet to be flexible.
 	// Lower targ's defense
 	// Apply some of spell_strength to target if reflected.
 	// Lower spell_strength by how much was not reflected.
@@ -32,59 +90,108 @@
 	
 endfunction
 
-function SpellTarget(byref who, byref npctarget:=0, prompt := "Select a target.", ops:=TGTOPT_CHECK_LOS+TGTOPT_NEUTRAL)
-	var x := who.x;
-	var y := who.y;
+/* 
+ * MS_Target(who, targ, prompt, flags)
+ *
+ * Purpose
+ * Used to handle targetting of other objects in spell scripts.
+ *
+ * Parameters
+ * who:		Mobile that is doing the targetting
+ * targ:	Pre-selected target (for NPCs)
+ * prompt:	Message the user receives when targeting.
+ * flags:	uo.em targeting flags.
+ *
+ * Return value
+ * Returns an object reference to what was targeted.
+ *
+ */
+function MS_Target(byref who, byref targ:=0, byref prompt := "Select a target.", byref flags:=TGTOPT_CHECK_LOS+TGTOPT_NEUTRAL)
 	who.hidden := 0;
 	
-	if ( npctarget )
-		return npctarget;
+	if ( targ.IsA(POLCLASS_UOBJECT) )
+		return targ;
 	elseif ( who.npctemplate )
-		return;
+		return 0;
 	endif
 	
+	var orig_x := who.x;
+	var orig_y := who.y;
+	
 	SendSysMessage(who, prompt);
 	
-	var targ := Target(who, ops);
+	targ := Target(who, flags);
 	if ( Distance(who, targ) > MAX_RANGE )
 		SendSysMessage(who, "That is too far away.");
 		return 0;
-	elseif ( who.x == x && who.y == y )
-		return targ;
-	else
+	elseif ( who.x != orig_x || who.y != orig_y )
 		SendSysMessage(who, "You break your concentration.");
 		return 0;
+	else
+		return targ;
 	endif
 endfunction
 
-function SpellTargetCoordinates(byref who, byref npctarget:=0, prompt := "Select a target.", range := MAX_RANGE)
-	var x := who.x;
-	var y := who.y;
+/* 
+ * MS_TargetCoordinates(who, targ, prompt)
+ *
+ * Purpose
+ * Used to handle targetting of other objects in spell scripts.
+ *
+ * Parameters
+ * who:		Mobile that is doing the targetting
+ * targ:	Pre-selected target (for NPCs)
+ * prompt:	Message the user receives when targeting.
+ *
+ * Return value
+ * Returns an object reference to what was targeted.
+ *
+ */
+function MS_TargetCoordinates(byref who, byref targ:=0, byref prompt := "Select a target.")
 	who.hidden := 0;
 	
-	if ( npctarget )
-		return npctarget;
+	if ( targ )
+		return targ;
 	elseif ( who.npctemplate )
-		return;
+		return 0;
 	endif
 	
+	var orig_x := who.x;
+	var orig_y := who.y;
+	
 	SendSysMessage(who, prompt);
-	var targ := TargetCoordinates(who);
+	targ := TargetCoordinates(who);
+	
 	if ( !targ )
 		SendSysMessage(who, "Cancelled.");
 		return 0;
-	elseif ( CoordDistance(who.x, who.y, targ.x, targ.y) > range )
+	elseif ( CoordinateDistance(who.x, who.y, targ.x, targ.y) > MAX_RANGE )
 		SendSysMessage(who, "That is too far away.");
 		return 0;
-	elseif ( who.x == x && who.y == y )
-		return targ;
-	else
+	elseif ( who.x != orig_x || who.y != orig_y )
 		SendSysMessage(who, "You lose concentration.");
 		return 0;
+	else
+		return targ;
 	endif
 endfunction
 
-function GetSpellPoints(mage, targ, points)
+/*
+ * MS_AdjustSpellPoints(mage, targ, points)
+ *
+ * Purpose
+ * Adjusts the effectiveness of a spell based on the target's magic resistance.
+ *
+ * Parameters
+ * caster:	Who is casting the spells.
+ * targ:	Who the spell is effecting.
+ * points:	Strength of the spell.
+ *
+ * Return value
+ * Integer - adjusted point
+ *
+ */
+function MS_AdjustSpellPoints(mage, targ, points)
 	var mage_skill := AP_GetSkill(mage, MAGERY);
 	var defense := AP_GetSkill(targ, RESISTING_SPELLS);
 
@@ -100,21 +207,23 @@
 	return effect_level;
 endfunction
 
-function GetSpellWords(spell_name)
-	var cfg := ReadConfigFile(":magic:configs/spell_info");
-	if ( cfg.errortext )
-		return "Error - GetSpellWords(). Unable to open :magic:configs/spell_info.cfg ->"+cfg.errortext;
-	endif
-	
-	cfg := cfg[spell_name];
-	if ( cfg.errortext )
-		return "Error - GetSpellWords(). Unable to find elem ["+spell_name+"] ->"+cfg.errortext;
-	endif
-	
-	return cfg.SpellWords;
-endfunction
-
+/*
+ * MS_ReleaseScript(pid)
+ *
+ * Purpose
+ * Informs the spell starter that the caster can cast another spell.
+ * This allows the spell script to continue running without blocking future castings.
+ *
+ * Parameters
+ * pid:	PId to the spell starter that started the spell.
+ *
+ * Return value
+ * Returns 1
+ *
+ */
 function ReleaseScript(pid)
 	var process := GetProcess(pid);
 	process.SendEvent("done");
+	
+	return 1;
 endfunction

Modified: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-03 14:42:53 UTC (rev 880)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-03 15:09:26 UTC (rev 881)
@@ -1,3 +1,8 @@
+/*
+ * $Id$
+ *
+ */
+
 use uo;
 use os;
 use cfgfile;
@@ -3,8 +8,9 @@
 
 include ":attributes:attributes";
+include ":magery:spells";
 include "include/client";
-include ":magery:spells";
 include "include/string";
 
+
 set_script_option(SCRIPTOPT_CAN_ACCESS_OFFLINE_MOBILES, 1);
 
@@ -38,7 +44,7 @@
 	var attribute		:= spell_info.Attribute;
 	var delay		:= spell_info.BaseDelay;
 	var difficulty		:= spell_info.Difficulty;
-	var mana		:= spell_info.ManaCost;
+	var mana_cost		:= spell_info.ManaCost;
 	if ( !attribute )
 		attribute := "Magery";
 	endif
@@ -59,7 +65,7 @@
 	elseif ( who.squelched && !who.npctemplate )
 		SendSysMessage(who, "Something prevents you from casting.");
 		FailSpell(who);
-	elseif ( !UseMana(who, mana) )
+	elseif ( !ConsumeVital(who, MANA, mana_cost) )
 		SendSysMessage(who, "You are too tired to cast.");
 		FailSpell(who);
 	elseif ( !CheckRegs(who, spell_info) )
@@ -120,7 +126,7 @@
 	endif
 	var script := start_script("movementCheck", {who, GetPid(), my_x, my_y});
 	
-	SpellDebug(who, "Cast delay ->"+delay);
+	MS_SpellDebug(who, "Cast delay ->"+delay);
 	
 	sleepms(delay);
 	



From austin at berlios.de  Thu Nov  3 16:29:00 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 16:29:00 +0100
Subject: [Poldistro-svn] r882 - trunk/096/pkg/items/magic
Message-ID: <200511031529.jA3FT0PF004790@sheep.berlios.de>

Author: austin
Date: 2005-11-03 16:29:00 +0100 (Thu, 03 Nov 2005)
New Revision: 882

Modified:
   trunk/096/pkg/items/magic/itemdesc.cfg
Log:
Moved to the magery package.

Modified: trunk/096/pkg/items/magic/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/magic/itemdesc.cfg	2005-11-03 15:09:26 UTC (rev 881)
+++ trunk/096/pkg/items/magic/itemdesc.cfg	2005-11-03 15:29:00 UTC (rev 882)
@@ -1,640 +0,0 @@
-Item 0x1f2d
-{
-    Name           reactivearmorscroll
-    Desc           Reactive Armor scroll
-    Script         scroll
-    Spellid        7
-    VendorBuysFor  6
-    VendorSellsFor 12
-    Tooltip        Doubleclick to cast a spell, or use Inscription to add this spell to a spellbook
-}
-
-Item 0x1f2e
-{
-    Name           clumsyscroll
-    Desc           Clumsy scroll
-    Script         scroll
-    Spellid        1
-    VendorBuysFor  6
-    VendorSellsFor 12
-}
-
-Item 0x1f2f
-{
-    Name           createfoodscroll
-    Desc           Create Food scroll
-    Script         scroll
-    Spellid        2
-    VendorBuysFor  6
-    VendorSellsFor 12
-}
-
-Item 0x1f30
-{
-    Name           feeblemindscroll
-    Desc           Feeblemind scroll
-    Script         scroll
-    Spellid        3
-    VendorBuysFor  6
-    VendorSellsFor 12
-}
-
-Item 0x1f31
-{
-    Name           healscroll
-    Desc           Heal scroll
-    Script         scroll
-    Spellid        4
-    VendorBuysFor  6
-    VendorSellsFor 12
-}
-
-Item 0x1f32
-{
-    Name           magicarrowscroll
-    Desc           Magic Arrow scroll
-    Script         scroll
-    Spellid        5
-    VendorBuysFor  6
-    VendorSellsFor 12
-}
-
-Item 0x1f33
-{
-    Name           nightsightscroll
-    Desc           Nightsight scroll
-    Script         scroll
-    Spellid        6
-    VendorBuysFor  6
-    VendorSellsFor 12
-}
-
-Item 0x1f34
-{
-    Name           weakenscroll
-    Desc           Weaken scroll
-    Script         scroll
-    Spellid        8
-    VendorBuysFor  6
-    VendorSellsFor 12
-}
-
-Item 0x1f35
-{
-    Name           agilityscroll
-    Desc           Agility scroll
-    Script         scroll
-    Spellid        9
-    VendorBuysFor  11
-    VendorSellsFor 22
-}
-
-Item 0x1f36
-{
-    Name           cunningscroll
-    Desc           Cunning scroll
-    Script         scroll
-    Spellid        10
-    VendorBuysFor  11
-    VendorSellsFor 22
-}
-
-Item 0x1f37
-{
-    Name           curescroll
-    Desc           Cure scroll
-    Script         scroll
-    Spellid        11
-    VendorBuysFor  11
-    VendorSellsFor 22
-}
-
-Item 0x1f38
-{
-    Name           harmscroll
-    Desc           Harm scroll
-    Script         scroll
-    Spellid        12
-    VendorBuysFor  11
-    VendorSellsFor 22
-}
-
-Item 0x1f39
-{
-    Name           magictrapscroll
-    Desc           Magic Trap scroll
-    Script         scroll
-    Spellid        13
-    VendorBuysFor  11
-    VendorSellsFor 22
-}
-
-Item 0x1f3a
-{
-    Name           magicuntrapscroll
-    Desc           Magic Untrap scroll
-    Script         scroll
-    Spellid        14
-    VendorBuysFor  11
-    VendorSellsFor 22
-}
-
-Item 0x1f3b
-{
-    Name           protectionscroll
-    Desc           Protection scroll
-    Script         scroll
-    Spellid        15
-    VendorBuysFor  11
-    VendorSellsFor 22
-}
-
-Item 0x1f3c
-{
-    Name           strengthscroll
-    Desc           Strength scroll
-    Script         scroll
-    Spellid        16
-    VendorBuysFor  11
-    VendorSellsFor 22
-}
-
-Item 0x1f3d
-{
-    Name           blessscroll
-    Desc           Bless scroll
-    Script         scroll
-    Spellid        17
-    VendorBuysFor  16
-    VendorSellsFor 32
-}
-
-Item 0x1f3e
-{
-    Name           fireballscroll
-    Desc           Fireball scroll
-    Script         scroll
-    Spellid        18
-    VendorBuysFor  16
-    VendorSellsFor 32
-}
-
-Item 0x1f3f
-{
-    Name           magiclockscroll
-    Desc           Magic Lock scroll
-    Script         scroll
-    Spellid        19
-    VendorBuysFor  16
-    VendorSellsFor 32
-}
-
-Item 0x1f40
-{
-    Name           poisonscroll
-    Desc           Poison scroll
-    Script         scroll
-    Spellid        20
-    VendorBuysFor  16
-    VendorSellsFor 32
-}
-
-Item 0x1f41
-{
-    Name           telekinesisscroll
-    Desc           Telekinesis scroll
-    Script         scroll
-    Spellid        21
-    VendorBuysFor  16
-    VendorSellsFor 32
-}
-
-Item 0x1f42
-{
-    Name           teleportscroll
-    Desc           Teleport scroll
-    Script         scroll
-    Spellid        22
-    VendorBuysFor  16
-    VendorSellsFor 32
-}
-
-Item 0x1f43
-{
-    Name           magicunlockscroll
-    Desc           Magic Unlock scroll
-    Script         scroll
-    Spellid        23
-    VendorBuysFor  16
-    VendorSellsFor 32
-}
-
-Item 0x1f44
-{
-    Name           wallofstonescroll
-    Desc           Wall of Stone scroll
-    Script         scroll
-    Spellid        24
-    VendorBuysFor  16
-    VendorSellsFor 32
-}
-
-Item 0x1f45
-{
-    Name           archcurescroll
-    Desc           Archcure scroll
-    Script         scroll
-    Spellid        25
-    VendorBuysFor  21
-    VendorSellsFor 42
-}
-
-Item 0x1f46
-{
-    Name           archprotectionscroll
-    Desc           Archprotection scroll
-    Script         scroll
-    Spellid        26
-    VendorBuysFor  21
-    VendorSellsFor 42
-}
-
-Item 0x1f47
-{
-    Name           cursecroll
-    Desc           Curse scroll
-    Script         scroll
-    Spellid        27
-    VendorBuysFor  21
-    VendorSellsFor 42
-}
-
-Item 0x1f48
-{
-    Name           firefieldscroll
-    Desc           Firefield scroll
-    Script         scroll
-    Spellid        28
-    VendorBuysFor  21
-    VendorSellsFor 42
-}
-
-Item 0x1f49
-{
-    Name           greaterhealscroll
-    Desc           Greater Heal scroll
-    Script         scroll
-    Spellid        29
-    VendorBuysFor  21
-    VendorSellsFor 42
-}
-
-Item 0x1f4a
-{
-    Name           lightningscroll
-    Desc           Lightning scroll
-    Script         scroll
-    Spellid        30
-    VendorBuysFor  21
-    VendorSellsFor 42
-}
-
-Item 0x1f4b
-{
-    Name           manadrainscroll
-    Desc           Manadrain scroll
-    Script         scroll
-    Spellid        31
-    VendorBuysFor  21
-    VendorSellsFor 42
-}
-
-Item 0x1f4c
-{
-    Name           recallscroll
-    Desc           Recall scroll
-    Script         scroll
-    Spellid        32
-    VendorBuysFor  21
-    VendorSellsFor 42
-}
-
-Item 0x1f4d
-{
-    Name           bladespiritscroll
-    Desc           Blade Spirit scroll
-    Script         scroll
-    Spellid        33
-    VendorBuysFor  26
-    VendorSellsFor 52
-}
-
-Item 0x1f4e
-{
-    Name           dispelfieldscroll
-    Desc           Dispel Field scroll
-    Script         scroll
-    Spellid        34
-    VendorBuysFor  26
-    VendorSellsFor 52
-}
-
-Item 0x1f4f
-{
-    Name           incognitoscroll
-    Desc           Incognito scroll
-    Script         scroll
-    Spellid        35
-    VendorBuysFor  26
-    VendorSellsFor 52
-}
-
-Item 0x1f50
-{
-    Name           magicrelfectscroll
-    Desc           Magic Reflect scroll
-    Script         scroll
-    Spellid        36
-    VendorBuysFor  26
-    VendorSellsFor 52
-}
-
-Item 0x1f51
-{
-    Name           mindblastscroll
-    Desc           Mind Blast scroll
-    Script         scroll
-    Spellid        37
-    VendorBuysFor  26
-    VendorSellsFor 52
-}
-
-Item 0x1f52
-{
-    Name           paralyzescroll
-    Desc           Paralyze scroll
-    Script         scroll
-    Spellid        38
-    VendorBuysFor  26
-    VendorSellsFor 52
-}
-
-Item 0x1f53
-{
-    Name           poisonfieldscroll
-    Desc           Poison Field scroll
-    Script         scroll
-    Spellid        39
-    VendorBuysFor  26
-    VendorSellsFor 52
-}
-
-Item 0x1f54
-{
-    Name           summoncreaturescroll
-    Desc           Summon Creature scroll
-    Script         scroll
-    Spellid        40
-    VendorBuysFor  26
-    VendorSellsFor 52
-}
-
-Item 0x1f55
-{
-    Name           dispelscroll
-    Desc           Dispel scroll
-    Script         scroll
-    Spellid        41
-    VendorBuysFor  31
-    VendorSellsFor 62
-}
-
-Item 0x1f56
-{
-    Name           energyboltscroll
-    Desc           Energy Bolt scroll
-    Script         scroll
-    Spellid        42
-    VendorBuysFor  31
-    VendorSellsFor 62
-}
-
-Item 0x1f57
-{
-    Name           explosionscroll
-    Desc           Explosion scroll
-    Script         scroll
-    Spellid        43
-    VendorBuysFor  31
-    VendorSellsFor 62
-}
-
-Item 0x1f58
-{
-    Name           invisibilityscroll
-    Desc           Invisibility scroll
-    Script         scroll
-    Spellid        44
-    VendorBuysFor  31
-    VendorSellsFor 62
-}
-
-Item 0x1f59
-{
-    Name           markscroll
-    Desc           Mark scroll
-    Script         scroll
-    Spellid        45
-    VendorBuysFor  31
-    VendorSellsFor 62
-}
-
-Item 0x1f5a
-{
-    Name           masscursescroll
-    Desc           Mass Curse scroll
-    Script         scroll
-    Spellid        46
-    VendorBuysFor  31
-    VendorSellsFor 62
-}
-
-Item 0x1f5b
-{
-    Name           paralyzefieldscroll
-    Desc           Paralyze Field scroll
-    Script         scroll
-    Spellid        47
-    VendorBuysFor  31
-    VendorSellsFor 62
-}
-
-Item 0x1f5c
-{
-    Name           revealscroll
-    Desc           Reveal scroll
-    Script         scroll
-    Spellid        48
-    VendorBuysFor  31
-    VendorSellsFor 62
-}
-
-Item 0x1f5d
-{
-    Name           chainlightningscroll
-    Desc           Chain Lightning scroll
-    Script         scroll
-    Spellid        49
-    VendorBuysFor  36
-    VendorSellsFor 72
-}
-
-Item 0x1f5e
-{
-    Name           energyfieldscroll
-    Desc           Energy Field scroll
-    Script         scroll
-    Spellid        50
-    VendorBuysFor  36
-    VendorSellsFor 72
-}
-
-Item 0x1f5f
-{
-    Name           flamestrikescroll
-    Desc           Flamestrike scroll
-    Script         scroll
-    Spellid        51
-    VendorBuysFor  36
-    VendorSellsFor 72
-}
-
-Item 0x1f60
-{
-    Name           gatetravelscroll
-    Desc           Gate Travel scroll
-    Script         scroll
-    Spellid        52
-    VendorBuysFor  36
-    VendorSellsFor 72
-}
-
-Item 0x1f61
-{
-    Name           manavampirescroll
-    Desc           Mana Vampire scroll
-    Script         scroll
-    Spellid        53
-    VendorBuysFor  36
-    VendorSellsFor 72
-}
-
-Item 0x1f62
-{
-    Name           massdispelscroll
-    Desc           Mass Dispel scroll
-    Script         scroll
-    Spellid        54
-    VendorBuysFor  36
-    VendorSellsFor 72
-}
-
-Item 0x1f63
-{
-    Name           meteorswarmscroll
-    Desc           Meteor Swarm scroll
-    Script         scroll
-    Spellid        55
-    VendorBuysFor  36
-    VendorSellsFor 72
-}
-
-Item 0x1f64
-{
-    Name           polymorphscroll
-    Desc           Polymorph scroll
-    Script         scroll
-    Spellid        56
-    VendorBuysFor  36
-    VendorSellsFor 72
-}
-
-Item 0x1f65
-{
-    Name           earthquakescroll
-    Desc           Earthquake scroll
-    Script         scroll
-    Spellid        57
-    VendorBuysFor  41
-    VendorSellsFor 82
-}
-
-Item 0x1f66
-{
-    Name           energyvortexscroll
-    Desc           Energy Vortex scroll
-    Script         scroll
-    Spellid        58
-    VendorBuysFor  41
-    VendorSellsFor 82
-}
-
-Item 0x1f67
-{
-    Name           resurrectionscroll
-    Desc           Resurrection scroll
-    Script         scroll
-    Spellid        59
-    VendorBuysFor  41
-    VendorSellsFor 82
-}
-
-Item 0x1f68
-{
-    Name           summonairelemscroll
-    Desc           Summon Air Elemental scroll
-    Script         scroll
-    Spellid        60
-    VendorBuysFor  41
-    VendorSellsFor 82
-}
-
-Item 0x1f69
-{
-    Name           summondaemonscroll
-    Desc           Summon Daemon scroll
-    Script         scroll
-    Spellid        61
-    VendorBuysFor  41
-    VendorSellsFor 82
-}
-
-Item 0x1f6a
-{
-    Name           summonearthelemscroll
-    Desc           Summon Earth Elemental scroll
-    Script         scroll
-    Spellid        62
-    VendorBuysFor  41
-    VendorSellsFor 82
-}
-
-Item 0x1f6b
-{
-    Name           summonfireelemscroll
-    Desc           Summon Fire Elemental scroll
-    Script         scroll
-    Spellid        63
-    VendorBuysFor  41
-    VendorSellsFor 82
-}
-
-Item 0x1f6c
-{
-    Name           summonwaterelemscroll
-    Desc           Summon Water Elemental scroll
-    Script         scroll
-    Spellid        64
-    VendorBuysFor  41
-    VendorSellsFor 82
-}
\ No newline at end of file



From austin at berlios.de  Thu Nov  3 16:30:37 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Thu, 3 Nov 2005 16:30:37 +0100
Subject: [Poldistro-svn] r883 - in trunk/096/pkg/skills/magery: . spellScroll
Message-ID: <200511031530.jA3FUbCO004899@sheep.berlios.de>

Author: austin
Date: 2005-11-03 16:30:37 +0100 (Thu, 03 Nov 2005)
New Revision: 883

Added:
   trunk/096/pkg/skills/magery/spellScroll/
   trunk/096/pkg/skills/magery/spellScroll/use.src
Modified:
   trunk/096/pkg/skills/magery/itemdesc.cfg
   trunk/096/pkg/skills/magery/spellStarter.src
Log:
Spell scrolls will work with the spell starter.
Itll consume the scroll rather than reagents.

Modified: trunk/096/pkg/skills/magery/itemdesc.cfg
===================================================================
--- trunk/096/pkg/skills/magery/itemdesc.cfg	2005-11-03 15:29:00 UTC (rev 882)
+++ trunk/096/pkg/skills/magery/itemdesc.cfg	2005-11-03 15:30:37 UTC (rev 883)
@@ -1,3 +1,9 @@
+#
+# $Id$
+#
+#
+
+//--=[ SPELL BOOKS ]=-------------------------
 Spellbook 0xEFA
 {
 	Name			Spellbook
@@ -23,3 +29,835 @@
 	CanRemoveScript		:containers:container/noRemove
 }
 
+//--=[ MAGERY SCROLLS ]=-------------------------
+Item 0x1f2d
+{
+	Name			reactivearmorscroll
+	Desc			Reactive Armor scroll
+	
+	SpellId			7
+	
+	VendorBuysFor		6
+	VendorSellsFor		12
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f2e
+{
+	Name			clumsyscroll
+	Desc			Clumsy scroll
+	
+	SpellId			1
+	
+	VendorBuysFor		6
+	VendorSellsFor		12
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f2f
+{
+	Name			createfoodscroll
+	Desc			Create Food scroll
+	
+	SpellId			2
+	
+	VendorBuysFor		6
+	VendorSellsFor		12
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f30
+{
+	Name			feeblemindscroll
+	Desc			Feeblemind scroll
+	
+	SpellId			3
+	
+	VendorBuysFor		6
+	VendorSellsFor		12
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f31
+{
+	Name			healscroll
+	Desc			Heal scroll
+	
+	SpellId			4
+	
+	VendorBuysFor		6
+	VendorSellsFor		12
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f32
+{
+	Name			magicarrowscroll
+	Desc			Magic Arrow scroll
+	
+	SpellId			5
+	
+	VendorBuysFor		6
+	VendorSellsFor		12
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f33
+{
+	Name			nightsightscroll
+	Desc			Nightsight scroll
+	
+	SpellId			6
+	
+	VendorBuysFor		6
+	VendorSellsFor		12
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f34
+{
+	Name			weakenscroll
+	Desc			Weaken scroll
+	
+	SpellId			8
+	
+	VendorBuysFor		6
+	VendorSellsFor		12
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f35
+{
+	Name			agilityscroll
+	Desc			Agility scroll
+	
+	SpellId			9
+	
+	VendorBuysFor		11
+	VendorSellsFor		22
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f36
+{
+	Name			cunningscroll
+	Desc			Cunning scroll
+	
+	SpellId			10
+	
+	VendorBuysFor		11
+	VendorSellsFor		22
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f37
+{
+	Name			curescroll
+	Desc			Cure scroll
+	
+	SpellId			11
+	
+	VendorBuysFor		11
+	VendorSellsFor		22
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f38
+{
+	Name			harmscroll
+	Desc			Harm scroll
+	
+	SpellId			12
+	
+	VendorBuysFor		11
+	VendorSellsFor		22
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f39
+{
+	Name			magictrapscroll
+	Desc			Magic Trap scroll
+	
+	SpellId			13
+	
+	VendorBuysFor		11
+	VendorSellsFor		22
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f3a
+{
+	Name			magicuntrapscroll
+	Desc			Magic Untrap scroll
+	
+	SpellId			14
+	
+	VendorBuysFor		11
+	VendorSellsFor		22
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f3b
+{
+	Name			protectionscroll
+	Desc			Protection scroll
+	
+	SpellId			15
+	
+	VendorBuysFor		11
+	VendorSellsFor		22
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f3c
+{
+	Name			strengthscroll
+	Desc			Strength scroll
+	
+	SpellId			16
+	
+	VendorBuysFor		11
+	VendorSellsFor		22
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f3d
+{
+	Name			blessscroll
+	Desc			Bless scroll
+	
+	SpellId			17
+	
+	VendorBuysFor		16
+	VendorSellsFor		32
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f3e
+{
+	Name			fireballscroll
+	Desc			Fireball scroll
+	
+	SpellId			18
+	
+	VendorBuysFor		16
+	VendorSellsFor		32
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f3f
+{
+	Name			magiclockscroll
+	Desc			Magic Lock scroll
+	
+	SpellId			19
+	
+	VendorBuysFor		16
+	VendorSellsFor		32
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f40
+{
+	Name			poisonscroll
+	Desc			Poison scroll
+	
+	SpellId			20
+	
+	VendorBuysFor		16
+	VendorSellsFor		32
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f41
+{
+	Name			telekinesisscroll
+	Desc			Telekinesis scroll
+	
+	SpellId			21
+	
+	VendorBuysFor		16
+	VendorSellsFor		32
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f42
+{
+	Name			teleportscroll
+	Desc			Teleport scroll
+	
+	SpellId			22
+	
+	VendorBuysFor		16
+	VendorSellsFor		32
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f43
+{
+	Name			magicunlockscroll
+	Desc			Magic Unlock scroll
+	
+	SpellId			23
+	
+	VendorBuysFor		16
+	VendorSellsFor		32
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f44
+{
+	Name			wallofstonescroll
+	Desc			Wall of Stone scroll
+	
+	SpellId			24
+	
+	VendorBuysFor		16
+	VendorSellsFor		32
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f45
+{
+	Name			archcurescroll
+	Desc			Archcure scroll
+	
+	SpellId			25
+	
+	VendorBuysFor		21
+	VendorSellsFor		42
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f46
+{
+	Name			archprotectionscroll
+	Desc			Archprotection scroll
+	
+	SpellId			26
+	
+	VendorBuysFor		21
+	VendorSellsFor		42
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f47
+{
+	Name			cursecroll
+	Desc			Curse scroll
+	
+	SpellId			27
+	
+	VendorBuysFor		21
+	VendorSellsFor		42
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f48
+{
+	Name			firefieldscroll
+	Desc			Firefield scroll
+	
+	SpellId			28
+	
+	VendorBuysFor		21
+	VendorSellsFor		42
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f49
+{
+	Name			greaterhealscroll
+	Desc			Greater Heal scroll
+	
+	SpellId			29
+	
+	VendorBuysFor		21
+	VendorSellsFor		42
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f4a
+{
+	Name			lightningscroll
+	Desc			Lightning scroll
+	
+	SpellId			30
+	
+	VendorBuysFor		21
+	VendorSellsFor		42
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f4b
+{
+	Name			manadrainscroll
+	Desc			Manadrain scroll
+	
+	SpellId			31
+	
+	VendorBuysFor		21
+	VendorSellsFor		42
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f4c
+{
+	Name			recallscroll
+	Desc			Recall scroll
+	
+	SpellId			32
+	
+	VendorBuysFor		21
+	VendorSellsFor		42
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f4d
+{
+	Name			bladespiritscroll
+	Desc			Blade Spirit scroll
+	
+	SpellId			33
+	
+	VendorBuysFor		26
+	VendorSellsFor		52
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f4e
+{
+	Name			dispelfieldscroll
+	Desc			Dispel Field scroll
+	
+	SpellId			34
+	
+	VendorBuysFor		26
+	VendorSellsFor		52
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f4f
+{
+	Name			incognitoscroll
+	Desc			Incognito scroll
+	
+	SpellId			35
+	
+	VendorBuysFor		26
+	VendorSellsFor		52
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f50
+{
+	Name			magicrelfectscroll
+	Desc			Magic Reflect scroll
+	
+	SpellId			36
+	
+	VendorBuysFor		26
+	VendorSellsFor		52
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f51
+{
+	Name			mindblastscroll
+	Desc			Mind Blast scroll
+	
+	SpellId			37
+	
+	VendorBuysFor		26
+	VendorSellsFor		52
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f52
+{
+	Name			paralyzescroll
+	Desc			Paralyze scroll
+	
+	SpellId			38
+	
+	VendorBuysFor		26
+	VendorSellsFor		52
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f53
+{
+	Name			poisonfieldscroll
+	Desc			Poison Field scroll
+	
+	SpellId			39
+	
+	VendorBuysFor		26
+	VendorSellsFor		52
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f54
+{
+	Name			summoncreaturescroll
+	Desc			Summon Creature scroll
+	
+	SpellId			40
+	
+	VendorBuysFor		26
+	VendorSellsFor		52
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f55
+{
+	Name			dispelscroll
+	Desc			Dispel scroll
+	
+	SpellId			41
+	
+	VendorBuysFor		31
+	VendorSellsFor		62
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f56
+{
+	Name			energyboltscroll
+	Desc			Energy Bolt scroll
+	
+	SpellId			42
+	
+	VendorBuysFor		31
+	VendorSellsFor		62
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f57
+{
+	Name			explosionscroll
+	Desc			Explosion scroll
+	
+	SpellId			43
+	
+	VendorBuysFor		31
+	VendorSellsFor		62
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f58
+{
+	Name			invisibilityscroll
+	Desc			Invisibility scroll
+	
+	SpellId			44
+	
+	VendorBuysFor		31
+	VendorSellsFor		62
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f59
+{
+	Name			markscroll
+	Desc			Mark scroll
+	
+	SpellId			45
+	
+	VendorBuysFor		31
+	VendorSellsFor		62
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f5a
+{
+	Name			masscursescroll
+	Desc			Mass Curse scroll
+	
+	SpellId			46
+	
+	VendorBuysFor		31
+	VendorSellsFor		62
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f5b
+{
+	Name			paralyzefieldscroll
+	Desc			Paralyze Field scroll
+	
+	SpellId			47
+	
+	VendorBuysFor		31
+	VendorSellsFor		62
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f5c
+{
+	Name			revealscroll
+	Desc			Reveal scroll
+	
+	SpellId			48
+	
+	VendorBuysFor		31
+	VendorSellsFor		62
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f5d
+{
+	Name			chainlightningscroll
+	Desc			Chain Lightning scroll
+	
+	SpellId			49
+	
+	VendorBuysFor		36
+	VendorSellsFor		72
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f5e
+{
+	Name			energyfieldscroll
+	Desc			Energy Field scroll
+	
+	SpellId			50
+	
+	VendorBuysFor		36
+	VendorSellsFor		72
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f5f
+{
+	Name			flamestrikescroll
+	Desc			Flamestrike scroll
+	
+	SpellId			51
+	
+	VendorBuysFor		36
+	VendorSellsFor		72
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f60
+{
+	Name			gatetravelscroll
+	Desc			Gate Travel scroll
+	
+	SpellId			52
+	
+	VendorBuysFor		36
+	VendorSellsFor		72
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f61
+{
+	Name			manavampirescroll
+	Desc			Mana Vampire scroll
+	
+	SpellId			53
+	
+	VendorBuysFor		36
+	VendorSellsFor		72
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f62
+{
+	Name			massdispelscroll
+	Desc			Mass Dispel scroll
+	
+	SpellId			54
+	
+	VendorBuysFor		36
+	VendorSellsFor		72
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f63
+{
+	Name			meteorswarmscroll
+	Desc			Meteor Swarm scroll
+	
+	SpellId			55
+	
+	VendorBuysFor		36
+	VendorSellsFor		72
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f64
+{
+	Name			polymorphscroll
+	Desc			Polymorph scroll
+	
+	SpellId			56
+	
+	VendorBuysFor		36
+	VendorSellsFor		72
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f65
+{
+	Name			earthquakescroll
+	Desc			Earthquake scroll
+	
+	SpellId			57
+	
+	VendorBuysFor		41
+	VendorSellsFor		82
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f66
+{
+	Name			energyvortexscroll
+	Desc			Energy Vortex scroll
+	
+	SpellId			58
+	
+	VendorBuysFor		41
+	VendorSellsFor		82
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f67
+{
+	Name			resurrectionscroll
+	Desc			Resurrection scroll
+	
+	SpellId			59
+	
+	VendorBuysFor		41
+	VendorSellsFor		82
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f68
+{
+	Name			summonairelemscroll
+	Desc			Summon Air Elemental scroll
+	
+	SpellId			60
+	
+	VendorBuysFor		41
+	VendorSellsFor		82
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f69
+{
+	Name			summondaemonscroll
+	Desc			Summon Daemon scroll
+	
+	SpellId			61
+	
+	VendorBuysFor		41
+	VendorSellsFor		82
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f6a
+{
+	Name			summonearthelemscroll
+	Desc			Summon Earth Elemental scroll
+	
+	SpellId			62
+	
+	VendorBuysFor		41
+	VendorSellsFor		82
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f6b
+{
+	Name			summonfireelemscroll
+	Desc			Summon Fire Elemental scroll
+	
+	SpellId			63
+	
+	VendorBuysFor		41
+	VendorSellsFor		82
+	
+	Script			spellScroll/use
+}
+
+Item 0x1f6c
+{
+	Name			summonwaterelemscroll
+	Desc			Summon Water Elemental scroll
+	
+	SpellId			64
+	
+	VendorBuysFor		41
+	VendorSellsFor		82
+	
+	Script			spellScroll/use
+}
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/spellScroll/use.src
===================================================================
--- trunk/096/pkg/skills/magery/spellScroll/use.src	2005-11-03 15:29:00 UTC (rev 882)
+++ trunk/096/pkg/skills/magery/spellScroll/use.src	2005-11-03 15:30:37 UTC (rev 883)
@@ -0,0 +1,23 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+use cfgfile;
+
+program useScroll(who, scroll)
+	var item_cfg := ReadConfigFile(":*:itemdesc");
+	item_cfg := item_cfg[scroll.objtype];
+	
+	var spell_id := item_cfg.SpellId;
+	
+	var script := Start_Script("spellStarter", {who, spell_id, scroll});
+	if ( script.errortext )
+		SendSysMessage(who, "Error - Could not start spell starter ->"+script.errortext);
+		return 0;
+	endif
+	
+	return 1;
+endprogram

Modified: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-03 15:29:00 UTC (rev 882)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-03 15:30:37 UTC (rev 883)
@@ -16,59 +16,51 @@
 set_script_option(SCRIPTOPT_CAN_ACCESS_OFFLINE_MOBILES, 1);
 
 program SpellStarter(params)
-	var who := params[1];
-	var words_of_power := params[2];
-	var parent_pid := params[3];
+	var who		:= params[1]; // Caster.
+	var spell_id	:= params[2]; // Id # of the spell.
+	var scroll	:= params[3]; // Scroll object being used.
+	var targ	:= params[4]; // NPC target
+	params := 0; // No longer needed
 	
 	Attach(who);
 	
-	//Remove trailing space
-	words_of_power := RemoveSpaces(words_of_power, CLR_LEADING_SPACES+CLR_DOUBLE_SPACES+CLR_TRAILING_SPACES);
-	
-	var spell_info := ReadConfigFile("configs/spell_info");
-	spell_info := spell_info[words_of_power];
+	var spell_elem := MS_GetSpellsCfgElem(spell_id);
 
 	// If spell is set to 'TestOnly 1', then it requires GM-cmdlevel or #TestSpell CProp
 	// before it can be used.
 	var can_cast := 1;
-	if ( spell_info.TestOnly && (!who.cmdlevel) )
+	if ( spell_elem.TestOnly && (!who.cmdlevel) )
 		// They need #TestSpell to cast it
 		if ( GetObjProperty(who, "#TestSpell") == error )
 			can_cast := 0;
 		endif
-	elseif ( spell_info.NPCOnly && !who.npctemplate )
+	elseif ( spell_elem.NPCOnly && !who.npctemplate )
 		PrintTextAbove(who, "Unable to cast - NPC only spell.");
 		return 0;
 	endif
 
-	var attribute		:= spell_info.Attribute;
-	var delay		:= spell_info.BaseDelay;
-	var difficulty		:= spell_info.Difficulty;
-	var mana_cost		:= spell_info.ManaCost;
+	var attribute		:= spell_elem.Attribute;
+	var delay		:= spell_elem.BaseDelay;
+	var difficulty		:= spell_elem.Difficulty;
+	var mana_cost		:= spell_elem.ManaCost;
 	if ( !attribute )
 		attribute := "Magery";
 	endif
 
 	if ( GetObjProperty(who, "#medding") )
 		SendSysMessage(who, "You can not cast right now.");
-		return;
+		return 0;
 	else
 		SetObjProperty(who, "#medding", 1);
 	endif
 
-	if ( !spell_info || !can_cast )
-		SendSysMessage(who, "Your words seem to have no meaning.");
-		if ( who.npctemplate )
-			PrintTextAbove(who, "Your words seem to have no meaning.");
-		endif
-		FailSpell(who);
-	elseif ( who.squelched && !who.npctemplate )
+	if ( who.squelched && !who.npctemplate )
 		SendSysMessage(who, "Something prevents you from casting.");
 		FailSpell(who);
 	elseif ( !ConsumeVital(who, MANA, mana_cost) )
 		SendSysMessage(who, "You are too tired to cast.");
 		FailSpell(who);
-	elseif ( !CheckRegs(who, spell_info) )
+	elseif ( !CheckRegs(who, spell_elem, scroll) )
 		FailSpell(who);
 	elseif ( !EquipmentCheck(who) )
 		FailSpell(who);
@@ -79,16 +71,16 @@
 		var skill_check := SkillCheck(who, attribute, difficulty);
 		if ( skill_check > 0 )
 			var info := struct;
-			info.+script := spell_info.script;
-			info.+attribute := attribute;
-			info.+skill_check := skill_check;
-			info.+spell_words := words_of_power;
-			info.+target := params[4];
-			info.+pid := GetPid();
+			info.+script		:= spell_elem.script;
+			info.+attribute		:= attribute;
+			info.+skill_check	:= skill_check;
+			info.+targ		:= targ;
+			info.+pid		:= GetPid();
+			info.+spellId		:= spell_id;
 
-			var script := start_script(spell_info.script, {who, info});
+			var script := start_script(spell_elem.Script, {who, info});
 			if ( script.errortext )
-				PrintTextAbove(who, "Unable to start ["+spell_info.script+"] -> "+script.errortext);
+				PrintTextAbove(who, "Unable to start ["+spell_elem.script+"] -> "+script.errortext);
 				SendSysMessage(who, script.errortext);
 			endif
 
@@ -102,7 +94,6 @@
 	endif
 
 	EraseObjProperty(who, "#medding");
-	ReleaseScript(parent_pid);
 endprogram
 
 function CheckDelay(who, attribute, difficulty, base_delay)
@@ -175,15 +166,17 @@
 	return 1;
 endfunction
 
-function CheckRegs(who, byref spell_info)
+function CheckRegs(who, byref spell_elem, scroll)
 	if ( who.npctemplate )
 		// NPCs don't need reagents to cast.
 		return 1;
+	elseif ( scroll )
+		return SubtractAmount(scroll, 1);
 	endif
 	
 	var reg_list := dictionary;
 
-	foreach line in GetConfigStringArray(spell_info, "Reagent")
+	foreach line in GetConfigStringArray(spell_elem, "Reagent")
 		line := SplitWords(line);
 		var objtype := GetObjTypeByName(line[1]);
 		var amount := CInt(line[2]);



From austin at berlios.de  Fri Nov  4 01:15:12 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Fri, 4 Nov 2005 01:15:12 +0100
Subject: [Poldistro-svn] r884 - trunk/096/pkg/mobiles/brainAI
Message-ID: <200511040015.jA40FCuf031562@sheep.berlios.de>

Author: austin
Date: 2005-11-04 01:14:35 +0100 (Fri, 04 Nov 2005)
New Revision: 884

Modified:
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
Log:
Updated to NPC format

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-03 15:30:37 UTC (rev 883)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-04 00:14:35 UTC (rev 884)
@@ -3,6 +3,7 @@
 #
 NPCTemplate ExampleNPC
 {
+	// Primary NPC information
 	Name		<Example NPC>
 	Script		:brainAI:brain
 	ObjType		0x190
@@ -22,17 +23,22 @@
 	HITS		100
 	MANA		1
 	STAM		100
-
+	
+	// Intrinsic Weapon
+	AttackHitScript	:combat:mainHitScript
+	
+	// Brain AI Settings
+	AISetting	AreaSize	i5
 	AISetting	CycleWait	i10
+	AISetting	DblClickRange	i10
 	AISetting	FleeLevel	i50 // 50%
+	AISetting	HearGhosts	i1
+	AISetting	HearSpeech	i1
 	AISetting	IdleTicks	i5
+	AISetting	ListenRange	i10
 	AISetting	SleepWait	i1000
-	AISetting	ListenRange	i10
-	AISetting	AreaSize	i5
-	AISetting	DblClickRange	i10
-	AISetting	HearSpeech	i1
-	AISetting	HearGhosts	i1
-
+	
+	// Brain AI Nerves
 	AIScript	Combat		:brainAI:complete/exampleNPC/combat
 	AIScript	Cycle		:brainAI:complete/exampleNPC/cycle
 	AIScript	DblClick	:brainAI:complete/exampleNPC/doubleClick
@@ -50,10 +56,17 @@
 	AIScript	ShouldWatch	:brainAI:complete/exampleNPC/shouldWatch
 	AIScript	Virtual		:brainAI:complete/exampleNPC/virtual
 	AIScript	EndFight	:brainAI:complete/exampleNPC/endFight
+	
+	// Skinning Info
+	
+	// Settings other scripts use...
+	
+	// CProps (eww!)
 }
 
 NPCTemplate Rigger
 {
+	// Primary NPC settings
 	Name			a rigger
 	Script			:brainAI:brain
 	ObjType			0x27
@@ -76,6 +89,7 @@
 	MANA			0
 	STAM			35
 
+	// Intrinsic weapon
 	AttackAttribute		Wrestling
 	AttackSpeed		20
 	AttackDamage		2d5
@@ -83,22 +97,36 @@
 	AttackMissSounds	a1:i569
 	DeathSounds		a1:i427
 	DamagedSounds		a1:i426
+	AttackHitScript		:combat:mainHitScript
 
+	// Brain AI Settings
+	AISetting	AreaSize	i10
+	AISetting	CycleWait	i10
+	AISetting	FleeLevel	i50 // 50%
+	AISetting	IdleTicks	i5
+	AISetting	SleepWait	i1000
+	
+	// Brain AI Nerves
 	AIScript	Combat		:brainAI:scripts/combat/rigger
 	AIScript	EnterArea	:brainAI:scripts/enterArea/generic
 	AIScript	LeftArea	:brainAI:scripts/leftArea/generic
 	AIScript	LookAround	:brainAI:scripts/lookAround/findAttackables
 	AIScript	Sleep		:brainAI:scripts/sleep/generic
 	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/targetPlayers
-
-	AttackHitScript		:combat:mainHitScript
+	
+	// Skinning Info
+	
+	// Settings other scripts use...
+	
+	// CProps (eww!)
 }
 
 ##########################################
 # Animals
 ##########################################
-NPCTemplate	cow
+NPCTemplate cow
 {
+	// Primary NPC settings
 	Name			a cow
 	Script			:brainAI:brain
 	ObjType			0xd8
@@ -106,17 +134,13 @@
 	TrueColor		0
 	Gender			0
 	RunSpeed		15
+	AR			9
 	Category		Animal
 
 	// Attributes
 	Strength		30
 	Intelligence		5
 	Dexterity		15
-	Anatomy			0.0
-	EvaluatingIntelligence	0.0
-	Magery			0.0
-	Meditation		0.0
-	Poisoning		0.0
 	ResistingSpells		5.5
 	Tactics			5.5
 	Wrestling		5.5
@@ -126,37 +150,28 @@
 	MANA			0
 	STAM			15
 
+	// Intrinsic Weapon
 	AttackAttribute		Wrestling
 	AttackSpeed		30
 	AttackDamage		1d4
+	AttackHitScript		:combat:mainHitScript
+	
+	// Sounds 
 	AttackHitSounds		a1:i123
 	AttackMissSounds	a1:i569
 	DeathSounds		a1:i125
 	DamagedSounds		a1:i124
-	IdleSounds		a2:i121i122		// Sounds stored in Packed Array form
+	IdleSounds		a2:i121i122
 
-	AR			9
-
-	food			veggie
-	foodtype		veggie
-	packinstinct		none
-
-	GuardIgnore		1
-	DStart			10
-	CorpseItm		rawribs hides
-	CorpseAmt		8 12
-	NoLoot			1
-
-	CProp  Karma		i0
-	CProp  Fame		i10
-
+	// Brain AI Settings
+	AISetting	AreaSize	i5
+	AISetting	CycleWait	i10
+	AISetting	DblClickRange	i1
 	AISetting	FleeLevel	i50 // 50%
-	AISetting	IdleTicks	i5
+	AISetting	IdleTicks	i2
 	AISetting	SleepWait	i1000
-	AISetting	ListenRange	i10
-	AISetting	AreaSize	i5
-	AISetting	DblClickRange	i1
 
+	// Brain AI Nerves
 	AIScript	Combat		:brainAI:scripts/combat/genericAnimal
 	AIScript	DblClick	:brainAI:scripts/doubleClick/cowTip
 	AIScript	EnterArea	:brainAI:scripts/enterArea/generic
@@ -165,66 +180,61 @@
 	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/watchFeared
 	AIScript	Sleep		:brainAI:scripts/sleep/generic
 	AIScript	EndFight	:brainAI:scripts/endFight/endFightAnimal
-
-	AttackHitScript		:combat:mainHitScript
+	
+	// Skinning Info
+	
+	// Settings other scripts use...
+	
+	// CProps (eww!)
 }
 
-NPCTemplate	sheep
+NPCTemplate sheep
 {
+	// Primary NPC Settings
 	Name			a sheep
 	Script			:brainAI:brain
-	ObjType			0xcf
+	ObjType			0xCF
 	Color			0
 	TrueColor		33784
 	Gender			0
 	runspeed		17
+	AR			8
 
+	// Attributes
 	Strength		19
 	Intelligence		5
 	Dexterity		25
-
+	ResistingSpells		5.0
+	Tactics			6.0
+	Wrestling		5.0
+	
+	// Vitals
 	HITS			12
 	MANA			0
 	STAM			25
-
-	Anatomy			0.0
-	EvaluatingIntelligence	0.0
-	Magery			0.0
-	Meditation		0.0
-	Poisoning		0.0
-	ResistingSpells		5.0
-	Tactics			6.0
-	Wrestling		5.0
-
+	
+	// Intrinsic Weapon
 	AttackSpeed		30
 	AttackDamage		1d2
 	AttackAttribute		Wrestling
+	AttackHitScript		:combat:mainHitScript
+	
+	// Sounds
 	AttackHitSounds		a1:i217
 	AttackMissSounds	a1:i569
 	DeathSounds		a1:i219
 	DamagedSounds		a1:i218
 	IdleSounds		a2:i215i216
 
-	AR			8
-
-	food			veggie
-	foodtype		veggie
-	packinstinct		none
-
-	GuardIgnore		1
-	DStart			10
-	CorpseItm		rawribs wool
-	CorpseAmt		3 3
-	NoLoot			1
-	CProp  Karma		i0
-	CProp  Fame		i1
-
+	// Brain AI Settings
+	AISetting	AreaSize	i5
+	AISetting	CycleWait	i5
 	AISetting	FleeLevel	i50 // 50%
-	AISetting	IdleTicks	i5
+	AISetting	IdleTicks	i2
+	AISetting	ListenRange	i7
 	AISetting	SleepWait	i1000
-	AISetting	ListenRange	i7
-	AISetting	AreaSize	i5
-
+	
+	// Brain AI Nerves
 	AIScript	Combat		:brainAI:scripts/combat/genericAnimal
 	AIScript	EnterArea	:brainAI:scripts/enterArea/generic
 	AIScript	LeftArea	:brainAI:scripts/leftArea/generic
@@ -233,5 +243,20 @@
 	AIScript	Sleep		:brainAI:scripts/sleep/generic
 	AIScript	EndFight	:brainAI:scripts/endFight/endFightAnimal
 
-	AttackHitScript		:combat:mainHitScript
+	// Skinning Info
+	// Skinning	ItemName	Amount
+	Skinning	RawRibs		3
+	Skinning	Wool		3
+
+	// Settings other scripts use...
+	Food			veggie
+	FoodType		veggie
+	PackInstinct		none
+	GuardIgnore		1
+	DStart			10
+	NoLoot			1
+	
+	// CProps (eww!)
+	CProp  Karma		i0
+	CProp  Fame		i1
 }
\ No newline at end of file



From austin at berlios.de  Fri Nov  4 01:35:55 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Fri, 4 Nov 2005 01:35:55 +0100
Subject: [Poldistro-svn] r885 - in trunk/096/pkg/skills/lumberjacking: include treeRegen
Message-ID: <200511040035.jA40ZtZs007564@sheep.berlios.de>

Author: austin
Date: 2005-11-04 01:35:53 +0100 (Fri, 04 Nov 2005)
New Revision: 885

Modified:
   trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc
   trunk/096/pkg/skills/lumberjacking/treeRegen/control.src
Log:
Added CInt() around the value to set wood.
Added 30 minute default cycle wait if none is set to the regeneration script.

Modified: trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc
===================================================================
--- trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc	2005-11-04 00:14:35 UTC (rev 884)
+++ trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc	2005-11-04 00:35:53 UTC (rev 885)
@@ -149,7 +149,7 @@
  * realm:	Name of the realm to set the wood type on.
  * x_pos:	X coordinate to set the wood type on.
  * y_pos:	Y coordinate to set the wood type on.
- * wood_type:	object type of the wood to set.
+ * wood_type:	object NAME of the wood to set.
  *
  * Return value
  * Returns 1
@@ -184,7 +184,7 @@
 	
 	var data_elem := LJ_GetDataElem(pos_string);
 	
-	data_elem.SetProp("Amount", amount);
+	data_elem.SetProp("Amount", CInt(amount));
 endfunction
 
 /*

Modified: trunk/096/pkg/skills/lumberjacking/treeRegen/control.src
===================================================================
--- trunk/096/pkg/skills/lumberjacking/treeRegen/control.src	2005-11-04 00:14:35 UTC (rev 884)
+++ trunk/096/pkg/skills/lumberjacking/treeRegen/control.src	2005-11-04 00:35:53 UTC (rev 885)
@@ -13,7 +13,7 @@
 	var settings := LJ_GetSettingsCfgElem("Settings");
 	var cycle_wait := CInt(settings.RegenWait);
 	if ( cycle_wait < 1 )
-		cycle_wait := 1;
+		cycle_wait := 30;
 	endif
 	cycle_wait := cycle_wait * 60;
 	



From austin at berlios.de  Fri Nov  4 03:21:14 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Fri, 4 Nov 2005 03:21:14 +0100
Subject: [Poldistro-svn] r887 - trunk/096/scripts/include/OLD
Message-ID: <200511040221.jA42LEUB018910@sheep.berlios.de>

Author: austin
Date: 2005-11-04 03:21:01 +0100 (Fri, 04 Nov 2005)
New Revision: 887

Added:
   trunk/096/scripts/include/OLD/math.inc
   trunk/096/scripts/include/OLD/properties.inc
Log:
Odd... tortoiseSVN didnt mark these for adding to /OLD

Added: trunk/096/scripts/include/OLD/math.inc
===================================================================
--- trunk/096/scripts/include/OLD/math.inc	2005-11-04 02:19:06 UTC (rev 886)
+++ trunk/096/scripts/include/OLD/math.inc	2005-11-04 02:21:01 UTC (rev 887)
@@ -0,0 +1,608 @@
+////////////////////////////////////////////////////////////
+////////////////////////////////////////////////////////////
+//
+//
+// math.inc
+//
+// Siggy's Improved Math Include, v2.0
+// Revision Date:  8/01/03
+//
+// Questions, comments, flames?   Send to:
+// EMail: cjtdennis at comcast.net
+// ICQ: 10520050
+//
+////////////////////////////////////////////////////////////
+////////////////////////////////////////////////////////////
+//
+// History:
+//
+// v2.0:
+//	- Added Min and Max functions.
+//	- Added Bounded function.
+//	- Added SplitLog function.
+// 
+// v1.5:
+//	- Factorial(x) now returns 1 if x==0.
+//	- Log(x, y) now uses Log10 instead of successive
+//	  approximation.
+//
+// v1.4:
+//	- Fixed errors in Mean and StdDev.
+//	- Minor code cleanup across include.
+//
+// v1.3:
+//	- Removed items duplicated in math.em.
+//
+////////////////////////////////////////////////////////////
+////////////////////////////////////////////////////////////
+
+use math;
+
+
+const CONST_E := 2.718282;
+const CONST_PI := 3.141592;
+
+
+
+function Log(b, x)
+
+// Finds the logarithm to base <b> of <x>.
+
+	if (x<=0)
+		return 0;
+	endif
+	return (Log10(x) / Log10(b));
+
+endfunction
+
+
+function SplitLog(x)
+// Returns array of {characteristic, mantissa} for x.
+// (If x==1.12345, the characteristic is "1", and the 
+// mantissa is (0.12345)
+
+	return { (CInt(x)), (x - CInt(x)) };
+endfunction
+
+
+function Bounded(x, i, y, inclusive := 1)
+// Checks to see if a number "i" falls between the two
+// bounds "x" and "y".  If inclusive is set to nonzero,
+// the function will return true if (i=x) || (i=y).
+	if (inclusive)
+		if ( (i >= Min({x, y})) && (i <= Max({x, y})) )
+			return 1;
+		else
+			return 0;
+		endif
+	else
+		if ( (i > Min({x, y})) && (i < Max({x, y})) )
+			return 1;
+		else
+			return 0;
+		endif
+	endif
+endfunction
+
+
+function Min(byref x)
+// returns the least value of array "x"
+	x.sort();
+	return x[1];
+endfunction
+
+
+function Max(byref x)
+// returns the greatest value of array "x"
+	x.sort();
+	return x[(len(x))];
+endfunction
+
+
+function Mod(Numerator, Denominator)
+
+// Returns the modulus of the fraction:
+//
+//		 Numerator
+//		-----------
+//		Denominator
+
+
+	return (Numerator - (CInt(Numerator/Denominator) * Denominator));
+	
+endfunction
+
+
+
+
+function Remainder(numerator, denominator)
+
+// Use this to get the remainder for non-integers.
+// Returns the remainder of the fraction:
+//
+//		 Numerator
+//		-----------
+//		Denominator
+
+	while (numerator >= denominator)
+		numerator := numerator - denominator;
+	endwhile
+
+	return numerator;
+
+endfunction
+
+
+function Trunc(number, places)
+
+// Truncates a dbl to a fixed amount of decimal places.
+
+	var base := Pow(10, places);
+
+	number := CDbl(CInt(number * Pow(10, places)));
+	number := number / base;
+
+	return number;
+
+endfunction
+
+
+function Fac(factorial);
+
+// Returns the factorial of a number:
+// Fac(10) = 10 * 9 * 8 * 7 * 6 * 5 * 4 * 3 * 2 * 1
+
+	factorial := CInt(factorial);
+	var x := 1
+
+	while (factorial > 0)
+		x := x * factorial;
+		factorial := factorial - 1;
+	endwhile
+	return x;
+
+endfunction
+
+
+function Exp(base, power)
+
+// Obsolete: math.em has Pow(b, p)
+
+	return Pow(base, power);
+
+endfunction
+
+
+function YRoot(x, y)
+
+// Returns the <y> root of a number <x>:
+	
+	var i := 0.000;
+	var n := 0.000;
+	var root := 2.000;
+	var a := CInt(Sqr(x));
+
+	if (a < 4)
+		a := 4;
+	endif
+
+	var success := 0;
+	while (!success)		
+		n := Pow(root, y);
+		i := x - n;
+		i := i / (a * root);
+		i := Trunc(i, 3);
+		root := root + i;
+		if (i = 0)
+			success := 1;
+			if ( Pow(Root, y) > x )
+				root := root - 0.001;
+			endif
+			if ( Pow((root + 0.001), y) = x)
+				root := root + 0.001;
+			endif
+		endif
+	endwhile
+
+	return root;
+
+endfunction
+
+
+function Inc(a)
+// Increments an integer by one.
+	return (a + 1);
+
+endfunction
+
+
+function Dec(a)
+// Decrements an integer by one.
+	return a - 1;
+
+endfunction
+
+
+function Mean(ArrayX)
+
+// Returns the arithmatic mean (average) of an array of numbers.
+
+	var n, i:=0.000;
+
+	foreach n in ArrayX
+		i := i + n;
+	endforeach
+
+	return (i / Len(ArrayX));
+
+endfunction
+
+
+function StdDev(ArrayX)
+// Returns the Standard Deviation of an array of numbers.
+
+	var m, n, i := 0.000;
+	var ArrayMean := Mean(ArrayX);
+	var ArrayLen := Len(ArrayX);
+
+	foreach m in ArrayX
+		n := m - ArrayMean;
+		n := Pow(n, 2);
+		i := i + n;
+	endforeach
+
+	i := i / (ArrayLen - 1);
+	n := Sqr (i);
+
+	return n;
+
+endfunction
+
+
+function ZTest(ArrayX, mu, sigma)
+// Returns the test statistic for a ZTest.   This is used to show
+// the likelihood that a sample is drawn from the population.  The 
+// mean and standard deviation for the population must be known.
+// The z-statistic is computed as follows:
+//
+//	z = (mean - mu) / (sigma / (Sqr(n))
+//
+// mean = the mean of the ArrayX data
+// mu = the mean of the entire population
+// sigma = the standard deviation of the population
+// n = the number of samples in the data
+
+	var i, n;
+	var z:= 0.000;
+	var ArrayMean := Mean(ArrayX);
+	var ArrayLen := Len(ArrayX);
+
+	i := ArrayMean - mu;
+	n := sigma / Sqr(ArrayLen);
+
+	z := i/n;
+
+	return := z;
+
+endfunction
+
+
+function TTest(ArrayX, mu)
+
+// Returns the test statistic for a TTest.   This is used to show
+// the likelihood that a sample is drawn from the population, when 
+// the mean and standard deviation for the entire population are
+// unknown.  The t-statistic is computed as follows:
+//
+//	t = (mean - mu) / (s / (Sqr(n))
+//
+// mean = the mean of the ArrayX data
+// mu = the estimated mean of the entire population
+// s = the standard deviation of the samples
+// n = the number of samples in the data
+
+
+	var i, n, s;
+	var t:= 0.000;
+	var ArrayMean := Mean(ArrayX);
+	var ArrayLen := Len(ArrayX);
+	var s := StdDev(ArrayX);
+
+	i := ArrayMean - mu;
+	n := s / Sqr(ArrayLen);
+
+	t := i/n;
+
+	return := t;
+
+endfunction
+
+
+
+//
+// BITWISE FUNCTIONS: These are very old, and not very efficient.
+// Use the standard $$, ||, etc. for bitwise comparisons.
+// Left intact to support any legacy code.
+
+
+function BitIn(ArrayX)
+
+// Takes an array of 8 bits and converts them into an integer.
+// This is used for the flag support.  IMPORTANT: bit positon is
+// *NOT* the same thing as the array position!   The first bit in 
+// the flag is the 8th bit in the array, and vice versa.  This is
+// because it processes the bit values in the following order:
+// 128, 64, 32, 16, 8, 4, 2, 1.
+
+	local i := 8;
+	local n;
+	local loop := 1;
+	local bitvalue := 0;
+
+	While (i >= 0)
+
+		n := 8 - i;
+		if (ArrayX[i] = 1)
+			bitvalue := bitvalue + Pow(2, n);
+		endif
+		i := i - 1;
+
+	endwhile
+
+	return bitvalue;
+
+endfunction
+
+
+function BitOut(x)
+
+// This function takes an unsigned, short integer (0-255) and returns
+// an array containing the individual bit values.   IMPORTANT: the 
+// first element of the array is NOT the first bit, it is the 8th
+// bit, and so on down.   See the desc for BitIn for the details.
+
+	x := Cint(x);
+	local loop := 1;
+	local bitvalue := 0;
+	local ArrayX := {0,0,0,0,0,0,0,0};
+	local n;
+
+	while (loop <= 8)
+
+		n := 8 - loop;
+		bitvalue := Pow(2, n);
+		if ( (x - bitvalue) >= 0)
+			ArrayX[loop] := 1;
+			x := x - bitvalue;
+		endif
+		loop := loop + 1;
+
+	endwhile
+
+	return ArrayX;
+
+endfunction
+
+
+function BitAnd(x, y)
+
+// Performs a bitwise logical conjunction for two unsigned, short
+// integers (0-255).  If both values for a position are set, then
+// that position in the result is set.   If either are reset, then
+// the position in the result is reset.
+
+	local ArrayX := BitOut(x);
+	local ArrayY := BitOut(y);
+	local z := 0;
+	local loop := 1;
+	local n;
+
+	while (loop <= 8)
+	
+		n := loop - 1;
+		if ( (ArrayX[loop] = 1) AND (ArrayY[loop] = 1) )
+			z := z + Pow(2, n);
+		endif
+		loop := loop + 1;
+
+	endwhile
+
+	return z;
+
+endfunction
+
+
+function BitOr(x, y)
+
+// Performs a bitwise logical disjunction for two unsigned, short
+// integers (0-255).  If either value (or both values) for a 
+// position are set, then that position in the result is set.   If 
+// both are reset, then the position in the result is reset.
+
+	local ArrayX := BitOut(x);
+	local ArrayY := BitOut(y);
+	local z := 0;
+	local loop := 1;
+	locan n;
+
+	while (loop <= 8)
+
+		n := loop - 1;
+		if ( (ArrayX[loop] = 1) OR (ArrayY[loop] = 1) )
+			z := z + Pow(2, n);
+		endif
+		loop := loop + 1;
+
+	endwhile
+
+	return z;
+
+endfunction
+
+
+function BitXor(x, y)
+
+// Performs a bitwise logical exclusion for two unsigned, short
+// integers (0-255).  If one and ONLY one value for a position is
+// set, then that position in the result is set.   If both are 
+// either set or reset, then the position in the result is reset.
+
+	local ArrayX := BitOut(x);
+	local ArrayY := BitOut(y);
+	local z := 0;
+	local loop := 1;
+	local n;
+
+	while (loop <= 8)
+
+		n := loop - 1;
+		if (ArrayX[loop] - ArrayY[loop] <> 0)
+			z := z + Pow(2, n);
+		endif
+		loop := loop + 1;
+
+	endwhile
+
+	return z;
+
+endfunction
+
+
+function BitEqv(x, y)
+
+// Performs a bitwise logical equivalence for two unsigned, short
+// integers (0-255).  If one and ONLY one value for a position is
+// set, then that position in the result is reset.   If both are 
+// either set or reset, then the position in the result is set.
+
+	local ArrayX := BitOut(x);
+	local ArrayY := BitOut(y);
+	local z := 0;
+	local loop := 1;
+	local n;
+
+	while (loop <= 8)
+
+		n := loop - 1;
+		if (ArrayX[loop] - ArrayY[loop] = 0)
+			z := z + Pow(2, n);
+		endif
+		loop := loop + 1;
+
+	endwhile
+
+	return z;
+
+endfunction
+
+
+function BitImp(x, y)
+
+// Performs a bitwise logical implication for two unsigned, short
+// integers (0-255).  If the a position in the first integer is set,
+// and the corresponding position for the second integer is reset,
+// then that position in the result is reset.  All other combinations
+// will result in the value being set.
+
+	local ArrayX := BitOut(x);
+	local ArrayY := BitOut(y);
+	local z := 0;
+	local loop := 1;
+	local n;
+
+	while (loop <= 8)
+
+		n := loop - 1;
+		if (ArrayX[loop] - ArrayY[loop] < 1)
+			z := z + Pow(2, n);
+		endif
+		loop := loop + 1;
+
+	endwhile
+
+	return z;
+
+endfunction
+
+
+function BitNot(x)
+
+// Performs a logical negation on a short, unsigned integer (0-255).
+// If a position in the integer is set, then that position in the
+// result is reset.  Conversely, if a position in the integer is 
+// reset, then that position in the result is set.
+
+	local ArrayX := BitOut(x);
+	local z := 0;
+	local loop := 1;
+	local n;
+
+	while (loop <= 8)
+
+		n := loop - 1;
+		if (ArrayX[loop] = 0)
+			ArrayX[loop] := 1;
+			z := z + Pow(2, n);
+		else
+			ArrayX[loop] := 0;
+		endif
+
+		loop := loop + 1;
+
+	endwhile
+
+	return z;
+
+endfunction
+
+
+function FlagSet(flag, bit);
+
+// This function will set the <bit> position in the <flag> register.
+// Both <flag> and <bit> are integers.
+
+	bit := 9 - bit;
+	
+	local FlagArray := BitOut(flag);
+	FlagArray[bit] := 1;
+
+	bit := BitIn(FlagArray);
+
+	return bit;
+
+endfunction
+
+
+function FlagReset(flag, bit);
+
+// This function will reset the <bit> position in the <flag> register.
+// Both <flag> and <bit> are integers.
+
+	bit := 9 - bit;
+	
+	local FlagArray := BitOut(flag);
+	FlagArray[bit] := 0;
+
+	bit := BitIn(FlagArray);
+
+	return bit;
+
+endfunction
+
+
+function FlagCheck(flag, bit);
+
+// This function will check the flag in the <bit> position of the
+// <flag> register.  It will return a 1 if the flag is set, and a 0
+// if the flag is reset.  Both <flag> and <bit> are integers.
+
+	local FlagArray := BitOut(flag);
+	bit := 9 - bit;
+
+	if (FlagArray[bit] = 1)
+		return 1;
+	else
+		return 0;
+	endif
+
+endfunction

Added: trunk/096/scripts/include/OLD/properties.inc
===================================================================
--- trunk/096/scripts/include/OLD/properties.inc	2005-11-04 02:19:06 UTC (rev 886)
+++ trunk/096/scripts/include/OLD/properties.inc	2005-11-04 02:21:01 UTC (rev 887)
@@ -0,0 +1,88 @@
+/* $Id: properties.inc 236 2005-09-25 09:06:19Z panosl $
+ *
+ * Purpose
+ * Provide property names and functions. Properties starting with "+" are to be protected.
+ *
+ */
+use uo;
+
+include "include/log";
+
+const SECURE_MAGIC          := 0xBADC0DE;
+
+enum MOB_PROPS
+    PROP_STAFF_LEVEL        := "+StaffLevel",        // Text command access level
+    PROP_CREATION_TIME      := "CreationTime",       // Character creation time (UNIX timestamp)
+    MOB_CPROPS_END          := 0
+endenum
+
+enum ITEM_PROPS
+    ITEM_CPROPS_END         := 0
+endenum
+
+enum WORLD_PROPS
+    PROP_PID                := "#PID",              // Array with all resistent scripts
+    PROP_TIMESTAMP          := "TimeStamp",         // Struct describing the time
+    WORLD_PROPS_END         := 0
+endenum
+
+
+// These properties only exist for a short time
+enum TEMP_PROPS
+    TEMPPROP_JUST_CREATED   := "#JustCreated",      // Character was just created
+    TEMPPROP_SCHED_PID      := "#SchedPID",         // PID of script scheduler
+    TEMP_PROPS_END          := 0
+endenum
+
+
+/*
+ * The following functions replace the default ObjProperty functions. Use these instead to avoid
+ * changing secured properies. If your script is safe, pass SECURE_MAGIC as magic.
+ *
+ */
+function SetProperty(what, property, value, magic := 0)
+    if(property[1] == "+")
+        if(magic == SECURE_MAGIC)
+            Log(LOG_WARNING, "Overwrote secure property '" + property + "' with '" + CStr(value) + "' on '" +
+                GetLogInfo(what) + "'");
+        else
+            Log(LOG_ERROR, "Failed to overwrite secure property '" + property + "' with '" + CStr(value) + "' on '" +
+                GetLogInfo(what) + "'");
+            return(error);
+        endif
+    endif
+    return(SetObjProperty(what, property, value));
+endfunction
+
+function GetProperty(what, property, magic := 0)
+    if(property[1] == "+" && magic != SECURE_MAGIC)
+        Log(LOG_ERROR, "Refused to GetProperty on secure property '" + property + "' on '" + GetLogInfo(what) + "'");
+        return(error);
+    endif
+    return(GetObjProperty(what, property));
+endfunction
+
+function EraseProperty(what, property, magic := 0)
+    if(property[1] == "+" && magic != SECURE_MAGIC)
+        Log(LOG_ERROR, "Refused to erase secure property '" + property + "' on '" + GetLogInfo(what) + "'");
+        return(error);
+    endif
+    return(EraseObjProperty(what, property));
+endfunction
+
+function GetPropertyNames(what, magic := 0)
+    var props, i;
+
+    if(magic == SECURE_MAGIC)
+        return(GetObjPropertyNames(what));
+    endif
+    
+    props := GetObjPropertyNames(what);
+    for(i := 1; i <= props.size(); i := i + 1)
+        if(props[i][1] == "+")
+            props.erase(i);
+            i := i - 1;
+        endif
+    endfor
+    return(props);
+endfunction



From austin at berlios.de  Fri Nov  4 03:50:02 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Fri, 4 Nov 2005 03:50:02 +0100
Subject: [Poldistro-svn] r888 - trunk/096/scripts/include
Message-ID: <200511040250.jA42o2Jk013504@sheep.berlios.de>

Author: austin
Date: 2005-11-04 03:50:01 +0100 (Fri, 04 Nov 2005)
New Revision: 888

Added:
   trunk/096/scripts/include/itemdesc.inc
Log:
Has functions for reading in itemdesc.cfg files easily.
Getting an itemdesc.cfg elem easily.

Has a function to parse an itemdesc.cfg Desc line
Example: Can parse loa%ves/f% of bread as "loaf of bread" and "loaves of bread"

Has a function to properly get an itemdesc.cfg graphic.

Added: trunk/096/scripts/include/itemdesc.inc
===================================================================
--- trunk/096/scripts/include/itemdesc.inc	2005-11-04 02:21:01 UTC (rev 887)
+++ trunk/096/scripts/include/itemdesc.inc	2005-11-04 02:50:01 UTC (rev 888)
@@ -0,0 +1,182 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+use cfgfile;
+use polsys;
+
+/*
+ * LoadItemDescCfgFile(package)
+ *
+ * Purpose
+ * Retrieves an itemdesc.cfg from a package or all of them.
+ *
+ * Parameters
+ * package:	Package name (e.g. "alchemy")
+ *		Note:
+ *			"*" - Will retrieve all itemdesc.cfg files.
+ *			"" - Will retrieve pol/config/itemdesc.cfg.
+ *
+ * Return value
+ * Returns a config file on success
+ * Returns an error on failure.
+ *
+ */
+function GetItemDescCfgFile(package:="")
+	var file_name := ":"+package+":itemdesc";
+	var item_cfg := ReadConfigFile(file_name);
+	
+	if ( item_cfg.errortext )
+		return error{"errortext":="Unable to open ["+file_name+"] ->"+item_cfg.errortext};
+	endif
+	
+	return item_cfg;
+endfunction
+
+/*
+ * GetItemDescInfo(obj_type)
+ *
+ * Purpose
+ * Retrieves the itemdesc.cfg elem for an object type.
+ *
+ * Parameters
+ * obj_type:	Object type to get the config elem for.
+ *
+ * Return value
+ * Returns a config elem on success.
+ * Returns an error on failure.
+ *
+ */
+function GetItemDescInfo(obj_type)
+	var item_cfg := GetItemDescCfgFile("*");
+	return item_cfg[obj_type];
+endfunction
+
+/*
+ * GetObjTypeGraphic(obj_type)
+ *
+ * Purpose
+ * Retrieves the proper graphic for an object type.
+ * For < 0x3FFF it will see if it has a graphic entry
+ * If it does not, it will return the object type (same thing as the graphic).
+ * 
+ * For > 0x3FFF it must contain a 'Graphic' entry to even start POL.
+ * 
+ * Parameters
+ * obj_type:	Object type to get the graphic for.
+ *
+ * Return value
+ * Returns an integer
+ *
+ */
+function GetObjTypeGraphic(obj_type)
+	obj_type := CInt(obj_type);
+	
+	var cfg_info := GetItemDescInfo(obj_type);
+	var graphic := CInt(cfg_info.Graphic);
+	if ( graphic )
+		return graphic;
+	else
+		return obj_type;
+	endif
+endfunction	
+
+/*
+ * GetObjTypeDesc(obj_type, plural)
+ *
+ * Purpose
+ * Retrieves the DESC entry from an itemdesc.cfg and parses it.
+ * e.g. bread loa%ves/f% could be "bread loaf" or "bread loaves"
+ * 
+ * Parameters
+ * objtype:	Object type (elem) to retrieve the description for.
+ * plural:	0 - Will parse the item description in singular form.
+ *		1 - Will parse the item in plural form.
+ *
+ * Return value
+ * Returns a string
+ *
+ */
+function GetObjTypeDesc(obj_type, plural:=0)
+	obj_type := CInt(obj_type);
+	
+	var cfg_info := GetItemDescInfo(obj_type);
+	if ( cfg_info.errortext )
+		return error{"errortext":="Object type not defined in any itemdesc.cfg"};
+	endif
+	
+	var name := "";
+	if ( cfg_info.Desc )
+		name := cfg_info.Desc;
+	elseif ( cfg_info.Name )
+		name := cfg_info.Name;
+	else
+		return error{"errortext":="Object type does not have a Name or Desc entry"};
+	endif
+
+	if ( !name["%"] ) // Plain desc line - easy enough to deal with.
+		if ( plural == 0 )
+			return name;
+		elseif ( name[Len(name)] in {"s"} )
+			return name;
+		elseif ( name[Len(name)] in {"h","j","x","z"} )
+			return name + "es";
+		else
+			return name + "s";
+		endif
+	endif
+
+	/* This section will deal with:
+	 	Bread Stick%s
+		Bread Loa%ves/f%
+		Lump%s% of Coal
+		Loa%ves/f% of Bread
+	*/
+	var first := Find(name, "%", 1);
+	var slash := Find(name, "/", first);
+	var second := Find(name, "%", first + 1);
+	
+	if ( slash && !second )
+		// Force-append a % if a '/' exists!
+		name := name + "%";
+		second := Len(name);
+	elseif ( !slash )
+		slash := second;
+	endif
+
+	// wwwww%xx[/yy]%[zzzzz]
+	// 12345678     9 01234
+	// 12345678 901 2 34567
+
+	var s_plur := name[first+1, slash-(first+1)];
+	var s_sing := "";
+	if ( slash != first )
+		s_sing := name[slash+1, second-(slash+1)];
+	endif
+
+	var s_first := name[1, first-1];
+	var s_middle := s_plur;
+	var s_last := "";
+	if ( len(name) > second )
+		s_last := name[second+1, len(name)-second];
+	endif
+
+	if ( plural == 0 )
+		s_middle := s_sing;
+	endif
+	
+	if ( !s_first )
+		s_first := "";
+	endif
+	if ( !s_middle )
+		s_middle := "";
+	endif
+	if ( !s_last )
+		s_last := "";
+	endif
+	
+	return s_first + s_middle + s_last;
+endfunction



From austin at berlios.de  Fri Nov  4 04:39:15 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Fri, 4 Nov 2005 04:39:15 +0100
Subject: [Poldistro-svn] r889 - in trunk/096: pkg/items/containers/include scripts/include
Message-ID: <200511040339.jA43dFWg019237@sheep.berlios.de>

Author: austin
Date: 2005-11-04 04:39:13 +0100 (Fri, 04 Nov 2005)
New Revision: 889

Added:
   trunk/096/pkg/items/containers/include/containers.inc
   trunk/096/scripts/include/facings.inc
Log:
containers.inc
Adds:
AmountInContainer()
Lets you find the number of items with specific properties in a container.

facings.inc
TurnObjectToward()
IsFacing()
IsBehind()


Added: trunk/096/pkg/items/containers/include/containers.inc
===================================================================
--- trunk/096/pkg/items/containers/include/containers.inc	2005-11-04 02:50:01 UTC (rev 888)
+++ trunk/096/pkg/items/containers/include/containers.inc	2005-11-04 03:39:13 UTC (rev 889)
@@ -0,0 +1,46 @@
+/* 
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+
+/*
+ * AmountInContainer(container, obj_type, params)
+ *
+ * Purpose
+ * Finds the amount of items with a certain objtype and 
+ * optional additional properties that are in a container.
+ *
+ * Parameters
+ * container:	Container to search
+ * obj_type:	Objtype to find
+ * params:	Optional - dictionary ( dict[property] = value )
+ *		Example: dict{"color"->0} // only count if uncolored
+ *
+ * Return value
+ * Returns an integer
+ *
+ */
+function AmountInContainer(container, obj_type, properties:=0)
+	var amount := 0;
+	foreach item in EnumerateItemsInContainer(container)
+		if( item.objtype == obj_type )
+			if ( !properties )
+				amount := amount + item.amount;
+			else
+				foreach property in ( properties.keys() )
+					if ( item.Get_Member(property) == properties[property] )
+						amount := amount + item.amount;
+					endif
+					sleepms(2);
+				endforeach
+			endif
+		endif
+		sleepms(2);
+	endforeach
+	
+	return amount;
+endfunction
+

Added: trunk/096/scripts/include/facings.inc
===================================================================
--- trunk/096/scripts/include/facings.inc	2005-11-04 02:50:01 UTC (rev 888)
+++ trunk/096/scripts/include/facings.inc	2005-11-04 03:39:13 UTC (rev 889)
@@ -0,0 +1,80 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+use math;
+
+/*
+ * TurnObjectToward(object, x_pos, y_pos)
+ *
+ * Purpose
+ * Sets an objects .facing member to face an x, y coordinate.
+ *
+ * Purpose
+ * object:	Object to set the facing on.
+ * x_pos:	X position to check.
+ * y_pos:	Y position to check.
+ *
+ * Return value
+ * Object's original facing
+ *
+ */
+function TurnObjectToward(object, x_pos, y_pos)
+	var orig := mobile.facing;
+
+	mobile.facing := GetFacing(mobile.x,mobile.y, x,y);
+
+	return orig;
+endfunction
+
+/*
+ * IsFacing(mobile, x_pos, y_pos)
+ *
+ * Purpose
+ * Determines if a mobile is facing a set of coordinates.
+ *
+ * Parameters
+ * mobile:	Mobile to check the coordinates with.
+ * x_pos:	X position to check.
+ * y_pos:	Y position to check.
+ *
+ * Return value
+ * Returns 1 if the mobile is facing the coordinates.
+ * Returns 0 if not.
+ *
+ */
+ function IsFacing(mobile, x, y)
+	return ( mobile.facing == GetFacing(mobile.x, mobile.y, x, y) );
+endfunction
+
+/*
+ * IsBehind(mobile, x_pos, y_pos)
+ * Determines if a set of coordinates are behind a character.
+ * Example ( ^ - character * - behind )
+ *         ^
+ *        ***
+ *       *****
+ *      *******
+ *
+ * Parameters
+ * mobile:	Mobile to check the coordinates with.
+ * x_pos:	X position to check.
+ * y_pos:	Y position to check.
+ *
+ * Return value
+ * Returns 1 if the coordinates are behind the mobile.
+ * Returns 0 if not.
+ *
+ */
+function IsBehind( tgt_mob, locx, locy )
+	var frot := Abs(((tgt_mob.facing+4)%8)-GetFacing(tgt_mob.x,tgt_mob.y,locx,locy));
+	if ( frot > 4 )
+		frot := 8-frot;
+	endif
+
+	return ( frot < 2 );
+endfunction
+



From austin at berlios.de  Fri Nov  4 07:14:48 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Fri, 4 Nov 2005 07:14:48 +0100
Subject: [Poldistro-svn] r890 - in trunk/096/pkg/skills/magery: . config include spellBook
Message-ID: <200511040614.jA46Em4L000689@sheep.berlios.de>

Author: austin
Date: 2005-11-04 07:14:45 +0100 (Fri, 04 Nov 2005)
New Revision: 890

Added:
   trunk/096/pkg/skills/magery/spellBook/
   trunk/096/pkg/skills/magery/spellBook/castSpell.src
   trunk/096/pkg/skills/magery/spells.cfg
Removed:
   trunk/096/pkg/skills/magery/config/spells.cfg
Modified:
   trunk/096/pkg/skills/magery/include/spells.inc
   trunk/096/pkg/skills/magery/spellStarter.src
Log:


Deleted: trunk/096/pkg/skills/magery/config/spells.cfg
===================================================================
--- trunk/096/pkg/skills/magery/config/spells.cfg	2005-11-04 03:39:13 UTC (rev 889)
+++ trunk/096/pkg/skills/magery/config/spells.cfg	2005-11-04 06:14:45 UTC (rev 890)
@@ -1,17 +0,0 @@
-#
-# Spell	Example
-# {
-#	Script		:magery:spellScripts/Circle#/fileName
-#	
-#	ManaCost	25
-#	
-#	BaseDelay	100
-#	Difficulty	35
-#	
-#	Attribute	Magery
-#	
-#	Reagent	BloodMoss	5
-#	Reagent	BlackPearl	10
-#	Reagent	Ginseng		250000
-#}
-#
\ No newline at end of file

Modified: trunk/096/pkg/skills/magery/include/spells.inc
===================================================================
--- trunk/096/pkg/skills/magery/include/spells.inc	2005-11-04 03:39:13 UTC (rev 889)
+++ trunk/096/pkg/skills/magery/include/spells.inc	2005-11-04 06:14:45 UTC (rev 890)
@@ -5,7 +5,6 @@
 
 include ":attributes:attributes";
 include "include/client";
-include "include/dist";
 
 const MAX_RANGE	:= 16;
 
@@ -22,10 +21,10 @@
  *
  */
 function MS_GetSpellsCfgFile()
-	var cfg := ReadConfigFile(":magery:config/spells");
+	var cfg := ReadConfigFile(":magery:spells");
 
 	if ( cfg.errortext )
-		SysLog("Error::MS_GetSpellsCfgFile() - Unable to open [:magery:config/spells.cfg] ->"+cfg.errortext);
+		SysLog("Error::MS_GetSpellsCfgFile() - Unable to open [:magery:spells.cfg] ->"+cfg.errortext);
 	endif
 
 	return cfg;

Added: trunk/096/pkg/skills/magery/spellBook/castSpell.src
===================================================================
--- trunk/096/pkg/skills/magery/spellBook/castSpell.src	2005-11-04 03:39:13 UTC (rev 889)
+++ trunk/096/pkg/skills/magery/spellBook/castSpell.src	2005-11-04 06:14:45 UTC (rev 890)
@@ -0,0 +1,18 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+use cfgfile;
+
+program castSpell(who, spell_id)
+	var script := Start_Script("spellStarter", {who, spell_id});
+	if ( script.errortext )
+		SendSysMessage(who, "Error - Could not start spell starter ->"+script.errortext);
+		return 0;
+	endif
+	
+	return 1;
+endprogram

Modified: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-04 03:39:13 UTC (rev 889)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-04 06:14:45 UTC (rev 890)
@@ -9,10 +9,10 @@
 
 include ":attributes:attributes";
 include ":magery:spells";
+include ":containers:containers";
+include "include/itemdesc";
 include "include/client";
-include "include/string";
 
-
 set_script_option(SCRIPTOPT_CAN_ACCESS_OFFLINE_MOBILES, 1);
 
 program SpellStarter(params)
@@ -60,7 +60,7 @@
 	elseif ( !ConsumeVital(who, MANA, mana_cost) )
 		SendSysMessage(who, "You are too tired to cast.");
 		FailSpell(who);
-	elseif ( !CheckRegs(who, spell_elem, scroll) )
+	elseif ( !CheckReagents(who, spell_elem, scroll) )
 		FailSpell(who);
 	elseif ( !EquipmentCheck(who) )
 		FailSpell(who);
@@ -166,7 +166,7 @@
 	return 1;
 endfunction
 
-function CheckRegs(who, byref spell_elem, scroll)
+function CheckReagents(who, byref spell_elem, scroll)
 	if ( who.npctemplate )
 		// NPCs don't need reagents to cast.
 		return 1;

Added: trunk/096/pkg/skills/magery/spells.cfg
===================================================================
--- trunk/096/pkg/skills/magery/spells.cfg	2005-11-04 03:39:13 UTC (rev 889)
+++ trunk/096/pkg/skills/magery/spells.cfg	2005-11-04 06:14:45 UTC (rev 890)
@@ -0,0 +1,904 @@
+Spell 1
+{
+	SpellId		1
+	Name		Clumsy
+	Script		spellBook/castSpell
+
+	ManaCost	0
+	Delay		0
+
+	PowerWords	Uus Jux
+	Circle		1
+
+	RegCost		BloodMoss	1
+	RegCost		NightShade	1
+}
+
+Spell 2
+{
+	SpellId		2
+	Name		Create Food
+	Script		spellBook/castSpell
+
+	ManaCost	0
+	Delay		0
+
+	Circle		1
+	PowerWords	In Mani Ylem
+
+	RegCost		Garlic		1
+	RegCost		Ginseng		1
+	RegCost		MandrakeRoot	1
+}
+
+Spell 3
+{
+	SpellId		3
+	Name		Feeblemind
+	Script		spellBook/castSpell
+
+	ManaCost	0
+	Delay		0
+
+	PowerWords	Rel Wis
+	Circle		1
+
+	RegCost		NightShade	1
+	RegCost		Ginseng		1
+}
+
+Spell 4
+{
+	SpellId		4
+	Name		Heal
+	Script		spellBook/castSpell
+
+	ManaCost	0
+	Delay		0
+
+	PowerWords	In Mani
+	Circle		1
+
+	RegCost		Garlic		1
+	RegCost		Ginseng		1
+	RegCost		SpiderSilk	1
+}
+
+Spell  5
+{
+	SpellId		5
+	Name		Magic Arrow
+	Script		spellBook/castSpell
+
+	PowerWords	In Por Ylem
+	Circle		1
+
+	RegCost		BlackPearl	1
+	RegCost		NightShade	1
+}
+
+Spell 6
+{
+	SpellId		6
+	Name		Night Sight
+	Script		spellBook/castSpell
+
+	PowerWords	In Lor
+	Circle		1
+
+	RegCost		SpiderSilk	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 7
+{
+	SpellId		7
+	Name		Reactive Armor
+	Script		spellBook/castSpell
+	
+	PowerWords	Flam Sanct
+	Circle		1
+	
+	RegCost		Garlic		1
+	RegCost		SpiderSilk	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 8
+{
+	SpellId		8
+	Name		Weaken
+	Script		spellBook/castSpell
+	
+	PowerWords	Des Mani
+	Circle		1
+	
+	RegCost		Garlic		1
+	RegCost		NightShade	1
+}
+
+Spell 9
+{
+	SpellId		9
+	Name		Agility
+	Script		spellBook/castSpell
+	
+	PowerWords	Ex Uus
+	Circle		2
+	
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+}
+
+Spell 10
+{
+	SpellId		10
+	Name		Cunning
+	Script		spellBook/castSpell
+	
+	PowerWords	Uus Wis
+	Circle		2
+	
+	RegCost		NightShade	1
+	RegCost		MandrakeRoot	1
+}
+
+Spell 11
+{
+	SpellId		11
+	Name		Cure
+	Script		spellBook/castSpell
+	
+	PowerWords	An Nox
+	Circle		2
+	
+	RegCost		Garlic		1
+	RegCost		Ginseng		1
+}
+
+Spell 12
+{
+	SpellId		12
+	Name		Harm
+	Script		spellBook/castSpell
+	
+	PowerWords	An Mani
+	Circle		2
+	
+	RegCost		NightShade	1
+	RegCost		SpiderSilk	1
+}
+
+Spell 13
+{
+	SpellId		13
+	Name		Magic Trap
+	Script		spellBook/castSpell
+	
+	PowerWords	In Jux
+	Circle		2
+	
+	RegCost		Garlic		1
+	RegCost		SpiderSilk	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 14
+{
+	SpellId		14
+	Name		Magic Untrap
+	Script		spellBook/castSpell
+	
+	PowerWords	An Jux
+	Circle		2
+	
+	RegCost		Garlic		1
+	RegCost		Ginseng		1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 15
+{
+	SpellId		15
+	Name		Protection
+	Script		spellBook/castSpell
+	
+	PowerWords	Uus Sanct
+	Circle		2
+	
+	RegCost		Garlic		1
+	RegCost		Ginseng		1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 16
+{
+	SpellId		16
+	Name		Strength
+	Script		spellBook/castSpell
+	
+	PowerWords	Uus Mani
+	Circle		2
+	
+	RegCost		MandrakeRoot	1
+	RegCost		NightShade	1
+}
+
+Spell 17
+{
+	SpellId		17
+	Name		Bless
+	Script		spellBook/castSpell
+	
+	PowerWords	Rel Sanct
+	Circle		3
+	
+	RegCost		Garlic		1
+	RegCost		MandrakeRoot	1
+}
+
+Spell 18
+{
+	SpellId		18
+	Name		Fireball
+	Script		spellBook/castSpell
+	
+	PowerWords	Vas Flam
+	Circle		3
+	
+	RegCost		BlackPearl	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 19
+{
+	SpellId		19
+	Name		Magic Lock
+	Script		spellBook/castSpell
+	
+	PowerWords	An Por
+	Circle		3
+	
+	RegCost		BloodMoss	1
+	RegCost		Garlic		1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 20
+{
+	SpellId		20
+	Name		Poison
+	Script		spellBook/castSpell
+	
+	PowerWords	In Nox
+	Circle		3
+	
+	RegCost		NightShade	1
+}
+
+Spell 21
+{
+	SpellId		21
+	Name		Telekinesis
+	Script		spellBook/castSpell
+	
+	PowerWords	Ort Por Ylem
+	Circle		3
+	
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+}
+
+Spell 22
+{
+	SpellId		22
+	Name		Teleport
+	Script		spellBook/castSpell
+	
+	PowerWords	Rel Por
+	Circle		3
+	
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+}
+
+Spell 23
+{
+	SpellId		23
+	Name		Unlock
+	Script		spellBook/castSpell
+	
+	PowerWords	Ex Por
+	Circle		3
+	
+	RegCost		BloodMoss	1
+	RegCost		Garlic		1
+}
+
+Spell 24
+{
+	SpellId		24
+	Name		Wall of Stone
+	Script		spellBook/castSpell
+	
+	PowerWords	In Sanct Ylem
+	Circle		3
+	
+	RegCost		BloodMoss	1
+	RegCost		Garlic		1
+}
+
+Spell 25
+{
+	SpellId		25
+	Name		Arch Cure
+	Script		spellBook/castSpell
+	
+	PowerWords	Vas An Nox
+	Circle		4
+	
+	RegCost		Garlic		1
+	RegCost		Ginseng		1
+	RegCost		MandrakeRoot	1
+}
+
+Spell 26
+{
+	SpellId		26
+	Name		Arch Protection
+	Script		spellBook/castSpell
+	
+	PowerWords	Vas Uus Sanct
+	Circle		4
+	
+	RegCost		Garlic		1
+	RegCost		Ginseng		1
+	RegCost		MandrakeRoot	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 27
+{
+	SpellId		27
+	Name		Curse
+	Script		spellBook/castSpell
+	
+	PowerWords	Des Sanct
+	Circle		4
+	
+	RegCost		Garlic		1
+	RegCost		NightShade	1
+	RegCost		SulphurousAsh	1
+}	
+
+Spell 28
+{
+	SpellId		28
+	Name		Fire Field
+	Script		spellBook/castSpell
+	
+	PowerWords	In Flam Grav
+	Circle		4
+	
+	RegCost		SpiderSilk	1
+	RegCost		SulphurousAsh	1
+	RegCost		BlackPearl	1
+}
+
+Spell 29
+{
+	SpellId		29
+	Name		Greater Heal
+	Script		spellBook/castSpell
+	
+	PowerWords	In Vas Mani
+	Circle		4
+	
+	RegCost		Garlic		1
+	RegCost		Ginseng		1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+}
+
+Spell 30
+{
+	SpellId		30
+	Name		Lightning
+	Script		spellBook/castSpell
+	
+	PowerWords	Por Ort Grav
+	Circle		4
+		
+	RegCost		BlackPearl	1
+	RegCost		SulphurousAsh	1
+	RegCost 	MandrakeRoot	1
+}
+
+Spell 31
+{
+	SpellId		31
+	Name		Mana Drain
+	Script		spellBook/castSpell
+	
+	PowerWords	Ort Rel
+	Circle		4
+	
+	RegCost		BlackPearl	1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1	
+}
+
+Spell 32
+{
+	SpellId		32
+	Name		Recall
+	Script		spellBook/castSpell
+	
+	PowerWords	Kal Ort Por
+	Circle		4
+	
+	RegCost		BlackPearl	1
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1	
+}
+
+Spell 33
+{
+	SpellId		33
+	Name		Blade Spirit
+	Script		spellBook/castSpell
+	
+	PowerWords	In Jux Hur Ylem
+	Circle		5
+	
+	RegCost		BlackPearl	1
+	RegCost		MandrakeRoot	1
+	RegCost		NightShade	1
+}
+
+Spell 34
+{
+	SpellId		34
+	Name		Dispel Field
+	Script		spellBook/castSpell
+	
+	PowerWords	An Grav
+	Circle		5
+	
+	RegCost		BlackPearl	1
+	RegCost		Garlic		1
+	RegCost		SpiderSilk	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 35
+{
+	SpellId		35
+	Name		Incognito
+	Script		spellBook/castSpell
+	
+	PowerWords	Kal In Ex
+	Circle		5
+	
+	RegCost		BloodMoss	1
+	RegCost		Garlic		1
+	RegCost		NightShade	1
+}
+
+Spell 36
+{
+	SpellId		36
+	Name		Spell Reflection
+	Script		spellBook/castSpell
+	
+	PowerWords	In Jux Sanct
+	Circle		5
+	
+	RegCost		Garlic		1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+}
+
+Spell 37
+{
+	SpellId		37
+	Name		Mind Blast
+	Script		spellBook/castSpell
+	
+	PowerWords	Por Corp Wis
+	Circle		5
+	
+	RegCost		BlackPearl	1
+	RegCost		MandrakeRoot	1
+	RegCost		NightShade	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 38
+{
+	SpellId		38
+	Name		Paralyze
+	Script		spellBook/castSpell
+	
+	PowerWords	An Ex Por
+	Circle		5
+	
+	RegCost		Garlic		1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+}
+
+Spell 39
+{
+	SpellId		39
+	Name		Poison Field
+	Script		spellBook/castSpell
+	
+	PowerWords	In Nox Grav
+	Circle		5
+	
+	RegCost		BlackPearl	1
+	RegCost		NightShade	1
+	RegCost		SpiderSilk	1
+}
+
+Spell 40
+{
+	SpellId		40
+	Name		SummonCreature
+	Script		spellBook/castSpell
+	
+	PowerWords	Kal Xen
+	Circle		5
+	
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+}
+
+Spell 41
+{
+	SpellId		41
+	Name		Dispel
+	Script		spellBook/castSpell
+	
+	PowerWords	An Ort
+	Circle		6
+	
+	RegCost		Garlic		1
+	RegCost		MandrakeRoot	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 42
+{
+	SpellId		42
+	Name		Energy Bolt
+	Script		spellBook/castSpell
+	
+	PowerWords	Corp Por
+	Circle		6
+	
+	RegCost		BlackPearl	1
+	RegCost		NightShade	1
+}
+
+Spell 43
+{
+	SpellId		43
+	Name		Explosion
+	Script		spellBook/castSpell
+	
+	PowerWords	Vas Ort Flam
+	Circle		6
+	
+	RegCost		BlackPearl	1
+	RegCost		MandrakeRoot	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 44
+{
+	SpellId		44
+	Name		Invisibility
+	Script		spellBook/castSpell
+	
+	PowerWords	An Lor Xen
+	Circle		6
+	
+	RegCost		BloodMoss	1
+	RegCost		NightShade	1
+}
+
+Spell 45
+{
+	SpellId		45
+	Name		Mark
+	Script		spellBook/castSpell
+	
+	PowerWords	Kal Por Ylem
+	Circle		6
+	
+	RegCost		BlackPearl	1
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+}
+
+Spell 46
+{
+	SpellId		46
+	Name		Mass Curse
+	Script		spellBook/castSpell
+	
+	PowerWords	Vas Des Sanct
+	Circle		6
+	
+	RegCost		Garlic		1
+	RegCost		MandrakeRoot	1
+	RegCost		NightShade	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 47
+{
+	SpellId		47
+	Name		Paralyze Field
+	Script		spellBook/castSpell
+	
+	PowerWords	In Ex Grav
+	Circle		6
+	
+	RegCost		BlackPearl	1
+	RegCost		Ginseng		1
+	RegCost		SpiderSilk	1
+}
+
+Spell 48
+{
+	SpellId		48
+	Name		Reveal
+	Script		spellBook/castSpell
+	
+	PowerWords	Wis  Quas
+	Circle		6
+	
+	RegCost		BloodMoss	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 49
+{
+	SpellId		49
+	Name		Chain Lightning
+	Script		spellBook/castSpell
+	
+	PowerWords	Vas Ort Grav
+	Circle		7
+	
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+	RegCost		BlackPearl	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 50
+{
+	SpellId		50
+	Name		Energy Field
+	Script		spellBook/castSpell
+	
+	PowerWords	In Sanct Grav
+	Circle		7
+	
+	RegCost		BlackPearl	1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 51
+{
+	SpellId		51
+	Name		FlameStrike
+	Script		spellBook/castSpell
+	
+	PowerWords	Kal Vas Flam
+	Circle		7
+	
+	RegCost		SpiderSilk	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 52
+{
+	SpellId		52
+	Name		Gate
+	Script		spellBook/castSpell
+	
+	PowerWords	Vas Rel Por
+	Circle		7
+	
+	RegCost		BlackPearl	1
+	RegCost		MandrakeRoot	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 53
+{
+	SpellId		53
+	Name		Mana Vampire
+	Script		spellBook/castSpell
+	
+	PowerWords	Ort Sanct
+	Circle		7
+	
+	RegCost		BlackPearl	1
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+}
+
+Spell 54
+{
+	SpellId		54
+	Name		Mass Dispel
+	Script		spellBook/castSpell
+	
+	PowerWords	Vas An Ort
+	Circle		7
+	
+	RegCost		BlackPearl	1
+	RegCost		Garlic		1
+	RegCost		MandrakeRoot	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 55
+{
+	SpellId		55
+	Name		Meteor Swarm
+	Script		spellBook/castSpell
+	
+	PowerWords	Kal Des Flam Ylem
+	Circle		7
+	
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 56
+{
+	SpellId		56
+	Name		Polymorph
+	Script		spellBook/castSpell
+	
+	PowerWords	Vas Ylem Rel
+	Circle		7
+	
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+}
+
+Spell 57
+{
+	SpellId		57
+	Name		Earthquake
+	Script		spellBook/castSpell
+	
+	PowerWords	In Vas Por
+	Circle		8
+
+	RegCost		BloodMoss	1
+	RegCost		Ginseng		1
+	RegCost		MandrakeRoot	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 58
+{
+	SpellId		58
+	Name		EnergyVortex
+	Script		spellBook/castSpell
+	
+	PowerWords	Vas Corp Por
+	Animation	0x11
+	Circle		8
+	
+	RegCost		BlackPearl	1
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+	RegCost		NightShade	1
+}
+
+Spell 59
+{
+	SpellId		59
+	Name		Resurrection
+	Script		spellBook/castSpell
+	
+	PowerWords	An Corp
+	Circle		8
+	
+	RegCost		BloodMoss	1
+	RegCost		Garlic		1
+	RegCost		Ginseng		1
+}
+
+Spell 60
+{
+	SpellId		60
+	Name		Summon Air Elemental
+	Script		spellBook/castSpell
+	
+	Animation	0x11
+	PowerWords	Kal Vas Xen Hur
+	Circle		8
+	
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+}
+
+Spell 61
+{
+	SpellId		61
+	Name		Summon Daemon
+	Script		spellBook/castSpell
+	
+	Animation	0x11
+	PowerWords	Kal Vas Xen Corp
+	Circle		8
+	
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 62
+{
+	SpellId		62
+	Name		Summon Earth Elemental
+	Script		spellBook/castSpell
+	
+	Animation	0x11
+	PowerWords	Kal Vas Xen Ylem
+	Circle		8
+		
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+}
+
+Spell 63
+{
+	SpellId		63
+	Name		Summon Fire Elemental
+	Script		spellBook/castSpell
+	
+	Animation	0x11
+	PowerWords	Kal Vas Xen Flam
+	Circle		8
+		
+	RegCost		BloodMoss	1
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+	RegCost		SulphurousAsh	1
+}
+
+Spell 64
+{
+	SpellId		64
+	Name		Summon Water Elemental
+	Script		spellBook/castSpell
+	
+	Animation	0x11
+	PowerWords	Kal Vas Xen An Flam
+	Circle		8
+	
+	RegCost		MandrakeRoot	1
+	RegCost		SpiderSilk	1
+}



From muaddiblsd at berlios.de  Fri Nov  4 07:30:23 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Fri, 4 Nov 2005 07:30:23 +0100
Subject: [Poldistro-svn] r891 - in trunk/096: pkg/commands/admin pkg/commands/coun pkg/commands/gm pkg/commands/player pkg/commands/props pkg/commands/seer pkg/config/include pkg/items/blood pkg/items/blood/blood pkg/items/blood/config pkg/items/blood/include pkg/items/containers/include pkg/items/dyes/dyeTub pkg/items/dyes/dyes pkg/items/dyes/furnitureTub pkg/items/dyes/include pkg/items/feces pkg/items/feces/config pkg/items/feces/poop pkg/items/training pkg/items/training/archeryButte pkg/items/training/config pkg/items/training/include pkg/items/training/pocketDip pkg/items/training/trainingDummy pkg/items/vomit pkg/items/vomit/config pkg/items/vomit/vomit pkg/items/walkOn/spiderWeb pkg/mobiles/brainAI/docs pkg/mobiles/brainAI/include pkg/mobiles/brainAI/scripts/combat pkg/mobiles/brainAI/scripts/doubleClick pkg/mobiles/brainAI/scripts/endFight pkg/mobiles/brainAI/scripts/enterArea pkg/mobiles/brainAI/scripts/leftArea pkg/mobiles/brainAI/scripts/lookAround pkg/mobiles/brainAI/scripts/sh!
 ouldWatch pkg/mobiles/brainAI/scripts/sleep pkg/mobiles/timedScripts pkg/mobiles/timedScripts/commands/gm pkg/mobiles/timedScripts/config pkg/mobiles/timedScripts/include pkg/mobiles/timedScripts/subScripts/food pkg/mobiles/timedScripts/subScripts/odors pkg/mobiles/timedScripts/subScripts/paralysis pkg/mobiles/timedScripts/subScripts/poison pkg/packetHooks pkg/packetHooks/CharProfile pkg/packetHooks/CharProfile/config pkg/packetHooks/OpenDoor pkg/packetHooks/OpenDoor/config pkg/packetHooks/PacketConfig pkg/packetHooks/PacketConfig/config pkg/packetHooks/RequestAttack pkg/packetHooks/RequestAttack/config pkg/packetHooks/StatHook pkg/packetHooks/Target pkg/packetHooks/Target/config pkg/packetHooks/WarAndPeace pkg/packetHooks/WarAndPeace/config pkg/skills/lumberjacking pkg/skills/lumberjacking/config pkg/skills/lumberjacking/include pkg/skills/lumberjacking/treeRegen pkg/skills/magery pkg/skills/magery/OLD pkg/skills/magery/OLD/config pkg/skills/magery/config pkg/skills/magery!
 /include pkg/skills/magery/spellScroll pkg/systems/attributes/!
 config p
Message-ID: <200511040630.jA46UNOA008444@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-04 07:29:43 +0100 (Fri, 04 Nov 2005)
New Revision: 891

Added:
   trunk/096/pkg/packetHooks/PacketConfig/
   trunk/096/pkg/packetHooks/PacketConfig/config/
   trunk/096/pkg/packetHooks/PacketConfig/config/icp.cfg
   trunk/096/pkg/packetHooks/PacketConfig/config/packetconfig.cfg
   trunk/096/pkg/packetHooks/PacketConfig/pkg.cfg
   trunk/096/pkg/packetHooks/Target/
   trunk/096/pkg/packetHooks/Target/config/
   trunk/096/pkg/packetHooks/Target/config/icp.cfg
   trunk/096/pkg/packetHooks/Target/pkg.cfg
   trunk/096/pkg/packetHooks/Target/targetHook.src
   trunk/096/pkg/packetHooks/Target/uopacket.cfg
   trunk/096/pkg/utils/logger/
   trunk/096/pkg/utils/logger/config/
   trunk/096/pkg/utils/logger/config/icp.cfg
   trunk/096/pkg/utils/logger/include/
   trunk/096/pkg/utils/logger/include/exception.inc
   trunk/096/pkg/utils/logger/include/log.inc
   trunk/096/pkg/utils/logger/pkg.cfg
Removed:
   trunk/096/scripts/include/OLD/exception.inc
   trunk/096/scripts/include/log.inc
Modified:
   trunk/096/pkg/commands/admin/unloadcfg.src
   trunk/096/pkg/commands/coun/conceal.src
   trunk/096/pkg/commands/gm/destroy.src
   trunk/096/pkg/commands/gm/kick.src
   trunk/096/pkg/commands/gm/shave.src
   trunk/096/pkg/commands/player/cmdtoggle.src
   trunk/096/pkg/commands/player/help.src
   trunk/096/pkg/commands/props/eraseglobal.src
   trunk/096/pkg/commands/props/eraseobjproperty.src
   trunk/096/pkg/commands/props/getCProp.src
   trunk/096/pkg/commands/props/getglobal.src
   trunk/096/pkg/commands/props/getprop.src
   trunk/096/pkg/commands/props/propedit.src
   trunk/096/pkg/commands/props/props.src
   trunk/096/pkg/commands/props/setglobal.src
   trunk/096/pkg/commands/props/setobjproperty.src
   trunk/096/pkg/commands/props/setprop.src
   trunk/096/pkg/commands/seer/rename.src
   trunk/096/pkg/config/include/config.inc
   trunk/096/pkg/items/blood/blood/control.src
   trunk/096/pkg/items/blood/blood/onCreate.src
   trunk/096/pkg/items/blood/config/icp.cfg
   trunk/096/pkg/items/blood/config/settings.cfg
   trunk/096/pkg/items/blood/include/blood.inc
   trunk/096/pkg/items/blood/itemdesc.cfg
   trunk/096/pkg/items/blood/pkg.cfg
   trunk/096/pkg/items/containers/include/containers.inc
   trunk/096/pkg/items/dyes/dyeTub/use.src
   trunk/096/pkg/items/dyes/dyes/use.src
   trunk/096/pkg/items/dyes/furnitureTub/use.src
   trunk/096/pkg/items/dyes/include/dyes.inc
   trunk/096/pkg/items/feces/config/icp.cfg
   trunk/096/pkg/items/feces/itemdesc.cfg
   trunk/096/pkg/items/feces/pkg.cfg
   trunk/096/pkg/items/feces/poop/use.src
   trunk/096/pkg/items/training/archeryButte/use.src
   trunk/096/pkg/items/training/config/icp.cfg
   trunk/096/pkg/items/training/include/training.inc
   trunk/096/pkg/items/training/itemdesc.cfg
   trunk/096/pkg/items/training/pkg.cfg
   trunk/096/pkg/items/training/pocketDip/use.src
   trunk/096/pkg/items/training/trainingDummy/control.src
   trunk/096/pkg/items/training/trainingDummy/use.src
   trunk/096/pkg/items/vomit/config/icp.cfg
   trunk/096/pkg/items/vomit/config/settings.cfg
   trunk/096/pkg/items/vomit/itemdesc.cfg
   trunk/096/pkg/items/vomit/pkg.cfg
   trunk/096/pkg/items/vomit/vomit/control.src
   trunk/096/pkg/items/vomit/vomit/onCreate.src
   trunk/096/pkg/items/walkOn/spiderWeb/control.src
   trunk/096/pkg/mobiles/brainAI/docs/about.html
   trunk/096/pkg/mobiles/brainAI/docs/changelog.html
   trunk/096/pkg/mobiles/brainAI/docs/configsettings.html
   trunk/096/pkg/mobiles/brainAI/docs/conversion.html
   trunk/096/pkg/mobiles/brainAI/docs/docs.css
   trunk/096/pkg/mobiles/brainAI/docs/eventId.html
   trunk/096/pkg/mobiles/brainAI/docs/index.html
   trunk/096/pkg/mobiles/brainAI/docs/menu.html
   trunk/096/pkg/mobiles/brainAI/docs/npcCommands.html
   trunk/096/pkg/mobiles/brainAI/docs/npcError.html
   trunk/096/pkg/mobiles/brainAI/docs/npcInit.html
   trunk/096/pkg/mobiles/brainAI/docs/npcNerves.html
   trunk/096/pkg/mobiles/brainAI/docs/npcSettings.html
   trunk/096/pkg/mobiles/brainAI/docs/npcUtil.html
   trunk/096/pkg/mobiles/brainAI/docs/npcWatchList.html
   trunk/096/pkg/mobiles/brainAI/docs/scripttypes.html
   trunk/096/pkg/mobiles/brainAI/include/npcSounds.inc
   trunk/096/pkg/mobiles/brainAI/scripts/combat/genericAnimal.src
   trunk/096/pkg/mobiles/brainAI/scripts/combat/rigger.src
   trunk/096/pkg/mobiles/brainAI/scripts/doubleClick/cowTip.src
   trunk/096/pkg/mobiles/brainAI/scripts/endFight/endFightAnimal.src
   trunk/096/pkg/mobiles/brainAI/scripts/enterArea/generic.src
   trunk/096/pkg/mobiles/brainAI/scripts/leftArea/generic.src
   trunk/096/pkg/mobiles/brainAI/scripts/lookAround/findAttackables.src
   trunk/096/pkg/mobiles/brainAI/scripts/lookAround/findFeared.src
   trunk/096/pkg/mobiles/brainAI/scripts/shouldWatch/targetPlayers.src
   trunk/096/pkg/mobiles/brainAI/scripts/shouldWatch/watchFeared.src
   trunk/096/pkg/mobiles/brainAI/scripts/sleep/generic.src
   trunk/096/pkg/mobiles/timedScripts/commands/gm/addTimer.src
   trunk/096/pkg/mobiles/timedScripts/commands/gm/curePoisons.src
   trunk/096/pkg/mobiles/timedScripts/commands/gm/listTimers.src
   trunk/096/pkg/mobiles/timedScripts/commands/gm/lowerTimer.src
   trunk/096/pkg/mobiles/timedScripts/config/icp.cfg
   trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg
   trunk/096/pkg/mobiles/timedScripts/include/poisonUtil.inc
   trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc
   trunk/096/pkg/mobiles/timedScripts/logon.src
   trunk/096/pkg/mobiles/timedScripts/pkg.cfg
   trunk/096/pkg/mobiles/timedScripts/reconnect.src
   trunk/096/pkg/mobiles/timedScripts/subScripts/food/alcohol.src
   trunk/096/pkg/mobiles/timedScripts/subScripts/odors/flatulence.src
   trunk/096/pkg/mobiles/timedScripts/subScripts/odors/poostink.src
   trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/endParalysis.src
   trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/paralysis.src
   trunk/096/pkg/mobiles/timedScripts/subScripts/poison/defaultPoison.src
   trunk/096/pkg/mobiles/timedScripts/timerControl.src
   trunk/096/pkg/packetHooks/CharProfile/charprofile.src
   trunk/096/pkg/packetHooks/CharProfile/config/icp.cfg
   trunk/096/pkg/packetHooks/CharProfile/onDelete.src
   trunk/096/pkg/packetHooks/CharProfile/parseCharProfile.src
   trunk/096/pkg/packetHooks/CharProfile/pkg.cfg
   trunk/096/pkg/packetHooks/CharProfile/uopacket.cfg
   trunk/096/pkg/packetHooks/OpenDoor/config/icp.cfg
   trunk/096/pkg/packetHooks/OpenDoor/openDoor.src
   trunk/096/pkg/packetHooks/OpenDoor/pkg.cfg
   trunk/096/pkg/packetHooks/OpenDoor/uopacket.cfg
   trunk/096/pkg/packetHooks/RequestAttack/config/icp.cfg
   trunk/096/pkg/packetHooks/RequestAttack/pkg.cfg
   trunk/096/pkg/packetHooks/RequestAttack/requestAttack.src
   trunk/096/pkg/packetHooks/RequestAttack/uopacket.cfg
   trunk/096/pkg/packetHooks/StatHook/sendStats.src
   trunk/096/pkg/packetHooks/WarAndPeace/config/icp.cfg
   trunk/096/pkg/packetHooks/WarAndPeace/pkg.cfg
   trunk/096/pkg/packetHooks/WarAndPeace/readme.txt
   trunk/096/pkg/packetHooks/WarAndPeace/requestWar.src
   trunk/096/pkg/packetHooks/WarAndPeace/uopacket.cfg
   trunk/096/pkg/skills/lumberjacking/config/icp.cfg
   trunk/096/pkg/skills/lumberjacking/config/settings.cfg
   trunk/096/pkg/skills/lumberjacking/config/woodRegions.cfg
   trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc
   trunk/096/pkg/skills/lumberjacking/include/settings.inc
   trunk/096/pkg/skills/lumberjacking/lumberJack.src
   trunk/096/pkg/skills/lumberjacking/pkg.cfg
   trunk/096/pkg/skills/lumberjacking/start.src
   trunk/096/pkg/skills/lumberjacking/treeRegen/control.src
   trunk/096/pkg/skills/magery/OLD/agility.src
   trunk/096/pkg/skills/magery/OLD/archCure.src
   trunk/096/pkg/skills/magery/OLD/archProt.src
   trunk/096/pkg/skills/magery/OLD/bladeSpirit.src
   trunk/096/pkg/skills/magery/OLD/bless.src
   trunk/096/pkg/skills/magery/OLD/chainLightning.src
   trunk/096/pkg/skills/magery/OLD/clumsy.src
   trunk/096/pkg/skills/magery/OLD/config/icp.cfg
   trunk/096/pkg/skills/magery/OLD/createFood.src
   trunk/096/pkg/skills/magery/OLD/cunning.src
   trunk/096/pkg/skills/magery/OLD/cure.src
   trunk/096/pkg/skills/magery/OLD/curse.src
   trunk/096/pkg/skills/magery/OLD/dispel.src
   trunk/096/pkg/skills/magery/OLD/dispelField.src
   trunk/096/pkg/skills/magery/OLD/eBolt.src
   trunk/096/pkg/skills/magery/OLD/earthquake.src
   trunk/096/pkg/skills/magery/OLD/energyField.src
   trunk/096/pkg/skills/magery/OLD/explosion.src
   trunk/096/pkg/skills/magery/OLD/feeblemind.src
   trunk/096/pkg/skills/magery/OLD/fireField.src
   trunk/096/pkg/skills/magery/OLD/fireball.src
   trunk/096/pkg/skills/magery/OLD/flameStrike.src.temp
   trunk/096/pkg/skills/magery/OLD/gHeal.src
   trunk/096/pkg/skills/magery/OLD/gate.src
   trunk/096/pkg/skills/magery/OLD/harm.src
   trunk/096/pkg/skills/magery/OLD/heal.src
   trunk/096/pkg/skills/magery/OLD/incognito.cfg
   trunk/096/pkg/skills/magery/OLD/incognito.src
   trunk/096/pkg/skills/magery/OLD/invisibility.src
   trunk/096/pkg/skills/magery/OLD/lightning.src
   trunk/096/pkg/skills/magery/OLD/magicArrow.src
   trunk/096/pkg/skills/magery/OLD/magicLock.src
   trunk/096/pkg/skills/magery/OLD/magicTrap.src
   trunk/096/pkg/skills/magery/OLD/magicUntrap.src
   trunk/096/pkg/skills/magery/OLD/magiccircles.cfg
   trunk/096/pkg/skills/magery/OLD/manaDrain.src
   trunk/096/pkg/skills/magery/OLD/manaVamp.src
   trunk/096/pkg/skills/magery/OLD/mark.src
   trunk/096/pkg/skills/magery/OLD/massCurse.src
   trunk/096/pkg/skills/magery/OLD/massDispel.src
   trunk/096/pkg/skills/magery/OLD/meteorSwarm.src
   trunk/096/pkg/skills/magery/OLD/mindBlast.src
   trunk/096/pkg/skills/magery/OLD/nightSight.src
   trunk/096/pkg/skills/magery/OLD/pField.src
   trunk/096/pkg/skills/magery/OLD/paraField.src
   trunk/096/pkg/skills/magery/OLD/paralyze.src
   trunk/096/pkg/skills/magery/OLD/poison.src
   trunk/096/pkg/skills/magery/OLD/poisonField.src
   trunk/096/pkg/skills/magery/OLD/polymorph.src
   trunk/096/pkg/skills/magery/OLD/protection.src
   trunk/096/pkg/skills/magery/OLD/reactiveArmor.src
   trunk/096/pkg/skills/magery/OLD/recall.src
   trunk/096/pkg/skills/magery/OLD/reflect.inc
   trunk/096/pkg/skills/magery/OLD/reflect.src
   trunk/096/pkg/skills/magery/OLD/resurrect.src
   trunk/096/pkg/skills/magery/OLD/reveal.src
   trunk/096/pkg/skills/magery/OLD/spells.cfg
   trunk/096/pkg/skills/magery/OLD/strength.src
   trunk/096/pkg/skills/magery/OLD/summon.inc
   trunk/096/pkg/skills/magery/OLD/summonAir.src
   trunk/096/pkg/skills/magery/OLD/summonCreature.src
   trunk/096/pkg/skills/magery/OLD/summonDaemon.src
   trunk/096/pkg/skills/magery/OLD/summonEarth.src
   trunk/096/pkg/skills/magery/OLD/summonFire.src
   trunk/096/pkg/skills/magery/OLD/summonWater.src
   trunk/096/pkg/skills/magery/OLD/telekinesis.src
   trunk/096/pkg/skills/magery/OLD/teleport.src
   trunk/096/pkg/skills/magery/OLD/unlock.src
   trunk/096/pkg/skills/magery/OLD/vortex.src
   trunk/096/pkg/skills/magery/OLD/wallOfStone.src
   trunk/096/pkg/skills/magery/OLD/weaken.src
   trunk/096/pkg/skills/magery/config/icp.cfg
   trunk/096/pkg/skills/magery/config/settings.cfg
   trunk/096/pkg/skills/magery/include/settings.inc
   trunk/096/pkg/skills/magery/include/spells.inc
   trunk/096/pkg/skills/magery/itemdesc.cfg
   trunk/096/pkg/skills/magery/movementCheck.src
   trunk/096/pkg/skills/magery/pkg.cfg
   trunk/096/pkg/skills/magery/spellScroll/use.src
   trunk/096/pkg/skills/magery/spellStarter.src
   trunk/096/pkg/systems/attributes/config/titles.cfg
   trunk/096/pkg/systems/attributes/include/titles.inc
   trunk/096/pkg/systems/combat/config/settings.cfg
   trunk/096/pkg/systems/combat/hooks/combatAdv.src
   trunk/096/pkg/systems/combat/hooks/parryAdv.src
   trunk/096/pkg/systems/combat/include/settings.inc
   trunk/096/pkg/systems/combat/include/weaponInfo.inc
   trunk/096/pkg/systems/combat/mainHitScript.src
   trunk/096/pkg/systems/combat/old/bewitchedHit.src
   trunk/096/pkg/systems/combat/old/bladeSpiritHit.src
   trunk/096/pkg/systems/combat/old/bladed.src
   trunk/096/pkg/systems/combat/old/chargeUpkeep.src
   trunk/096/pkg/systems/combat/old/deathrobe.src
   trunk/096/pkg/systems/combat/old/destroy.src
   trunk/096/pkg/systems/combat/old/earthElemental.src
   trunk/096/pkg/systems/combat/old/equip.inc
   trunk/096/pkg/systems/combat/old/equip.src
   trunk/096/pkg/systems/combat/old/hitScriptInc.inc
   trunk/096/pkg/systems/combat/old/itemControl.src
   trunk/096/pkg/systems/combat/old/itemdesc.cfg
   trunk/096/pkg/systems/combat/old/maceHit.src
   trunk/096/pkg/systems/combat/old/magicarmor.cfg
   trunk/096/pkg/systems/combat/old/magiccloth.cfg
   trunk/096/pkg/systems/combat/old/magicweaps.cfg
   trunk/096/pkg/systems/combat/old/mobPoisonHit.src
   trunk/096/pkg/systems/combat/old/poisonHit.src
   trunk/096/pkg/systems/combat/old/reactiveArmorHit.src
   trunk/096/pkg/systems/combat/old/setWeaponHit.src
   trunk/096/pkg/systems/combat/old/silverHit.src
   trunk/096/pkg/systems/combat/old/unequip.src
   trunk/096/pkg/systems/combat/old/vortexHit.src
   trunk/096/pkg/systems/combat/old/wrestleControl.src
   trunk/096/pkg/systems/combat/old/wrestlingHitScript.src
   trunk/096/pkg/systems/combat/onDestroy.src
   trunk/096/pkg/systems/combat/syshook.cfg
   trunk/096/pkg/systems/combat/useScripts/bladed.src
   trunk/096/pkg/utils/saver/commands/coun/savenow.src
   trunk/096/pkg/utils/scheduler/include/scheduler.inc
   trunk/096/pkg/utils/scheduler/scheduler.src
   trunk/096/scripts/include/OLD/properties.inc
   trunk/096/scripts/include/time.inc
   trunk/096/scripts/start.src
Log:
Updated config package to make it more felxible for config name and elem keynames.
Added keyword ID ability to more directories.
Added Target packet hook for incoming.
Added PacketHook config package.
Added Logger package.
Moved log.inc and exception.inc to the logger package.
Updated scripts that include files moved to logger package.


Modified: trunk/096/pkg/commands/admin/unloadcfg.src
===================================================================
--- trunk/096/pkg/commands/admin/unloadcfg.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/commands/admin/unloadcfg.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -1,7 +1,7 @@
 use cfgfile;
 use uo;
 
-include "include/log";
+include ":logger:log";
 
 
 program command_unloadCFG(who, filename)

Modified: trunk/096/pkg/commands/coun/conceal.src
===================================================================
--- trunk/096/pkg/commands/coun/conceal.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/commands/coun/conceal.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -3,9 +3,9 @@
  * TODO: convert the remaining SendSysMessage()
  * must check agaist cmdlevel within the script
  */
-use uo; 
+use uo;
 
-include "include/log";
+include ":logger:log";
 include "include/messages";
 include "include/localization";
 

Modified: trunk/096/pkg/commands/gm/destroy.src
===================================================================
--- trunk/096/pkg/commands/gm/destroy.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/commands/gm/destroy.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -3,7 +3,7 @@
  */
 use uo;
 
-include "include/log";
+include ":logger:log";
 include "include/messages";
 include "include/localization";
 

Modified: trunk/096/pkg/commands/gm/kick.src
===================================================================
--- trunk/096/pkg/commands/gm/kick.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/commands/gm/kick.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -3,7 +3,7 @@
  */
 use uo;
 
-include "include/log";
+include ":logger:log";
 include "include/messages";
 include "include/localization";
 

Modified: trunk/096/pkg/commands/gm/shave.src
===================================================================
--- trunk/096/pkg/commands/gm/shave.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/commands/gm/shave.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -6,7 +6,7 @@
 include "include/client";
 include "include/messages";
 include "include/localization";
-include "include/log";
+include ":logger:log";
 
 
 program command_shave(who, area)
@@ -25,7 +25,7 @@
 		endforeach
 		return;
 	endif
-    
+
 	SendMessage(who, MSG_TARGET_OBJ, {}, MSG_COMMAND);
 	mobile := Target(who, TGTOPT_NOCHECK_LOS);
 	if (!mobile.isA(POLCLASS_MOBILE))


Property changes on: trunk/096/pkg/commands/player/cmdtoggle.src
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/096/pkg/commands/player/help.src
===================================================================
--- trunk/096/pkg/commands/player/help.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/commands/player/help.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -6,7 +6,7 @@
  */
 use uo;
 
-include "include/log";
+include ":logger:log";
 include "include/messages";
 include "include/localization";
 


Property changes on: trunk/096/pkg/commands/props/eraseglobal.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/commands/props/eraseobjproperty.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/commands/props/getCProp.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/commands/props/getglobal.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/commands/props/getprop.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/commands/props/propedit.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/commands/props/props.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/commands/props/setglobal.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/commands/props/setobjproperty.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/commands/props/setprop.src
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/096/pkg/commands/seer/rename.src
===================================================================
--- trunk/096/pkg/commands/seer/rename.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/commands/seer/rename.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -1,7 +1,7 @@
 use os;
 use uo;
 
-include "include/log";
+include ":logger:log";
 include "include/messages";
 include "include/localization";
 

Modified: trunk/096/pkg/config/include/config.inc
===================================================================
--- trunk/096/pkg/config/include/config.inc	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/config/include/config.inc	2005-11-04 06:29:43 UTC (rev 891)
@@ -1,4 +1,4 @@
-/* $Id: config.inc,v 1.1 2004/03/16 14:05:46 folko Exp $
+/* $Id$
  *
  * Purpose
  * Provide various functions and constants for the shard's behaviour.
@@ -6,10 +6,10 @@
  */
 use cfgfile;
 
-include "include/exception";
+include ":logger:exception";
 
-const SHARD_CFG     := ":config:config/shardconfig";
-const CONFIG_ELEM   := "Main";
+CONST SHARD_CFG     := ":config:config/shardconfig";
+CONST DEFAULT_KEY   := "Main";
 
 enum CFG_ENTRIES
     SHARD_NAME      := "ShardName",
@@ -17,11 +17,11 @@
 
     LINGER_STAFF    := "StaffLingerTime",
     LINGER_PLAYER   := "PlayerLingerTime",
-    
+
     REGEN_HITS      := "HitsRegenRate",
     REGEN_MANA      := "ManaRegenRate",
     REGEN_STAM      := "StamRegenRate",
-    
+
     SAVE_TIME       := "SaveTime",
     SAVE_ANNOUNCE   := "SaveAnnounce"
 endenum
@@ -30,48 +30,59 @@
 /*
  * QueryConfigString(what)
  *
- * Author: Folko
- *
  * Purpose
- * Returns a config string from the shard's main config file.
+ * Returns a config string from the config file passed. If no
+ * config file, or elem name, is passed, it uses the defaults.
+ * shardconfig.cfg is the default config file, Main is the
+ * default elem name.
  *
  * Parameters
- * what:    The name of the config elem to return
+ * what:	The name of the config elem to return
+ * cfg_file:	Optional. Packaged name of the config file.
+ * elem_name:	Optional. Elem name to look up in the config.
  *
  * Return value
  * The config file's value for the desired elem.
- * 
+ *
  */
-function QueryConfigString(what)
-    return(GetConfigString(FindConfigElem(ReadConfigFile(SHARD_CFG), CONFIG_ELEM), what));
+function QueryConfigString(what, cfg_file:=SHARD_CFG, elem_name:=DEFAULT_ELEM)
+	var ret_value := GetConfigString(FindConfigElem(ReadConfigFile(cfg_file), elem_name), what);
+	if( ret_value.errortext )
+		SysLog("Error::QueryConfigString() - Unable to open ["+cfg_file+"] ->"+ret_value.errortext);
+	endif
+	return ret_value;
 endfunction
 
 
 /*
  * QueryConfigInt(what)
  *
- * Author: Folko
+ * Returns a config integer from the config file passed. If no
+ * config file, or elem name, is passed, it uses the defaults.
+ * shardconfig.cfg is the default config file, Main is the
+ * default elem name.
  *
- * Purpose
- * Returns a config integer from the shard's main config file.
- *
  * Parameters
- * what:    The name of the config elem to return
+ * what:	The name of the config elem to return
+ * cfg_file:	Optional. Packaged name of the config file.
+ * elem_name:	Optional. Elem name to look up in the config.
  *
  * Return value
  * The config file's value for the desired elem.
- * 
+ *
  */
-function QueryConfigInt(what)
-    return(GetConfigInt(FindConfigElem(ReadConfigFile(SHARD_CFG), CONFIG_ELEM), what));
+function QueryConfigInt(what, cfg_file:=SHARD_CFG, elem_name:=DEFAULT_ELEM)
+	var ret_value := GetConfigInt(FindConfigElem(ReadConfigFile(cfg_file), elem_name), what);
+	if( ret_value.errortext )
+		SysLog("Error::QueryConfigInt() - Unable to open ["+cfg_file+"] ->"+ret_value.errortext);
+	endif
+	return ret_value;
 endfunction
 
 
 /*
  * GetShardName()
  *
- * Author: Folko
- *
  * Purpose
  * Returns the shard's name as specified in the config file.
  *
@@ -80,7 +91,7 @@
  *
  * Return value
  * The shard's name.
- * 
+ *
  */
 function GetShardName()
     return(QueryConfigString(SHARD_NAME));
@@ -90,8 +101,6 @@
 /*
  * GetStaffLingerTime()
  *
- * Author: Folko
- *
  * Purpose
  * Returns the linger time for staff in seconds.
  *
@@ -100,7 +109,7 @@
  *
  * Return value
  * The staff linger time in seconds.
- * 
+ *
  */
 function GetStaffLingerTime()
     return(QueryConfigInt(LINGER_STAFF));
@@ -110,8 +119,6 @@
 /*
  * GetPlayerLingerTime()
  *
- * Author: Folko
- *
  * Purpose
  * Returns the linger time for players in seconds.
  *
@@ -120,7 +127,7 @@
  *
  * Return value
  * The player linger time in seconds.
- * 
+ *
  */
 function GetPlayerLingerTime()
     return(QueryConfigInt(LINGER_PLAYER));
@@ -130,8 +137,6 @@
 /*
  * GetTimeZone()
  *
- * Author: Folko
- *
  * Purpose
  * Returns the timezone offset from the GMT time.
  *
@@ -140,7 +145,7 @@
  *
  * Return value
  * The offset from GMT
- * 
+ *
  */
 function GetTimeZone()
     return(QueryConfigInt(SHARD_TIMEZONE));
@@ -150,8 +155,6 @@
 /*
  * GetDefaultRegenRate(stat)
  *
- * Author: Folko
- *
  * Purpose
  * Returns the default regen rate of a stat
  *
@@ -160,7 +163,7 @@
  *
  * Return value
  * The default stat regen rate
- * 
+ *
  */
 function GetDefaultRegenRate(stat)
     if(stat != REGEN_HITS && stat != REGEN_MANA && stat != REGEN_STAM)
@@ -173,8 +176,6 @@
 /*
  * GetSaveTime()
  *
- * Author: Folko
- *
  * Purpose
  * Returns the time between saves in minutes
  *
@@ -183,7 +184,7 @@
  *
  * Return value
  * The time between saves in minutes
- * 
+ *
  */
 function GetSaveTime()
     return(QueryConfigInt(SAVE_TIME));
@@ -193,8 +194,6 @@
 /*
  * GetSaveAnnounceTime()
  *
- * Author: Folko
- *
  * Purpose
  * Returns the time of the save announcement before a save in minutes
  *
@@ -203,7 +202,7 @@
  *
  * Return value
  * The offset of the save time and announce time
- * 
+ *
  */
 function GetSaveAnnounceTime()
     return(QueryConfigInt(SAVE_ANNOUNCE));


Property changes on: trunk/096/pkg/items/blood/blood/control.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/blood/blood/onCreate.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/blood/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/blood/config/settings.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/blood/include/blood.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/blood/itemdesc.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/blood/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/containers/include/containers.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/096/pkg/items/dyes/dyeTub/use.src
===================================================================
--- trunk/096/pkg/items/dyes/dyeTub/use.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/items/dyes/dyeTub/use.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -8,10 +8,10 @@
 		SendSysMessage(mobile, "That dye tub is aleady in use.");
 		return 0;
 	endif
-	
+
 	SendSysMessage(mobile, "What do you want to use this dyetub on?");
 	var targ := target(mobile);
-	
+
 	if ( !targ )
 		SendSysMessage(mobile, "Cancelled");
 		return;
@@ -19,7 +19,7 @@
 		SendSysMessage(mobile, "That is already in use.");
 		return 0;
 	endif
-	
+
 	if ( CanDye(targ) || mobile.cmdlevel )
 		PlaySoundEffect(mobile, 0x23F);
 		targ.color := dyetub.color;

Modified: trunk/096/pkg/items/dyes/dyes/use.src
===================================================================
--- trunk/096/pkg/items/dyes/dyes/use.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/items/dyes/dyes/use.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -7,11 +7,14 @@
 	if( !ReserveItem(dyes) )
 		SendSysMessage(mobile, "Those dyes are already in use.");
 		return 0;
+	elseif( !(dyes in EnumerateItemsInContainer(mobile.backpack)) )
+		SendSysMessage(mobile, "That item is not in your backpack.");
+		return 0;
 	endif
-	
+
 	SendSysMessage(mobile, "What do you want to use these dyes on?");
 	var targ := target(mobile);
-	
+
 	if ( !targ )
 		SendSysMessage(mobile, "Cancelled");
 		return 0;
@@ -19,7 +22,7 @@
 		SendSysMessage(mobile, "That is already in use.");
 		return 0;
 	endif
-	
+
 	if ( (CanDye(targ)) || (mobile.cmdlevel) )
 		var color := SelectColor(mobile, targ);
 		if ( ValidDyeColor(mobile, color) )

Modified: trunk/096/pkg/items/dyes/furnitureTub/use.src
===================================================================
--- trunk/096/pkg/items/dyes/furnitureTub/use.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/items/dyes/furnitureTub/use.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -8,10 +8,10 @@
 		SendSysMessage(mobile, "That dye tub is aleady in use.");
 		return 0;
 	endif
-	
+
 	SendSysMessage(mobile, "What do you want to use this dyetub on?");
 	var targ := target(mobile);
-	
+
 	if ( !targ )
 		SendSysMessage(mobile, "Cancelled");
 		return;
@@ -25,7 +25,7 @@
 		SendSysMessage(mobile, "That targ is not locked down.");
 		return 0;
 	endif
-	
+
 	if ( GetObjProperty(targ, "furniture") || mobile.cmdlevel )
 		PlaySoundEffect(mobile, 0x23F);
 		targ.color := dyetub.color;

Modified: trunk/096/pkg/items/dyes/include/dyes.inc
===================================================================
--- trunk/096/pkg/items/dyes/include/dyes.inc	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/items/dyes/include/dyes.inc	2005-11-04 06:29:43 UTC (rev 891)
@@ -34,12 +34,13 @@
 function CanDye(item)
 	var config := ReadConfigFile(":*:itemdesc");
 	config := config[item.objtype];
-	
+
 	if ( config.CanDye )
 		return 1;
 	elseif ( config.dyeable )
 		return 1;
 	endif
+	return 0;
 endfunction
 
 /*
@@ -82,6 +83,6 @@
 function RandomDyeColor()
 	var color := RandomInt(MAX_COLOR - MIN_COLOR);
 	color := color+MIN_COLOR;
-	
+
 	return color;
 endfunction


Property changes on: trunk/096/pkg/items/feces/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/feces/itemdesc.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/feces/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/feces/poop/use.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/training/archeryButte/use.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/training/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/training/include/training.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/training/itemdesc.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/training/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/training/pocketDip/use.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/training/trainingDummy/control.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/training/trainingDummy/use.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/vomit/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/vomit/config/settings.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/vomit/itemdesc.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/vomit/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/vomit/vomit/control.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/vomit/vomit/onCreate.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/walkOn/spiderWeb/control.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/about.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/changelog.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/configsettings.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/conversion.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/docs.css
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/eventId.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/index.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/menu.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/npcCommands.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/npcError.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/npcInit.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/npcNerves.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/npcSettings.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/npcUtil.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/npcWatchList.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/docs/scripttypes.html
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/include/npcSounds.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/combat/genericAnimal.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/combat/rigger.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/doubleClick/cowTip.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/endFight/endFightAnimal.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/enterArea/generic.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/leftArea/generic.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/lookAround/findAttackables.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/lookAround/findFeared.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/shouldWatch/targetPlayers.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/shouldWatch/watchFeared.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/sleep/generic.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/commands/gm/addTimer.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/commands/gm/curePoisons.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/commands/gm/listTimers.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/commands/gm/lowerTimer.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/config/timedScripts.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/include/poisonUtil.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/include/timedScripts.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/logon.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/reconnect.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/subScripts/food/alcohol.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/subScripts/odors/flatulence.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/subScripts/odors/poostink.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/endParalysis.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/subScripts/paralysis/paralysis.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/subScripts/poison/defaultPoison.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/timedScripts/timerControl.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/CharProfile/charprofile.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/CharProfile/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/CharProfile/onDelete.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/CharProfile/parseCharProfile.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/CharProfile/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/CharProfile/uopacket.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/OpenDoor/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/OpenDoor/openDoor.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/OpenDoor/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/OpenDoor/uopacket.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/packetHooks/PacketConfig/config/icp.cfg
===================================================================
--- trunk/096/pkg/packetHooks/PacketConfig/config/icp.cfg	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/packetHooks/PacketConfig/config/icp.cfg	2005-11-04 06:29:43 UTC (rev 891)
@@ -0,0 +1,19 @@
+# $Id: icp.cfg 878 2005-11-03 08:08:29Z muaddiblsd $
+#
+#
+ICP Register
+{
+	Name		Packethook Configuration
+	Version		1.0
+	Description	Settings for various Packet Hooks used in Distro.
+
+	Creator		MuadDib
+	C_Email		muaddib at lostsoulsshard.org
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}

Added: trunk/096/pkg/packetHooks/PacketConfig/config/packetconfig.cfg
===================================================================
--- trunk/096/pkg/packetHooks/PacketConfig/config/packetconfig.cfg	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/packetHooks/PacketConfig/config/packetconfig.cfg	2005-11-04 06:29:43 UTC (rev 891)
@@ -0,0 +1,11 @@
+# $Id$
+#
+#
+# Purpose
+# Configure various packet behaviours
+#
+
+ConfigSet Target
+{
+	Enabled		1
+}
\ No newline at end of file

Added: trunk/096/pkg/packetHooks/PacketConfig/pkg.cfg
===================================================================
--- trunk/096/pkg/packetHooks/PacketConfig/pkg.cfg	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/packetHooks/PacketConfig/pkg.cfg	2005-11-04 06:29:43 UTC (rev 891)
@@ -0,0 +1,6 @@
+Enabled		1
+Name		packetconfig
+Maintainer	Distro Team
+Email		distro at polserver.com
+CoreRequired	96
+Version		1.0


Property changes on: trunk/096/pkg/packetHooks/RequestAttack/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/RequestAttack/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/RequestAttack/requestAttack.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/RequestAttack/uopacket.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/096/pkg/packetHooks/StatHook/sendStats.src
===================================================================
--- trunk/096/pkg/packetHooks/StatHook/sendStats.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/packetHooks/StatHook/sendStats.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -1,3 +1,6 @@
+/* $Id$
+ *
+ */
 ////////////////////////////////////////////////////////////////////////////////////////////////////
 //
 //  name:    Send Stats Packet Hook

Added: trunk/096/pkg/packetHooks/Target/config/icp.cfg
===================================================================
--- trunk/096/pkg/packetHooks/Target/config/icp.cfg	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/packetHooks/Target/config/icp.cfg	2005-11-04 06:29:43 UTC (rev 891)
@@ -0,0 +1,19 @@
+# $Id: icp.cfg 878 2005-11-03 08:08:29Z muaddiblsd $
+#
+#
+ICP Register
+{
+	Name		Targetting Packet Hook
+	Version		1.0
+	Description	PacketHook for handling Targetting Packets.
+
+	Creator		MuadDib
+	C_Email		muaddib at lostsoulsshard.org
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}

Added: trunk/096/pkg/packetHooks/Target/pkg.cfg
===================================================================
--- trunk/096/pkg/packetHooks/Target/pkg.cfg	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/packetHooks/Target/pkg.cfg	2005-11-04 06:29:43 UTC (rev 891)
@@ -0,0 +1,6 @@
+Enabled		1
+Name		targethook
+Maintainer	Distro Team
+Email		distro at polserver.com
+CoreRequired	96
+Version		1.0

Added: trunk/096/pkg/packetHooks/Target/targetHook.src
===================================================================
--- trunk/096/pkg/packetHooks/Target/targetHook.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/packetHooks/Target/targetHook.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -0,0 +1,66 @@
+/* $Id$
+ *
+ */
+////////////////////////////////////////////////////////////////////////////////////////////////////
+//
+//  name:    Incoming Targetting Packet Hook
+//  version: 1.0
+//  author:  MuadDib
+//
+//  Purpose:  This hooks fixes issues involving having LOS to hidden characters, and targetting
+//		concealed characters above your cmdlevel.
+//
+///////////////////////////////////////////////////////////////////////////////////////////////
+use uo;
+use os;
+
+include ":config:config";
+
+CONST TYPE_MOB    := 0;
+CONST SERIAL_BYTE := 6;
+CONST X_BYTE      := 11;
+CONST Y_BYTE      := 13;
+CONST Z_BYTE      := 16;
+CONST GRAPHIC_BYTE := 17;
+
+program TargetCheck()
+	Print("Installing Incoming Target PH.");
+	return 1;
+endprogram
+
+exported function HandleTargetPacket(who, byref packet)
+	var enabled := QueryConfigInt("Enabled", ":packetconfig:config/packetconfig", "Target");
+	if( !enabled )
+		return 0;
+	endif
+
+	var the_target;
+	var packet_type := packet.GetInt8(1);
+	if( packet_type == TYPE_MOB )
+		the_target := packet.GetInt32(SERIAL_BYTE);
+		the_target := SystemFindObjectBySerial(the_target);
+		// If player level, check for player restrictions.
+		if(!who.cmdlevel)
+			if(the_target.hidden || the_target.concealed)
+				packet.SetInt32(SERIAL_BYTE, 0);
+				packet.SetInt16(X_BYTE, 0xFFFF);
+				packet.SetInt16(Y_BYTE, 0xFFFF);
+				packet.SetInt8(Z_BYTE, 0);
+				packet.SetInt16(GRAPHIC_BYTE, 0);
+				return 0;
+			endif
+		else
+			// Makes sure they are not attempting to target someone
+			// concealed at a higher level than themselves.
+			if(the_target.concealed > who.cmdlevel)
+				packet.SetInt32(SERIAL_BYTE, 0);
+				packet.SetInt16(X_BYTE, 0xFFFF);
+				packet.SetInt16(Y_BYTE, 0xFFFF);
+				packet.SetInt8(Z_BYTE, 0);
+				packet.SetInt16(GRAPHIC_BYTE, 0);
+				return 0;
+			endif
+		endif
+	endif
+	return 0;
+endfunction

Added: trunk/096/pkg/packetHooks/Target/uopacket.cfg
===================================================================
--- trunk/096/pkg/packetHooks/Target/uopacket.cfg	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/packetHooks/Target/uopacket.cfg	2005-11-04 06:29:43 UTC (rev 891)
@@ -0,0 +1,5 @@
+Packet 0x6C
+{
+  Length 19
+  ReceiveFunction targetHook:HandleTargetPacket
+}


Property changes on: trunk/096/pkg/packetHooks/WarAndPeace/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/WarAndPeace/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/WarAndPeace/readme.txt
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/WarAndPeace/requestWar.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/WarAndPeace/uopacket.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/lumberjacking/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/lumberjacking/config/settings.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/lumberjacking/config/woodRegions.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/lumberjacking/include/settings.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/lumberjacking/lumberJack.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/lumberjacking/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/lumberjacking/start.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/lumberjacking/treeRegen/control.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/agility.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/archCure.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/archProt.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/bladeSpirit.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/bless.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/chainLightning.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/clumsy.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/createFood.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/cunning.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/cure.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/curse.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/dispel.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/dispelField.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/eBolt.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/earthquake.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/energyField.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/explosion.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/feeblemind.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/fireField.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/fireball.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/flameStrike.src.temp
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/gHeal.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/gate.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/harm.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/heal.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/incognito.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/incognito.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/invisibility.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/lightning.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/magicArrow.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/magicLock.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/magicTrap.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/magicUntrap.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/magiccircles.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/manaDrain.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/manaVamp.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/mark.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/massCurse.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/massDispel.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/meteorSwarm.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/mindBlast.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/nightSight.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/pField.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/paraField.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/paralyze.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/poison.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/poisonField.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/polymorph.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/protection.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/reactiveArmor.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/recall.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/reflect.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/reflect.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/resurrect.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/reveal.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/spells.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/strength.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/summon.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/summonAir.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/summonCreature.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/summonDaemon.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/summonEarth.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/summonFire.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/summonWater.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/telekinesis.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/teleport.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/unlock.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/vortex.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/wallOfStone.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/OLD/weaken.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/config/settings.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/include/settings.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/include/spells.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/itemdesc.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/movementCheck.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/spellScroll/use.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/spellStarter.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/attributes/config/titles.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/attributes/include/titles.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/config/settings.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/hooks/combatAdv.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/hooks/parryAdv.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/include/settings.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/include/weaponInfo.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/mainHitScript.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/bewitchedHit.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/bladeSpiritHit.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/bladed.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/chargeUpkeep.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/deathrobe.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/destroy.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/earthElemental.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/equip.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/equip.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/hitScriptInc.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/itemControl.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/itemdesc.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/maceHit.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/magicarmor.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/magiccloth.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/magicweaps.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/mobPoisonHit.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/poisonHit.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/reactiveArmorHit.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/setWeaponHit.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/silverHit.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/unequip.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/vortexHit.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/wrestleControl.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/old/wrestlingHitScript.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/onDestroy.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/syshook.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/useScripts/bladed.src
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/logger/config/icp.cfg
===================================================================
--- trunk/096/pkg/utils/logger/config/icp.cfg	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/utils/logger/config/icp.cfg	2005-11-04 06:29:43 UTC (rev 891)
@@ -0,0 +1,16 @@
+# $Id$
+#
+#
+ICP Register
+{
+	Name		Script Logger
+	Version		1.0
+	Description	Includes for handling Logging from scripts.
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}


Property changes on: trunk/096/pkg/utils/logger/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/logger/include/exception.inc
===================================================================
--- trunk/096/pkg/utils/logger/include/exception.inc	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/utils/logger/include/exception.inc	2005-11-04 06:29:43 UTC (rev 891)
@@ -0,0 +1,35 @@
+/* $Id$
+ *
+ * Purpose
+ * Provides various functions and constants for exceptions.
+ *
+ */
+use uo;
+
+include ":logger:log";
+
+
+/*
+ * Exception(what)
+ *
+ * Author: Folko
+ *
+ * Purpose
+ * Raises and exception and logs it to the error log.
+ *
+ * Parameters
+ * what:        A string describing the error
+ *
+ * Return value
+ * Always returns an error-object
+ *
+ * Notes
+ * Only use this for script errors etc., we don't want spam in the error log.
+ *
+ */
+function Exception(what)
+	print("******Exception: " + what + "******");
+	Log(LOG_ERROR, "Exception: " + what);
+
+	return(error);
+endfunction


Property changes on: trunk/096/pkg/utils/logger/include/exception.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/logger/include/log.inc
===================================================================
--- trunk/096/pkg/utils/logger/include/log.inc	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/utils/logger/include/log.inc	2005-11-04 06:29:43 UTC (rev 891)
@@ -0,0 +1,70 @@
+/* $Id$
+ *
+ * Purpose
+ * Provide various functions and constants to log stuff
+ *
+ * TODO:
+ * Implement log roll over.
+ *
+ */
+use basic;
+use file;
+
+include "include/time";
+
+enum LOG_FILES
+	LOG_MAIN        := "::log/mainlog.log",
+	LOG_ERROR       := "::log/errorlog.log",
+	LOG_WARNING     := "::log/warning.log",
+	LOG_ACCESS      := "::log/access.log",
+	LOG_COMMAND     := "::log/commands.log"
+endenum
+
+
+/*
+ * Log(file, line)
+ *
+ * Author: Folko
+ *
+ * Purpose
+ * Adds a timestamp to a string and logs it to a file.
+ *
+ * Parameters
+ * file:    The logfile where the string will be logged to
+ * line:    The string to log
+ *
+ * Return value
+ * No return value.
+ * 
+ */
+function Log(file, line)
+	LogToFile(file, AddTimeStamp(line));
+
+	return;
+endfunction
+
+
+/*
+ * GetLogInfo(what)
+ *
+ * Author: Folko
+ *
+ * Purpose
+ * Returns name and serial for logging purposes.
+ *
+ * Parameters
+ * what:    The thing of which to return name and serial
+ *
+ * Return value
+ * String describing the thing for logging
+ * 
+ */
+function GetLogInfo(what)
+	if(what.isA(POLCLASS_MOBILE))
+		return(what.name + "(" + Hex(what.serial) + ")");
+	else
+		return(what.desc + "(" + Hex(what.serial) + ")");
+	endif
+
+	return;
+endfunction


Property changes on: trunk/096/pkg/utils/logger/include/log.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/logger/pkg.cfg
===================================================================
--- trunk/096/pkg/utils/logger/pkg.cfg	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/utils/logger/pkg.cfg	2005-11-04 06:29:43 UTC (rev 891)
@@ -0,0 +1,13 @@
+# $Id$
+#
+#
+Enabled		1
+Name		logger
+Version		1.0
+
+CoreRequired	94
+
+Maintainer	Distro Team
+Email		distro at polserver.com
+
+#conflicts	none


Property changes on: trunk/096/pkg/utils/logger/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/096/pkg/utils/saver/commands/coun/savenow.src
===================================================================
--- trunk/096/pkg/utils/saver/commands/coun/savenow.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/utils/saver/commands/coun/savenow.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -1,10 +1,10 @@
-/* $Id: savenow.src,v 1.1 2004/03/16 14:05:46 folko Exp $
+/* $Id$
  *
  * Purpose:
  * Save the world state.
  *
  */
-include "include/log";
+include ":logger:log";
 include ":saver:include/saver";
 
 

Modified: trunk/096/pkg/utils/scheduler/include/scheduler.inc
===================================================================
--- trunk/096/pkg/utils/scheduler/include/scheduler.inc	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/utils/scheduler/include/scheduler.inc	2005-11-04 06:29:43 UTC (rev 891)
@@ -29,7 +29,7 @@
  */
 use os;
 
-include "include/exception";
+include ":logger:exception";
 include "include/properties";
 
 const SCHED_TIMEOUT := 5;               // Timeout for Wait_For_Event()
@@ -52,7 +52,7 @@
  *
  * Return value
  * No return value.
- * 
+ *
  */
 function Wait(what, time := SCHED_TIMEOUT)
 	while(Wait_For_Event(time) != what)
@@ -73,7 +73,7 @@
  *
  * Return value
  * No return value.
- * 
+ *
  */
 function Send(what)
 	var sched := GetProcess(GetGlobalProperty(TEMPPROP_SCHED_PID));

Modified: trunk/096/pkg/utils/scheduler/scheduler.src
===================================================================
--- trunk/096/pkg/utils/scheduler/scheduler.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/pkg/utils/scheduler/scheduler.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -10,7 +10,7 @@
 use cfgfile;
 use os;
 
-include "include/exception";
+include ":logger:exception";
 include ":scheduler:scheduler";
 
 

Deleted: trunk/096/scripts/include/OLD/exception.inc
===================================================================
--- trunk/096/scripts/include/OLD/exception.inc	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/scripts/include/OLD/exception.inc	2005-11-04 06:29:43 UTC (rev 891)
@@ -1,35 +0,0 @@
-/* $Id: exception.inc 236 2005-09-25 09:06:19Z panosl $
- *
- * Purpose
- * Provides various functions and constants for exceptions.
- *
- */
-use uo;
-
-include "include/log";
-
-
-/*
- * Exception(what)
- *
- * Author: Folko
- *
- * Purpose
- * Raises and exception and logs it to the error log.
- *
- * Parameters
- * what:        A string describing the error
- *
- * Return value
- * Always returns an error-object
- *
- * Notes
- * Only use this for script errors etc., we don't want spam in the error log.
- *
- */
-function Exception(what)
-	print("******Exception: " + what + "******");
-	Log(LOG_ERROR, "Exception: " + what);
-
-	return(error);
-endfunction

Modified: trunk/096/scripts/include/OLD/properties.inc
===================================================================
--- trunk/096/scripts/include/OLD/properties.inc	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/scripts/include/OLD/properties.inc	2005-11-04 06:29:43 UTC (rev 891)
@@ -6,7 +6,7 @@
  */
 use uo;
 
-include "include/log";
+include ":logger:log";
 
 const SECURE_MAGIC          := 0xBADC0DE;
 
@@ -76,7 +76,7 @@
     if(magic == SECURE_MAGIC)
         return(GetObjPropertyNames(what));
     endif
-    
+
     props := GetObjPropertyNames(what);
     for(i := 1; i <= props.size(); i := i + 1)
         if(props[i][1] == "+")

Deleted: trunk/096/scripts/include/log.inc
===================================================================
--- trunk/096/scripts/include/log.inc	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/scripts/include/log.inc	2005-11-04 06:29:43 UTC (rev 891)
@@ -1,70 +0,0 @@
-/* $Id: log.inc,v 1.1 2004/03/16 14:05:46 folko Exp $
- *
- * Purpose
- * Provide various functions and constants to log stuff
- *
- * TODO:
- * Implement log roll over.
- *
- */
-use basic;
-use file;
-
-include "include/time";
-
-enum LOG_FILES
-	LOG_MAIN        := "::log/mainlog.log",
-	LOG_ERROR       := "::log/errorlog.log",
-	LOG_WARNING     := "::log/warning.log",
-	LOG_ACCESS      := "::log/access.log",
-	LOG_COMMAND     := "::log/commands.log"
-endenum
-
-
-/*
- * Log(file, line)
- *
- * Author: Folko
- *
- * Purpose
- * Adds a timestamp to a string and logs it to a file.
- *
- * Parameters
- * file:    The logfile where the string will be logged to
- * line:    The string to log
- *
- * Return value
- * No return value.
- * 
- */
-function Log(file, line)
-	LogToFile(file, AddTimeStamp(line));
-
-	return;
-endfunction
-
-
-/*
- * GetLogInfo(what)
- *
- * Author: Folko
- *
- * Purpose
- * Returns name and serial for logging purposes.
- *
- * Parameters
- * what:    The thing of which to return name and serial
- *
- * Return value
- * String describing the thing for logging
- * 
- */
-function GetLogInfo(what)
-	if(what.isA(POLCLASS_MOBILE))
-		return(what.name + "(" + Hex(what.serial) + ")");
-	else
-		return(what.desc + "(" + Hex(what.serial) + ")");
-	endif
-
-	return;
-endfunction

Modified: trunk/096/scripts/include/time.inc
===================================================================
--- trunk/096/scripts/include/time.inc	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/scripts/include/time.inc	2005-11-04 06:29:43 UTC (rev 891)
@@ -7,7 +7,7 @@
 use uo;
 
 include "include/properties";
-include "include/exception";
+include ":logger:exception";
 include ":config:include/config";
 
 enum TIME_UNITS

Modified: trunk/096/scripts/start.src
===================================================================
--- trunk/096/scripts/start.src	2005-11-04 06:14:45 UTC (rev 890)
+++ trunk/096/scripts/start.src	2005-11-04 06:29:43 UTC (rev 891)
@@ -12,8 +12,8 @@
 use uo;
 use os;
 
-include "include/exception";
-include "include/log";
+include ":logger:exception";
+include ":logger:log";
 include "include/utility";
 include "include/teleporters";
 



From muaddiblsd at berlios.de  Fri Nov  4 07:51:04 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Fri, 4 Nov 2005 07:51:04 +0100
Subject: [Poldistro-svn] r892 - in trunk/096: pkg/packetHooks/OpenDoor scripts/include scripts/include/OLD
Message-ID: <200511040651.jA46p4HJ016082@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-04 07:51:00 +0100 (Fri, 04 Nov 2005)
New Revision: 892

Added:
   trunk/096/scripts/include/properties.inc
Removed:
   trunk/096/scripts/include/OLD/properties.inc
Modified:
   trunk/096/pkg/packetHooks/OpenDoor/openDoor.src
Log:
Moved properties.inc back into /scripts/include for now. Could this get packaged somewhere??

Added break; to the case in OpenDoor. Maybe Austin will bitch less about using break; now. I doubt it.

Modified: trunk/096/pkg/packetHooks/OpenDoor/openDoor.src
===================================================================
--- trunk/096/pkg/packetHooks/OpenDoor/openDoor.src	2005-11-04 06:29:43 UTC (rev 891)
+++ trunk/096/pkg/packetHooks/OpenDoor/openDoor.src	2005-11-04 06:51:00 UTC (rev 892)
@@ -45,14 +45,14 @@
  	// The only exception is while they are running, which who cares about
  	// those trying to run non-stop through a door eh? ;)
  	case(direction)
- 		0: item := ListItemsNearLocationWithFlag((character.x),(character.y-1),(character.z),0,TILEDATA_FLAG_DOOR);
- 		1: item := ListItemsNearLocationWithFlag((character.x+1),(character.y-1),(character.z),0,TILEDATA_FLAG_DOOR);
- 		2: item := ListItemsNearLocationWithFlag((character.x+1),(character.y),(character.z),0,TILEDATA_FLAG_DOOR);
- 		3: item := ListItemsNearLocationWithFlag((character.x+1),(character.y+1),(character.z),0,TILEDATA_FLAG_DOOR);
- 		4: item := ListItemsNearLocationWithFlag((character.x),(character.y+1),(character.z),0,TILEDATA_FLAG_DOOR);
- 		5: item := ListItemsNearLocationWithFlag((character.x-1),(character.y+1),(character.z),0,TILEDATA_FLAG_DOOR);
- 		6: item := ListItemsNearLocationWithFlag((character.x-1),(character.y),(character.z),0,TILEDATA_FLAG_DOOR);
- 		7: item := ListItemsNearLocationWithFlag((character.x-1),(character.y-1),(character.z),0,TILEDATA_FLAG_DOOR);
+ 		0: item := ListItemsNearLocationWithFlag((character.x),(character.y-1),(character.z),0,TILEDATA_FLAG_DOOR); break;
+ 		1: item := ListItemsNearLocationWithFlag((character.x+1),(character.y-1),(character.z),0,TILEDATA_FLAG_DOOR); break;
+ 		2: item := ListItemsNearLocationWithFlag((character.x+1),(character.y),(character.z),0,TILEDATA_FLAG_DOOR); break;
+ 		3: item := ListItemsNearLocationWithFlag((character.x+1),(character.y+1),(character.z),0,TILEDATA_FLAG_DOOR); break;
+ 		4: item := ListItemsNearLocationWithFlag((character.x),(character.y+1),(character.z),0,TILEDATA_FLAG_DOOR); break;
+ 		5: item := ListItemsNearLocationWithFlag((character.x-1),(character.y+1),(character.z),0,TILEDATA_FLAG_DOOR); break;
+ 		6: item := ListItemsNearLocationWithFlag((character.x-1),(character.y),(character.z),0,TILEDATA_FLAG_DOOR); break;
+ 		7: item := ListItemsNearLocationWithFlag((character.x-1),(character.y-1),(character.z),0,TILEDATA_FLAG_DOOR); break;
  	endcase
  	// See if item found is a Door. Check if the player has Line Of Sight to the door. Make sure they
  	// Are ALIVE!

Deleted: trunk/096/scripts/include/OLD/properties.inc
===================================================================
--- trunk/096/scripts/include/OLD/properties.inc	2005-11-04 06:29:43 UTC (rev 891)
+++ trunk/096/scripts/include/OLD/properties.inc	2005-11-04 06:51:00 UTC (rev 892)
@@ -1,88 +0,0 @@
-/* $Id: properties.inc 236 2005-09-25 09:06:19Z panosl $
- *
- * Purpose
- * Provide property names and functions. Properties starting with "+" are to be protected.
- *
- */
-use uo;
-
-include ":logger:log";
-
-const SECURE_MAGIC          := 0xBADC0DE;
-
-enum MOB_PROPS
-    PROP_STAFF_LEVEL        := "+StaffLevel",        // Text command access level
-    PROP_CREATION_TIME      := "CreationTime",       // Character creation time (UNIX timestamp)
-    MOB_CPROPS_END          := 0
-endenum
-
-enum ITEM_PROPS
-    ITEM_CPROPS_END         := 0
-endenum
-
-enum WORLD_PROPS
-    PROP_PID                := "#PID",              // Array with all resistent scripts
-    PROP_TIMESTAMP          := "TimeStamp",         // Struct describing the time
-    WORLD_PROPS_END         := 0
-endenum
-
-
-// These properties only exist for a short time
-enum TEMP_PROPS
-    TEMPPROP_JUST_CREATED   := "#JustCreated",      // Character was just created
-    TEMPPROP_SCHED_PID      := "#SchedPID",         // PID of script scheduler
-    TEMP_PROPS_END          := 0
-endenum
-
-
-/*
- * The following functions replace the default ObjProperty functions. Use these instead to avoid
- * changing secured properies. If your script is safe, pass SECURE_MAGIC as magic.
- *
- */
-function SetProperty(what, property, value, magic := 0)
-    if(property[1] == "+")
-        if(magic == SECURE_MAGIC)
-            Log(LOG_WARNING, "Overwrote secure property '" + property + "' with '" + CStr(value) + "' on '" +
-                GetLogInfo(what) + "'");
-        else
-            Log(LOG_ERROR, "Failed to overwrite secure property '" + property + "' with '" + CStr(value) + "' on '" +
-                GetLogInfo(what) + "'");
-            return(error);
-        endif
-    endif
-    return(SetObjProperty(what, property, value));
-endfunction
-
-function GetProperty(what, property, magic := 0)
-    if(property[1] == "+" && magic != SECURE_MAGIC)
-        Log(LOG_ERROR, "Refused to GetProperty on secure property '" + property + "' on '" + GetLogInfo(what) + "'");
-        return(error);
-    endif
-    return(GetObjProperty(what, property));
-endfunction
-
-function EraseProperty(what, property, magic := 0)
-    if(property[1] == "+" && magic != SECURE_MAGIC)
-        Log(LOG_ERROR, "Refused to erase secure property '" + property + "' on '" + GetLogInfo(what) + "'");
-        return(error);
-    endif
-    return(EraseObjProperty(what, property));
-endfunction
-
-function GetPropertyNames(what, magic := 0)
-    var props, i;
-
-    if(magic == SECURE_MAGIC)
-        return(GetObjPropertyNames(what));
-    endif
-
-    props := GetObjPropertyNames(what);
-    for(i := 1; i <= props.size(); i := i + 1)
-        if(props[i][1] == "+")
-            props.erase(i);
-            i := i - 1;
-        endif
-    endfor
-    return(props);
-endfunction

Added: trunk/096/scripts/include/properties.inc
===================================================================
--- trunk/096/scripts/include/properties.inc	2005-11-04 06:29:43 UTC (rev 891)
+++ trunk/096/scripts/include/properties.inc	2005-11-04 06:51:00 UTC (rev 892)
@@ -0,0 +1,88 @@
+/* $Id$
+ *
+ * Purpose
+ * Provide property names and functions. Properties starting with "+" are to be protected.
+ *
+ */
+use uo;
+
+include ":logger:log";
+
+const SECURE_MAGIC          := 0xBADC0DE;
+
+enum MOB_PROPS
+    PROP_STAFF_LEVEL        := "+StaffLevel",        // Text command access level
+    PROP_CREATION_TIME      := "CreationTime",       // Character creation time (UNIX timestamp)
+    MOB_CPROPS_END          := 0
+endenum
+
+enum ITEM_PROPS
+    ITEM_CPROPS_END         := 0
+endenum
+
+enum WORLD_PROPS
+    PROP_PID                := "#PID",              // Array with all resistent scripts
+    PROP_TIMESTAMP          := "TimeStamp",         // Struct describing the time
+    WORLD_PROPS_END         := 0
+endenum
+
+
+// These properties only exist for a short time
+enum TEMP_PROPS
+    TEMPPROP_JUST_CREATED   := "#JustCreated",      // Character was just created
+    TEMPPROP_SCHED_PID      := "#SchedPID",         // PID of script scheduler
+    TEMP_PROPS_END          := 0
+endenum
+
+
+/*
+ * The following functions replace the default ObjProperty functions. Use these instead to avoid
+ * changing secured properies. If your script is safe, pass SECURE_MAGIC as magic.
+ *
+ */
+function SetProperty(what, property, value, magic := 0)
+    if(property[1] == "+")
+        if(magic == SECURE_MAGIC)
+            Log(LOG_WARNING, "Overwrote secure property '" + property + "' with '" + CStr(value) + "' on '" +
+                GetLogInfo(what) + "'");
+        else
+            Log(LOG_ERROR, "Failed to overwrite secure property '" + property + "' with '" + CStr(value) + "' on '" +
+                GetLogInfo(what) + "'");
+            return(error);
+        endif
+    endif
+    return(SetObjProperty(what, property, value));
+endfunction
+
+function GetProperty(what, property, magic := 0)
+    if(property[1] == "+" && magic != SECURE_MAGIC)
+        Log(LOG_ERROR, "Refused to GetProperty on secure property '" + property + "' on '" + GetLogInfo(what) + "'");
+        return(error);
+    endif
+    return(GetObjProperty(what, property));
+endfunction
+
+function EraseProperty(what, property, magic := 0)
+    if(property[1] == "+" && magic != SECURE_MAGIC)
+        Log(LOG_ERROR, "Refused to erase secure property '" + property + "' on '" + GetLogInfo(what) + "'");
+        return(error);
+    endif
+    return(EraseObjProperty(what, property));
+endfunction
+
+function GetPropertyNames(what, magic := 0)
+    var props, i;
+
+    if(magic == SECURE_MAGIC)
+        return(GetObjPropertyNames(what));
+    endif
+
+    props := GetObjPropertyNames(what);
+    for(i := 1; i <= props.size(); i := i + 1)
+        if(props[i][1] == "+")
+            props.erase(i);
+            i := i - 1;
+        endif
+    endfor
+    return(props);
+endfunction


Property changes on: trunk/096/scripts/include/properties.inc
___________________________________________________________________
Name: svn:keywords
   + Id



From muaddiblsd at berlios.de  Fri Nov  4 07:55:34 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Fri, 4 Nov 2005 07:55:34 +0100
Subject: [Poldistro-svn] r893 - trunk/096/pkg/config/include
Message-ID: <200511040655.jA46tYm2018269@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-04 07:55:17 +0100 (Fri, 04 Nov 2005)
New Revision: 893

Modified:
   trunk/096/pkg/config/include/config.inc
Log:
Retard typo

Modified: trunk/096/pkg/config/include/config.inc
===================================================================
--- trunk/096/pkg/config/include/config.inc	2005-11-04 06:51:00 UTC (rev 892)
+++ trunk/096/pkg/config/include/config.inc	2005-11-04 06:55:17 UTC (rev 893)
@@ -45,7 +45,7 @@
  * The config file's value for the desired elem.
  *
  */
-function QueryConfigString(what, cfg_file:=SHARD_CFG, elem_name:=DEFAULT_ELEM)
+function QueryConfigString(what, cfg_file:=SHARD_CFG, elem_name:=DEFAULT_KEY)
 	var ret_value := GetConfigString(FindConfigElem(ReadConfigFile(cfg_file), elem_name), what);
 	if( ret_value.errortext )
 		SysLog("Error::QueryConfigString() - Unable to open ["+cfg_file+"] ->"+ret_value.errortext);
@@ -71,7 +71,7 @@
  * The config file's value for the desired elem.
  *
  */
-function QueryConfigInt(what, cfg_file:=SHARD_CFG, elem_name:=DEFAULT_ELEM)
+function QueryConfigInt(what, cfg_file:=SHARD_CFG, elem_name:=DEFAULT_KEY)
 	var ret_value := GetConfigInt(FindConfigElem(ReadConfigFile(cfg_file), elem_name), what);
 	if( ret_value.errortext )
 		SysLog("Error::QueryConfigInt() - Unable to open ["+cfg_file+"] ->"+ret_value.errortext);



From muaddiblsd at berlios.de  Fri Nov  4 07:58:01 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Fri, 4 Nov 2005 07:58:01 +0100
Subject: [Poldistro-svn] r894 - trunk/096/pkg/config/include
Message-ID: <200511040658.jA46w1PU019782@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-04 07:57:50 +0100 (Fri, 04 Nov 2005)
New Revision: 894

Modified:
   trunk/096/pkg/config/include/config.inc
Log:
Added syslogging to cfg file errors

Modified: trunk/096/pkg/config/include/config.inc
===================================================================
--- trunk/096/pkg/config/include/config.inc	2005-11-04 06:55:17 UTC (rev 893)
+++ trunk/096/pkg/config/include/config.inc	2005-11-04 06:57:50 UTC (rev 894)
@@ -6,6 +6,7 @@
  */
 use cfgfile;
 
+include ":logger:log";
 include ":logger:exception";
 
 CONST SHARD_CFG     := ":config:config/shardconfig";



From muaddiblsd at berlios.de  Fri Nov  4 08:01:40 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Fri, 4 Nov 2005 08:01:40 +0100
Subject: [Poldistro-svn] r895 - trunk/096/pkg/config/include
Message-ID: <200511040701.jA471eY1021264@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-04 08:01:37 +0100 (Fri, 04 Nov 2005)
New Revision: 895

Modified:
   trunk/096/pkg/config/include/config.inc
Log:


Modified: trunk/096/pkg/config/include/config.inc
===================================================================
--- trunk/096/pkg/config/include/config.inc	2005-11-04 06:57:50 UTC (rev 894)
+++ trunk/096/pkg/config/include/config.inc	2005-11-04 07:01:37 UTC (rev 895)
@@ -5,8 +5,8 @@
  *
  */
 use cfgfile;
+use basic;
 
-include ":logger:log";
 include ":logger:exception";
 
 CONST SHARD_CFG     := ":config:config/shardconfig";



From muaddiblsd at berlios.de  Fri Nov  4 08:04:04 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Fri, 4 Nov 2005 08:04:04 +0100
Subject: [Poldistro-svn] r896 - trunk/096/pkg/config/include
Message-ID: <200511040704.jA4744h7022447@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-04 08:03:59 +0100 (Fri, 04 Nov 2005)
New Revision: 896

Modified:
   trunk/096/pkg/config/include/config.inc
Log:


Modified: trunk/096/pkg/config/include/config.inc
===================================================================
--- trunk/096/pkg/config/include/config.inc	2005-11-04 07:01:37 UTC (rev 895)
+++ trunk/096/pkg/config/include/config.inc	2005-11-04 07:03:59 UTC (rev 896)
@@ -5,7 +5,7 @@
  *
  */
 use cfgfile;
-use basic;
+use os;
 
 include ":logger:exception";
 



From muaddiblsd at berlios.de  Fri Nov  4 08:22:25 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Fri, 4 Nov 2005 08:22:25 +0100
Subject: [Poldistro-svn] r897 - in trunk/096/pkg/skills/magery/OLD: . config
Message-ID: <200511040722.jA47MP09028671@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-04 08:22:07 +0100 (Fri, 04 Nov 2005)
New Revision: 897

Added:
   trunk/096/pkg/skills/magery/OLD/agility.src.temp
   trunk/096/pkg/skills/magery/OLD/archCure.src.temp
   trunk/096/pkg/skills/magery/OLD/archProt.src.temp
   trunk/096/pkg/skills/magery/OLD/bladeSpirit.src.temp
   trunk/096/pkg/skills/magery/OLD/bless.src.temp
   trunk/096/pkg/skills/magery/OLD/chainLightning.src.temp
   trunk/096/pkg/skills/magery/OLD/clumsy.src.temp
   trunk/096/pkg/skills/magery/OLD/config/icp.cfg.temp
   trunk/096/pkg/skills/magery/OLD/createFood.src.temp
   trunk/096/pkg/skills/magery/OLD/cunning.src.temp
   trunk/096/pkg/skills/magery/OLD/cure.src.temp
   trunk/096/pkg/skills/magery/OLD/curse.src.temp
   trunk/096/pkg/skills/magery/OLD/dispel.src.temp
   trunk/096/pkg/skills/magery/OLD/dispelField.src.temp
   trunk/096/pkg/skills/magery/OLD/eBolt.src.temp
   trunk/096/pkg/skills/magery/OLD/earthquake.src.temp
   trunk/096/pkg/skills/magery/OLD/energyField.src.temp
   trunk/096/pkg/skills/magery/OLD/explosion.src.temp
   trunk/096/pkg/skills/magery/OLD/feeblemind.src.temp
   trunk/096/pkg/skills/magery/OLD/fireField.src.temp
   trunk/096/pkg/skills/magery/OLD/fireball.src.temp
   trunk/096/pkg/skills/magery/OLD/gHeal.src.temp
   trunk/096/pkg/skills/magery/OLD/gate.src.temp
   trunk/096/pkg/skills/magery/OLD/harm.src.temp
   trunk/096/pkg/skills/magery/OLD/heal.src.temp
   trunk/096/pkg/skills/magery/OLD/incognito.cfg.temp
   trunk/096/pkg/skills/magery/OLD/incognito.src.temp
   trunk/096/pkg/skills/magery/OLD/invisibility.src.temp
   trunk/096/pkg/skills/magery/OLD/lightning.src.temp
   trunk/096/pkg/skills/magery/OLD/magicArrow.src.temp
   trunk/096/pkg/skills/magery/OLD/magicLock.src.temp
   trunk/096/pkg/skills/magery/OLD/magicTrap.src.temp
   trunk/096/pkg/skills/magery/OLD/magicUntrap.src.temp
   trunk/096/pkg/skills/magery/OLD/magiccircles.cfg.temp
   trunk/096/pkg/skills/magery/OLD/manaDrain.src.temp
   trunk/096/pkg/skills/magery/OLD/manaVamp.src.temp
   trunk/096/pkg/skills/magery/OLD/mark.src.temp
   trunk/096/pkg/skills/magery/OLD/massCurse.src.temp
   trunk/096/pkg/skills/magery/OLD/massDispel.src.temp
   trunk/096/pkg/skills/magery/OLD/meteorSwarm.src.temp
   trunk/096/pkg/skills/magery/OLD/mindBlast.src.temp
   trunk/096/pkg/skills/magery/OLD/nightSight.src.temp
   trunk/096/pkg/skills/magery/OLD/pField.src.temp
   trunk/096/pkg/skills/magery/OLD/paraField.src.temp
   trunk/096/pkg/skills/magery/OLD/paralyze.src.temp
   trunk/096/pkg/skills/magery/OLD/poison.src.temp
   trunk/096/pkg/skills/magery/OLD/poisonField.src.temp
   trunk/096/pkg/skills/magery/OLD/polymorph.src.temp
   trunk/096/pkg/skills/magery/OLD/protection.src.temp
   trunk/096/pkg/skills/magery/OLD/reactiveArmor.src.temp
   trunk/096/pkg/skills/magery/OLD/recall.src.temp
   trunk/096/pkg/skills/magery/OLD/reflect.inc.temp
   trunk/096/pkg/skills/magery/OLD/reflect.src.temp
   trunk/096/pkg/skills/magery/OLD/resurrect.src.temp
   trunk/096/pkg/skills/magery/OLD/reveal.src.temp
   trunk/096/pkg/skills/magery/OLD/spells.cfg.temp
   trunk/096/pkg/skills/magery/OLD/strength.src.temp
   trunk/096/pkg/skills/magery/OLD/summon.inc.temp
   trunk/096/pkg/skills/magery/OLD/summonAir.src.temp
   trunk/096/pkg/skills/magery/OLD/summonCreature.src.temp
   trunk/096/pkg/skills/magery/OLD/summonDaemon.src.temp
   trunk/096/pkg/skills/magery/OLD/summonEarth.src.temp
   trunk/096/pkg/skills/magery/OLD/summonFire.src.temp
   trunk/096/pkg/skills/magery/OLD/summonWater.src.temp
   trunk/096/pkg/skills/magery/OLD/telekinesis.src.temp
   trunk/096/pkg/skills/magery/OLD/teleport.src.temp
   trunk/096/pkg/skills/magery/OLD/unlock.src.temp
   trunk/096/pkg/skills/magery/OLD/vortex.src.temp
   trunk/096/pkg/skills/magery/OLD/wallOfStone.src.temp
   trunk/096/pkg/skills/magery/OLD/weaken.src.temp
Removed:
   trunk/096/pkg/skills/magery/OLD/agility.src
   trunk/096/pkg/skills/magery/OLD/archCure.src
   trunk/096/pkg/skills/magery/OLD/archProt.src
   trunk/096/pkg/skills/magery/OLD/bladeSpirit.src
   trunk/096/pkg/skills/magery/OLD/bless.src
   trunk/096/pkg/skills/magery/OLD/chainLightning.src
   trunk/096/pkg/skills/magery/OLD/clumsy.src
   trunk/096/pkg/skills/magery/OLD/config/icp.cfg
   trunk/096/pkg/skills/magery/OLD/createFood.src
   trunk/096/pkg/skills/magery/OLD/cunning.src
   trunk/096/pkg/skills/magery/OLD/cure.src
   trunk/096/pkg/skills/magery/OLD/curse.src
   trunk/096/pkg/skills/magery/OLD/dispel.src
   trunk/096/pkg/skills/magery/OLD/dispelField.src
   trunk/096/pkg/skills/magery/OLD/eBolt.src
   trunk/096/pkg/skills/magery/OLD/earthquake.src
   trunk/096/pkg/skills/magery/OLD/energyField.src
   trunk/096/pkg/skills/magery/OLD/explosion.src
   trunk/096/pkg/skills/magery/OLD/feeblemind.src
   trunk/096/pkg/skills/magery/OLD/fireField.src
   trunk/096/pkg/skills/magery/OLD/fireball.src
   trunk/096/pkg/skills/magery/OLD/gHeal.src
   trunk/096/pkg/skills/magery/OLD/gate.src
   trunk/096/pkg/skills/magery/OLD/harm.src
   trunk/096/pkg/skills/magery/OLD/heal.src
   trunk/096/pkg/skills/magery/OLD/incognito.cfg
   trunk/096/pkg/skills/magery/OLD/incognito.src
   trunk/096/pkg/skills/magery/OLD/invisibility.src
   trunk/096/pkg/skills/magery/OLD/lightning.src
   trunk/096/pkg/skills/magery/OLD/magicArrow.src
   trunk/096/pkg/skills/magery/OLD/magicLock.src
   trunk/096/pkg/skills/magery/OLD/magicTrap.src
   trunk/096/pkg/skills/magery/OLD/magicUntrap.src
   trunk/096/pkg/skills/magery/OLD/magiccircles.cfg
   trunk/096/pkg/skills/magery/OLD/manaDrain.src
   trunk/096/pkg/skills/magery/OLD/manaVamp.src
   trunk/096/pkg/skills/magery/OLD/mark.src
   trunk/096/pkg/skills/magery/OLD/massCurse.src
   trunk/096/pkg/skills/magery/OLD/massDispel.src
   trunk/096/pkg/skills/magery/OLD/meteorSwarm.src
   trunk/096/pkg/skills/magery/OLD/mindBlast.src
   trunk/096/pkg/skills/magery/OLD/nightSight.src
   trunk/096/pkg/skills/magery/OLD/pField.src
   trunk/096/pkg/skills/magery/OLD/paraField.src
   trunk/096/pkg/skills/magery/OLD/paralyze.src
   trunk/096/pkg/skills/magery/OLD/poison.src
   trunk/096/pkg/skills/magery/OLD/poisonField.src
   trunk/096/pkg/skills/magery/OLD/polymorph.src
   trunk/096/pkg/skills/magery/OLD/protection.src
   trunk/096/pkg/skills/magery/OLD/reactiveArmor.src
   trunk/096/pkg/skills/magery/OLD/recall.src
   trunk/096/pkg/skills/magery/OLD/reflect.inc
   trunk/096/pkg/skills/magery/OLD/reflect.src
   trunk/096/pkg/skills/magery/OLD/resurrect.src
   trunk/096/pkg/skills/magery/OLD/reveal.src
   trunk/096/pkg/skills/magery/OLD/spells.cfg
   trunk/096/pkg/skills/magery/OLD/strength.src
   trunk/096/pkg/skills/magery/OLD/summon.inc
   trunk/096/pkg/skills/magery/OLD/summonAir.src
   trunk/096/pkg/skills/magery/OLD/summonCreature.src
   trunk/096/pkg/skills/magery/OLD/summonDaemon.src
   trunk/096/pkg/skills/magery/OLD/summonEarth.src
   trunk/096/pkg/skills/magery/OLD/summonFire.src
   trunk/096/pkg/skills/magery/OLD/summonWater.src
   trunk/096/pkg/skills/magery/OLD/telekinesis.src
   trunk/096/pkg/skills/magery/OLD/teleport.src
   trunk/096/pkg/skills/magery/OLD/unlock.src
   trunk/096/pkg/skills/magery/OLD/vortex.src
   trunk/096/pkg/skills/magery/OLD/wallOfStone.src
   trunk/096/pkg/skills/magery/OLD/weaken.src
Log:
Renamed all the OLD crap to .temp.

Deleted: trunk/096/pkg/skills/magery/OLD/agility.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/agility.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/agility.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,21 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/statMod";
-include ":attributes:attributes";
-
-program agility( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  PlaySoundEffect(caster, 0x1e8);
-  PlayObjectCenteredEffect(caster, 0x373a, 7,7);
-  if(!CanMod(castOn, "dex"))
-    SendSysMessage(caster,"Another existing effect negates your spell!");
-    return;
-  endif
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := GetModAmount( magery );
-  var duration := GetModDuration( magery );
-  DoTempMod(castOn, "dex", modAmount, duration);
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/agility.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/agility.src)

Deleted: trunk/096/pkg/skills/magery/OLD/archCure.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/archCure.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/archCure.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,48 +0,0 @@
-use uo;
-use cfgfile;
-
-include "include/eventID";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":timedscripts:timedScripts";
-include ":timedscripts:poisonUtil";
-
-program archCure(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var npccfg := ReadConfigFile("::npcdesc");
-  PlaySoundEffect(caster, SFX_SPELL_ARCH_CURE);
-  var magery := AP_GetSkill(caster, MAGERY);
-  var potency := CInt(AP_GetSkill( caster, MAGERY ) /33)+1;
-  foreach castOn in ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, CInt(magery/15), caster.realm );
-    if((CheckLineOfSight(castOn, caster)) and (castOn.cmdlevel < 2))
-	  PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 10,10);
-      if(castOn.isA(POLCLASS_NPC))
-        var element := npccfg[castOn.npctemplate].elemental;
-        if(element == "poison")
-          var ev := array;
-          ev.+ type;
-          ev.+ source;
-          ev.type := EVID_PEACEMADE;
-          SendEvent(castOn, ev);
-          ev.source := caster;
-          SendEvent(castOn, ev);
-          ev.type := EVID_ENGAGED;
-          SendEvent(castOn, ev);
-          ApplyRawDamage(castOn, potency);
-        endif
-      endif
-      if (TS_GetTimerNames(castOn, "P").size() > 0)
-        TS_CurePoison(castOn, 180, "P", potency);
-        if (TS_GetTimerNames(castOn, "P").size() > 0)
-          SendSysMessage(caster, "You cure some poison.");  
-          SendSysMessage(castOn, caster.name + " has partially cured you!");
-        else
-          SendSysMessage(caster, castOn.name + " cured.");
-          SendSysMessage(castOn, caster.name + " has cured you completely!");
-        endif
-      endif
-    endif
-  endforeach
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/archCure.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/archCure.src)

Deleted: trunk/096/pkg/skills/magery/OLD/archProt.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/archProt.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/archProt.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,27 +0,0 @@
-use uo;
-use os;
-
-include "include/sound";
-include "include/tileEffects";
-include "include/statMod";
-include ":attributes:attributes";
-
-
-program archProtection(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	PlaySoundEffect(caster, SFX_SPELL_PROTECTION);
-	var magery := AP_GetSkill(caster, MAGERY);
-	var modAmount := CInt(RandomInt(6) + 5);
-	var duration := GetModDuration( magery );
-	foreach castOn in ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, CInt(magery/15), caster.realm );
-		if ((CheckLineOfSight(castOn, caster)) and (castOn.cmdlevel < 2))
-			if (CanMod(castOn, "ar"))
-				PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 7,7);
-				DoTempMod(castOn, "ar", modAmount, duration);
-			endif
-		endif
-	endforeach
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/archProt.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/archProt.src)

Deleted: trunk/096/pkg/skills/magery/OLD/bladeSpirit.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/bladeSpirit.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/bladeSpirit.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,23 +0,0 @@
-use uo;
-use os;
-use util;
-
-include ":attributes:attributes";
-include "include/tileEffects";
-include "include/sound";
-
-
-program bladeSpirit(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var thecritter := CreateNpcFromTemplate("bladespirit", castOn.x, castOn.y, castOn.z, 0, caster.realm);
-  PlaySoundEffect(thecritter, SFX_SPELL_BLADE_SPIRITS);
-  SetObjProperty(thecritter, "summoned", 1);
-  SetObjProperty(thecritter, "master", caster.serial);
-  Detach();
-  sleep( (AP_GetSkill( caster, MAGERY ) ) );
-  PlaySoundEffect( thecritter, SFX_SPELL_MANA_VAMPIRE );
-  PlayStationaryEffect( thecritter.x, thecritter.y, thecritter.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
-  MoveCharacterToLocation(thecritter,0,0,0,MOVECHAR_FORCELOCATION);
-  ApplyRawDamage(thecritter, AP_GetVital(thecritter, "Hits") + 3);
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/bladeSpirit.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/bladeSpirit.src)

Deleted: trunk/096/pkg/skills/magery/OLD/bless.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/bless.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/bless.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,28 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/statMod";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-
-
-program bless(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  PlaySoundEffect(castOn, SFX_SPELL_BLESS);
-  PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 10,10);
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := GetModAmount(magery);
-  var duration := GetModDuration(magery);
-  if(CanMod(castOn, "str"))
-	DoTempMod(castOn, "str", modAmount, duration);
-  endif
-  if(CanMod(castOn, "dex"))
-	DoTempMod(castOn, "dex", modAmount, duration);
-  endif
-  if(CanMod(castOn, "int"))
-	DoTempMod(castOn, "int", modAmount, duration);
-  endif
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/bless.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/bless.src)

Deleted: trunk/096/pkg/skills/magery/OLD/chainLightning.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/chainLightning.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/chainLightning.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,40 +0,0 @@
-use uo;
-use os;
-use util;
-use cfgfile;
-
-include ":magery:reflect";
-include "include/spellAttack";
-include "include/sound";
-include "include/tileEffects";
-include "include/magic";
-
-program chainLightning( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  var dmg;
-  var range := 2;
-  var victims := ListMobilesNearLocationEx( castOn.x, castOn.y, castOn.z, range, 0x03, caster.realm);
-  Detach();
-  foreach mobile in victims
-    if((CheckLineOfSight(mobile, caster)) and (mobile.cmdlevel < 2))
-      SetObjProperty(mobile, "LastHit", {caster.name, caster.serial, "chain lightning"});
-      if(spell_reflect(mobile))
-        mobile := caster;
-      endif
-      dmg := RandomDiceRoll("6d8");
-      send_attack(mobile,caster, 49);
-      PlayLightningBoltEffect( mobile );
-      PlaySoundEffect(mobile, SFX_SPELL_LIGHTNING);
-      if(mobile.isA(POLCLASS_NPC))
-        dmg := dmg * 2;
-      endif
-      ApplyRawDamage( mobile, Resisted(circle,caster,mobile,dmg) );
-      sleepms(600);
-    endif
-  endforeach
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/chainLightning.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/chainLightning.src)

Deleted: trunk/096/pkg/skills/magery/OLD/clumsy.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/clumsy.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/clumsy.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,34 +0,0 @@
-use uo;
-use os;
-use util;
-use cfgfile;
-
-include "include/statMod";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include "reflect";
-include "include/magic";
-
-program clumsy( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "clumsy" });
-  if(spell_reflect(castOn))
-	castOn := caster;
-  endif
-  PlaySoundEffect(castOn, SFX_SPELL_CURE);
-  PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 7,7);
-  if(!CanMod(castOn, "dex"))
-	SendSysMessage(caster,"Already under the influence!");
-	return;
-  endif
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := Resisted(circle,caster,castOn,(GetModAmount( magery )));
-  var duration := GetModDuration( magery );
-  DoTempMod(castOn, "dex", 0 - modAmount, duration);
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/clumsy.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/clumsy.src)

Deleted: trunk/096/pkg/skills/magery/OLD/config/icp.cfg
===================================================================
--- trunk/096/pkg/skills/magery/OLD/config/icp.cfg	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/config/icp.cfg	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,12 +0,0 @@
-ICP Register
-{
-        Name            Magery
-        Version         1.0
-        Description     Magery Skill
-
-        Creator         Distro Team
-        C_Email         distro at polserver.com
-
-        Maintainer      Distro Team
-        M_Email         distro at polserver.com
-}

Copied: trunk/096/pkg/skills/magery/OLD/config/icp.cfg.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/config/icp.cfg)

Deleted: trunk/096/pkg/skills/magery/OLD/createFood.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/createFood.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/createFood.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,25 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/client";
-
-
-program spell_createFood(parms)
-	var caster := parms.caster;
-	var food;
-	case (RandomInt(8))
-		0:	food := 0x09c9;
-		1:	food := 0x09ea;
-		2:	food := 0x1040;
-		3:	food := 0x09b7;
-		4: 	food := 0x1608;
-		5: 	food := 0x09e9;
-		6: 	food := 0x1044;
-		7: 	food := 0x0c77;
-	endcase
-	PlaySoundEffect(caster, 0x01e3);
-	CreateItemInBackpack(caster, food, 1);
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/createFood.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/createFood.src)

Deleted: trunk/096/pkg/skills/magery/OLD/cunning.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/cunning.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/cunning.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,28 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/statMod";
-include "include/client";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-
-
-program spell_cunning(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	PlaySoundEffect(castOn, SFX_SPELL_CUNNING);
-	PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 7,7);
-	if (!CanMod(castOn, "int"))
-		SendSysMessage(caster,"Already under the influence!");
-		return;
-	endif
-	var magery := AP_GetSkill(caster, MAGERY);
-	var modAmount := GetModAmount( magery );
-	var duration := GetModDuration( magery );
-	DoTempMod(castOn, "int", modAmount, duration);
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/cunning.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/cunning.src)

Deleted: trunk/096/pkg/skills/magery/OLD/cure.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/cure.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/cure.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,44 +0,0 @@
-use uo;
-use cfgfile;
-
-include "include/eventID";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include ":timedscripts:timedScripts";
-include ":timedscripts:poisonUtil";
-
-
-program cure( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var npccfg := ReadConfigFile("::npcdesc");
-  PlaySoundEffect(caster, SFX_SPELL_CURE);
-  PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 10,10);
-  var potency := CInt(AP_GetSkill(caster, MAGERY) / 33) +1;
-  if(castOn.isA(POLCLASS_NPC))
-    var element := npccfg[castOn.npctemplate].elemental;
-    if(element == "poison")
-      var ev := array;
-      ev.+ type;
-      ev.+ source;
-      ev.type := EVID_PEACEMADE;
-      SendEvent(castOn, ev);
-      ev.source := caster;
-      SendEvent(castOn, ev);
-      ev.type := EVID_ENGAGED;
-      SendEvent(castOn, ev);
-      ApplyRawDamage(castOn, potency);
-    endif
-  endif
-  if (TS_GetTimerNames(castOn, "P").size() > 0)
-    TS_CurePoison(castOn, 120, "P", potency);
-    if (TS_GetTimerNames(castOn, "P").size() > 0)
-      SendSysMessage(caster, "You cure some poison.");  
-      SendSysMessage(castOn, caster.name + " has partially cured you!");
-    else
-      SendSysMessage(caster, castOn.name + " cured.");
-      SendSysMessage(castOn, caster.name + " has cured you completely!");
-    endif
-  endif
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/cure.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/cure.src)

Deleted: trunk/096/pkg/skills/magery/OLD/curse.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/curse.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/curse.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,37 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/statMod";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include "include/magic";
-include "reflect";
-
-program curse( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  PlaySoundEffect(castOn, SFX_SPELL_CURSE);
-  PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 10,10);
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := Resisted(circle,caster,castOn,GetModAmount( magery ));
-  var duration := GetModDuration( magery );
-	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "curse" });
-  if(spell_reflect(castOn))
-	castOn := caster;
-  endif
-  if (CanMod(castOn, "str"))
-	DoTempMod(castOn, "str", 0- modAmount, duration);
-  endif
-  if (CanMod(castOn, "dex"))
-	DoTempMod(castOn, "dex", 0- modAmount, duration);
-  endif
-  if (CanMod(castOn, "int"))
-	DoTempMod(castOn, "int", 0- modAmount, duration);
-  endif
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/curse.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/curse.src)

Deleted: trunk/096/pkg/skills/magery/OLD/dispel.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/dispel.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/dispel.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,53 +0,0 @@
-use uo;
-use cfgfile;
-
-include "include/eventID";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include "include/spellAttack";
-include "include/magic";
-
-program dispel( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-  var npccfg := ReadConfigFile("::npcdesc");
-
-  var summoned := GetObjProperty( castOn, "summoned");
-  if(summoned == 1)
-    PlaySoundEffect( caster, 0x202 );
-    PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_HEAL_EFFECT, 0xa, 0xa,0 , caster.realm );
-    var master := SystemFindObjectBySerial(CInt(GetObjProperty(castOn, "master")));
-    if(master)
-      var resist := AP_GetSkill(master, RESISTING_SPELLS);
-      if((RandomInt(99) + 1) < resist)
-        MoveCharacterToLocation(castOn,0,0,0,MOVECHAR_FORCELOCATION);
-        ApplyRawDamage(castOn, AP_GetVitalMaximumValue(caston, HITS) + 3);
-      endif
-      send_attack(caster, castOn, 41);
-    endif
-  else
-    if(castOn.isA(POLCLASS_NPC))
-      var element := npccfg[castOn.npctemplate].elemental;
-      if(element == "undead")
-        PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_HEAL_EFFECT, 0xa, 0xa, 0, caster.realm );
-        var ev := array;
-        ev.+ type;
-        ev.+ source;
-        ev.type := EVID_PEACEMADE;
-        SendEvent(castOn, ev);
-        ev.source := caster;
-        SendEvent(castOn, ev);
-        ev.type := EVID_ENGAGED;
-        SendEvent(castOn, ev);
-        PlaySoundEffect(caster, 0x202);
-        PlayObjectCenteredEffect(castOn, 0x37b9, 0x03, 0x0a);
-        var dmg := CalcSpellDamage(circle, caster) + (RandomInt(20));
-        ApplyRawDamage(castOn, Resisted(circle, caster, castOn, dmg));
-      endif
-    endif
-  endif
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/dispel.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/dispel.src)

Deleted: trunk/096/pkg/skills/magery/OLD/dispelField.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/dispelField.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/dispelField.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,22 +0,0 @@
-use uo;
-use os;
-
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-
-
-program dispelField( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var magery := AP_GetSkill(caster, MAGERY);
-  var therange := CInt(magery / 15 );
-  var items := ListItemsNearLocation(castOn.x, castOn.y, castOn.z, therange, caster.realm);
-  PlaySoundEffect( caster, SFX_SPELL_DISPEL );
-  foreach item in items
-	if (GetObjProperty(item, "f") == "1")
-	  PlayStationaryEffect( item.x, item.y, item.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
-      DestroyItem(item);
-	endif
-  endforeach
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/dispelField.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/dispelField.src)

Deleted: trunk/096/pkg/skills/magery/OLD/eBolt.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/eBolt.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/eBolt.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,48 +0,0 @@
-use uo;
-use os;
-use util;
-use cfgfile;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include "include/spellAttack";
-include ":magery:reflect";
-include "include/magic";
-
-
-program spell_eBolt(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-
-	if (!castOn.container)
-		PlayMovingEffect( caster, castOn, FX_ENERGY_BOLT, 0xa, 0x1e );
-	endif
-	PlaySoundEffect( caster, SFX_SPELL_ENERGY_BOLT );
-	SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "ebolt" } );
-	if (spell_reflect(castOn))
-		castOn := caster;
-		PlayMovingEffect( caster, castOn, FX_ENERGY_BOLT, 0xa, 0x1e );
-		PlaySoundEffect( caster, SFX_SPELL_ENERGY_BOLT );
-	endif
-	var dmg := RandomDiceRoll("5d8");
-	if (spell_reflect(castOn))
-		PlayMovingEffect( castOn, caster, FX_ENERGY_BOLT, 0xa, 0x1e );
-		PlaySoundEffect( castOn, SFX_SPELL_ENERGY_BOLT );
-		castOn := caster;
-		if (GetObjProperty( caster, "mr") == "1")
-			EraseObjProperty(caster, "mr");
-			SendSysMessage(caster, "Your magic reflect spell saved you!");
-			return;
-		endif
-  	endif
-	if (castOn.isA(POLCLASS_NPC))
-		dmg := dmg * 2;
-	endif
-	ApplyRawDamage(castOn, Resisted(circle, caster, castOn, dmg));
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/eBolt.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/eBolt.src)

Deleted: trunk/096/pkg/skills/magery/OLD/earthquake.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/earthquake.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/earthquake.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,40 +0,0 @@
-use uo;
-use util;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include "include/spellAttack";
-include "include/magic";
-
-
-program spell_earthquake(parms)
-	var caster := parms.caster;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-	var range := 12;
-	var victims := ListMobilesNearLocationEx( caster.x, caster.y, caster.z, range, LISTEX_FLAG_NORMAL + LISTEX_FLAG_HIDDEN, caster.realm );
-	var dmg;
-
-	PlaySoundEffect( caster, SFX_220 );
-	foreach mobile in victims
-		if ((mobile.serial != caster.serial) and (mobile.cmdlevel < 2))
-			SetObjProperty(mobile, "LastHit", {caster.name,caster.serial, "earthquake" });
-			send_attack(mobile,caster, 57);
-			dmg := RandomDiceRoll("7d7");
-			PrintTextAbovePrivate( mobile,"You are tossed about as the earth trembles below your feet!", mobile );
-			PlaySoundEffect( mobile, SFX_SPELL_EARTHQUAKE );
-			PlayObjectCenteredEffect( mobile, FX_SMOKE, 7, 7);
-			if (mobile.isA(POLCLASS_NPC))
-				dmg := dmg * 2;
-			endif
-	  		ApplyRawDamage( mobile, Resisted(circle,caster,mobile,dmg) );
-		endif
-	endforeach
-	sleep(2);
-	PlaySoundEffect(caster, SFX_223);
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/earthquake.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/earthquake.src)

Deleted: trunk/096/pkg/skills/magery/OLD/energyField.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/energyField.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/energyField.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,28 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/fields";
-include ":attributes:attributes";
-include "include/objtype";
-
-
-program spell_energyField( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var fields := {};
-  var x := castOn.x;
-  var y := castOn.y;
-  var z := castOn.z;
-  case(get_direction(caster))
-	"NS" : fields := CreateNorthSouthField(caster, UOBJ_EFIELD_NS, x, y, z, 5);
-	"EW" : fields := CreateEastWestField(caster, UOBJ_EFIELD_EW, x, y, z, 5);
-  endcase
-  PlaySoundEffect(caster,0x20c);
-  Detach();
-  var duration := 20 + ( CInt(AP_GetSkill(caster, MAGERY) ) / 3 );
-  sleep(duration);
-  foreach fieldpart in fields
-    DestroyItem(fieldpart);
-  endforeach
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/energyField.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/energyField.src)

Deleted: trunk/096/pkg/skills/magery/OLD/explosion.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/explosion.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/explosion.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,36 +0,0 @@
-use os;
-use uo;
-use cfgfile;
-
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include "include/spellAttack";
-include ":magery:reflect";
-include "include/magic";
-
-program spell_explosion(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-	var dmg;
-
-	SetObjProperty(castOn, "LastHit", ( {caster.name, caster.serial, "explosion" } ) );
-	if(spell_reflect(castOn))
-		castOn := caster;
-	endif
-  dmg := RandomDiceRoll("7d6");
-  Detach();
-  sleep(4);
-  send_attack(castOn,caster, 43);
-  PlaySoundEffect( castOn, SFX_SPELL_EXPLOSION );
-  PlayStationaryEffect( castOn.x,castOn.y,castOn.z, FX_EXPLODE_3, 7, 0x10, 0 , caster.realm );
-  if(AP_GetVital(castOn, HITS) >= 1)
-    if(castOn.npctemplate)
-      dmg := dmg * 2;
-    endif
-    ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
-  endif
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/explosion.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/explosion.src)

Deleted: trunk/096/pkg/skills/magery/OLD/feeblemind.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/feeblemind.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/feeblemind.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,35 +0,0 @@
-use uo;
-use os;
-use util;
-use cfgfile;
-
-include "include/statMod";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include ":magery:reflect";
-include "include/magic";
-
-
-program spell_feeblemind(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "feeblemind" });
-  if (spell_reflect(castOn))
-	castOn := caster;
-  endif
-  PlaySoundEffect(castOn, SFX_SPELL_FEEBLEMIND);
-  PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 7, 7 );
-  if (!CanMod(castOn, "int"))
-	SendSysMessage(caster,"Already under the influence!");
-	return;
-  endif
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := Resisted(circle,caster,castOn,(GetModAmount( magery )));
-  var duration := GetModDuration( magery );
-  DoTempMod(castOn, "int", 0 - modAmount, duration);
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/feeblemind.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/feeblemind.src)

Deleted: trunk/096/pkg/skills/magery/OLD/fireField.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/fireField.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/fireField.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,27 +0,0 @@
-include "include/fields";
-include ":attributes:attributes";
-include "include/client";
-include "include/firewall";
-
-
-program spell_fireField(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var fields := {};
-	var x := castOn.x;
-	var y := castOn.y;
-	var z := castOn.z;
-	case (get_direction(caster))
-		"NS" : fields := CreateNorthSouthField(caster, UOBJ_FIREFIELD_NS, x, y, z, 5);
-		"EW" : fields := CreateEastWestField(caster, UOBJ_FIREFIELD_EW, x, y, z, 5);
-	endcase
-	PlaySoundEffect(caster, 0x20d);
-	Detach();
-	var duration := 20 + ( CInt(AP_GetSkill(caster, MAGERY) ) / 3 );
-	sleep(duration);
-	foreach fieldpart in fields
-		DestroyItem(fieldpart);
-	endforeach
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/fireField.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/fireField.src)

Deleted: trunk/096/pkg/skills/magery/OLD/fireball.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/fireball.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/fireball.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,33 +0,0 @@
-use uo;
-use cfgfile;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-
-
-program spell_fireball(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  PlayMovingEffect(caster, castOn, FX_FIREBALL, 5, 1);
-  PlaySoundEffect(caster, 0x15f);
-  var dmg := RandomDiceRoll("3d6");
-  SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "fireball"});
-  if (spell_reflect(castOn))
-    PlayMovingEffect(castOn, caster, FX_FIREBALL, 5, 1);
-    PlaySoundEffect(castOn, 0x15f);
-    castOn := caster;
-  endif
-  if (AP_GetVital(castOn, HITS) >= 1)
-    if(castOn.npctemplate)
-      dmg := dmg * 2;
-    endif
-    ApplyRawDamage(castOn, Resisted(circle,caster,castOn, dmg));
-  endif
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/fireball.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/fireball.src)

Deleted: trunk/096/pkg/skills/magery/OLD/gHeal.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/gHeal.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/gHeal.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,25 +0,0 @@
-use uo;
-use os;
-use util;
-
-include ":attributes:attributes";
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-
-
-program spell_greaterHeal(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var healed := RandomDiceRoll("1d3");
-	healed := CInt(AP_GetSkill(caster, MAGERY)/2) + healed;
-	SendSysMessage(caster, "You healed " + healed + " damage.");
-	if (castOn.isA(POLCLASS_NPC))
-		healed := healed * 2;
-	endif
-	HealDamage(castOn, healed);
-	PlayObjectCenteredEffect( castOn, FX_SPARK_EFFECT, 7, 0x10 );
-	PlaySoundEffect( castOn, SFX_SPELL_GREATER_HEAL );
-
-	return;
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/gHeal.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/gHeal.src)

Deleted: trunk/096/pkg/skills/magery/OLD/gate.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/gate.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/gate.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,130 +0,0 @@
-use os;
-use uo;
-
-include "include/isValidLoc";
-include "include/objtype";
-include "include/client";
-include "include/sound";
-
-
-program spell_gate(parms)
-  var caster := parms.caster;
-  var castOn := Target(caster);
-  if((castOn.objtype != UOBJ_RUNE) && (castOn.objtype != 0x6100))
-    SendSysMessage(caster, "You can only cast that on a recall rune!");
-    return;
-  endif
-  var tox := CInt(GetObjProperty( castOn, "x" ));
-  var toy := CInt(GetObjProperty( castOn, "y" ));
-  var toz := CInt(GetObjProperty( castOn, "z" ));
-  var torealm := GetObjProperty( castOn, "realm" );
-  if(!tox)
-    SendSysMessage(caster, "The rune must be marked.");
-    return;
-  endif
-  if(!torealm)
-  	torealm := "britannia";
-  endif  
-  if(!ReserveItem(castOn))
-    return;
-  endif
-  if(GetObjProperty(castOn, "Vendored"))
-    SendSysMessage(caster, "You cannot gate off of runes on a vendor.");
-    return;
-  endif
-  if(!isValidLoc(tox,toy))
-    SendSysMessage(caster, "You may not gate into Green Acres.");
-    ReleaseItem(castOn);
-    DestroyItem(castOn);
-    return;
-  endif
-  PlaySoundEffect( caster, SFX_SPELL_GATE_TRAVEL );
-  var chk := 0;
-  if((caster.x >= 5120) && (caster.x <= 5375) && (caster.y >= 0) && (caster.y <= 255))
-    SendSysMessage(caster, "Your spell fails and consumes the rune!");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    elseif(castOn.objtype == 0x6100)
-      removeentry(castOn);
-    endif
-    chk := 1;
-  endif
-  var multicheck := CreateItemAtLocation(1, 1, 0, 0xeed, 1, torealm);
-  multicheck.hidden := 1;
-  if(!MoveItemToLocation(multicheck, tox, toy, toz, MOVEITEM_NORMAL))
-    SendSysMessage(caster, "Something is blocking the location.");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    elseif(castOn.objtype == 0x6100)
-      removeentry(castOn);
-    endif
-    chk := 1;
-  endif
-  if(multicheck.multi)
-    SendSysMessage(caster,"Something is blocking the location.");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    elseif(castOn.objtype == 0x6100)
-      removeentry(castOn);
-    endif
-    chk := 1;
-  endif
-  DestroyItem(multicheck);
-  if(chk == 1)
-    return;
-  endif
-  var wx := caster.x;
-  var wy := caster.y;
-  var wz := caster.z;
-  PlayStationaryEffect( wx, wy, wz, 6899, 1, 30, 0, caster.realm );
-  PlayStationaryEffect( tox, toy, toz, 6899, 1, 30, 0, caster.realm );
-  sleepms(2800);
-  set_critical( 1 );
-  var gate1 := CreateItemAtLocation( wx, wy, wz, UOBJ_BLUE_MOONGATE, 1, caster.realm );
-  gate1.movable := 0;
-  var gate2 := CreateItemAtLocation( tox, toy, toz, UOBJ_BLUE_MOONGATE, 1, torealm );
-  gate2.movable := 0;
-  if(!gate1)
-    DestroyItem(gate2);
-    SendSysMessage(caster, "Something is interfering with the spell.");
-    return;
-  endif
-  if (!gate2)
-    DestroyItem(gate1);
-    SendSysMessage(caster, "Something is interfering with the spell.");
-    return;
-  endif
-  set_critical(0);
-  SetObjProperty( gate1, "GateDestX", gate2.x );
-  SetObjProperty( gate1, "GateDestY", gate2.y );
-  SetObjProperty( gate1, "GateDestZ", gate2.z );
-  SetObjProperty( gate1, "GateDestRealm", gate2.realm );
-  SetObjProperty( gate2, "GateDestX", gate1.x );
-  SetObjProperty( gate2, "GateDestY", gate1.y );
-  SetObjProperty( gate2, "GateDestZ", gate1.z );
-  SetObjProperty( gate2, "GateDestRealm", gate1.realm );
-  Detach();
-  sleep(30);
-  set_critical(1);
-  DestroyItem( gate1 );
-  DestroyItem( gate2 );
-  set_critical(0);
-endprogram
-
-function removeentry(castOn)
-  var tox := CInt(GetObjProperty( castOn, "x" ));
-  var toy := CInt(GetObjProperty( castOn, "y" ));
-  var toz := CInt(GetObjProperty( castOn, "z" ));
-  var defs := GetObjProperty(castOn, "runedefs");
-  var holder := {};
-  foreach thing in defs
-    if((Cint(thing[2]) != tox) or (Cint(thing[3]) != toy) or (Cint(thing[4]) != toz))
-      holder.append(thing);
-    endif
-  endforeach
-  SetObjProperty(castOn, "runedefs", holder);
-  EraseObjProperty(castOn, "x");
-  EraseObjProperty(castOn, "y");
-  EraseObjProperty(castOn, "z");
-  return;
-endfunction
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/gate.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/gate.src)

Deleted: trunk/096/pkg/skills/magery/OLD/harm.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/harm.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/harm.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,36 +0,0 @@
-use os;
-use uo;
-use util;
-use cfgfile;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-include "include/magic";
-
-
-program spell_harm(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-	var dmg := RandomDiceRoll("1d12");
-
-	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "harm" });
-	if (spell_reflect(castOn))
-		castOn := caster;
-	endif
-	PlaySoundEffect(castOn, SFX_SPELL_HARM);
-	PlayObjectCenteredEffect( castOn, FX_GLOW_SPIKE, 0x0a,0x1e);
-	if(AP_GetVital(castOn, HITS) >= 1)
-		if(castOn.npctemplate)
-			dmg := dmg * 2;
-		endif
-		ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
-	endif
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/harm.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/harm.src)

Deleted: trunk/096/pkg/skills/magery/OLD/heal.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/heal.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/heal.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,25 +0,0 @@
-use uo;
-use os;
-use util;
-
-include "include/client";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-
-
-program spell_heal(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var healed := CInt(AP_GetSkill(caster, MAGERY) / 20) + 5;
-  if(healed > 20)
-	healed := 20;
-  endif
-  if(castOn.isA(POLCLASS_NPC))
-    healed := healed * 2;
-  endif
-  HealDamage(castOn, healed);
-  PlayObjectCenteredEffect(castOn, FX_SPARK_EFFECT, 7, 0x10);
-  PlaySoundEffect(castOn, SFX_SPELL_HEAL);
-  SendSysMessage(caster, "You healed " + healed + " damage.");
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/heal.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/heal.src)

Deleted: trunk/096/pkg/skills/magery/OLD/incognito.cfg
===================================================================
--- trunk/096/pkg/skills/magery/OLD/incognito.cfg	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/incognito.cfg	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,3733 +0,0 @@
-Names MALE
-{
-        Count 1518
-        Name1           Aaron
-        Name2           Aasin
-        Name3           Abbott
-        Name4           Abdel
-        Name5           Abdiel
-        Name6           Abel
-        Name7           Abijah
-        Name8           Abner
-        Name9           Abraham
-        Name10          Abran
-        Name11          Ace
-        Name12          Achilles
-        Name13          Ackerley
-        Name14          Adair
-        Name15          Adam
-        Name16          Adan
-        Name17          Addison
-        Name18          Adeben
-        Name19          Adem
-        Name20          Adiran
-        Name21          Adlai
-        Name22          Adler
-        Name23          Adley
-        Name24          Admon
-        Name25          Adolph
-        Name26          Adon
-        Name27          Adonis
-        Name28          Adrian
-        Name29          Adriel
-        Name30          Aeneas
-        Name31          Agustin
-        Name32          Ahearn
-        Name33          Ahmik
-        Name34          Ahren
-        Name35          Aidan
-        Name36          Aiken
-        Name37          Aimery
-        Name38          Aitan
-        Name39          Ajayi
-        Name40          Akando
-        Name41          Akbaar
-        Name42          Akello
-        Name43          Akil
-        Name44          Akshay
-        Name45          Alan
-        Name46          Aland
-        Name47          Alano
-        Name48          Alaric
-        Name49          Alastair
-        Name50          Alben
-        Name51          Albert
-        Name52          Alcander
-        Name53          Alcott
-        Name54          Alden
-        Name55          Alder
-        Name56          Aldrick
-        Name57          Alec
-        Name58          Alek
-        Name59          Aleksy
-        Name60          Aleron
-        Name61          Aleser
-        Name62          Alex
-        Name63          Alexander
-        Name64          Alfred
-        Name65          Alger
-        Name66          Alim
-        Name67          Alistair
-        Name68          Allaard
-        Name69          Allan
-        Name70          Allard
-        Name71          Allen
-        Name72          Alonzo
-        Name73          Alphonse
-        Name74          Alphonso
-        Name75          Alston
-        Name76          Altair
-        Name77          Alton
-        Name78          Alvin
-        Name79          Amadeo
-        Name80          Amadi
-        Name81          Amado
-        Name82          Ambrose
-        Name83          Amiel
-        Name84          Ammon
-        Name85          Amos
-        Name86          Amsden
-        Name87          Anders
-        Name88          Andre
-        Name89          Andreus
-        Name90          Andrew
-        Name91          Andrey
-        Name92          Andries
-        Name93          Andrio
-        Name94          Angelo
-        Name95          Angus
-        Name96          Anker
-        Name97          Anoki
-        Name98          Ansel
-        Name99          Anselme
-        Name100         Ansley
-        Name101         Anson
-        Name102         Anthony
-        Name103         Antonio
-        Name104         Anwar
-        Name105         Archer
-        Name106         Archibald
-        Name107         Ardon
-        Name108         Aren
-        Name109         Ares
-        Name110         Argus
-        Name111         Ari
-        Name112         Aricin
-        Name113         Arion
-        Name114         Aristo
-        Name115         Aristotle
-        Name116         Arkin
-        Name117         Arlen
-        Name118         Arley
-        Name119         Arlin
-        Name120         Arlo
-        Name121         Arman
-        Name122         Armen
-        Name123         Armon
-        Name124         Armstrong
-        Name125         Arne
-        Name126         Arnold
-        Name127         Arnon
-        Name128         Aron
-        Name129         Arpiar
-        Name130         Arsen
-        Name131         Arsenio
-        Name132         Arthur
-        Name133         Ashby
-        Name134         Asher
-        Name135         Ashford
-        Name136         Ashlin
-        Name137         Ashon
-        Name138         Ashur
-        Name139         Athan
-        Name140         Atheron
-        Name141         Atman
-        Name142         Audric
-        Name143         Audun
-        Name144         Augustin
-        Name145         Augustus
-        Name146         Aurek
-        Name147         Austin
-        Name148         Averill
-        Name149         Avery
-        Name150         Axel
-        Name151         Bae
-        Name152         Bailey
-        Name153         Baingana
-        Name154         Bakari
-        Name155         Balbo
-        Name156         Balder
-        Name157         Baldwin
-        Name158         Bale
-        Name159         Balendin
-        Name160         Bali
-        Name161         Balin
-        Name162         Balint
-        Name163         Bancroft
-        Name164         Bandele
-        Name165         Bane
-        Name166         Banning
-        Name167         Baran
-        Name168         Barclay
-        Name169         Barden
-        Name170         Bardo
-        Name171         Bardon
-        Name172         Barnabas
-        Name173         Barnaby
-        Name174         Barnett
-        Name175         Barney
-        Name176         Baron
-        Name177         Barrett
-        Name178         Barry
-        Name179         Barse
-        Name180         Bart
-        Name181         Barth
-        Name182         Bartholomew
-        Name183         Barton
-        Name184         Basil
-        Name185         Bastiaan
-        Name186         Baul
-        Name187         Bavol
-        Name188         Baxter
-        Name189         Bay
-        Name190         Bayani
-        Name191         Bayard
-        Name192         Baylor
-        Name193         Bazyli
-        Name194         Beacan
-        Name195         Beagan
-        Name196         Beaman
-        Name197         Beau
-        Name198         Beaumont
-        Name199         Beauregard
-        Name200         Beck
-        Name201         Beldon
-        Name202         Belen
-        Name203         Bem
-        Name204         Beman
-        Name205         Ben
-        Name206         Benedict
-        Name207         Benen
-        Name208         Benjamin
-        Name209         Bennett
-        Name210         Benson
-        Name211         Bent
-        Name212         Bentley
-        Name213         Benton
-        Name214         Berenger
-        Name215         Bergren
-        Name216         Berk
-        Name217         Berkeley
-        Name218         Bernard
-        Name219         Bersh
-        Name220         Bert
-        Name221         Bert
-        Name222         Berthold
-        Name223         Berton
-        Name224         Bertram
-        Name225         Beval
-        Name226         Bevan
-        Name227         Bialy
-        Name228         Bilal
-        Name229         Bishop
-        Name230         Bitalo
-        Name231         Bjorn
-        Name232         Blade
-        Name233         Blaine
-        Name234         Blair
-        Name235         Blaise
-        Name236         Blake
-        Name237         Blaz
-        Name238         Blorn
-        Name239         Bo
-        Name240         Boden
-        Name241         Bogart
-        Name242         Bohdan
-        Name243         Bolton
-        Name244         Bond
-        Name245         Booker
-        Name246         Boone
-        Name247         Borden
-        Name248         Boris
-        Name249         Botan
-        Name250         Bowie
-        Name251         Bowman
-        Name252         Boyce
-        Name253         Boyd
-        Name254         Boyden
-        Name255         Brad
-        Name256         Braden
-        Name257         Bradford
-        Name258         Bradney
-        Name259         Brady
-        Name260         Bram
-        Name261         Bran
-        Name262         Brand
-        Name263         Brandeis
-        Name264         Brandon
-        Name265         Brant
-        Name266         Braxton
-        Name267         Bray
-        Name268         Braz
-        Name269         Brazil
-        Name270         Bren
-        Name271         Brencis
-        Name272         Brendan
-        Name273         Brendon
-        Name274         Brennan
-        Name275         Brent
-        Name276         Brentan
-        Name277         Bret
-        Name278         Brett
-        Name279         Brewster
-        Name280         Briac
-        Name281         Brian
-        Name282         Briand
-        Name283         Brice
-        Name284         Brieg
-        Name285         Brinley
-        Name286         Brishen
-        Name287         Brock
-        Name288         Broderick
-        Name289         Brodny
-        Name290         Brody
-        Name291         Bronson
-        Name292         Bront
-        Name293         Bruce
-        Name294         Bruno
-        Name295         Brutus
-        Name296         Bryan
-        Name297         Bryant
-        Name298         Bryce
-        Name299         Bryson
-        Name300         Buck
-        Name301         Bud
-        Name302         Budo
-        Name303         Burgess
-        Name304         Burhan
-        Name305         Burian
-        Name306         Burke
-        Name307         Burl
-        Name308         Burr
-        Name309         Burton
-        Name310         Byran
-        Name311         Byron
-        Name312         Cadeo
-        Name313         Cador
-        Name314         Caedmon
-        Name315         Cailan
-        Name316         Cain
-        Name317         Caine
-        Name318         Calder
-        Name319         Caldwell
-        Name320         Caleb
-        Name321         Calvin
-        Name322         Cam
-        Name323         Camden
-        Name324         Cameron
-        Name325         Candan
-        Name326         Canton
-        Name327         Canute
-        Name328         Carden
-        Name329         Carey
-        Name330         Carl
-        Name331         Carlin
-        Name332         Carlo
-        Name333         Carlos
-        Name334         Carlton
-        Name335         Carr
-        Name336         Carrick
-        Name337         Carrocio
-        Name338         Carroll
-        Name339         Carson
-        Name340         Carson
-        Name341         Carter
-        Name342         Carver
-        Name343         Casey
-        Name344         Casper
-        Name345         Cassidy
-        Name346         Cassius
-        Name347         Castel
-        Name348         Cato
-        Name349         Caton
-        Name350         Cavan
-        Name351         Ceasar
-        Name352         Cecil
-        Name353         Cedric
-        Name354         Cemal
-        Name355         Chad
-        Name356         Chadwick
-        Name357         Chaim
-        Name358         Chal
-        Name359         Chale
-        Name360         Chalmers
-        Name361         Chander
-        Name362         Chandler
-        Name363         Chane
-        Name364         Chaney
-        Name365         Channing
-        Name366         Chapin
-        Name367         Chapman
-        Name368         Charles
-        Name369         Charlton
-        Name370         Chase
-        Name371         Chatha
-        Name372         Chauncy
-        Name373         Chayton
-        Name374         Chen
-        Name375         Cheney
-        Name376         Chester
-        Name377         Chet
-        Name378         Chevalier
-        Name379         Chike
-        Name380         Chin
-        Name381         Christian
-        Name382         Christoph
-        Name383         Christopher
-        Name384         Christos
-        Name385         Chuck
-        Name386         Ciceron
-        Name387         Ciro
-        Name388         Clarence
-        Name389         Clark
-        Name390         Claude
-        Name391         Clay
-        Name392         Clay
-        Name393         Clayton
-        Name394         Clement
-        Name395         Cleveland
-        Name396         Clifford
-        Name397         Clifton
-        Name398         Clint
-        Name399         Clinton
-        Name400         Clive
-        Name401         Clyde
-        Name402         Cody
-        Name403         Colby
-        Name404         Cole
-        Name405         Coleman
-        Name406         Colin
-        Name407         Collin
-        Name408         Colon
-        Name409         Colton
-        Name410         Coman
-        Name411         Conan
-        Name412         Condon
-        Name413         Connor
-        Name414         Conrad
-        Name415         Conway
-        Name416         Corbett
-        Name417         Corbin
-        Name418         Corcoran
-        Name419         Cordell
-        Name420         Corey
-        Name421         Cornelius
-        Name422         Cort
-        Name423         Coty
-        Name424         Courtland
-        Name425         Craig
-        Name426         Crandall
-        Name427         Creighton
-        Name428         Crispin
-        Name429         Crosby
-        Name430         Cullen
-        Name431         Cullin
-        Name432         Culver
-        Name433         Curran
-        Name434         Curtis
-        Name435         Cynric
-        Name436         Cyrano
-        Name437         Cyril
-        Name438         Cyrus
-        Name439         Dag
-        Name440         Dagan
-        Name441         Dakarai
-        Name442         Dakota
-        Name443         Dale
-        Name444         Dallin
-        Name445         Dalton
-        Name446         Daly
-        Name447         Damek
-        Name448         Damen
-        Name449         Damian
-        Name450         Damien
-        Name451         Damion
-        Name452         Damon
-        Name453         Dana
-        Name454         Dane
-        Name455         Daniel
-        Name456         Danior
-        Name457         Dannik
-        Name458         Dante
-        Name459         Daren
-        Name460         Darien
-        Name461         Dario
-        Name462         Darnell
-        Name463         Darrel
-        Name464         Darrell
-        Name465         Darren
-        Name466         Daryl
-        Name467         David
-        Name468         Davin
-        Name469         Davis
-        Name470         Deacon
-        Name471         Dean
-        Name472         Decker
-        Name473         Delaney
-        Name474         Delano
-        Name475         Delbert
-        Name476         Dellan
-        Name477         Delmore
-        Name478         Delsin
-        Name479         Deman
-        Name480         Dempsey
-        Name481         Dempster
-        Name482         Denby
-        Name483         Dennis
-        Name484         Dennys
-        Name485         Denton
-        Name486         Denver
-        Name487         Der
-        Name488         Derek
-        Name489         Derrick
-        Name490         Derry
-        Name491         Desmond
-        Name492         Deverell
-        Name493         Devin
-        Name494         Devlin
-        Name495         Dewey
-        Name496         Dexter
-        Name497         Diederik
-        Name498         Diego
-        Name499         Dieter
-        Name500         Dillon
-        Name501         Dimitri
-        Name502         Dirk
-        Name503         Dobry
-        Name504         Dominic
-        Name505         Dominick
-        Name506         Donald
-        Name507         Donatien
-        Name508         Donato
-        Name509         Donnelley
-        Name510         Donnelly
-        Name511         Donovan
-        Name512         Doron
-        Name513         Dougie
-        Name514         Douglas
-        Name515         Douglass
-        Name516         Dov
-        Name517         Doyle
-        Name518         Drake
-        Name519         Drew
-        Name520         Duane
-        Name521         Dugan
-        Name522         Duglas
-        Name523         Duncan
-        Name524         Dunstan
-        Name525         Durand
-        Name526         Durriken
-        Name527         Dusan
-        Name528         Dustin
-        Name529         Dutch
-        Name530         Dwayne
-        Name531         Dwight
-        Name532         Dyami
-        Name533         Dyastro
-        Name534         Dylan
-        Name535         Dymas
-        Name536         Eamon
-        Name537         Earl
-        Name538         Earle
-        Name539         Eaton
-        Name540         Edan
-        Name541         Edgan
-        Name542         Edgar
-        Name543         Edison
-        Name544         Edmund
-        Name545         Edrin
-        Name546         Edward
-        Name547         Edwin
-        Name548         Edwin
-        Name549         Egan
-        Name550         Einar
-        Name551         Elad
-        Name552         Elden
-        Name553         Eldroth
-        Name554         Elek
-        Name555         Eli
-        Name556         Elias
-        Name557         Elijah
-        Name558         Elkan
-        Name559         Ellery
-        Name560         Elliot
-        Name561         Elliott
-        Name562         Ellis
-        Name563         Ellsworth
-        Name564         Elmer
-        Name565         Elmo
-        Name566         Elston
-        Name567         Elton
-        Name568         Elwood
-        Name569         Emanuel
-        Name570         Emil
-        Name571         Emilio
-        Name572         Emmett
-        Name573         Emo
-        Name574         Enoch
-        Name575         Enrico
-        Name576         Enrique
-        Name577         Ephraim
-        Name578         Erek
-        Name579         Eric
-        Name580         Erik
-        Name581         Ernest
-        Name582         Erol
-        Name583         Errol
-        Name584         Erskine
-        Name585         Erwin
-        Name586         Eryx
-        Name587         Essien
-        Name588         Esteban
-        Name589         Ethan
-        Name590         Eugene
-        Name591         Evan
-        Name592         Evander
-        Name593         Everett
-        Name594         Evzen
-        Name595         Ezekial
-        Name596         Ezra
-        Name597         Fabio
-        Name598         Fairfax
-        Name599         Farley
-        Name600         Farrell
-        Name601         Faxon
-        Name602         Felix
-        Name603         Felix
-        Name604         Fenn
-        Name605         Fenton
-        Name606         Fergus
-        Name607         Ferran
-        Name608         Ferris
-        Name609         Fielding
-        Name610         Filbert
-        Name611         Filmore
-        Name612         Finlay
-        Name613         Finley
-        Name614         Finn
-        Name615         Finnigan
-        Name616         Fisk
-        Name617         Fitzgerald
-        Name618         Fletcher
-        Name619         Flindo
-        Name620         Flint
-        Name621         Floyd
-        Name622         Flynn
-        Name623         Forbes
-        Name624         Forrest
-        Name625         Forsythe
-        Name626         Foster
-        Name627         Foster
-        Name628         Francis
-        Name629         Franek
-        Name630         Frank
-        Name631         Franklin
-        Name632         Frasier
-        Name633         Frazer
-        Name634         Frazier
-        Name635         Fred
-        Name636         Frederick
-        Name637         Fremont
-        Name638         Fritz
-        Name639         Fuller
-        Name640         Fulton
-        Name641         Gabe
-        Name642         Gabriel
-        Name643         Gage
-        Name644         Galen
-        Name645         Galeno
-        Name646         Galvin
-        Name647         Gamble
-        Name648         Gannon
-        Name649         Gareth
-        Name650         Garfield
-        Name651         Gargan
-        Name652         Garner
-        Name653         Garrett
-        Name654         Garrick
-        Name655         Garridan
-        Name656         Garrison
-        Name657         Garritt
-        Name658         Garth
-        Name659         Garvin
-        Name660         Gary
-        Name661         Gaspar
-        Name662         Gaston
-        Name663         Gavin
-        Name664         Gavrie
-        Name665         Gaylord
-        Name666         Gaynor
-        Name667         Geoff
-        Name668         Geoffrey
-        Name669         Geoffry
-        Name670         George
-        Name671         Gerard
-        Name672         Gerik
-        Name673         Germain
-        Name674         Gerry
-        Name675         Gideon
-        Name676         Gilberto
-        Name677         Giles
-        Name678         Ginton
-        Name679         Givon
-        Name680         Glen
-        Name681         Glenn
-        Name682         Glenno
-        Name683         Godfrey
-        Name684         Gordon
-        Name685         Gordy
-        Name686         Gorman
-        Name687         Grady
-        Name688         Graham
-        Name689         Gram
-        Name690         Granger
-        Name691         Grant
-        Name692         Granville
-        Name693         Grayson
-        Name694         Greg
-        Name695         Greger
-        Name696         Gregor
-        Name697         Gregory
-        Name698         Gresham
-        Name699         Griffen
-        Name700         Griffith
-        Name701         Guilhem
-        Name702         Gunnar
-        Name703         Gunther
-        Name704         Gus
-        Name705         Gustave
-        Name706         Guthrie
-        Name707         Guy
-        Name708         Hackett
-        Name709         Hadden
-        Name710         Hadi
-        Name711         Hadley
-        Name712         Hadrian
-        Name713         Hagan
-        Name714         Hal
-        Name715         Halden
-        Name716         Hale
-        Name717         Halian
-        Name718         Halsey
-        Name719         Hamilton
-        Name720         Hamlin
-        Name721         Hank
-        Name722         Hans
-        Name723         Harden
-        Name724         Hardy
-        Name725         Harith
-        Name726         Harlan
-        Name727         Harman
-        Name728         Harold
-        Name729         Harper
-        Name730         Harrison
-        Name731         Harry
-        Name732         Hart
-        Name733         Hartley
-        Name734         Harvey
-        Name735         Hassan
-        Name736         Hastin
-        Name737         Hastings
-        Name738         Hayden
-        Name739         Hayes
-        Name740         Haynes
-        Name741         Heath
-        Name742         Hector
-        Name743         Helaku
-        Name744         Henning
-        Name745         Henry
-        Name746         Herbert
-        Name747         Herman
-        Name748         Herschel
-        Name749         Hilliard
-        Name750         Hilton
-        Name751         Hiroshi
-        Name752         Hobart
-        Name753         Hogan
-        Name754         Holden
-        Name755         Holt
-        Name756         Homes
-        Name757         Horace
-        Name758         Horton
-        Name759         Houston
-        Name760         Howard
-        Name761         Howrence
-        Name762         Hoyt
-        Name763         Hugh
-        Name764         Hugo
-        Name765         Humphrey
-        Name766         Hunter
-        Name767         Huntley
-        Name768         Hyman
-        Name769         Iain
-        Name770         Ian
-        Name771         Ian
-        Name772         Ilias
-        Name773         Ingmar
-        Name774         Ingram
-        Name775         Ira
-        Name776         Irvin
-        Name777         Irving
-        Name778         Irwin
-        Name779         Isaac
-        Name780         Isaiah
-        Name781         Israel
-        Name782         Itzak
-        Name783         Ivan
-        Name784         Ivar
-        Name785         Jabari
-        Name786         Jabir
-        Name787         Jack
-        Name788         Jacob
-        Name789         Jacobe
-        Name790         Jacques
-        Name791         Jacson
-        Name792         Jacy
-        Name793         Jafar
-        Name794         Jagger
-        Name795         Jake
-        Name796         Jal
-        Name797         Jaleel
-        Name798         Jamal
-        Name799         James
-        Name800         Jamison
-        Name801         Jared
-        Name802         Jarek
-        Name803         Jarman
-        Name804         Jaron
-        Name805         Jarrod
-        Name806         Jarvis
-        Name807         Jason
-        Name808         Jasper
-        Name809         Javan
-        Name810         Javier
-        Name811         Jay
-        Name812         Jebidiah
-        Name813         Jed
-        Name814         Jedidiah
-        Name815         Jedidiah
-        Name816         Jedrek
-        Name817         Jeff
-        Name818         Jeffrey
-        Name819         Jelani
-        Name820         Jeremiah
-        Name821         Jeremy
-        Name822         Jerolin
-        Name823         Jerome
-        Name824         Jeromy
-        Name825         Jerzy
-        Name826         Jesse
-        Name827         Jessee
-        Name828         Jethro
-        Name829         Jibril
-        Name830         Jin
-        Name831         Jiro
-        Name832         Jivin
-        Name833         Joel
-        Name834         Johann
-        Name835         John
-        Name836         Jolon
-        Name837         Jonah
-        Name838         Jonathan
-        Name839         Jonathon
-        Name840         Jordan
-        Name841         Jordon
-        Name842         Jorgen
-        Name843         Jorvin
-        Name844         Joseph
-        Name845         Joshua
-        Name846         Judd
-        Name847         Jude
-        Name848         Julian
-        Name849         Julius
-        Name850         Juma
-        Name851         Jung
-        Name852         Justin
-        Name853         Kadin
-        Name854         Kai
-        Name855         Kaikara
-        Name856         Kaladin
-        Name857         Kalb
-        Name858         Kale
-        Name859         Kalil
-        Name860         Kalkin
-        Name861         Kalman
-        Name862         Kamal
-        Name863         Kane
-        Name864         Kaniel
-        Name865         Kardal
-        Name866         Karl
-        Name867         Karsten
-        Name868         Kasch
-        Name869         Kasen
-        Name870         Kaspar
-        Name871         Kateb
-        Name872         Kayin
-        Name873         Keane
-        Name874         Kearney
-        Name875         Kedar
-        Name876         Keefe
-        Name877         Keelan
-        Name878         Keenan
-        Name879         Kegan
-        Name880         Keir
-        Name881         Keir
-        Name882         Keith
-        Name883         Kelby
-        Name884         Keleman
-        Name885         Kell
-        Name886         Kellen
-        Name887         Kelvin
-        Name888         Ken
-        Name889         Kenan
-        Name890         Kendall
-        Name891         Kendrick
-        Name892         Kenelm
-        Name893         Kenley
-        Name894         Kennard
-        Name895         Kennedy
-        Name896         Kenneth
-        Name897         Kent
-        Name898         Kenton
-        Name899         Kenyon
-        Name900         Keona
-        Name901         Ker
-        Name902         Kerby
-        Name903         Kern
-        Name904         Kerry
-        Name905         Kers
-        Name906         Kersen
-        Name907         Kerwin
-        Name908         Kester
-        Name909         Kevin
-        Name910         Khalil
-        Name911         Khoury
-        Name912         Kiefer
-        Name913         Kieran
-        Name914         Kiernan
-        Name915         Killian
-        Name916         Kin
-        Name917         Kinnel
-        Name918         Kinsey
-        Name919         Kintan
-        Name920         Kip
-        Name921         Kipp
-        Name922         Kirby
-        Name923         Kirk
-        Name924         Kiyoshi
-        Name925         Kliftin
-        Name926         Klog
-        Name927         Komor
-        Name928         Kontar
-        Name929         Krischan
-        Name930         Krister
-        Name931         Kurt
-        Name932         Kyle
-        Name933         Kyler
-        Name934         Laethan
-        Name935         Laird
-        Name936         Lamar
-        Name937         Lamont
-        Name938         Lance
-        Name939         Lander
-        Name940         Landon
-        Name941         Lane
-        Name942         Lang
-        Name943         Larry
-        Name944         Lars
-        Name945         Lawler
-        Name946         Lawrence
-        Name947         Lazarus
-        Name948         Lear
-        Name949         Lee
-        Name950         Leif
-        Name951         Leighton
-        Name952         Leland
-        Name953         Len
-        Name954         Lennon
-        Name955         Lennor
-        Name956         Lennox
-        Name957         Lensar
-        Name958         Leo
-        Name959         Leon
-        Name960         Leonard
-        Name961         Leron
-        Name962         Leroy
-        Name963         Lester
-        Name964         Lev
-        Name965         Levi
-        Name966         Lewis
-        Name967         Lewis
-        Name968         Li
-        Name969         Liam
-        Name970         Like
-        Name971         Lincoln
-        Name972         Lindsey
-        Name973         Lionel
-        Name974         Llewellyn
-        Name975         Lloyd
-        Name976         Logan
-        Name977         Loren
-        Name978         Lorenzo
-        Name979         Lorne
-        Name980         Louis
-        Name981         Lowell
-        Name982         Lucas
-        Name983         Lucian
-        Name984         Luis
-        Name985         Luke
-        Name986         Lukyan
-        Name987         Lunt
-        Name988         Luther
-        Name989         Lyle
-        Name990         Lyndon
-        Name991         Lysander
-        Name992         Mac
-        Name993         Macer
-        Name994         Mack
-        Name995         Mackenzie
-        Name996         Magnus
-        Name997         Malcolm
-        Name998         Malik
-        Name999         Manco
-        Name1000                Mandek
-        Name1001                Mander
-        Name1002                Manfred
-        Name1003                Manning
-        Name1004                Mansur
-        Name1005                Manuel
-        Name1006                Marc
-        Name1007                Marcos
-        Name1008                Marcus
-        Name1009                Marden
-        Name1010                Marek
-        Name1011                Mario
-        Name1012                Mark
-        Name1013                Markham
-        Name1014                Markos
-        Name1015                Marlin
-        Name1016                Marlon
-        Name1017                Marlon
-        Name1018                Marshal
-        Name1019                Marshall
-        Name1020                Marsten
-        Name1021                Martin
-        Name1022                Martingo
-        Name1023                Marvin
-        Name1024                Mason
-        Name1025                Matai
-        Name1026                Mateo
-        Name1027                Mather
-        Name1028                Matthew
-        Name1029                Matthias
-        Name1030                Maurice
-        Name1031                Max
-        Name1032                Maximillian
-        Name1033                Maxwell
-        Name1034                Maynard
-        Name1035                Mayon
-        Name1036                Mead
-        Name1037                Meka
-        Name1038                Melvin
-        Name1039                Mercer
-        Name1040                Merill
-        Name1041                Merle
-        Name1042                Merlin
-        Name1043                Merrick
-        Name1044                Merrik
-        Name1045                Meyer
-        Name1046                Micael
-        Name1047                Michael
-        Name1048                Migon
-        Name1049                Miguel
-        Name1050                Mike
-        Name1051                Mikkel
-        Name1052                Mikos
-        Name1053                Miles
-        Name1054                Miles
-        Name1055                Milo
-        Name1056                Milton
-        Name1057                Miner
-        Name1058                Mitchell
-        Name1059                Monroe
-        Name1060                Monte
-        Name1061                Morgan
-        Name1062                Morley
-        Name1063                Morris
-        Name1064                Mortimer
-        Name1065                Morton
-        Name1066                Morven
-        Name1067                Morz
-        Name1068                Motega
-        Name1069                Mukasa
-        Name1070                Murdoch
-        Name1071                Murdock
-        Name1072                Murphy
-        Name1073                Myles
-        Name1074                Myron
-        Name1075                Naeem
-        Name1076                Nalren
-        Name1077                Nantan
-        Name1078                Nathan
-        Name1079                Nathaniel
-        Name1080                Neal
-        Name1081                Neale
-        Name1082                Neil
-        Name1083                Nelek
-        Name1084                Nelson
-        Name1085                Neron
-        Name1086                Nestor
-        Name1087                Nevan
-        Name1088                Neville
-        Name1089                Nevin
-        Name1090                Nevin
-        Name1091                Nicanor
-        Name1092                Nicholas
-        Name1093                Nigel
-        Name1094                Nikolos
-        Name1095                Nils
-        Name1096                Noah
-        Name1097                Nodin
-        Name1098                Noe
-        Name1099                Nolan
-        Name1100                Norbert
-        Name1101                Norman
-        Name1102                Norris
-        Name1103                Norton
-        Name1104                Nuri
-        Name1105                Nyle
-        Name1106                Oakes
-        Name1107                Oakley
-        Name1108                Ochen
-        Name1109                Octavius
-        Name1110                Odell
-        Name1111                Odin
-        Name1112                Odion
-        Name1113                Odon
-        Name1114                Ogden
-        Name1115                Olaf
-        Name1116                Olin
-        Name1117                Oliver
-        Name1118                Omar
-        Name1119                Ordano
-        Name1120                Oren
-        Name1121                Orion
-        Name1122                Orman
-        Name1123                Ormand
-        Name1124                Orrin
-        Name1125                Orson
-        Name1126                Orville
-        Name1127                Oscar
-        Name1128                Osgood
-        Name1129                Osmond
-        Name1130                Otis
-        Name1131                Otto
-        Name1132                Owen
-        Name1133                Paco
-        Name1134                Palmer
-        Name1135                Paolo
-        Name1136                Paris
-        Name1137                Parker
-        Name1138                Parnell
-        Name1139                Pascal
-        Name1140                Patamon
-        Name1141                Patrick
-        Name1142                Patterson
-        Name1143                Patton
-        Name1144                Paul
-        Name1145                Paulin
-        Name1146                Pavel
-        Name1147                Paxton
-        Name1148                Payton
-        Name1149                Pearce
-        Name1150                Peder
-        Name1151                Pembroke
-        Name1152                Penn
-        Name1153                Percival
-        Name1154                Perry
-        Name1155                Peter
-        Name1156                Peyton
-        Name1157                Phearcy
-        Name1158                Philip
-        Name1159                Phillip
-        Name1160                Phillippe
-        Name1161                Phoenix
-        Name1162                Pierce
-        Name1163                Pierre
-        Name1164                Pierson
-        Name1165                Pilan
-        Name1166                Platon
-        Name1167                Porter
-        Name1168                Prentice
-        Name1169                Prescot
-        Name1170                Prescott
-        Name1171                Preston
-        Name1172                Quentin
-        Name1173                Quenton
-        Name1174                Quillan
-        Name1175                Quincy
-        Name1176                Quinlan
-        Name1177                Quinn
-        Name1178                Rad
-        Name1179                Radcliffe
-        Name1180                Radman
-        Name1181                Rafael
-        Name1182                Rafferty
-        Name1183                Ragnar
-        Name1184                Raidon
-        Name1185                Raleigh
-        Name1186                Ralph
-        Name1187                Ramiro
-        Name1188                Ramon
-        Name1189                Ramsay
-        Name1190                Ramsey
-        Name1191                Ranard
-        Name1192                Rance
-        Name1193                Randall
-        Name1194                Randolph
-        Name1195                Ranen
-        Name1196                Ranger
-        Name1197                Rankin
-        Name1198                Raoul
-        Name1199                Raphael
-        Name1200                Raul
-        Name1201                Ravi
-        Name1202                Ravi
-        Name1203                Ravid
-        Name1204                Ray
-        Name1205                Raymond
-        Name1206                Raynor
-        Name1207                Reade
-        Name1208                Redford
-        Name1209                Redmond
-        Name1210                Reed
-        Name1211                Reese
-        Name1212                Reeve
-        Name1213                Regan
-        Name1214                Reginald
-        Name1215                Regis
-        Name1216                Remington
-        Name1217                Remington
-        Name1218                Renaldo
-        Name1219                Rendor
-        Name1220                Renfry
-        Name1221                Renny
-        Name1222                Reuben
-        Name1223                Rex
-        Name1224                Reyhan
-        Name1225                Rhett
-        Name1226                Rhett
-        Name1227                Rhys
-        Name1228                Ricardo
-        Name1229                Richard
-        Name1230                Richter
-        Name1231                Rico
-        Name1232                Rider
-        Name1233                Ridgley
-        Name1234                Rigby
-        Name1235                Riley
-        Name1236                Rimon
-        Name1237                Ringo
-        Name1238                Ringo
-        Name1239                Riodan
-        Name1240                Riordan
-        Name1241                Roarke
-        Name1242                Robert
-        Name1243                Roberto
-        Name1244                Robi
-        Name1245                Rockwell
-        Name1246                Rod
-        Name1247                Roderick
-        Name1248                Rodman
-        Name1249                Rodney
-        Name1250                Rodrigo
-        Name1251                Roger
-        Name1252                Roi
-        Name1253                Roland
-        Name1254                Roldan
-        Name1255                Rolf
-        Name1256                Ronald
-        Name1257                Ronan
-        Name1258                Rooney
-        Name1259                Rory
-        Name1260                Roscoe
-        Name1261                Ross
-        Name1262                Roth
-        Name1263                Rowan
-        Name1264                Rowland
-        Name1265                Roy
-        Name1266                Royce
-        Name1267                Ruben
-        Name1268                Rudd
-        Name1269                Rudi
-        Name1270                Rudyard
-        Name1271                Rufus
-        Name1272                Runako
-        Name1273                Ruskin
-        Name1274                Russ
-        Name1275                Russell
-        Name1276                Rusty
-        Name1277                Rutherford
-        Name1278                Rutledge
-        Name1279                Ryan
-        Name1280                Ryder
-        Name1281                Rylan
-        Name1282                Sahale
-        Name1283                Sahen
-        Name1284                Salim
-        Name1285                Saloman
-        Name1286                Sam
-        Name1287                Samien
-        Name1288                Sammon
-        Name1289                Samson
-        Name1290                Samuel
-        Name1291                Sanders
-        Name1292                Sandon
-        Name1293                Sandor
-        Name1294                Sanford
-        Name1295                Sargent
-        Name1296                Sarngin
-        Name1297                Sarojin
-        Name1298                Saul
-        Name1299                Saunders
-        Name1300                Sawyer
-        Name1301                Saxon
-        Name1302                Schuyler
-        Name1303                Scott
-        Name1304                Seamus
-        Name1305                Sean
-        Name1306                Sebastian
-        Name1307                Sebastien
-        Name1308                Seif
-        Name1309                Selby
-        Name1310                Senon
-        Name1311                Sergio
-        Name1312                Seth
-        Name1313                Seung
-        Name1314                Severin
-        Name1315                Sevilin
-        Name1316                Seward
-        Name1317                Seymour
-        Name1318                Shane
-        Name1319                Shawn
-        Name1320                Shea
-        Name1321                Sheffield
-        Name1322                Sheldon
-        Name1323                Shen
-        Name1324                Sheridan
-        Name1325                Sherman
-        Name1326                Sherwin
-        Name1327                Sherwood
-        Name1328                Shing
-        Name1329                Shunnar
-        Name1330                Sidney
-        Name1331                Siegfried
-        Name1332                Silas
-        Name1333                Simon
-        Name1334                Sivan
-        Name1335                Skip
-        Name1336                Skyler
-        Name1337                Slade
-        Name1338                Slade
-        Name1339                Slevin
-        Name1340                Smith
-        Name1341                Solomon
-        Name1342                Sorgan
-        Name1343                Soterios
-        Name1344                Spalding
-        Name1345                Spencer
-        Name1346                Spenser
-        Name1347                Standford
-        Name1348                Stanley
-        Name1349                Stanton
-        Name1350                Stasio
-        Name1351                Stefan
-        Name1352                Stephan
-        Name1353                Stephen
-        Name1354                Sterling
-        Name1355                Stevan
-        Name1356                Steve
-        Name1357                Steven
-        Name1358                Stewart
-        Name1359                Stoke
-        Name1360                Stoyan
-        Name1361                Strom
-        Name1362                Stuart
-        Name1363                Subrey
-        Name1364                Sulaiman
-        Name1365                Sullican
-        Name1366                Sumner
-        Name1367                Sutherland
-        Name1368                Sutton
-        Name1369                Sven
-        Name1370                Sylvester
-        Name1371                Tab
-        Name1372                Tabari
-        Name1373                Tad
-        Name1374                Tadi
-        Name1375                Tai
-        Name1376                Tajo
-        Name1377                Talbart
-        Name1378                Talbot
-        Name1379                Talman
-        Name1380                Talos
-        Name1381                Tanek
-        Name1382                Tanner
-        Name1383                Tano
-        Name1384                Taro
-        Name1385                Tate
-        Name1386                Taurin
-        Name1387                Taylor
-        Name1388                Tem
-        Name1389                Terence
-        Name1390                Terrence
-        Name1391                Terrill
-        Name1392                Terry
-        Name1393                Thaddeus
-        Name1394                Thai
-        Name1395                Thaman
-        Name1396                Thane
-        Name1397                Thanos
-        Name1398                Theobald
-        Name1399                Theodore
-        Name1400                Theron
-        Name1401                Thierry
-        Name1402                Thomas
-        Name1403                Thorpe
-        Name1404                Thurston
-        Name1405                Thurston
-        Name1406                Tibalt
-        Name1407                Tiernan
-        Name1408                Timothy
-        Name1409                Titus
-        Name1410                Tobias
-        Name1411                Toby
-        Name1412                Tod
-        Name1413                Todd
-        Name1414                Tomas
-        Name1415                Tong
-        Name1416                Tor
-        Name1417                Torin
-        Name1418                Torrance
-        Name1419                Tovi
-        Name1420                Townsend
-        Name1421                Travers
-        Name1422                Travis
-        Name1423                Tremain
-        Name1424                Tremaine
-        Name1425                Trent
-        Name1426                Trevor
-        Name1427                Trey
-        Name1428                Tristan
-        Name1429                Troy
-        Name1430                Tryon
-        Name1431                Tucker
-        Name1432                Tully
-        Name1433                Tyee
-        Name1434                Tyler
-        Name1435                Tymon
-        Name1436                Tyrone
-        Name1437                Ulysses
-        Name1438                Upton
-        Name1439                Uriah
-        Name1440                Urian
-        Name1441                Van
-        Name1442                Vance
-        Name1443                Vaughn
-        Name1444                Vern
-        Name1445                Vernon
-        Name1446                Victor
-        Name1447                Vincent
-        Name1448                Vinson
-        Name1449                Virgil
-        Name1450                Vito
-        Name1451                Vlad
-        Name1452                Vladimir
-        Name1453                Vokes
-        Name1454                Volf
-        Name1455                Wade
-        Name1456                Wagner
-        Name1457                Walden
-        Name1458                Waldo
-        Name1459                Walker
-        Name1460                Wallace
-        Name1461                Wally
-        Name1462                Walter
-        Name1463                Ward
-        Name1464                Warner
-        Name1465                Warren
-        Name1466                Watson
-        Name1467                Waylan
-        Name1468                Wayland
-        Name1469                Waylon
-        Name1470                Wayne
-        Name1471                Webb
-        Name1472                Webster
-        Name1473                Wendell
-        Name1474                Wesley
-        Name1475                Weston
-        Name1476                Weylin
-        Name1477                Whitaker
-        Name1478                Wilfen
-        Name1479                Will
-        Name1480                Willard
-        Name1481                Willem
-        Name1482                William
-        Name1483                Wilson
-        Name1484                Winston
-        Name1485                Winthrop
-        Name1486                Wlby
-        Name1487                Woody
-        Name1488                Wyatt
-        Name1489                Xavier
-        Name1490                Xenos
-        Name1491                Xerxes
-        Name1492                Ximen
-        Name1493                Yakecan
-        Name1494                Yale
-        Name1495                Yancey
-        Name1496                Yardley
-        Name1497                Yarin
-        Name1498                Yerik
-        Name1499                Yero
-        Name1500                Yervant
-        Name1501                York
-        Name1502                Yusuf
-        Name1503                Yves
-        Name1504                Zachariah
-        Name1505                Zachary
-        Name1506                Zackery
-        Name1507                Zaid
-        Name1508                Zaide
-        Name1509                Zane
-        Name1510                Zaniel
-        Name1511                Zann
-        Name1512                Zared
-        Name1513                Zarek
-        Name1514                Zeke
-        Name1515                Zenon
-        Name1516                Zion
-        Name1517                Ziven
-        Name1518                Zorn
-}
-
-Names FEMALE
-{
-        Count 2206
-        Name1           Aba
-        Name2           Abby
-        Name3           Abella
-        Name4           Abey
-        Name5           Abigail
-        Name6           Abina
-        Name7           Abiona
-        Name8           Abira
-        Name9           Abra
-        Name10          Abrah
-        Name11          Absinthe
-        Name12          Acacia
-        Name13          Acanit
-        Name14          Acantha
-        Name15          Accalia
-        Name16          Acelin
-        Name17          Achen
-        Name18          Ada
-        Name19          Adalia
-        Name20          Adamina
-        Name21          Adara
-        Name22          Addi
-        Name23          Adelaide
-        Name24          Adele
-        Name25          Adelia
-        Name26          Adeline
-        Name27          Adelle
-        Name28          Adena
-        Name29          Aderes
-        Name30          Adesina
-        Name31          Adie
-        Name32          Aditi
-        Name33          Adiva
-        Name34          Adoncia
-        Name35          Adonia
-        Name36          Adora
-        Name37          Adrienne
-        Name38          Aelina
-        Name39          Afina
-        Name40          Afra
-        Name41          Afrika
-        Name42          Afton
-        Name43          Agate
-        Name44          Agatha
-        Name45          Agnes
-        Name46          Ahara
-        Name47          Ahava
-        Name48          Ahimsa
-        Name49          Aida
-        Name50          Aiella
-        Name51          Aiko
-        Name52          Aila
-        Name53          Aileen
-        Name54          Ailsa
-        Name55          Aimee
-        Name56          Ain
-        Name57          Aina
-        Name58          Aine
-        Name59          Ainhoa
-        Name60          Ainsley
-        Name61          Aintzane
-        Name62          Airlia
-        Name63          Aisling
-        Name64          Aislinn
-        Name65          Aithne
-        Name66          Aiyana
-        Name67          Ajara
-        Name68          Ajay
-        Name69          Ajinora
-        Name70          Akako
-        Name71          Akala
-        Name72          Akanke
-        Name73          Akasma
-        Name74          Akela
-        Name75          Akilah
-        Name76          Akili
-        Name77          Akilina
-        Name78          Akina
-        Name79          Alaina
-        Name80          Alake
-        Name81          Alala
-        Name82          Alamanda
-        Name83          Alana
-        Name84          Alani
-        Name85          Alanna
-        Name86          Alaqua
-        Name87          Alavda
-        Name88          Alazne
-        Name89          Alberta
-        Name90          Albinka
-        Name91          Alcina
-        Name92          Aldea
-        Name93          Aldercy
-        Name94          Aleka
-        Name95          Alenne
-        Name96          Alesia
-        Name97          Alessa
-        Name98          Alethea
-        Name99          Alexa
-        Name100         Alexandra
-        Name101         Alexandria
-        Name102         Alexandrina
-        Name103         Alexis
-        Name104         Alexis
-        Name105         Ali
-        Name106         Alia
-        Name107         Alice
-        Name108         Alicia
-        Name109         Alida
-        Name110         Alidia
-        Name111         Alike
-        Name112         Alima
-        Name113         Alina
-        Name114         Alison
-        Name115         Alita
-        Name116         Alix
-        Name117         Aliz
-        Name118         Aliza
-        Name119         Allegra
-        Name120         Allele
-        Name121         Allinora
-        Name122         Allison
-        Name123         Allyn
-        Name124         Alma
-        Name125         Alodie
-        Name126         Aloysia
-        Name127         Altair
-        Name128         Althea
-        Name129         Alula
-        Name130         Alumit
-        Name131         Alvina
-        Name132         Alvita
-        Name133         Alysa
-        Name134         Alyssa
-        Name135         Alyssand
-        Name136         Alzena
-        Name137         Ama
-        Name138         Amabel
-        Name139         Amadi
-        Name140         Amadika
-        Name141         Amadis
-        Name142         Amaia
-        Name143         Amala
-        Name144         Amalia
-        Name145         Amanda
-        Name146         Amandine
-        Name147         Amara
-        Name148         Amarande
-        Name149         Amarante
-        Name150         Amaris
-        Name151         Amata
-        Name152         Ambar
-        Name153         Amber
-        Name154         Ambika
-        Name155         Amdis
-        Name156         Ameerah
-        Name157         Amelia
-        Name158         Amelina
-        Name159         Amethyst
-        Name160         Amie
-        Name161         Amiella
-        Name162         Amina
-        Name163         Aminta
-        Name164         Amira
-        Name165         Amissa
-        Name166         Amity
-        Name167         Amoke
-        Name168         Amy
-        Name169         An
-        Name170         Ana
-        Name171         Anana
-        Name172         Ananda
-        Name173         Anastasia
-        Name174         Ancelin
-        Name175         Andi
-        Name176         Andra
-        Name177         Andraianna
-        Name178         Andras
-        Name179         Andrea
-        Name180         Andreana
-        Name181         Andromeda
-        Name182         Aneida
-        Name183         Anella
-        Name184         Anemone
-        Name185         Anezka
-        Name186         Angela
-        Name187         Angelica
-        Name188         Angeline
-        Name189         Angelique
-        Name190         Angeni
-        Name191         Ani
-        Name192         Anica
-        Name193         Anieli
-        Name194         Anisa
-        Name195         Anita
-        Name196         Anke
-        Name197         Ann
-        Name198         Anna
-        Name199         Annabel
-        Name200         Annabelle
-        Name201         Annamarie
-        Name202         Anne
-        Name203         Annette
-        Name204         Annikka
-        Name205         Annora
-        Name206         Anorah
-        Name207         Anoush
-        Name208         Anteia
-        Name209         Anthea
-        Name210         Antje
-        Name211         Antoinette
-        Name212         Antonia
-        Name213         Aolani
-        Name214         Apara
-        Name215         Apirka
-        Name216         Apolline
-        Name217         Apollonia
-        Name218         Aponi
-        Name219         April
-        Name220         Aprille
-        Name221         Aqua
-        Name222         Aquene
-        Name223         Ara
-        Name224         Arabella
-        Name225         Arabelle
-        Name226         Araceli
-        Name227         Araminta
-        Name228         Araxie
-        Name229         Arcadia
-        Name230         Ardath
-        Name231         Ardelia
-        Name232         Arden
-        Name233         Ardis
-        Name234         Ardith
-        Name235         Areiela
-        Name236         Arella
-        Name237         Aretha
-        Name238         Aretina
-        Name239         Ariadne
-        Name240         Ariana
-        Name241         Aricia
-        Name242         Ariel
-        Name243         Ariene
-        Name244         Arista
-        Name245         Arlene
-        Name246         Arlinda
-        Name247         Armina
-        Name248         Arminda
-        Name249         Artemisia
-        Name250         Aruna
-        Name251         Arziki
-        Name252         Asaria
-        Name253         Asenka
-        Name254         Ash
-        Name255         Asha
-        Name256         Ashlan
-        Name257         Ashleigh
-        Name258         Ashley
-        Name259         Asia
-        Name260         Asisa
-        Name261         Aslinda
-        Name262         Aspasia
-        Name263         Asta
-        Name264         Aster
-        Name265         Astera
-        Name266         Astra
-        Name267         Astrea
-        Name268         Astrid
-        Name269         Atalanta
-        Name270         Atara
-        Name271         Atenne
-        Name272         Ateri
-        Name273         Athalia
-        Name274         Athara
-        Name275         Athena
-        Name276         Athene
-        Name277         Athla
-        Name278         Atifa
-        Name279         Atta
-        Name280         Aubrey
-        Name281         Auda
-        Name282         Audny
-        Name283         Audrey
-        Name284         Audrianna
-        Name285         Audun
-        Name286         Augustina
-        Name287         Aura
-        Name288         Aure
-        Name289         Aurelia
-        Name290         Aurilia
-        Name291         Aurina
-        Name292         Aurkene
-        Name293         Aurora
-        Name294         Autumn
-        Name295         Ava
-        Name296         Avana
-        Name297         Avasa
-        Name298         Avella
-        Name299         Avena
-        Name300         Avie
-        Name301         Avis
-        Name302         Aviva
-        Name303         Axella
-        Name304         Aya
-        Name305         Ayaluna
-        Name306         Ayame
-        Name307         Ayana
-        Name308         Ayasha
-        Name309         Ayda
-        Name310         Aydee
-        Name311         Ayela
-        Name312         Ayiana
-        Name313         Ayila
-        Name314         Ayisha
-        Name315         Ayita
-        Name316         Ayla
-        Name317         Aynora
-        Name318         Ayuna
-        Name319         Azaleah
-        Name320         Azalia
-        Name321         Azarael
-        Name322         Azeline
-        Name323         Azera
-        Name324         Azha
-        Name325         Azilea
-        Name326         Azina
-        Name327         Azize
-        Name328         Azora
-        Name329         Azura
-        Name330         Babette
-        Name331         Bacia
-        Name332         Baka
-        Name333         Bakarne
-        Name334         Balayna
-        Name335         Balia
-        Name336         Bambi
-        Name337         Banan
-        Name338         Banella
-        Name339         Bara
-        Name340         Barakah
-        Name341         Barbara
-        Name342         Barika
-        Name343         Basha
-        Name344         Basia
-        Name345         Basimah
-        Name346         Bathsheba
-        Name347         Batya
-        Name348         Bay
-        Name349         Bayana
-        Name350         Baylea
-        Name351         Bayo
-        Name352         Bayta
-        Name353         Bea
-        Name354         Beatrice
-        Name355         Beatrix
-        Name356         Beauvina
-        Name357         Becca
-        Name358         Becky
-        Name359         Bedelia
-        Name360         Bel
-        Name361         Belana
-        Name362         Belina
-        Name363         Belinda
-        Name364         Belita
-        Name365         Bella
-        Name366         Bellanca
-        Name367         Belle
-        Name368         Belora
-        Name369         Bente
-        Name370         Beradine
-        Name371         Berilla
-        Name372         Berit
-        Name373         Bernadette
-        Name374         Bernice
-        Name375         Beryl
-        Name376         Bess
-        Name377         Bessine
-        Name378         Beta
-        Name379         Beth
-        Name380         Bethana
-        Name381         Bethany
-        Name382         Betony
-        Name383         Bette
-        Name384         Betty
-        Name385         Beulah
-        Name386         Beverlea
-        Name387         Beverly
-        Name388         Bevin
-        Name389         Bian
-        Name390         Bianca
-        Name391         Billie
-        Name392         Bina
-        Name393         Bindy
-        Name394         Binti
-        Name395         Birdie
-        Name396         Birget
-        Name397         Birkita
-        Name398         Bixenta
-        Name399         Blanche
-        Name400         Blanda
-        Name401         Blenda
-        Name402         Bliss
-        Name403         Bly
-        Name404         Blythe
-        Name405         Bo
-        Name406         Bohdana
-        Name407         Bonamy
-        Name408         Bonita
-        Name409         Bonnie
-        Name410         Bonny
-        Name411         Borgny
-        Name412         Brandi
-        Name413         Brandy
-        Name414         Bren
-        Name415         Brenda
-        Name416         Brenna
-        Name417         Bretta
-        Name418         Briana
-        Name419         Bridget
-        Name420         Brie
-        Name421         Brier
-        Name422         Brietta
-        Name423         Brigit
-        Name424         Brigitte
-        Name425         Brina
-        Name426         Briona
-        Name427         Briony
-        Name428         Brites
-        Name429         Britta
-        Name430         Brittany
-        Name431         Bronwyn
-        Name432         Brooke
-        Name433         Brynn
-        Name434         Bucia
-        Name435         Cadence
-        Name436         Cai
-        Name437         Caimile
-        Name438         Caitlin
-        Name439         Caitrin
-        Name440         Cala
-        Name441         Calandia
-        Name442         Calandra
-        Name443         Calantha
-        Name444         Caledonia
-        Name445         Caley
-        Name446         Calida
-        Name447         Calista
-        Name448         Calla
-        Name449         Callan
-        Name450         Callia
-        Name451         Callidora
-        Name452         Callie
-        Name453         Calliope
-        Name454         Caltha
-        Name455         Calypso
-        Name456         Cam
-        Name457         Camelai
-        Name458         Camilia
-        Name459         Camilla
-        Name460         Camille
-        Name461         Canace
-        Name462         Candace
-        Name463         Candice
-        Name464         Candida
-        Name465         Candide
-        Name466         Candra
-        Name467         Candra
-        Name468         Cantara
-        Name469         Caoimhe
-        Name470         Capri
-        Name471         Caprice
-        Name472         Cara
-        Name473         Caradoc
-        Name474         Caresse
-        Name475         Cari
-        Name476         Carina
-        Name477         Carine
-        Name478         Carissa
-        Name479         Carita
-        Name480         Carla
-        Name481         Carleen
-        Name482         Carlen
-        Name483         Carling
-        Name484         Carlota
-        Name485         Carlotta
-        Name486         Carly
-        Name487         Carma
-        Name488         Carmel
-        Name489         Carmela
-        Name490         Carmelina
-        Name491         Carmelita
-        Name492         Carmen
-        Name493         Carna
-        Name494         Carnelian
-        Name495         Carol
-        Name496         Carolina
-        Name497         Caroline
-        Name498         Carolyn
-        Name499         Caron
-        Name500         Carrie
-        Name501         Caryn
-        Name502         Casey
-        Name503         Casilda
-        Name504         Cassandra
-        Name505         Cassia
-        Name506         Cassiel
-        Name507         Casta
-        Name508         Castalia
-        Name509         Catalin
-        Name510         Catalina
-        Name511         Catava
-        Name512         Caterina
-        Name513         Catherine
-        Name514         Cathleen
-        Name515         Cathy
-        Name516         Catriona
-        Name517         Cayla
-        Name518         Ceara
-        Name519         Cecania
-        Name520         Cecilia
-        Name521         Celandine
-        Name522         Celeste
-        Name523         Celia
-        Name524         Celina
-        Name525         Cellia
-        Name526         Cerelia
-        Name527         Chaitra
-        Name528         Chanah
-        Name529         Chanda
-        Name530         Chandi
-        Name531         Chandra
-        Name532         Chandra
-        Name533         Chane
-        Name534         Chanel
-        Name535         Channa
-        Name536         Chantal
-        Name537         Charis
-        Name538         Charissa
-        Name539         Charity
-        Name540         Charlotte
-        Name541         Charmaine
-        Name542         Charmian
-        Name543         Chastity
-        Name544         Chava
-        Name545         Chavi
-        Name546         Chaviva
-        Name547         Chay
-        Name548         Chaya
-        Name549         Chelsea
-        Name550         Chenoa
-        Name551         Cherice
-        Name552         Cherie
-        Name553         Cherise
-        Name554         Cheryl
-        Name555         Chesna
-        Name556         Chiara
-        Name557         Chika
-        Name558         Chilali
-        Name559         Chimalis
-        Name560         Chipo
-        Name561         Chloe
-        Name562         Chloris
-        Name563         Cho
-        Name564         Christa
-        Name565         Christable
-        Name566         Christina
-        Name567         Christine
-        Name568         Christy
-        Name569         Chyou
-        Name570         Ciannait
-        Name571         Ciar
-        Name572         Cicely
-        Name573         Cindy
-        Name574         Claire
-        Name575         Clara
-        Name576         Clarinda
-        Name577         Clarissa
-        Name578         Claudette
-        Name579         Claudia
-        Name580         Claudine
-        Name581         Clementina
-        Name582         Clementine
-        Name583         Cleo
-        Name584         Cliantha
-        Name585         Clio
-        Name586         Clorinda
-        Name587         Clover
-        Name588         Cochiti
-        Name589         Coleen
-        Name590         Colette
-        Name591         Colleen
-        Name592         Connie
-        Name593         Constance
-        Name594         Constanza
-        Name595         Consuela
-        Name596         Cora
-        Name597         Coralie
-        Name598         Corazon
-        Name599         Corbey
-        Name600         Cordelia
-        Name601         Coretta
-        Name602         Cori
-        Name603         Corinna
-        Name604         Coris
-        Name605         Corliss
-        Name606         Cornelia
-        Name607         Corrine
-        Name608         Courtney
-        Name609         Crescent
-        Name610         Cressida
-        Name611         Crystal
-        Name612         Cybele
-        Name613         Cybil
-        Name614         Cynara
-        Name615         Cynthia
-        Name616         Cyprien
-        Name617         Cyrene
-        Name618         Cyrilla
-        Name619         Cytheria
-        Name620         Dabria
-        Name621         Dacey
-        Name622         Dacia
-        Name623         Dacio
-        Name624         Dae
-        Name625         Dagmar
-        Name626         Dagna
-        Name627         Dagny
-        Name628         Dahlia
-        Name629         Dai
-        Name630         Daily
-        Name631         Daisel
-        Name632         Daisy
-        Name633         Dakota
-        Name634         Dale
-        Name635         Dalila
-        Name636         Dalilia
-        Name637         Damalis
-        Name638         Damara
-        Name639         Damaris
-        Name640         Damita
-        Name641         Dana
-        Name642         Danett
-        Name643         Dania
-        Name644         Danica
-        Name645         Daniella
-        Name646         Danielle
-        Name647         Danyelle
-        Name648         Daphene
-        Name649         Daphne
-        Name650         Daphnie
-        Name651         Dar
-        Name652         Dara
-        Name653         Daralis
-        Name654         Darby
-        Name655         Darcie
-        Name656         Darcy
-        Name657         Daria
-        Name658         Darla
-        Name659         Darlene
-        Name660         Dasha
-        Name661         Davine
-        Name662         Davita
-        Name663         Dawn
-        Name664         Daya
-        Name665         Dayna
-        Name666         Deandra
-        Name667         Deanna
-        Name668         Deanne
-        Name669         Deb
-        Name670         Deborah
-        Name671         Debra
-        Name672         Dede
-        Name673         Dedra
-        Name674         Dee
-        Name675         Deedee
-        Name676         Deianira
-        Name677         Deiene
-        Name678         Deirdre
-        Name679         Delana
-        Name680         Delaney
-        Name681         Delbin
-        Name682         Delia
-        Name683         Delicia
-        Name684         Delilah
-        Name685         Della
-        Name686         Delphine
-        Name687         Dembe
-        Name688         Demi
-        Name689         Demitria
-        Name690         Dena
-        Name691         Denby
-        Name692         Denise
-        Name693         Desa
-        Name694         Desdemona
-        Name695         Desiree
-        Name696         Deva
-        Name697         Devaki
-        Name698         Deval
-        Name699         Devi
-        Name700         Devin
-        Name701         Devnet
-        Name702         Devon
-        Name703         Diamanta
-        Name704         Diana
-        Name705         Diane
-        Name706         Dianthe
-        Name707         Diedre
-        Name708         Diella
-        Name709         Dillian
-        Name710         Dilys
-        Name711         Dinah
-        Name712         Dionne
-        Name713         Dirdre
-        Name714         Disa
-        Name715         Dita
-        Name716         Dixie
-        Name717         Dodie
-        Name718         Dolly
-        Name719         Dolores
-        Name720         Dominique
-        Name721         Dona
-        Name722         Donata
-        Name723         Donielle
-        Name724         Donna
-        Name725         Donner
-        Name726         Dooriya
-        Name727         Dophina
-        Name728         Dora
-        Name729         Doreen
-        Name730         Dorinda
-        Name731         Doris
-        Name732         Dorothea
-        Name733         Dorothy
-        Name734         Dory
-        Name735         Drew
-        Name736         Drina
-        Name737         Drucilla
-        Name738         Dulcie
-        Name739         Dulcinea
-        Name740         Dusty
-        Name741         Dyan
-        Name742         Dyani
-        Name743         Dymphna
-        Name744         Dyna
-        Name745         Eartha
-        Name746         Easter
-        Name747         Ebony
-        Name748         Echo
-        Name749         Edana
-        Name750         Eden
-        Name751         Edie
-        Name752         Edith
-        Name753         Edlyn
-        Name754         Edna
-        Name755         Edna
-        Name756         Edolie
-        Name757         Edria
-        Name758         Edwina
-        Name759         Efia
-        Name760         Eileen
-        Name761         Eirene
-        Name762         Elaine
-        Name763         Elana
-        Name764         Eleanor
-        Name765         Elena
-        Name766         Eleora
-        Name767         Elina
-        Name768         Elisa
-        Name769         Elise
-        Name770         Eliska
-        Name771         Elissa
-        Name772         Elita
-        Name773         Eliza
-        Name774         Elizabeth
-        Name775         Elke
-        Name776         Ella
-        Name777         Elle
-        Name778         Ellen
-        Name779         Elly
-        Name780         Elodie
-        Name781         Eloise
-        Name782         Elsa
-        Name783         Else
-        Name784         Elsie
-        Name785         Elynor
-        Name786         Elyse
-        Name787         Elysia
-        Name788         Ema
-        Name789         Emajane
-        Name790         Emalia
-        Name791         Ember
-        Name792         Emelie
-        Name793         Emelyne
-        Name794         Emily
-        Name795         Emma
-        Name796         Endora
-        Name797         Engracia
-        Name798         Enid
-        Name799         Enola
-        Name800         Enye
-        Name801         Eranthe
-        Name802         Erasma
-        Name803         Erianthe
-        Name804         Erica
-        Name805         Erika
-        Name806         Erin
-        Name807         Erlina
-        Name808         Erwand
-        Name809         Eskarne
-        Name810         Esmerelda
-        Name811         Esperanza
-        Name812         Esta
-        Name813         Estelle
-        Name814         Esther
-        Name815         Etain
-        Name816         Etania
-        Name817         Etsu
-        Name818         Etta
-        Name819         Eudocia
-        Name820         Eugenia
-        Name821         Eulalia
-        Name822         Eustacia
-        Name823         Eva
-        Name824         Evacsa
-        Name825         Evadine
-        Name826         Evadne
-        Name827         Evangeline
-        Name828         Evanthe
-        Name829         Eve
-        Name830         Evelyn
-        Name831         Evita
-        Name832         Evonne
-        Name833         Eyota
-        Name834         Fabienne        
-        Name835         Fainche 
-        Name836         Fairuza 
-        Name837         Faith   
-        Name838         Faizah  
-        Name839         Fallon
-        Name840         Fantine
-        Name841         Farha
-        Name842         Farrah
-        Name843         Fatima
-        Name844         Fatin
-        Name845         Fawne
-        Name846         Fay
-        Name847         Faye
-        Name848         Fayina
-        Name849         Fayme
-        Name850         Felcia
-        Name851         Felicia
-        Name852         Felicite
-        Name853         Felicity
-        Name854         Femi
-        Name855         Feridwyn
-        Name856         Fern
-        Name857         Feronia
-        Name858         Filinda
-        Name859         Fina
-        Name860         Finola
-        Name861         Fiona
-        Name862         Fiorenza
-        Name863         Flavia
-        Name864         Fleta
-        Name865         Flora
-        Name866         Florence
-        Name867         Frances
-        Name868         Francesca
-        Name869         Francine
-        Name870         Francisca
-        Name871         Freda
-        Name872         Frederica
-        Name873         Freya
-        Name874         Frida
-        Name875         Frieda
-        Name876         Fuscienne
-        Name877         Gabriella
-        Name878         Gabrielle
-        Name879         Gaia
-        Name880         Gail
-        Name881         Gala
-        Name882         Galatea
-        Name883         Gali
-        Name884         Galina
-        Name885         Galya
-        Name886         Gana
-        Name887         Ganesa
-        Name888         Gauri
-        Name889         Gaye
-        Name890         Gayle
-        Name891         Gelasia
-        Name892         Gemma
-        Name893         Genevieve
-        Name894         Geogia
-        Name895         Georgeanne
-        Name896         Georgetta
-        Name897         Georgette
-        Name898         Georgiana
-        Name899         Geradline
-        Name900         Geraldine
-        Name901         Gerda
-        Name902         Gerri
-        Name903         Gertrude
-        Name904         Geva
-        Name905         Ghislaine
-        Name906         Giacinta
-        Name907         Gianina
-        Name908         Gigi
-        Name909         Gilana
-        Name910         Gilda
-        Name911         Gilen
-        Name912         Gillian
-        Name913         Gin
-        Name914         Gina
-        Name915         Ginger
-        Name916         Giselle
-        Name917         Gitana
-        Name918         Githa
-        Name919         Gizane
-        Name920         Gleda
-        Name921         Glenna
-        Name922         Glennys
-        Name923         Gloria
-        Name924         Golda
-        Name925         Goldie
-        Name926         Gotzone
-        Name927         Grace
-        Name928         Gracie
-        Name929         Grainne
-        Name930         Grazia
-        Name931         Grear
-        Name932         Greta
-        Name933         Gretchen
-        Name934         Grette
-        Name935         Gwen
-        Name936         Gwendolyn
-        Name937         Gweneth
-        Name938         Gwynne
-        Name939         Gytha
-        Name940         Hadara
-        Name941         Hadassa
-        Name942         Hadiya
-        Name943         Haidee
-        Name944         Hailey
-        Name945         Haimi
-        Name946         Haldis
-        Name947         Hale
-        Name948         Haley
-        Name949         Hali
-        Name950         Hali
-        Name951         Halima
-        Name952         Halle
-        Name953         Hallie
-        Name954         Hana
-        Name955         Hanan
-        Name956         Hannah
-        Name957         Hanne
-        Name958         Harmoni
-        Name959         Harriet
-        Name960         Hasna
-        Name961         Hava
-        Name962         Haya
-        Name963         Haylee
-        Name964         Hazel
-        Name965         Hea
-        Name966         Heather
-        Name967         Hei
-        Name968         Heidi
-        Name969         Heldegarde
-        Name970         Helen
-        Name971         Helena
-        Name972         Helene
-        Name973         Helki
-        Name974         Henka
-        Name975         Henrietta
-        Name976         Hesper
-        Name977         Hester
-        Name978         Hilary
-        Name979         Hilda
-        Name980         Hinda
-        Name981         Hisa
-        Name982         Holly
-        Name983         Hope
-        Name984         Hoshi
-        Name985         Huyana
-        Name986         Hyacinth
-        Name987         Hye
-        Name988         Hypatia
-        Name989         Ianthe
-        Name990         Ida
-        Name991         Idola
-        Name992         Idonia
-        Name993         Ilene
-        Name994         Ilona
-        Name995         Iman
-        Name996         Imogene
-        Name997         India
-        Name998         Indira
-        Name999         Indra
-        Name1000                Ines
-        Name1001                Inez
-        Name1002                Inga
-        Name1003                Ingrid
-        Name1004                Iolana
-        Name1005                Iolanthe
-        Name1006                Iona
-        Name1007                Iratze
-        Name1008                Irena
-        Name1009                Irene
-        Name1010                Iris
-        Name1011                Irma
-        Name1012                Isabeau
-        Name1013                Isabel
-        Name1014                Isabella
-        Name1015                Isadora
-        Name1016                Isaura
-        Name1017                Isis
-        Name1018                Isleta
-        Name1019                Isobel
-        Name1020                Isoke
-        Name1021                Istas
-        Name1022                Ivana
-        Name1023                Ivory
-        Name1024                Ivy
-        Name1025                Jacelyn
-        Name1026                Jacinda
-        Name1027                Jacinthe
-        Name1028                Jacqueline
-        Name1029                Jada
-        Name1030                Jael
-        Name1031                Jaen
-        Name1032                Jaimie
-        Name1033                Jaione
-        Name1034                Jakinda
-        Name1035                Jala
-        Name1036                Jamie
-        Name1037                Jamila
-        Name1038                Jamilah
-        Name1039                Jan
-        Name1040                Jana
-        Name1041                Jane
-        Name1042                Janelle
-        Name1043                Janet
-        Name1044                Janice
-        Name1045                Janis
-        Name1046                Janna
-        Name1047                Jannelle
-        Name1048                Jardena
-        Name1049                Jarvia
-        Name1050                Jarvinia
-        Name1051                Jasmine
-        Name1052                Jaya
-        Name1053                Jayne
-        Name1054                Jean
-        Name1055                Jean
-        Name1056                Jeanette
-        Name1057                Jeanine
-        Name1058                Jelena
-        Name1059                Jena
-        Name1060                Jenay
-        Name1061                Jendayi
-        Name1062                Jendyose
-        Name1063                Jenica
-        Name1064                Jennettia
-        Name1065                Jennifer
-        Name1066                Jensine
-        Name1067                Jerrilyn
-        Name1068                Jessamine
-        Name1069                Jessica
-        Name1070                Jewel
-        Name1071                Jezebel
-        Name1072                Jihan
-        Name1073                Jillian
-        Name1074                Jin
-        Name1075                Jina
-        Name1076                Jinny
-        Name1077                Jinx
-        Name1078                Joakima
-        Name1079                Joan
-        Name1080                Joanne
-        Name1081                Jobey
-        Name1082                Jobihna
-        Name1083                Jocasa
-        Name1084                Jocelyn
-        Name1085                Jodi
-        Name1086                Jody
-        Name1087                Joelle
-        Name1088                Joelliane
-        Name1089                Johanna
-        Name1090                Joia
-        Name1091                Jolan
-        Name1092                Jolanta
-        Name1093                Jolene
-        Name1094                Jolie
-        Name1095                Joline
-        Name1096                Jonina
-        Name1097                Jora
-        Name1098                Jordane
-        Name1099                Josephine
-        Name1100                Josie
-        Name1101                Jotha
-        Name1102                Joy
-        Name1103                Joyce
-        Name1104                Joye
-        Name1105                Juanita
-        Name1106                Judith
-        Name1107                Juditha
-        Name1108                Julia
-        Name1109                Juliana
-        Name1110                Juliane
-        Name1111                Julie
-        Name1112                Julietta
-        Name1113                Julinka
-        Name1114                Julita
-        Name1115                Jumoke
-        Name1116                Jun
-        Name1117                June
-        Name1118                Justine
-        Name1119                Kaatje
-        Name1120                Kachine
-        Name1121                Kaclyn
-        Name1122                Kaede
-        Name1123                Kaethe
-        Name1124                Kai
-        Name1125                Kaia
-        Name1126                Kaie
-        Name1127                Kaili
-        Name1128                Kaimi
-        Name1129                Kairos
-        Name1130                Kaiya
-        Name1131                Kakra
-        Name1132                Kala
-        Name1133                Kalama
-        Name1134                Kalanit
-        Name1135                Kalare
-        Name1136                Kalea
-        Name1137                Kali
-        Name1138                Kalika
-        Name1139                Kalila
-        Name1140                Kalinda
-        Name1141                Kalle
-        Name1142                Kalli
-        Name1143                Kalonice
-        Name1144                Kalyca
-        Name1145                Kama
-        Name1146                Kamala
-        Name1147                Kamali
-        Name1148                Kamaria
-        Name1149                Kambo
-        Name1150                Kameko
-        Name1151                Kamilah
-        Name1152                Kamilia
-        Name1153                Kanda
-        Name1154                Kane
-        Name1155                Kanene
-        Name1156                Kanika
-        Name1157                Kantha
-        Name1158                Kanya
-        Name1159                Kapera
-        Name1160                Kara
-        Name1161                Karan
-        Name1162                Karayan
-        Name1163                Karel
-        Name1164                Karen
-        Name1165                Karida
-        Name1166                Karimah
-        Name1167                Karisa
-        Name1168                Karka
-        Name1169                Karla
-        Name1170                Karlenne
-        Name1171                Karli
-        Name1172                Karlyn
-        Name1173                Karmina
-        Name1174                Karol
-        Name1175                Karylin
-        Name1176                Karyn
-        Name1177                Kasa
-        Name1178                Kasen
-        Name1179                Kasia
-        Name1180                Kasinda
-        Name1181                Kassia
-        Name1182                Kate
-        Name1183                Katherine
-        Name1184                Kathleen
-        Name1185                Katie
-        Name1186                Katja
-        Name1187                Katoka
-        Name1188                Katrien
-        Name1189                Katrina
-        Name1190                Kaula
-        Name1191                Kaveri
-        Name1192                Kavindra
-        Name1193                Kay
-        Name1194                Kaya
-        Name1195                Kaye
-        Name1196                Kayla
-        Name1197                Kaysa
-        Name1198                Kazia
-        Name1199                Keara
-        Name1200                Keelin
-        Name1201                Keely
-        Name1202                Kefira
-        Name1203                Kehinde
-        Name1204                Kei
-        Name1205                Keiko
-        Name1206                Keisha
-        Name1207                Kekona
-        Name1208                Kelda
-        Name1209                Kelia
-        Name1210                Kelley
-        Name1211                Kelli
-        Name1212                Kellie
-        Name1213                Kelly
-        Name1214                Kelsey
-        Name1215                Kendra
-        Name1216                Kennis
-        Name1217                Kenyangi
-        Name1218                Kepa
-        Name1219                Kerani
-        Name1220                Kerensa
-        Name1221                Kerstan
-        Name1222                Kesare
-        Name1223                Kesi
-        Name1224                Kesia
-        Name1225                Kessie
-        Name1226                Keturah
-        Name1227                Ketzia
-        Name1228                Khalida
-        Name1229                Kichi
-        Name1230                Kiele
-        Name1231                Kim
-        Name1232                Kimberly
-        Name1233                Kimmie
-        Name1234                Kimmy
-        Name1235                Kineta
-        Name1236                Kiona
-        Name1237                Kira
-        Name1238                Kiran
-        Name1239                Kirby
-        Name1240                Kirima
-        Name1241                Kirsten
-        Name1242                Kirti
-        Name1243                Kisa
-        Name1244                Kiska
-        Name1245                Kismet
-        Name1246                Kissa
-        Name1247                Kita
-        Name1248                Kohana
-        Name1249                Koko
-        Name1250                Kolina
-        Name1251                Koren
-        Name1252                Koressa
-        Name1253                Kristen
-        Name1254                Kyly
-        Name1255                Kyna
-        Name1256                Kynthia
-        Name1257                Kyoko
-        Name1258                Lacey
-        Name1259                Lacie
-        Name1260                Laila
-        Name1261                Lailie
-        Name1262                Lakeisha
-        Name1263                Lala
-        Name1264                Lalasa
-        Name1265                Lan
-        Name1266                Lana
-        Name1267                Landra
-        Name1268                Lane
-        Name1269                Lani
-        Name1270                Lara
-        Name1271                Laraine
-        Name1272                Laralee
-        Name1273                Lari
-        Name1274                Larissa
-        Name1275                Lark
-        Name1276                Latika
-        Name1277                Latonia
-        Name1278                Laura
-        Name1279                Laurana
-        Name1280                Laurel
-        Name1281                Laurie
-        Name1282                Laurinda
-        Name1283                Lauryn
-        Name1284                Laveda
-        Name1285                Lavern
-        Name1286                Laverne
-        Name1287                Lavinia
-        Name1288                Lea
-        Name1289                Leah
-        Name1290                Leah
-        Name1291                Leala
-        Name1292                Leandra
-        Name1293                Leba
-        Name1294                Ledah
-        Name1295                Lee
-        Name1296                Leigh
-        Name1297                Leiko
-        Name1298                Leila
-        Name1299                Leilana
-        Name1300                Lena
-        Name1301                Lene
-        Name1302                Lenor
-        Name1303                Lenora
-        Name1304                Lenore
-        Name1305                Leona
-        Name1306                Leora
-        Name1307                Leslie
-        Name1308                Letha
-        Name1309                Letitia
-        Name1310                Levana
-        Name1311                Lexine
-        Name1312                Lia
-        Name1313                Liadan
-        Name1314                Lian
-        Name1315                Liana
-        Name1316                Liane
-        Name1317                Libby
-        Name1318                Lien
-        Name1319                Lila
-        Name1320                Lilith
-        Name1321                Lillian
-        Name1322                Lillie
-        Name1323                Lily
-        Name1324                Limber
-        Name1325                Lina
-        Name1326                Linda
-        Name1327                Lindsay
-        Name1328                Lindsey
-        Name1329                Linette
-        Name1330                Linnae
-        Name1331                Linnea
-        Name1332                Lisa
-        Name1333                Lisette
-        Name1334                Litsa
-        Name1335                Liv
-        Name1336                Liza
-        Name1337                Lois
-        Name1338                Lokelani
-        Name1339                Lola
-        Name1340                Loni
-        Name1341                Lora
-        Name1342                Lore
-        Name1343                Lorelei
-        Name1344                Lorelle
-        Name1345                Loretta
-        Name1346                Lori
-        Name1347                Lorraine
-        Name1348                Lotus
-        Name1349                Louise
-        Name1350                Lucia
-        Name1351                Lucille
-        Name1352                Lucinda
-        Name1353                Lucine
-        Name1354                Lucretia
-        Name1355                Lucy
-        Name1356                Ludia
-        Name1357                Luela
-        Name1358                Luisa
-        Name1359                Lukene
-        Name1360                Lukina
-        Name1361                Lulu
-        Name1362                Luna
-        Name1363                Lydia
-        Name1364                Lynda
-        Name1365                Lynelle
-        Name1366                Lynn
-        Name1367                Lynnda
-        Name1368                Lynnette
-        Name1369                Lyris
-        Name1370                Lysel
-        Name1371                Lysnadra
-        Name1372                Mabel
-        Name1373                Macaria
-        Name1374                Machi
-        Name1375                Maddy
-        Name1376                Madelaine
-        Name1377                Madelina
-        Name1378                Madeline
-        Name1379                Madelon
-        Name1380                Madelyn
-        Name1381                Mady
-        Name1382                Mae
-        Name1383                Magan
-        Name1384                Magara
-        Name1385                Magdalen
-        Name1386                Magdalena
-        Name1387                Magdaline
-        Name1388                Magena
-        Name1389                Magenta
-        Name1390                Maggie
-        Name1391                Mahala
-        Name1392                Mahalia
-        Name1393                Mai
-        Name1394                Maia
-        Name1395                Maida
-        Name1396                Maisie
-        Name1397                Maitane
-        Name1398                Maizah
-        Name1399                Maj
-        Name1400                Malaya
-        Name1401                Malila
-        Name1402                Malina
-        Name1403                Malinda
-        Name1404                Malka
-        Name1405                Mallory
-        Name1406                Malu
-        Name1407                Mamie
-        Name1408                Manda
-        Name1409                Mandara
-        Name1410                Mandisa
-        Name1411                Mandy
-        Name1412                Mangena
-        Name1413                Manon
-        Name1414                Mansi
-        Name1415                Manya
-        Name1416                Mara
-        Name1417                Marcella
-        Name1418                Marcia
-        Name1419                Marcy
-        Name1420                Maren
-        Name1421                Margaret
-        Name1422                Margaret
-        Name1423                Margarita
-        Name1424                Margo
-        Name1425                Margot
-        Name1426                Marguirte
-        Name1427                Maria
-        Name1428                Mariah
-        Name1429                Mariam
-        Name1430                Mariama
-        Name1431                Marian
-        Name1432                Mariana
-        Name1433                Marianna
-        Name1434                Marianne
-        Name1435                Maribel
-        Name1436                Marie
-        Name1437                Mariel
-        Name1438                Marietta
-        Name1439                Marily
-        Name1440                Marilyn
-        Name1441                Marina
-        Name1442                Maris
-        Name1443                Marisa
-        Name1444                Marisha
-        Name1445                Marissa
-        Name1446                Marjani
-        Name1447                Marjeta
-        Name1448                Marjorie
-        Name1449                Marlene
-        Name1450                Marlo
-        Name1451                Marmara
-        Name1452                Marnie
-        Name1453                Marnina
-        Name1454                Marsha
-        Name1455                Marta
-        Name1456                Martha
-        Name1457                Marti
-        Name1458                Martina
-        Name1459                Mary
-        Name1460                Maryann
-        Name1461                Marybeth
-        Name1462                Marylou
-        Name1463                Marzia
-        Name1464                Matana
-        Name1465                Mathea
-        Name1466                Matilda
-        Name1467                Matrika
-        Name1468                Maud
-        Name1469                Maude
-        Name1470                Maura
-        Name1471                Maureen
-        Name1472                Maurita
-        Name1473                Mavis
-        Name1474                Maxine
-        Name1475                May
-        Name1476                Maya
-        Name1477                Meara
-        Name1478                Meara
-        Name1479                Meda
-        Name1480                Medea
-        Name1481                Meg
-        Name1482                Megan
-        Name1483                Megara
-        Name1484                Meghan
-        Name1485                Mei
-        Name1486                Meira
-        Name1487                Mela
-        Name1488                Melanie
-        Name1489                Melantha
-        Name1490                Melba
-        Name1491                Melia
-        Name1492                Melian
-        Name1493                Melina
-        Name1494                Melinda
-        Name1495                Melisenda
-        Name1496                Melissa
-        Name1497                Mellinio
-        Name1498                Melodie
-        Name1499                Melody
-        Name1500                Melosa
-        Name1501                Melva
-        Name1502                Mercedes
-        Name1503                Meredith
-        Name1504                Merele
-        Name1505                Mesha
-        Name1506                Meta
-        Name1507                Mia
-        Name1508                Miakoda
-        Name1509                Michaela
-        Name1510                Michele
-        Name1511                Michelle
-        Name1512                Midori
-        Name1513                Migina
-        Name1514                Mignon
-        Name1515                Mika
-        Name1516                Millicent
-        Name1517                Millie
-        Name1518                Min
-        Name1519                Mina
-        Name1520                Minda
-        Name1521                Mindel
-        Name1522                Mindy
-        Name1523                Minerva
-        Name1524                Minka
-        Name1525                Minna
-        Name1526                Minnie
-        Name1527                Mira
-        Name1528                Miranda
-        Name1529                Mirem
-        Name1530                Miremba
-        Name1531                Mireya
-        Name1532                Miriam
-        Name1533                Mirielle
-        Name1534                Missy
-        Name1535                Misty
-        Name1536                Mitena
-        Name1537                Mitexi
-        Name1538                Mitzi
-        Name1539                Miyoko
-        Name1540                Moira
-        Name1541                Mollie
-        Name1542                Molly
-        Name1543                Mona
-        Name1544                Monica
-        Name1545                Monique
-        Name1546                Moon
-        Name1547                Morena
-        Name1548                Morgan
-        Name1549                Morgana
-        Name1550                Morgance
-        Name1551                Moria
-        Name1552                Moriah
-        Name1553                Muriel
-        Name1554                Myra
-        Name1555                Nada
-        Name1556                Nadia
-        Name1557                Nadine
-        Name1558                Nadya
-        Name1559                Naia
-        Name1560                Nailah
-        Name1561                Naimah
-        Name1562                Nalini
-        Name1563                Namazzi
-        Name1564                Nami
-        Name1565                Nan
-        Name1566                Nana
-        Name1567                Nancy
-        Name1568                Nanette
-        Name1569                Nantale
-        Name1570                Naomi
-        Name1571                Napea
-        Name1572                Nara
-        Name1573                Narda
-        Name1574                Narmada
-        Name1575                Nasiche
-        Name1576                Nastassia
-        Name1577                Natalie
-        Name1578                Natane
-        Name1579                Natasha
-        Name1580                Natesa
-        Name1581                Naysa
-        Name1582                Nazirqah
-        Name1583                Neala
-        Name1584                Neci
-        Name1585                Nediva
-        Name1586                Neely
-        Name1587                Nekane
-        Name1588                Nell
-        Name1589                Neola
-        Name1590                Neoma
-        Name1591                Neona
-        Name1592                Neria
-        Name1593                Nerine
-        Name1594                Nerissa
-        Name1595                Netti
-        Name1596                Neva
-        Name1597                Nevada
-        Name1598                Neysa
-        Name1599                Nicia
-        Name1600                Nicola
-        Name1601                Nicole
-        Name1602                Nicolette
-        Name1603                Nika
-        Name1604                Nikki
-        Name1605                Nimah
-        Name1606                Nina
-        Name1607                Niobe
-        Name1608                Niola
-        Name1609                Nira
-        Name1610                Nirvelli
-        Name1611                Nissa
-        Name1612                Nita
-        Name1613                Nitara
-        Name1614                Nitzana
-        Name1615                Nixie
-        Name1616                Noel
-        Name1617                Noelani
-        Name1618                Noella
-        Name1619                Nolita
-        Name1620                Nona
-        Name1621                Nona
-        Name1622                Nora
-        Name1623                Norah
-        Name1624                Noreen
-        Name1625                Nori
-        Name1626                Noriko
-        Name1627                Norma
-        Name1628                Nydia
-        Name1629                Nyrna
-        Name1630                Nyssa
-        Name1631                Nyx
-        Name1632                Obelia
-        Name1633                Octavia
-        Name1634                Odelia
-        Name1635                Odelia
-        Name1636                Odera
-        Name1637                Odessa
-        Name1638                Odetta
-        Name1639                Odette
-        Name1640                Odile
-        Name1641                Ohanna
-        Name1642                Okelani
-        Name1643                Olathe
-        Name1644                Olayinka
-        Name1645                Olesia
-        Name1646                Olga
-        Name1647                Oliana
-        Name1648                Olinda
-        Name1649                Olive
-        Name1650                Olivette
-        Name1651                Olivia
-        Name1652                Ona
-        Name1653                Onida
-        Name1654                Opal
-        Name1655                Ophelia
-        Name1656                Oralie
-        Name1657                Orane
-        Name1658                Orenda
-        Name1659                Oriana
-        Name1660                Orianna
-        Name1661                Oriel
-        Name1662                Oriole
-        Name1663                Orlantha
-        Name1664                Ornidaa
-        Name1665                Paige
-        Name1666                Pakuna
-        Name1667                Palmiera
-        Name1668                Paloma
-        Name1669                Pamela
-        Name1670                Pandita
-        Name1671                Pandora
-        Name1672                Panthea
-        Name1673                Pantzike
-        Name1674                Panya
-        Name1675                Panyin
-        Name1676                Pascale
-        Name1677                Patia
-        Name1678                Patience
-        Name1679                Patricia
-        Name1680                Patsy
-        Name1681                Paula
-        Name1682                Paulette
-        Name1683                Pauline
-        Name1684                Pavla
-        Name1685                Pazia
-        Name1686                Pearl
-        Name1687                Peg
-        Name1688                Peggy
-        Name1689                Pelagia
-        Name1690                Pemba
-        Name1691                Penda
-        Name1692                Penelope
-        Name1693                Peninna
-        Name1694                Penny
-        Name1695                Penthea
-        Name1696                Peony
-        Name1697                Perdita
-        Name1698                Perouze
-        Name1699                Persis
-        Name1700                Petra
-        Name1701                Phaedra
-        Name1702                Phedra
-        Name1703                Philomena
-        Name1704                Phoebe
-        Name1705                Phylis
-        Name1706                Phyllis
-        Name1707                Pia
-        Name1708                Pier
-        Name1709                Pila
-        Name1710                Piper
-        Name1711                Polly
-        Name1712                Poloma
-        Name1713                Porche
-        Name1714                Portia
-        Name1715                Priscilla
-        Name1716                Prudence
-        Name1717                Prudy
-        Name1718                Pyrena
-        Name1719                Pythia
-        Name1720                Qamra
-        Name1721                Queena
-        Name1722                Quella
-        Name1723                Quenby
-        Name1724                Quintina
-        Name1725                Quiterie
-        Name1726                Rachel
-        Name1727                Radella
-        Name1728                Radinka
-        Name1729                Rae
-        Name1730                Rai
-        Name1731                Raisa
-        Name1732                Raizel
-        Name1733                Ramla
-        Name1734                Ramona
-        Name1735                Ramya
-        Name1736                Randie
-        Name1737                Rane
-        Name1738                Ranee
-        Name1739                Rani
-        Name1740                Raquel
-        Name1741                Rashida
-        Name1742                Rasine
-        Name1743                Ratri
-        Name1744                Raven
-        Name1745                Rawnie
-        Name1746                Rayna
-        Name1747                Raynell
-        Name1748                Raziya
-        Name1749                Reba
-        Name1750                Rebecca
-        Name1751                Regan
-        Name1752                Regina
-        Name1753                Rei
-        Name1754                Reidun
-        Name1755                Remy
-        Name1756                Rena
-        Name1757                Renata
-        Name1758                Rene
-        Name1759                Renee
-        Name1760                Rhea
-        Name1761                Rhiamon
-        Name1762                Rhianne
-        Name1763                Rhiannon
-        Name1764                Rhoda
-        Name1765                Rhodanthe
-        Name1766                Rhonda
-        Name1767                Rhonna
-        Name1768                Rhyssa
-        Name1769                Ria
-        Name1770                Riane
-        Name1771                Rica
-        Name1772                Rihana
-        Name1773                Rikki
-        Name1774                Rio
-        Name1775                Risa
-        Name1776                Rita
-        Name1777                Riva
-        Name1778                Roanna
-        Name1779                Roberta
-        Name1780                Robin
-        Name1781                Robyn
-        Name1782                Rochelle
-        Name1783                Rohanna
-        Name1784                Rona
-        Name1785                Rorie
-        Name1786                Rosa
-        Name1787                Rosalind
-        Name1788                Rosalinda
-        Name1789                Rosalinde
-        Name1790                Rosaline
-        Name1791                Rosanne
-        Name1792                Rose
-        Name1793                Roseanne
-        Name1794                Rosemarie
-        Name1795                Rosemary
-        Name1796                Rowena
-        Name1797                Roxana
-        Name1798                Roxanne
-        Name1799                Ruby
-        Name1800                Rumer
-        Name1801                Ruth
-        Name1802                Ruthann
-        Name1803                Ryann
-        Name1804                Ryanne
-        Name1805                Ryba
-        Name1806                Ryssa
-        Name1807                Saba
-        Name1808                Sabina
-        Name1809                Sabiny
-        Name1810                Sabirah
-        Name1811                Sabra
-        Name1812                Sabrina
-        Name1813                Sacha
-        Name1814                Sachi
-        Name1815                Sade
-        Name1816                Sadira
-        Name1817                Saffi
-        Name1818                Safiya
-        Name1819                Sagara
-        Name1820                Saidah
-        Name1821                Sakari
-        Name1822                Sakinah
-        Name1823                Sakti
-        Name1824                Sakura
-        Name1825                Salihah
-        Name1826                Salimah
-        Name1827                Salina
-        Name1828                Sally
-        Name1829                Salome
-        Name1830                Samantha
-        Name1831                Samara
-        Name1832                Samirah
-        Name1833                Sancia
-        Name1834                Sandia
-        Name1835                Sandra
-        Name1836                Sandrine
-        Name1837                Sandya
-        Name1838                Sara
-        Name1839                Sarah
-        Name1840                Sarai
-        Name1841                Saraid
-        Name1842                Saree
-        Name1843                Sarena
-        Name1844                Sari
-        Name1845                Sarisha
-        Name1846                Sasha
-        Name1847                Sashenka
-        Name1848                Satinka
-        Name1849                Savanna
-        Name1850                Saxon
-        Name1851                Scotia
-        Name1852                Searlait
-        Name1853                Season
-        Name1854                Sebasten
-        Name1855                Seema
-        Name1856                Sela
-        Name1857                Selena
-        Name1858                Selina
-        Name1859                Selma
-        Name1860                Semele
-        Name1861                Senta
-        Name1862                Serafina
-        Name1863                Serilda
-        Name1864                Sesha
-        Name1865                Shaine
-        Name1866                Shakira
-        Name1867                Shako
-        Name1868                Shammara
-        Name1869                Shana
-        Name1870                Shanata
-        Name1871                Shandra
-        Name1872                Shandy
-        Name1873                Shani
-        Name1874                Shanley
-        Name1875                Shanna
-        Name1876                Shannon
-        Name1877                Shantay
-        Name1878                Shantha
-        Name1879                Sharman
-        Name1880                Sharon
-        Name1881                Sharri
-        Name1882                Shashi
-        Name1883                Shawn
-        Name1884                Shayndel
-        Name1885                Sheba
-        Name1886                Sheena
-        Name1887                Sheila
-        Name1888                Shela
-        Name1889                Shelby
-        Name1890                Shelley
-        Name1891                Shelly
-        Name1892                Sherri
-        Name1893                Sherry
-        Name1894                Shika
-        Name1895                Shin
-        Name1896                Shina
-        Name1897                Shira
-        Name1898                Shirley
-        Name1899                Shobi
-        Name1900                Shoshana
-        Name1901                Sibley
-        Name1902                Sibongile
-        Name1903                Sibyl
-        Name1904                Sidonia
-        Name1905                Sidra
-        Name1906                Sierra
-        Name1907                Sigourney
-        Name1908                Siham
-        Name1909                Sileas
-        Name1910                Silva
-        Name1911                Silvia
-        Name1912                Simba
-        Name1913                Simone
-        Name1914                Sine
-        Name1915                Sinead
-        Name1916                Siobhan
-        Name1917                Siran
-        Name1918                Sirena
-        Name1919                Siroun
-        Name1920                Sitara
-        Name1921                Sitembile
-        Name1922                Siv
-        Name1923                Sive
-        Name1924                Skyler
-        Name1925                Sofi
-        Name1926                Solana
-        Name1927                Solange
-        Name1928                Soledad
-        Name1929                Solita
-        Name1930                Sondra
-        Name1931                Sonia
-        Name1932                Sonja
-        Name1933                Sonya
-        Name1934                Soo
-        Name1935                Sophia
-        Name1936                Sophie
-        Name1937                Sophronia
-        Name1938                Spica
-        Name1939                Stacey
-        Name1940                Stacia
-        Name1941                Stacy
-        Name1942                Stefania
-        Name1943                Stella
-        Name1944                Stephani
-        Name1945                Stephanie
-        Name1946                Ster
-        Name1947                Stesha
-        Name1948                Stockard
-        Name1949                Storm
-        Name1950                Sukatai
-        Name1951                Suki
-        Name1952                Sumi
-        Name1953                Summer
-        Name1954                Sun
-        Name1955                Susan
-        Name1956                Susanna
-        Name1957                Suzanne
-        Name1958                Svetlana
-        Name1959                Sybil
-        Name1960                Sydelle
-        Name1961                Sydney
-        Name1962                Syeira
-        Name1963                Sylvia
-        Name1964                Syna
-        Name1965                Synia
-        Name1966                Tabitha
-        Name1967                Taci
-        Name1968                Tacita
-        Name1969                Tadi
-        Name1970                Taffy
-        Name1971                Tahirah
-        Name1972                Tai
-        Name1973                Taima
-        Name1974                Tainn
-        Name1975                Taipa
-        Name1976                Taite
-        Name1977                Taka
-        Name1978                Takara
-        Name1979                Takiyah
-        Name1980                Takoda
-        Name1981                Talasi
-        Name1982                Tale
-        Name1983                Talia
-        Name1984                Talia
-        Name1985                Talitha
-        Name1986                Tallulah
-        Name1987                Tam
-        Name1988                Tama
-        Name1989                Tamara
-        Name1990                Tamary
-        Name1991                Tamma
-        Name1992                Tammy
-        Name1993                Tanaka
-        Name1994                Tani
-        Name1995                Tansy
-        Name1996                Tanya
-        Name1997                Tao
-        Name1998                Tara
-        Name1999                Tate
-        Name2000                Tatyana
-        Name2001                Tawnie
-        Name2002                Tawny
-        Name2003                Tayce
-        Name2004                Taylor
-        Name2005                Teague
-        Name2006                Tehya
-        Name2007                Tekla
-        Name2008                Temina
-        Name2009                Terentia
-        Name2010                Teresa
-        Name2011                Terese
-        Name2012                Terrilyn
-        Name2013                Tertia
-        Name2014                Teryn
-        Name2015                Tesia
-        Name2016                Tess
-        Name2017                Tessa
-        Name2018                Thadea
-        Name2019                Thais
-        Name2020                Thalassa
-        Name2021                Thalia
-        Name2022                Than
-        Name2023                Thana
-        Name2024                Thara
-        Name2025                Thea
-        Name2026                Thekla
-        Name2027                Thelma
-        Name2028                Theodosia
-        Name2029                Theone
-        Name2030                Thera
-        Name2031                Therese
-        Name2032                Thirza
-        Name2033                Thora
-        Name2034                Thyra
-        Name2035                Tia
-        Name2036                Tiara
-        Name2037                Tienette
-        Name2038                Tierney
-        Name2039                Tierra
-        Name2040                Tiffany
-        Name2041                Tilda
-        Name2042                Timandra
-        Name2043                Tina
-        Name2044                Tiponya
-        Name2045                Tirza
-        Name2046                Tivona
-        Name2047                Tobey
-        Name2048                Tola
-        Name2049                Tora
-        Name2050                Tori
-        Name2051                Tory
-        Name2052                Tosia
-        Name2053                Tove
-        Name2054                Tracey
-        Name2055                Tracy
-        Name2056                Treasa
-        Name2057                Tresa
-        Name2058                Treva
-        Name2059                Trianon
-        Name2060                Tricia
-        Name2061                Trilby
-        Name2062                Trina
-        Name2063                Trind
-        Name2064                Trish
-        Name2065                Trisha
-        Name2066                Trudy
-        Name2067                Tryne
-        Name2068                Tryphena
-        Name2069                Tuesday
-        Name2070                Tyne
-        Name2071                Ula
-        Name2072                Ulani
-        Name2073                Ultima
-        Name2074                Uma
-        Name2075                Una
-        Name2076                Undine
-        Name2077                Undine
-        Name2078                Urania
-        Name2079                Uria
-        Name2080                Uriana
-        Name2081                Ursula
-        Name2082                Uta
-        Name2083                Vala
-        Name2084                Valda
-        Name2085                Valentina
-        Name2086                Valeria
-        Name2087                Valerie
-        Name2088                Valeska
-        Name2089                Valonia
-        Name2090                Valora
-        Name2091                Vanda
-        Name2092                Vanessa
-        Name2093                Vanora
-        Name2094                Vanya
-        Name2095                Vashti
-        Name2096                Veda
-        Name2097                Velika
-        Name2098                Velma
-        Name2099                Venesssa
-        Name2100                Vera
-        Name2101                Verena
-        Name2102                Verity
-        Name2103                Veronica
-        Name2104                Vesta
-        Name2105                Vevila
-        Name2106                Victoria
-        Name2107                Vidonia
-        Name2108                Violet
-        Name2109                Violet
-        Name2110                Violetta
-        Name2111                Virginia
-        Name2112                Viridis
-        Name2113                Viveka
-        Name2114                Vivian
-        Name2115                Voleta
-        Name2116                Vrinda
-        Name2117                Wakanda
-        Name2118                Wanda
-        Name2119                Waneta
-        Name2120                Wapeka
-        Name2121                Wendy
-        Name2122                Whilhelmina
-        Name2123                Whitney
-        Name2124                Wijdan
-        Name2125                Willow
-        Name2126                Wilma
-        Name2127                Wilona
-        Name2128                Winda
-        Name2129                Winema
-        Name2130                Winifred
-        Name2131                Winna
-        Name2132                Winona
-        Name2133                Wynee
-        Name2134                Wynn
-        Name2135                Wynona
-        Name2136                Xanthe
-        Name2137                Xaveria
-        Name2138                Xaviera
-        Name2139                Xena
-        Name2140                Xenia
-        Name2141                Ximena
-        Name2142                Xylia
-        Name2143                Xylona
-        Name2144                Yachne
-        Name2145                Yanice
-        Name2146                Yarmilla
-        Name2147                Yasmeen
-        Name2148                Yasmin
-        Name2149                Yelinda
-        Name2150                Yenene
-        Name2151                Yesmina
-        Name2152                Yetta
-        Name2153                Yeva
-        Name2154                Yokiko
-        Name2155                Yoko
-        Name2156                Yolanda
-        Name2157                Yolie
-        Name2158                Yonina
-        Name2159                Yoshi
-        Name2160                Yovela
-        Name2161                Yvella
-        Name2162                Yvette
-        Name2163                Yvonne
-        Name2164                Zada
-        Name2165                Zahara
-        Name2166                Zahirah
-        Name2167                Zahra
-        Name2168                Zakia
-        Name2169                Zalea
-        Name2170                Zalika
-        Name2171                Zaltana
-        Name2172                Zandra
-        Name2173                Zara
-        Name2174                Zarah
-        Name2175                Zaza
-        Name2176                Zehava
-        Name2177                Zelda
-        Name2178                Zelenka
-        Name2179                Zelia
-        Name2180                Zella
-        Name2181                Zena
-        Name2182                Zenaide
-        Name2183                Zenia
-        Name2184                Zenobia
-        Name2185                Zerlinda
-        Name2186                Zeva
-        Name2187                Zevida
-        Name2188                Zia
-        Name2189                Ziazan
-        Name2190                Zigana
-        Name2191                Zila
-        Name2192                Zina
-        Name2193                Zinnia
-        Name2194                Zinnia
-        Name2195                Zita
-        Name2196                Zoe
-        Name2197                Zola
-        Name2198                Zona
-        Name2199                Zora
-        Name2200                Zorah
-        Name2201                Zorda
-        Name2202                Zosia
-        Name2203                Zuleika
-        Name2204                Zulema
-        Name2205                Zuza
-        Name2206                Zuzanny
-}

Copied: trunk/096/pkg/skills/magery/OLD/incognito.cfg.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/incognito.cfg)

Deleted: trunk/096/pkg/skills/magery/OLD/incognito.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/incognito.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/incognito.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,57 +0,0 @@
-use uo;
-use os;
-use util;
-use cfgfile;
-
-include ":attributes:attributes";
-
-
-program spell_incognito(parms)
-  var caster := parms.caster;
-  if (!GetObjProperty( caster, "realname"))
-    SetObjProperty( caster, "realname", caster.name );
-  endif
-  var newName := AssignName(caster);
-  SetName( caster, newName );
-  PlaySoundEffect(caster, 0x1e1);
-  Detach();
-  set_critical(1);
-  sleep( 60 * CInt(AP_GetSkill(caster, MAGERY)/10 ) );
-  SetName( caster, GetObjProperty( caster, "realname" ) );
-  EraseObjProperty( caster, "realname" );
-endprogram
-
-function AssignName( me )
-  var index := "MALE";
-  if (me.graphic == 401)
-	index := "FEMALE";
-  endif
-  var cfg := ReadConfigFile( "incognito" );
-  if (!cfg)
-	SendSysMessage(me,"Unable to read incognito.cfg");
-	Syslog("Unable to read incognito.cfg");
-	return;
-  endif
-  var elem := FindConfigElem( cfg, index );
-  var number := GetConfigInt( elem, "Count" );
-  var dice_str := "1d" + CStr(number);
-  var choice := RandomDiceRoll( dice_str );
-  var entry := "Name" + choice;
-  var str := GetConfigString( elem, entry );
-  var title := PreserveTitle( me );
-  str := str + title;
-  return( str );
-endfunction
-
-function PreserveTitle( me )
-  var myname := me.name;
-  var start := find( myname, ">", 1 );
-  if( !start )
-    return;
-  endif
-  var title := myname[ start+1, (len( myname ) - 8) ];
-  if( !title )
-    return("");
-  endif
-  return( title );
-endfunction
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/incognito.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/incognito.src)

Deleted: trunk/096/pkg/skills/magery/OLD/invisibility.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/invisibility.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/invisibility.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,20 +0,0 @@
-use uo;
-use os;
-
-include "include/client";
-include "include/sound";
-include ":attributes:attributes";
-
-
-program spell_invisibility(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	PlaySoundEffect(castOn, SFX_SPELL_INVISIBILITY);
-	castOn.hidden := 1;
-	Detach();
-	sleep(CInt(AP_GetSkill(caster, MAGERY)));
-	castOn.hidden := 0;
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/invisibility.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/invisibility.src)

Deleted: trunk/096/pkg/skills/magery/OLD/lightning.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/lightning.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/lightning.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,34 +0,0 @@
-use uo;
-use util;
-use os;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":magery:reflect";
-
-
-program spell_lightning( parms )
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-	var dmg := RandomDiceRoll("3d7");
-
-	if (dmg < 1)
-		dmg := 1;
-	endif
-  PlaySoundEffect(castOn, SFX_SPELL_LIGHTNING);
-  PlayLightningBoltEffect( castOn);
-  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "lightning bolt"});
-  if(spell_reflect(castOn))
-	castOn := caster;
-    PlaySoundEffect(castOn, SFX_SPELL_LIGHTNING);
-    PlayLightningBoltEffect( castOn);
-  endif
-  if(castOn.isA(POLCLASS_NPC))
-    dmg := dmg * 2;
-  endif
-  ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/lightning.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/lightning.src)

Deleted: trunk/096/pkg/skills/magery/OLD/magicArrow.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magicArrow.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/magicArrow.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,36 +0,0 @@
-use uo;
-use cfgfile;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":magery:reflect";
-include ":attributes:attributes";
-
-
-program spell_magicArrow( parms )
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-
-	PlayMovingEffect( caster, castOn, FX_MAGIC_ARROW, 5, 1 );
-	PlaySoundEffect( caster, SFX_SPELL_MAGIC_ARROW );
-	var dmg := RandomDiceRoll("1d8");
-	if (spell_reflect(castOn))
-		PlayMovingEffect( castOn, caster, FX_MAGIC_ARROW, 5, 1 );
-		PlaySoundEffect( castOn, SFX_SPELL_MAGIC_ARROW );
-		ApplyRawDamage( caster, Resisted(circle,caster,castOn,dmg) );
-	else
-		if (AP_GetVital(castOn, HITS) >= 1)
-			SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "magic arrow" });
-			if (castOn.isA(POLCLASS_NPC))
-				dmg := dmg * 2;
-			endif
-			ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
-		endif
-	endif
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/magicArrow.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/magicArrow.src)

Deleted: trunk/096/pkg/skills/magery/OLD/magicLock.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magicLock.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/magicLock.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,45 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/client";
-include "include/sound";
-include ":attributes:attributes";
-include "include/findCity";
-include "util/key";
-
-
-program spell_magicLock( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  if((castOn.multi) ||(GetObjProperty(castOn,"houseserial")) ||(GetObjProperty(castOn,"house_serial")))
-    SendSysMessage(caster, "That cannot be magically locked!");
-    return;
-  endif
-  if(castOn.locked)
-    SendSysMessage(caster,"That is already locked!");
-    return;
-  endif
-  if((CheckForDoors(castOn)) && ((FindCity(castOn) != "no city") || (FindCity(caster) != "no city")))
-    SendSysMessage(caster, "That cannot be magically locked!");
-    return;
-  endif
-  if(((castOn.graphic<=0x9ab) &&(castOn.graphic>=0x9a8)) ||((castOn.graphic<=0xe43) &&(castOn.graphic>=0xe3c)) ||((castOn.graphic<=0xe80) &&(castOn.graphic>=0xe7c)) ||(checkfordoors(castOn)))
-    PlaySoundEffect(caster, SFX_SPELL_MAGIC_LOCK);
-    PrintTextAbovePrivate(castOn, "*Locked!*", caster);
-    var magery := CInt(AP_GetSkill(caster, MAGERY) / 4);
-    SetObjProperty(castOn, "MLockPickDiff", magery);
-    castOn.locked := 1;
-  else
-    SendSysMessage(caster, "That cannot be magically locked!");
-  endif
-endprogram
-
-
-function CheckForDoors(castOn)
-	if (((castOn.graphic<=0x1ffc) &&(castOn.graphic>=0x1fed)) ||((castOn.graphic<=0x6f4) &&(castOn.graphic>=0x675)))
-		return 1;
-	endif
-
-	return 0;
-endfunction
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/magicLock.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/magicLock.src)

Deleted: trunk/096/pkg/skills/magery/OLD/magicTrap.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magicTrap.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/magicTrap.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,41 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/client";
-include ":attributes:attributes";
-include "include/sound";
-include "include/findCity";
-
-
-program spell_magicTrap(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	if ((castOn.isa(POLCLASS_DOOR)) || (castOn.objtype == 0xe79) || ((castOn.graphic<=0x9ab) &&(castOn.graphic>=0x9a8)) ||((castOn.graphic<=0xe43) &&(castOn.graphic>=0xe3c)) ||((castOn.graphic<=0xe80) &&(castOn.graphic>=0xe7c)))
-		var magery := AP_GetSkill(caster, MAGERY);
-		var trapstr := CInt(magery/5);
-		if (findcity(castOn) != "no city")
-			caster.setCriminal(1);
-		endif
-		if (findcity(caster) != "no city")
-			caster.setCriminal(1);
-		endif
-		if (trapstr < 1)
-			trapstr := 1;
-		endif
-		if (trapstr > 5)
-			trapstr:=5;
-		endif
-		PlaySoundEffect(caster, SFX_SPELL_MAGIC_TRAP);
-		PlayStationaryEffect(castOn.x, castOn.y, castOn.z, 0x376a, 30, 30, 0, caster.realm);
-		SetObjProperty(castOn, "trap_strength", trapstr);
-		SetObjProperty(castOn, "trap_type", 4);
-		SetObjProperty(castOn, "oldscript", castOn.usescript);
-		castOn.usescript := ":tinkering:tinkerTraps";
-	else
-		SendSysMessage(caster, "That cannot be magically trapped!");
-	endif
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/magicTrap.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/magicTrap.src)

Deleted: trunk/096/pkg/skills/magery/OLD/magicUntrap.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magicUntrap.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/magicUntrap.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,27 +0,0 @@
-// $Id: magicUntrap.src 806 2005-11-01 21:56:02Z austin $
-
-use os;
-use uo;
-use util;
-
-include "include/client";
-include "include/sound";
-include ":attributes:attributes";
-
-program spell_magicUntrap(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	if (GetObjProperty(castOn, "trap_strength") > 25)
-		SendSysMessage(caster, "You couldn't disarm the trap.");
-	else
-		var oldscript := GetObjProperty(castOn, "oldscript");
-		PlaySoundEffect(caster, SFX_SPELL_MAGIC_UNTRAP);
-		PlayStationaryEffect(castOn.x, castOn.y, castOn.z, 0x376a, 30, 30,0 , caster.realm);
-		EraseObjProperty(castOn, "trap_type");
-		EraseObjProperty(castOn, "trap_strength");
-		castOn.usescript := oldscript;
-	endif
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/magicUntrap.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/magicUntrap.src)
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magicUntrap.src	2005-11-04 06:29:43 UTC (rev 891)
+++ trunk/096/pkg/skills/magery/OLD/magicUntrap.src.temp	2005-11-04 07:22:07 UTC (rev 897)
@@ -0,0 +1,27 @@
+// $Id$
+
+use os;
+use uo;
+use util;
+
+include "include/client";
+include "include/sound";
+include ":attributes:attributes";
+
+program spell_magicUntrap(parms)
+	var caster := parms.caster;
+	var castOn := parms.castOn;
+
+	if (GetObjProperty(castOn, "trap_strength") > 25)
+		SendSysMessage(caster, "You couldn't disarm the trap.");
+	else
+		var oldscript := GetObjProperty(castOn, "oldscript");
+		PlaySoundEffect(caster, SFX_SPELL_MAGIC_UNTRAP);
+		PlayStationaryEffect(castOn.x, castOn.y, castOn.z, 0x376a, 30, 30,0 , caster.realm);
+		EraseObjProperty(castOn, "trap_type");
+		EraseObjProperty(castOn, "trap_strength");
+		castOn.usescript := oldscript;
+	endif
+
+	return;
+endprogram

Deleted: trunk/096/pkg/skills/magery/OLD/magiccircles.cfg
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magiccircles.cfg	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/magiccircles.cfg	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,87 +0,0 @@
-Circle 1
-{
-    Mana        4
-    Difficulty  20
-    PointValue  20
-    animReps	1
-    extraWait	500
-}
-
-Circle 2
-{
-    Mana        6
-    Difficulty  30
-    PointValue  40
-    animReps	2 
-    extraWait	0
-}
-
-Circle 3
-{
-    Mana        9
-    Difficulty  40
-    PointValue  80
-    animReps	2
-    extraWait	250
-}
-
-Circle 4
-{
-    Mana        11
-    Difficulty  50
-    PointValue  100
-    animReps	2
-    extraWait	500
-}
-
-Circle 5
-{
-    Mana        14
-    Difficulty  60
-    PointValue  120
-    animReps	3
-    extraWait	0
-}
-
-Circle 6
-{
-    Mana        20
-    Difficulty  70
-    PointValue  140
-    animReps	3
-    extraWait	250
-}
-
-Circle 7
-{
-    Mana        40
-    Difficulty  80
-    PointValue  160
-    animReps	3
-    extraWait	500
-}
-
-Circle 8
-{
-    Mana        50
-    Difficulty  90
-    PointValue  180
-    animReps	4
-    extraWait	0
-}
-
-Circle 9
-{
-    Mana        75
-    Difficulty  100
-    PointValue  300
-    Delay       5000
-}
-
-Circle 10
-{
-    Mana        100
-    Difficulty  100
-    PointValue  300
-    Delay       7000
-}

Copied: trunk/096/pkg/skills/magery/OLD/magiccircles.cfg.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/magiccircles.cfg)

Deleted: trunk/096/pkg/skills/magery/OLD/manaDrain.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/manaDrain.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/manaDrain.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,37 +0,0 @@
-use uo;
-use util;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-
-
-program spell_manaDrain(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var spellid := parms.spellid;
-	var spellcfg := ReadConfigFile(":*:spells");
-	var circle := spellcfg[spellid].circle;
-
-	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "mana drain" });
-	if (spell_reflect(castOn))
-		var tmp := castOn;
-		castOn := caster;
-		caster := tmp;
-	endif
-	var dmg := Cint(GetAttribute(caster, "magery") / 2);
-	var diff := Resisted(circle, caster, castOn, dmg);
-	if (diff)
-		PlaySoundEffect( caster, SFX_SPELL_MANA_DRAIN );
-		PlayObjectCenteredEffect( castOn, FX_HEAL_EFFECT, 7,0x10 );
-		if (diff > AP_GetVital(castOn, MANA))
-			AP_SetVital(castOn, MANA, 0);
-		else
-			AP_SetVital(castOn, MANA, AP_GetVital(castOn, MANA) - diff);
-		endif
-	endif
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/manaDrain.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/manaDrain.src)

Deleted: trunk/096/pkg/skills/magery/OLD/manaVamp.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/manaVamp.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/manaVamp.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,44 +0,0 @@
-use uo;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":magery:reflect";
-include ":attributes:attributes";
-
-
-program spell_manaVamp(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "mana vampire"});
-  if(spell_reflect(castOn))
-    castOn := caster;
-  endif
-  if(!castOn.isA(POLCLASS_MOBILE))
-    return;
-  endif
-  var dmg := Cint(GetAttribute(caster, "magery") / 3);
-  var diff := Resisted(circle, caster, castOn, dmg);
-  if(diff)
-    PlaySoundEffect(caster, SFX_SPELL_MANA_VAMPIRE);
-    PlayObjectCenteredEffect(castOn, FX_GLOW, 7,0x10);
-    var gain := 0;
-	if(diff > AP_GetVital(castOn, MANA))
-	  gain := AP_GetVital(castOn, MANA);
-	  AP_SetVital(castOn, MANA, 0);
-	else
-	  gain := diff;
-	  AP_SetVital(castOn, MANA, AP_GetVital(castOn, MANA) - diff);
-	endif
-	AP_SetVital(caster, MANA, AP_GetVital(caster, MANA) + gain);
-	if(AP_GetVital(caster, MANA) > AP_GetVitalMaximumValue(caster, MANA))
-	  AP_SetVital(caster, MANA, AP_GetVitalMaximumValue(caster, MANA));
-	endif
-  endif
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/manaVamp.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/manaVamp.src)

Deleted: trunk/096/pkg/skills/magery/OLD/mark.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/mark.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/mark.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,46 +0,0 @@
-use uo;
-use util;
-
-include "include/objtype";
-include "include/sound";
-include "include/tileEffects";
-
-
-program mark(parms)
-  var caster := parms.caster;
-  var castOn := Target(caster);
-  if (castOn.objtype != UOBJ_RUNE)
-    SendSysMessage(caster, "You can only cast that on a recall rune!");
-	return;
-  endif
-  if(caster.multi)
-    SendSysMessage(caster,"You cannot mark runes here.");
-    PlaySoundEffect(caster,0x005d);
-    PlayObjectCenteredEffect(caster, 0x3735,0x0a, 0x1e);
-    return;
-  endif
-  if(((caster.x >= 5120) && (caster.x <= 5375) && (caster.y >= 0) && (caster.y <= 255)) or (caster.multi))
-    SendSysMessage(caster, "You cannot mark runes here.");
-    return;
-  endif
-  if (!Accessible(caster, castOn))
-	SendSysMessage(caster, "You can't reach that!");
-  endif
-  if (castOn.objtype != UOBJ_RUNE)
-	SendSysMessage(caster, "You can only cast that on a recall rune!");
-	return;
-  endif
-  if(!ReserveItem(castOn))
-    SendSysMessage(caster,"Your spell fizzles.");
-    return;
-  endif
-  PlayObjectCenteredEffect(caster, FX_MARK_EFFECT, 10, 10);
-  PlaySoundEffect(caster, SFX_SPELL_MARK);
-  SetObjProperty(castOn, "x", caster.x);
-  SetObjProperty(castOn, "y", caster.y);
-  SetObjProperty(castOn, "z", caster.z);
-  SetObjProperty(castOn, "realm", caster.realm);
-  SetName(castOn, "a marked recall rune");
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/mark.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/mark.src)

Deleted: trunk/096/pkg/skills/magery/OLD/massCurse.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/massCurse.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/massCurse.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,47 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/statMod";
-include ":attributes:attributes";
-include "include/sound";
-include "include/tileEffects";
-include "include/spellAttack";
-include ":magery:reflect";
-include "include/magic";
-
-program massCurse( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  PlaySoundEffect(caster, SFX_SPELL_MASS_CURSE);
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := GetModAmount( magery );
-  var duration := GetModDuration( magery );
-  Detach();
-  foreach castOn in ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, 4, caster.realm );
-	SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "mass curse"});
-    if(spell_reflect(castOn))
-	  castOn := caster;
-    endif
-    PlaySoundEffect(castOn, SFX_SPELL_MASS_CURSE);
-    PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 10,10);
-	send_attack(castOn,caster, 46);
-    if(castOn.criminal == 0)
-      caster.setCriminal(1);
-    endif
-    modAmount := Resisted(circle,caster,castOn, GetModAmount( magery ));
-	if (CanMod(castOn, "str"))
-	  DoTempMod(castOn, "str", 0- modAmount, duration);
-	endif
-	if (CanMod(castOn, "dex"))
-	  DoTempMod(castOn, "dex", 0- modAmount, duration);
-	endif
-	if (CanMod(castOn, "int"))
-	  DoTempMod(castOn, "int", 0- modAmount, duration);
-	endif
-  endforeach
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/massCurse.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/massCurse.src)

Deleted: trunk/096/pkg/skills/magery/OLD/massDispel.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/massDispel.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/massDispel.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,64 +0,0 @@
-use uo;
-
-include "include/eventID";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-include "include/spellAttack";
-include "include/magic";
-
-
-program spell_massDispel(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  var npccfg := ReadConfigFile("::npcdesc");
-  var magery := AP_GetSkill(caster, MAGERY);
-  var range := CInt(magery / 20);
-  var targets := ListMobilesNearLocation( castOn.x, castOn.y, castOn.z, range, caster.realm );
-  PlaySoundEffect( caster, 0x202 );
-  foreach mobile in targets
-	SetObjProperty(mobile, "LastHit", {caster.name, caster.serial, "mass dispel"});
-    if(spell_reflect(mobile))
-	  mobile := caster;
-    endif
-    var summoned := GetObjProperty( mobile, "summoned");
-	if (summoned == 1)
-      PlaySoundEffect(caster, 0x202 );
-      PlayStationaryEffect( mobile.x, mobile.y, mobile.z, FX_HEAL_EFFECT, 0xa, 0xa,0 , caster.realm );
-      var master := SystemFindObjectBySerial(CInt(GetObjProperty(mobile, "master")));
-      if(master)
-        var resist := AP_GetSkill(master, RESISTING_SPELLS);
-        if((RandomInt(99) + 1) < resist)
-          MoveCharacterToLocation(mobile,0,0,0,MOVECHAR_FORCELOCATION);
-          ApplyRawDamage(mobile, AP_GetVitalMaximumValue(mobile, HITS) + 3);
-        endif
-        send_attack(caster, mobile, 41);
-    endif
-    else
-      if(mobile.isA(POLCLASS_NPC))
-        var element := npccfg[mobile.npctemplate].elemental;
-        if(element == "undead")
-          PlayStationaryEffect( mobile.x, mobile.y, mobile.z, FX_HEAL_EFFECT, 0xa, 0xa,0, caster.realm );
-          var ev := array;
-          ev.+ type;
-          ev.+ source;
-          ev.type := EVID_PEACEMADE;
-          SendEvent(mobile, ev);
-          ev.source := caster;
-          SendEvent(mobile, ev);
-          ev.type := EVID_ENGAGED;
-          SendEvent(mobile, ev);
-	      PlaySoundEffect( caster, 0x202 );
-          PlayObjectCenteredEffect(mobile, 0x37b9,0x03, 0x0a);
-          var dmg := CalcSpellDamage(circle,caster) + (RandomInt(20));
-          ApplyRawDamage(mobile, Resisted(circle,caster,mobile,dmg));
-        endif
-      endif
-    endif
-  endforeach
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/massDispel.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/massDispel.src)

Deleted: trunk/096/pkg/skills/magery/OLD/meteorSwarm.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/meteorSwarm.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/meteorSwarm.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,41 +0,0 @@
-use cfgfile;
-use uo;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-include "include/spellAttack";
-
-
-program spell_meteorSwarm( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  Detach();
-  var dmg;
-  var victims := ListMobilesNearLocationEx( castOn.x, castOn.y, castOn.z, 3, 0x03, caster.realm);
-  foreach mobile in victims
-	PlaySoundEffect( mobile, SFX_SPELL_FIREBALL );
-	PlayMovingEffect( caster, mobile, FX_FIREBALL, 5, 1 );
-	SetObjProperty(mobile, "LastHit", {caster.name, caster.serial, "meteor swarm"});
-    if(spell_reflect(mobile))
-	  mobile := caster;
-	  PlaySoundEffect( mobile, SFX_SPELL_FIREBALL );
-	  PlayMovingEffect( caster, mobile, FX_FIREBALL, 5, 1 );
-    endif
-	dmg := RandomDiceRoll("6d8");
-	send_attack(mobile,caster, 55);
-    if(AP_GetVital(mobile, HITS) > 1)
-      if(castOn.npctemplate)
-        dmg := dmg * 2;
-      endif
-      ApplyRawDamage(mobile, Resisted(circle,caster,mobile,dmg));
-    endif
-	sleep(1);
-  endforeach
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/meteorSwarm.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/meteorSwarm.src)

Deleted: trunk/096/pkg/skills/magery/OLD/mindBlast.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/mindBlast.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/mindBlast.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,42 +0,0 @@
-use os;
-use uo;
-
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-include ":magery:reflect";
-include ":attributes:attributes";
-
-
-program spell_mindBlast( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  var myInt := CInt(AP_GetStat(caster, INTELLIGENCE));
-  var hisInt := CInt(AP_GetStat(castOn, INTELLIGENCE));
-  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "mind blast" });
-  var modif := myInt - hisInt;
-  if(hisInt > myInt)
-    modif := hisInt - myInt;
-	castOn := caster;
-  elseif(hisInt == myInt)
-	return;
-  endif
-  if(modif > 20)
-    modif:= 20;
-  endif
-  if(spell_reflect(castOn))
-	castOn := caster;
-  endif
-  PlaySoundEffect(castOn, SFX_SPELL_MIND_BLAST);
-  PlayObjectCenteredEffect(castOn, FX_CURSE_EFFECT, 7,0x10);
-  var dmg := RandomDiceRoll("3d7");
-  var diff := Resisted(circle, caster, castOn, dmg);
-  if(castOn.isA(POLCLASS_NPC))
-    diff := diff * 2;
-  endif
-  ApplyRawDamage(castOn, diff);
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/mindBlast.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/mindBlast.src)

Deleted: trunk/096/pkg/skills/magery/OLD/nightSight.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/nightSight.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/nightSight.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,24 +0,0 @@
-use uo;
-use util;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-
-
-program nightSight(parms, spellid)
-
-	spellid := spellid;
-
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	PlaySoundEffect(castOn, SFX_SPELL_NIGHT_SIGHT );
-	var magery := AP_GetSkill(caster, MAGERY);
-	castOn.setlightlevel(0, magery * 60);
-	PlayObjectCenteredEffect(castOn, FX_BLESS_EFFECT, 10,10);
-
-	return;
-
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/nightSight.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/nightSight.src)

Deleted: trunk/096/pkg/skills/magery/OLD/pField.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/pField.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/pField.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,24 +0,0 @@
-use uo;
-use os;
-
-include "include/sound";
-include "include/tileEffects";
-include "include/objtype";
-
-
-program spell_pField(parms)
-	var castOn := parms.castOn;
-	var boss := parms.caster;
-	SetScriptController(boss);
-	SetObjProperty(castOn,"#pfield", 1);
-	PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_CURSE_EFFECT, 10, 0xa, 0, castOn.realm );
-	PlaySoundEffect( castOn, SFX_SPELL_PARALYZE );
-	Detach();
-	castOn.paralyzed := 1;
-	sleep(15);
-	castOn.paralyzed := 0;
-	sleepms(500);
-	EraseObjProperty(castOn,"#pfield");
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/pField.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/pField.src)

Deleted: trunk/096/pkg/skills/magery/OLD/paraField.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/paraField.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/paraField.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,38 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/fields";
-include "include/objtype";
-include "include/sound";
-include ":attributes:attributes";
-
-
-program spell_paraField(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	var fields := {};
-	var x := castOn.x;
-	var y := castOn.y;
-	var z := castOn.z;
-	case (get_direction(caster))
-		"NS" : fields:= CreateNorthSouthField(caster, UOBJ_PARAFIELD_NS, x, y, z, 5);
-		"EW" : fields:= CreateEastWestField(caster, UOBJ_PARAFIELD_EW, x, y, z, 5);
-	endcase
-	Detach();
-	var duration := CInt(AP_GetSkill(caster, MAGERY) )/2;
-	if (duration < 20)
-		duration := 20;
-	endif
-	var i;
-	for (i := 1; i <= 5; i := i + 1)
-		SetObjProperty(fields[i], "f", 1);
-		PlaySoundEffect(fields[i], SFX_20C);
-		sleep(duration/4);
-	endfor
-	foreach fieldpart in fields
-		DestroyItem(fieldpart);
-	endforeach
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/paraField.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/paraField.src)

Deleted: trunk/096/pkg/skills/magery/OLD/paralyze.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/paralyze.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/paralyze.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,68 +0,0 @@
-use uo;
-use os;
-
-include ":magery:reflect";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include "include/statMod";
-include "include/magic";
-
-
-program spell_paralyze( parms )
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "paralyze" });
-	if (spell_reflect(castOn))
-		castOn := caster;
-	endif
-	var amt := 10 + RandomInt(CInt(AP_GetSkill(caster, MAGERY)/5));
-	var duration := ParaResist(2, caster, castOn, amt);
-	PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_CURSE_EFFECT, 10, 0xa, 0, caster.realm );
-	PlaySoundEffect( castOn, SFX_SPELL_PARALYZE );
-	DoTempMod(castOn, "p", 1, duration);
-
-	return;
-endprogram
-
-
-function ParaResist(circle, caster, castOn, amt)
-  var magery := CInt(AP_GetSkill(caster, MAGERY));
-  var evalint := CInt(AP_GetSkill(caster, EVALUATING_INTELLIGENCE));
-  var resist := CInt(AP_GetSkill(castOn, RESISTING_SPELLS));
-  var chk1 := (resist / 5);
-  var chk2 := resist - (((magery - 20) / 5) + (circle * 5));
-  if(chk1 < 1)
-    chk1 := 1;
-  endif
-  if(chk2 < 1)
-    chk2 := 1;
-  endif
-  var diff := 0;
-  if(chk1 > chk2)
-    diff := chk1;
-  else
-    diff := chk2;
-  endif
-  //var points := getresistpoints(circle, castOn, RESISTING_SPELLS);
-  if(castOn.dead)
-    return 0;
-  endif
-  if((RandomInt(99) + 1) <= diff)
-	SendSysMessage(castOn, "You feel yourself resisting magical energy!");
-	PlaySoundEffect(castOn, SFX_SPELL_WEAKEN);
-	PlayObjectCenteredEffect(castOn, FX_CURSE_EFFECT, 5,5);
-	//AwardRawSkillPoints(castOn, RESISTING_SPELLS, points);
-	amt := 0;
-	return amt;
-  endif
-  var modamt := 1;
-  if(resist > evalint)
-    modamt := (1 + ((evalint - resist) / 200.0));
-  elseif(evalint > resist)
-    modamt := (1 + ((evalint - resist) / 500.0));
-  endif
-  amt := (amt * modamt);
-  return CInt(amt);
-endfunction

Copied: trunk/096/pkg/skills/magery/OLD/paralyze.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/paralyze.src)

Deleted: trunk/096/pkg/skills/magery/OLD/poison.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/poison.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/poison.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,97 +0,0 @@
-use os;
-use uo;
-use cfgfile;
-
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-include ":timedscripts:timedScripts";
-
-const EVID_DISCHARGE := 0x123457;
-
-
-program poison(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var npccfg := ReadConfigFile("::npcdesc");
-  if(spell_reflect(castOn))
-    castOn := caster;
-  endif
-  if((!castOn.isA(POLCLASS_MOBILE)) || (castOn.dead))
-    SendSysMessage(caster, "You cannot poison that.");
-    return;
-  endif
-  PlaySoundEffect(castOn, 0x206);
-  PlayObjectCenteredEffect(castOn, FX_CURSE_EFFECT, 0x0a,0x1e);
-  var pLevel :=  0;
-  var skil := AP_GetSkill(caster, MAGERY);
-  if(skil <= 50)
-    pLevel := 1;
-  elseif(skil <= 90)
-    pLevel := 2;
-  elseif(skil <= 98)
-    pLevel := 3;
-  else
-    pLevel := 4;
-  endif
-  pLevel := pLevel - RandomInt(2);
-  if(pLevel < 1)
-    pLevel := 1;
-  endif
-  var passparms, newamt;
-  if(castOn.isA(POLCLASS_NPC))
-    var element := npccfg[castOn.npctemplate].elemental;
-    if(element == "poison")
-      HealDamage(castOn, (pLevel * 50));
-    else
-      newamt := PoisonResist(caster, castOn, pLevel);
-      if(newamt > 0)
-        SendSysMessage(castOn, "You have been poisoned by " + caster.name +"!");
-        Detach();
-        passparms := {castOn, caster, "poison spell", newamt};
-        start_script(":magery:poisonDamage", passparms);
-        SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "poison spell" });
-      else
-        SendSysMessage(caster, "Your target resists the spell completely.");
-      endif
-    endif
-  else
-    newamt := poisonresist(caster, castOn, pLevel);
-    if(newamt > 0)
-      SendSysMessage(castOn, "You have been poisoned by " + caster.name +"!");
-      Detach();
-      TS_StartTimer(castOn, "defaultPoison", 20, pLevel);
-      //passparms := {castOn, caster, "poison spell", newamt};
-      //start_script(":magery:poisonDamage", passparms);
-      SetObjProperty(castOn, "LastHit", {caster.name, caster.serial, "poison spell" });
-    else
-      SendSysMessage(castOn, "You resist the spell completely.");
-      if(caster != castOn)
-        SendSysMessage(caster, "Your target resists the spell completely.");
-      endif
-    endif
-  endif
-endprogram
-
-function PoisonResist(caster, castOn, amt)
-  var diff := Cint(AP_GetSkill(caster, MAGERY) + Cint(AP_GetSkill(caster, EVALUATING_INTELLIGENCE) / 10));
-  if( SkillCheck(castOn, RESISTING_SPELLS, diff) > 0 )
-    SendSysMessage(castOn, "You feel yourself resisting magical energy!");
-    PlaySoundEffect(castOn, SFX_SPELL_WEAKEN);
-    PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 5,5);
-    if(amt == 5)
-      amt := 3;
-    elseif(amt == 4)
-      return 2;
-    elseif(amt == 3)
-      return 2;
-    elseif(amt == 2)
-      return 1;
-    elseif(amt == 1)
-      return 0;
-    endif
-  else
-    return amt;
-  endif
-endfunction

Copied: trunk/096/pkg/skills/magery/OLD/poison.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/poison.src)

Deleted: trunk/096/pkg/skills/magery/OLD/poisonField.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/poisonField.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/poisonField.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,27 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/fields";
-include ":attributes:attributes";
-include "include/objtype";
-
-
-program spell_poisonField( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var fields := {};
-  var x := castOn.x;
-  var y := castOn.y;
-  var z := castOn.z;
-  case(get_direction(caster))
-	"NS" : fields:= CreateNorthSouthField(caster, UOBJ_POISONFIELD_NS, x, y, z, 5);
-	"EW" : fields:= CreateEastWestField(caster, UOBJ_POISONFIELD_EW, x, y, z, 5);
-  endcase
-  Detach();
-  var duration := 20 + ( CInt(AP_GetSkill(caster, MAGERY) ) / 3 );
-  sleep(duration);
-  foreach fieldpart in fields
-    DestroyItem(fieldpart);
-  endforeach
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/poisonField.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/poisonField.src)

Deleted: trunk/096/pkg/skills/magery/OLD/polymorph.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/polymorph.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/polymorph.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,83 +0,0 @@
-use util;
-
-include ":attributes:attributes";
-
-
-program spell_polymorph( parms )
-  var caster := parms.caster;
-  var magery     := CInt(AP_GetSkill(caster, MAGERY));
-  var meditation := CInt(AP_GetSkill(caster, MEDITATION));
-  var evalint    := CInt(AP_GetSkill(caster, EVALUATING_INTELLIGENCE));
-  var critgroup;
-  var thecreature;
-  if (magery < 70)
-	critgroup := RandomInt(1);
-  elseif (magery < 80)
-	critgroup := RandomInt(1)+1;
-  elseif (magery < 90)
-	critgroup := RandomInt(1)+2;
-  else
-	critgroup := 3;
-  endif
-  var critter := RandomInt(8);
-  case (critgroup)
-	0:
-	  case (critter)
-		0: thecreature := 6;	//bird
-		1: thecreature := 51;	//slime
-		2: thecreature := 5;	//eagle
-		3: thecreature := 39;	//mongbat
-		4: thecreature := 31;	//headless
-		5: thecreature := 29;	//gorilla
-		6: thecreature := 42;	//ratman
-		7: thecreature := 28;	//giant spider
-	  endcase
-	1:
-	  case (critter)
-		0: thecreature := 48;	//scorpion
-		1: thecreature := 7;	//orc
-		2: thecreature := 3;	//zombie
-		3: thecreature := 17;	//orc
-		4: thecreature := 33;	//lizardman
-		5: thecreature := 26;	//shade
-		6: thecreature := 21;	//giant serp
-		7: thecreature := 30;	//harpy
-	  endcase
-	2:
-	  case (critter)
-	    0: thecreature := 18;	//ettin
-		1: thecreature := 8;	//corpser
-		2: thecreature := 22;	//beholder
-		3: thecreature := 14;	//earth elem
-		4: thecreature := 16;	//water elem
-		5: thecreature := 15;	//fire elem
-		6: thecreature := 13;	//air elem
-		7: thecreature := 47;	//ent
-	  endcase
-	3:
-	  case (critter)
-		0: thecreature := 1;	//ogre
-		1: thecreature := 4;	//gargoyle
-		2: thecreature := 24;	//lich
-		3: thecreature := 150;	//seaserp
-		4: thecreature := 9;	//demon
-		5: thecreature := 12;	//dragon
-		6: thecreature := 10;	//demon with sword
-		7: thecreature := 58;	//wisp
-	  endcase
-  endcase
-  caster.graphic := thecreature;
-  if ( thecreature == 150 )
-	caster.color := 233;
-  else
-	caster.color := 0;
-  endif
-  var magerydur := magery/2;
-  var meditadur := magerydur + meditation/10;
-  var duration  := meditadur + evalint/10;
-  Detach();
-  sleep(duration);
-  caster.graphic := caster.objtype;
-  caster.color := caster.truecolor;
-  EraseObjProperty(caster,"poly");
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/polymorph.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/polymorph.src)

Deleted: trunk/096/pkg/skills/magery/OLD/protection.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/protection.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/protection.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,33 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-include "include/statMod";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-
-program spell_protection(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  PlaySoundEffect(castOn, SFX_SPELL_PROTECTION);
-  PlayObjectCenteredEffect(castOn, FX_BLESS_EFFECT, 7,7);
-  if (!CanMod(castOn, "ar"))
-	SendSysMessage(caster,"Already under the influence!");
-	return;
-  endif
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := (GetModAmount(magery) * 2);
-  var duration := GetModDuration(magery);
-  var itmcfg := ReadConfigFile(":*:itemdesc");
-  var arpoints := 0;
-  foreach thing in ListEquippedItems(castOn)
-    arpoints := arpoints + (CInt(itmcfg[thing.objtype].AR) / 12);
-  endforeach
-  if(modAmount > arpoints)
-    modAmount := modAmount - arpoints;
-  else
-    modAmount := 0;
-  endif
-  DoTempMod(castOn, "ar", modAmount, duration);
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/protection.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/protection.src)

Deleted: trunk/096/pkg/skills/magery/OLD/reactiveArmor.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/reactiveArmor.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/reactiveArmor.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,30 +0,0 @@
-use uo;
-use os;
-
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-
-
-program spell_reactiveArmor( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  PlaySoundEffect(castOn, SFX_SPELL_REACTIVE_ARMOR);
-  PlayObjectCenteredEffect( castOn, FX_SPARK_EFFECT, 7, 0x10 );
-  if(GetObjProperty(castOn, "ar"))
-	SendSysMessage(caster,"Already under the influence!");
-	return;
-  endif
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := magery / 10;
-  var duration := CInt(RandomInt(10) + (magery / 2));
-  SetObjProperty(castOn, "ReactiveArmor", modAmount);
-  Detach();
-  sleep(duration);
-  if(GetObjProperty(castOn, "ReactiveArmor"))
-    PlaySoundEffect(castOn, 0x1eb);
-    EraseObjProperty(castOn,"ReactiveArmor");
-  endif
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/reactiveArmor.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/reactiveArmor.src)

Deleted: trunk/096/pkg/skills/magery/OLD/recall.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/recall.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/recall.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,108 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-include "include/client";
-include "include/objtype";
-include "include/isValidLoc";
-
-
-program spell_recall(parms)
-  var caster := parms.caster;
-  var failure := 0;  
-  var castOn := Target(caster);
-  if((castOn.objtype != UOBJ_RUNE) && (castOn.objtype != 0x6100))
-    SendSysMessage(caster, "You can only cast that on a recall rune.");
-	return;
-  endif
-  if(!ReserveItem(castOn))
-    return;
-  endif
-  if(GetObjProperty(castOn, "Vendored"))
-    SendSysMessage(caster, "You cannot recall off of runes on a vendor.");
-    return;
-  endif
-  var tox := CInt(GetObjProperty( castOn, "x" ));
-  var toy := CInt(GetObjProperty( castOn, "y" ));
-  var toz := CInt(GetObjProperty( castOn, "z" ));
-  var torealm := GetObjProperty( castOn, "realm" );
-  if(!tox)
-    SendSysMessage(caster, "The rune must be marked.");
-    return;
-  endif
-  if(!torealm)
-  	torealm := "britannia";
-  endif
-  
-  if(!isValidLoc(tox,toy,torealm))
-    SendSysMessage(caster, "Invalid recall location.");
-    DestroyItem(castOn);
-    return;
-  endif
-  PlaySoundEffect(caster, 0x210);
-  Detach();
-  var chk := 0;
-  if((caster.x >= 5120) && (caster.x <= 5375) && (caster.y >= 0) && (caster.y <= 255))
-    SendSysMessage(caster, "Your spell fails and consumes the rune!");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    elseif(castOn.objtype == 0x6100)
-      removeentry(castOn);
-    endif
-    chk := 1;
-  endif
-  var multicheck := CreateItemAtLocation(1, 1, 0, 0xeed, 1, torealm);
-  multicheck.hidden := 1;
-  if(!MoveItemToLocation(multicheck, tox, toy, toz, MOVEITEM_NORMAL))
-    SendSysMessage(caster, "Something is blocking the location.");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    elseif(castOn.objtype == 0x6100)
-      removeentry(castOn);
-    endif
-    chk := 1;
-  endif
-  if(multicheck.multi)
-    SendSysMessage(caster,"Something is blocking the location.");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    elseif(castOn.objtype == 0x6100)
-      removeentry(castOn);
-    endif
-    chk := 1;
-  endif
-  DestroyItem(multicheck);
-  if(chk == 1)
-    return;
-  endif
-  if (failure == 0);
-  	if(torealm != caster.realm)
-  		MoveObjectToRealm(caster,torealm,1,1,0,MOVECHAR_FORCELOCATION);
-  	endif
-	MoveCharacterToLocation( caster, tox, toy, toz );
-  elseif (failure == 2)
-    SendSysMessage(caster, "Your spell fails and consumes the rune!");
-    if(castOn.objtype == UOBJ_RUNE)
-      DestroyItem(castOn);
-    endif
-  endif
-  PlaySoundEffect(caster, 0x1fd);
-endprogram
-
-function removeentry(castOn)
-  var tox := CInt(GetObjProperty( castOn, "x" ));
-  var toy := CInt(GetObjProperty( castOn, "y" ));
-  var toz := CInt(GetObjProperty( castOn, "z" ));
-  var defs := GetObjProperty(castOn, "runedefs");
-  var holder := {};
-  foreach thing in defs
-    if((Cint(thing[2]) != tox) or (Cint(thing[3]) != toy) or (Cint(thing[4]) != toz))
-      holder.append(thing);
-    endif
-  endforeach
-  SetObjProperty(castOn, "runedefs", holder);
-  EraseObjProperty(castOn, "x");
-  EraseObjProperty(castOn, "y");
-  EraseObjProperty(castOn, "z");
-  return;
-endfunction
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/recall.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/recall.src)

Deleted: trunk/096/pkg/skills/magery/OLD/reflect.inc
===================================================================
--- trunk/096/pkg/skills/magery/OLD/reflect.inc	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/reflect.inc	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,41 +0,0 @@
-use uo;
-use os;
-
-include "include/eventID";
-include "include/sound";
-include "include/tileEffects";
-
-
-function spell_reflect(cast_on)
-	var mr := CInt(GetObjProperty(cast_on, "mr"));
-	if (mr >= 1)
-		PlaySoundEffect(cast_on, SFX_SPELL_MAGIC_REFLECTION);
-		PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 10,10);
-		SendSysMessage(cast_on, "Your magic reflect spell saved you!");
-		if (mr == 1)
-			EraseObjProperty(cast_on, "mr");
-		elseif (mr == 2)
-			var holder, pid;
-			var eqp := GetObjProperty(cast_on, "EquipTimers");
-			foreach thing in ListEquippedItems(cast_on)
-				foreach entry in eqp
-					if ((thing.serial == entry[1]) and (entry[2] == "ref"))
-						holder := GetObjProperty(thing, "pid");
-						break;
-					endif
-				endforeach
-			endforeach
-			pid := getprocess(holder);
-			if (pid)
-				var k := struct;
-				k.+type := EVID_DISCHARGE;
-				pid.sendevent(k);
-			else
-				EraseObjProperty(cast_on, "mr");
-			endif
-		endif
-		return 1;
-	endif
-
-	return 0;
-endfunction

Copied: trunk/096/pkg/skills/magery/OLD/reflect.inc.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/reflect.inc)

Deleted: trunk/096/pkg/skills/magery/OLD/reflect.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/reflect.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/reflect.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,21 +0,0 @@
-use uo;
-use os;
-
-include "include/tileEffects";
-
-
-program spell_reflect( parms )
-	var caster := parms.caster;
-
-	if (!(GetObjProperty(caster, "mr") == "1") )
-		PlaySoundEffect(caster, 0x1ea);
-		PlayObjectCenteredEffect(caster, FX_SPARK_EFFECT, 10,10);
-		SetObjProperty(caster, "mr","1");
-	else
-		PlaySoundEffect(caster,0x005d);
-		PlayObjectCenteredEffect(caster, 0x3735,0x0a, 0x1e);
-		SendSysMessage(caster,"You are already protected.");
-	endif
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/reflect.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/reflect.src)

Deleted: trunk/096/pkg/skills/magery/OLD/resurrect.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/resurrect.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/resurrect.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,63 +0,0 @@
-use os;
-use uo;
-
-include "include/eventID";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include "include/client";
-include "include/resurrection";
-include "include/magic";
-
-
-program spell_resurrect(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var npccfg := ReadConfigFile("::npcdesc");
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-  if(Distance(caster, castOn) > 1)
-	SendSysMessage(caster,"That is too far away!");
-	return;
-  endif
-  PlaySoundEffect(caster, SFX_SPELL_RESSURECTION);
-  PlaySoundEffect(castOn, SFX_SPELL_RESSURECTION);
-  if(castOn.isA(POLCLASS_NPC))
-    var element := npccfg[castOn.npctemplate].elemental;
-    if(element == "undead")
-      PlayStationaryEffect( castOn.x, castOn.y, castOn.z, FX_HEAL_EFFECT, 0xa, 0xa,0, caster.realm );
-      var ev := array;
-      ev.+ type;
-      ev.+ source;
-      ev.type := EVID_PEACEMADE;
-      SendEvent(castOn, ev);
-      ev.source := caster;
-      SendEvent(castOn, ev);
-      ev.type := EVID_ENGAGED;
-      SendEvent(castOn, ev);
-      PlayObjectCenteredEffect(castOn, 0x37b9,0x03, 0x0a);
-      if( SkillCheck(castOn, RESISTING_SPELLS, 70) > 0 )
-        var dmg := CalcSpellDamage(circle,caster) + (RandomInt(20));
-        ApplyRawDamage(castOn, dmg);
-      else
-        ApplyRawDamage(castOn, AP_GetVital(castOn, HITS) +1);
-      endif
-    endif
-  else
-    if (!castOn.dead)
-	  SendSysMessage(caster,"That isn't dead!");
-	  return;
-    endif
-    if(castOn.criminal)
-      caster.setCriminal(1);
-    endif
-    detach();
-    if(ResNow(castOn)==1)
-      Resurrect(castOn);
-      MurdererStatLoss(caston);
-    endif
-  endif
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/resurrect.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/resurrect.src)

Deleted: trunk/096/pkg/skills/magery/OLD/reveal.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/reveal.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/reveal.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,43 +0,0 @@
-use uo;
-
-include ":attributes:attributes";
-include "include/magic";
-include "include/sound";
-include "include/tileEffects";
-
-
-program reveal(parms)
-  var caster := parms.caster;
-  var range := ( AP_GetSkill( caster, MAGERY  )/10 ) - 5;
-  if (range < 1)
-	range := 1;
-  endif
-  var hiders := ListMobilesNearLocationEx( caster.x, caster.y, caster.z, range, LISTEX_FLAG_HIDDEN, caster.realm );
-  var numfound := 0;
-  PlaySoundEffect(caster, SFX_1FE);
-  if(len(hiders) > 0)
-	foreach mobile in hiders
-	  if( Found( caster,  mobile) )
-		numfound := 1;
-		mobile.hidden := 0;
-		PrintTextAbovePrivate( mobile, "You have been revealed!", mobile );
-		PrintTextAbovePrivate( mobile, "You have found someone!", caster );
-		PlaySoundEffect(mobile, SFX_1FE);
-	  endif
-	endforeach
-  endif
-  if (!numfound)
-    PrintTextAbovePrivate( caster, "You didn't find any anyone.", caster );
-  endif
-endprogram
-
-
-function Found(finder, hider)
-  var magic_skill := Resisted(6, finder, hider, AP_GetSkill( finder, MAGERY ));
-  var resist := (AP_GetSkill( finder,RESISTING_SPELLS)/1.5);
-  if ( magic_skill > resist )
-	return 1;
-  else
-	return 0;
-  endif
-endfunction
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/reveal.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/reveal.src)

Deleted: trunk/096/pkg/skills/magery/OLD/spells.cfg
===================================================================
--- trunk/096/pkg/skills/magery/OLD/spells.cfg	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/spells.cfg	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,1005 +0,0 @@
-# $Id: spells.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
-#
-#
-##############
-#
-# SpellID : same as the config key val- the ID of the spell
-# Name : the spells's name
-# SpellScript : the spell's SpellScript
-# Circle : the circle of the spell
-# Delivery : the mode of delivering the spell.
-#   direct : target something
-#   indirect : target an area
-#   notarget : no target necessary
-# Noto : casting a harmful spell on a blue will flag you criminal;
-#   casting a beneficial spell on a red will do the same.
-# PowerWords : the words of power for the spell
-# Animation : define a different spellcasting animation
-# animReps : caster will perform the spellcasting animation this many times,
-#   with 750ms passing in between. Overrides the default value in circles.cfg
-# extraWait : after finishing the animations, wait this many ms before spell
-#   actually goes off.  Overrides the default value in circles.cfg
-# Reagent : what regs the spell requires.
-#
-################
-
-###
-# Madman's note:
-#  All spellcasting timing notes come from the LBR/AOS hint book for UO.
-#  The old versions of these values in this file included summoning spells
-#  taking a heck of a lot longer to cast than ordinary spells.
-#  Fortunately, you can tweak these on a by-spell basis, so feel free.
-#
-
-# First circle spells take 500ms to cast.
-
-Spell 1
-{
-    SpellId     1
-    Name        Clumsy
-    SpellScript      :magery:clumsy
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Uus Jux
-    Reagent     bloodmoss
-    Reagent     nightshade
-
-}
-
-Spell 2
-{
-    SpellId     2
-    Name        Create Food
-    SpellScript      :magery:createFood
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	notarget
-    Noto	helpful
-    PowerWords  In Mani Ylem
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     MandrakeRoot
-}
-
-Spell 3
-{
-    SpellId     3
-    Name        Feeblemind
-    SpellScript      :magery:feeblemind
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Rel Wis
-    Reagent     nightshade
-    Reagent     ginseng
-}
-
-Spell 4
-{
-    SpellId     4
-    Name        Heal
-    SpellScript      :magery:heal
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	helpful
-    PowerWords  In Mani
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     spidersilk
-}
-
-Spell  5
-{
-    SpellId     5
-    Name        Magic Arrow
-    SpellScript      :magery:magicArrow
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	harmful
-    PowerWords  In Por Ylem
-    Reagent     blackpearl
-    Reagent     nightshade
-}
-
-Spell 6
-{
-    SpellId     6
-    Name        Night Sight
-    SpellScript      :magery:nightSight
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	helpful
-    PowerWords  In Lor
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 7
-{
-    SpellId     7
-    Name        Reactive Armor
-    SpellScript      :magery:reactiveArmor
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	helpful
-    PowerWords  Flam Sanct
-    Reagent     garlic
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 8
-{
-    SpellId     8
-    Name        Weaken
-    SpellScript      :magery:weaken
-    Script	:spellcasting:spellcast
-    Circle      1
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Des Mani
-    Reagent     garlic
-    Reagent     nightshade
-}
-
-# Second circle spells take 750ms to cast.
-
-Spell 9
-{
-    SpellId     9
-    Name        Agility
-    SpellScript      :magery:agility
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	helpful
-    PowerWords  Ex Uus
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-}
-
-Spell 10
-{
-    SpellId     10
-    Name        Cunning
-    SpellScript      :magery:cunning
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	helpful
-    PowerWords  Uus Wis
-    Reagent     Nightshade
-    Reagent     mandrakeroot
-}
-
-Spell 11
-{
-    SpellId     11
-    Name        Cure
-    SpellScript      :magery:cure
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	helpful
-    PowerWords  An Nox
-    Reagent     garlic
-    Reagent     ginseng
-}
-
-Spell 12
-{
-    SpellId     12
-    Name        Harm
-    SpellScript      :magery:harm
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	harmful
-    PowerWords  An Mani
-    Reagent     nightshade
-    Reagent     spidersilk
-}
-
-Spell 13
-{
-    SpellId     13
-    Name        Magic Trap
-    SpellScript      :magery:magicTrap
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	harmful
-    PowerWords  In Jux
-    Reagent     garlic
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 14
-{
-    SpellId     14
-    Name        Magic Untrap
-    SpellScript      :magery:magicUntrap
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	harmful
-    PowerWords  An Jux
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     SulphurousAsh
-}
-
-Spell 15
-{
-    SpellId     15
-    Name        Protection
-    SpellScript      :magery:protection
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	helpful
-    PowerWords  Uus Sanct
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     SulphurousAsh
-}
-
-Spell 16
-{
-    SpellId     16
-    Name        Strength
-    SpellScript      :magery:strength
-    Script	:spellcasting:spellcast
-    Circle      2
-    Delivery	direct
-    Noto	helpful
-    PowerWords  Uus Mani
-    Reagent     mandrakeroot
-    Reagent     nightshade
-}
-
-# Third circle spells take 1s to cast.
-
-Spell 17
-{
-    SpellId     17
-    Name        Bless
-    SpellScript      :magery:bless
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	direct
-    Noto	helpful
-    PowerWords  Rel Sanct
-    Reagent     garlic
-    Reagent     mandrakeroot
-}
-
-Spell 18
-{
-    SpellId     18
-    Name        Fireball
-    SpellScript      :magery:fireball
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Vas Flam
-    Reagent     blackpearl
-    Reagent     sulphurousash
-}
-
-Spell 19
-{
-    SpellId     19
-    Name        Magic Lock
-    SpellScript      :magery:magicLock
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	direct
-    Noto	neutral
-    PowerWords  An Por
-    Reagent     bloodmoss
-    Reagent     garlic
-    Reagent     SulphurousAsh
-}
-
-Spell 20
-{
-    SpellId     20
-    Name        Poison
-    SpellScript      :magery:poison
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	direct
-    Noto	harmful
-    PowerWords  In Nox
-    Reagent     nightshade
-}
-
-Spell 21
-{
-    SpellId     21
-    Name        Telekinesis
-    SpellScript      :magery:telekinesis
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery 	direct
-    Noto	harmful
-    PowerWords  Ort Por Ylem
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-}
-
-Spell 22
-{
-    SpellId     22
-    Name        Teleport
-    SpellScript      :magery:teleport
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	indirect
-    Noto	neutral
-    PowerWords  Rel Por
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-}
-
-Spell 23
-{
-    SpellId     23
-    Name        Unlock
-    SpellScript      :magery:unlock
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	direct
-    Noto	neutral
-    PowerWords  Ex Por
-    Reagent     bloodmoss
-    Reagent     garlic
-}
-
-Spell 24
-{
-    SpellId     24
-    Name        Wall of Stone
-    SpellScript      :magery:wallOfStone
-    Script	:spellcasting:spellcast
-    Circle      3
-    Delivery	indirect
-    Noto	neutral
-    PowerWords  In Sanct Ylem
-    Reagent     bloodmoss
-    Reagent     garlic
-}
-
-# Fourth circle spells take 1250ms to cast
-
-Spell 25
-{
-    SpellId     25
-    Name        Arch Cure
-    SpellScript      :magery:archCure
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	indirect
-    Noto	helpful
-    PowerWords  Vas An Nox
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     MandrakeRoot
-}
-
-Spell 26
-{
-    SpellId     26
-    Name        Arch Protection
-    SpellScript      :magery:archProt
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	indirect
-    Noto	helpful
-    PowerWords  Vas Uus Sanct
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     mandrakeroot
-    Reagent     SulphurousAsh
-}
-
-Spell 27
-{
-    SpellId     27
-    Name        Curse
-    SpellScript      :magery:curse
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Des Sanct
-    Reagent     garlic
-    Reagent     nightshade
-    Reagent     SulphurousAsh
-}
-
-Spell 28
-{
-    SpellId     28
-    Name        Fire Field
-    SpellScript      :magery:fireField
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  In Flam Grav
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-    Reagent     blackpearl
-}
-
-Spell 29
-{
-    SpellId     29
-    Name        Greater Heal
-    SpellScript      :magery:gHeal
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	direct
-    Noto	helpful
-    PowerWords  In Vas Mani
-    Reagent     garlic
-    Reagent     ginseng
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 30
-{
-    SpellId     30
-    Name        Lightning
-    SpellScript      :magery:lightning
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Por Ort Grav
-    Reagent     blackpearl
-    Reagent     sulphurousash
-    Reagent 	MandrakeRoot
-}
-
-Spell 31
-{
-    SpellId     31
-    Name        Mana Drain
-    SpellScript      :magery:manaDrain
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Ort Rel
-    Reagent     blackpearl
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 32
-{
-    SpellId     32
-    Name        Recall
-    SpellScript      :magery:recall
-    Script	:spellcasting:spellcast
-    Circle      4
-    Delivery	notarget
-    Noto	neutral
-    PowerWords  Kal Ort Por
-    Reagent     blackpearl
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-}
-
-# Fifth circle spells take 1500ms to cast
-
-Spell 33
-{
-    SpellId     33
-    Name        Blade Spirit
-    SpellScript      :magery:bladeSpirit
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  In Jux Hur Ylem
-    Reagent     blackpearl
-    Reagent     mandrakeroot
-    Reagent     nightshade
-}
-
-Spell 34
-{
-    SpellId     34
-    Name        Dispel Field
-    SpellScript      :magery:dispelField
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	direct
-    Noto	neutral
-    PowerWords  An Grav
-    Reagent     blackpearl
-    Reagent     garlic
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 35
-{
-    SpellId     35
-    Name        Incognito
-    SpellScript      :magery:incognito
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	notarget
-    Noto	neutral
-    PowerWords  Kal In Ex
-    Reagent     bloodmoss
-    Reagent     garlic
-    Reagent     nightshade
-}
-
-Spell 36
-{
-    SpellId     36
-    Name        Magic Reflection
-    SpellScript      :magery:reflect
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	notarget
-    Noto	helpful
-    PowerWords  In Jux Sanct
-    Reagent     garlic
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 37
-{
-    SpellId     37
-    Name        Mind Blast
-    SpellScript      :magery:mindBlast
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Por Corp Wis
-    Reagent     blackpearl
-    Reagent     mandrakeroot
-    Reagent     nightshade
-    Reagent     SulphurousAsh
-}
-
-Spell 38
-{
-    SpellId     38
-    Name        Paralyze
-    SpellScript      :magery:paralyze
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	direct
-    Noto	harmful
-    PowerWords  An Ex Por
-    Reagent     garlic
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 39
-{
-    SpellId     39
-    Name        Poison Field
-    SpellScript      :magery:poisonField
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  In Nox Grav
-    Reagent     blackpearl
-    Reagent     nightshade
-    Reagent     spidersilk
-}
-
-Spell 40
-{
-    SpellId     40
-    Name        SummonCreature
-    SpellScript      :magery:summonCreature
-    Script	:spellcasting:spellcast
-    Circle      5
-    Delivery	indirect
-    Noto	neutral
-    PowerWords  Kal Xen
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-# Sixth circle spells take 1750ms to cast
-
-Spell 41
-{
-    SpellId     41
-    Name        Dispel
-    SpellScript      :magery:dispel
-    Script	:spellcasting:spellcast
-    Circle      6
-    PowerWords  An Ort
-    Reagent     garlic
-    Reagent     mandrakeroot
-    Reagent     SulphurousAsh
-}
-
-Spell 42
-{
-    SpellId     42
-    Name        Energy Bolt
-    SpellScript      :magery:eBolt
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Corp Por
-    Reagent     blackpearl
-    Reagent     nightshade
-}
-
-Spell 43
-{
-    SpellId     43
-    Name        Explosion
-    SpellScript      :magery:explosion
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Vas Ort Flam
-    Reagent     blackpearl
-    Reagent     mandrakeroot
-    Reagent     SulphurousAsh
-}
-
-Spell 44
-{
-    SpellId     44
-    Name        Invisibility
-    SpellScript      :magery:invisibility
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	direct
-    Noto	helpful
-    PowerWords  An Lor Xen
-    Reagent     bloodmoss
-    Reagent     nightshade
-}
-
-Spell 45
-{
-    SpellId     45
-    Name        Mark
-    SpellScript      :magery:mark
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	notarget
-    Noto	neutral
-    PowerWords  Kal Por Ylem
-    Reagent     blackpearl
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-}
-
-Spell 46
-{
-    SpellId     46
-    Name        Mass Curse
-    SpellScript      :magery:massCurse
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  Vas Des Sanct
-    Reagent     garlic
-    Reagent     mandrakeroot
-    Reagent     nightshade
-    Reagent     SulphurousAsh
-}
-
-Spell 47
-{
-    SpellId     47
-    Name        Paralyze Field
-    SpellScript      :magery:paraField
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  In Ex Grav
-    Reagent     blackpearl
-    Reagent     ginseng
-    Reagent     spidersilk
-}
-
-Spell 48
-{
-    SpellId     48
-    Name        Reveal
-    SpellScript      :magery:reveal
-    Script	:spellcasting:spellcast
-    Circle      6
-    Delivery	indirect
-    Noto	neutral
-    PowerWords  Wis  Quas
-    Reagent     bloodmoss
-    Reagent     SulphurousAsh
-}
-
-# Seventh circle spells take 2s to cast
-
-Spell 49
-{
-    SpellId     49
-    Name        Chain Lightning
-    SpellScript      :magery:chainLightning
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  Vas Ort Grav
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     blackpearl
-    Reagent     SulphurousAsh
-}
-
-Spell 50
-{
-    SpellId     50
-    Name        Energy Field
-    SpellScript      :magery:energyField
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	indirect
-    Noto	neutral
-    PowerWords  In Sanct Grav
-    Reagent     blackpearl
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 51
-{
-    SpellId     51
-    Name        FlameStrike
-    SpellScript      :magery:flameStrike
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Kal Vas Flam
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 52
-{
-    SpellId     52
-    Name        Gate
-    SpellScript      :magery:gate
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	notarget
-    Noto	neutral
-    PowerWords  Vas Rel Por
-    Reagent     blackpearl
-    Reagent     mandrakeroot
-    Reagent     SulphurousAsh
-}
-
-Spell 53
-{
-    SpellId     53
-    Name        Mana Vampire
-    SpellScript      :magery:manaVamp
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	direct
-    Noto	harmful
-    PowerWords  Ort Sanct
-    Reagent     blackpearl
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 54
-{
-    SpellId     54
-    Name        Mass Dispel
-    SpellScript      :magery:massDispel
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	indirect
-    Noto	neutral
-    PowerWords  Vas An Ort
-    Reagent     blackpearl
-    Reagent     garlic
-    Reagent     mandrakeroot
-    Reagent     SulphurousAsh
-}
-
-Spell 55
-{
-    SpellId     55
-    Name        Meteor Swarm
-    SpellScript      :magery:meteorSwarm
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	indirect
-    Noto	harmful
-    PowerWords  Kal Des Flam Ylem
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     SpiderSilk
-    Reagent     SulphurousAsh
-}
-
-Spell 56
-{
-    SpellId     56
-    Name        Polymorph
-    SpellScript      :magery:polymorph
-    Script	:spellcasting:spellcast
-    Circle      7
-    Delivery	notarget
-    Noto	helpful
-    PowerWords  Vas Ylem Rel
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-# Eighth circle spells take 2250ms to cast
-
-Spell 57
-{
-    SpellId     57
-    Name        Earthquake
-    SpellScript      :magery:earthquake
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	notarget
-    Noto	neutral
-    PowerWords  In Vas Por
-    Reagent     bloodmoss
-    Reagent     ginseng
-    Reagent     mandrakeroot
-    Reagent     SulphurousAsh
-}
-
-Spell 58
-{
-    SpellId     58
-    Name        EnergyVortex
-    SpellScript      :magery:vortex
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	indirect
-    Noto	harmful
-    Animation   0x11
-    PowerWords  Vas Corp Por
-    Reagent     blackpearl
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     nightshade
-}
-
-Spell 59
-{
-    SpellId     59
-    Name        Resurrection
-    SpellScript      :magery:resurrect
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	direct
-    Noto	neutral
-    PowerWords  An Corp
-    Reagent     bloodmoss
-    Reagent     garlic
-    Reagent     ginseng
-}
-
-Spell 60
-{
-    SpellId     60
-    Name        Summon Air Elemental
-    SpellScript      :magery:summonAir
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	indirect
-    Noto	neutral
-    Animation   0x11
-    PowerWords  Kal Vas Xen Hur
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 61
-{
-    SpellId     61
-    Name        Summon Daemon
-    SpellScript      :magery:summonDaemon
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	indirect
-    Noto	neutral
-    Animation   0x11
-    PowerWords  Kal Vas Xen Corp
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 62
-{
-    SpellId     62
-    Name        Summon Earth Elemental
-    SpellScript      :magery:summonEarth
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	indirect
-    Noto	neutral
-    Animation   0x11
-    PowerWords  Kal Vas Xen Ylem
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}
-
-Spell 63
-{
-    SpellId     63
-    Name        Summon Fire Elemental
-    SpellScript      :magery:summonFire
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	indirect
-    Noto	neutral
-    Animation   0x11
-    PowerWords  Kal Vas Xen Flam
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-    Reagent     SulphurousAsh
-}
-
-Spell 64
-{
-    SpellId     64
-    Name        Summon Water Elemental
-    SpellScript      :magery:summonWater
-    Script	:spellcasting:spellcast
-    Circle      8
-    Delivery	indirect
-    Noto	neutral
-    Animation   0x11
-    PowerWords  Kal Vas Xen An Flam
-    Reagent     bloodmoss
-    Reagent     mandrakeroot
-    Reagent     spidersilk
-}

Copied: trunk/096/pkg/skills/magery/OLD/spells.cfg.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/spells.cfg)
===================================================================
--- trunk/096/pkg/skills/magery/OLD/spells.cfg	2005-11-04 06:29:43 UTC (rev 891)
+++ trunk/096/pkg/skills/magery/OLD/spells.cfg.temp	2005-11-04 07:22:07 UTC (rev 897)
@@ -0,0 +1,1005 @@
+# $Id$
+#
+#
+##############
+#
+# SpellID : same as the config key val- the ID of the spell
+# Name : the spells's name
+# SpellScript : the spell's SpellScript
+# Circle : the circle of the spell
+# Delivery : the mode of delivering the spell.
+#   direct : target something
+#   indirect : target an area
+#   notarget : no target necessary
+# Noto : casting a harmful spell on a blue will flag you criminal;
+#   casting a beneficial spell on a red will do the same.
+# PowerWords : the words of power for the spell
+# Animation : define a different spellcasting animation
+# animReps : caster will perform the spellcasting animation this many times,
+#   with 750ms passing in between. Overrides the default value in circles.cfg
+# extraWait : after finishing the animations, wait this many ms before spell
+#   actually goes off.  Overrides the default value in circles.cfg
+# Reagent : what regs the spell requires.
+#
+################
+
+###
+# Madman's note:
+#  All spellcasting timing notes come from the LBR/AOS hint book for UO.
+#  The old versions of these values in this file included summoning spells
+#  taking a heck of a lot longer to cast than ordinary spells.
+#  Fortunately, you can tweak these on a by-spell basis, so feel free.
+#
+
+# First circle spells take 500ms to cast.
+
+Spell 1
+{
+    SpellId     1
+    Name        Clumsy
+    SpellScript      :magery:clumsy
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Uus Jux
+    Reagent     bloodmoss
+    Reagent     nightshade
+
+}
+
+Spell 2
+{
+    SpellId     2
+    Name        Create Food
+    SpellScript      :magery:createFood
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	notarget
+    Noto	helpful
+    PowerWords  In Mani Ylem
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     MandrakeRoot
+}
+
+Spell 3
+{
+    SpellId     3
+    Name        Feeblemind
+    SpellScript      :magery:feeblemind
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Rel Wis
+    Reagent     nightshade
+    Reagent     ginseng
+}
+
+Spell 4
+{
+    SpellId     4
+    Name        Heal
+    SpellScript      :magery:heal
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	helpful
+    PowerWords  In Mani
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     spidersilk
+}
+
+Spell  5
+{
+    SpellId     5
+    Name        Magic Arrow
+    SpellScript      :magery:magicArrow
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	harmful
+    PowerWords  In Por Ylem
+    Reagent     blackpearl
+    Reagent     nightshade
+}
+
+Spell 6
+{
+    SpellId     6
+    Name        Night Sight
+    SpellScript      :magery:nightSight
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	helpful
+    PowerWords  In Lor
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 7
+{
+    SpellId     7
+    Name        Reactive Armor
+    SpellScript      :magery:reactiveArmor
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	helpful
+    PowerWords  Flam Sanct
+    Reagent     garlic
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 8
+{
+    SpellId     8
+    Name        Weaken
+    SpellScript      :magery:weaken
+    Script	:spellcasting:spellcast
+    Circle      1
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Des Mani
+    Reagent     garlic
+    Reagent     nightshade
+}
+
+# Second circle spells take 750ms to cast.
+
+Spell 9
+{
+    SpellId     9
+    Name        Agility
+    SpellScript      :magery:agility
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	helpful
+    PowerWords  Ex Uus
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+}
+
+Spell 10
+{
+    SpellId     10
+    Name        Cunning
+    SpellScript      :magery:cunning
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	helpful
+    PowerWords  Uus Wis
+    Reagent     Nightshade
+    Reagent     mandrakeroot
+}
+
+Spell 11
+{
+    SpellId     11
+    Name        Cure
+    SpellScript      :magery:cure
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	helpful
+    PowerWords  An Nox
+    Reagent     garlic
+    Reagent     ginseng
+}
+
+Spell 12
+{
+    SpellId     12
+    Name        Harm
+    SpellScript      :magery:harm
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	harmful
+    PowerWords  An Mani
+    Reagent     nightshade
+    Reagent     spidersilk
+}
+
+Spell 13
+{
+    SpellId     13
+    Name        Magic Trap
+    SpellScript      :magery:magicTrap
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	harmful
+    PowerWords  In Jux
+    Reagent     garlic
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 14
+{
+    SpellId     14
+    Name        Magic Untrap
+    SpellScript      :magery:magicUntrap
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	harmful
+    PowerWords  An Jux
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     SulphurousAsh
+}
+
+Spell 15
+{
+    SpellId     15
+    Name        Protection
+    SpellScript      :magery:protection
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	helpful
+    PowerWords  Uus Sanct
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     SulphurousAsh
+}
+
+Spell 16
+{
+    SpellId     16
+    Name        Strength
+    SpellScript      :magery:strength
+    Script	:spellcasting:spellcast
+    Circle      2
+    Delivery	direct
+    Noto	helpful
+    PowerWords  Uus Mani
+    Reagent     mandrakeroot
+    Reagent     nightshade
+}
+
+# Third circle spells take 1s to cast.
+
+Spell 17
+{
+    SpellId     17
+    Name        Bless
+    SpellScript      :magery:bless
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	direct
+    Noto	helpful
+    PowerWords  Rel Sanct
+    Reagent     garlic
+    Reagent     mandrakeroot
+}
+
+Spell 18
+{
+    SpellId     18
+    Name        Fireball
+    SpellScript      :magery:fireball
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Vas Flam
+    Reagent     blackpearl
+    Reagent     sulphurousash
+}
+
+Spell 19
+{
+    SpellId     19
+    Name        Magic Lock
+    SpellScript      :magery:magicLock
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	direct
+    Noto	neutral
+    PowerWords  An Por
+    Reagent     bloodmoss
+    Reagent     garlic
+    Reagent     SulphurousAsh
+}
+
+Spell 20
+{
+    SpellId     20
+    Name        Poison
+    SpellScript      :magery:poison
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	direct
+    Noto	harmful
+    PowerWords  In Nox
+    Reagent     nightshade
+}
+
+Spell 21
+{
+    SpellId     21
+    Name        Telekinesis
+    SpellScript      :magery:telekinesis
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery 	direct
+    Noto	harmful
+    PowerWords  Ort Por Ylem
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+}
+
+Spell 22
+{
+    SpellId     22
+    Name        Teleport
+    SpellScript      :magery:teleport
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	indirect
+    Noto	neutral
+    PowerWords  Rel Por
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+}
+
+Spell 23
+{
+    SpellId     23
+    Name        Unlock
+    SpellScript      :magery:unlock
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	direct
+    Noto	neutral
+    PowerWords  Ex Por
+    Reagent     bloodmoss
+    Reagent     garlic
+}
+
+Spell 24
+{
+    SpellId     24
+    Name        Wall of Stone
+    SpellScript      :magery:wallOfStone
+    Script	:spellcasting:spellcast
+    Circle      3
+    Delivery	indirect
+    Noto	neutral
+    PowerWords  In Sanct Ylem
+    Reagent     bloodmoss
+    Reagent     garlic
+}
+
+# Fourth circle spells take 1250ms to cast
+
+Spell 25
+{
+    SpellId     25
+    Name        Arch Cure
+    SpellScript      :magery:archCure
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	indirect
+    Noto	helpful
+    PowerWords  Vas An Nox
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     MandrakeRoot
+}
+
+Spell 26
+{
+    SpellId     26
+    Name        Arch Protection
+    SpellScript      :magery:archProt
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	indirect
+    Noto	helpful
+    PowerWords  Vas Uus Sanct
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     mandrakeroot
+    Reagent     SulphurousAsh
+}
+
+Spell 27
+{
+    SpellId     27
+    Name        Curse
+    SpellScript      :magery:curse
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Des Sanct
+    Reagent     garlic
+    Reagent     nightshade
+    Reagent     SulphurousAsh
+}
+
+Spell 28
+{
+    SpellId     28
+    Name        Fire Field
+    SpellScript      :magery:fireField
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  In Flam Grav
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+    Reagent     blackpearl
+}
+
+Spell 29
+{
+    SpellId     29
+    Name        Greater Heal
+    SpellScript      :magery:gHeal
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	direct
+    Noto	helpful
+    PowerWords  In Vas Mani
+    Reagent     garlic
+    Reagent     ginseng
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 30
+{
+    SpellId     30
+    Name        Lightning
+    SpellScript      :magery:lightning
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Por Ort Grav
+    Reagent     blackpearl
+    Reagent     sulphurousash
+    Reagent 	MandrakeRoot
+}
+
+Spell 31
+{
+    SpellId     31
+    Name        Mana Drain
+    SpellScript      :magery:manaDrain
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Ort Rel
+    Reagent     blackpearl
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 32
+{
+    SpellId     32
+    Name        Recall
+    SpellScript      :magery:recall
+    Script	:spellcasting:spellcast
+    Circle      4
+    Delivery	notarget
+    Noto	neutral
+    PowerWords  Kal Ort Por
+    Reagent     blackpearl
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+}
+
+# Fifth circle spells take 1500ms to cast
+
+Spell 33
+{
+    SpellId     33
+    Name        Blade Spirit
+    SpellScript      :magery:bladeSpirit
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  In Jux Hur Ylem
+    Reagent     blackpearl
+    Reagent     mandrakeroot
+    Reagent     nightshade
+}
+
+Spell 34
+{
+    SpellId     34
+    Name        Dispel Field
+    SpellScript      :magery:dispelField
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	direct
+    Noto	neutral
+    PowerWords  An Grav
+    Reagent     blackpearl
+    Reagent     garlic
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 35
+{
+    SpellId     35
+    Name        Incognito
+    SpellScript      :magery:incognito
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	notarget
+    Noto	neutral
+    PowerWords  Kal In Ex
+    Reagent     bloodmoss
+    Reagent     garlic
+    Reagent     nightshade
+}
+
+Spell 36
+{
+    SpellId     36
+    Name        Magic Reflection
+    SpellScript      :magery:reflect
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	notarget
+    Noto	helpful
+    PowerWords  In Jux Sanct
+    Reagent     garlic
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 37
+{
+    SpellId     37
+    Name        Mind Blast
+    SpellScript      :magery:mindBlast
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Por Corp Wis
+    Reagent     blackpearl
+    Reagent     mandrakeroot
+    Reagent     nightshade
+    Reagent     SulphurousAsh
+}
+
+Spell 38
+{
+    SpellId     38
+    Name        Paralyze
+    SpellScript      :magery:paralyze
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	direct
+    Noto	harmful
+    PowerWords  An Ex Por
+    Reagent     garlic
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 39
+{
+    SpellId     39
+    Name        Poison Field
+    SpellScript      :magery:poisonField
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  In Nox Grav
+    Reagent     blackpearl
+    Reagent     nightshade
+    Reagent     spidersilk
+}
+
+Spell 40
+{
+    SpellId     40
+    Name        SummonCreature
+    SpellScript      :magery:summonCreature
+    Script	:spellcasting:spellcast
+    Circle      5
+    Delivery	indirect
+    Noto	neutral
+    PowerWords  Kal Xen
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+# Sixth circle spells take 1750ms to cast
+
+Spell 41
+{
+    SpellId     41
+    Name        Dispel
+    SpellScript      :magery:dispel
+    Script	:spellcasting:spellcast
+    Circle      6
+    PowerWords  An Ort
+    Reagent     garlic
+    Reagent     mandrakeroot
+    Reagent     SulphurousAsh
+}
+
+Spell 42
+{
+    SpellId     42
+    Name        Energy Bolt
+    SpellScript      :magery:eBolt
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Corp Por
+    Reagent     blackpearl
+    Reagent     nightshade
+}
+
+Spell 43
+{
+    SpellId     43
+    Name        Explosion
+    SpellScript      :magery:explosion
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Vas Ort Flam
+    Reagent     blackpearl
+    Reagent     mandrakeroot
+    Reagent     SulphurousAsh
+}
+
+Spell 44
+{
+    SpellId     44
+    Name        Invisibility
+    SpellScript      :magery:invisibility
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	direct
+    Noto	helpful
+    PowerWords  An Lor Xen
+    Reagent     bloodmoss
+    Reagent     nightshade
+}
+
+Spell 45
+{
+    SpellId     45
+    Name        Mark
+    SpellScript      :magery:mark
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	notarget
+    Noto	neutral
+    PowerWords  Kal Por Ylem
+    Reagent     blackpearl
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+}
+
+Spell 46
+{
+    SpellId     46
+    Name        Mass Curse
+    SpellScript      :magery:massCurse
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  Vas Des Sanct
+    Reagent     garlic
+    Reagent     mandrakeroot
+    Reagent     nightshade
+    Reagent     SulphurousAsh
+}
+
+Spell 47
+{
+    SpellId     47
+    Name        Paralyze Field
+    SpellScript      :magery:paraField
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  In Ex Grav
+    Reagent     blackpearl
+    Reagent     ginseng
+    Reagent     spidersilk
+}
+
+Spell 48
+{
+    SpellId     48
+    Name        Reveal
+    SpellScript      :magery:reveal
+    Script	:spellcasting:spellcast
+    Circle      6
+    Delivery	indirect
+    Noto	neutral
+    PowerWords  Wis  Quas
+    Reagent     bloodmoss
+    Reagent     SulphurousAsh
+}
+
+# Seventh circle spells take 2s to cast
+
+Spell 49
+{
+    SpellId     49
+    Name        Chain Lightning
+    SpellScript      :magery:chainLightning
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  Vas Ort Grav
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     blackpearl
+    Reagent     SulphurousAsh
+}
+
+Spell 50
+{
+    SpellId     50
+    Name        Energy Field
+    SpellScript      :magery:energyField
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	indirect
+    Noto	neutral
+    PowerWords  In Sanct Grav
+    Reagent     blackpearl
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 51
+{
+    SpellId     51
+    Name        FlameStrike
+    SpellScript      :magery:flameStrike
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Kal Vas Flam
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 52
+{
+    SpellId     52
+    Name        Gate
+    SpellScript      :magery:gate
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	notarget
+    Noto	neutral
+    PowerWords  Vas Rel Por
+    Reagent     blackpearl
+    Reagent     mandrakeroot
+    Reagent     SulphurousAsh
+}
+
+Spell 53
+{
+    SpellId     53
+    Name        Mana Vampire
+    SpellScript      :magery:manaVamp
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	direct
+    Noto	harmful
+    PowerWords  Ort Sanct
+    Reagent     blackpearl
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 54
+{
+    SpellId     54
+    Name        Mass Dispel
+    SpellScript      :magery:massDispel
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	indirect
+    Noto	neutral
+    PowerWords  Vas An Ort
+    Reagent     blackpearl
+    Reagent     garlic
+    Reagent     mandrakeroot
+    Reagent     SulphurousAsh
+}
+
+Spell 55
+{
+    SpellId     55
+    Name        Meteor Swarm
+    SpellScript      :magery:meteorSwarm
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	indirect
+    Noto	harmful
+    PowerWords  Kal Des Flam Ylem
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     SpiderSilk
+    Reagent     SulphurousAsh
+}
+
+Spell 56
+{
+    SpellId     56
+    Name        Polymorph
+    SpellScript      :magery:polymorph
+    Script	:spellcasting:spellcast
+    Circle      7
+    Delivery	notarget
+    Noto	helpful
+    PowerWords  Vas Ylem Rel
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+# Eighth circle spells take 2250ms to cast
+
+Spell 57
+{
+    SpellId     57
+    Name        Earthquake
+    SpellScript      :magery:earthquake
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	notarget
+    Noto	neutral
+    PowerWords  In Vas Por
+    Reagent     bloodmoss
+    Reagent     ginseng
+    Reagent     mandrakeroot
+    Reagent     SulphurousAsh
+}
+
+Spell 58
+{
+    SpellId     58
+    Name        EnergyVortex
+    SpellScript      :magery:vortex
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	indirect
+    Noto	harmful
+    Animation   0x11
+    PowerWords  Vas Corp Por
+    Reagent     blackpearl
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     nightshade
+}
+
+Spell 59
+{
+    SpellId     59
+    Name        Resurrection
+    SpellScript      :magery:resurrect
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	direct
+    Noto	neutral
+    PowerWords  An Corp
+    Reagent     bloodmoss
+    Reagent     garlic
+    Reagent     ginseng
+}
+
+Spell 60
+{
+    SpellId     60
+    Name        Summon Air Elemental
+    SpellScript      :magery:summonAir
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	indirect
+    Noto	neutral
+    Animation   0x11
+    PowerWords  Kal Vas Xen Hur
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 61
+{
+    SpellId     61
+    Name        Summon Daemon
+    SpellScript      :magery:summonDaemon
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	indirect
+    Noto	neutral
+    Animation   0x11
+    PowerWords  Kal Vas Xen Corp
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 62
+{
+    SpellId     62
+    Name        Summon Earth Elemental
+    SpellScript      :magery:summonEarth
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	indirect
+    Noto	neutral
+    Animation   0x11
+    PowerWords  Kal Vas Xen Ylem
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}
+
+Spell 63
+{
+    SpellId     63
+    Name        Summon Fire Elemental
+    SpellScript      :magery:summonFire
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	indirect
+    Noto	neutral
+    Animation   0x11
+    PowerWords  Kal Vas Xen Flam
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+    Reagent     SulphurousAsh
+}
+
+Spell 64
+{
+    SpellId     64
+    Name        Summon Water Elemental
+    SpellScript      :magery:summonWater
+    Script	:spellcasting:spellcast
+    Circle      8
+    Delivery	indirect
+    Noto	neutral
+    Animation   0x11
+    PowerWords  Kal Vas Xen An Flam
+    Reagent     bloodmoss
+    Reagent     mandrakeroot
+    Reagent     spidersilk
+}

Deleted: trunk/096/pkg/skills/magery/OLD/strength.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/strength.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/strength.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,26 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/statMod";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-
-
-program spell_strength(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-	PlaySoundEffect(castOn, SFX_SPELL_STRENGTH);
-	PlayObjectCenteredEffect( castOn, FX_BLESS_EFFECT, 7,7);
-	if (!CanMod(castOn, "str"))
-		SendSysMessage(caster,"Already under the influence!");
-		return;
-	endif
-	var magery := AP_GetSkill(caster, MAGERY);
-	var mod_amount := GetModAmount( magery );
-	var duration := GetModDuration( magery );
-	DoTempMod(castOn, "str", mod_amount, duration);
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/strength.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/strength.src)

Deleted: trunk/096/pkg/skills/magery/OLD/summon.inc
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summon.inc	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/summon.inc	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,41 +0,0 @@
-use uo;
-use os;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-
-
-function DoSummon( caster, circle, npctemplate, cast_loc )
-  var thecritter;
-  var magery := AP_GetSkill(caster, MAGERY);
-  var duration := 20 + (magery * 2);
-  var parms := {};
-  parms .+ script := "tamed";
-  Detach();
-  sleepms(100);
-  thecritter := CreateNpcFromTemplate(npctemplate, cast_loc.x, cast_loc.y,cast_loc.z, parms, caster.realm);
-  if(npctemplate == "summoneddaemon")
-    PlaySoundEffect(caster, 535);
-  else
-    if(circle == 8)
-      PlaySoundEffect(caster, 536);
-      PerformAction(thecritter, 12);
-    else
-      PlaySoundEffect(caster, 534);
-    endif
-  endif
-  SetObjProperty(thecritter,"master", caster.serial);
-  SetScriptController( thecritter);
-  SetObjProperty(thecritter, "happiness",100);
-  SetObjProperty(thecritter, "summoned",1);
-  RestartScript(thecritter);
-  //SetBaseSkillBaseValue( thecritter, SKILLID_MAGICRESISTANCE,  magery * 10  );
-  AP_SetTrueSkill(thecritter, RESISTING_SPELLS, magery*10);
-  sleep(duration);
-  PlaySoundEffect( thecritter, SFX_SPELL_MANA_VAMPIRE );
-  PlayStationaryEffect( thecritter.x, thecritter.y, thecritter.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
-  MoveCharacterToLocation(thecritter,0,0,0,MOVECHAR_FORCELOCATION);
-  ApplyRawDamage(thecritter, AP_GetVital(thecritter, HITS) + 3);
-endfunction

Copied: trunk/096/pkg/skills/magery/OLD/summon.inc.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/summon.inc)

Deleted: trunk/096/pkg/skills/magery/OLD/summonAir.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summonAir.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/summonAir.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,10 +0,0 @@
-include "summon";
-
-program spell_summonAirElemental(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	DoSummon(caster, 8, "airelemental", castOn);
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/summonAir.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/summonAir.src)

Deleted: trunk/096/pkg/skills/magery/OLD/summonCreature.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summonCreature.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/summonCreature.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,55 +0,0 @@
-use util;
-
-include "summon";
-include ":attributes:attributes";
-
-
-program spell_summonCreature( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-  
-  var thecreature;
-  var critgroup;
-  var basemagery := CInt(AP_GetSkill(caster, MAGERY));
-  if (basemagery < 70)
-	critgroup := RandomInt(1);
-  elseif (basemagery < 80)
-	critgroup := RandomInt(1)+1;
-  elseif (basemagery < 90)
-	critgroup := RandomInt(1)+2;
-  else
-	critgroup := 3;
-  endif
-  var critter := RandomInt(19);
-	  case (critter)
-		0: thecreature := "chicken";
-		1: thecreature := "cat";
-		2: thecreature := "slime";
-		3: thecreature := "sheep";
-		4: thecreature := "pig";
-		5: thecreature := "dog";
-		6: thecreature := "grat";
-		7: thecreature := "eagle";
-		8: case(RandomInt(4))
-		     0: thecreature := "horse";
-		     1: thecreature := "horse2";
-		     2: thecreature := "horse3";
-		     3: thecreature := "horse4";
-		   endcase
-	    9: thecreature := "gorilla";
-	   10: thecreature := "panther";
-	   11: thecreature := "deer";
-	   12: thecreature := "bear";
-	   13: thecreature := "ghart";
-	   14: thecreature := "blackbear";
-	   15: thecreature := "alligator";
-	   16: thecreature := "giantspider";
-	   17: thecreature := "giant_serpent";
-	   18: thecreature := "polar";
-  endcase
- 
-  DoSummon( caster, circle, thecreature, castOn );
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/summonCreature.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/summonCreature.src)

Deleted: trunk/096/pkg/skills/magery/OLD/summonDaemon.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summonDaemon.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/summonDaemon.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,11 +0,0 @@
-include "summon";
-
-
-program summonDaemon( parms )
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	DoSummon( caster, 8, "summoneddaemon", castOn );
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/summonDaemon.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/summonDaemon.src)

Deleted: trunk/096/pkg/skills/magery/OLD/summonEarth.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summonEarth.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/summonEarth.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,11 +0,0 @@
-include "summon";
-
-
-program summonEarthElemental(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	DoSummon(caster, 8, "earthelemental", castOn);
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/summonEarth.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/summonEarth.src)

Deleted: trunk/096/pkg/skills/magery/OLD/summonFire.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summonFire.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/summonFire.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,11 +0,0 @@
-include "summon";
-
-
-program spell_summonFireElemental(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-
-	DoSummon(caster, 8, "fireelemental", castOn);
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/summonFire.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/summonFire.src)

Deleted: trunk/096/pkg/skills/magery/OLD/summonWater.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/summonWater.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/summonWater.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,11 +0,0 @@
-include "summon";
-
-
-program spell_summonWaterElemental(parms)
-	var caster := parms.caster;
-	var castOn := parms.castOn;
-  
-	DoSummon(caster, 8, "waterelemental", castOn);
-
-	return;
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/summonWater.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/summonWater.src)

Deleted: trunk/096/pkg/skills/magery/OLD/telekinesis.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/telekinesis.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/telekinesis.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,47 +0,0 @@
-use uo;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-include "include/magic";
-
-
-program spell_telekinesis(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-  
-  PlaySoundEffect( caster, SFX_SPELL_TELEKINESIS );
-  if( castOn.npctemplate || castOn.acctname )
-    SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "telekinesis" });
-    if(spell_reflect(castOn))
-      castOn := caster;
-    endif
-    PlaySoundEffect(castOn, 0x144);
-    PlayObjectCenteredEffect(castOn, 0x37b9,0x03, 0x0a);
-    var dmg := RandomInt(AP_GetSkill(caster, MAGERY) / 10);
-    ApplyRawDamage(castOn, Resisted(circle,caster,castOn,dmg));
-    if((castOn.graphic  == 0x190) or (castOn.graphic == 0x191))
-      PerformAction(castOn, 20);
-    endif
-  elseif(castOn.multi.serial)
-    SendSysMessage(caster, "You cannot use that on items inside houses.");
-    return;
-  elseif(castOn.container.serial)
-    SendSysMessage(caster, "You cannot use that on items inside containers.");
-    return;
-  elseif((castOn.isa(POLCLASS_CONTAINER)) and (GetObjProperty(castOn, "trap_type")))
-    var parms := array(caster, castOn);
-    start_script(":tinkering:tinkerTraps", parms);
-  else
-    if(MoveItemToContainer( castOn, caster.backpack, x := -1, y := -1 ))
-      PrintTextAbovePrivate(caster, "You pick up the item with your mind.", caster);
-    else
-      PrintTextAbovePrivate(caster, "You cannot will it to move.", caster);
-    endif
-  endif
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/telekinesis.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/telekinesis.src)

Deleted: trunk/096/pkg/skills/magery/OLD/teleport.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/teleport.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/teleport.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,35 +0,0 @@
-use uo;
-use os;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include "include/isValidLoc";
-
-
-program spell_teleport( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  if (!isValidLoc(castOn.x, castOn.y))
-    SendSysMessage(caster, "You cannot teleport there.");
-    return;
-  endif
-  var sx := caster.x, sy := caster.y, sz := caster.z; 
-  var multicheck := CreateItemAtLocation(castOn.x, castOn.y, castOn.z, 0xeed, 1, caster.realm);
-  multicheck.hidden := 1;
-  if (multicheck.multi.serial != error)
-    SendSysMessage(caster,"You cannot teleport there.");
-    DestroyItem(multicheck);
-    return;
-  else
-    if((multicheck.x > 5120) && (multicheck.x < 6133) && (multicheck.y > 2063) && (multicheck.y < 2303))
-      DestroyItem(multicheck);
-      return;
-    endif
-    DestroyItem(multicheck);
-    MoveCharacterToLocation( caster, castOn.x, castOn.y, castOn.z );
-    PlayStationaryEffect( sx, sy, sz, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
-    PlayStationaryEffect( caster.x, caster.y, caster.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
-    PlaySoundEffect( caster, SFX_SPELL_TELEPORT );
-  endif
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/teleport.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/teleport.src)

Deleted: trunk/096/pkg/skills/magery/OLD/unlock.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/unlock.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/unlock.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,84 +0,0 @@
-// $Id: unlock.src 278 2005-09-28 19:20:39Z muaddiblsd $
-
-use os;
-use uo;
-use util;
-
-include "include/sound";
-include "include/client";
-
-program spell_unlock(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  if (!castOn.locked)
-    SendSysMessage(caster,"That is not locked!");
-    return;
-  endif
-  if ((castOn.multi) || (GetObjProperty(castOn,"houseserial")) || (GetObjProperty(castOn,"house_serial")))
-    SendSysMessage(caster, "You cannot magically unlock that!");
-//    PlayLightningBoltEffect(caster);
-    return;
-  endif
-  if (GetObjProperty(castOn, "#U"))
-    if (GetObjProperty(castOn, "#U") > ReadGameClock())
-      SendSysMessage(caster, "You must wait to pick this lock!");
-      return;
-    endif
-  endif
-  var diff := CInt(GetObjProperty(castOn,"MLockPickDiff"));
-  if(diff)
-    PlaySoundEffect(caster, SFX_SPELL_UNLOCK);
-    if(diff <= 25)
-      castOn.locked := 0;
-      PrintTextAbovePrivate(castOn, "*Unlocked!*", caster);
-      EraseObjProperty(castOn, "MLockPickDiff");
-      return;
-    else
-      SendSysMessage(caster, "Your spell doesn't seem to work on that lock.");
-      return;
-    endif
-  else
-    var diffi := CInt(GetObjProperty(castOn,"LockPickDiff"));
-    if(diffi)
-      PlaySoundEffect(caster, SFX_SPELL_UNLOCK);
-      if(diffi <= 25)
-        castOn.locked := 0;
-        PrintTextAbovePrivate(castOn, "*Unlocked!*", caster);
-        return;
-      else
-        SendSysMessage(caster, "Your spell doesn't seem to work on that lock.");
-        return;
-      endif
-    else
-      if(GetObjProperty(castOn, "level"))
-        PickTreasureChest(caster, castOn);
-      else
-        SendSysMessage(castOn, "You can't seem to unlock that!");
-        return;
-      endif
-    endif
-  endif
-endprogram
-
-function PickTreasureChest(me, chest)
-  var lvl := GetObjProperty(chest,"level");
-  if(!lvl)
-    SendSysMessage(me, "You cannot pick that.");
-    return;
-  endif
-  if(!chest.locked)
-    SendSysMessage(me,"That doesn't appear to be locked.");
-    return;
-  endif
-  PlaySoundEffect(me, SFX_242);
-  sleep(1);
-  var diff := (lvl * 25) - 10;
-  if(diff <= 25)
-    PlaySoundEffect(chest,SFX_200);
-    PrintTextAbovePrivate(chest, "*Unlocked!*", me);
-    chest.locked := 0;
-  else
-    SendSysMessage(me, "Your spell doesn't seem to work on that lock.");
-    return;
-  endif
-endfunction
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/unlock.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/unlock.src)
===================================================================
--- trunk/096/pkg/skills/magery/OLD/unlock.src	2005-11-04 06:29:43 UTC (rev 891)
+++ trunk/096/pkg/skills/magery/OLD/unlock.src.temp	2005-11-04 07:22:07 UTC (rev 897)
@@ -0,0 +1,84 @@
+// $Id$
+
+use os;
+use uo;
+use util;
+
+include "include/sound";
+include "include/client";
+
+program spell_unlock(parms)
+  var caster := parms.caster;
+  var castOn := parms.castOn;
+  if (!castOn.locked)
+    SendSysMessage(caster,"That is not locked!");
+    return;
+  endif
+  if ((castOn.multi) || (GetObjProperty(castOn,"houseserial")) || (GetObjProperty(castOn,"house_serial")))
+    SendSysMessage(caster, "You cannot magically unlock that!");
+//    PlayLightningBoltEffect(caster);
+    return;
+  endif
+  if (GetObjProperty(castOn, "#U"))
+    if (GetObjProperty(castOn, "#U") > ReadGameClock())
+      SendSysMessage(caster, "You must wait to pick this lock!");
+      return;
+    endif
+  endif
+  var diff := CInt(GetObjProperty(castOn,"MLockPickDiff"));
+  if(diff)
+    PlaySoundEffect(caster, SFX_SPELL_UNLOCK);
+    if(diff <= 25)
+      castOn.locked := 0;
+      PrintTextAbovePrivate(castOn, "*Unlocked!*", caster);
+      EraseObjProperty(castOn, "MLockPickDiff");
+      return;
+    else
+      SendSysMessage(caster, "Your spell doesn't seem to work on that lock.");
+      return;
+    endif
+  else
+    var diffi := CInt(GetObjProperty(castOn,"LockPickDiff"));
+    if(diffi)
+      PlaySoundEffect(caster, SFX_SPELL_UNLOCK);
+      if(diffi <= 25)
+        castOn.locked := 0;
+        PrintTextAbovePrivate(castOn, "*Unlocked!*", caster);
+        return;
+      else
+        SendSysMessage(caster, "Your spell doesn't seem to work on that lock.");
+        return;
+      endif
+    else
+      if(GetObjProperty(castOn, "level"))
+        PickTreasureChest(caster, castOn);
+      else
+        SendSysMessage(castOn, "You can't seem to unlock that!");
+        return;
+      endif
+    endif
+  endif
+endprogram
+
+function PickTreasureChest(me, chest)
+  var lvl := GetObjProperty(chest,"level");
+  if(!lvl)
+    SendSysMessage(me, "You cannot pick that.");
+    return;
+  endif
+  if(!chest.locked)
+    SendSysMessage(me,"That doesn't appear to be locked.");
+    return;
+  endif
+  PlaySoundEffect(me, SFX_242);
+  sleep(1);
+  var diff := (lvl * 25) - 10;
+  if(diff <= 25)
+    PlaySoundEffect(chest,SFX_200);
+    PrintTextAbovePrivate(chest, "*Unlocked!*", me);
+    chest.locked := 0;
+  else
+    SendSysMessage(me, "Your spell doesn't seem to work on that lock.");
+    return;
+  endif
+endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/skills/magery/OLD/vortex.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/vortex.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/vortex.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,24 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/client";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-
-
-program spell_vortex( parms )
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var thecritter := CreateNpcFromTemplate("vortex", castOn.x, castOn.y,castOn.z, 0, caster.realm);
-  PlaySoundEffect(thecritter,SFX_SPELL_ENERGY_VORTEX);
-  SetObjProperty(thecritter, "summoned",1);
-  SetObjProperty(thecritter, "master", caster.serial);
-  Detach();
-  sleep( (AP_GetSkill(caster, MAGERY) ) );
-  PlaySoundEffect( thecritter, SFX_SPELL_MANA_VAMPIRE );
-  PlayStationaryEffect( thecritter.x, thecritter.y, thecritter.z, FX_SMOKE, 0xa, 0xa, 0, caster.realm );
-  MoveCharacterToLocation(thecritter,0,0,0,MOVECHAR_FORCELOCATION);
-  ApplyRawDamage(thecritter, AP_GetVital(thecritter, HITS) + 3);
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/vortex.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/vortex.src)

Deleted: trunk/096/pkg/skills/magery/OLD/wallOfStone.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/wallOfStone.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/wallOfStone.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,35 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/fields";
-include "include/sound";
-include ":attributes:attributes";
-
-
-program spell_wallOfStone(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var fields := {};
-  var duration;
-  var x := castOn.x;
-  var y := castOn.y;
-  var z := castOn.z;
-  case(get_direction(caster))
-	"NS" : fields:= CreateNorthSouthField(caster, 0x80, x, y, z, 5);
-	"EW" : fields:= CreateEastWestField(caster, 0x80, x, y, z, 5);
-  endcase
-  Detach();
-  duration := CInt(AP_GetSkill(caster, MAGERY) )/2;
-  if (duration < 20)
-    duration := 20;
-  endif
-  var i;
-  for (i := 1; i <= 5; i := i + 1)
-    PlaySoundEffect(fields[i], SFX_SPELL_WALL_OF_STONE);
-  endfor
-  sleep(duration);
-  foreach fieldpart in fields
-    DestroyItem(fieldpart);
-  endforeach
-endprogram

Copied: trunk/096/pkg/skills/magery/OLD/wallOfStone.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/wallOfStone.src)

Deleted: trunk/096/pkg/skills/magery/OLD/weaken.src
===================================================================
--- trunk/096/pkg/skills/magery/OLD/weaken.src	2005-11-04 07:03:59 UTC (rev 896)
+++ trunk/096/pkg/skills/magery/OLD/weaken.src	2005-11-04 07:22:07 UTC (rev 897)
@@ -1,33 +0,0 @@
-use os;
-use uo;
-use util;
-
-include "include/statMod";
-include "include/sound";
-include "include/tileEffects";
-include ":attributes:attributes";
-include ":magery:reflect";
-include "include/magic";
-
-
-program spell_weaken(parms)
-  var caster := parms.caster;
-  var castOn := parms.castOn;
-  var spellid := parms.spellid;
-  var spellcfg := ReadConfigFile(":*:spells");
-  var circle := spellcfg[spellid].circle;
-
-  SetObjProperty(castOn, "LastHit", {caster.name,caster.serial, "weaken" });
-  if(spell_reflect(castOn))
-	castOn := caster;
-  endif
-  PlaySoundEffect(castOn, SFX_SPELL_WEAKEN);
-  PlayObjectCenteredEffect( castOn, FX_CURSE_EFFECT, 7,7);
-  if(!CanMod(castOn, "str"))
-	return;
-  endif
-  var magery := AP_GetSkill(caster, MAGERY);
-  var modAmount := Resisted(circle,caster,castOn,(GetModAmount( magery )));
-  var duration := GetModDuration( magery );
-  DoTempMod(castOn, "str", 0 - modAmount, duration);
-endprogram
\ No newline at end of file

Copied: trunk/096/pkg/skills/magery/OLD/weaken.src.temp (from rev 891, trunk/096/pkg/skills/magery/OLD/weaken.src)



From muaddiblsd at berlios.de  Fri Nov  4 08:39:49 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Fri, 4 Nov 2005 08:39:49 +0100
Subject: [Poldistro-svn] r898 - in trunk/096: . config pkg/items/bountyboard pkg/items/bountyboard/include pkg/packetHooks/PacketConfig pkg/packetHooks/PacketConfig/config pkg/packetHooks/Target pkg/packetHooks/Target/config pkg/skills/magery pkg/skills/magery/spellBook scripts/include scripts/include/OLD scripts/misc
Message-ID: <200511040739.jA47dnRO002836@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-04 08:39:41 +0100 (Fri, 04 Nov 2005)
New Revision: 898

Added:
   trunk/096/pkg/items/bountyboard/include/
   trunk/096/pkg/items/bountyboard/include/bounty.inc
Removed:
   trunk/096/pkg/items/bountyboard/start.src
   trunk/096/scripts/include/OLD/bounty.inc
Modified:
   trunk/096/HowToBegin.txt
   trunk/096/config/www.cfg
   trunk/096/pkg/items/bountyboard/bounty.src
   trunk/096/pkg/items/bountyboard/bountyWatcher.src
   trunk/096/pkg/items/bountyboard/bountyboard.src
   trunk/096/pkg/items/bountyboard/collectBounty.src
   trunk/096/pkg/packetHooks/PacketConfig/config/icp.cfg
   trunk/096/pkg/packetHooks/PacketConfig/config/packetconfig.cfg
   trunk/096/pkg/packetHooks/PacketConfig/pkg.cfg
   trunk/096/pkg/packetHooks/Target/config/icp.cfg
   trunk/096/pkg/packetHooks/Target/pkg.cfg
   trunk/096/pkg/packetHooks/Target/targetHook.src
   trunk/096/pkg/packetHooks/Target/uopacket.cfg
   trunk/096/pkg/skills/magery/spellBook/castSpell.src
   trunk/096/pkg/skills/magery/spells.cfg
   trunk/096/scripts/include/OLD/bard.inc
   trunk/096/scripts/include/OLD/bitwise.inc
   trunk/096/scripts/include/OLD/canAccess.inc
   trunk/096/scripts/include/OLD/clock.inc
   trunk/096/scripts/include/OLD/coords.inc
   trunk/096/scripts/include/OLD/dist.inc
   trunk/096/scripts/include/OLD/eventID.inc
   trunk/096/scripts/include/OLD/fields.inc
   trunk/096/scripts/include/OLD/findCity.inc
   trunk/096/scripts/include/OLD/firewall.inc
   trunk/096/scripts/include/OLD/guildFunctions.inc
   trunk/096/scripts/include/OLD/help.inc
   trunk/096/scripts/include/OLD/innCheck.inc
   trunk/096/scripts/include/OLD/isValidLoc.inc
   trunk/096/scripts/include/OLD/magic.inc
   trunk/096/scripts/include/OLD/math.inc
   trunk/096/scripts/include/OLD/mrcSpawn.inc
   trunk/096/scripts/include/OLD/myUtil.inc
   trunk/096/scripts/include/OLD/noto.inc
   trunk/096/scripts/include/OLD/objtype.inc
   trunk/096/scripts/include/OLD/recallRune.inc
   trunk/096/scripts/include/OLD/reportMurder.inc
   trunk/096/scripts/include/OLD/resurrection.inc
   trunk/096/scripts/include/OLD/selChar.inc
   trunk/096/scripts/include/OLD/skillLists.inc
   trunk/096/scripts/include/OLD/snooping.inc
   trunk/096/scripts/include/OLD/sorting.inc
   trunk/096/scripts/include/OLD/sound.inc
   trunk/096/scripts/include/OLD/spellAttack.inc
   trunk/096/scripts/include/OLD/spellRestrictions.inc
   trunk/096/scripts/include/OLD/startEqp.inc
   trunk/096/scripts/include/OLD/statMod.inc
   trunk/096/scripts/include/OLD/std.inc
   trunk/096/scripts/include/OLD/stringArrays.inc
   trunk/096/scripts/include/OLD/teleporters.inc
   trunk/096/scripts/include/OLD/tempMod.inc
   trunk/096/scripts/include/OLD/toolWear.inc
   trunk/096/scripts/include/OLD/utility.inc
   trunk/096/scripts/include/OLD/webPage.inc
   trunk/096/scripts/include/equipment.inc
   trunk/096/scripts/include/facings.inc
   trunk/096/scripts/include/itemdesc.inc
   trunk/096/scripts/misc/dblclickother.src
   trunk/096/scripts/misc/equipTest.src
   trunk/096/scripts/misc/unequipTest.src
Log:
Moved /scripts/include/OLD/bounty.inc to pkg/items/bountyboard/include/bounty.inc

Upgraded bountyboard package to use autoload.cfg and use new location of bounty.inc

Added ID keyword to more files.


Property changes on: trunk/096/HowToBegin.txt
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/config/www.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/096/pkg/items/bountyboard/bounty.src
===================================================================
--- trunk/096/pkg/items/bountyboard/bounty.src	2005-11-04 07:22:07 UTC (rev 897)
+++ trunk/096/pkg/items/bountyboard/bounty.src	2005-11-04 07:39:41 UTC (rev 898)
@@ -3,7 +3,7 @@
 use uo;
 use os;
 
-include "include/bounty";
+include ":bountyboard:bounty";
 include ":datafile:datafile";
 include ":containers:storageAreas";
 include ":gumps:gumps";

Modified: trunk/096/pkg/items/bountyboard/bountyWatcher.src
===================================================================
--- trunk/096/pkg/items/bountyboard/bountyWatcher.src	2005-11-04 07:22:07 UTC (rev 897)
+++ trunk/096/pkg/items/bountyboard/bountyWatcher.src	2005-11-04 07:39:41 UTC (rev 898)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 
-include "include/bounty";
+include ":bountyboard:bounty";
 include ":datafile:datafile";
 
 program bountyWatcher()

Modified: trunk/096/pkg/items/bountyboard/bountyboard.src
===================================================================
--- trunk/096/pkg/items/bountyboard/bountyboard.src	2005-11-04 07:22:07 UTC (rev 897)
+++ trunk/096/pkg/items/bountyboard/bountyboard.src	2005-11-04 07:39:41 UTC (rev 898)
@@ -5,7 +5,7 @@
 include ":datafile:datafile";
 include "include/sorting";
 include "include/client";
-include "include/bounty";
+include ":bountyboard:bounty";
 include ":gumps:include/old/old-gumps";
 
 var loop := 1;

Modified: trunk/096/pkg/items/bountyboard/collectBounty.src
===================================================================
--- trunk/096/pkg/items/bountyboard/collectBounty.src	2005-11-04 07:22:07 UTC (rev 897)
+++ trunk/096/pkg/items/bountyboard/collectBounty.src	2005-11-04 07:39:41 UTC (rev 898)
@@ -5,7 +5,7 @@
 use datafile;
 
 include ":datafile:datafile";
-include "include/bounty";
+include ":bountyboard:bounty";
 include ":containers:storageAreas";
 
 program collectBounty(parms)

Added: trunk/096/pkg/items/bountyboard/include/bounty.inc
===================================================================
--- trunk/096/pkg/items/bountyboard/include/bounty.inc	2005-11-04 07:22:07 UTC (rev 897)
+++ trunk/096/pkg/items/bountyboard/include/bounty.inc	2005-11-04 07:39:41 UTC (rev 898)
@@ -0,0 +1,65 @@
+/* $Id$
+ *
+ */
+use datafile;
+
+var bountyfile := DFOpenDataFile("BountySystem", 1);
+
+function AddBounty(killer, amt)
+	var entry := DFFindElement(bountyfile, CStr(killer.serial), 1);
+	print(entry);
+	entry.SetProp("Name", killer.name);
+	entry.SetProp("Bounty", CInt(DFGetProp(entry, "Bounty", 1, 0) + amt));
+	entry.SetProp("Murders", CInt(DFGetProp(entry, "Murders", 1, 0) + 1));
+	entry.SetProp("Expires", ReadGameClock() + 1209600);
+endfunction
+
+
+function FindBounty(who, serial)
+	who := who; // stops ecompile "not used" warning
+	var elem := DFFindElement(bountyfile, CStr(serial));
+	if( elem )
+		var holder := array;
+		holder.append(DFGetProp(elem, "Name"));
+		holder.append(DFGetProp(elem, "Bounty"));
+		holder.append(DFGetProp(elem, "Murders"));
+		bountyfile.DeleteElement(CStr(serial));
+		return holder;
+	else
+		return 0;
+	endif
+endfunction
+
+
+function ComposeBountyBoard()
+	var pnames := bountyfile.keys();
+	var data := array;
+	Foreach thing in pnames
+		var elem := DFFindElement(bountyfile, thing);
+		var holder := array;
+		holder.append(DFGetProp(elem, "Name"));
+		holder.append(CInt(thing));
+		holder.append(DFGetProp(elem, "Bounty"));
+		holder.append(DFGetProp(elem, "Murders", 1, 1));
+		data.append(holder);
+	endforeach
+	return bubble_sort_array(data, 3);
+endfunction
+
+
+function MaintainBountySystem()
+	var count := 0;
+	foreach thing in (bountyfile.keys())
+		var elem := DFFindElement(bountyfile, thing);
+		if( ReadGameClock() > DFGetProp(elem, "Expires") )
+			bountyfile.DeleteElement(thing);
+			count := count + 1;
+		endif
+		sleep(1);
+	endforeach
+	print("//////////////////////////////////////////");
+	print("// Bounty System Maintenance");
+	print("// Removed " + count + " expired bounties.");
+	print("//////////////////////////////////////////");
+endfunction
+


Property changes on: trunk/096/pkg/items/bountyboard/include/bounty.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/096/pkg/items/bountyboard/start.src
===================================================================
--- trunk/096/pkg/items/bountyboard/start.src	2005-11-04 07:22:07 UTC (rev 897)
+++ trunk/096/pkg/items/bountyboard/start.src	2005-11-04 07:39:41 UTC (rev 898)
@@ -1,4 +0,0 @@
-use os;
-use uo;
-
-start_script("bountyWatcher");


Property changes on: trunk/096/pkg/packetHooks/PacketConfig/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/PacketConfig/config/packetconfig.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/PacketConfig/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/Target/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/Target/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/Target/targetHook.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/packetHooks/Target/uopacket.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/spellBook/castSpell.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/spells.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/bard.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/bitwise.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/096/scripts/include/OLD/bounty.inc
===================================================================
--- trunk/096/scripts/include/OLD/bounty.inc	2005-11-04 07:22:07 UTC (rev 897)
+++ trunk/096/scripts/include/OLD/bounty.inc	2005-11-04 07:39:41 UTC (rev 898)
@@ -1,59 +0,0 @@
-use datafile;
-
-var bountyfile := DFOpenDataFile("BountySystem", 1);
-
-function AddBounty(killer, amt)
-  var entry := DFFindElement(bountyfile, CStr(killer.serial), 1);
-  print(entry);
-  entry.SetProp("Name", killer.name);
-  entry.SetProp("Bounty", CInt(DFGetProp(entry, "Bounty", 1, 0) + amt));
-  entry.SetProp("Murders", CInt(DFGetProp(entry, "Murders", 1, 0) + 1));
-  entry.SetProp("Expires", ReadGameClock() + 1209600);
-endfunction
-
-function FindBounty(who, serial)
-  who := who; // stops ecompile "not used" warning
-  var elem := DFFindElement(bountyfile, CStr(serial));
-  if(elem)
-    var holder := array;
-    holder.append(DFGetProp(elem, "Name"));
-    holder.append(DFGetProp(elem, "Bounty"));
-    holder.append(DFGetProp(elem, "Murders"));
-    bountyfile.DeleteElement(CStr(serial));
-    return holder;
-  else
-    return 0;
-  endif
-endfunction
-
-function ComposeBountyBoard()
-  var pnames := bountyfile.keys();
-  var data := array;
-  Foreach thing in pnames
-    var elem := DFFindElement(bountyfile, thing);
-    var holder := array;
-    holder.append(DFGetProp(elem, "Name"));
-    holder.append(CInt(thing));
-    holder.append(DFGetProp(elem, "Bounty"));
-    holder.append(DFGetProp(elem, "Murders", 1, 1));
-    data.append(holder);
-  endforeach
-  return bubble_sort_array(data, 3);
-endfunction
-
-function MaintainBountySystem()
-  var count := 0;
-  foreach thing in (bountyfile.keys())
-    var elem := DFFindElement(bountyfile, thing);
-    if(ReadGameClock() > DFGetProp(elem, "Expires"))
-      bountyfile.DeleteElement(thing);
-      count := count + 1;
-    endif
-    sleep(1);
-  endforeach
-  print("//////////////////////////////////////////");
-  print("// Bounty System Maintenance");
-  print("// Removed " + count + " expired bounties.");
-  print("//////////////////////////////////////////");
-endfunction
-


Property changes on: trunk/096/scripts/include/OLD/canAccess.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/clock.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/coords.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/dist.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/eventID.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/fields.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/findCity.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/firewall.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/guildFunctions.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/help.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/innCheck.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/isValidLoc.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/magic.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/math.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/mrcSpawn.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/myUtil.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/noto.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/objtype.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/recallRune.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/096/scripts/include/OLD/reportMurder.inc
===================================================================
--- trunk/096/scripts/include/OLD/reportMurder.inc	2005-11-04 07:22:07 UTC (rev 897)
+++ trunk/096/scripts/include/OLD/reportMurder.inc	2005-11-04 07:39:41 UTC (rev 898)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 
-//include "include/bounty";
+//include ":bountyboard:bounty";
 include ":gumps:include/gumps";
 include ":datafile:datafile";
 
@@ -14,7 +14,7 @@
 function SendReportGump(who)
 	var reportables := who.reportables;
 	var report_data := array{};
-	
+
 	var gump := GFCreateGump();
 	GFPage(gump, 0);
 	GFDisposable(gump, 0);
@@ -25,19 +25,19 @@
 	GFTextLine(gump, 50, 20, 0, "Now is the time for retribution!");
 	GFTextLine(gump, 50, 50, 0, "Check zero or more players to report for your murder");
 	GFTextLine(gump, 50, 70, 0, "and press OKAY");
-	
+
 	FillInArrays(reportables, report_data, gump);
-	
+
 	SetObjProperty(who, "ReportMenu", report_data);
-	
+
 	var ret := GFSendGump(who, gump);
 	if( ret == 0 )
 		return;
 	endif
-	
+
 	EraseObjProperty(who, "ReportMenu");
 	EraseObjProperty(who, "LoginReport");
-	
+
 	var holder := array{};
 	foreach id in (ret.keys)
 		if( id in report_data )
@@ -47,25 +47,25 @@
 			else
 				AdjustNoto(mob, who);
 			endif
-			
+
 			holder.append(id);
 			AdjustMurderCounts(mob.killer);
 		endif
 		sleepms(2);
 	endforeach
-	
+
 	foreach reportable in (who.reportables)
 		who.removeReportable(reportable.serial, reportable.gameclock);
 		sleepms(2);
 	endforeach
-	
+
 	var parms := array{who, holder};
 	var script := start_script(":bountyboard:bounty", parms);
 	if ( script.errortext )
 		SysLog("ERROR SendReportGump():: Unable to start :bountyboard:bounty ->"+script.errortext);
 		return error;
 	endif
-	
+
 	return 1;
 endfunction
 
@@ -84,31 +84,31 @@
 			prev_y := prev_y+20;
 			buttonret := buttonret+1;
 		endif
-		
+
 		sleepms(2);
 	endforeach
-	
+
 	return 1;
 endfunction
 
 function AdjustMurderCounts(killer)
 	var onlinetime := GetObjProperty(killer, "onlinetimer");
 	var longcount := GetObjProperty(killer, "longmurders");
-	
+
 	if( !longcount )
 		longcount := 0;
 	endif
-	
+
 	longcount := longcount + 1;
 	SetObjProperty(killer, "longmurders", longcount);
-	
+
 	if( longcount > 4 )
 		killer.setMurderer(1);
 		SendSysMessage(killer, "You are now known as a murderer!");
 	endif
-	
+
 	SetObjProperty(killer, "decaylongcountat", (onlinetime+LONG_COUNT_DECAY_TIME));
-	
+
 	var shortcount := CInt(GetObjProperty(killer, "shortmurders"));
 	shortcount := shortcount + 1;
 	SetObjProperty(killer, "shortmurders", shortcount);


Property changes on: trunk/096/scripts/include/OLD/reportMurder.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/resurrection.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/selChar.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/skillLists.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/snooping.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/sorting.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/sound.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/spellAttack.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/spellRestrictions.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/startEqp.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/statMod.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/std.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/stringArrays.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/teleporters.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/tempMod.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/toolWear.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/utility.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/OLD/webPage.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/equipment.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/facings.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/include/itemdesc.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/misc/dblclickother.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/misc/equipTest.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/scripts/misc/unequipTest.src
___________________________________________________________________
Name: svn:keywords
   + Id



From muaddiblsd at berlios.de  Fri Nov  4 08:49:16 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Fri, 4 Nov 2005 08:49:16 +0100
Subject: [Poldistro-svn] r899 - in trunk/096/pkg: items/bountyboard systems/merchantnodes
Message-ID: <200511040749.jA47nG41008143@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-04 08:49:13 +0100 (Fri, 04 Nov 2005)
New Revision: 899

Modified:
   trunk/096/pkg/items/bountyboard/bounty.src
   trunk/096/pkg/items/bountyboard/bountyboard.src
   trunk/096/pkg/systems/merchantnodes/guardNode.src
   trunk/096/pkg/systems/merchantnodes/merchantNode.src
Log:
replaced COLOR_YELLOW crap with 0x35 for color yellow.

Modified: trunk/096/pkg/items/bountyboard/bounty.src
===================================================================
--- trunk/096/pkg/items/bountyboard/bounty.src	2005-11-04 07:39:41 UTC (rev 898)
+++ trunk/096/pkg/items/bountyboard/bounty.src	2005-11-04 07:49:13 UTC (rev 899)
@@ -53,7 +53,7 @@
 	GFResizePic(gump, 50,  50, 5120, 500, 200);
 	GFResizePic(gump, 60,  60, 5054, 480, 180);
 	GFTextLine(gump, 247,  68, 0, "Bounty Menu");
-	GFTextLine(gump, 250,  70, COLOR_YELLOW, "Bounty Menu");
+	GFTextLine(gump, 250,  70, 0x35, "Bounty Menu");
 	GFTextLine(gump, 80, 120, 0, "Your bank box contains " + mygold + " gold coins from which you");
 	GFTextLine(gump, 80, 140, 0, "may place a bounty on " + name + "'s head.");
 	GFTextLine(gump, 80, 160, 0, "Simply enter the bounty amount you wish to place below.");

Modified: trunk/096/pkg/items/bountyboard/bountyboard.src
===================================================================
--- trunk/096/pkg/items/bountyboard/bountyboard.src	2005-11-04 07:39:41 UTC (rev 898)
+++ trunk/096/pkg/items/bountyboard/bountyboard.src	2005-11-04 07:49:13 UTC (rev 899)
@@ -21,7 +21,7 @@
   OldGFPage(0);
   OldGFGumpPic(0, 0, 2170);
   OldGFTextLine(197, 38, 0, "Bounty Board");
-  OldGFTextLine(200, 40, COLOR_YELLOW, "Bounty Board");
+  OldGFTextLine(200, 40, 0x35, "Bounty Board");
   var data := ComposeBountyBoard();
   data.reverse();
   var count := 0, page := 2, ct := 0;

Modified: trunk/096/pkg/systems/merchantnodes/guardNode.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/guardNode.src	2005-11-04 07:39:41 UTC (rev 898)
+++ trunk/096/pkg/systems/merchantnodes/guardNode.src	2005-11-04 07:49:13 UTC (rev 899)
@@ -20,7 +20,7 @@
   OldGFResizePic(  0,   0, 5120, 440, 300);
   OldGFResizePic( 10,  10, 5054, 420, 250);
   OldGFTextLine(132, 17, 0, "Guard Node Interface");
-  OldGFTextLine(130, 15, COLOR_YELLOW, "Guard Node Interface");
+  OldGFTextLine(130, 15, 0x35, "Guard Node Interface");
   var type := GetObjProperty(item, "Type");
   if(!type)
     type := "townguard";
@@ -49,7 +49,7 @@
   elseif(current == 0)
     OldGFTextLine(350,  80, COLOR_RED,    current+"/"+amt);
   else
-    OldGFTextLine(350,  80, COLOR_YELLOW, current+"/"+amt);
+    OldGFTextLine(350,  80, 0x35, current+"/"+amt);
   endif
   OldGFGumpPic(171, 50, 2440);
   OldGFGumpPic(171, 80, 2444);
@@ -86,10 +86,10 @@
     endcase
   var cs := GetObjProperty(item, "#wait");
   if(cs == 1)
-    color := COLOR_YELLOW;
+    color := 0x35;
     txt := "Guard Node Is Waiting To Initialize";
   elseif(cs == 2)
-    color := COLOR_YELLOW;
+    color := 0x35;
     txt := "Guard Nodes Are Disabled Globally";
   elseif(status != "off")
     respawn := OldGFCheckBox(  20, 120, 208, 209, 0, 300);

Modified: trunk/096/pkg/systems/merchantnodes/merchantNode.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/merchantNode.src	2005-11-04 07:39:41 UTC (rev 898)
+++ trunk/096/pkg/systems/merchantnodes/merchantNode.src	2005-11-04 07:49:13 UTC (rev 899)
@@ -29,10 +29,10 @@
   endif
   if(template == 1)
     OldGFTextLine(232, 17, 0, "Merchant Node Interface");
-    OldGFTextLine(230, 15, COLOR_YELLOW, "Merchant Node Interface");
+    OldGFTextLine(230, 15, 0x35, "Merchant Node Interface");
   else
     OldGFTextLine(232, 17, 0, "Banker Node Interface");
-    OldGFTextLine(230, 15, COLOR_YELLOW, "Banker Node Interface");
+    OldGFTextLine(230, 15, 0x35, "Banker Node Interface");
   endif
   type := GetObjProperty(item, "Type");
   if(!type)
@@ -49,7 +49,7 @@
   OldGFTextLine(420, 40, COLOR_BLUE, "Rebuild Stock");
   FillInPageData();
   if(len(type) < 10)
-    OldGFTextLine(40, sy, COLOR_YELLOW, "Create a new merchant here?   (negates all other choices)");
+    OldGFTextLine(40, sy, 0x35, "Create a new merchant here?   (negates all other choices)");
     OldGFButtonID(20, sy, 210, 211, 1, sy);
   endif
   OldGFTextLine( 20, 20, COLOR_GREEN, "Current:");
@@ -68,7 +68,7 @@
   elseif(current == 0)
     OldGFTextLine(90, 20, COLOR_RED,    current+"/"+amt);
   else
-    OldGFTextLine(90, 20, COLOR_YELLOW, current+"/"+amt);
+    OldGFTextLine(90, 20, 0x35, current+"/"+amt);
   endif
   apply   := OldGFButtonID( 20, 370, 2124, 2123, 1);
   cancel  := OldGFButtonID(100, 370, 2121, 2120, 1, 0);
@@ -169,10 +169,10 @@
     endcase
   var cs := GetObjProperty(item, "#wait");
   if(cs == 1)
-    color := COLOR_YELLOW;
+    color := 0x35;
     txt := "Merchant Node Is Waiting To Initialize";
   elseif(cs == 2)
-    color := COLOR_YELLOW;
+    color := 0x35;
     txt := "Merchant Nodes Are Disabled Globally";
   elseif(status != "off")
     restock := OldGFCheckBox(340, 320, 208, 209, 0, 400);



From austin at berlios.de  Fri Nov  4 03:19:27 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Fri, 4 Nov 2005 03:19:27 +0100
Subject: [Poldistro-svn] r886 - in trunk/096/scripts/include: . OLD
Message-ID: <200511040219.jA42JRXC018747@sheep.berlios.de>

Author: austin
Date: 2005-11-04 03:19:06 +0100 (Fri, 04 Nov 2005)
New Revision: 886

Added:
   trunk/096/scripts/include/OLD/
   trunk/096/scripts/include/OLD/bard.inc
   trunk/096/scripts/include/OLD/bitwise.inc
   trunk/096/scripts/include/OLD/bounty.inc
   trunk/096/scripts/include/OLD/canAccess.inc
   trunk/096/scripts/include/OLD/clock.inc
   trunk/096/scripts/include/OLD/coords.inc
   trunk/096/scripts/include/OLD/dist.inc
   trunk/096/scripts/include/OLD/eventID.inc
   trunk/096/scripts/include/OLD/exception.inc
   trunk/096/scripts/include/OLD/fields.inc
   trunk/096/scripts/include/OLD/findCity.inc
   trunk/096/scripts/include/OLD/firewall.inc
   trunk/096/scripts/include/OLD/guildFunctions.inc
   trunk/096/scripts/include/OLD/help.inc
   trunk/096/scripts/include/OLD/innCheck.inc
   trunk/096/scripts/include/OLD/isValidLoc.inc
   trunk/096/scripts/include/OLD/magic.inc
   trunk/096/scripts/include/OLD/mrcSpawn.inc
   trunk/096/scripts/include/OLD/myUtil.inc
   trunk/096/scripts/include/OLD/noto.inc
   trunk/096/scripts/include/OLD/objtype.inc
   trunk/096/scripts/include/OLD/recallRune.inc
   trunk/096/scripts/include/OLD/reportMurder.inc
   trunk/096/scripts/include/OLD/resurrection.inc
   trunk/096/scripts/include/OLD/selChar.inc
   trunk/096/scripts/include/OLD/skillLists.inc
   trunk/096/scripts/include/OLD/snooping.inc
   trunk/096/scripts/include/OLD/sorting.inc
   trunk/096/scripts/include/OLD/sound.inc
   trunk/096/scripts/include/OLD/spellAttack.inc
   trunk/096/scripts/include/OLD/spellRestrictions.inc
   trunk/096/scripts/include/OLD/startEqp.inc
   trunk/096/scripts/include/OLD/statMod.inc
   trunk/096/scripts/include/OLD/std.inc
   trunk/096/scripts/include/OLD/stringArrays.inc
   trunk/096/scripts/include/OLD/teleporters.inc
   trunk/096/scripts/include/OLD/tempMod.inc
   trunk/096/scripts/include/OLD/toolWear.inc
   trunk/096/scripts/include/OLD/utility.inc
   trunk/096/scripts/include/OLD/webPage.inc
Removed:
   trunk/096/scripts/include/bard.inc
   trunk/096/scripts/include/bitwise.inc
   trunk/096/scripts/include/bounty.inc
   trunk/096/scripts/include/canAccess.inc
   trunk/096/scripts/include/clock.inc
   trunk/096/scripts/include/coords.inc
   trunk/096/scripts/include/dist.inc
   trunk/096/scripts/include/eventID.inc
   trunk/096/scripts/include/exception.inc
   trunk/096/scripts/include/fields.inc
   trunk/096/scripts/include/findCity.inc
   trunk/096/scripts/include/firewall.inc
   trunk/096/scripts/include/guildFunctions.inc
   trunk/096/scripts/include/help.inc
   trunk/096/scripts/include/innCheck.inc
   trunk/096/scripts/include/isValidLoc.inc
   trunk/096/scripts/include/magic.inc
   trunk/096/scripts/include/math.inc
   trunk/096/scripts/include/moveObject.inc
   trunk/096/scripts/include/mrcSpawn.inc
   trunk/096/scripts/include/myUtil.inc
   trunk/096/scripts/include/noto.inc
   trunk/096/scripts/include/objtype.inc
   trunk/096/scripts/include/properties.inc
   trunk/096/scripts/include/recallRune.inc
   trunk/096/scripts/include/reportMurder.inc
   trunk/096/scripts/include/resurrection.inc
   trunk/096/scripts/include/scripts.inc
   trunk/096/scripts/include/selChar.inc
   trunk/096/scripts/include/skillLists.inc
   trunk/096/scripts/include/snooping.inc
   trunk/096/scripts/include/sorting.inc
   trunk/096/scripts/include/sound.inc
   trunk/096/scripts/include/spellAttack.inc
   trunk/096/scripts/include/spellRestrictions.inc
   trunk/096/scripts/include/startEqp.inc
   trunk/096/scripts/include/statMod.inc
   trunk/096/scripts/include/std.inc
   trunk/096/scripts/include/stringArrays.inc
   trunk/096/scripts/include/teleporters.inc
   trunk/096/scripts/include/tempMod.inc
   trunk/096/scripts/include/toolWear.inc
   trunk/096/scripts/include/utility.inc
   trunk/096/scripts/include/webPage.inc
Modified:
   trunk/096/scripts/include/arrays.inc
   trunk/096/scripts/include/packets.inc
   trunk/096/scripts/include/string.inc
Log:
Moved old includes and ones that don't properly compile to OLD
Added functions to arrays.inc, cleaned up ClearSpaces() in strings.inc a little.

Added: trunk/096/scripts/include/OLD/bard.inc
===================================================================
--- trunk/096/scripts/include/OLD/bard.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/bard.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,39 @@
+use uo;
+
+include "include/client";
+include ":attributes:attributes";
+
+function play(character, theskill, item, skil)
+  var success, fail;
+  case(item.graphic)
+    0x0eb1:  success := 0x44;  fail := 0x45;
+    0x0eb2:  success := 0x46;  fail := 0x47;
+    0x0eb3:  success := 0x4d;  fail := 0x4e;
+    0x0eb4:  success := 0x4d;  fail := 0x4e;
+    0x0e9c:  success := 0x39;  fail := 0x3a;
+    0x0e9d:  success := 0x53;  fail := 0x54;
+    0x0e9e:  success := 0x53;  fail := 0x54;
+  endcase
+  var thepoints := GetEffectiveSkill(character, SKILLID_MUSICIANSHIP);
+  if(CheckSkill(character, SKILLID_MUSICIANSHIP, theskill, thepoints))
+    if(CheckSkill(character, skil, theskill, thepoints * 2))
+      PlaySoundEffect( character, success);
+      return 1;
+    else
+      PlaySoundEffect( character, fail);
+      return 0;
+    endif
+  else
+    PlaySoundEffect( character, fail);
+    return 0;
+  endif
+endfunction
+
+function findinstrument(character)
+  var instruments := {0x0eb1, 0x0eb2, 0x0eb3, 0x0eb4, 0x0e9c, 0x0e9d, 0x0e9e};
+  foreach item in EnumerateItemsInContainer(character.backpack)
+    if(item.graphic in instruments)
+      return item;
+    endif
+  endforeach
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/bitwise.inc
===================================================================
--- trunk/096/scripts/include/OLD/bitwise.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/bitwise.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,475 @@
+const CONST_E := 2.718282;
+const CONST_PI := 3.141592;
+
+
+function Log(base, answer)
+
+	var x := 1.000;
+	var logcount := 0.000;
+	var diff := 1.000;
+	var success := 0;
+
+	while (success == 0)
+
+		x := x * base;
+
+		if (Abs(answer - x) < 0.001)
+			logcount := logcount + 1;
+			success := 1;
+		else
+			if (x > answer)
+				diff := diff / 2;
+				logcount := logcount - diff;
+				x := Exp(base, logcount);
+			else
+				logcount := logcount + diff;
+			endif
+		endif
+
+		count := count + 1;
+
+		if (count > 200)
+			success := 1;
+		endif
+
+	endwhile
+
+	return logcount;
+
+endfunction
+
+
+function Mod(numerator, denominator)
+
+	while (numerator > denominator)
+		numerator := numerator - denominator;
+	endwhile
+
+	return numerator;
+
+endfunction
+
+
+function Trunc(number, places)
+
+	var base := Exp(10, places);
+
+	number := number * base;
+	number := CInt(number);
+	number := CDbl(number);
+	number := number / base;
+
+	return number;
+
+endfunction
+
+
+function Fac(factorial);
+
+	var x;
+	while (factorial > 0)
+		x := x * factorial;
+		factorial := factorial - 1;
+	endwhile
+	return x;
+
+endfunction
+
+
+function Exp(base, power)
+
+	var i;
+	var x := 1;
+	var check := CInt(power);
+	if (power == check)
+		for(i:=1;i<=power;i:=i+1)
+			x := x * base;
+		endfor
+		return x;
+	else
+		var m, n;
+		m := power - check;
+		m := m * 1000;
+		n := YRoot(base, 1000);
+		x := Exp(n, m);
+		return x;
+	endif
+
+endfunction
+
+
+function YRoot(x, y)
+
+
+	var i := 0.000;
+	var n := 0.000;
+	var root := 2.000;
+	var a := CInt(Sqr(x));
+
+	if (a < 4)
+		a := 4;
+	endif
+
+	var success := 0;
+
+
+	while (success == 0)	
+
+		n := Exp(root, y);
+		i := x - n;
+		i := i / (a * root);
+		i := Trunc(i, 3);
+		root := root + i;
+		if (i == 0)
+			success := 1;
+			if ( Exp(Root, y) > x )
+				root := root - 0.001;
+			endif
+			if ( Exp((root + 0.001), y) == x)
+				root := root + 0.001;
+			endif
+		endif
+	endwhile
+
+	return root;
+
+endfunction
+
+
+function Sqr(x)
+
+	var i := 0.000;
+	var n := 0.000;
+	var root := 2.000;
+	var success := 0;
+
+	while (success == 0)	
+
+		n := Exp(root, 2);
+		i := x - n;
+		i := i / (2 * root);
+		i := Trunc(i, 3);
+		root := root + i;
+		if (i == 0)
+			success := 1;
+			if ( Exp(Root, 2) > x )
+				root := root - 0.001;
+			endif
+		endif
+	endwhile
+
+	return root;
+
+endfunction
+
+
+function Mean(arrayx)
+
+	var n, i:=0.000;
+
+	foreach n in arrayx
+		i := i + arrayx[n];
+	endforeach
+
+	n := CDbl(i / len(arrayx) );
+
+	return n;
+
+endfunction
+
+
+function StdDev(arrayx)
+
+	var m, n, i := 0.000;
+	var arraymean := Mean(arrayx);
+	var arraylen := len(arrayx);
+
+	foreach m in arrayx
+		n := arrayx[m] - arraymean;
+		n := Exp(n, 2);
+		i := i + n;
+	endforeach
+
+	i := i / (arraylen - 1);
+	n := Sqr(i);
+
+	return n;
+
+endfunction
+
+
+function ZTest(arrayx, mu, sigma)
+
+	var i, n;
+	var z:= 0.000;
+	var arraymean := Mean(arrayx);
+	var arraylen := len(arrayx);
+
+	i := arraymean - mu;
+	n := sigma / Sqr(arraylen);
+
+	z := i/n;
+
+	return := z;
+
+endfunction
+
+
+function TTest(arrayx, mu)
+
+	var i, n, s;
+	var t:= 0.000;
+	var arraymean := Mean(arrayx);
+	var arraylen := len(arrayx);
+	var s := StdDev(arrayx);
+
+	i := arraymean - mu;
+	n := s / Sqr(arraylen);
+
+	t := i/n;
+
+	return := t;
+
+endfunction
+
+function BitIn(arrayx)
+
+	var i := 8;
+	var n;
+	var loop := 1;
+	var bitvalue := 0;
+
+	while (i >= 0)
+
+		n := 8 - i;
+		if (arrayx[i] == 1)
+			bitvalue := bitvalue + Exp(2, n);
+		endif
+		i := i - 1;
+
+	endwhile
+
+	return bitvalue;
+
+endfunction
+
+
+function BitOut(x)
+
+	x := CInt(x);
+	var loop := 1;
+	var bitvalue := 0;
+	var arrayx := {0,0,0,0,0,0,0,0};
+	var n;
+
+	while (loop <= 8)
+
+		n := 8 - loop;
+		bitvalue := Exp(2, n);
+		if ( (x - bitvalue) >= 0)
+			arrayx[loop] := 1;
+			x := x - bitvalue;
+		endif
+		loop := loop + 1;
+
+	endwhile
+
+	return arrayx;
+
+endfunction
+
+
+function BitAnd(x, y)
+
+	var arrayx := BitOut(x);
+	var arrayy := BitOut(y);
+	var z := 0;
+	var loop := 1;
+	var n;
+
+	while (loop <= 8)
+
+		n := loop - 1;
+		if ( (arrayx[loop] == 1) && (arrayy[loop] == 1) )
+			z := z + Exp(2, n);
+		endif
+		loop := loop + 1;
+
+	endwhile
+
+	return z;
+
+endfunction
+
+
+function BitOr(x, y)
+
+	var arrayx := BitOut(x);
+	var arrayy := BitOut(y);
+	var z := 0;
+	var loop := 1;
+	locan n;
+
+	while (loop <= 8)
+
+		n := loop - 1;
+		if ( (arrayx[loop] == 1) || (arrayy[loop] == 1) )
+			z := z + Exp(2, n);
+		endif
+		loop := loop + 1;
+
+	endwhile
+
+	return z;
+
+endfunction
+
+
+function BitXor(x, y)
+
+	var arrayx := BitOut(x);
+	var arrayy := BitOut(y);
+	var z := 0;
+	var loop := 1;
+	var n;
+
+	while (loop <= 8)
+
+		n := loop - 1;
+		if (arrayx[loop] - arrayy[loop] != 0)
+			z := z + Exp(2, n);
+		endif
+		loop := loop + 1;
+
+	endwhile
+
+	return z;
+
+endfunction
+
+
+function BitEqv(x, y)
+
+	var arrayx := BitOut(x);
+	var arrayy := BitOut(y);
+	var z := 0;
+	var loop := 1;
+	var n;
+
+	while (loop <= 8)
+
+		n := loop - 1;
+		if (arrayx[loop] - arrayy[loop] == 0)
+			z := z + Exp(2, n);
+		endif
+		loop := loop + 1;
+
+	endwhile
+
+	return z;
+
+endfunction
+
+
+function BitImp(x, y)
+
+	var arrayx := BitOut(x);
+	var arrayy := BitOut(y);
+	var z := 0;
+	var loop := 1;
+	var n;
+
+	while (loop <= 8)
+
+		n := loop - 1;
+		if (arrayx[loop] - arrayy[loop] < 1)
+			z := z + Exp(2, n);
+		endif
+		loop := loop + 1;
+
+	endwhile
+
+	return z;
+
+endfunction
+
+
+function BitNot(x)
+
+	var arrayx := BitOut(x);
+	var z := 0;
+	var loop := 1;
+	var n;
+
+	while (loop <= 8)
+
+		n := loop - 1;
+		if (arrayx[loop] == 0)
+			arrayx[loop] := 1;
+			z := z + Exp(2, n);
+		else
+			arrayx[loop] := 0;
+		endif
+
+		loop := loop + 1;
+
+	endwhile
+
+	return z;
+
+endfunction
+
+
+function FlagSet(flag, bit);
+
+	bit := 9 - bit;
+
+	var flagarray := BitOut(flag);
+	flagarray[bit] := 1;
+
+	bit := BitIn(flagarray);
+
+	return bit;
+
+endfunction
+
+
+function FlagReset(flag, bit);
+
+	var x := 1;
+	var y := 0;
+	var n := 0;
+
+	bit := 9 - bit;
+
+	var flagarray := BitOut(flag);
+	flagarray[bit] := 0;
+
+	while (x <= 8)
+
+		if (flagarray[x] == 1)
+			n := x - 1;
+			y := y + Exp(2, n);
+		endif
+
+		x := x + 1;
+
+	endwhile
+
+	return y;
+
+endfunction
+
+
+function FlagCheck(flag, bit);
+
+	var flagarray := BitOut(flag);
+	bit := 9 - bit;
+
+	if (flagarray[bit] == 1)
+		return 1;
+	else
+		return 0;
+	endif
+
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/bounty.inc
===================================================================
--- trunk/096/scripts/include/OLD/bounty.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/bounty.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,59 @@
+use datafile;
+
+var bountyfile := DFOpenDataFile("BountySystem", 1);
+
+function AddBounty(killer, amt)
+  var entry := DFFindElement(bountyfile, CStr(killer.serial), 1);
+  print(entry);
+  entry.SetProp("Name", killer.name);
+  entry.SetProp("Bounty", CInt(DFGetProp(entry, "Bounty", 1, 0) + amt));
+  entry.SetProp("Murders", CInt(DFGetProp(entry, "Murders", 1, 0) + 1));
+  entry.SetProp("Expires", ReadGameClock() + 1209600);
+endfunction
+
+function FindBounty(who, serial)
+  who := who; // stops ecompile "not used" warning
+  var elem := DFFindElement(bountyfile, CStr(serial));
+  if(elem)
+    var holder := array;
+    holder.append(DFGetProp(elem, "Name"));
+    holder.append(DFGetProp(elem, "Bounty"));
+    holder.append(DFGetProp(elem, "Murders"));
+    bountyfile.DeleteElement(CStr(serial));
+    return holder;
+  else
+    return 0;
+  endif
+endfunction
+
+function ComposeBountyBoard()
+  var pnames := bountyfile.keys();
+  var data := array;
+  Foreach thing in pnames
+    var elem := DFFindElement(bountyfile, thing);
+    var holder := array;
+    holder.append(DFGetProp(elem, "Name"));
+    holder.append(CInt(thing));
+    holder.append(DFGetProp(elem, "Bounty"));
+    holder.append(DFGetProp(elem, "Murders", 1, 1));
+    data.append(holder);
+  endforeach
+  return bubble_sort_array(data, 3);
+endfunction
+
+function MaintainBountySystem()
+  var count := 0;
+  foreach thing in (bountyfile.keys())
+    var elem := DFFindElement(bountyfile, thing);
+    if(ReadGameClock() > DFGetProp(elem, "Expires"))
+      bountyfile.DeleteElement(thing);
+      count := count + 1;
+    endif
+    sleep(1);
+  endforeach
+  print("//////////////////////////////////////////");
+  print("// Bounty System Maintenance");
+  print("// Removed " + count + " expired bounties.");
+  print("//////////////////////////////////////////");
+endfunction
+

Added: trunk/096/scripts/include/OLD/canAccess.inc
===================================================================
--- trunk/096/scripts/include/OLD/canAccess.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/canAccess.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,25 @@
+
+function can_access(who, item, flags := 0)
+  var owner := Cint(GetObjProperty(item, "Owner"));
+  if((owner) and (owner != who.serial))
+    SendSysMessage(who, "You cannot use that (1) " + item.desc);
+    return 0;
+  elseif(GetObjProperty(item, "Vendored"))
+    SendSysMessage(who, "You cannot use that (2) " + item.desc);
+    return 0;
+  elseif(!Accessible(who, item))
+    SendSysMessage(who, "You cannot use that (3) " + item.desc);
+    return 0;
+  elseif((!flags["distance"]) and ((Distance(who, item) > 2)))
+    SendSysMessage(who, "That item is too far away.");
+    return 0;
+  elseif((!flags["unmovable"]) and (item.movable == 0))
+    SendSysMessage(who, "You cannot use that while locked down.");
+    return 0;
+  elseif(!ReserveItem(item))
+    SendSysMessage(who, "That item is already in use.");
+    return 0;
+  else
+    return 1;
+  endif
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/clock.inc
===================================================================
--- trunk/096/scripts/include/OLD/clock.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/clock.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,67 @@
+use uo;
+use cfgfile;
+
+function GetTime()
+  var cfg := ReadConfigFile( ":daynight:config/days" );
+  var elem := FindConfigElem( cfg, "WholeDay" );
+  var length := GetConfigInt( elem, "Length" );
+  var day_length := (60 * length);
+  var x := ReadGameClock();
+  var bigpart := x / day_length;
+  var smallpart := bigpart * day_length;
+  x := (x - smallpart);
+  return ( x );
+endfunction
+
+function GetTransition()
+  var cfg := ReadConfigFile( ":daynight:config/days" );
+  var elem := FindConfigElem( cfg, "Transition" );
+  var length := GetConfigInt( elem, "Length" );
+  return length;
+endfunction
+
+function GetDayLength()
+  var cfg := ReadConfigFile( ":daynight:config/days" );
+  var elem := FindConfigElem( cfg, "WholeDay" );
+  var length := GetConfigInt( elem, "Length" );
+  return length;
+endfunction
+
+function GetTimeofDay()
+  var time_sec := GetTime();
+  var length := (GetDayLength() * 60) * 1.0;
+  var temp := length / time_sec;
+  var raw_time := 24.0 / temp;
+  var hours := CInt(raw_time);
+  var remainder := raw_time - hours;
+  var minutes := CInt( remainder * 60 );
+  if( len(CStr(minutes)) == 1 )
+	minutes := "0" + CStr(minutes);
+  endif
+  if( len(CStr(hours)) == 1 )
+	hours := "0" + CStr(hours);
+  endif
+  return (hours+":"+minutes);
+endfunction
+
+function GetHourOfDay()
+  var time := GetTimeofDay();
+  var colon := find(time, ":", 1);
+  return CInt(time[1, colon]);
+endfunction
+
+function HourWithinRange(hr, hrstart, hrend)
+  hr := CInt(hr) + 24;
+  hrstart := CInt(hrstart) + 24;
+  hrend := CInt(hrend) + 24;
+  if (hrstart > hrend)
+	if (hr >= hrstart || hr < hrend)
+	  return 1;
+	endif
+  else
+	if (hr >= hrstart && hr <= hrend)
+	  return 1;
+	endif
+  endif
+  return 0;
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/coords.inc
===================================================================
--- trunk/096/scripts/include/OLD/coords.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/coords.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,25 @@
+use basic;
+use math;
+
+function ToSextant(x, y)
+  var latitude_direction, longitude_direction;
+  var latitude_degrees, longitude_degrees;
+  var latitude_minutes, longitude_minutes;
+  latitude_degrees := (y-1624)*0.087890625;
+  longitude_degrees := (x-1323)*0.0703125;
+  if(latitude_degrees < 0)
+	latitude_direction := "N";
+  else
+	latitude_direction := "S";
+  endif
+  if(longitude_degrees < 0)
+	longitude_direction := "W";
+  else
+	longitude_direction := "E";
+  endif
+  latitude_degrees := Abs(latitude_degrees);
+  longitude_degrees := Abs(longitude_degrees);
+  latitude_minutes := CInt((CInt((latitude_degrees-Floor(latitude_degrees))*100)*60)/100);
+  longitude_minutes := CInt((CInt((longitude_degrees-Floor(longitude_degrees))*100)*60)/100);
+  return(Floor(latitude_degrees) + "o " + latitude_minutes + "'" + latitude_direction + ", " + Floor(longitude_degrees) + "o " + longitude_minutes + "'" + longitude_direction);
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/dist.inc
===================================================================
--- trunk/096/scripts/include/OLD/dist.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/dist.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,52 @@
+/*
+ *  dist( obj1, obj2 )
+ *      - returns the largest of the x-distance and y-distance 
+ *        between two objects.
+ */
+
+use uo;
+
+function dist( obj1, obj2 )
+    return Distance( obj1, obj2 );
+
+            /* implements:
+                while (obj1.container)
+                    obj1 := obj1.container;
+                endwhile
+    
+                while (obj2.container)
+                    obj2 := obj2.container;
+                endwhile
+
+                var xd := obj1.x - obj2.x;
+                var yd := obj1.y - obj2.y;
+                if (xd < 0)
+                    xd := -xd;
+                endif
+                if (yd < 0)
+                    yd := -yd;
+                endif
+                if (xd > yd)
+                    return xd;
+                else
+                    return yd;
+                endif
+            */
+endfunction
+
+function coordist( x1, y1, x2, y2 )
+
+   var xd := x1 - x2;
+   var yd := y1 - y2;
+   if (xd < 0)
+      xd := -xd;
+   endif
+   if (yd < 0)
+      yd := -yd;
+   endif
+   if (xd > yd)
+      return xd;
+   else
+     return yd;
+   endif
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/eventID.inc
===================================================================
--- trunk/096/scripts/include/OLD/eventID.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/eventID.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,84 @@
+//
+// event IDs to be returned in eventid member of wait_for_event
+// result.
+//
+// See documentation for details.
+//
+// TODO: move this to OS.EM, when .EM files can have constants.
+//
+// Author: ens
+//
+// Last modification: 01/22/1999
+//
+
+
+//const EVID_SPEECH           := 0x0001;
+
+const EVID_ENGAGED          := 0x0002;
+const EVID_DISENGAGED       := 0x0004;
+const EVID_NODE             := 0x0005;
+const EVID_DAMAGED          := 0x0008;
+const EVID_HERDING          := 0x1111;
+const EVID_WAKEUP           := 0x1112;
+const EVID_SKILLCAP         := 0x1113;
+const EVID_STATCAP          := 0x1114;
+const EVID_SPAWNREGION      := 0x1115;
+const EVID_SR_DEATH         := 0x1116;
+const EVID_SR_PENDING       := 0x1117;
+const EVID_ENTEREDAREA      := 0x0010;
+const EVID_STAFF_LOGIN      := 0x0011;
+const EVID_PLAYER_LOGIN     := 0x0012;
+const EVID_PLAYER_LOGOFF    := 0x0013;
+const EVID_PLAYER_DELAY     := 0x0014;
+const EVID_FIND_COUN        := 0x0015;
+const EVID_FIND_GM          := 0x0016;
+const EVID_GUILD_DISBAND    := 0x0017;
+const EVID_GUILD_CREATED    := 0x0018;
+
+const EVID_ALL_ATTACK_CMD := 0x12;
+const EVID_ALL_FOLLOW_CMD := 0x11;
+
+const EVID_LEFTAREA         := 0x0020;
+
+const EVID_OPPONENT_MOVED   := 0x0040;
+
+const EVID_HOSTILE_MOVED    := 0x0080; // not implemented
+
+const EVID_MERCHANT_BOUGHT  := 0x0100;
+const EVID_MERCHANT_SOLD    := 0x0200;
+
+const EVID_ITEM_GIVEN       := 0x0400;
+const EVID_DOUBLECLICKED    := 0x0800;
+
+const EVID_RESERVED_1000    := 0x00001000;
+const EVID_RESERVED_2000    := 0x00002000;
+const EVID_RESERVED_4000    := 0x00004000;
+const EVID_RESERVED_8000    := 0x00008000;
+
+const EVID_SPAWNPOINT_CREATED	:= 1010;
+const EVID_SPAWNPOINT_DESTROYED := 1020;
+const EVID_SPAWNPOINT_RESET		:= 1040;
+const EVID_SPAWNPOINT_CHANGED	:= 1080;
+const EVID_SPAWN_DEATH			:= 1100;
+const EVID_SPAWNREGION_DEATH	:= 3001;
+const EVID_RESERVED_00010000    := 0x00010000;
+const EVID_RESERVED_00020000    := 0x00020000;
+const EVID_RESERVED_00040000    := 0x00040000;
+const EVID_RESERVED_00080000    := 0x00080000;
+const EVID_RESERVED_00100000    := 0x00100000;
+const EVID_RESERVED_00200000    := 0x00200000;
+const EVID_RESERVED_00400000    := 0x00400000;
+const EVID_RESERVED_00800000    := 0x00800000;
+const EVID_RESERVED_01000000    := 0x01000000;
+const EVID_RESERVED_02000000    := 0x02000000;
+const EVID_RESERVED_04000000    := 0x04000000;
+const EVID_RESERVED_08000000    := 0x08000000;
+const EVID_RESERVED_10000000    := 0x10000000;
+const EVID_RESERVED_20000000    := 0x20000000;
+const EVID_RESERVED_40000000    := 0x40000000;
+const EVID_RESERVED_80000000    := 0x80000000;
+
+/* FIXME: these need to be renumbered, one clashes with a reserved event */
+const EVID_SPELL_ATTACK     := 0x0800;
+const EVID_BUDDYATTACKED     := 0x1600;
+const EVID_PEACEMADE         := 0x90000000;
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/exception.inc
===================================================================
--- trunk/096/scripts/include/OLD/exception.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/exception.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,35 @@
+/* $Id: exception.inc 236 2005-09-25 09:06:19Z panosl $
+ *
+ * Purpose
+ * Provides various functions and constants for exceptions.
+ *
+ */
+use uo;
+
+include "include/log";
+
+
+/*
+ * Exception(what)
+ *
+ * Author: Folko
+ *
+ * Purpose
+ * Raises and exception and logs it to the error log.
+ *
+ * Parameters
+ * what:        A string describing the error
+ *
+ * Return value
+ * Always returns an error-object
+ *
+ * Notes
+ * Only use this for script errors etc., we don't want spam in the error log.
+ *
+ */
+function Exception(what)
+	print("******Exception: " + what + "******");
+	Log(LOG_ERROR, "Exception: " + what);
+
+	return(error);
+endfunction

Added: trunk/096/scripts/include/OLD/fields.inc
===================================================================
--- trunk/096/scripts/include/OLD/fields.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/fields.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,67 @@
+function get_direction(who)
+  var ret;
+  if(who.facing in array(1, 3, 5, 7))
+    case (RandomInt(2))
+      0: ret := "NS";
+      1: ret := "EW";
+	endcase
+  else
+    case(who.facing)
+      2: ret := "EW";
+      4: ret := "NS";
+      6: ret := "EW";
+      0: ret := "NS";
+    endcase
+  endif
+  return ret;
+endfunction
+
+function CreateNorthSouthField(caster, fieldtype,x,y,z, length := 5)
+  var counter := 0;
+  var i;
+  var fires := { };
+  var tester := CreateItemAtLocation(x,y,z, 0xeed, 1, caster.realm);
+  for ( i := x - 2; i <= x - 2 + length; i := i + 1)
+    counter := counter  + 1;
+    if(fieldtype == 0x80)
+      if((CheckLosAt(tester, i, y, z )) and (len(ListMobilesNearLocation(i, y, z, 0, caster.realm)) == 0))
+        fires[counter] := CreateItemAtLocation( i, y, z, fieldtype, 1, caster.realm);
+        SetObjProperty(fires[counter], "f","1");
+        SetObjProperty(fires[counter], "creater", caster.serial);
+      endif
+    else
+      if(CheckLosAt(tester, i, y, z ))
+        fires[counter] := CreateItemAtLocation( i,y,z,fieldtype, 1, caster.realm );
+        SetObjProperty(fires[counter], "creater", caster.serial);
+        SetObjProperty(fires[counter], "f","1");
+      endif
+    endif
+  endfor
+  DestroyItem(tester);
+  return fires;
+endfunction
+
+function CreateEastWestField(caster, fieldtype,x,y,z, length)
+  var counter := 0;
+  var i;
+  var fires := { };
+  var tester := CreateItemAtLocation(x,y,z, 0xeed, 1, caster.realm);
+  for ( i := y - 2; i <= y - 2 + length; i := i + 1)
+    counter := counter  + 1;
+    if(fieldtype == 0x80)
+      if((CheckLosAt(tester, x, i, z )) and (len(ListMobilesNearLocation(x, i, z, 0, caster.realm)) == 0))
+        fires[counter] := CreateItemAtLocation( x,i,z,fieldtype, 1, caster.realm );
+        SetObjProperty(fires[counter], "f","1");
+        SetObjProperty(fires[counter], "creater", caster.serial);
+      endif
+    else
+      if(CheckLosAt(tester, x, i, z ))
+        fires[counter] := CreateItemAtLocation( x,i,z,fieldtype, 1, caster.realm );
+        SetObjProperty(fires[counter], "f","1");
+        SetObjProperty(fires[counter], "creater", caster.serial);
+      endif
+    endif
+  endfor
+  DestroyItem(tester);
+  return fires;
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/findCity.inc
===================================================================
--- trunk/096/scripts/include/OLD/findCity.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/findCity.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,47 @@
+use os;
+use uo;
+
+function FindCity(me)
+  if(me.x>=1244 && me.y>=1530 && me.x<=1704 && me.y<=1758)
+    return "Britain";
+  elseif(me.x>=4379 && me.y>=1045 && me.x<=4487 && me.y<=1178)
+    return "Moonglow";
+  elseif(me.x>=5137 && me.y>=3948 && me.x<=5196 && me.y<=4082)
+    return "Delucia";
+  elseif(me.x>=5196 && me.y>=3923 && me.x<=5322 && me.y<=4085)
+    return "Delucia";
+  elseif(me.x>=5638 && me.y>=3083 && me.x<=5799 && me.y<=3328)
+    return "Papua";
+  elseif(me.x>=5799 && me.y>=3121 && me.x<=5822 && me.y<=3327)
+    return "Papua";
+  elseif(me.x>=1294 && me.y>=3664 && me.x<=1506 && me.y<=3886)
+    return "Jhelom";
+  elseif(me.x>=494 && me.y>=926 && me.x<=600 && me.y<=1034)
+    return "Yew";
+  elseif(me.x>=590 && me.y>=796 && me.x<=670 && me.y<=886)
+    return "Empath Abbey";
+  elseif(me.x>=2394 && me.y>=370 && me.x<=2624 && me.y<=632)
+    return "Minoc";
+  elseif(me.x>=1794 && me.y>=2638 && me.x<=2136 && me.y<=2902)
+    return "Trinsic";
+  elseif(me.x>=538 && me.y>=2106 && me.x<=686 && me.y<=2274)
+    return "Skara Brae";
+  elseif(me.x>=3646 && me.y>=2040 && me.x<=3814 && me.y<=2280)
+    return "Magincia";
+  elseif(me.x>=3588 && me.y>=2446 && me.x<=3762 && me.y<=2690)
+    return "Occlo";
+  elseif(me.x>=2612 && me.y>=2082 && me.x<=2772 && me.y<=2256)
+    return "Buccaneers Den";
+  elseif(me.x>=3496 && me.y>=1062 && me.x<=3808 && me.y<=1400)
+    return "Nujelm";
+  elseif(me.x>=2794 && me.y>=634 && me.x<=3026 && me.y<=1000)
+    return "Vesper";
+  elseif(me.x>=2206 && me.y>=1116 && me.x<=2290 && me.y<=1236)
+    return "Cove";
+  elseif(me.x>=5120 && me.y>=0 && me.x<=5374 && me.y<=254)
+    return "Wind";
+  elseif(me.x>=1382 && me.y>=3955 && me.x<=1528 && me.y<=4044)
+    return "Jhelom";
+  endif
+  return "no city";
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/firewall.inc
===================================================================
--- trunk/096/scripts/include/OLD/firewall.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/firewall.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,66 @@
+use os;
+use util;
+use uo;
+
+include "include/client";
+include "include/fields";
+
+const SOUND_EFFECT_FIREFIELD:= 0x1de;
+const UOBJ_FIREFIELD_NS := 0x398c;
+const UOBJ_FIREFIELD_EW := 0x3996;
+const SOUND_EFFECT_POISON := 0x247;
+const EFFECT_RED_SPARKLE := 0x374a;
+
+/*
+function DoFireField( caster )
+var thetarget;
+var x;
+var y;
+var z;
+var i;
+var fires := { };
+var duration;
+var listeners := { };
+var sufferers := { };
+thetarget := TargetCoordinates(caster);
+if ((!thetarget))
+        SendSysMessage(caster, "Targetting cancelled.");
+endif
+x := thetarget.x;
+y := thetarget.y;
+z := thetarget.z;
+if (!CheckLosAt( caster, x, y, z ))
+        SendSysMessage(caster, "You can't see that!");
+        return;
+endif
+var dir := get_direction(caster, x, y, z);
+case dir
+	"north" : fires:= CreateNorthSouthField(caster, UOBJ_FIREFIELD_NS, x, y, z, 5);
+	"south"  :fires:= CreateNorthSouthField(caster, UOBJ_FIREFIELD_NS, x, y, z, 5);
+	"east"  : fires:= CreateEastWestField(caster, UOBJ_FIREFIELD_EW, x, y, z, 5);
+        "west"  : fires:= CreateEastWestField(caster, UOBJ_FIREFIELD_EW, x, y, z, 5);
+        default:  var firetype := RandomInt(2) + 1;
+        	  case firetype
+        	  	1: fires:= CreateNorthSouthField(caster, UOBJ_FIREFIELD_NS, x, y, z, 5);
+        	  	2: fires:= CreateEastWestField(caster, UOBJ_FIREFIELD_EW, x, y, z, 5);
+        	  endcase
+endcase
+Detach();
+foreach fire in fires
+        PlaySoundEffect(fire, SOUND_EFFECT_FIREFIELD);
+endforeach
+var counter := 0;
+duration := CInt(GetEffectiveSkill( caster, SKILLID_MAGERY ) );
+for (counter := 1; counter <= duration; counter := counter + 1)
+foreach fire in fires
+	if (fire)
+        PlaySoundEffect(fire, SOUND_EFFECT_FIREFIELD);
+    endif
+endforeach
+sleep(1);
+endfor
+foreach fire in fires
+    DestroyItem( fire );
+endforeach
+endfunction
+*/
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/guildFunctions.inc
===================================================================
--- trunk/096/scripts/include/OLD/guildFunctions.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/guildFunctions.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,337 @@
+use uo;
+use os;
+
+var guildinitlayout := {
+	"page 0",
+	"resizepic 30 30 3000 400 200",
+	"text 163 43 5 0",
+	"text 50 65 5 1",
+	"text 80 85 35 2",
+	"text 50 105 5 3",
+	"text 80 125 35 4",
+	"text 50 145 5 5",
+	"text 80 165 35 6",
+	"button 230 195 2119 2120 1 0 1",
+	"button 165 195 2130 2129 1 0 2"
+};
+
+var guildinitdata := {
+	"Guild Information",
+	"Guild Name:",
+	"Guildname",
+	"Guild Abbreviation:",
+	"Guildabbr",
+	"Guildmaster:",
+	"Guildmaster"
+};
+// ResetGuildStone(stone)
+//
+// This function will initialize a guildstone.  It will wipe all
+// existing guild data from the stone, queue all of the guild's
+// players so their guild info is removed, and remove the guild from
+// the registry.
+
+function ResetGuildStone(stone)
+
+	var i, x;
+	var empty := {};
+
+	var guildmembers := GetObjProperty(stone, "MemberSerials");
+
+	SetObjProperty(stone, "GuildName", "NONE");
+	SetObjProperty(stone, "GuildAbbr", "NONE");
+	SetObjProperty(stone, "GuildAlign", "NONE");
+	SetObjProperty(stone, "MemberSerials", empty);
+	SetObjProperty(stone, "MemberNames", empty);
+	SetObjProperty(stone, "MemberTitles", empty);
+	SetObjProperty(stone, "Enemies", empty);
+	SetObjProperty(stone, "Allies", empty);
+	SetObjProperty(stone, "PendingAction", empty);
+
+	set_critical(1);
+	var guildregistry := GetGlobalProperty("GuildRegistry");
+	var newregistry := {};
+	var newreglen := 0;
+	for (i := 1; i <= len(guildregistry); i := i + 1);
+		if (stone.serial != guildregistry[i])
+			newreglen := newreglen + 1;
+			newregistry[newreglen] := guildregistry[i];
+		endif
+	endfor
+	SetGlobalProperty("GuildRegistry", newregistry);
+	set_critical(0);
+
+	foreach x in guildmembers
+		GuildAction(x.serial, stone, "Disband");
+	endforeach
+
+	PrintTextAbove(stone, "Guildstone has been reset.");
+
+endfunction
+
+
+// GuildAction(destination, source, action)
+//
+// This function adds a PendingAction to a guildstone.  It can be used
+// to declare war, peace, or alliances with other guildstones, (in
+// which case destination = target guild's stone serial, source = 
+// the declarer's guildstone, and the action = "War", "Peace", or 
+// "Ally"), or it can be used to remove or retitle other members of
+// the guild  (in which case destination = target's serial, source =
+// the stone, and action = "Remove", "Disband", "Add", etc).  If a 
+// player is changed, and the player is not online, then the action
+// is posted to the global queue.  The function returns 1 on success, 
+// 2 if the target was offline, and 0 for failure.
+
+function GuildAction(destination, source, action)
+
+	var i, x;
+	var targobj;
+	var pendingaction;
+
+	var guildname := GetObjProperty(source, "GuildName");
+
+	if ( (action == "War") || (action == "Peace") || (action == "Ally") )
+		targobj := SystemFindObjectBySerial(destination);
+		pendingaction := GetObjProperty(targobj, "PendingAction");
+		x := len(pendingaction) + 1;
+		pendingaction[x] := source.serial;
+		x := x + 1;
+		pendingaction[x] := action;
+		SetObjProperty(targobj, "PendingAction", pendingaction);
+		return 1;
+	elseif ( (action == "Remove") || (action == "Disband") || (action == "Retitle") || (action == "Add"))
+		i := 0;
+		foreach x in EnumerateOnlineCharacters()
+			if (x.serial == destination)
+				targobj := x;
+				i := 1;
+			endif
+		endforeach
+		if (i == 1)
+			case(action)
+				"Remove":
+				SendSysMessage(targobj, "You have been removed from " + guildname + "!");
+				EraseObjProperty(targobj, "Guild");
+				targobj.name := GetObjProperty(targobj, "OldName");
+				EraseObjProperty(targobj, "GuildTitle");
+				EraseObjProperty(targobj, "OldName");
+				return 1;
+
+				"Disband":
+				SendSysMessage(targobj, "Your guild, " + guildname + ", has disbanded.");
+				EraseObjProperty(targobj, "Guild");
+				targobj.name := GetObjProperty(targobj, "OldName");
+				EraseObjProperty(targobj, "GuildTitle");
+				EraseObjProperty(targobj, "OldName");
+				return 1;
+
+				"Retitle":
+				SendSysMessage(targobj, "You have been granted a new guild title.  Go to the guildstone and update your information.");
+				return 1;
+
+				"Add":
+				SendSysMessage(targobj, "You have been recruited into " + guildname + ".");
+				SetObjProperty(targobj, "OldName", targobj.name);
+				SetObjProperty(targobj, "Guild", source.serial);
+				SetObjProperty(targobj, "GuildTitle", "Initiate");
+				return 1;
+
+			endcase
+		else
+			set_critical(1);
+			var guildpendingaction := GetGlobalProperty("GuildPendingAction");
+			i := len(guildpendingaction) + 1;
+			guildpendingaction[x] := destination;
+			x := x + 1;
+			guildpendingaction[x] := action;
+			SetGlobalProperty("GuildPendingAction", guildpendingaction);
+			set_critical(0);
+			return 2;
+		endif	
+	else
+		print("Error selecting action type.");
+		return 0;
+	endif
+
+endfunction
+
+
+// FindPosition(who, stone)
+//
+// This function will find the array position in the guild data for
+// member <who>.  If the person is not in the guild, the function 
+// returns a 0.
+
+function FindPosition(who, stone)
+
+	var memberserials := GetObjProperty(stone, "MemberSerials");
+	var i;
+	var guildslot := 0;
+
+	for (i := 1; i <= len(memberserials); i := i + 1)
+		if (memberserials[i] == who.serial)
+			guildslot := i;
+		endif
+	endfor
+
+	return guildslot;
+
+endfunction
+
+
+// RemoveMember(who, stone)
+//
+// This function will remove an individual from a guildstone.  In this
+// case, <who> is the SERIAL NUMBER of the person to be removed.
+
+function RemoveMember(who, stone)
+
+	var i := 0;
+	var x := 0;
+	var newserials := {};
+	var newnames := {};
+	var newtitles := {};
+
+	var memberserials := GetObjProperty(stone, "MemberSerials");
+	var membernames := GetObjProperty(stone, "MemberNames");
+	var membertitles := GetObjProperty(stone, "MemberTitles");
+
+	for (i := 1; i <= len(memberserials); i := i + 1)
+		if (i != who)
+			x := x + 1;
+			newserials[x] := memberserials[i];
+			x := x + 1;
+			newnames[x] := membernames[i];
+			x := x + 1;
+			newtitles[x] := membertitles[i];
+		endif
+	endfor
+
+	SetObjProperty(stone, "MemberSerials", newserials);
+	SetObjProperty(stone, "MemberNames", newnames);
+	SetObjProperty(stone, "MemberTitles", newtitles);
+
+	GuildAction(who, stone, "Remove");
+
+endfunction
+
+
+// AddMember(who, stone)
+//
+// This function will add a member to a guildstone.  If the player is
+// already a member, the function will return 0.  The "title" field
+// is optional, and will return "Initiate" if omitted.
+
+function AddMember(who, stone, title := "Initiate")
+
+	if ( FindPosition(who, stone) > 0 )
+		PrintTextAbove(stone, "That person is already a member!");
+		return 0;
+	endif
+
+	var memberserials := GetObjProperty(stone, "MemberSerials");
+	var membernames := GetObjProperty(stone, "MemberNames");
+	var membertitles := GetObjProperty(stone, "MemberTitles");
+
+	var i := len(memberserials) + 1;
+
+	memberserials[i] := who.serial;
+	membernames[i] := who.name;
+	membertitles[i] := title;
+
+	SetObjProperty(stone, "MemberSerials", memberserials);
+	SetObjProperty(stone, "MemberNames", membernames);
+	SetObjProperty(stone, "MemberTitles", membertitles);
+
+	GuildAction(who.serial, stone, "Add");
+
+endfunction
+
+
+// InitializeGuild(who, guildstone)
+//
+// This function runs when the guildstone is first placed, or after
+// it has been wiped and the guild disbanded.   The first person to
+// use the stone after it is placed becomes the guildmaster.  This
+// function just sets the name and abbreviation of the guild, and
+// sets the title of the guildmaster.   It will then return to the
+// main guildstone program, where the guildmaster can add members
+// and make adjustments as needed.
+
+function InitializeGuild(who, stone)
+
+	var success := 0;
+	var guildname, guildabbr, guildtitle;
+
+	while (success == 0)
+		guildname := RequestInput(who, stone, "Enter a your Guild's name (5-40 characters):");
+		if ( (len(guildname) > 40) || (len(guildname) < 5) )
+			SendSysMessage(who, "Invalid Name.");
+		else
+			success := 1;
+		endif
+	endwhile
+	guildinitdata[3] := guildname;
+
+	success := 0;
+	while (success == 0)
+		guildabbr := RequestInput(who, stone, "Enter a your Guild's short name, displayed in your members' titles (3-16 characters):");
+		SendSysMessage(who, guildabbr);
+		if ( (len(guildabbr) > 16) || (len(guildname) < 3) )
+			SendSysMessage(who, "Invalid Name.");
+		else
+			success := 1;
+		endif
+	endwhile
+	guildinitdata[5] := guildabbr;
+
+	success := 0;
+	while (success == 0)
+		guildtitle := RequestInput(who, stone, "Enter your title (3-16 characters):");
+		SendSysMessage(who, guildtitle);
+		if ( (len(guildtitle) > 16) || (len(guildname) < 3) )
+			SendSysMessage(who, "Invalid Name.");
+		else
+			success := 1;
+		endif
+	endwhile
+	guildinitdata[7] := guildtitle;
+
+	SendSysMessage(who, "Is this information correct?");
+	var res := SendDialogGump(who, guildinitlayout, guildinitdata);
+	if (res[0] == 2)
+
+		set_critical(1);
+		var masterlist := GetGlobalProperty("GuildRegistry");
+		success := len(masterlist) + 1;
+		masterlist[success] := stone.serial;	
+		SetGlobalProperty("GuildRegistry", masterlist);
+		set_critical(0);
+
+		var memberserials := { who.serial };
+		var membernames := { who.name };
+		var membertitles := { guildtitle };
+		var empty := { };
+
+		SetObjProperty(stone, "GuildName", guildname);
+		SetObjProperty(stone, "GuildAbbr", guildabbr);
+		SetObjProperty(stone, "GuildAlign", "NONE");
+		SetObjProperty(stone, "MemberSerials", memberserials);
+		SetObjProperty(stone, "MemberNames", membernames);
+		SetObjProperty(stone, "MemberTitles", membertitles);
+		SetObjProperty(stone, "GuildEnemies", empty);
+		SetObjProperty(stone, "GuildAllies", empty);
+		SetObjProperty(stone, "PendingAction", empty);
+
+		SetObjProperty(who, "Guild", stone.serial);
+		SetObjProperty(who, "OldName", who.name);
+		SetObjProperty(who, "GuildTitle", guildtitle);
+		who.name := who.name + ", " + guildtitle + " [" + guildabbr + "]";
+		SendSysMessage(who, "Guildstone initialized.");
+		return 1;
+	else
+		return 0;
+	endif
+
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/help.inc
===================================================================
--- trunk/096/scripts/include/OLD/help.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/help.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,63 @@
+var onlinecounselors;
+var onlinestaff;
+
+onlinecounselors := staffcheck("coun");
+onlinestaff := staffcheck("gm");
+
+function Icanpage(thechar)
+  foreach person in EnumerateOnlineCharacters()
+    if ((GetObjProperty(person,"canpage")) && (person.serial != thechar.serial))
+      return 0;
+    endif
+  endforeach
+  SetObjProperty(thechar, "canpage", 1);
+  return 1;
+endfunction
+
+function staffcheck(type)
+  var stafflist := GetProcess(GetGlobalProperty("#stafflist"));
+  var k := struct;
+  case(type)
+    "coun": k.+type := EVID_FIND_COUN;
+    "gm":   k.+type := EVID_FIND_GM;
+  endcase
+  k.+pid := getpid();
+  stafflist.sendevent(k);
+  var ev := wait_for_event(10);
+  var evdata := ev.data;
+  return evdata;
+endfunction
+
+function pagecheck(serial, type)
+  var cserial := CInt(serial);
+  var retval := 0;
+  var i;
+  case(CInt(type))
+    1: var maxi := gmpages.size();
+	   for(i := 0; i < maxi; i := i + 1)
+		 if (cserial == CInt(gmpages[i]))
+		   retval := i;
+		   break;
+		 endif
+	   endfor
+    2: var maxi := counpages.size();
+	   for(i := 0; i < maxi; i := i + 1)
+		 if (cserial == CInt(counpages[i]))
+		   retval := i;
+		   break;
+		 endif
+	   endfor
+  endcase
+  return retval;
+endfunction
+
+function pagewarning(type, thepage, who)
+  case(type)
+    1: foreach char in onlinestaff
+		 SendSysMessage( char, "Page from " + who.name + ": " + thepage);
+	   endforeach
+    2: foreach char in onlinecounselors
+		 SendSysMessage( char, "Page from " + who.name +  ": " + thepage);
+	   endforeach
+  endcase
+endfunction

Added: trunk/096/scripts/include/OLD/innCheck.inc
===================================================================
--- trunk/096/scripts/include/OLD/innCheck.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/innCheck.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,22 @@
+use uo;
+use os;
+use cfgfile;
+use util;
+
+function Inncheck(character)
+
+  var element, rect;
+  var cfgfile := ReadConfigFile("::innlocation");
+  var entries := GetConfigStringKeys(cfgfile);
+  foreach listing in entries
+    element :=  cfgfile[listing];
+    rect := element.rect;
+    rect := SplitWords(rect);
+    if((character.x >= CInt(rect[1])) && (character.x <= CInt(rect[3])) && (character.y >= CInt(rect[2])) && (character.y <= CInt(rect[4])))
+      return 1;
+      break;
+    endif
+  endforeach
+  return 0;
+
+endfunction 
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/isValidLoc.inc
===================================================================
--- trunk/096/scripts/include/OLD/isValidLoc.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/isValidLoc.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,57 @@
+use uo;
+use polsys;
+
+function isValidLoc(x, y, realm := "britannia" )
+ 
+  if(realm == "britannia" || realm == "britannia_alt")
+  
+	  if((x >= 5112) && (x <= 5213))
+	    if((y >= 1093) && (y <= 1213))
+	      return 0;
+	    endif
+	  endif
+	
+	  if((x >= 5120) && (x <= 5374))
+	    if((y >= 265) && (y <= 512))
+	      return 0;
+	    endif
+	  endif
+	
+	  if((x >= 5890) && (x <= 6142))
+	    if((y >= 514) && (y <= 1278))
+	      return 0;
+	    endif
+	  endif
+	
+	  if((x >= 5376) && (x <= 5910))
+	    if((y >= 1030) && (y <= 1276))
+	      return 0;
+	    endif
+	  endif
+	
+	  if((x >= 5422) && (x <= 6142))
+	    if((y >= 1536) && (y <= 1796))
+	      return 0;
+	    endif
+	  endif
+	
+	  if((x >= 5632) && (x <= 6142))
+	    if((y >= 1784) && (y <= 2303))
+	      return 0;
+	    endif
+	  endif
+	
+	  if((x >= 5120) && (x <= 5680))
+	    if((y >= 2048) && (y <= 2303))
+	      return 0;
+	    endif
+	  endif
+  
+  else
+  	var realm := Realms()[realm];
+  	if( x >= realm.width || y >= realm.height )
+  		return 0;
+  	endif
+  endif
+  return 1;
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/magic.inc
===================================================================
--- trunk/096/scripts/include/OLD/magic.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/magic.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,96 @@
+const EVID_DISCHARGE := 0x123457;
+
+include ":attributes:attributes";
+
+
+function Resisted(circle, caster, cast_on, amt)
+  // Purpose: to check for resistance to spells cast upon a character
+  // called by: most spells
+  // returns: amount of damage not resisted?
+
+  var magery := CInt(AP_GetSkill(caster, MAGERY));
+  var evalint := CInt(AP_GetSkill(caster, EVALINT));
+  var resist := CInt(AP_GetSkill(cast_on, RESISTING_SPELLS));
+        
+  // chk1 relates to the resist ability.
+  var chk1 := (resist / 5);
+  // chk2 relates to the difficulty level
+  var chk2 := resist - (((magery - 20) / 5) + (circle * 5));
+        
+  if(chk1 < 1)
+    chk1 := 1;
+  endif
+  if(chk2 < 1)
+    chk2 := 1;
+  endif
+        
+  // What an odd construct.  
+  // If you're hit with an easy spell then you have a difficulty of your resist
+  var diff := 0;
+  if(chk1 > chk2)
+    diff := chk1;
+  else
+    diff := chk2;
+  endif
+        
+  if(cast_on.dead)
+    return 0;
+  endif
+  if( SkillCheck(cast_on, RESISTING_SPELLS, diff) > 0 )
+    SendSysMessage(cast_on, "You feel yourself resisting magical energy!");
+    //PlaySoundEffect(cast_on, SFX_SPELL_WEAKEN);
+    //PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 5,5);
+    amt := (amt * 0.5);
+    if(amt < 1)
+      amt := 1;
+    endif
+  endif
+  var modamt := 1;
+  if(resist > evalint)
+    modamt := (1 + ((evalint - resist) / 200.0));
+  elseif(evalint > resist)
+    modamt := (1 + ((evalint - resist) / 500.0));
+  endif
+  amt := (amt * modamt);
+  return CInt(amt);
+endfunction
+
+function getresistpoints(c, victim, skillid)
+  var points;
+  var diff;
+  case(c)
+    1:   points :=  20; diff := 20;
+    2:   points :=  40; diff := 30;
+    3:   points :=  80; diff := 40;
+    4:   points := 100; diff := 50;
+    5:   points := 120; diff := 60;
+    6:   points := 140; diff := 70;
+    7:   points := 160; diff := 86;
+    8:   points := 180; diff := 100;
+  endcase
+  var skill := AP_GetSkill(victim, skillid);
+  if(skill > (diff - 20))
+    if((skill - diff) <= 5)
+      points := points;
+    elseif((skill - diff) <= 10)
+      points := (points * 3) / 4;
+    elseif((skill - diff) <= 15)
+      points := points / 2;
+    elseif((skill - diff) <= 15)
+      points := points / 4;
+    else
+      points := 0;
+    endif
+  endif
+  return points;
+endfunction
+
+function CalcSpellDamage(circle, caster)
+  var die_string := circle+"d8";
+  var dmg := RandomDiceRoll(die_string);
+  dmg := dmg + CInt(AP_GetSkill(caster, MAGERY)/10);
+  if(dmg > (circle * 8))
+    dmg := circle * 8;
+  endif
+  return dmg;
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/mrcSpawn.inc
===================================================================
--- trunk/096/scripts/include/OLD/mrcSpawn.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/mrcSpawn.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,321 @@
+use cfgfile;
+include ":attributes:attributes";
+include "include/utility";
+
+var mrcspawn_cfg := ReadConfigFile("::mrcspawn");
+var itemconfig := ReadConfigFile(":*:itemdesc");
+var storage := find_or_create_storage("Merchant Storage");
+
+function FindMerchantType(mrctype)
+	var npcdesccfg	:= ReadConfigFile(":*:npcdesc");
+	var elem := FindConfigElem(npcdesccfg, mrctype);
+	var retval := 0;
+	foreach thing in GetConfigStringArray(elem, "Cprop")
+		var split := SplitWords(thing);
+		if(split[1] == "MerchantType")
+			retval := split[2] - split[2][1];
+			break;
+		endif
+	endforeach
+	return retval;
+endfunction
+
+function create_node_merc(merchanttype, name)
+	var inv_rs := find_or_create_item(storage, name + " RS");
+	var inv_fs := find_or_create_item(storage, name + " FS");
+	var inv_pb := find_or_create_item(storage, name + " PB");
+	var inv_1c := find_or_create_item(storage, name + " 1C");
+	SetObjProperty(inv_rs, "MerchantType", merchanttype);
+	SetObjProperty(inv_rs, "MyGold", 5000);
+	StockInventory(merchanttype, inv_rs);
+	RestockInitialInventory(inv_rs, inv_fs);
+endfunction
+
+function destroy_node_merc(name)
+	DestroyRootItemInStorageArea(storage, name + " RS");
+	DestroyRootItemInStorageArea(storage, name + " FS");
+	DestroyRootItemInStorageArea(storage, name + " PB");
+	DestroyRootItemInStorageArea(storage, name + " 1C");
+endfunction
+
+function StockInventory(merchanttype, inventory)
+	var mtype := FindConfigElem(mrcspawn_cfg, merchanttype);
+	if(mtype)
+		foreach productgroup in GetConfigStringArray(mtype, "Sells");
+			var pg_elem := FindConfigElem(mrcspawn_cfg, productgroup);
+			foreach itemstr in GetConfigStringArray(pg_elem, "Item")
+				SpawnItem(inventory, itemstr);
+				sleepms(10);
+			endforeach
+		endforeach
+	endif
+endfunction
+
+function SpawnItem(inventory, itemstr)
+	var split := SplitWords(itemstr);
+	var objtype := split[1];
+	var amt := Cint(split[2]);
+	var buyprice	:= itemconfig[objtype].VendorBuysFor;
+	var sellprice := itemconfig[objtype].VendorSellsFor;
+	if(Cint(objtype))
+		objtype := Cint(objtype);
+	else
+		objtype := Cint(GetObjtypeByName(objtype));
+	endif
+	if(!objtype)
+		syslog("Could not determine objtype for itemstr: " + itemstr);
+		return;
+	endif
+	var res;
+	if(amt > 0)
+		var i;
+		for( i := 1; i <= amt; i := i + 1 )
+			res := CreateItemInInventory(inventory, objtype, 1);
+			res.buyprice	:= buyprice;
+			res.sellprice := sellprice;
+		endfor
+	endif
+endfunction
+
+function checkstock(rs, pak)
+// purpose: to remove items that the vendor does not carry, but have been sold to it.
+// and replenish the purchasing gold supply for the vendor.
+	var mygold := Cint(GetObjProperty(rs, "MyGold"));
+	foreach thing in EnumerateItemsInContainer(pak)
+		var crs := Cint(GetObjProperty(thing, "ClearRestock"));
+		var cst;
+		if(crs)
+			if(ReadGameClock() > CInt(crs))
+				cst := CInt(itemconfig[thing.objtype].VendorBuysFor) + 5;
+				if(!cst)
+					cst := 1;
+				endif
+				mygold := CInt(mygold + (cst * thing.amount));
+				DestroyItem(thing);
+			endif
+		endif
+	endforeach
+	SetObjProperty(rs, "MyGold", mygold);
+endfunction
+
+function RestockInitialInventory(source, destination)
+// When vendors start up, they need a slightly different script.
+	var merchanttype := GetObjProperty(source, "MerchantType");
+	var multiplier, amt, mlt, things;
+	var newarray := {};
+	foreach thing in EnumerateItemsInContainer(source)
+		newarray.append(thing.objtype);
+		amt := 0;
+		multiplier := CInt(GetObjProperty(thing, "Multiplier"));
+		var chk := CountExisting(destination, thing.objtype);
+		things := chk[2];
+		amt := chk[1];
+		if(amt >= (thing.amount * multiplier))
+			multiplier := multiplier - 1;
+			if(multiplier < 1)
+				multiplier := 1;
+			endif
+		elseif(amt == 0)
+			multiplier := multiplier + 1;
+			if(multiplier > 20)
+				multiplier := 20;
+			endif
+		endif
+		SetObjProperty(thing, "Multiplier", multiplier);
+		mlt := Cint(thing.amount * multiplier);
+		var buyprice := Cint(thing.buyprice);
+		var sellprice := Cint(thing.sellprice);
+		var res;
+		if(amt != mlt)
+			foreach widget in things
+				DestroyItem(widget);
+			endforeach
+			if(amt > mlt)
+				res := CreateItemInInventory(destination, thing.objtype, mlt);
+				if(res)
+					res.sellprice := sellprice;
+					res.buyprice := buyprice;
+				endif
+			elseif(amt < mlt)
+				var i;
+				for(i:=1; i<= mlt; i := i+1)
+					var res := CreateItemInInventory(destination, thing.objtype, 1);
+					res.sellprice := sellprice;
+					res.buyprice := buyprice;
+					sleepms(1);
+				endfor
+			endif
+		endif
+		sleepms(1);
+	endforeach
+	foreach thing in EnumerateItemsInContainer(destination)
+		if((!(thing.objtype in newarray)) and (!GetObjProperty(thing, "ClearRestock")))
+			DestroyItem(thing);
+		endif
+	endforeach
+endfunction
+
+function RestockMyInventory(source, destination)
+	var merchanttype := GetObjProperty(source, "MerchantType");
+	var multiplier, amt, mlt, items, mygold;
+	var newarray := {}; // Array of what's for sale
+	// cycle through everything that's for sale
+	foreach thing in EnumerateItemsInContainer(source)// this is the "ideal" stock.
+		newarray.append(thing.objtype);
+		amt := 0;
+		mygold := GetObjProperty(source, "MyGold");
+		multiplier := CInt(GetObjProperty(thing, "Multiplier")); // multiplier of increments.
+		var chk := CountExisting(destination, thing.objtype); // to see what we got *really* for sale
+		items := chk[2];// returns all of a particular item, stacked or unstacked. (array)
+		amt := chk[1];
+		
+		// determine whether to increase or decrease stock.
+		if(amt >= (thing.amount * multiplier))
+			multiplier := multiplier - 1;
+			if(multiplier < 1)
+				multiplier := 1;
+			endif
+		elseif(amt == 0)
+			multiplier := multiplier + 1;
+			if(multiplier > 20)
+				multiplier := 20;
+			endif
+		endif
+		SetObjProperty(thing, "Multiplier", multiplier);
+		
+		mlt := Cint(thing.amount * multiplier); // mlt is the amount that should be in stock
+		
+		if(amt != mlt)
+			// define characteristics of the items
+			var buyprice := Cint(thing.buyprice);
+			var sellprice := Cint(thing.sellprice);
+
+			// remove what remains
+			foreach widget in items
+				mygold := mygold + Cint(widget.amount * buyprice);
+				DestroyItem(widget);
+			endforeach
+			var i;
+			// make one of everything you need
+			for(i:=1; i<= mlt; i := i+1)
+				if((mygold > buyprice) or (merchanttype == "Architect"))
+					var res := CreateItemInInventory(destination, thing.objtype, 1);
+					res.sellprice := sellprice;
+					res.buyprice := buyprice;
+					if(merchanttype != "Architect")
+						mygold := mygold - buyprice;
+					endif
+				sleepms(1);
+				endif
+			endfor
+		endif
+		SetObjProperty(source, "MyGold", mygold);
+		sleepms(1);
+	endforeach
+
+	// ditch the leftovers
+	foreach thing in EnumerateItemsInContainer(destination)
+		if((!(thing.objtype in newarray)) and (!GetObjProperty(thing, "ClearRestock")))
+			mygold := mygold + Cint(thing.amount * thing.buyprice);
+			DestroyItem(thing);
+		endif
+	endforeach
+	SetObjProperty(source, "MyGold", mygold);
+endfunction
+
+function CountExisting(container, objtype)
+	var amt := 0;
+	var things := {};
+	foreach thing in EnumerateItemsInContainer(container)
+		if((thing.objtype == objtype) and (Cint(GetObjProperty(thing, "ClearRestock")) == 0))
+			things.append(thing);
+			amt := amt + thing.amount;
+		endif
+	endforeach
+	var ary := {};
+	ary.append(amt);
+	ary.append(things);
+	return ary;
+endfunction
+
+function ModifyPCSellList(merchanttype, backpack)
+	var backpackitems := ListRootItemsInContainer(backpack);
+	var prodgroups := FindConfigElem(mrcspawn_cfg, merchanttype);
+	var buys := GetConfigStringArray(prodgroups, "Buys");
+	var normcost, normsell, percentage;
+	
+	//  If not buying lets call the whole thing off.
+	if(buys.size() < 1)
+		return 0;
+	endif
+
+	var iteminit := 0;
+	var itemmark := -1;
+	
+	// set buy price for each item to be 0 to start. This means it won't be sellable.
+	foreach item in backpackitems
+		item.buyprice := iteminit;
+	endforeach
+	
+	var buynobuyable := { }; 
+	var objtype;
+	var counter := 0;
+	
+	// Populate the array of items the vendor will buy.
+	foreach prodgroup in buys
+		foreach itemstr in GetConfigStringArray(FindConfigElem(mrcspawn_cfg, prodgroup), "Item")
+			itemstr := SplitWords(itemstr);
+			objtype := itemstr[1];
+			if(CInt(objtype))
+				objtype := CInt(objtype);
+			else
+				objtype := GetObjtypeByName(objtype);
+			endif
+			buynobuyable.append(objtype);
+		endforeach
+	endforeach
+	
+	// compare all the items in the top level of the backpack to things the vendor can buy and set the price.
+	if(buynobuyable.size())
+		foreach item in backpackitems
+			if((item.objtype in buynobuyable) && (!item.newbie))
+				counter := counter + 1;
+				if(!item.quality)
+					item.quality := 1;
+				endif
+				normcost := itemconfig[item.objtype].VendorBuysFor;
+				normsell := itemconfig[item.objtype].VendorSellsFor;
+				normcost := normcost * item.quality;
+				normsell := normsell * item.quality;
+				percentage := ((item.hp * 10) / item.maxhp);
+				if(percentage)
+					normcost := CInt((normcost * percentage) / 10);
+					normsell := CInt((normsell * percentage) / 10);
+					item.buyprice := normcost;
+					item.sellprice := normsell;
+				else
+					item.buyprice := itemmark;
+				endif
+			endif
+		endforeach
+	endif
+	return counter;
+endfunction
+
+/*
+function Merchants(merchantgroup)
+	var result := array;
+	var mrc := array;
+	mrc.+name;
+	mrc.+type;
+	var group_elem := FindConfigElem(mrcspawn_cfg, merchantgroup);
+	var count := GetConfigInt(group_elem, "MerchantCount" );
+	var i;
+	for( i := 1; i <= count; i := i + 1 )
+		mrc.name := GetConfigString(group_elem, "Merchant" + i);
+		mrc.type := GetConfigString(group_elem, "MerchantType"+i);
+		result[i] := mrc;
+	endfor
+	return result;
+endfunction
+*/
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/myUtil.inc
===================================================================
--- trunk/096/scripts/include/OLD/myUtil.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/myUtil.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,97 @@
+use cfgfile;
+
+//returns all the items in container of objtype
+function EnumerateItemsInContainerOfObjtype(container, objtype)
+
+	var ret := { };
+        foreach item in EnumerateItemsInContainer(container)
+		if ( item.objtype == objtype )
+			ret.append(item);
+		endif
+	endforeach
+
+	return ret;
+
+endfunction
+
+//returns all the 'top-level' items in container
+function ListRootItemsInContainer(container)
+
+	var ret := { };
+        foreach item in EnumerateItemsInContainer(container)
+		if ( item.container == container )
+			ret.append(item);
+		endif
+	endforeach
+
+	return ret;
+
+endfunction
+
+//returns all the 'top-level' items in container of objtype
+function ListRootItemsInContainerOfObjtype(container, objtype)
+
+	var ret := { };
+        foreach item in EnumerateItemsInContainer(container)
+		if ( (item.container == container) && (item.objtype == objtype) )
+			ret.append(item);
+		endif
+	endforeach
+
+	return ret;
+
+endfunction
+
+function InInventory(inventory, it)
+
+	foreach item in EnumerateItemsInContainer(inventory)
+		if (item == it)
+			return 1;
+		endif
+	endforeach
+
+	return 0;
+
+endfunction
+
+function IsContainer( it )
+
+	if (it.objtype == 0x7057)
+		return 0;//trashcans don't count as containers
+		         // random note- huh? trashcans are 0x7007...
+	endif
+
+	var waslocked := it.locked;
+	it.locked := 1;
+	if (it.locked)
+		it.locked := waslocked;
+		return 1;
+	else
+		return 0;
+	endif
+
+endfunction
+
+function IsDungeon( x, y )
+
+	if ( (x >= 5120) && (x <= 6143) )
+		if ( (y >= 0) && (y <= 2303) )
+			return 1;
+		endif
+	endif
+
+	return 0;
+
+endfunction
+
+function NoTeleportZone( x, y )
+
+	if ( (x >= 5120) && (x <= 6143) )
+		if ( (y >= 2080) && (y <= 2303) )
+			return 1;
+		endif
+	endif
+
+	return 0;
+
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/noto.inc
===================================================================
--- trunk/096/scripts/include/OLD/noto.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/noto.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,236 @@
+use uo;
+use util;
+use math;
+
+include ":attributes:attributes";
+
+var nototitles :=
+{
+    {"Outcast",     "Wretched",     "Nefarious", "Dread",         "Dread"},
+    {"Despicable",  "Dastardly",    "Wicked",    "Evil",          "Evil"},
+    {"Scoundrel",   "Malicious",    "Vile",      "Villainous",    "Dark"},
+    {"Unsavory",    "Dishonorable", "Ignoble",   "Sinister",      "Sinister"},
+    {"Rude",        "Disreputable", "Notorious", "Infamous",      "Dishonored"},
+    {"None",        "Notable",      "Prominent", "Reknowned",     ""},
+    {"Fair",        "Upstanding",   "Reputable", "Distinguished", "Distinguished"},
+    {"Kind",        "Respectable",  "Proper",    "Eminent",       "Eminent"},
+    {"Good",        "Honorable",    "Admirable", "Noble",         "Noble"},
+    {"Honest",      "Commendable",  "Famed",     "Illustrious",   "Illustrious"},
+    {"Trustworthy", "Estimable",    "Great",     "Glorious",      "Glorious"}
+};
+
+function AdjustNoto(attacker, defender)
+  if(attacker.isA(POLCLASS_NPC))
+    return;
+  endif
+  var karma   := CInt(GetObjProperty(attacker, "Karma"));
+  var fame    := CInt(GetObjProperty(attacker, "Fame"));
+  var dkarma  := CInt(GetObjProperty(defender, "Karma"));
+  var dfame   := CInt(GetObjProperty(defender, "Fame"));
+  var dfchk, dkchk;
+  if(defender.isA(POLCLASS_MOBILE))
+    dkarma := dkarma / 100.0;
+    dkchk := dkarma * 10;
+  elseif(!AP_GetStat(defender, "Strength"))
+    dkarma := dkarma * 10;
+    dkchk := dkarma * 10;
+    dkchk := 0 - dkchk;
+  endif
+  if(defender.isA(POLCLASS_MOBILE))
+    dfame := dfame / 100.0;
+    dfchk := dfame * 10;
+  elseif(!AP_GetStat(defender, "Strength"))
+    dfchk := dfame * 100;
+    dfame := dfame * 10;
+  endif
+  var kmod      := GetKarmaLevel(karma) - 6;
+  var fmod      := GetFameLevel(fame);
+  var dkmod     := GetKarmaLevel(dkchk) - 6;
+  var dfmod     := GetFameLevel(dfchk);
+  var famegain  := dfame;
+  var karmagain := (0 - dkarma);
+  var chk := 0;
+  if(karmagain >= 0)
+    chk := 1;
+  endif
+  if(Abs(kmod) > Abs(dkmod))
+    karmagain := 0;
+  elseif(Abs(kmod) == Abs(dkmod))
+    karmagain := Abs(karmagain) / 4;
+    if(chk == 0)
+      karmagain := (0 - karmagain);
+    endif
+  else
+    karmagain := Abs(karmagain) / 2;
+    var holder := 0;
+    case(dkmod - kmod)
+      1: holder := 0.15;
+      2: holder := 0.30;
+      3: holder := 0.45;
+      4: holder := 0.60;
+      5: holder := 0.75;
+      6: holder := 0.90;
+    endcase
+    karmagain := karmagain + CInt(karmagain * holder);
+    if(chk == 0)
+      karmagain := (0 - karmagain);
+    endif
+  endif
+  if(fmod == dfmod)
+    famegain := famegain / 4;
+  elseif(fmod > dfmod)
+    famegain := 0;
+  else
+    famegain := famegain / 2;
+  endif
+  if(defender.isA(POLCLASS_MOBILE))
+    famegain := famegain / 100;
+    karmagain := karmagain / 100;
+  endif
+  karma := karma + karmagain;
+  fame := fame + famegain;
+  var online := 0;
+  if(!attacker.isA(POLCLASS_NPC))
+    foreach char in EnumerateOnlineCharacters()
+      if(char == attacker)
+        online := 1;
+        break;
+      endif
+    endforeach
+    if(online == 1)
+      SetObjProperty(attacker, "Karma", karma);
+      SetObjProperty(attacker, "Fame", fame);
+      SendGainMessage(attacker, "Fame", famegain);
+      SendGainMessage(attacker, "Karma", karmagain);
+    else
+      SetObjProperty(attacker, "ModKarma", kmod);
+      SetObjProperty(attacker, "ModFame", famegain);
+    endif
+  else
+    SetObjProperty(attacker, "Karma", karma);
+    SetObjProperty(attacker, "Fame", fame);
+  endif
+  if(attacker.isA(POLCLASS_MOBILE))
+    SetNotoTitle(attacker, karma, fame);
+  endif
+  if(defender.isA(POLCLASS_MOBILE))
+    SetNotoTitle(defender, kmod, fmod);
+  endif
+endfunction
+
+function GetFameLevel(fame)
+  var fmod := 0;
+  if((fame <= 1249) && (fame >= 0))
+    fmod := 1;
+  elseif((fame <= 2499) && (fame >= 1250))
+    fmod := 2;
+  elseif((fame <= 4999) && (fame >= 2500))
+    fmod := 3;
+  elseif((fame <= 9999) && (fame >= 5000))
+    fmod := 4;
+  elseif(fame >= 10000)
+    fmod := 5;
+  endif
+  return fmod;
+endfunction
+
+function GetKarmaLevel(karma)
+  var kmod := 0;
+  if(karma <= -10000)
+    kmod := 1;
+  elseif((karma <= -5000) && (karma >= -9999))
+    kmod := 2;
+  elseif((karma <= -2500) && (karma >= -4999))
+    kmod := 3;
+  elseif((karma <= -1250) && (karma >= -2499))
+    kmod := 4;
+  elseif((karma <=  -625) && (karma >= -1249))
+    kmod := 5;
+  elseif((karma <=   624) && (karma >=  -624))
+    kmod := 6;
+  elseif((karma <=  1249) && (karma >=   625))
+    kmod := 7;
+  elseif((karma <=  2499) && (karma >=  1250))
+    kmod := 8;
+  elseif((karma <=  4999) && (karma >=  2500))
+    kmod := 9;
+  elseif((karma <=  9999) && (karma >=  5000))
+    kmod := 10;
+  elseif(karma >= 10000)
+    kmod := 11;
+  endif
+  return kmod;
+endfunction
+
+function SetNotoTitle(who, karma, fame)
+  var kmod := GetKarmaLevel(karma);
+  var fmod := GetFameLevel(fame);
+  var newtitle := nototitles[ (kmod) ];
+  
+  // That trailing space seems to be unneeded
+  //newtitle := "The " + CStr(newtitle[fmod]) + " ";
+  newtitle := "The " + CStr(newtitle[fmod]);
+  
+  if(newtitle["None"])
+    newtitle := "";
+  endif
+  if(fmod == 5)
+    if(who.gender == 1)
+      newtitle := newtitle + " Lady";
+    else
+      newtitle := newtitle + " Lord";
+    endif
+  endif
+  if(newtitle != who.title_prefix)
+    who.title_prefix := newtitle;
+    SendSysMessage(who, "You are now known as " + newtitle + " " + who.name);
+  endif
+endfunction
+
+function SendGainMessage(who, type, amount)
+  var msgtext := "You have ";
+  if(amount < 0)
+    msgtext := msgtext + "lost ";
+    amount := Abs(amount);
+  else
+    msgtext := msgtext + "gained ";
+  endif
+  if(amount > 150)
+    msgtext := msgtext + "a great amount of ";
+  elseif(amount > 125)
+    msgtext := msgtext + "a lot of ";
+  elseif(amount > 75)
+    msgtext := msgtext + "a good amount of ";
+  elseif(amount > 30)
+    msgtext := msgtext + "some ";
+  elseif(amount > 0)
+    msgtext := msgtext + "a little ";
+  else
+    return 0;
+  endif
+  msgtext := msgtext + type + ".";
+  SendSysMessage(who, msgtext);
+endfunction
+
+function ExceptionalFameMod(who, skill, diff, points)
+  if(skill > (diff - 20))
+    if((skill - diff) <= 5)
+      points := points;
+    elseif((skill - diff) <= 10)
+      points := (points * 3) / 4;
+    elseif((skill - diff) <= 15)
+      points := points / 2;
+    elseif((skill - diff) <= 20)
+      points := points / 4;
+    else
+      points := 0;
+    endif
+    points := CInt(points);
+    var fame := CInt(GetObjProperty(who, "Fame"));
+    var famegain := fame + points;
+    SetObjProperty(who, "Fame", famegain);
+
+    SendGainMessage(who, "fame", points);
+    SetNotoTitle(who, CInt(GetObjProperty(who, "Karma")), CInt(GetObjProperty(who, "Fame")));
+  endif
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/objtype.inc
===================================================================
--- trunk/096/scripts/include/OLD/objtype.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/objtype.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,220 @@
+/////////////////////////////////////////////////////////////////////////////
+//
+// include/objtype.inc - Object Type definitions
+//
+// TODO: consider moving these into include/client.inc
+//       or, moving CID_XX CONSTants in here
+//
+/////////////////////////////////////////////////////////////////////////////
+
+/////////////////////////////////////////////////////////////////////////////
+//
+// 0x0000 to 0x3FFF - "Standard" objects
+//
+/////////////////////////////////////////////////////////////////////////////
+
+CONST UOBJ_STONEWALL_NS := 0x005f;
+CONST UOBJ_STONEWALL_EW := 0x0060;
+CONST UOBJ_GUARDS       := 0xa340;
+CONST UOBJ_FISHSTEAK    := 0x097a;
+
+CONST UOBJ_BOX          := 0x09aa;
+
+CONST UOBJ_FISH_START   := 0x09cc;
+CONST UOBJ_FISH_END     := 0x09cf;
+
+CONST UOBJ_SFISH_START  := 0x0dd6;
+CONST UOBJ_SFISH_END    := 0x0dd9;
+
+CONST UOBJ_KINDLING     := 0x0de1;
+CONST UOBJ_CAMPFIRE     := 0x0de3;
+CONST UOBJ_EMBERS       := 0x0de9;
+CONST UOBJ_ASHES        := 0x0dea;
+
+CONST UOBJ_BANDAGE      := 0x0e21;
+CONST UOBJ_BLANK_SCROLL := 0x0e34;
+
+CONST UOBJ_BANKBOX      := 0x0e40;
+
+CONST UOBJ_DRUM         := 0x0e9c;
+CONST UOBJ_TAMB         := 0x0e9d;
+CONST UOBJ_HARP         := 0x0eb2;
+CONST UOBJ_LUTE         := 0x0eb3;
+
+CONST UOBJ_SPELLBOOK        := 0x0efa;
+
+CONST UOBJ_POISON_POTION    := 0x0f0a;
+CONST UOBJ_EMPTY_BOTTLE     := 0x0f0e;
+
+CONST UOBJ_GEM_START        := 0x0f0f;
+CONST UOBJ_GEM_END          := 0x0f30;
+
+CONST UOBJ_SHOVEL           := 0x0f39;
+
+CONST UOBJ_XBOW             := 0x0f4f;
+
+CONST UOBJ_BLUE_MOONGATE    := 0x0f6c;
+
+
+
+CONST UOBJ_CLAY             := 0xee19;
+CONST UOBJ_SAND             := 0xee18;
+
+
+
+
+CONST UOBJ_BLACK_PEARL      := 0x0f7a;
+CONST UOBJ_BLOOD_MOSS       := 0x0f7b;
+CONST UOBJ_BRIMSTONE        := 0x0f7f;
+CONST UOBJ_FERTILE_DIRT     := 0x0f81;
+CONST UOBJ_EXECUTIONERS_CAP := 0x0f83;
+CONST UOBJ_GARLIC           := 0x0f84;
+CONST UOBJ_GINSENG          := 0x0f85;
+CONST UOBJ_MANDRAKE_ROOT    := 0x0f86;
+CONST UOBJ_NIGHTSHADE       := 0x0f88;
+CONST UOBJ_OBSIDIAN         := 0x0f89;
+CONST UOBJ_PIG_IRON         := 0x0f8a;
+CONST UOBJ_SULFUROUS_ASH    := 0x0f8c; // CHECKME spelling
+CONST UOBJ_SPIDER_SILK      := 0x0f8d;
+CONST UOBJ_VOLCANIC_ASH     := 0x0f8f;
+
+CONST UOBJ_DEAD_WOOD    := 0x0f90;
+
+CONST UOBJ_CLOTH        := 0x0f95;
+CONST UOBJ_CLOTH_STARTS := 0x175d;
+CONST UOBJ_CLOTH_END    := 0x1768;
+CONST UOBJ_LOOM_START   := 0x105f;
+CONST UOBJ_LOOM_END     := 0x1066;
+CONST UOBJ_BOLT_START   := 0x0f95;
+CONST UOBJ_BOLT_END     := 0x0f9c;
+CONST UOBJ_THREAD_START := 0x0fa0;
+CONST UOBJ_THREAD_END   := 0x0fa1;
+CONST UOBJ_MUTLI_CLOTH  := 0x1766;
+CONST UOBJ_SEWING_KIT   := 0x0f9d;
+
+CONST UOBJ_ANVIL1       := 0x0faf;
+CONST UOBJ_ANVIL2       := 0x0fb0;
+CONST UOBJ_SMALL_FORGE  := 0xfb1;  // see also UOBJ_FORGE_START..UOBJ_FORGE_END
+CONST UOBJ_FORGE1       := 0x19a2;
+CONST UOBJ_FORGE2       := 0x19a6;
+CONST UOBJ_FORGE3       := 0x1982;
+CONST UOBJ_FORGE4       := 0x1996;
+CONST UOBJ_FORGE5       := 0x199a;
+CONST UOBJ_FORGE6       := 0x198e;
+CONST UOBJ_FORGE7       := 0x1992;
+CONST UOBJ_FORGE8       := 0x1986;
+CONST UOBJ_FORGE9       := 0x198a;
+
+CONST UOBJ_COPPER_KEY   := 0x100e;
+CONST UOBJ_GOLD_KEY     := 0x100f;
+CONST UOBJ_IRON_KEY     := 0x1010;
+CONST UOBJ_KEY_RING     := 0x1011;
+CONST UOBJ_MAGIC_KEY    := 0x1012;
+CONST UOBJ_RUSTY_IRON_KEY := 0x1013;
+
+CONST UOBJ_CLOCK   := 0x104c;
+CONST UOBJ_CLOCK_FRAME   := 0x104e;
+CONST UOBJ_CLOCK_PARTS   := 0x104f;
+CONST UOBJ_AXLE_AND_GEARS   := 0x1051;
+CONST UOBJ_GEARS   := 0x1053;
+CONST UOBJ_HINGE   := 0x1055;
+CONST UOBJ_SEXTANT   := 0x1057;
+CONST UOBJ_SEXTANT_PARTS   := 0x1059;
+CONST UOBJ_AXLE   := 0x105b;
+CONST UOBJ_SPRINGS   := 0x105d;
+
+CONST UOBJ_TDUMMYSWING_NS     := 0x1071;
+CONST UOBJ_TDUMMYFREEZE_NS    := 0x1070;
+CONST UOBJ_TDUMMYSWING_EW     := 0x1075;
+CONST UOBJ_TDUMMYFREEZE_EW    := 0x1074;
+
+CONST UOBJ_PDUMMYSWING_EW       := 0x1EC1;
+CONST UOBJ_PDUMMYFREEZE_EW      := 0x1EC0;
+CONST UOBJ_PDUMMYSWING_NS       := 0x1EC4;
+CONST UOBJ_PDUMMYFREEZE_NS      := 0x1EC3;
+
+CONST UOBJ_BLOOD        := 0x122d;
+
+CONST UOBJ_BOW          := 0x13b2;
+CONST UOBJ_HEAVY_XBOW   := 0x13fd;
+
+CONST UOBJ_MAP1         := 0x14eb;
+CONST UOBJ_MAP2         := 0x14ec;
+CONST UOBJ_ROLLED_MAP1  := 0x14ed;
+CONST UOBJ_ROLLED_MAP2  := 0x14ee;
+
+CONST UOBJ_HOUSE_DEED1  := 0x14ef;
+CONST UOBJ_SHIP_DEED1   := 0x14f1;
+CONST UOBJ_SHIP_DEED2   := 0x14f2;
+
+CONST UOBJ_CHEST        := 0x1940;
+
+CONST UOBJ_FORGE_START  := 0x197a;  // see also UOBJ_SMALL_FORGE
+CONST UOBJ_FORGE_END    := 0x19a9;
+
+CONST UOBJ_FEATHER      := 0x1bd1;
+CONST UOBJ_SHAFTS       := 0x1bd4;
+CONST UOBJ_LOGS         := 0x1bdd;
+
+CONST UOBJ_GLASS        := 0xee20;
+
+CONST UOBJ_ARM          := 0x1cec;
+CONST UOBJ_LEG          := 0x1ce2;
+CONST UOBJ_TRUNK        := 0x1cee;
+CONST UOBJ_HEART        := 0x1cef;
+CONST UOBJ_HEAD         := 0x1dae;
+
+CONST UOBJ_TINKER_TOOLS := 0x1ebc;
+
+
+CONST UOBJ_RUNE         := 0x1f14;
+
+CONST UOBJ_CORPSE       := 0x2006;
+
+CONST UOBJ_PARAFIELD_NS := 0x3967;
+CONST UOBJ_PARAFIELD_EW := 0x3979;
+CONST UOBJ_POISONFIELD_NS   := 0x3914;
+CONST UOBJ_POISONFIELD_EW   := 0x3920;
+CONST UOBJ_EFIELD_NS        := 0x3947;
+CONST UOBJ_EFIELD_EW        := 0x3956;
+
+CONST GID_PLANK_EXTENDED_FACING_WEST   := 0x3ed5;
+CONST GID_PLANK_RETRACTED_FACING_WEST  := 0x3eb1;
+CONST GID_PLANK_EXTENDED_FACING_EAST   := 0x3ed4;
+CONST GID_PLANK_RETRACTED_FACING_EAST  := 0x3eb2;
+CONST GID_PLANK_EXTENDED_FACING_SOUTH  := 0x3e84;
+CONST GID_PLANK_RETRACTED_FACING_SOUTH := 0x3e85;
+CONST GID_PLANK_EXTENDED_FACING_NORTH  := 0x3e89;
+CONST GID_PLANK_RETRACTED_FACING_NORTH := 0x3e8a;
+
+// ick! these are fine for humans, but not true for items..
+// these are more of a CID.
+CONST UOBJ_HUMAN_MALE   := 0x190;
+CONST UOBJ_HUMAN_FEMALE := 0x191;
+
+/////////////////////////////////////////////////////////////////////////////
+//
+// 0x4000 to 0x4FFF - Multis
+//
+/////////////////////////////////////////////////////////////////////////////
+
+/////////////////////////////////////////////////////////////////////////////
+//
+// 0x5000 to 0xEFFF - To Be Determined
+//
+/////////////////////////////////////////////////////////////////////////////
+
+
+/////////////////////////////////////////////////////////////////////////////
+//
+// 0xF000 to 0xFFFF - Reserved by system
+//
+/////////////////////////////////////////////////////////////////////////////
+
+        //
+        // Ship Components
+        //
+CONST EXTOBJ_TILLERMAN       := 0xf010;
+CONST EXTOBJ_PORT_PLANK      := 0xf011;
+CONST EXTOBJ_STARBOARD_PLANK := 0xf012;
+CONST EXTOBJ_HOLD            := 0xf013;

Added: trunk/096/scripts/include/OLD/recallRune.inc
===================================================================
--- trunk/096/scripts/include/OLD/recallRune.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/recallRune.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,48 @@
+use uo;
+use os;
+
+function Rename_Rune(who,rune)
+        if (GetObjProperty( rune, "x" ) == error)
+                SendSysMessage( who, "That rune is not marked." );
+                return;
+        endif
+
+	var mark := CInt(GetObjProperty( rune, "mark" ));
+        var descrip := "a ";
+
+	if (mark<4)
+               	if (mark<2)
+               		descrip := descrip + "nearly blanked";
+       		else
+               		descrip := descrip + "worn";
+       		endif
+       	endif
+
+	if (GetObjProperty( rune, "Place" ) == error)
+       		rune.name := descrip + " marked recall rune";
+	else
+		rune.name := descrip + " rune for " + GetObjProperty( rune, "Place" );
+        endif
+
+endfunction
+
+
+// chance is the #/10 for the rune to blank
+function Blank_Rune(who,rune,chance)
+        var mark := CInt(GetObjProperty( rune, "mark" ));
+
+	if (mark<1) // non initialized rune
+		mark := 6; // make it full (lucky guy !)
+		SetObjProperty(rune,"mark",mark);
+	endif
+
+        if (RandomInt(10)<chance)  // Rune is blanking
+                mark := mark - 1;
+		SetObjProperty(rune,"mark",mark);
+                if (mark == 0)
+                        DestroyItem(rune);
+                else
+			Rename_Rune(who,rune);
+		endif
+	endif
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/reportMurder.inc
===================================================================
--- trunk/096/scripts/include/OLD/reportMurder.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/reportMurder.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,116 @@
+use uo;
+use os;
+
+//include "include/bounty";
+include ":gumps:include/gumps";
+include ":datafile:datafile";
+
+const LONG_COUNT_DECAY_TIME := 144000; //40 hours
+const SHORT_COUNT_DECAY_TIME := 28800; //8 hours
+
+//var reportables;
+//var reportdata := array{};
+
+function SendReportGump(who)
+	var reportables := who.reportables;
+	var report_data := array{};
+	
+	var gump := GFCreateGump();
+	GFPage(gump, 0);
+	GFDisposable(gump, 0);
+	GFClosable(gump, 0);
+	GFMovable(gump, 0);
+	GFResizePic(gump, 0, 0, 2600, 480, 480);
+	GFAddButton(gump, 380, 345, 249, 248, 1, 99);
+	GFTextLine(gump, 50, 20, 0, "Now is the time for retribution!");
+	GFTextLine(gump, 50, 50, 0, "Check zero or more players to report for your murder");
+	GFTextLine(gump, 50, 70, 0, "and press OKAY");
+	
+	FillInArrays(reportables, report_data, gump);
+	
+	SetObjProperty(who, "ReportMenu", report_data);
+	
+	var ret := GFSendGump(who, gump);
+	if( ret == 0 )
+		return;
+	endif
+	
+	EraseObjProperty(who, "ReportMenu");
+	EraseObjProperty(who, "LoginReport");
+	
+	var holder := array{};
+	foreach id in (ret.keys)
+		if( id in report_data )
+			var mob := SystemFindObjectBySerial(id, SYSFIND_SEARCH_OFFLINE_MOBILES);
+			if( !mob.ip )
+				SetObjProperty(mob.killer, "LoginNotify", who.serial);
+			else
+				AdjustNoto(mob, who);
+			endif
+			
+			holder.append(id);
+			AdjustMurderCounts(mob.killer);
+		endif
+		sleepms(2);
+	endforeach
+	
+	foreach reportable in (who.reportables)
+		who.removeReportable(reportable.serial, reportable.gameclock);
+		sleepms(2);
+	endforeach
+	
+	var parms := array{who, holder};
+	var script := start_script(":bountyboard:bounty", parms);
+	if ( script.errortext )
+		SysLog("ERROR SendReportGump():: Unable to start :bountyboard:bounty ->"+script.errortext);
+		return error;
+	endif
+	
+	return 1;
+endfunction
+
+function FillInArrays(reportables, byref report_data, byref gump)
+	var prev_y := 80;
+	var buttonret := 10;
+	GFPage(gump, 1);
+	foreach reportable in reportables
+		if( !(reportable.killer).cmdlevel )
+			if( buttonret == 21 )
+				prev_y := 80;
+			endif
+			report_data.append((reportable.killer).serial);
+			GFCheckBox(gump, 40, prev_y+20, 210, 211, 0, (reportable.killer).serial);
+			GFTextLine(gump, 60, prev_y+20, 0, (reportable.killer).name);
+			prev_y := prev_y+20;
+			buttonret := buttonret+1;
+		endif
+		
+		sleepms(2);
+	endforeach
+	
+	return 1;
+endfunction
+
+function AdjustMurderCounts(killer)
+	var onlinetime := GetObjProperty(killer, "onlinetimer");
+	var longcount := GetObjProperty(killer, "longmurders");
+	
+	if( !longcount )
+		longcount := 0;
+	endif
+	
+	longcount := longcount + 1;
+	SetObjProperty(killer, "longmurders", longcount);
+	
+	if( longcount > 4 )
+		killer.setMurderer(1);
+		SendSysMessage(killer, "You are now known as a murderer!");
+	endif
+	
+	SetObjProperty(killer, "decaylongcountat", (onlinetime+LONG_COUNT_DECAY_TIME));
+	
+	var shortcount := CInt(GetObjProperty(killer, "shortmurders"));
+	shortcount := shortcount + 1;
+	SetObjProperty(killer, "shortmurders", shortcount);
+	SetObjProperty(killer, "decayshortcountat", (onlinetime+SHORT_COUNT_DECAY_TIME));
+endfunction

Added: trunk/096/scripts/include/OLD/resurrection.inc
===================================================================
--- trunk/096/scripts/include/OLD/resurrection.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/resurrection.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,80 @@
+/*
+ * $Id: resurrection.inc 693 2005-10-29 06:45:26Z muaddiblsd $
+ *
+ * Uhh what the fuck is this anyway?
+ *
+ */
+
+use uo;
+use os;
+
+include ":attributes:attributes";
+include ":gumps:gumps";
+
+const MAXIMUM_LOSS := 0.20; //20% loss for 20 shortterm murders or more
+
+function ResNow(mobile)
+
+	var gump := GFCreateGump();
+	GFClosable(gump, 0);
+	GFGumpPic(gump, 300, 230, 2070);
+	GFAddButton(gump, 330, 305, 2073, 2072, GF_CLOSE_BTN, 10);
+	GFAddButton(gump, 400, 305, 2076, 2075, GF_CLOSE_BTN, 11);
+	GFTextLine(gump, 332, 264, 40, "Resurrect Now?");
+
+	var input := GFSendGump(mobile, gump);
+	input := input[0];
+	input := input-10;
+
+	if ( !input )
+		return 0;
+	else
+		return 1;
+	endif
+
+endfunction
+
+function MurdererStatLoss(who)
+
+	var shortc := GetObjProperty(who,"shortmurders");
+	if( !shortc )
+		return 0;
+	endif
+
+	if( shortc > 4 )
+		var multiplier := CInt(shortc)/100.0;
+		if( multiplier > MAXIMUM_LOSS )
+			multiplier := MAXIMUM_LOSS;
+		endif
+
+		multiplier := 1.0 - multiplier;
+
+		var str := AP_GetTrueStat(who, "strength");
+		var dex := AP_GetTrueStat(who, "dexterity");
+		var inte := AP_GetTrueStat(who, "intelligence");
+
+		str := CInt(str * multiplier);
+		dex := CInt(dex * multiplier);
+		inte := CInt(inte * multiplier);
+
+		AP_SetTrueStat(who, "strength", str);
+		AP_SetTrueStat(who, "dexterity", dex);
+		AP_SetTrueStat(who, "intelligence", inte);
+
+		AP_SetVital(who, "hits", AP_GetVitalMaximumValue(who, "hits"));
+		AP_SetVital(who, "stamina", AP_GetVitalMaximumValue(who, "stamina"));
+		AP_SetVital(who, "mana", AP_GetVitalMaximumValue(who, "mana"));
+
+		var newval;
+
+		foreach entry in (AP_ListAttributesByType("skill"))
+			var skill_level := AP_GetTrueSkill(who, entry);
+			if( skill_level > 0.0 )
+				newval := skill_level * multiplier;
+				AP_SetTrueSkill(who, entry, newval);
+			endif
+		endforeach
+		SendSysMessage(who,"Thy body pays the price for thy sins.");
+	endif
+
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/selChar.inc
===================================================================
--- trunk/096/scripts/include/OLD/selChar.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/selChar.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,133 @@
+/////////////////////////////////////////////////////////////////////////////
+//
+// selchar.inc: 
+//
+// SelectOnlineCharacter( selector, charname, action )
+//
+// if charname is blank, prompts selector with a dialog box
+// 'action' is the text displayed above the column of buttons
+//
+/////////////////////////////////////////////////////////////////////////////
+
+use uo;
+
+
+function SelectOnlineCharacter( selector, charname, action )
+
+  if(!charname)
+
+    return SelectCharacterFromDialog( selector, "Goto" );
+  else
+    //print (who.name + " wants to visit " + whom);
+
+    charname := upper(charname);
+
+    foreach onlinechr in EnumerateOnlineCharacters()
+        if (upper(onlinechr.name) == charname)
+            return onlinechr;
+        endif
+    endforeach
+
+    return 0;
+
+  endif
+
+endfunction
+
+
+var playercount := 0;
+var pagecount := 1;
+
+var layout := array(
+
+"page 0",
+"nodispose",
+"gumppic 0 50 2620",
+"gumppic 20 50 2621",
+"gumppic 290 50 2622",
+"gumppic 0 68 2623",
+"gumppic 22 68 2624",
+"gumppic 288 68 2625",
+"gumppic 0 272 2623",
+"gumppic 22 272 2624",
+"gumppic 288 272 2625",
+"gumppic 0 476 2626",
+"gumppic 20 476 2627",
+"gumppic 290 476 2628",
+"gumppic 20 80 2621",   
+
+"text 20 59 40 0",
+"text 260 59 40 1"
+);
+
+var data := array(
+       "Player Name",         //0
+       "[action]"
+);
+
+
+function SelectCharacterFromDialog( selector, action )
+
+    var players := EnumerateOnlineCharacters();
+    var datalen;
+    var layoutlen;
+    var prev_y := CInt(80);
+    var datindx;
+    var buttonret := 1;
+   
+
+    layout[GetLayoutLength()+1] := "page " + pagecount;
+    if( len(players) > 19)
+        layout[GetLayoutLength()+1] := "button 285 465 2648 2647 0 " + (pagecount + 1);
+    endif
+
+    data[2] := action;
+
+    foreach player in players
+        playercount := playercount + 1;
+
+        datalen := GetDataLength();
+        layoutlen := GetLayoutLength();
+
+        datindx := datalen+1;
+        data[datindx] := player.name;
+        if( playercount == 20 || playercount == 39 || playercount == 58 || playercount == 77 || playercount == 96)
+
+            pagecount := pagecount + 1;
+            layout[GetLayoutLength()+1] := "page " + pagecount;
+            prev_y := 80;
+            //add page turners
+
+            layout[GetLayoutLength()+1] := "button 285 85 2650 2651 0 " + (pagecount - 1);
+            if( len(players) > playercount + 19)
+                layout[GetLayoutLength()+1] := "button 285 465 2648 2647 0 " + (pagecount + 1);
+            endif
+        endif
+
+        layout[GetLayoutLength()+1] := ("text 20 " + CStr(prev_y + 20) + " 40 " + datalen);
+        layout[GetLayoutLength()+1] := ("button 260 " + CStr(prev_y + 20) + " 2640 2641 1 0 " + buttonret);
+
+        prev_y := prev_y + 20;
+        buttonret := buttonret + 1;
+    endforeach
+
+    var result := SendDialogGump( selector, layout, data );
+
+    if (result)
+        return players[ result[0] ];
+    else
+        return 0;
+    endif
+   
+
+endfunction
+
+
+function GetLayoutLength();
+    return (len(layout));
+endfunction
+
+function GetDataLength();
+    return (len(data));
+endfunction
+

Added: trunk/096/scripts/include/OLD/skillLists.inc
===================================================================
--- trunk/096/scripts/include/OLD/skillLists.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/skillLists.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,99 @@
+function getskilllist(me)
+  var mytemplate := lower(GetObjProperty(me, "MerchantType"));
+  case(mytemplate)
+    "healer":           return { "spiritspeaking", "healing", "anatomy", "camping", "fishing", "forensic evaluation" };
+    "stable":           return { "animal lore", "animal taming", "veterinary" };
+    "shipWright":       return { "wrestling", "tactics" };
+    "fisherman":        return { "fishing", "fencing" };
+    "innkeeper":        return { "fencing", "tactics" };
+    "farmer":           return { "swordsmanship", "animal lore", "herding", "veterinary" };
+    "weaponsmith":      return { "swordsmanship", "arms lore", "blacksmithy", "mining", "parrying", "tactics" };
+    "blacksmith":       return { "swordsmanship", "arms lore", "blacksmithy", "mining", "parrying", "tactics" };
+    "Armorer":          return { "mace fighting", "arms lore", "blacksmithy", "mining", "parrying", "tactics" };
+    "barkeep":          return { "mace fighting", "tactics" };
+    "barmaid":          return { "fencing", "tactics" };
+    "baker":            return { "wrestling", "cooking" };
+    "tinker":           return { "fencing", "alchemy", "lockpicking", "tinkering" };
+    "bard":             return { "fencing", "enticement", "musicianship", "provocation", "peacemaking" };
+    "butcher":          return { "mace fighting", "cooking", "taste identification" };
+    "cobbler":          return { "swordsmanship", "tailoring" };
+    "jeweler":          return { "fencing", "item identification" };
+    "mage":             return { "magic resistance", "inscription", "magery", "meditation", "wrestling" };
+    "Alchemist":        return { "magic resistance", "taste identification", "alchemy", "wrestling" };
+    "herbalist":        return { "magic resistance", "alchemy", "cooking", "taste identification", "wrestling" };
+    "tailor":           return { "tailoring", "fencing" };
+    "weaver":           return { "tailoring", "fencing" };
+    "leatherworker":    return { "parrying", "mace fighting" };
+    "provisioner":      return { "tactics", "parrying", "fencing" };
+    "carpenter":        return { "carpentry", "lumberjacking", "swordsmanship" };
+    "bowyer":           return { "archery", "bowcraft", "fencing" };
+    "architect":        return { "magic resistance", "wrestling" };
+    "scribe":           return { "magic resistance", "evaluating intelligence", "wrestling" };
+    "mapmaker":         return { "cartography", "wrestling" };
+    "vetrinarian":      return { "animal lore", "wrestling", "veterinary" };
+    "townguard":        return { "anatomy", "tactics", "swordsmanship", "detect hidden", "arms lore" };
+    "thief":            return { "snooping", "stealing", "remove trap", "stealth", "fencing", "poisoning", "lockpicking", "hiding" };
+    "beggar":           return { "begging", "wrestling", "cooking", "fishing" };
+    "fighter1":         return { "anatomy", "tactics", "swordsmanship", "arms lore" };
+    "fighter2":         return { "anatomy", "tactics", "swordsmanship", "arms lore" };
+    "fighter3":         return { "anatomy", "tactics", "swordsmanship", "arms lore" };
+    "fighter4":         return { "anatomy", "tactics", "swordsmanship", "arms lore" };
+    "paladin":          return { "anatomy", "tactics", "swordsmanship", "detect hidden", "arms lore" };
+    "artist":
+  endcase
+endfunction
+
+function FindSkillId(name)
+  case(name)
+    "alchemy":                  return  0;
+    "anatomy":                  return  1;
+    "animal lore":              return  2;
+    "item identification":      return  3;
+    "arms lore":                return  4;
+    "parrying":                 return  5;
+    "begging":                  return  6;
+    "blacksmithy":              return  7;
+    "bowcraft":                 return  8;
+    "peacemaking":              return  9;
+    "camping":                  return 10;
+    "carpentry":                return 11;
+    "cartography":              return 12;
+    "cooking":                  return 13;
+    "detect hidden":            return 14;
+    "enticement":               return 15;
+    "evaluating intelligence":  return 16;
+    "healing":                  return 17;
+    "fishing":                  return 18;
+    "forensic evaluation":      return 19;
+    "herding":                  return 20;
+    "hiding":                   return 21;
+    "provocation":              return 22;
+    "inscription":              return 23;
+    "lockpicking":              return 24;
+    "magery":                   return 25;
+    "magic resistance":         return 26;
+    "tactics":                  return 27;
+    "snooping":                 return 28;
+    "musicianship":             return 29;
+    "poisoning":                return 30;
+    "archery":                  return 31;
+    "spiritspeaking":           return 32;
+    "stealing":                 return 33;
+    "tailoring":                return 34;
+    "animal taming":            return 35;
+    "taste identification":     return 36;
+    "tinkering":                return 37;
+    "tracking":                 return 38;
+    "veterinary":               return 39;
+    "swordsmanship":            return 40;
+    "mace fighting":            return 41;
+    "fencing":                  return 42;
+    "wrestling":                return 43;
+    "lumberjacking":            return 44;
+    "mining":                   return 45;
+    "meditation":               return 46;
+    "stealth":                  return 47;
+    "remove trap":              return 48;
+  endcase
+endfunction
+ 
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/snooping.inc
===================================================================
--- trunk/096/scripts/include/OLD/snooping.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/snooping.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,7 @@
+include ":attributes:attributes";
+
+function snoop(who, victim)
+  victim := victim; // stops "var not used" ecompile warning
+  SendSysMessage(who, "Snooping not implemented yet.");
+  return;
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/sorting.inc
===================================================================
--- trunk/096/scripts/include/OLD/sorting.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/sorting.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,20 @@
+use uo;
+use os;
+use cfgfile;
+
+function bubble_sort_array(data, pos)
+  var i := 1;
+  var l := len(data);
+  for(i:=1; i<=l; i:=i+1)
+    var ind := data[i];
+    var j := i;
+    while((j > 0) && (data[j-1][pos] > ind[pos]))
+      data[j] := data[j-1];
+      j := j - 1;
+      sleepms(1);
+    endwhile
+    data[j] := ind;
+    sleepms(1);
+  endfor
+  return data;
+endfunction

Added: trunk/096/scripts/include/OLD/sound.inc
===================================================================
--- trunk/096/scripts/include/OLD/sound.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/sound.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,711 @@
+/* $Id: sound.inc 236 2005-09-25 09:06:19Z panosl $
+ *
+ */
+
+enum SFX_BASE
+	SFX_1     :=  0x0001, // forest
+	SFX_2     :=  0x0002, // forest
+	SFX_3     :=  0x0003, // forest
+	SFX_4     :=  0x0004, // jungle
+	SFX_5     :=  0x0005, // jungle
+	SFX_6     :=  0x0006, // jungle
+	SFX_7     :=  0x0007, // swamp
+	SFX_8     :=  0x0008, // swamp
+	SFX_9     :=  0x0009, // forest
+	SFX_A     :=  0x000a, // forest
+	SFX_B     :=  0x000b, // generic
+	SFX_C     :=  0x000c, // generic
+	SFX_D     :=  0x000d, // jungle
+	SFX_E     :=  0x000e, // jungle
+	SFX_F     :=  0x000f, // swamp
+	SFX_10    :=  0x0010, // swamp
+	SFX_11    :=  0x0011, // water
+	SFX_12    :=  0x0012, // water
+	SFX_13    :=  0x0013, // waves
+	SFX_14    :=  0x0014, // waves
+	SFX_15    :=  0x0015, // wind
+	SFX_16    :=  0x0016, // wind
+	SFX_17    :=  0x0017, // wind
+	SFX_18    :=  0x0018, // bird
+	SFX_19    :=  0x0019, // bird
+	SFX_1A    :=  0x001a, // bird
+	SFX_1B    :=  0x001b, // bird
+	SFX_1C    :=  0x001c, // bird
+	SFX_1D    :=  0x001d, // bird
+	SFX_1E    :=  0x001e, // bird
+	SFX_1F    :=  0x001f, // bird
+	SFX_20    :=  0x0020, // bird
+	SFX_21    :=  0x0021, // bubbles
+	SFX_22    :=  0x0022, // bubbles
+	SFX_23    :=  0x0023, // dripping
+	SFX_24    :=  0x0024, // dripping
+	SFX_25    :=  0x0025, // dripping
+	SFX_26    :=  0x0026, // splashing
+	SFX_27    :=  0x0027, // splashing
+	SFX_28    :=  0x0028, // splashing
+	SFX_29    :=  0x0029, // thundr01.wav, thunder
+	SFX_2A    :=  0x002a, // thundr02.wav, thunder
+	SFX_2B    :=  0x002b, // anvil.wav, anvil
+	SFX_2C    :=  0x002c, // bellows.wav, bellows
+	SFX_2D    :=  0x002d, // chstcls3.wav, chest close
+	SFX_2E    :=  0x002e, // chstopn2.wav, chest open
+	SFX_2F    :=  0x002f, // drawercl.wav, drawer close
+	SFX_30    :=  0x0030, // drawerop.wav, drawer open
+	SFX_31    :=  0x0031, // drink01.wav, drink
+	SFX_32    :=  0x0032, // drink05.wav, drink
+	SFX_33    :=  0x0033, // dropgem1.wav, drop gem
+	SFX_34    :=  0x0034, // dropgem2.wav, drop gem
+	SFX_35    :=  0x0035, // dropgem3.wav, drop gem
+	SFX_36    :=  0x0036, // dropmny1.wav, drop money
+	SFX_37    :=  0x0037, // dropmny2.wav, drop money
+	SFX_38    :=  0x0038, // dropmny3.wav, drop money
+	SFX_39    :=  0x0039, // drum01.wav, drum
+	SFX_3A    :=  0x003a, // drum01_b.wav, drum
+	SFX_3B    :=  0x003b, // eat01.wav, eat
+	SFX_3C    :=  0x003c, // eat03.wav, eat
+	SFX_3D    :=  0x003d, // eat06.wav,eat
+	SFX_3E    :=  0x003e, // flute01.wav, flute
+	SFX_3F    :=  0x003f, // glasbrk1.wav, glassbreak
+	SFX_40    :=  0x0040, // glasbrk2.wav, glassbreak
+	SFX_41    :=  0x0041, // glasbrk3.wav, glassbreak
+	SFX_42    :=  0x0042, // glasbrk4.wav, glassbreak
+	SFX_43    :=  0x0043, // hamer01.wav, hammer
+	SFX_44    :=  0x0044, // harp01.wav, harp
+	SFX_45    :=  0x0045, // harp01_b.wav, harp
+	SFX_46    :=  0x0046, // harp02.wav, harp
+	SFX_47    :=  0x0047, // harp02_b.wav, harp
+	SFX_48    :=  0x0048, // igntorch.wav, ignite torch
+	SFX_49    :=  0x0049, // leather1.wav, leather
+	SFX_4A    :=  0x004a, // lever01.wav, lever
+	SFX_4B    :=  0x004b, // lever02.wav, lever
+	SFX_4C    :=  0x004c, // lever05.wav, lever
+	SFX_4D    :=  0x004d, // lute01.wav, lute
+	SFX_4E    :=  0x004e, // lute01_b.wav, lute
+	SFX_4F    :=  0x004f, // pouring.wav, pouring
+	SFX_50    :=  0x0050, // rustle.wav, rustle
+	SFX_51    :=  0x0051, // swallow2.wav, swallow
+	SFX_52    :=  0x0052, // switch01.wav, switch
+	SFX_53    :=  0x0053, // tamborin.wav, tamborine
+	SFX_54    :=  0x0054, // tambrn_b.wav, tamborine
+	SFX_55    :=  0x0055, // torch01.wav, torch
+	SFX_56    :=  0x0056, // turnpage.wav, turn page
+	SFX_57    :=  0x0057, // unsheth1.wav, ?
+	SFX_58    :=  0x0058, // usecloth.wav, use cloth
+	SFX_59    :=  0x0059, // uselethr.wav, use leather
+	SFX_5A    :=  0x005a, // uselthr1.wav, use leather
+	SFX_5B    :=  0x005b, // aligatr1.wav, alligator
+	SFX_5C    :=  0x005c, // aligatr2.wav, alligator
+	SFX_5D    :=  0x005d, // aligatr3.wav, alligator
+	SFX_5E    :=  0x005e, // aligatr4.wav, alligator
+	SFX_5F    :=  0x005f, // aligatr5.wav, alligator
+	SFX_60    :=  0x0060, // bear1.wav, bear
+	SFX_61    :=  0x0061, // bear2.wav, bear
+	SFX_62    :=  0x0062, // bear3.wav, bear
+	SFX_63    :=  0x0063, // bear4.wav, bear
+	SFX_64    :=  0x0064, // bear5.wav, bear
+	SFX_65    :=  0x0065, // bull1.wav, bull
+	SFX_66    :=  0x0066, // bull2.wav, bull
+	SFX_67    :=  0x0067, // bull3.wav, bull
+	SFX_68    :=  0x0068, // bull4.wav, bull
+	SFX_69    :=  0x0069, // bull5.wav, bull
+	SFX_6A    :=  0x006a, // cat1.wav
+	SFX_6B    :=  0x006b, // cat2.wav
+	SFX_6C    :=  0x006c, // cat3.wav
+	SFX_6D    :=  0x006d, // cat4.wav
+	SFX_6E    :=  0x006e, // cat5.wav
+	SFX_6F    :=  0x006f, // chicken1.wav
+	SFX_70    :=  0x0070, // chicken2.wav
+	SFX_71    :=  0x0071, // chicken3.wav
+	SFX_72    :=  0x0072, // chicken4.wav
+	SFX_73    :=  0x0073, // chicken5.wav
+	SFX_74    :=  0x0074, // cougar1.wav
+	SFX_75    :=  0x0075, // cougar2.wav
+	SFX_76    :=  0x0076, // cougar3.wav
+	SFX_77    :=  0x0077, // cougar4.wav
+	SFX_78    :=  0x0078, // cougar5.wav
+	SFX_79    :=  0x0079, // cow1.wav
+	SFX_7A    :=  0x007a, // cow2.wav
+	SFX_7B    :=  0x007b, // cow3.wav
+	SFX_7C    :=  0x007c, // cow4.wav
+	SFX_7D    :=  0x007d, // cow5.wav
+	SFX_7E    :=  0x007e, // crow1.wav
+	SFX_7F    :=  0x007f, // crow2.wav
+	SFX_80    :=  0x0080, // crow3.wav
+	SFX_81    :=  0x0081, // crow4.wav
+	SFX_82    :=  0x0082, // crow5.wav
+	SFX_83    :=  0x0083, // deer3.wav
+	SFX_84    :=  0x0084, // deer4.wav
+	SFX_85    :=  0x0085, // deer5.wav
+	SFX_86    :=  0x0086, // dog1.wav
+	SFX_87    :=  0x0087, // dog2.wav
+	SFX_88    :=  0x0088, // dog3.wav
+	SFX_89    :=  0x0089, // dog4.wav
+	SFX_8A    :=  0x008a, // dog5.wav
+	SFX_8B    :=  0x008b, // dolphin1.wav
+	SFX_8C    :=  0x008c, // dolphin2.wav
+	SFX_8D    :=  0x008d, // dolphin3.wav
+	SFX_8E    :=  0x008e, // dolphin4.wav
+	SFX_8F    :=  0x008f, // dolphin5.wav
+	SFX_90    :=  0x0090, // eagle1.wav
+	SFX_91    :=  0x0091, // eagle2.wav
+	SFX_92    :=  0x0092, // eagle3.wav
+	SFX_93    :=  0x0093, // eagle4.wav
+	SFX_94    :=  0x0094, // eagle5.wav
+	SFX_95    :=  0x0095, // frstbrd1.wav
+	SFX_96    :=  0x0096, // frstbrd2.wav
+	SFX_97    :=  0x0097, // frstbrd3.wav
+	SFX_98    :=  0x0098, // frstbrd4.wav
+	SFX_99    :=  0x0099, // frstbrd5.wav
+	SFX_9A    :=  0x009a, // goat1.wav
+	SFX_9B    :=  0x009b, // goat2.wav
+	SFX_9C    :=  0x009c, // goat3.wav
+	SFX_9D    :=  0x009d, // goat4.wav
+	SFX_9E    :=  0x009e, // goat5.wav
+	SFX_9F    :=  0x009f, // gorilla1.wav
+	SFX_A0    :=  0x00a0, // gorilla2.wav
+	SFX_A1    :=  0x00a1, // gorilla3.wav
+	SFX_A2    :=  0x00a2, // gorilla4.wav
+	SFX_A3    :=  0x00a3, // gorilla5.wav
+	SFX_A4    :=  0x00a4, // grizzly1.wav
+	SFX_A5    :=  0x00a5, // grizzly2.wav
+	SFX_A6    :=  0x00a6, // grizzly3.wav
+	SFX_A7    :=  0x00a7, // grizzly4.wav
+	SFX_A8    :=  0x00a8, // grizzly5.wav
+	SFX_A9    :=  0x00a9, // horse1.wav
+	SFX_AA    :=  0x00aa, // horse2.wav
+	SFX_AB    :=  0x00ab, // horse3.wav
+	SFX_AC    :=  0x00ac, // horse4.wav
+	SFX_AD    :=  0x00ad, // horse5.wav
+	SFX_AE    :=  0x00ae, // jungbrd1.wav
+	SFX_AF    :=  0x00af, // jungbrd2.wav
+	SFX_B0    :=  0x00b0, // jungbrd3.wav
+	SFX_B1    :=  0x00b1, // jungbrd4.wav
+	SFX_B2    :=  0x00b2, // jungbrd5.wav
+	SFX_B3    :=  0x00b3, // lion1.wav
+	SFX_B4    :=  0x00b4, // lion2.wav
+	SFX_B5    :=  0x00b5, // lion3.wav
+	SFX_B6    :=  0x00b6, // lion4.wav
+	SFX_B7    :=  0x00b7, // lion5.wav
+	SFX_B8    :=  0x00b8, // llama3.wav
+	SFX_B9    :=  0x00b9, // llama4.wav
+	SFX_BA    :=  0x00ba, // llama5.wav
+	SFX_BB    :=  0x00bb, // panther1.wav
+	SFX_BC    :=  0x00bc, // panther2.wav
+	SFX_BD    :=  0x00bd, // panther3.wav
+	SFX_BE    :=  0x00be, // panther4.wav
+	SFX_BF    :=  0x00bf, // panther5.wav
+	SFX_C0    :=  0x00c0, // parrot1.wav
+	SFX_C1    :=  0x00c1, // parrot2.wav
+	SFX_C2    :=  0x00c2, // parrot3.wav
+	SFX_C3    :=  0x00c3, // parrot4.wav
+	SFX_C4    :=  0x00c4, // parrot5.wav
+	SFX_C5    :=  0x00c5, // pig1.wav
+	SFX_C6    :=  0x00c6, // pig2.wav
+	SFX_C7    :=  0x00c7, // pig3.wav
+	SFX_C8    :=  0x00c8, // pig4.wav
+	SFX_C9    :=  0x00c9, // pig5.wav
+	SFX_CA    :=  0x00ca, // rabbit3.wav
+	SFX_CB    :=  0x00cb, // rabbit4.wav
+	SFX_CC    :=  0x00cc, // rabbit5.wav
+	SFX_CD    :=  0x00cd, // rat1.wav
+	SFX_CE    :=  0x00ce, // rat2.wav
+	SFX_CF    :=  0x00cf, // rat3.wav
+	SFX_D0    :=  0x00d0, // rat4.wav
+	SFX_D1    :=  0x00d1, // rat5.wav
+	SFX_D2    :=  0x00d2, // raven1.wav
+	SFX_D3    :=  0x00d3, // raven2.wav
+	SFX_D4    :=  0x00d4, // raven3.wav
+	SFX_D5    :=  0x00d5, // raven4.wav
+	SFX_D6    :=  0x00d6, // raven5.wav
+	SFX_D7    :=  0x00d7, // sheep1.wav
+	SFX_D8    :=  0x00d8, // sheep2.wav
+	SFX_D9    :=  0x00d9, // sheep3.wav
+	SFX_DA    :=  0x00da, // sheep4.wav
+	SFX_DB    :=  0x00db, // sheep5.wav
+	SFX_DC    :=  0x00dc, // snake1.wav
+	SFX_DD    :=  0x00dd, // snake2.wav
+	SFX_DE    :=  0x00de, // snake3.wav
+	SFX_DF    :=  0x00df, // snake4.wav
+	SFX_E0    :=  0x00e0, // snake5.wav
+	SFX_E1    :=  0x00e1, // walrus1.wav
+	SFX_E2    :=  0x00e2, // walrus2.wav
+	SFX_E3    :=  0x00e3, // walrus3.wav
+	SFX_E4    :=  0x00e4, // walrus4.wav
+	SFX_E5    :=  0x00e5, // walrus5.wav
+	SFX_E6    :=  0x00e6, // wolf1.wav
+	SFX_E7    :=  0x00e7, // wolf2.wav
+	SFX_E8    :=  0x00e8, // wolf3.wav
+	SFX_E9    :=  0x00e9, // wolf4.wav
+	SFX_EA    :=  0x00ea, // wolf5.wav
+	SFX_EB    :=  0x00eb, // open01a.wav
+	SFX_EC    :=  0x00ec, // open03a.wav
+	SFX_ED    :=  0x00ed, // open04b.wav
+	SFX_EE    :=  0x00ee, // open09.wav
+	SFX_EF    :=  0x00ef, // portclos.wav
+	SFX_F0    :=  0x00f0, // portcul4.wav
+	SFX_F1    :=  0x00f1, // portcul5.wav
+	SFX_F2    :=  0x00f2, // shut03a.wav
+	SFX_F3    :=  0x00f3, // shut07a.wav
+	SFX_F4    :=  0x00f4, // shut14b.wav
+	SFX_F5    :=  0x00f5, // shut17.wav
+	SFX_F6    :=  0x00f6, // sfx01.wav
+	SFX_F7    :=  0x00f7, // sfx02.wav
+	SFX_F8    :=  0x00f8, // sfx04.wav
+	SFX_F9    :=  0x00f9, // sfx05.wav
+	SFX_FA    :=  0x00fa, // sfx06.wav
+	SFX_FB    :=  0x00fb, // sfx08.wav
+	SFX_FC    :=  0x00fc, // sfx10.wav
+	SFX_FD    :=  0x00fd, // sfx11.wav
+	SFX_FE    :=  0x00fe, // sfx12.wav
+	SFX_FF    :=  0x00ff, // sfx13.wav
+	SFX_100   :=  0x0100, // sfx14_l.wav
+	SFX_101   :=  0x0101, // sfx15_l.wav
+	SFX_102   :=  0x0102, // sfx16_l.wav
+	SFX_103   :=  0x0103, // sfx17_l.wav
+	SFX_104   :=  0x0104, // sfx18_l.wav
+	SFX_105   :=  0x0105, // sfx20_l.wav
+	SFX_106   :=  0x0106, // sfx21_l.wav
+	SFX_107   :=  0x0107, // sfx22_l.wav
+	SFX_108   :=  0x0108, // airelem1.wav
+	SFX_109   :=  0x0109, // airelem2.wav
+	SFX_10A   :=  0x010a, // airelem3.wav
+	SFX_10B   :=  0x010b, // airelem4.wav
+	SFX_10C   :=  0x010c, // airelem5.wav
+	SFX_10D   :=  0x010d, // erthel1.wav
+	SFX_10E   :=  0x010e, // erthel2.wav
+	SFX_10F   :=  0x010f, // erthel3.wav
+	SFX_110   :=  0x0110, // erthel4.wav
+	SFX_111   :=  0x0111, // erthel5.wav
+	SFX_112   :=  0x0112, // firelem1.wav
+	SFX_113   :=  0x0113, // firelem2.wav
+	SFX_114   :=  0x0114, // firelem3.wav
+	SFX_115   :=  0x0115, // firelem4.wav
+	SFX_116   :=  0x0116, // firelem5.wav
+	SFX_117   :=  0x0117, // watrel1.wav
+	SFX_118   :=  0x0118, // watrel2.wav
+	SFX_119   :=  0x0119, // watrel3.wav
+	SFX_11A   :=  0x011a, // watrel4.wav
+	SFX_11B   :=  0x011b, // watrel5.wav
+	SFX_11C   :=  0x011c, // exp01.wav
+	SFX_11D   :=  0x011d, // exp04.wav
+	SFX_11E   :=  0x011e, // exp05.wav
+	SFX_11F   :=  0x011f, // exp06.wav
+	SFX_120   :=  0x0120, // bigfoot1.wav
+	SFX_121   :=  0x0121, // bigfoot2.wav
+	SFX_122   :=  0x0122, // feet01a.wav
+	SFX_123   :=  0x0123, // feet01b.wav
+	SFX_124   :=  0x0124, // feet03a.wav
+	SFX_125   :=  0x0125, // feet03b.wav
+	SFX_126   :=  0x0126, // feet05a.wav
+	SFX_127   :=  0x0127, // feet05b.wav
+	SFX_128   :=  0x0128, // feet08a.wav
+	SFX_129   :=  0x0129, // feet08b.wav
+	SFX_12A   :=  0x012a, // feet10a.wav
+	SFX_12B   :=  0x012b, // feet10b.wav
+	SFX_12C   :=  0x012c, // feet12a.wav
+	SFX_12D   :=  0x012d, // feet12b1wav
+	SFX_12E   :=  0x012e, // feet13a.wav
+	SFX_12F   :=  0x012f, // feet13b.wav
+	SFX_130   :=  0x0130, // feet14a.wav
+	SFX_131   :=  0x0131, // feet14b.wav
+	SFX_132   :=  0x0132, // feet15a.wav
+	SFX_133   :=  0x0133, // feet15b.wav
+	SFX_134   :=  0x0134, // feet15c.wav
+	SFX_135   :=  0x0135, // feet15d.wav
+	SFX_136   :=  0x0136, // hit01.wav
+	SFX_137   :=  0x0137, // hit02.wav
+	SFX_138   :=  0x0138, // hit03.wav
+	SFX_139   :=  0x0139, // hit04.wav
+	SFX_13A   :=  0x013a, // hit05.wav
+	SFX_13B   :=  0x013b, // hit06.wav
+	SFX_13C   :=  0x013c, // hit07.wav
+	SFX_13D   :=  0x013d, // hit08.wav
+	SFX_13E   :=  0x013e, // hit09.wav
+	SFX_13F   :=  0x013f, // hit10.wav
+	SFX_140   :=  0x0140, // hit11.wav
+	SFX_141   :=  0x0141, // hit12.wav
+	SFX_142   :=  0x0142, // hit13.wav
+	SFX_143   :=  0x0143, // hit14.wav
+	SFX_144   :=  0x0144, // hit15.wav
+	SFX_145   :=  0x0145, // hit16.wav
+	SFX_146   :=  0x0146, // hit17.wav
+	SFX_147   :=  0x0147, // hit18.wav
+	SFX_148   :=  0x0148, // hit19.wav
+	SFX_149   :=  0x0149, // hit20.wav
+	SFX_14A   :=  0x014a, // hit21.wav
+	SFX_14B   :=  0x014b, // hit22.wav
+	SFX_14C   :=  0x014c, // foomph01.wav
+	SFX_14D   :=  0x014d, // foomph06.wav
+	SFX_14E   :=  0x014e, // foomph07.wav
+	SFX_14F   :=  0x014f, // foomph08.wav
+	SFX_150   :=  0x0150, // foomph09.wav
+	SFX_151   :=  0x0151, // f_die_01.wav
+	SFX_152   :=  0x0152, // f_die_02.wav
+	SFX_153   :=  0x0153, // f_die_03.wav
+	SFX_154   :=  0x0154, // f_die_04.wav
+	SFX_155   :=  0x0155, // moomph01.wav
+	SFX_156   :=  0x0156, // moomph02.wav
+	SFX_157   :=  0x0157, // moomph03.wav
+	SFX_158   :=  0x0158, // moomph04.wav
+	SFX_159   :=  0x0159, // moomph05.wav
+	SFX_15A   :=  0x015a, // moomph13.wav
+	SFX_15B   :=  0x015b, // m_die_01.wav
+	SFX_15C   :=  0x015c, // m_die_02.wav
+	SFX_15D   :=  0x015d, // m_die_03.wav
+	SFX_15E   :=  0x015e, // m_die_04.wav
+	SFX_15F   :=  0x015f, // fyrbal01.wav
+	SFX_160   :=  0x0160, // fyrbal02.wav
+	SFX_161   :=  0x0161, // fyrbal03.wav
+	SFX_162   :=  0x0162, // corpsr1.wav
+	SFX_163   :=  0x0163, // corpsr3.wav
+	SFX_164   :=  0x0164, // corpsr4.wav
+	SFX_165   :=  0x0165, // corpsr5.wav
+	SFX_166   :=  0x0166, // daemon1.wav
+	SFX_167   :=  0x0167, // daemon2.wav
+	SFX_168   :=  0x0168, // daemon3.wav
+	SFX_169   :=  0x0169, // daemon4.wav
+	SFX_16A   :=  0x016a, // daemon5.wav
+	SFX_16B   :=  0x016b, // dragon1.wav
+	SFX_16C   :=  0x016c, // dragon2.wav
+	SFX_16D   :=  0x016d, // dragon3.wav
+	SFX_16E   :=  0x016e, // dragon4.wav
+	SFX_16F   :=  0x016f, // dragon5.wav
+	SFX_170   :=  0x0170, // ettin1.wav
+	SFX_171   :=  0x0171, // ettin2.wav
+	SFX_172   :=  0x0172, // ettin3.wav
+	SFX_173   :=  0x0173, // ettin4.wav
+	SFX_174   :=  0x0174, // ettin5.wav
+	SFX_175   :=  0x0175, // gargyl1.wav
+	SFX_176   :=  0x0176, // gargyl2.wav
+	SFX_177   :=  0x0177, // gargyl3.wav
+	SFX_178   :=  0x0178, // gargyl4.wav
+	SFX_179   :=  0x0179, // gargyl5.wav
+	SFX_17A   :=  0x017a, // gazer1.wav
+	SFX_17B   :=  0x017b, // gazer2.wav
+	SFX_17C   :=  0x017c, // gazer3.wav
+	SFX_17D   :=  0x017d, // gazer4.wav
+	SFX_17E   :=  0x017e, // gazer5.wav
+	SFX_17F   :=  0x017f, // ghost1.wav
+	SFX_180   :=  0x0180, // ghost2.wav
+	SFX_181   :=  0x0181, // ghost3.wav
+	SFX_182   :=  0x0182, // ghost4.wav
+	SFX_183   :=  0x0183, // ghost5.wav
+	SFX_184   :=  0x0184, // gispidr1.wav
+	SFX_185   :=  0x0185, // gispidr2.wav
+	SFX_186   :=  0x0186, // gispidr3.wav
+	SFX_187   :=  0x0187, // gispidr4.wav
+	SFX_188   :=  0x0188, // gispidr5.wav
+	SFX_189   :=  0x0189, // grat1.wav
+	SFX_18A   :=  0x018a, // grat2.wav
+	SFX_18B   :=  0x018b, // grat3.wav
+	SFX_18C   :=  0x018c, // grat4.wav
+	SFX_18D   :=  0x018d, // grat5.wav
+	SFX_18E   :=  0x018e, // gscorp1.wav
+	SFX_18F   :=  0x018f, // gscorp2.wav
+	SFX_190   :=  0x0190, // gscorp3.wav
+	SFX_191   :=  0x0191, // gscorp4.wav
+	SFX_192   :=  0x0192, // gscorp5.wav
+	SFX_193   :=  0x0193, // harpy1.wav
+	SFX_194   :=  0x0194, // harpy2.wav
+	SFX_195   :=  0x0195, // harpy3.wav
+	SFX_196   :=  0x0196, // harpy4.wav
+	SFX_197   :=  0x0197, // harpy5.wav
+	SFX_198   :=  0x0198, // headls1.wav
+	SFX_199   :=  0x0199, // headls2.wav
+	SFX_19A   :=  0x019a, // headls3.wav
+	SFX_19B   :=  0x019b, // headls4.wav
+	SFX_19C   :=  0x019c, // headls5.wav
+	SFX_19D   :=  0x019d, // liche1.wav
+	SFX_19E   :=  0x019e, // liche2.wav
+	SFX_19F   :=  0x019f, // liche3.wav
+	SFX_1A0   :=  0x01a0, // liche4.wav
+	SFX_1A1   :=  0x01a1, // liche5.wav
+	SFX_1A2   :=  0x01a2, // lzrdmn1.wav
+	SFX_1A3   :=  0x01a3, // lzrdmn2.wav
+	SFX_1A4   :=  0x01a4, // lzrdmn3.wav
+	SFX_1A5   :=  0x01a5, // lzrdmn4.wav
+	SFX_1A6   :=  0x01a6, // lzrdmn5.wav
+	SFX_1A7   :=  0x01a7, // mngbat1.wav
+	SFX_1A8   :=  0x01a8, // mngbat2.wav
+	SFX_1A9   :=  0x01a9, // mngbat3.wav
+	SFX_1AA   :=  0x01aa, // mngbat4.wav
+	SFX_1AB   :=  0x01ab, // mngbat5.wav
+	SFX_1AC   :=  0x01ac, // ogre1.wav
+	SFX_1AD   :=  0x01ad, // ogre2.wav
+	SFX_1AE   :=  0x01ae, // ogre3.wav
+	SFX_1AF   :=  0x01af, // ogre4.wav
+	SFX_1B0   :=  0x01b0, // ogre5.wav
+	SFX_1B1   :=  0x01b1, // orc1.wav
+	SFX_1B2   :=  0x01b2, // orc2.wav
+	SFX_1B3   :=  0x01b3, // orc3.wav
+	SFX_1B4   :=  0x01b4, // orc4.wav
+	SFX_1B5   :=  0x01b5, // orc5.wav
+	SFX_1B6   :=  0x01b6, // ratman1.wav
+	SFX_1B7   :=  0x01b7, // ratman2.wav
+	SFX_1B8   :=  0x01b8, // ratman3.wav
+	SFX_1B9   :=  0x01b9, // ratman4.wav
+	SFX_1BA   :=  0x01ba, // ratman5.wav
+	SFX_1BB   :=  0x01bb, // reaper1.wav
+	SFX_1BC   :=  0x01bc, // reaper2.wav
+	SFX_1BD   :=  0x01bd, // reaper3.wav
+	SFX_1BE   :=  0x01be, // reaper4.wav
+	SFX_1BF   :=  0x01bf, // reaper5.wav
+	SFX_1C0   :=  0x01c0, // seaserp1.wav
+	SFX_1C1   :=  0x01c1, // seaserp3.wav
+	SFX_1C2   :=  0x01c2, // seaserp4.wav
+	SFX_1C3   :=  0x01c3, // seaserp5.wav
+	SFX_1C4   :=  0x01c4, // skletn1.wav
+	SFX_1C5   :=  0x01c5, // skletn2.wav
+	SFX_1C6   :=  0x01c6, // skletn3.wav
+	SFX_1C7   :=  0x01c7, // skletn4.wav
+	SFX_1C8   :=  0x01c8, // skletn5.wav
+	SFX_1C9   :=  0x01c9, // slime1.wav
+	SFX_1CA   :=  0x01ca, // slime2.wav
+	SFX_1CB   :=  0x01cb, // slime3.wav
+	SFX_1CC   :=  0x01cc, // slime4.wav
+	SFX_1CD   :=  0x01cd, // slime5.wav
+	SFX_1CE   :=  0x01ce, // troll1.wav
+	SFX_1CF   :=  0x01cf, // troll2.wav
+	SFX_1D0   :=  0x01d0, // troll3.wav
+	SFX_1D1   :=  0x01d1, // troll4.wav
+	SFX_1D2   :=  0x01d2, // troll5.wav
+	SFX_1D3   :=  0x01d3, // wisp1.wav
+	SFX_1D4   :=  0x01d4, // wisp2.wav
+	SFX_1D5   :=  0x01d5, // wisp3.wav
+	SFX_1D6   :=  0x01d6, // wisp4.wav
+	SFX_1D7   :=  0x01d7, // wisp5.wav
+	SFX_1D8   :=  0x01d8, // zombie1.wav
+	SFX_1D9   :=  0x01d9, // zombie2.wav
+	SFX_1DA   :=  0x01da, // zombie3.wav
+	SFX_1DB   :=  0x01db, // zombie4.wav
+	SFX_1DC   :=  0x01dc, // zombie5.wav
+	SFX_1DD   :=  0x01dd, // elec_l.wav
+	SFX_1DE   :=  0x01de, // fire_l.wav
+	SFX_1DF   :=  0x01df, // hiss_l.wav
+	SFX_1E0   :=  0x01e0, // clumsy.wav
+	SFX_1E1   :=  0x01e1, // cure.wav
+	SFX_1E2   :=  0x01e2, // curse.wav
+	SFX_1E3   :=  0x01e3, // c_food.wav
+	SFX_1E4   :=  0x01e4, // c_light.wav
+	SFX_1E5   :=  0x01e5, // feblmind.wav
+	SFX_1E6   :=  0x01e6, // m_arrow.wav
+	SFX_1E7   :=  0x01e7, // weaken.wav
+	SFX_1E8   :=  0x01e8, // agility.wav
+	SFX_1E9   :=  0x01e9, // archcure.wav
+	SFX_1EA   :=  0x01ea, // birdseye.wav
+	SFX_1EB   :=  0x01eb, // bless.wav
+	SFX_1EC   :=  0x01ec, // cunning.wav
+	SFX_1ED   :=  0x01ed, // identify.wav
+	SFX_1EE   :=  0x01ee, // protect.wav
+	SFX_1EF   :=  0x01ef, // strength.wav
+	SFX_1F0   :=  0x01f0, // trap.wav
+	SFX_1F1   :=  0x01f1, // untrap.wav
+	SFX_1F2   :=  0x01f2, // harm.wav
+	SFX_1F3   :=  0x01f3, // heal.wav
+	SFX_1F4   :=  0x01f4, // magic_fyrbal01.
+	SFX_1F5   :=  0x01f5, // m_lock.wav
+	SFX_1F6   :=  0x01f6, // teleknes.wav
+	SFX_1F7   :=  0x01f7, // walstone.wav
+	SFX_1F8   :=  0x01f8, // aprotect.wav
+	SFX_1F9   :=  0x01f9, // manadran.wav
+	SFX_1FA   :=  0x01fa, // manavamp.wav
+	SFX_1FB   :=  0x01fb, // mark.wav
+	SFX_1FC   :=  0x01fc, // masscurs.wav
+	SFX_1FD   :=  0x01fd, // recall.wav
+	SFX_1FE   :=  0x01fe, // reveal.wav
+	SFX_1FF   :=  0x01ff, // teleport.wav
+	SFX_200   :=  0x0200, // unlock.wav
+	SFX_201   :=  0x0201, // bladsprt.wav
+	SFX_202   :=  0x0202, // dispfild.wav
+	SFX_203   :=  0x0203, // gratheal.wav
+	SFX_204   :=  0x0204, // invisibl.wav
+	SFX_205   :=  0x0205, // paralyze.wav
+	SFX_206   :=  0x0206, // poison.wav
+	SFX_207   :=  0x0207, // thundr01.wav
+	SFX_208   :=  0x0208, // explode.wav
+	SFX_209   :=  0x0209, // flamstrk.wav
+	SFX_20A   :=  0x020a, // massdisp.wav
+	SFX_20B   :=  0x020b, // nrgybolt.wav
+	SFX_20C   :=  0x020c, // parafild.wav
+	SFX_20D   :=  0x020d, // posnfild.wav
+	SFX_20E   :=  0x020e, // earthqke.wav
+	SFX_20F   :=  0x020f, // gatetrvl.wav
+	SFX_210   :=  0x0210, // morph.wav
+	SFX_211   :=  0x0211, // nergyfld.wav
+	SFX_212   :=  0x0212, // nrgywind.wav
+	SFX_213   :=  0x0213, // dethvrtx.wav
+	SFX_214   :=  0x0214, // mindblst.wav
+	SFX_215   :=  0x0215, // resurect.wav
+	SFX_216   :=  0x0216, // sumncrtr.wav
+	SFX_217   :=  0x0217, // sumndemn.wav
+	SFX_218   :=  0x0218, // sumnelem.wav
+	SFX_219   :=  0x0219, // blade01.wav
+	SFX_21A   :=  0x021a, // blade02.wav
+	SFX_21B   :=  0x021b, // blade03.wav
+	SFX_21C   :=  0x021c, // blade04.wav
+	SFX_21D   :=  0x021d, // blade05.wav
+	SFX_21E   :=  0x021e, // boulder1.wav
+	SFX_21F   :=  0x021f, // boulder2.wav
+	SFX_220   :=  0x0220, // crumble1.wav
+	SFX_221   :=  0x0221, // crumble2.wav
+	SFX_222   :=  0x0222, // crumble3.wav
+	SFX_223   :=  0x0223, // crumble4.wav
+	SFX_224   :=  0x0224, // dart01.wav
+	SFX_225   :=  0x0225, // dart02.wav
+	SFX_226   :=  0x0226, // flame01.wav
+	SFX_227   :=  0x0227, // flame03.wav
+	SFX_228   :=  0x0228, // flame05.wav
+	SFX_229   :=  0x0229, // mushrm01.wav
+	SFX_22A   :=  0x022a, // mushrm02.wav
+	SFX_22B   :=  0x022b, // mushrm03.wav
+	SFX_22C   :=  0x022c, // spike01.wav
+	SFX_22D   :=  0x022d, // spike02.wav
+	SFX_22E   :=  0x022e, // spike03.wav
+	SFX_22F   :=  0x022f, // spike04.wav
+	SFX_230   :=  0x0230, // vapor01.wav
+	SFX_231   :=  0x0231, // vapor02.wav
+	SFX_232   :=  0x0232, // vapor03.wav
+	SFX_233   :=  0x0233, // axe01.wav
+	SFX_234   :=  0x0234, // blunt01.wav
+	SFX_235   :=  0x0235, // crossbow.wav
+	SFX_236   :=  0x0236, // gilotin1.wav
+	SFX_237   :=  0x0237, // hvyswrd1.wav
+	SFX_238   :=  0x0238, // hvyswrd4.wav
+	SFX_239   :=  0x0239, // swish01.wav
+	SFX_23A   :=  0x023a, // swish02.wav
+	SFX_23B   :=  0x023b, // swish03.wav
+	SFX_23C   :=  0x023c, // sword1.wav
+	SFX_23D   :=  0x023d, // sword7.wav
+	SFX_23E   :=  0x023e, // carpntry.wav
+	SFX_23F   :=  0x023f, // dye.wav
+	SFX_240   :=  0x0240, // fshsplsh.wav
+	SFX_241   :=  0x0241, // liquid.wav
+	SFX_242   :=  0x0242, // lockpick.wav
+	SFX_243   :=  0x0243, // mortar.wav
+	SFX_244   :=  0x0244, // mystery1.wav
+	SFX_245   :=  0x0245, // mystery2.wav
+	SFX_246   :=  0x0246, // mystery3.wav
+	SFX_247   :=  0x0247, // poison.wav
+	SFX_248   :=  0x0248, // powder.wav
+	SFX_249   :=  0x0249, // scissors.wav
+	SFX_24A   :=  0x024a, // scribe.wav
+	SFX_24B   :=  0x024b, // spirtspk.wav
+	SFX_24C   :=  0x024c, // z_horseft2.wav
+	SFX_24D   :=  0x024d, // z_horseft1.wav
+	SFX_24E   :=  0x024e, // Tera.Warrior 1
+	SFX_24F   :=  0x02ef  // Tera.Warrior 2
+endenum
+
+
+// Fill in the rest of the T2A sounds here.
+enum SFX_MUSIC
+	SFX_MUSIC_LUTE_GOOD           := SFX_4D,
+	SFX_MUSIC_LUTE_FAIL           := SFX_4E,
+	SFX_MUSIC_DRUM_GOOD           := SFX_39,
+	SFX_MUSIC_DRUM_FAIL           := SFX_3A,
+	SFX_MUSIC_HARP_LARGE_GOOD     := SFX_44,
+	SFX_MUSIC_HARP_LARGE_FAIL     := SFX_45,
+	SFX_MUSIC_HARP_LAP_GOOD       := SFX_46,
+	SFX_MUSIC_HARP_LAP_FAIL       := SFX_47,
+	SFX_MUSIC_TAMBORINE_GOOD      := SFX_53,
+	SFX_MUSIC_TAMBORINE_FAIL      := SFX_54
+endenum
+
+
+enum SFX_SPELLS
+	SFX_SPELL_CLUMSY              := SFX_1E0,
+	SFX_SPELL_CREATE_FOOD         := SFX_1E3,
+	SFX_SPELL_FEEBLEMIND          := SFX_1E5,
+	SFX_SPELL_HEAL                := SFX_1F3,
+	SFX_SPELL_MAGIC_ARROW         := SFX_1E6,
+	SFX_SPELL_NIGHT_SIGHT         := SFX_1E4,
+	SFX_SPELL_REACTIVE_ARMOR      := SFX_1F3,
+	SFX_SPELL_WEAKEN              := SFX_1E7,
+	SFX_SPELL_AGILITY             := SFX_1E8,
+	SFX_SPELL_CUNNING             := SFX_1EC,
+	SFX_SPELL_CURE                := SFX_1E1,
+	SFX_SPELL_HARM                := SFX_1F2,
+	SFX_SPELL_MAGIC_TRAP          := SFX_1F0,
+	SFX_SPELL_MAGIC_UNTRAP        := SFX_1F1,
+	SFX_SPELL_PROTECTION          := SFX_1EE,
+	SFX_SPELL_STRENGTH            := SFX_1EF,
+	SFX_SPELL_BLESS               := SFX_1EB,
+	SFX_SPELL_FIREBALL            := SFX_160,
+	SFX_SPELL_MAGIC_LOCK          := SFX_1F5,
+	SFX_SPELL_TELEKINESIS         := SFX_1F6,
+	SFX_SPELL_TELEPORT            := SFX_1FF,
+	SFX_SPELL_POISON              := SFX_247,
+	SFX_SPELL_UNLOCK              := SFX_200,
+	SFX_SPELL_WALL_OF_STONE       := SFX_1F7,
+	SFX_SPELL_ARCH_CURE           := SFX_1E9,
+	SFX_SPELL_ARCH_PROTECTION     := SFX_1F8,
+	SFX_SPELL_CURSE               := SFX_1E2,
+	SFX_SPELL_FIRE_FIELD          := SFX_226,
+	SFX_SPELL_GREATER_HEAL        := SFX_203,
+	SFX_SPELL_LIGHTNING           := SFX_2A,
+	SFX_SPELL_MANA_DRAIN          := SFX_1F9,
+	SFX_SPELL_RECALL              := SFX_1FD,
+	SFX_SPELL_BLADE_SPIRITS       := SFX_213,
+	SFX_SPELL_ENERGY_FIELD        := SFX_211, // used to say dispel field?
+	SFX_SPELL_INCOGNITO           := SFX_1ED,
+	SFX_SPELL_MAGIC_REFLECTION    := SFX_1E8,
+	SFX_SPELL_MIND_BLAST          := SFX_214,
+	SFX_SPELL_PARALYZE            := SFX_205,
+	SFX_SPELL_POISON_FIELD        := SFX_20D, // was 227 (??)
+	SFX_SPELL_SUMMON_CREATURE     := SFX_216,
+	SFX_SPELL_DISPEL              := SFX_202,
+	SFX_SPELL_ENERGY_BOLT         := SFX_20B,
+	SFX_SPELL_EXPLOSION           := SFX_208,
+	SFX_SPELL_INVISIBILITY        := SFX_204,
+	SFX_SPELL_MARK                := SFX_1FB,
+	SFX_SPELL_MASS_CURSE          := SFX_1FC,
+	SFX_SPELL_PARALYZE_FIELD      := SFX_212,
+	SFX_SPELL_REVEAL              := SFX_1FE,
+	SFX_SPELL_CHAIN_LIGHTNING     := SFX_30,
+	SFX_SPELL_PARA_FIELD          := SFX_20C,
+	SFX_SPELL_FLAME_STRIKE        := SFX_209,
+	SFX_SPELL_GATE_TRAVEL         := SFX_20F,
+	SFX_SPELL_MANA_VAMPIRE        := SFX_1FA,
+	SFX_SPELL_MASS_DISPEL         := SFX_20A,
+	SFX_SPELL_METEOR_SWARM        := SFX_161,
+	SFX_SPELL_POLYMORPH           := SFX_20A,
+	SFX_SPELL_EARTHQUAKE          := SFX_20E,
+	SFX_SPELL_ENERGY_VORTEX       := SFX_213,
+	SFX_SPELL_RESSURECTION        := SFX_215,
+	SFX_SPELL_SUMMON_ELEMENTAL    := SFX_218,
+	SFX_SPELL_SUMMON_DAEMON       := SFX_217
+endenum
+
+
+enum SFX_SKILLS
+	SFX_SKILL_SPIRITSPEAK	:= SFX_24B,
+	SFX_SKILL_LUMBERJACK	:= SFX_13F,
+	SFX_SKILL_LOCKPICK	:= SFX_242
+endenum
+
+
+enum SFX_ITEMS
+	SFX_TRAP_NEEDLE		:= SFX_225,
+	SFX_TRAP_POISON		:= SFX_206,
+	SFX_TRAP_EXPLOSION	:= SFX_208,
+	SFX_ANVIL		:= SFX_2B,
+	SFX_PICK		:= SFX_13B,
+	SFX_HAMMER		:= SFX_43,
+	SFX_GLASSBREAK4		:= SFX_42,
+	SFX_HARP_SUCC		:= SFX_46,
+	SFX_LUTE_SUCC		:= SFX_4D,
+	SFX_DRUM_SUCC		:= SFX_39,
+	SFX_TAMB_SUCC		:= SFX_53,
+	SFX_HARP_FAIL		:= SFX_47,
+	SFX_LUTE_FAIL		:= SFX_4E,
+	SFX_DRUM_FAIL		:= SFX_3A,
+	SFX_TAMB_FAIL		:= SFX_54
+endenum
+
+
+enum SFX_DOORS
+	SFX_OPEN_WOODEN_DOOR	:= SFX_EB,
+	SFX_CLOSE_WOODEN_DOOR	:= SFX_F2,
+	SFX_OPEN_METAL_DOOR	:= SFX_ED,
+	SFX_CLOSE_METAL_DOOR	:= SFX_F4
+endenum

Added: trunk/096/scripts/include/OLD/spellAttack.inc
===================================================================
--- trunk/096/scripts/include/OLD/spellAttack.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/spellAttack.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,14 @@
+function send_attack(ttarget, source, spellid := 0)
+  var ev := array;
+  ev.+type;
+  ev.+source;
+  ev.type := 0x0002;
+  ev.source := source;
+  SendEvent(ttarget, ev);
+  if (spellid)
+    ev.+spell;
+    ev.type := 0x0800;
+    ev.spell := spellid;
+    SendEvent(ttarget, ev);
+  endif
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/spellRestrictions.inc
===================================================================
--- trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,593 @@
+use uo;
+use os;
+use cfgfile;
+use util;
+
+include "include/fields";
+include "include/client";
+include "include/tileEffects";
+include "include/sound";
+include "include/objtype";
+include "include/statMod";
+include "include/firewall";
+include "include/spellAttack";
+include "include/dist";
+
+var caster;
+var npccfg := ReadConfigFile("::npcdesc");
+const EVID_DISCHARGE := 0x123457;
+
+
+function maincast(parms, delivery, circle, noto, id);
+  var cast_on;
+  var spellscroll := 0;
+  var scroll;
+  var tgtopt := TGTOPT_CHECK_LOS;
+  if(parms[1] == "#MOB")
+    caster := parms[2];
+    if(mobspellcast(caster, circle, spellscroll) == 0)
+      return 0;
+    endif
+    cast_on := parms[3];
+  elseif (parms[1] == "#scroll")
+    spellscroll := 1;
+    caster := parms[2];
+    EraseObjProperty(caster, "IsMeditating");
+    EraseObjProperty(caster, "HealTimer");
+    if(spellcast(caster, circle, spellscroll, id) == 0)
+      return 0;
+    endif
+    scroll := parms[3];
+    if(!ReserveItem(scroll))
+      SendSysMessage(caster,"You lost your concentration.", 3, 40);
+      return 0;
+    endif
+    if(delivery == "notarget")
+      cast_on := caster;
+      if(!can_cast(caster))
+        cast_on := 0;
+      endif
+    elseif(delivery == "direct")
+      if(noto == "helpful")
+        cast_on := CanTargetSpell(caster, circle, TGTOPT_HELPFUL | tgtopt);
+        if(!can_cast(caster))
+          cast_on := 0;
+        endif
+      elseif(noto == "neutral")
+        cast_on := CanTargetSpell(caster, circle, TGTOPT_NEUTRAL | tgtopt);
+        if(!can_cast(caster))
+          cast_on := 0;
+        endif
+      else
+        cast_on := CanTargetSpell(caster, circle, TGTOPT_HARMFUL | tgtopt);
+        if(!can_cast(caster))
+          cast_on := 0;
+        endif
+      endif
+      if(!cast_on)
+        return 0;
+      endif
+    elseif(delivery == "indirect")
+      cast_on := CanTargetArea(caster, circle);
+      if(!can_cast(caster))
+        cast_on := 0;
+      endif
+      if (!cast_on)
+        return 0;
+      endif
+    else
+      return 0;
+    endif
+  else
+    caster := parms;
+    EraseObjProperty(caster, "IsMeditating");
+    EraseObjProperty(caster, "HealTimer");
+    if (spellcast(caster, circle, spellscroll, id) == 0)
+      return 0;
+    endif
+    if (!ConsumeReagents(caster, id+100))
+      SendSysMessage(caster, "You do not have the proper reagents.");
+      return 0;
+    endif
+    if(delivery == "notarget")
+      cast_on := caster;
+      if(!can_cast(caster))
+        cast_on := 0;
+      endif
+    elseif(delivery == "direct")
+      if(noto == "helpful")
+        cast_on := CanTargetSpell(caster, circle, TGTOPT_HELPFUL | tgtopt);
+        if(!can_cast(caster))
+          cast_on := 0;
+        endif
+      elseif(noto == "neutral")
+        cast_on := CanTargetSpell(caster, circle, TGTOPT_NEUTRAL | tgtopt);
+        if(!can_cast(caster))
+          cast_on := 0;
+        endif
+      else
+        cast_on := CanTargetSpell(caster, circle, TGTOPT_HARMFUL | tgtopt);
+        if(!can_cast(caster))
+          cast_on := 0;
+        endif
+      endif
+      if (!cast_on)
+        return 0;
+      endif
+    elseif(delivery == "indirect")
+      cast_on := CanTargetArea(caster, circle);
+      if(!can_cast(caster))
+        cast_on := 0;
+      endif
+      if (!cast_on)
+        return 0;
+      endif
+    else
+      return 0;
+    endif
+  endif
+  if(newusemana(caster, circle, cast_on, delivery) == 0)
+    PlaySoundEffect(caster,0x005d);
+    PlayObjectCenteredEffect(caster, 0x3735,0x0a, 0x1e);
+    return 0;
+  endif
+  if(spellscroll == 1)
+    if(!SubtractAmount(scroll, 1))
+      return 0;
+    endif
+  endif
+  var points := getpoints(circle, spellscroll, SKILLID_MAGERY);
+  //AwardRawSkillPoints(caster, SKILLID_MAGERY, points);
+  var newparms := {};
+  newparms[1] := caster;
+  newparms[2] := cast_on;
+  return newparms;
+endfunction
+
+function can_cast(who)
+  var hand1 := (GetEquipmentByLayer(who, 1));
+  var hand2 := (GetEquipmentByLayer(who, 2));
+  if(hand1)
+    if(hand1.graphic != 0x0efa)
+      SendSysMessage(who,"You can't cast spells with things in your hands.", 3, 40);
+      return 0;
+    endif
+  endif
+  if(hand2)
+    if(hand2.graphic != 0x0efa)
+      SendSysMessage(who,"You can't cast spells with things in your hands.", 3, 40);
+      return 0;
+    endif
+  endif
+  return 1;
+endfunction
+
+function CanTargetSpell(caster, circle, targopt := (TGTOPT_NEUTRAL | TGTOPT_CHECK_LOS) )
+  circle := circle; // stops ecompile "not used" warning
+  if(!can_cast(caster))
+    return 0;
+  endif
+  var cast_on := Target(caster, targopt);
+  if(!cast_on)
+    return 0;
+  endif
+  if(cast_on.hidden)
+    SendSysMessage(caster,"You can't see that.", 3, 40);
+    return 0;
+  endif
+  if(dist(caster, cast_on) >= 12)
+    SendSysMessage(caster, "That is too far away.", 3, 40);
+    return 0;
+  endif
+  return cast_on;
+endfunction
+
+function CanTargetArea(caster, circle)
+  circle := circle; // stops ecompile "not used" warning
+  if (!can_cast(caster))
+    return 0;
+  endif
+  var cast_loc := TargetCoordinates(caster);
+  if (!cast_loc.x)
+    return 0;
+  endif
+  if (!CheckLosAt(caster, cast_loc.x, cast_loc.y, cast_loc.z))
+    SendSysMessage(caster, "You can't see that.", 3, 40);
+    return 0;
+  endif
+  if(coordist(caster.x, caster.y, cast_loc.x, cast_loc.y) >= 12)
+    SendSysMessage(caster, "That is too far away.", 3, 40);
+    return 0;
+  endif
+  return cast_loc;
+endfunction
+
+function Reflected(cast_on)
+  var mr := CInt(GetObjProperty(cast_on, "mr"));
+  if(mr >= 1)
+    PlaySoundEffect(cast_on, SFX_SPELL_MAGIC_REFLECTION);
+    PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 10,10);
+    SendSysMessage(cast_on, "Your magic reflect spell saved you!");
+    if(mr == 1)
+      EraseObjProperty(cast_on, "mr");
+    elseif(mr == 2)
+      var holder, pid;
+      var eqp := GetObjProperty(cast_on, "EquipTimers");
+      foreach thing in ListEquippedItems(cast_on)
+        foreach entry in eqp
+          if((thing.serial == entry[1]) and (entry[2] == "ref"))
+            holder := GetObjProperty(thing, "pid");
+            break;
+          endif
+        endforeach
+      endforeach
+      pid := getprocess(holder);
+      if(pid)
+        var k := struct;
+        k.+type := EVID_DISCHARGE;
+        pid.sendevent(k);
+      else
+        EraseObjProperty(cast_on, "mr");
+      endif
+    endif
+    return 1;
+  endif
+  return 0;
+endfunction
+
+function Resisted(circle, caster, cast_on, amt)
+	// Purpose: to check for resistance to spells cast upon a character
+	// called by: most spells
+	// returns: amount of damage not resisted?
+
+        var magery := CInt(AP_GetSkill(caster, SKILLID_MAGERY));
+        var evalint := CInt(AP_GetSkill(caster, SKILLID_EVALINT));
+        var resist := CInt(AP_GetSkill(cast_on, SKILLID_MAGICRESISTANCE));
+        
+        // chk1 relates to the resist ability.
+        var chk1 := (resist / 5);
+        // chk2 relates to the difficulty level
+        var chk2 := resist - (((magery - 20) / 5) + (circle * 5));
+        
+        if(chk1 < 1)
+                chk1 := 1;
+        endif
+        if(chk2 < 1)
+                chk2 := 1;
+        endif
+        
+        // What an odd construct.  
+        // If you're hit with an easy spell then you have a difficulty of your resist
+        var diff := 0;
+        if(chk1 > chk2)
+                diff := chk1;
+        else
+                diff := chk2;
+        endif
+        
+        var points := getresistpoints(circle, cast_on, SKILLID_MAGICRESISTANCE);
+        if(cast_on.dead)
+                return 0;
+        endif
+        if(CheckSkill(cast_on, SKILLID_MAGICRESISTANCE, diff, points))
+                SendSysMessage(cast_on, "You feel yourself resisting magical energy!");
+                PlaySoundEffect(cast_on, SFX_SPELL_WEAKEN);
+                PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 5,5);
+                amt := (amt * 0.5);
+                if(amt < 1)
+                        amt := 1;
+                endif
+        endif
+        var modamt := 1;
+        if(resist > evalint)
+                modamt := (1 + ((evalint - resist) / 200.0));
+        elseif(evalint > resist)
+                modamt := (1 + ((evalint - resist) / 500.0));
+        endif
+        amt := (amt * modamt);
+        return CInt(amt);
+endfunction
+
+
+function CalcSpellDamage(circle, caster, cast_on)
+  var die_string := circle+"d8";
+  var dmg := RandomDiceRoll(die_string);
+  dmg := dmg + CInt(AP_GetSkill(caster, SKILLID_MAGERY)/10);
+  if(dmg > (circle * 8))
+    dmg := circle * 8;
+  endif
+  return dmg;
+endfunction
+
+function CanTargetThing(caster, circle, targopt := TGTOPT_CHECK_LOS)
+  if (!can_cast(caster))
+    return 0;
+  endif
+  var cast_on := Target(caster, targopt);
+  if(!cast_on)
+    return;
+  endif
+  return cast_on;
+endfunction
+
+function spellcast(me, circle, scroll, id)
+  var spellcfg := ReadConfigFile(":spells:spells");
+  var val := SplitWords(spellcfg[id].val);
+  var times := CInt(val[1]);
+  var slp   := CInt(val[2]);
+  var mhp := AP_GetVital(me, "Hits");
+  var umana, diff;
+  var n := 1;
+  if(scroll == 0)
+    case (circle)
+      1:   umana :=   4;     diff :=  10;
+      2:   umana :=   6;     diff :=  20;
+      3:   umana :=   9;     diff :=  30;
+      4:   umana :=  11;     diff :=  50;
+      5:   umana :=  14;     diff :=  60;
+      6:   umana :=  20;     diff :=  70;
+      7:   umana :=  40;     diff :=  85;
+      8:   umana :=  50;     diff :=  95;
+      9:   umana :=  75;     diff := 100;
+     10:   umana := 100;     diff := 100;
+    endcase
+  elseif(scroll == 1)
+    case (circle)
+      1:   umana :=   4;     diff := 10;
+      2:   umana :=   6;     diff := 10;
+      3:   umana :=   9;     diff := 10;
+      4:   umana :=  11;     diff := 20;
+      5:   umana :=  14;     diff := 30;
+      6:   umana :=  20;     diff := 50;
+      7:   umana :=  40;     diff := 60;
+      8:   umana :=  50;     diff := 70;
+      9:   umana :=  75;     diff := 85;
+     10:   umana := 100;     diff := 95;
+    endcase
+  else
+    return 0;
+  endif
+  if((mhp > AP_GetVital(me, "Hits")) && ((RandomInt(99)+1) > (AP_GetSkill(me, SKILLID_WRESTLING)/2)))
+    SendSysMessage(me,"You lost your concentration.", 3, 40);
+    return 0;
+  endif
+  if (umana > AP_GetVital(me, "Mana"))
+    me.frozen :=1;
+    PerformAction(me,ANIM_CAST_DIR);
+    sleepms(1200);
+    me.frozen :=0;
+    SendSysMessage(me,"You do not have enough mana to cast that.", 3, 40);
+    PlaySoundEffect(me,0x005d);
+    PlayObjectCenteredEffect(me, 0x3735,0x0a, 0x1e);
+    return 0;
+  endif
+  if(can_cast(me))
+    me.frozen :=1;
+    for (n:=1; n<=times; n:=n+1)
+      if((mhp > AP_GetVital(me, "Hits")) && ((RandomInt(99)+1) > (AP_GetSkill(me, SKILLID_WRESTLING)/2)))
+        SendSysMessage(me,"You lost your concentration.", 3, 40);
+        PlaySoundEffect(me,0x005d);
+        PlayObjectCenteredEffect(me, 0x3735,0x0a, 0x1e);
+        me.frozen :=0;
+        return 0;
+      endif
+      PerformAction(me,ANIM_CAST_DIR);
+      sleepms(900);
+    endfor
+    if(slp)
+      sleepms(slp * 100);
+    endif
+    me.frozen :=0;
+    if (CheckSkill(me,SKILLID_MAGERY, diff, 0))
+      if((mhp > AP_GetVital(me, "Hits")) && ((RandomInt(99)+1) > (AP_GetSkill(me, SKILLID_WRESTLING)/2)))
+        SendSysMessage(me,"You lost your concentration.", 3, 40);
+        return 0;
+      endif
+      return 1;
+    else
+      SendSysMessage(me,"The spell fizzles.", 3, 40);
+      PlaySoundEffect(me,0x005d);
+      PlayObjectCenteredEffect(me, 0x3735,0x0a, 0x1e);
+      return 0;
+    endif
+  endif
+endfunction
+
+function newusemana(who, circle, cast_on, delivery)
+  if(delivery == "direct")
+    if(!CheckLineOfSight(who, cast_on))
+      SendSysMessage(who, "You can't see that.", 3, 40);
+      return 0;
+    endif
+  elseif(delivery == "indirect")
+    if(!CheckLosAt(who, cast_on.x, cast_on.y, cast_on.z))
+      SendSysMessage(who, "You can't see that.", 3, 40);
+      return 0;
+    endif
+  endif
+  if(cdist(who.x, who.y, cast_on.x, cast_on.y) > 12)
+    var check := 0;
+    foreach thing in EnumerateItemsInContainer(who.backpack)
+      if(thing == cast_on)
+        check := 1;
+        break;
+      endif
+    endforeach
+    if(!check)
+      SendSysMessage(who,"The target is out of range.", 3, 40);
+      return 0;
+    endif
+  endif
+  var umana;
+    case (circle)
+    1: umana :=  4;
+    2: umana :=  6;
+    3: umana :=  9;
+    4: umana := 11;
+    5: umana := 14;
+    6: umana := 20;
+    7: umana := 40;
+    8: umana := 50;
+  endcase
+  var mana := AP_GetVital(who, "Mana");
+  if(mana >= umana)
+    AP_SetVital(who, "Mana", Cint(mana - umana));
+    return 1;
+  else
+    SendSysMessage(who,"You do not have enough mana to cast that.", 3, 40);
+    return 0;
+  endif
+endfunction
+
+function mobspellcast(me, circle, scroll)
+  scroll := scroll; // stops ecompile "not used" warning
+  var diff, points, umana;
+  case(circle)
+    1:   diff := 10;     points :=  20;    umana :=   4;
+    2:   diff := 20;     points :=  40;    umana :=   6;
+    3:   diff := 30;     points :=  80;    umana :=   9;
+    4:   diff := 50;     points := 100;    umana :=  11;
+    5:   diff := 60;     points := 130;    umana :=  14;
+    6:   diff := 70;     points := 160;    umana :=  20;
+    7:   diff := 85;     points := 190;    umana :=  40;
+    8:   diff := 95;     points := 210;    umana :=  50;
+  endcase
+  if(umana > AP_GetVital(me, "Mana"))
+    return 0;
+  endif
+  if(can_cast(me))
+    if(CheckSkill(me, SKILLID_MAGERY, (diff - 10), points))
+      return 1;
+    else
+      return 0;
+    endif
+  endif
+endfunction
+
+function getpoints(c, scroll, skillid)
+  var points;
+  var diff;
+  if(scroll == 1)
+    case(c)
+      1:   points :=  10; diff :=  0;
+      2:   points :=  20; diff := 10;
+      3:   points :=  20; diff := 10;
+      4:   points :=  40; diff := 20;
+      5:   points :=  60; diff := 30;
+      6:   points := 100; diff := 50;
+      7:   points := 120; diff := 60;
+      8:   points := 140; diff := 70;
+    endcase
+  else
+    case(c)
+      1:   points :=  20; diff := 20;
+      2:   points :=  40; diff := 30;
+      3:   points :=  80; diff := 40;
+      4:   points := 100; diff := 50;
+      5:   points := 120; diff := 60;
+      6:   points := 140; diff := 70;
+      7:   points := 160; diff := 86;
+      8:   points := 180; diff := 100;
+    endcase
+  endif
+  var skill := AP_GetSkill(caster, skillid);
+  if(skill > (diff - 20))
+    if((skill - diff) <= 5)
+      points := points;
+    elseif((skill - diff) <= 10)
+      points := (points * 3) / 4;
+    elseif((skill - diff) <= 15)
+      points := points / 2;
+    elseif((skill - diff) <= 15)
+      points := points / 4;
+    else
+      points := 0;
+    endif
+  endif
+  return points;
+endfunction
+
+function getresistpoints(c, victim, skillid)
+  var points;
+  var diff;
+  case(c)
+    1:   points :=  20; diff := 20;
+    2:   points :=  40; diff := 30;
+    3:   points :=  80; diff := 40;
+    4:   points := 100; diff := 50;
+    5:   points := 120; diff := 60;
+    6:   points := 140; diff := 70;
+    7:   points := 160; diff := 86;
+    8:   points := 180; diff := 100;
+  endcase
+  var skill := AP_GetSkill(victim, skillid);
+  if(skill > (diff - 20))
+    if((skill - diff) <= 5)
+      points := points;
+    elseif((skill - diff) <= 10)
+      points := (points * 3) / 4;
+    elseif((skill - diff) <= 15)
+      points := points / 2;
+    elseif((skill - diff) <= 15)
+      points := points / 4;
+    else
+      points := 0;
+    endif
+  endif
+  return points;
+endfunction
+
+function cdist(x1, y1, x2, y2)
+  var xd := x1 - x2;
+  var yd := y1 - y2;
+  if (xd < 0)
+    xd := -xd;
+  endif
+  if (yd < 0)
+    yd := -yd;
+  endif
+  if (xd > yd)
+    return xd;
+  else
+    return yd;
+  endif
+endfunction
+
+function usemana(who, circle, cast_on)
+  if(cast_on.mobile)
+    if(!CheckLineOfSight(who, cast_on))
+      SendSysMessage(who, "You can't see that.", 3, 40);
+      return 0;
+    endif
+  else
+    if(!CheckLosAt(who, cast_on.x, cast_on.y, cast_on.z))
+      SendSysMessage(who, "You can't see that.", 3, 40);
+      return 0;
+    endif
+  endif
+  if(cdist(who.x, who.y, cast_on.x, cast_on.y) > 12)
+    SendSysMessage(who,"The target is out of range.", 3, 40);
+    return 0;
+  endif
+  var umana;
+  case (circle)
+    1: umana :=   4;
+    2: umana :=   6;
+    3: umana :=   9;
+    4: umana :=  11;
+    5: umana :=  14;
+    6: umana :=  20;
+    7: umana :=  40;
+    8: umana :=  50;
+    9: umana :=  75;
+   10: umana := 100;
+  endcase
+  var mana := AP_GetVital(who, "Mana");
+  if(mana >= umana)
+    var ms := AP_SetVital(who, "Mana", Cint(mana - umana));
+    return 1;
+  else
+    SendSysMessage(who,"You do not have enough mana to cast that.", 3, 40);
+    return 0;
+  endif
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/startEqp.inc
===================================================================
--- trunk/096/scripts/include/OLD/startEqp.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/startEqp.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,595 @@
+use uo;
+use cfgfile;
+use os;
+use util;
+
+include ":attributes:attributes";
+
+var unique_items_created := {};
+var starteqp_cfg;
+var template;
+var magicspawnchance := 0;
+var magicadjustment  := 0;
+var making_starting_equipment := 0;
+
+var thecritter;
+
+function MakeLoot(corpse, lootgroup)
+  var npcdesc := ReadConfigFile("::npcdesc");
+  var elem := FindConfigElem(npcdesc, corpse.npctemplate);
+  var mprop, madj;
+  if(elem)
+    mprop := CInt(GetConfigInt(elem, "Magicitemchance"));
+    madj  := CInt(GetConfigInt(elem, "MagicAdjustment"));
+  else
+    mprop := 1;
+    if(corpse.objtype == 0x9e40)
+      case(CInt(GetObjProperty(corpse,"level")))
+        1: madj := 0;
+        2: madj := 2;
+        3: madj := 4;
+        4: madj := 6;
+        5: madj := 8;
+      endcase
+    else
+      magicadjustment := 0;
+    endif
+  endif
+  if(AP_GetVital(corpse, "Hits"))
+    foreach thing in ListEquippedItems(corpse)
+      if(thing.objtype == 0xe75)
+        corpse := thing;
+        break;
+      endif
+    endforeach
+  endif
+  thecritter := corpse;
+  if(mprop)
+    magicspawnchance := 1;
+  else
+    if((corpse.objtype == 0x9e40) || (corpse.objtype == 0xe40))
+      magicspawnchance := 1;
+    else
+      magicspawnchance := 0;
+    endif
+  endif
+  magicadjustment  := madj;
+  starteqp_cfg := ReadConfigFile("::nlootgroup");
+  if(lootgroup)
+    CreateFromGroup(corpse, lootgroup);
+  else
+    var lootgroups := GetConfigStringArray(elem, "lootgroup");
+    foreach str in lootgroups
+      CreateFromGroup(corpse, CInt(str));
+    endforeach
+  endif
+endfunction
+
+function CreateStartingEquipment(who, skillids)
+  making_starting_equipment := 1;
+  starteqp_cfg := ReadConfigFile("::starteqp");
+  foreach skillid in skillids
+    var skillname := GetSkillName(CInt(skillid));
+    CreateFromGroup(who.backpack, skillname);
+  endforeach
+  CreateFromGroup(who.backpack, "all");
+endfunction
+
+function CreateFromGroup(who, group)
+  if(making_starting_equipment != 1)
+	starteqp_cfg := ReadConfigFile("::nlootgroup");
+  endif
+  var elem := starteqp_cfg[group];
+  foreach str in GetConfigStringArray(elem, "Stack")
+    CreateFromStackString(who, str);
+  endforeach
+  foreach str in GetConfigStringArray(elem, "Item")
+    CreateFromItemString(who, str);
+  endforeach
+  foreach str in GetConfigStringArray(elem, "Random")
+    CreateFromRandomString(who, str);
+  endforeach
+  foreach str in GetConfigStringArray(elem, "Group")
+    CreateFromGroup(who, str);
+  endforeach
+  foreach str in GetConfigStringArray(elem, "Unique")
+    CreateFromUniqueString(who, str);
+  endforeach
+endfunction
+
+function GetSkillName(skillid)
+  var cfg := ReadConfigFile("::skills");
+  return cfg[skillid].name;
+endfunction
+
+function CreateFromItemString(who, str)
+  var params := SplitWords(str);
+  var count, objname, color, chance;
+  var colors := ReadConfigFile("::colors");
+  count := RandomDiceRoll(CStr(params[1]));
+  params[1] := params[2];
+  params[2] := params[3];
+  params[3] := params[4];
+  if (!count)
+    count := 1;
+  endif
+  objname := params[1];
+  if(CInt(params[2]))
+    color := CInt(params[2]);
+  elseif (params[2])
+    color := 0;
+    var colorg := FindConfigElem(colors, params[2]);
+    if(colorg)
+      var str := GetConfigStringArray(colorg, "color");
+	  var ar := {};
+	  var rndint := RandomInt(len(str)) + 1;
+	  ar := SplitWords(str[rndint]);
+	  if(len(ar) > 1)
+	    if(CInt(ar[2]) > 0)
+	      color := RandomInt(CInt(ar[2]) - CInt(ar[1]))+1;
+	    else
+	      color := CInt(str[RandomInt(len(str))+1]);
+	    endif
+	  else
+            color := CInt(str[RandomInt(len(str))+1]);
+	  endif
+	  if(color == 1)
+	    color := 0;
+	  endif
+    endif
+  endif
+  if (!color)
+    color := 0;
+  endif
+  if(CInt(params[3]))
+    chance := CInt(params[3]);
+  else
+    chance := 100;
+  endif
+  if(CInt(RandomInt(100)+1) <= CInt(chance))
+    var i, canbemagic;
+    for(i:=1; i<=CInt(count); i:=i+1)
+      if (CInt(objname))
+        objname := CInt(objname);
+      endif
+      var item := CreateItemInContainer(who, objname);
+      item.color := color;
+      if(making_starting_equipment)
+        item.newbie := 1;
+        continue;
+      endif
+      if( (item.graphic in array( 0xdf2, 0xdf3, 0xdf4, 0xdf5, 0x13f9 )) && (magicspawnchance == 1))
+        ProcessWand(item);
+      else
+        if(magicspawnchance == 1)
+          canbemagic := MagicAllowedandType(objname);
+          case(canbemagic)
+            1: WeaponTable(item);
+            2: ArmorTable(item);
+            3: ClothTable(item);
+          endcase
+        endif
+      endif
+    endfor
+  endif
+endfunction
+
+function ProcessWand(item)
+  var amt;
+  case(RandomInt(10) + 1)
+    1: amt :=  15;   SetObjProperty(item, "SpellId",  1);   SetObjProperty(item, "damagemod", "of clumsiness");
+    2: amt :=  15;   SetObjProperty(item, "SpellId",  3);   SetObjProperty(item, "damagemod", "of feeblemindedness");
+    3: amt :=  15;   SetObjProperty(item, "SpellId",  4);   SetObjProperty(item, "damagemod", "of healing");
+    4: amt :=  15;   SetObjProperty(item, "SpellId",  8);   SetObjProperty(item, "damagemod", "of weakness");
+    5: amt :=  10;   SetObjProperty(item, "SpellId", 12);   SetObjProperty(item, "damagemod", "of harming");
+    6: amt :=   5;   SetObjProperty(item, "SpellId", 18);   SetObjProperty(item, "damagemod", "of fireballs");
+    7: amt :=   5;   SetObjProperty(item, "SpellId", 29);   SetObjProperty(item, "damagemod", "of greater healing");
+    8: amt :=   3;   SetObjProperty(item, "SpellId", 30);   SetObjProperty(item, "damagemod", "of lightning");
+    9: amt :=  10;   SetObjProperty(item, "SpellId", 31);   SetObjProperty(item, "damagemod", "of mana draining");
+   10: amt := 100;   SetObjProperty(item, "SpellId", 65);   SetObjProperty(item, "damagemod", "of identification");
+  endcase
+  SetObjProperty(item, "charges", (amt + RandomInt(10)));
+  item.usescript := ":wands:magicWands";
+  var dsc;
+  if(item.objtype == 0x13f9)
+    dsc := "gnarled staff";
+  else
+    dsc := "wand";
+  endif
+  SetName(item, "a magic " + dsc);
+endfunction
+
+function ClothTable(item)
+  var val := RandomInt(19) + 1;
+  if(val >= 14)
+    var charges := RandomDiceRoll("1d30") + 10;
+    SetObjProperty(item, "charges", charges);
+    SetObjProperty(item, "type", "sight");
+    SetObjProperty(item, "damagemod", " of nightsight");
+  elseif(val >= 11)
+    var charges := RandomDiceRoll("1d30") + 10;
+    SetObjProperty(item, "charges", charges);
+    SetObjProperty(item, "type", "protection");
+    SetObjProperty(item, "damagemod", " of protection");
+  elseif(val <= 8)
+    var charges := RandomDiceRoll("1d30") + 10;
+    SetObjProperty(item, "charges", charges);
+    SetObjProperty(item, "type", "strength");
+    SetObjProperty(item, "damagemod", " of strength");
+  elseif(val > 5)
+    var charges := RandomDiceRoll("1d30") + 10;
+    SetObjProperty(item, "charges", charges);
+    SetObjProperty(item, "type", "invisibility");
+    SetObjProperty(item, "damagemod", " of invisibility");
+  elseif(val == 3)
+    var charges := RandomDiceRoll("1d30") + 10;
+    SetObjProperty(item, "charges", charges);
+    SetObjProperty(item, "type", "blessing");
+    SetObjProperty(item, "damagemod", " of blessing");
+  else
+    var charges := RandomDiceRoll("1d30") + 10;
+    SetObjProperty(item, "charges", charges);
+    SetObjProperty(item, "type", "reflect");
+    SetObjProperty(item, "damagemod", " of magic reflection");
+  endif
+  AddName(item);
+endfunction
+
+function ArmorTable(item)
+  var newarray := {1, 2};
+  var count := RandomInt(99) + 1;
+  var counter;
+  if(count >= 40)
+    counter := 1;
+  else
+    counter := 2;
+  endif
+  count := 0;
+  var num;
+  while(count <= counter)
+    num := RandomInt(99) + 1;
+    if(num >=  50)
+      num := 1;
+    else
+      num := 2;
+    endif
+    case(num)
+      1: ApplyHPMod(item);
+      2: ApplyARMod(item);
+    endcase
+    newarray.erase(num);
+    count := count + 1;
+  endwhile
+  if((RandomInt(10)+1) <= 1)
+    ExtraArmorTable(item);
+  endif
+  AddName(item);
+endfunction
+
+function ExtraArmorTable(item)
+  var val := RandomInt(4) + 1;
+  case(val)
+    1: var charges := RandomDiceRoll("1d30") + 10;
+       SetObjProperty(item, "charges", charges);
+       SetObjProperty(item, "type", "protection");
+       var dmgmod := GetObjProperty(item, "damagemod");
+       if(dmgmod)
+         dmgmod := dmgmod + " and protection";
+         SetObjProperty(item, "damagemod", dmgmod);
+       else
+         dmgmod := " of protection";
+         SetObjProperty(item, "damagemod", dmgmod);
+       endif
+    2: var charges := RandomDiceRoll("1d30") + 10;
+       SetObjProperty(item, "charges", charges);
+       SetObjProperty(item, "type", "strength");
+       var dmgmod := GetObjProperty(item, "damagemod");
+       if(dmgmod)
+         dmgmod := dmgmod + " and strength";
+         SetObjProperty(item, "damagemod", dmgmod);
+       else
+         dmgmod := " of strength";
+         SetObjProperty(item, "damagemod", dmgmod);
+       endif
+    3:  var charges := RandomDiceRoll("1d30") + 10;
+       SetObjProperty(item, "charges", charges);
+       SetObjProperty(item, "type", "blessing");
+       var dmgmod := GetObjProperty(item, "damagemod");
+       if(dmgmod)
+         dmgmod := dmgmod + " and blessing";
+         SetObjProperty(item, "damagemod", dmgmod);
+       else
+         dmgmod := " of blessing";
+         SetObjProperty(item, "damagemod", dmgmod);
+       endif
+    4: var charges := RandomDiceRoll("1d30") + 10;
+       SetObjProperty(item, "charges", charges);
+       SetObjProperty(item, "type", "reflect");
+       var dmgmod := GetObjProperty(item, "damagemod");
+       if(dmgmod)
+         dmgmod := dmgmod + " and magic reflection";
+         SetObjProperty(item, "damagemod", dmgmod);
+       else
+         dmgmod := " of magic reflection";
+         SetObjProperty(item, "damagemod", dmgmod);
+       endif
+  endcase
+endfunction
+
+function WeaponTable(item)
+  var newarray := array(1, 2, 3);
+  var count := RandomInt(100) + 1;
+  var counter;
+  if(count >= 60)
+    counter := 1;
+  elseif(count >= 40)
+    counter := 2;
+  elseif(count >= 10)
+    counter := 3;
+  else
+    counter := 4;
+  endif
+  if(counter == 1)
+    DestroyItem(item);
+    return;
+  endif
+  count := 0;
+  var num, val;
+  while(count <= counter)
+    num := RandomInt(len(newarray)) + 1;
+    val := newarray[num];
+    case(val)
+      1: ApplyAccyMod(item);
+      2: ApplyHPMod(item);
+      3: ApplyDmgMod(item);
+    endcase
+    newarray.erase(num);
+    count := count + 1;
+  endwhile
+  AddName(item);
+endfunction
+
+function CreateFromRandomString(who, desc)
+  var params := SplitWords(desc);
+  var amt := Cint(params[1]);
+  var count := 1;
+  if(amt != 1)
+    count := RandomDiceRoll(Cstr(amt + 1));
+  endif
+  var group := params[2];
+  var chance := params[4];
+  var elem := FindConfigElem(starteqp_cfg, group);
+  if(elem == error)
+    syslog("Unable to find group " + group);
+    return;
+  endif
+  var items := GetConfigStringArray(elem, "Item");
+  if(items == error)
+    syslog("Group " + group + " does not contain items!");
+    return;
+  endif
+  if(!chance)
+    chance := 100;
+  endif
+  var rand := RandomInt(99)+1;
+  if(CInt(rand) <= CInt(chance))
+    if(count > len(items))
+      count := len(items);
+    endif
+    while(count)
+      var n := RandomInt(len(items)) + 1;
+      if(items[n])
+        CreateFromItemString(who, items[n]);
+        if(making_starting_equipment)
+          items[n] := "";
+        endif
+        count := count - 1;
+      endif
+    endwhile
+  endif
+endfunction
+
+function CreateFromUniqueString(who, str)
+  var params := SplitWords(str);
+  var objtype;
+  if (CInt(params[1]))
+    objtype := params[1];
+  else
+    objtype := GetObjtypeByName(params[1]);
+  endif
+  if(!objtype)
+    syslog("Don't know what a " + str + " is");
+    return;
+  endif
+  if(objtype in unique_items_created)
+    return;
+  endif
+  unique_items_created[len(unique_items_created) + 1] := objtype;
+  var newstr := "1 " + str;
+  CreateFromItemString(who, newstr);
+endfunction
+
+function CreateFromStackString(who, str)
+  var params := SplitWords(str);
+  var count;
+  var objname;
+  var color;
+  var chance;
+  count := RandomDiceRoll(CStr(params[1]));
+  params[1] := params[2];
+  params[2] := params[3];
+  params[3] := params[4];
+  if (!count)
+    count := 1;
+  endif
+  objname := params[1];
+  if(CInt(params[2]))
+    color := CInt(params[2]);
+  else
+    color := 0;
+  endif
+  if (CInt(params[3]))
+    chance := CInt(params[3]);
+  else
+    chance := 100;
+  endif
+  var rand := RandomInt(100)+1;
+  if(CInt(rand) <= CInt(chance))
+    if (CInt(objname))
+      objname := CInt(objname);
+    endif
+    var item := CreateItemInContainer(who, objname, count);
+    if(!item)
+      syslog("Unable to create " + objname + " on " + who.name + ".");
+    endif
+    item.color := color;
+    if(making_starting_equipment)
+      item.newbie := 1;
+    endif
+  endif
+endfunction
+
+function MagicAllowedandType(objname)
+  var magicweapcfg := ReadConfigFile(":combat:magicweaps");
+  var magicarmorcfg := ReadConfigFile(":combat:magicarmor");
+  var magicclothcfg := ReadConfigFile(":combat:magiccloth");
+  var elem1 := FindConfigElem(magicweapcfg, "1");
+  var data1 := GetConfigInt(elem1, objname);
+  if(data1)
+    return 1;
+  endif
+  var elem2 := FindConfigElem(magicarmorcfg, "1");
+  var data2 := GetConfigInt(elem2, objname);
+  if(data2)
+    return 2;
+  endif
+  var elem3 := FindConfigElem(magicclothcfg, "1");
+  var data3 := GetConfigInt(elem3, objname);
+  if(data3)
+    return 3;
+  endif
+  return 0;
+endfunction
+
+function ApplyDmgMod(item)
+  var numb := ((RandomInt(100)+1) - magicadjustment);
+  if(numb < 1)
+    numb := 1;
+  endif
+  if(numb >= 50)
+    item.dmg_mod := 1;
+    SetObjProperty(item, "damagemod", "of ruin");
+  elseif(numb >= 25)
+    item.dmg_mod := 3;
+    SetObjProperty(item, "damagemod", "of might");
+  elseif(numb >= 15)
+    item.dmg_mod := 5;
+    SetObjProperty(item, "damagemod", "of force");
+  elseif(numb >= 5)
+    item.dmg_mod := 7;
+    SetObjProperty(item, "damagemod", "of power");
+  elseif(numb >= 1)
+    item.dmg_mod := 9;
+    SetObjProperty(item, "damagemod", "of vanquishing");
+  endif
+  SilverMod(item);
+endfunction
+
+function ApplyAccyMod(item)
+  var numb := ((RandomInt(100)+1) - magicadjustment);
+  if(numb < 1)
+    numb := 1;
+  endif
+  var modifier := 0;
+  if(numb >= 50)
+    modifier := 5;
+    SetObjProperty(item, "accuracy", "accurate");
+  elseif(numb >= 25)
+    modifier := 10;
+    SetObjProperty(item, "accuracy", "surpassingly accurate");
+  elseif(numb >= 15)
+    modifier := 15;
+    SetObjProperty(item, "accuracy", "eminently accurate");
+  elseif(numb >= 5)
+    modifier := 20;
+    SetObjProperty(item, "accuracy", "exceedingly accurate");
+  elseif(numb >= 1)
+    modifier := 25;
+    SetObjProperty(item, "accuracy", "supremely accurate");
+  endif
+  SetObjProperty(item, "type", "accuracy");
+  SetObjProperty(item, "gain", modifier);
+endfunction
+
+function ApplyHPMod(item)
+  var numb := ((RandomInt(100)+1) - magicadjustment);
+  if(numb < 1)
+    numb := 1;
+  endif
+  if(numb >= 50)
+    item.maxhp_mod := item.maxhp_mod + 05;
+    SetObjProperty(item, "durability", "durable");
+  elseif(numb >= 25)
+    item.maxhp_mod := item.maxhp_mod + 10;
+    SetObjProperty(item, "durability", "substantial");
+  elseif(numb >= 15)
+    item.maxhp_mod := item.maxhp_mod + 15;
+    SetObjProperty(item, "durability", "massive");
+  elseif(numb >= 5)
+    item.maxhp_mod := item.maxhp_mod + 20;
+    SetObjProperty(item, "durability", "fortified");
+  elseif(numb >= 1)
+    item.maxhp_mod := item.maxhp_mod + 25;
+    SetObjProperty(item, "durability", "indestructable");
+  endif
+  item.hp := item.maxhp;
+endfunction
+
+function ApplyARMod(item)
+  var numb := ((RandomInt(100)+1) - magicadjustment);
+  if(numb < 1)
+    numb := 1;
+  endif
+  if(numb >= 50)
+    item.ar_mod := 5;
+    SetObjProperty(item, "damagemod", "of defense");
+  elseif(numb >= 25)
+    item.ar_mod := 10;
+    SetObjProperty(item, "damagemod", "of guarding");
+  elseif(numb >= 15)
+    item.ar_mod := 15;
+    SetObjProperty(item, "damagemod", "of hardening");
+  elseif(numb >= 5)
+    item.ar_mod := 20;
+    SetObjProperty(item, "damagemod", "of fortification");
+  elseif(numb >= 1)
+    item.ar_mod := 25;
+    SetObjProperty(item, "damagemod", "of invulnerability");
+  endif
+endfunction
+
+function SilverMod(item)
+  var numb := (RandomInt(10) + 1);
+  if(numb == 1)
+    var hits := GetObjProperty(item, "OnHit");
+    if(!hits)
+      hits := {};
+    endif
+    hits.append("silverHit");
+    SetObjProperty(item, "OnHit", hits);
+    SetObjProperty(item, "silvermod", 1);
+  endif
+endfunction
+
+function AddName(item)
+  var currdesc := item.desc;
+  if(currdesc[1] == "a")
+    var space := find(item.desc, " ", 1);
+    var newname := currdesc[space+1,len(item.desc)];
+    SetName(item,"a magic " + newname);
+  else
+    SetName(item, "magic " + currdesc);
+  endif
+endfunction
+
+

Added: trunk/096/scripts/include/OLD/statMod.inc
===================================================================
--- trunk/096/scripts/include/OLD/statMod.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/statMod.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,52 @@
+use uo;
+use util;
+
+include ":attributes:attributes";
+
+function GetModAmount(magery)
+  var mod_amount := CInt(RandomInt(3) +(magery/10));
+  if(mod_amount > 10)
+    mod_amount := 10;
+  endif
+  return mod_amount;
+endfunction
+
+function GetModDuration(magery)
+  var duration := CInt(60 +((magery / 30) * 60));
+  return(duration);
+endfunction
+
+function CanMod(who, stat)
+  var mod;
+  case(stat)
+    "str": mod := "#ss";
+    "dex": mod := "#dd";
+    "int": mod := "#ii";
+    "p"  : mod := "#pp";
+    "ar" : mod := "#ar";
+  endcase
+  if(GetObjProperty(who, mod))
+    return 0;
+  else
+    return 1;
+  endif
+endfunction
+
+function DoTempMod(who, stat, amt, duration)
+  var mod;
+  case(stat)
+    "str":  mod := "#ss";  AP_SetStatMod(who, "Strength", AP_GetStatMod(who, "Strength") + amt);
+    "dex":  mod := "#dd";  AP_SetStatMod(who, "Dexterity", AP_GetStatMod(who, "Dexterity") + amt);
+    "int":  mod := "#ii";  AP_SetStatMod(who, "Intelligence", AP_GetStatMod(who, "Intelligence") + amt);
+    "ar" :  mod := "#ar";  who.ar_mod           := who.ar_mod + amt;
+	"p"  :  mod := "#pp";  who.setParalyzed(1);
+  endcase
+  SetObjProperty(who,mod,1);
+  var parms := {};
+  parms[2] := who;
+  parms[1] := stat;
+  parms[3] := amt;
+  parms[4] := duration;
+  parms[5] := who.serial;
+  start_script("::/misc/unmod", parms);
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/std.inc
===================================================================
--- trunk/096/scripts/include/OLD/std.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/std.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,517 @@
+/***************************************************************************
+
+	STANDARD POL INCLUDE FILE v0.4
+
+	Last Update: 2001-03-02
+
+	This file is a collection of the most used (and useful) functions
+	available in the POL community. It's intended to be a replacement
+	for those include files that everyone has but were never released
+	to the public, providing a wide set of single functions.
+
+	This file is supposed to be kept by the community but administrated
+	by the one member. If you have a function to add to this file, or
+	have a code	tweak or optimization, don't hesitate to send an email to:
+	HellRaider <zion at uo.com.br>
+
+Functions (Alphabetical) List:
+		CreateStackArrayInContainer (container, objtype, amount, limit_per_stack := 60000)
+			- Creates a dynamic number os stacks into the given container,
+			based on the given amount, respecting a limit amount for each
+			stack.
+			Returns: array of ObjRefs to each created stack.
+			Examples:
+				CreateStackArrayInContainer(container, UOBJ_GOLDCOIN, 90000)
+					- Creates 2 piles of gold into the container, the first
+					with 60k coins, and the second with 30k coins.
+				CreateStackArrayInContainer(container, UOBJ_GOLDCOIN, 90000, 10000)
+					- Creates 9 piles of 10k gold into the container.
+
+		GetFormattedTime()
+			Returns: string containing the current in-game time in
+			military/internation format "HH:MM".
+
+		GetGoldInContainer(container)
+			- Loops through the given container looking for gold stacks.
+			Returns: an array where the first element is the sum of gold
+				within the container, and the following elements are ObjRefs
+				to the gold piles found.
+			Example: if used at a container with 2 piles of 10k gold, the
+				function would return {20000, 1st_pile, 2nd_pile}.
+
+		GetSpelledTime()
+			Returns: string containing the spelled in-game time, just like
+			in OSI Shards.
+			Examples:
+				"half past two in the morning."
+				"eight o'clock at night."
+				"midnight."
+
+		GetStacksOfTypeInContainer (container, objtype)
+			- Loops through the given container looking for item stacks from the
+			given objtype.
+			Returns: an array where the first element is the sum of items from the
+				given objtype within the container, and the following elements are
+				ObjRefs to the item stacks found.
+			Example: if used at a container with 2 stacks of 50 cloth, the function
+				would return {100, 1st_stack_of_cloth, 2nd_stack_of_cloth}.
+
+
+		GetStorageArea (areaname)
+			- Finds an storage area by name. If no matching storage area is found,
+			this function creates a new storage area with the given name.
+			Returns: reference to the storage area found or created.
+
+		GetStorageRoot (storage, rootname, objtype := 0x0E7C)
+			- Finds a container with the given name in the storage area.
+			If no matching root container is found, this function creates one
+			using the given objtype (default is a metalbox, like a bank box).
+			Returns: reference to the root container found or created.
+
+		GetStrAfter (needle, byref haystack)
+			- This function finds the first occurrence of needle within haystack
+			then returns the remaining characters in the string.
+			Returns: all characters found after needle in haystack.
+				GetStrAfter("this ", "this rocks") returns "rocks";
+				GetStrAfter("sky ", "the sky is blue") returns "is blue";
+
+		GetStrBefore (needle, byref haystack)
+			- This function finds the first occurrence of needle within haystack
+			then returns the preceding characters in the string.
+			Returns: all characters preceding needle in haystack.
+				GetStrBefore(" ", "pol rocks") returns "pol";
+				GetStrBefore(" is ", "the sky is blue") returns "the sky";
+
+		GetTimeOfDay()
+			Returns: elapsed seconds in the current UO day.
+
+		ListObjectsOfClassNearLocation(x, y, z, range, POLCLASS, flags := LISTEX_FLAG_NORMAL, realm := "britannia")
+			- Returns an array of itemrefs of the specified POLCLASS;
+			- flags can be a set of LISTEX_* constants, and are only used
+			with POLCLASS_UOBJECT, POLCLASS_MOBILE and POLCLASS_NPC.
+			Returns: array of ObjRefs found.
+
+		MoveItemToForcedLocation(item, x, y, z)
+			- Moves item ignoring it's movable state.
+			Returns: nonzero if successful, error otherwise.
+
+		MoveItem(item, byref place, flags := MOVEITEM_NORMAL)
+			- Moves item either to a container or to a place depending of
+			the parameter passed. Item will be moved to a container if the
+			parameter is a ContainerRef, or a location if it's an array.
+			- flags can be a set of MOVEITEM_* constants.
+			- If an array of 2 integers is passed as the 'place' paramemter
+			this function finds an appropriated 3rd parameter to be the Z
+			coordinate of the location; since this parameter is passed byref
+			the original array will have the 3rd parameter set once the function
+			returns.
+			Possible usages:
+				MoveItem(item, TargetCoordinates(player));
+				MoveItem(item, {1234, 5678});
+				MoveItem(item, {1234, 5678, 9});
+				MoveItem(item, player.backpack);
+			Returns: nonzero if successfull, error if the item couldn't be
+				moved or if an invalid parameter was passed.
+
+		RandomListInt (tableref)
+			- Returns a random integer based on a special config file "table".
+			The passed parameter must be a reference to a config file "table".
+			The table is meant to be structured like this:
+
+				List [table name]
+				{
+					Count 4
+					Elem0		1	5
+					Elem1		6	10
+					Elem2		11	15
+					Elem3		16
+				}
+
+			Count counts the number of "Elements" within the table. The elements
+			are inserted starting by zero. Each element may hold either, a number
+			or a range. In the previous example, the first 3 elements are ranges,
+			and the fourth element is an unique number. This function will first
+			choose a random element, and then check if it's a range or an unique
+			number, if it's an unique number the function will return the number,
+			otherwise the function will return a random number within the specified
+			range. Note that number 16 has a 25% chance to be picked up, while
+			each number (inclusive) from 1 to 15 has a 5% chance (75%/15).
+			Possible usages:
+				RandomListInt(ReadConfigFile("::colors")[ALL_COLORS]);
+				RandomListInt(config[24]);
+			Returns: random integer.
+
+		Season (player, season_id)
+			- Use this function to set one's client-side season.
+			- Possible values for seasons:
+				SEASON_SUMMER	: Looks like "old Britannia".
+				SEASON_FALL		: What it suggests.
+				SEASON_WINTER	: Ugly like a dog sucking mango.
+				SEASON_FELUCCA	: Chaotic look!
+				SEASON_SPRING	: Trammel, home of the care bears.
+			- Note that this function doesn't check the validity of the passed
+			season id, just because I don't want to sacrifice performance,
+			please use the constant values above to avoid problems.
+
+		SubtractFromStackArray (byref arrayofobjrefs, amount)
+			- Loops through the array of objects until the given amount of
+			items is subtracted, or the last item is destroyed. IE if 2 piles
+			of 10k gold are passed as the first argument, and 15000 is passed
+			as the second argument, the first pile will be destroyed and the
+			second pile will have 5000 gold subtracted from it.
+			- In case the array contains non-POL-items objects, those objects
+			are ignored.
+			Returns: amount of items successfully subtracted.
+
+		ToSextant(x, y)
+			Returns: a formated string containing the sextant coordinates
+				for the location; ie, 29o 52'N, 138o 57'W
+
+
+	A history of changes can be found at the end of this file.
+	The contants below can be adjusted to fit your Shard's design.
+
+***************************************************************************/
+
+const STD_DAY_LENGTH := 7200;	// A whole UO day in seconds (7200 is equivalent to 2 hours)
+const STD_GOLD := 0x0EED;		// ObjType for gold coins.
+
+// HellRaider <zion at uo.com.br> 2000-12-19
+// Required Modules: UO
+function CreateStackArrayInContainer (container, objtype, amount, limit_per_stack := 60000)
+	var result array;
+	for loops := 1 to (amount/limit_per_stack)
+		result.append(CreateItemInContainer(container, objtype, limit_per_stack));
+	endfor
+	result.append(CreateItemInContainer(container, objtype, amount-(amount/limit_per_stack)*limit_per_stack));
+	return result;
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-13
+// Required Modules: UO BASIC
+function GetFormattedTime()
+    var time := GetTimeOfDay();
+    var raw_time := 24.0/(CDbl(STD_DAY_LENGTH)/time);
+    var hours := CInt(raw_time);
+    var minutes := CInt((raw_time-hours)*60);
+    if (minutes < 10)
+		minutes := "0"+minutes;
+    endif
+    if (hours < 10)
+		hours := "0"+hours;
+    endif
+    return (hours+":"+minutes);
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-18
+// Required Modules: UO
+function GetGoldInContainer (container)
+	var result := {0};
+	foreach item in EnumerateItemsInContainer(container)
+		if (item.objtype = STD_GOLD)
+			result.append(item);
+			result[1] := result[1]+item.amount;
+		endif
+	endforeach
+	return result;
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-13
+// Required Modules: UO BASIC
+// Dependencies: SpellHour(hours)
+function GetSpelledTime()
+	var time := GetTimeOfDay();
+    var raw_time := 24.0/(CDbl(STD_DAY_LENGTH)/time);
+    var hours := CInt(raw_time);
+    var minutes := CInt((raw_time-hours)*60);
+	var ext;
+	if (hours<11)
+		ext := " in the morning.";
+	elseif (hours>11 and hours<19)
+		ext := " in the afternoon.";
+	else
+		ext := " at night.";
+	endif
+	if (hours>12)
+		hours := hours-12;
+	endif
+	if (minutes<15)
+		if (!hours or hours=12)
+			return SpellHour(hours);
+		else
+			return SpellHour(hours)+" o'clock"+ext;
+		endif
+	elseif (minutes > 14 and minutes < 30)
+		if (!hours or hours=12)
+			return "quarter past "+SpellHour(hours);
+		else
+			return "quarter past "+SpellHour(hours)+ext;
+		endif
+	elseif (minutes > 29 and minutes < 45)
+		if (!hours or hours=12)
+			return "half past "+SpellHour(hours);
+		else
+			return "half past "+SpellHour(hours)+ext;
+		endif
+	else
+		if (!hours or hours=12)
+			return "quarter to "+SpellHour(hours+1);
+		else
+			return "quarter to "+SpellHour(hours+1)+ext;
+		endif
+	endif
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-13
+function SpellHour (hours)
+	case (hours)
+		0:	return "midnight.";
+		1:	return "one";
+		2:	return "two";
+		3:	return "three";
+		4:	return "four";
+		5:	return "five";
+		6:	return "six";
+		7:	return "seven";
+		8:	return "eight";
+		9:	return "nine";
+		10:	return "ten";
+		11:	return "eleven";
+		12:	return "midday.";
+	endcase
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-18
+// Required Modules: UO
+function GetStacksOfTypeInContainer (container, objtype)
+	var result := {0};
+	foreach item in EnumerateItemsInContainer(container)
+		if (item.objtype = objtype)
+			result.append(item);
+			result[1] := result[1]+item.amount;
+		endif
+	endforeach
+	return result;
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-13
+// Required Modules: UO
+function GetStorageArea (areaname)
+	var area := FindStorageArea(areaname);
+	if (!area)
+		return CreateStorageArea(areaname);
+	endif
+	return area;
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-13
+// Required Modules: UO
+function GetStorageRoot (storage, rootname, objtype := 0x0E7C)
+	var item := FindRootItemInStorageArea(storage, rootname);
+	if (!item)
+		return CreateRootItemInStorageArea(storage, rootname, objtype);
+    endif
+	return item;
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-13
+// Required Modules: BASIC
+function GetStrAfter (needle, byref haystack)
+	return haystack[Find(haystack, needle, 1)+len(needle), len(haystack)];
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-13
+// Required Modules: BASIC
+function GetStrBefore (needle, byref haystack)
+	return haystack[1, Find(haystack, needle, 1)];
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-13
+// Required Modules: UO
+//function GetTimeOfDay()
+//    var time := ReadGameClock();
+//	return (time-((time/STD_DAY_LENGTH)*STD_DAY_LENGTH));
+//endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-13
+// Required Modules: UO
+// Notes: POLCLASS_UOBJECT will return both, mobiles and items.
+// This function is limited and it'd be a good idea to have core support for it.
+function ListObjectsOfClassNearLocation (x, y, z, range, POLCLASS, flags := LISTEX_FLAG_NORMAL, realm := "britannia")
+	case (POLCLASS)
+		POLCLASS_UOBJECT:
+			return ListObjectsInBox(x-range, y+range, z-10, x+range, y-range, z+10, realm);
+		POLCLASS_MOBILE: //I'll separate it from POLCLASS_NPC for performance purposes.
+			return ListMobilesNearLocationEx(x, y, z, range, flags, realm);
+		POLCLASS_NPC:
+			var result array;
+			foreach mobile in ListMobilesNearLocationEx(x, y, z, range, flags, realm)
+				if (mobile.isa(POLCLASS_NPC)) result.append(mobile); endif
+			endforeach
+			return result;
+		default:
+			var result array;
+			foreach item in ListItemsNearLocation(x, y, z, range, realm)
+				if (item.isa(POLCLASS)) result.append(item); endif
+			endforeach
+			return result;
+	endcase
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-13
+// Required Modules: UO
+// This function forces the move in every aspect: using MOVEITEM_FORCELOCATION
+// and setting the item movable state to 1 if it's zero. The movable state is
+// set back to it's original state.
+function MoveItemToForcedLocation (item, x, y, z)
+	if (!item.movable)
+		item.movable := 1;
+		var result := MoveItemToLocation(item, x, y, z, MOVEITEM_FORCELOCATION);
+		item.movable := 0;
+		return result;
+	endif
+	return MoveItemToLocation(item, x, y, z, MOVEITEM_FORCELOCATION);
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-13
+// Required Modules: UO
+function MoveItem (item, byref place, flags := MOVEITEM_NORMAL)
+	if (place.isa(POLCLASS_CONTAINER))
+		return MoveItemToContainer(item, place);
+	elseif (place=array)
+		case (place.size())
+			0:1:
+				var result := error;
+				result.+errortext := "Parameter place has less than 2 elements."
+				return result;
+			2:
+				place[3] := GetWorldHeight(place[1], place[2], item.realm);
+				continue;
+			default:
+				return MoveItemToLocation(item, place[1], place[2], place[3], flags);
+		endif
+	endif
+	var result := error;
+	result.+errortext := "Invalid place: expected an ContainerRef or Array, got "+place+".";
+	return result;
+endfunction
+
+// HellRaider <zion at uo.com.br> 2001-01-17
+// Required Modules: BASIC CFGFILE UTIL
+function RandomListInt (tableref)
+	var elem := SplitWords(GetConfigString(tableref, "Elem"+RandomInt(tableref.Count)));
+	elem[1] := CInt(elem[1]);
+	if (elem.Size()=1)
+		return elem[1];
+	else
+		return RandomInt(CInt(elem[2])-elem[1])+elem[1];
+	endif
+endfunction
+
+// HellRaider <zion at uo.com.br> 2001-03-02
+// Required Modules: UO
+const SEASON_SUMMER		:= 1;
+const SEASON_FALL		:= 2;
+const SEASON_WINTER		:= 3;
+const SEASON_FELUCCA	:= 4;
+const SEASON_SPRING		:= 5;
+function Season (player, season_id)
+	// Doesn't support cursor customization, yet.
+	SendPacket(player, "BC0"+season_id+"01");
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-18
+// Required Modules: UO
+function SubtractFromStackArray (byref arrayofobjrefs, amount)
+	var needed := amount;
+	foreach item in arrayofobjrefs
+		if (!item.isa(POLCLASS_ITEM)) continue; endif
+		if (item.amount<needed)
+			needed := needed-item.amount;
+			SubtractAmount(item, item.amount);
+		else
+			SubtractAmount(item, needed);
+			return amount;
+		endif
+	endforeach
+	return (amount-needed);
+endfunction
+
+// HellRaider <zion at uo.com.br> 2000-12-13
+// Required Modules: UO BASIC MATH
+// Note: For some (rare) coords this function returns the minutes with 1 tile off OSI's.
+// Each cartesian coord still have an unique sextant coord though (shouldn't be a problem).
+// OSI uses a special rounding function for it.
+function ToSextant(x, y)
+	var latitude_direction, longitude_direction;
+	var latitude_degrees, longitude_degrees;
+	var latitude_minutes, longitude_minutes;
+
+	latitude_degrees := (y-1624)*0.087890625;
+	longitude_degrees := (x-1323)*0.0703125;
+
+	if (latitude_degrees < 0)
+		latitude_direction := "N";
+	else
+		latitude_direction := "S";
+	endif
+
+	if (longitude_degrees < 0)
+		longitude_direction := "W";
+	else
+		longitude_direction := "E";
+	endif
+
+	latitude_degrees := Abs(latitude_degrees);
+	longitude_degrees := Abs(longitude_degrees);
+
+	//The next lines get the first 2 digits from the decimal part of the real variables
+	//and multiply by 60, returning an integer.
+	latitude_minutes := ((((latitude_degrees-Floor(latitude_degrees))*100)*60)/100);
+	longitude_minutes := ((((longitude_degrees-Floor(longitude_degrees))*100)*60)/100);
+
+	return(	Floor(latitude_degrees)+"o "+latitude_minutes+"'"+latitude_direction+", "+
+			Floor(longitude_degrees)+"o "+longitude_minutes+"'"+longitude_direction);
+endfunction
+
+/***************************************************************************
+
+	HISTORY OF CHANGES
+
+	Version 0.1
+		- Added the followind functions:
+			GetFormattedTime();
+			GetSpelledTime();
+			GetStorageArea (byref areaname);
+			GetStorageRoot (storage, byref rootname, objtype := 0x0E7C);
+			GetStrAfter (byref needle, byref haystack);
+			GetStrBefore (byref needle, byref haystack);
+			GetTimeOfDay();
+			ListObjectsOfClassNearLocation(x, y, z, range, POLCLASS, flags := LISTEX_FLAG_NORMAL);
+			MoveItemToForcedLocation(item, x, y, z);
+			MoveItem(item, byref place, flags := MOVEITEM_NORMAL);
+			ToSextant(x, y);
+
+	Version 0.2
+		- Added function GetGoldInContainer(container).
+
+	Version 0.3
+		- Added History of Changes.
+		- Added function CreateStackArrayInContainer (container, objtype, amount, limit_per_stack := 60000).
+		- Added function GetStacksOfTypeInContainer (container, objtype).
+		- Added function SubtractFromStackArray (byref arrayofobjrefs, amount).
+		- Fixed a bug in GetGoldInContainer(container) that would generate a compilation error.
+		- Fixed a bug in MoveItem (item, byref place, flags := MOVEITEM_NORMAL).
+		- Small tweak on the design of GetGoldInContainer(container). Since POL arrays don't support
+		elements at index zero, the function was changed so the first element (index one) is the sum
+		of the amount of gold found within the container, and the following elements are objrefs to
+		the piles of gold.
+
+	Version 0.4
+		- Added RandomListInt(tableref).
+		- Added Season(player, season_id).
+		
+	Version 0.5
+		- Racalac added realm param to ListObjectsOfClassNearLocation
+
+***************************************************************************/

Added: trunk/096/scripts/include/OLD/stringArrays.inc
===================================================================
--- trunk/096/scripts/include/OLD/stringArrays.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/stringArrays.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,23 @@
+
+function array2string(thearray)
+        var retval;
+
+        foreach word in thearray
+                retval := retval + " " + thearray;
+        endforeach
+
+        retval := retval[2,1000000];
+
+        return retval;
+endfunction
+
+
+function string2array(thestring)
+
+        var retval := array;
+        retval := SplitWords(thestring);
+
+endfunction
+
+
+       
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/teleporters.inc
===================================================================
--- trunk/096/scripts/include/OLD/teleporters.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/teleporters.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,410 @@
+use uo;
+use os;
+use cfgfile;
+
+var teleporters := {
+////yew to t2a tunnel
+    { 312,   786,  -24,    5748,   361,    2},
+    { 313,   786,  -24,    5749,   361,    2},
+    { 314,   786,  -24,    5750,   361,    4},
+    {5748,   362,    2,     312,   787,  -24},
+    {5749,   362,    0,     313,   787,  -24},
+    {5750,   362,    3,     314,   787,  -24},
+           
+////jhelom teleporters
+    {1142,  3621,    5,    1414,  3828,    5},
+    {1406,  3996,    5,    1414,  3828,    5},
+    {1409,  3824,    5,    1124,  3623,    5},
+    {1419,  3832,    5,    1466,  4015,    5},
+
+//// moonglow teleporters
+    {4300,   968,    5,    4442,  1122,    5},
+    {4436,  1107,    5,    4300,   992,    5},
+    {4443,  1137,    5,    4487,  1475,    5},
+    {4449,  1107,    5,    4539,   890,   28},
+    {4449,  1115,    5,    4671,  1135,   10},
+    {4496,  1475,   15,    4442,  1122,    5},
+    {4540,   898,   32,    4442,  1122,    5},
+    {4663,  1134,   13,    4442,  1122,    5},
+
+////hedge maze
+    {1163,  2208,   60,    1171,  2202,    0},
+    {1165,  2205,   40,    1163,  2209,   60},
+    {1166,  2237,   60,    1163,  2208,    0},
+
+////destard
+//enterance
+    {1175,  2635,    0,    5242,  1006,    0},
+    {1176,  2635,    0,    5243,  1006,    0},
+    {1177,  2635,    0,    5244,  1006,    0},
+    {5242,  1007,    0,    1175,  2636,    0},
+    {5243,  1007,    0,    1176,  2636,    0},
+    {5244,  1007,    0,    1177,  2636,    0},
+//lvl1 - lvl2
+    {5129,   909,  -28,    5142,   798,   17},
+    {5130,   909,  -28,    5143,   798,   17},
+    {5131,   909,  -28,    5144,   798,   17},
+    {5132,   909,  -28,    5145,   798,   17},
+    {5142,   797,   22,    5129,   908,  -28},
+    {5143,   797,   22,    5130,   908,  -28},
+    {5144,   797,   22,    5131,   908,  -28},
+    {5145,   797,   22,    5132,   908,  -28},
+//lvl2 - lvl3 
+    {5153,   808,  -25,    5134,   984,   17},
+    {5153,   809,  -25,    5134,   985,   17},
+    {5153,   810,  -25,    5134,   986,   17},
+    {5153,   811,  -25,    5134,   987,   17},
+    {5133,   984,   22,    5152,   808,  -19},
+    {5133,   985,   22,    5152,   809,  -19},
+    {5133,   986,   22,    5152,   810,  -19},
+    {5133,   987,   22,    5152,   811,  -19},
+
+////shame
+//enterance
+    { 512,  1559,    0,    5394,   126,    0},
+    { 513,  1559,    0,    5395,   126,    0},
+    { 514,  1559,    0,    5396,   126,    0},
+    {5394,   127,    0,     512,  1560,    0},
+    {5395,   127,    0,     513,  1560,    0},
+    {5396,   127,    0,     514,  1560,    0},
+//lvl1 - lvl2
+    {5490,    19,  -30,    5514,    10,    0},
+    {5514,    10,    0,    5490,    19,  -30},
+//lvl2 - lvl3
+    {5604,   102,    5,    5514,   148,   25},
+    {5514,   148,   25,    5604,   102,    5},
+//lvl3 - lvl4
+    {5538,   170,    5,    5513,   176,    5},
+    {5513,   176,    5,    5538,   170,    5},
+//lvl4 - lvl5
+    {5507,   162,    5,    5875,    19,   -5},
+    {5875,    19,   -5,    5507,   162,    5},
+
+////deceit
+//enterance
+    {4110,   430,    5,    5187,   638,    0},
+    {4111,   430,    5,    5188,   638,    0},
+    {4112,   430,    5,    5189,   638,    0},
+    {5187,   639,    0,    4110,   431,    5},
+    {5188,   639,    0,    4111,   431,    5},
+    {5189,   639,    0,    4112,   431,    5},
+//lvl1 - lvl2
+    {5216,   587,  -18,    5304,   531,   12},
+    {5217,   587,  -18,    5305,   531,   12},
+    {5218,   587,  -18,    5306,   531,   12},
+    {5304,   530,   17,    5216,   586,  -13},
+    {5305,   530,   17,    5217,   586,  -13},
+    {5306,   530,   17,    5218,   586,  -13},
+//lvl2 - lvl3
+    {5346,   578,    5,    5137,   649,    5},
+    {5137,   649,    5,    5346,   578,    5},
+//lvl3 - lvl4
+    {5218,   761,  -28,    5305,   650,   12},
+    {5219,   761,  -28,    5306,   650,   12},
+    {5305,   649,   17,    5218,   760,    1},
+    {5306,   549,   17,    5219,   760,    1},
+
+////wrong
+//enterance
+    {2041,   215,   14,    5824,   630,    0},
+    {2042,   215,   14,    5825,   630,    0},
+    {2043,   215,   14,    5826,   630,    0},
+    {5824,   631,    0,    2041,   216,   14},
+    {5825,   631,    0,    2042,   216,   14},
+    {5826,   631,    0,    2043,   216,   14},
+//lvl1 - lvl2
+    {5826,   592,    0,    5690,   569,   25},
+    {5690,   569,   25,    5826,   592,    0},
+//lvl2 - lvl3
+    {5736,   551,   20,    5703,   639,    0},
+    {5698,   662,    0,    5736,   551,   20},
+
+////despise
+//enterance
+    {1296,  1080,    0,    5587,   630,   30},
+    {1296,  1081,    0,    5587,   631,   30},
+    {1296,  1082,    0,    5587,   632,   30},
+    {5588,   630,   30,    1297,  1080,    0},
+    {5588,   631,   30,    1297,  1081,    0},
+    {5588,   632,   30,    1297,  1082,    0},
+//lvl1 - lvl2
+    {5570,   628,   57,    5504,   569,   46},
+    {5570,   629,   57,    5504,   570,   46},
+    {5570,   630,   57,    5504,   571,   46},
+    {5505,   569,   41,    5571,   628,   52},
+    {5505,   570,   41,    5571,   629,   52},
+    {5505,   571,   41,    5571,   630,   52},
+//lvl2 - lvl3
+    {5571,   632,   12,    5522,   672,   32},
+    {5571,   633,   12,    5522,   673,   32},
+    {5571,   634,   12,    5522,   674,   32},
+    {5523,   672,   37,    5572,   632,   17},
+    {5523,   673,   37,    5572,   633,   17},
+    {5523,   674,   37,    5572,   634,   17},
+//lvl3 - lvl4
+    {5385,   755,  -13,    5410,   858,   57},
+    {5385,   756,  -13,    5410,   859,   57},
+    {5385,   757,  -13,    5410,   860,   57},
+    {5411,   858,   62,    5386,   755,   -8},
+    {5411,   859,   62,    5386,   756,   -8},
+    {5411,   860,   62,    5386,   757,   -8},
+
+////covetous
+//entrance
+    {5455,  1864,    0,    2498,   917,    0},
+    {5456,  1864,    0,    2499,   917,    0},
+    {5457,  1864,    0,    2500,   917,    0},
+    {2498,   916,    0,    5455,  1863,    0},
+    {2499,   916,    0,    5456,  1863,    0},
+    {2500,   916,    0,    5457,  1863,    0},
+//lvl1 - lvl2
+    {5392,  1959,    0,    2420,   883,    0},
+    {5393,  1959,    0,    2421,   883,    0},
+    {5394,  1959,    0,    2422,   883,    0},
+    {2420,   884,    0,    5392,  1958,    0},
+    {2421,   884,    0,    5393,  1958,    0},
+    {2422,   884,    0,    5394,  1958,    0},
+//lvl2 - lvl3
+    {2384,   836,    0,    5614,  1996,    0},
+    {2384,   837,    0,    5614,  1997,    0},
+    {2384,   838,    0,    5614,  1998,    0},
+    {5615,  1996,    0,    2385,   836,    0},
+    {5615,  1997,    0,    2385,   837,    0},
+    {5615,  1998,    0,    2385,   838,    0},
+//lvl3 - lvl4
+    {5388,  2027,    0,    2455,   859,    0},
+    {5389,  2027,    0,    2456,   859,    0},
+    {5390,  2027,    0,    2457,   859,    0},
+    {2455,   858,    0,    5388,  2026,    0},
+    {2456,   858,    0,    5389,  2026,    0},
+    {2457,   858,    0,    5390,  2026,    0},
+//lvl4 - lvl5
+    {2544,   846,    0,    5578,  1926,    0},
+    {2545,   846,    0,    5579,  1926,    0},
+    {2546,   846,    0,    5580,  1926,    0},
+    {5578,  1927,    0,    2544,   847,    0},
+    {5579,  1927,    0,    2545,   847,    0},
+    {5580,  1927,    0,    2546,   847,    0},
+//lvl5-lvl6a
+    {5556,  1827,  -15,    5551,  1805,   12},
+    {5557,  1827,  -15,    5552,  1805,   12},
+    {5551,  1804,   17,    5556,  1826,  -10},
+    {5552,  1804,   17,    5556,  1826,  -10},
+    {5552,  1804,   17,    5557,  1826,  -10},
+//lvl5 - lvl6b
+    {5595,  1840,  -14,    5466,  1804,   12},
+    {5595,  1841,  -14,    5466,  1805,   12},
+    {5465,  1804,   17,    5594,  1840,   -9},
+    {5465,  1805,   17,    5594,  1841,   -9},
+    {5465,  1805,   17,    5594,  1841,   -9},
+
+////hythloth
+//enterance
+    {5904,    17,   61,    4721,  3814,    0},
+    {5905,    17,   61,    4722,  3814,    0},
+    {5906,    17,   61,    4723,  3814,    0},
+    {4721,  3813,    0,    5904,    18,   56},
+    {4722,  3813,    0,    5905,    18,   56},
+    {4723,  3813,    0,    5906,    18,   56},
+//lvl1 - lvl2
+    {5905,    97,    0,    5976,   169,    0},
+    {5976,   169,    0,    5905,    97,    0},
+    {5976,   168,    0,    5905,    97,    0},
+    {5977,   169,    0,    5905,    97,    0},
+    {5977,   168,    0,    5905,    97,    0},
+//lvl2 - lvl3
+    {5922,   168,    7,    6081,   144,  -10},
+    {5922,   169,    7,    6081,   145,  -10},
+    {5922,   170,    7,    6081,   146,  -10},
+    {6080,   144,   -5,    5921,   169,   11},
+    {6080,   145,   -5,    5921,   169,   12},
+    {6080,   146,   -5,    5921,   169,   11},
+//lvl3 - lvl4
+    {6041,   192,    7,    6057,    87,   34},
+    {6041,   193,    7,    6057,    89,   34},
+    {6041,   194,    9,    6057,    90,   34},
+    {6056,    87,   39,    6040,   192,   12},
+    {6056,    89,   39,    6040,   193,   12},
+    {6056,    90,   39,    6040,   194,   12},
+
+////wind
+//enterance
+    {5166,   245,   15,    1361,   883,    0},
+    {1361,   883,    0,    5166,   245,   15},
+//NE exit
+    {5191,   152,    0,    1361,   883,    0},
+// wind - park
+    {5200,    71,   17,    5211,    22,   15},
+    {5217,    18,   15,    5200,    71,   17},
+    
+////ice dungeon
+//enterance
+    {5882,   241,    0,    1997,    81,    7},
+    {5882,   242,    0,    1997,    81,    7},
+    {5882,   243,    0,    1997,    81,    7},
+    {1997,    81,    7,    5881,   242,    0},
+//lvl1 - orc fort
+    {5849,   238,  -25,    5831,   324,   27},
+    {5850,   238,  -25,    5832,   324,   26},
+    {5851,   238,  -25,    5833,   324,   28},
+    {5852,   238,  -25,    5834,   324,   27},
+    {5853,   238,  -23,    5835,   324,   27},
+    {5831,   323,   34,    5849,   237,  -24},
+    {5832,   323,   34,    5850,   237,  -24},    
+    {5833,   323,   33,    5851,   237,  -24},    
+    {5834,   323,   33,    5852,   237,  -25},
+    {5835,   323,   33,    5853,   237,  -23},
+//lvl1 - lvl2
+    {5704,   145,  -45,    5705,   305,   12},
+    {5704,   146,  -45,    5705,   306,   12},   
+    {5704,   147,  -45,    5705,   307,   12},  
+    {5706,   303,   12,    5705,   146,  -45},
+    {5706,   304,   12,    5705,   146,  -45},
+    {5706,   305,   12,    5705,   146,  -45},
+    {5706,   306,   12,    5705,   147,  -45},
+    {5706,   307,   12,    5705,   147,  -45},
+    {5706,   308,   12,    5705,   147,  -45},
+//lvl1 - t2a exit
+    {5872,   144,   32,    5203,  2327,   27}, 
+    {5873,   144,   32,    5203,  2327,   27}, 
+    {5874,   144,   32,    5203,  2327,   27}, 
+    {5875,   144,   32,    5203,  2327,   27}, 
+    {5876,   144,   32,    5207,  2322,   27}, 
+    {5877,   144,   32,    5207,  2322,   27}, 
+    {5878,   144,   32,    5207,  2323,   26}, 
+    {5879,   144,   32,    5207,  2323,   26}, 
+    {5203,  2327,   27,    5874,   145,   30},
+    {5207,  2322, -255,    5875,   145,   30},
+    {5207,  2323, -255,    5876,   145,   30},
+
+////fire dungeon
+//enterance
+    {5827,  1502,    0,    2922,  3406,    8},
+    {5828,  1502,   -1,    2923,  3406,    9},
+    {5829,  1502,    2,    2924,  3406,    7},
+    {2922,  3405,    7,    5827,  1501,    0},
+    {2923,  3405,    6,    5828,  1501,    0},
+    {2924,  3405,    7,    5829,  1501,    1},
+//lvl1 - t2a exit
+    {5790,  1415,   39,    5758,  2907,   15},
+    {5790,  1416,   40,    5758,  2908,   15},
+    {5790,  1417,   38,    5758,  2909,   15},
+    {5757,  2907,   15,    5789,  1415,   42},
+    {5757,  2908,   14,    5789,  1416,   39},
+    {5757,  2909,   15,    5789,  1417,   38},
+//lvl1 - lvl2
+    {5786,  1335,  -13,    5701,  1318,    8},
+    {5787,  1335,  -13,    5702,  1318,    8},
+    {5788,  1335,  -13,    5703,  1318,    8},
+    {5701,  1319,   13,    5786,  1336,   -8},
+    {5702,  1319,   13,    5787,  1336,   -8},
+    {5703,  1319,   13,    5788,  1336,   -8},
+
+////volcano shop teleporter
+    {1653,  2963,    0,    1671,  2981,    0},
+    {1677,  2987,    0,    1675,  2987,   20},
+    
+////bucs den underground
+//enterance
+    {2674,  2242,    2,    2677,  2242,  -20},
+    {2676,  2242,  -18,    2675,  2242,    2},
+    {2676,  2242,  -18,    2675,  2242,    2},
+//exit
+    {2649,  2195,  -14,    2648,  2193,    4},
+    {2669,  2072,  -19,    2669,  2072,    5},
+    {2669,  2073,  -19,    2669,  2073,    5},
+
+////britain sewer
+//enterance
+    {6031,  1499,   35,    1490,  1640,   24},
+    {6031,  1501,   36,    1490,  1642,   24},
+    {1491,  1640,   24,    6032,  1499,   31},
+    {1491,  1642,   24,    6032,  1501,   31},
+//lvl1 - cave
+    {6140,  1431,    4,    6137,  1408,    2},
+    {6141,  1431,    4,    6138,  1408,    2},
+    {6137,  1409,    2,    6140,  1432,    4},
+    {6138,  1409,    2,    6141,  1432,    4},
+//cave - t2a exit
+    {6126,  1410,   15,    6074,  3333,    2},
+    {6127,  1410,   15,    6075,  3333,    2},    
+    {6074,  3332,    4,    6126,  1409,   13},
+    {6075,  3332,    4,    6127,  1409,   13},
+
+////minoc cave
+//enterance
+    {2399,   198,    0,    6087,  3675,   17},
+    {2400,   198,    0,    6087,  3676,   18},
+//exit to t2a
+    {6086,  3675,   15,    2399,   199,    0},
+    {6086,  3676,   16,    2400,   199,    0},
+
+////vesper graveyard
+//enterance
+    {2776,   894,  -23,    5685,   386,    1},
+    {2776,   895,  -23,    5685,   387,    2},
+    {5686,   386,    2,    2777,   894,  -23},
+    {5686,   387,    2,    2777,   895,  -23},
+//cave - t2a graveyard
+    {5658,   423,    8,    5697,  3659,    2},
+    {5697,  3660,   -5,    5658,   424,    0}, 
+
+////trinsic cave
+//enterance
+    {1628,  3320,    0,    5899,  1409,   41},
+    {1629,  3320,    0,    5900,  1409,   39}, 
+    {5898,  1411,   38,    1628,  3321,    0},
+    {5899,  1411,   43,    1628,  3321,    0},
+    {5900,  1411,   42,    1629,  3321,    0},
+//lvl1 - lvl2
+    {5918,  1410,  -29,    5962,  1407,   57},
+    {5918,  1411,  -29,    5962,  1408,   56},
+    {5918,  1412,  -29,    5962,  1409,   56},
+    {5961,  1407,   59,    5917,  1410,  -27},
+    {5961,  1408,   59,    5917,  1411,  -27},
+    {5961,  1409,   59,    5917,  1412,  -27},
+//lvl2 - west t2a
+    {6025,  1344,  -26,    5138,  3664,   31},
+    {6025,  1345,  -25,    5138,  3665,   32},
+    {6025,  1346,  -25,    5138,  3666,   32},
+    {5137,  3664,   27,    6024,  1345,  -25},
+    {5137,  3665,   31,    6024,  1346,  -25},
+//lvl2 - delucia
+    {6005,  1378,    0,    5151,  4062,   37},
+    {6005,  1379,    2,    5151,  4063,   37},
+    {6005,  1380,    1,    5151,  4064,   37},
+    {5150,  4062,   38,    6004,  1378,    1},
+    {5150,  4063,   38,    6004,  1379,   -1},
+    
+////terathan keep
+//enterance
+    {5426,  3122, -74,    5341,  1601,    0},
+    {5341,  1601,   0,    5426,  3121,  -65},
+
+////spirituality shrine
+    {1592,  2489,   17,    1600,  2489,   10},
+    {1600,  2489,   10,    1592,  2490,   17},
+    {1600,  2490,   10,    1592,  2490,   17}
+};
+
+function CreateTeleporters()
+  if(GetGlobalProperty("SystemTeleportersCreated") == 1)
+    return;
+  endif
+  foreach tele in teleporters
+    var fromx := tele[1];
+    var fromy := tele[2];
+    var fromz := tele[3];
+    var tox := tele[4];
+    var toy := tele[5];
+    var toz := tele[6];
+    var teleporter := CreateItemAtLocation(fromx, fromy, fromz, "systemteleporter", 1, "britannia"); //FIXME realms
+    if(teleporter)
+      teleporter.graphic := 3948;
+      SetObjProperty(teleporter, "DestX", tox);
+      SetObjProperty(teleporter, "DestY", toy);
+      SetObjProperty(teleporter, "DestZ", toz);
+    endif
+  endforeach
+  SetGlobalProperty("SystemTeleportersCreated", 1);
+endfunction

Added: trunk/096/scripts/include/OLD/tempMod.inc
===================================================================
--- trunk/096/scripts/include/OLD/tempMod.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/tempMod.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,44 @@
+use os;
+
+function do_temp_mod(who, mod, amt, duration)
+  var parms := {};
+  parms[2] := who;
+  parms[1] := mod;
+  parms[3] := amt;
+  parms[4] := duration;
+  start_script("::/misc/demod", parms);
+endfunction
+
+function can_stat_mod(who, stat)
+  var mod;
+  case(stat)
+    "str": mod := "#ss";
+    "dex" : mod := "#dd";
+    "int" : mod := "#ii";
+    "ar"  : mod := "#aa";
+  endcase
+  if(GetObjProperty(who, mod))
+    return 0;
+  else
+    SetObjProperty(who, mod, 1);
+    return 1;
+  endif
+endfunction
+
+function allow_stat_mod(who, stat, duration)
+  Detach();
+  var mod;
+  case(stat)
+    "str": mod := "#ss";
+    "dex" : mod := "#dd";
+    "int" : mod := "#ii";
+    "ar"  : mod := "#aa";
+  endcase
+  while(1)
+    sleep(duration);
+    if(who)
+      EraseObjProperty(who, mod);
+      return;
+    endif
+  endwhile
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/toolWear.inc
===================================================================
--- trunk/096/scripts/include/OLD/toolWear.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/toolWear.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,71 @@
+include ":attributes:attributes_ex";
+
+function CheckToolWear (who, tool, skillid)
+  var swings := GetObjProperty(tool,"swings");
+  if(!swings)
+    var mods := GetObjProperty(tool, "durability");
+    var bonus := 0;
+    case(mods)
+      "durable":        bonus := 10;
+      "substantial":    bonus := 20;
+      "massive":        bonus := 30;
+      "fortified":      bonus := 40;
+      "indestructable": bonus := 50;
+    endcase
+    swings := Cint(50 * tool.quality) + bonus;
+    SetObjProperty(tool,"swings", swings);
+  endif
+  if(swings <= 0)
+    DestroyItem(tool);
+    SendSysMessage(who,"Your tool broke.");
+  else
+    var skill := GetAttribute(who, AP_SkillIdToAttributeName(skillid));
+    if(skill > 80)
+      skill := 80;
+    elseif(skill < 20)
+      skill := 20;
+    endif
+    if((RandomInt(100)+1) > skill)
+      if(tool.isa(POLCLASS_WEAPON))
+        if(tool.hp > 1)
+          SetObjProperty(tool,"swings", (swings - 1));
+          tool.hp := tool.hp - 1;
+        elseif((tool.hp > tool.maxhp) or (tool.hp == 1))
+          SendSysMessage(who,"Your tool broke.");
+          DestroyItem(tool);
+        endif
+      else
+        SetObjProperty(tool,"swings", (swings - 1));
+      endif   
+    endif
+  endif
+endfunction 
+
+function SetToolDurability(who, tool, skillid)
+
+  var toolfile := ReadConfigFile(":*:itemdesc");
+  var toolscript := toolfile[tool.objtype].Script;
+
+  if(!toolscript.errortext)
+    if(!tool.isA(POLCLASS_CONTAINER) && !tool.isA(POLCLASS_ARMOR))
+      var myskill := GetEffectiveSkill(who, skillid);
+      var swings := 0;
+      var mods := GetObjProperty(tool, "durability");
+      var bonus := 0;
+      case(mods)
+        "durable":        bonus := 10;
+        "substantial":    bonus := 20;
+        "massive":        bonus := 30;
+        "fortified":      bonus := 40;
+        "indestructable": bonus := 50;
+        default: bonus := 0;
+      endcase
+      swings := Cint(50 + myskill) + bonus;
+      SetObjProperty(tool, "swings", swings);
+      if(!tool.quality or tool.quality == error)
+        tool.quality := 1.0;
+      endif
+    endif
+  endif
+
+endfunction 

Added: trunk/096/scripts/include/OLD/utility.inc
===================================================================
--- trunk/096/scripts/include/OLD/utility.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/utility.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,49 @@
+use basic;
+
+include "include/myUtil";
+
+
+function find_or_create_storage( areaname )
+  var area;
+  area := FindStorageArea( areaname );
+  if(!area)
+	area := CreateStorageArea( areaname );
+    if(area)
+    endif
+  endif
+  return area;
+endfunction
+
+function find_or_create_item(storage, name, objtype := 0x966a)
+  var item := FindRootItemInStorageArea(storage, name);
+  if(item)
+	return item;
+  endif
+  item := CreateRootItemInStorageArea( storage, name, objtype);
+  return item;
+endfunction
+
+function IsLocationAccessible(character, x, y, z)
+  var xd, yd, zd;
+  xd := character.x - x;
+  if(xd < -1 || xd > 1)
+    return 0;
+  endif
+  yd := character.y - y;
+  if(yd < -1 || yd > 1)
+    return 0;
+  endif
+  zd := character.z - z;
+  if(zd < -10 || zd > 10)
+    return 0;
+  endif
+  return CheckLosAt( character, x, y, z );
+endfunction
+
+function min(x, y)
+  if(x<= y)
+    return x;
+  else
+    return y;
+  endif
+endfunction
\ No newline at end of file

Added: trunk/096/scripts/include/OLD/webPage.inc
===================================================================
--- trunk/096/scripts/include/OLD/webPage.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/OLD/webPage.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -0,0 +1,34 @@
+function OpenWebSite(who, url)
+	var packet := "A5" + WordPacket(Len(url) + 4);
+
+	foreach ascii_code in CAscZ(url)
+		packet:=packet+BytePacket(ascii_code);
+	endforeach
+	SendPacket(who, packet + "00");
+
+	return;
+endfunction
+
+
+function BytePacket(byte)
+	var packet := Hex(byte);
+	packet := "00" + packet[3, Len(packet) - 2];
+
+	return (packet[Len(packet) - 1, 2]);
+endfunction
+
+
+function WordPacket(word)
+	var packet := Hex(word);
+	packet := "0000" + packet[3, Len(packet) - 2];
+
+	return (packet[Len(packet) - 3, 4]);
+endfunction
+
+
+function DoubleWordPacket(doubleword)
+	var packet := Hex(doubleword);
+	packet := "00000000" + packet[3, Len(packet) - 2];
+
+	return (packet[Len(packet) - 7, 8]);
+endfunction

Modified: trunk/096/scripts/include/arrays.inc
===================================================================
--- trunk/096/scripts/include/arrays.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/arrays.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -8,7 +8,123 @@
 use os;
 use uo;
 
+/*
+ * GetArrayRange(the_array, start, stop)
+ * 
+ * Purpose
+ * Retrieves a range from the array.
+ *
+ * Parameters
+ * the_array:	The array to extract data from.
+ * start:	Start index to get data from.
+ * stop:	End index to get data from.
+ *		If stop is 0, will go until the end of the array is reached.
+ *
+ * Return value
+ * Returns an array on success.
+ * Returns an error on failure.
+ *
+ */
+function GetArrayRange(byref the_array, start, stop:=0)
+	if ( Lower(TypeOf(the_array)) != "array" )
+		return error{"errortext":="Object passed was not an array."};
+	endif
+	
+	start := CInt(start);
+	stop := CInt(stop);
 
+	if ( start < 1 )
+		start := 1;
+	endif
+	if ( !stop )
+		stop := the_array.size();
+	elseif ( stop > the_array.size() )
+		stop := the_array.size();
+	endif
+
+	var new_array := array{};
+	for ( start; start<=stop; start:=start+1 )
+		new_array.append(the_array[start]);
+		sleepms(2);
+	endfor
+
+	return new_array;
+endfunction
+
+/* 
+ * BreakArray(the_array, size)
+ *
+ * Purpose
+ * Breaks an array up into smaller arrays.
+ *
+ * Parameters
+ * the_array:	The array that will be broken up.
+ * size:	Size of the new arrays.
+ *
+ * Return value
+ * Returns an array of arrays
+ * 
+ */
+function BreakArray(byref the_array, size:=1)
+	if ( Lower(TypeOf(the_array)) != "array" )
+		return error{"errortext":="Object passed was not an array."};
+	endif
+	
+	if ( the_array.size() > size )
+		var new_arrays := array();
+		var arrays_needed := Ceil(CDbl(the_array.size()) / CDbl(size));
+
+		var i := 1;
+		var start := i;
+		var stop := size;
+		for ( i; i<=arrays_needed; i:=i+1 )
+			new_arrays.Append(GetArrayRange(the_array, start, stop));
+			start := stop+1;
+			stop := stop+size;
+			sleepms(2);
+		endfor
+
+		return new_arrays;
+	else
+		return array{the_array};
+	endif
+endfunction
+
+/*
+ * FindInArray(byref the_array, find_what) 
+ *
+ * Purpose
+ * Finds the first instance of something in an array.
+ *
+ * Parameters
+ * the_array:	Array to search.
+ * find_what:	What to look for.
+ * 
+ * Return value
+ * Returns > 1 (the index) if it is found.
+ * Returns 0 if 'find_what' was not found.
+ *
+ */
+function FindInArray(byref the_array, find_what)
+	if ( Lower(TypeOf(the_array)) != "array" )
+		return error{"errortext":="Object passed was not an array."};
+	endif
+	
+	foreach index in the_array
+		if ( index == find_what )
+			return _index_iter;
+		endif
+		sleepms(2);
+	endforeach
+	
+	return 0;
+endfunction
+
+
+/*-------------------
+  ( OLDER FUNCTIONS )
+  ------------------*/
+
 /**
  * GetIndex(byref the_array, byref to_find)
  *
@@ -65,7 +181,6 @@
 	
 endfunction
 
-
 /**
  * InsertElementInSortedArray(byref the_array, byref to_find)
  *

Deleted: trunk/096/scripts/include/bard.inc
===================================================================
--- trunk/096/scripts/include/bard.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/bard.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,39 +0,0 @@
-use uo;
-
-include "include/client";
-include ":attributes:attributes";
-
-function play(character, theskill, item, skil)
-  var success, fail;
-  case(item.graphic)
-    0x0eb1:  success := 0x44;  fail := 0x45;
-    0x0eb2:  success := 0x46;  fail := 0x47;
-    0x0eb3:  success := 0x4d;  fail := 0x4e;
-    0x0eb4:  success := 0x4d;  fail := 0x4e;
-    0x0e9c:  success := 0x39;  fail := 0x3a;
-    0x0e9d:  success := 0x53;  fail := 0x54;
-    0x0e9e:  success := 0x53;  fail := 0x54;
-  endcase
-  var thepoints := GetEffectiveSkill(character, SKILLID_MUSICIANSHIP);
-  if(CheckSkill(character, SKILLID_MUSICIANSHIP, theskill, thepoints))
-    if(CheckSkill(character, skil, theskill, thepoints * 2))
-      PlaySoundEffect( character, success);
-      return 1;
-    else
-      PlaySoundEffect( character, fail);
-      return 0;
-    endif
-  else
-    PlaySoundEffect( character, fail);
-    return 0;
-  endif
-endfunction
-
-function findinstrument(character)
-  var instruments := {0x0eb1, 0x0eb2, 0x0eb3, 0x0eb4, 0x0e9c, 0x0e9d, 0x0e9e};
-  foreach item in EnumerateItemsInContainer(character.backpack)
-    if(item.graphic in instruments)
-      return item;
-    endif
-  endforeach
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/bitwise.inc
===================================================================
--- trunk/096/scripts/include/bitwise.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/bitwise.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,475 +0,0 @@
-const CONST_E := 2.718282;
-const CONST_PI := 3.141592;
-
-
-function Log(base, answer)
-
-	var x := 1.000;
-	var logcount := 0.000;
-	var diff := 1.000;
-	var success := 0;
-
-	while (success == 0)
-
-		x := x * base;
-
-		if (Abs(answer - x) < 0.001)
-			logcount := logcount + 1;
-			success := 1;
-		else
-			if (x > answer)
-				diff := diff / 2;
-				logcount := logcount - diff;
-				x := Exp(base, logcount);
-			else
-				logcount := logcount + diff;
-			endif
-		endif
-
-		count := count + 1;
-
-		if (count > 200)
-			success := 1;
-		endif
-
-	endwhile
-
-	return logcount;
-
-endfunction
-
-
-function Mod(numerator, denominator)
-
-	while (numerator > denominator)
-		numerator := numerator - denominator;
-	endwhile
-
-	return numerator;
-
-endfunction
-
-
-function Trunc(number, places)
-
-	var base := Exp(10, places);
-
-	number := number * base;
-	number := CInt(number);
-	number := CDbl(number);
-	number := number / base;
-
-	return number;
-
-endfunction
-
-
-function Fac(factorial);
-
-	var x;
-	while (factorial > 0)
-		x := x * factorial;
-		factorial := factorial - 1;
-	endwhile
-	return x;
-
-endfunction
-
-
-function Exp(base, power)
-
-	var i;
-	var x := 1;
-	var check := CInt(power);
-	if (power == check)
-		for(i:=1;i<=power;i:=i+1)
-			x := x * base;
-		endfor
-		return x;
-	else
-		var m, n;
-		m := power - check;
-		m := m * 1000;
-		n := YRoot(base, 1000);
-		x := Exp(n, m);
-		return x;
-	endif
-
-endfunction
-
-
-function YRoot(x, y)
-
-
-	var i := 0.000;
-	var n := 0.000;
-	var root := 2.000;
-	var a := CInt(Sqr(x));
-
-	if (a < 4)
-		a := 4;
-	endif
-
-	var success := 0;
-
-
-	while (success == 0)	
-
-		n := Exp(root, y);
-		i := x - n;
-		i := i / (a * root);
-		i := Trunc(i, 3);
-		root := root + i;
-		if (i == 0)
-			success := 1;
-			if ( Exp(Root, y) > x )
-				root := root - 0.001;
-			endif
-			if ( Exp((root + 0.001), y) == x)
-				root := root + 0.001;
-			endif
-		endif
-	endwhile
-
-	return root;
-
-endfunction
-
-
-function Sqr(x)
-
-	var i := 0.000;
-	var n := 0.000;
-	var root := 2.000;
-	var success := 0;
-
-	while (success == 0)	
-
-		n := Exp(root, 2);
-		i := x - n;
-		i := i / (2 * root);
-		i := Trunc(i, 3);
-		root := root + i;
-		if (i == 0)
-			success := 1;
-			if ( Exp(Root, 2) > x )
-				root := root - 0.001;
-			endif
-		endif
-	endwhile
-
-	return root;
-
-endfunction
-
-
-function Mean(arrayx)
-
-	var n, i:=0.000;
-
-	foreach n in arrayx
-		i := i + arrayx[n];
-	endforeach
-
-	n := CDbl(i / len(arrayx) );
-
-	return n;
-
-endfunction
-
-
-function StdDev(arrayx)
-
-	var m, n, i := 0.000;
-	var arraymean := Mean(arrayx);
-	var arraylen := len(arrayx);
-
-	foreach m in arrayx
-		n := arrayx[m] - arraymean;
-		n := Exp(n, 2);
-		i := i + n;
-	endforeach
-
-	i := i / (arraylen - 1);
-	n := Sqr(i);
-
-	return n;
-
-endfunction
-
-
-function ZTest(arrayx, mu, sigma)
-
-	var i, n;
-	var z:= 0.000;
-	var arraymean := Mean(arrayx);
-	var arraylen := len(arrayx);
-
-	i := arraymean - mu;
-	n := sigma / Sqr(arraylen);
-
-	z := i/n;
-
-	return := z;
-
-endfunction
-
-
-function TTest(arrayx, mu)
-
-	var i, n, s;
-	var t:= 0.000;
-	var arraymean := Mean(arrayx);
-	var arraylen := len(arrayx);
-	var s := StdDev(arrayx);
-
-	i := arraymean - mu;
-	n := s / Sqr(arraylen);
-
-	t := i/n;
-
-	return := t;
-
-endfunction
-
-function BitIn(arrayx)
-
-	var i := 8;
-	var n;
-	var loop := 1;
-	var bitvalue := 0;
-
-	while (i >= 0)
-
-		n := 8 - i;
-		if (arrayx[i] == 1)
-			bitvalue := bitvalue + Exp(2, n);
-		endif
-		i := i - 1;
-
-	endwhile
-
-	return bitvalue;
-
-endfunction
-
-
-function BitOut(x)
-
-	x := CInt(x);
-	var loop := 1;
-	var bitvalue := 0;
-	var arrayx := {0,0,0,0,0,0,0,0};
-	var n;
-
-	while (loop <= 8)
-
-		n := 8 - loop;
-		bitvalue := Exp(2, n);
-		if ( (x - bitvalue) >= 0)
-			arrayx[loop] := 1;
-			x := x - bitvalue;
-		endif
-		loop := loop + 1;
-
-	endwhile
-
-	return arrayx;
-
-endfunction
-
-
-function BitAnd(x, y)
-
-	var arrayx := BitOut(x);
-	var arrayy := BitOut(y);
-	var z := 0;
-	var loop := 1;
-	var n;
-
-	while (loop <= 8)
-
-		n := loop - 1;
-		if ( (arrayx[loop] == 1) && (arrayy[loop] == 1) )
-			z := z + Exp(2, n);
-		endif
-		loop := loop + 1;
-
-	endwhile
-
-	return z;
-
-endfunction
-
-
-function BitOr(x, y)
-
-	var arrayx := BitOut(x);
-	var arrayy := BitOut(y);
-	var z := 0;
-	var loop := 1;
-	locan n;
-
-	while (loop <= 8)
-
-		n := loop - 1;
-		if ( (arrayx[loop] == 1) || (arrayy[loop] == 1) )
-			z := z + Exp(2, n);
-		endif
-		loop := loop + 1;
-
-	endwhile
-
-	return z;
-
-endfunction
-
-
-function BitXor(x, y)
-
-	var arrayx := BitOut(x);
-	var arrayy := BitOut(y);
-	var z := 0;
-	var loop := 1;
-	var n;
-
-	while (loop <= 8)
-
-		n := loop - 1;
-		if (arrayx[loop] - arrayy[loop] != 0)
-			z := z + Exp(2, n);
-		endif
-		loop := loop + 1;
-
-	endwhile
-
-	return z;
-
-endfunction
-
-
-function BitEqv(x, y)
-
-	var arrayx := BitOut(x);
-	var arrayy := BitOut(y);
-	var z := 0;
-	var loop := 1;
-	var n;
-
-	while (loop <= 8)
-
-		n := loop - 1;
-		if (arrayx[loop] - arrayy[loop] == 0)
-			z := z + Exp(2, n);
-		endif
-		loop := loop + 1;
-
-	endwhile
-
-	return z;
-
-endfunction
-
-
-function BitImp(x, y)
-
-	var arrayx := BitOut(x);
-	var arrayy := BitOut(y);
-	var z := 0;
-	var loop := 1;
-	var n;
-
-	while (loop <= 8)
-
-		n := loop - 1;
-		if (arrayx[loop] - arrayy[loop] < 1)
-			z := z + Exp(2, n);
-		endif
-		loop := loop + 1;
-
-	endwhile
-
-	return z;
-
-endfunction
-
-
-function BitNot(x)
-
-	var arrayx := BitOut(x);
-	var z := 0;
-	var loop := 1;
-	var n;
-
-	while (loop <= 8)
-
-		n := loop - 1;
-		if (arrayx[loop] == 0)
-			arrayx[loop] := 1;
-			z := z + Exp(2, n);
-		else
-			arrayx[loop] := 0;
-		endif
-
-		loop := loop + 1;
-
-	endwhile
-
-	return z;
-
-endfunction
-
-
-function FlagSet(flag, bit);
-
-	bit := 9 - bit;
-
-	var flagarray := BitOut(flag);
-	flagarray[bit] := 1;
-
-	bit := BitIn(flagarray);
-
-	return bit;
-
-endfunction
-
-
-function FlagReset(flag, bit);
-
-	var x := 1;
-	var y := 0;
-	var n := 0;
-
-	bit := 9 - bit;
-
-	var flagarray := BitOut(flag);
-	flagarray[bit] := 0;
-
-	while (x <= 8)
-
-		if (flagarray[x] == 1)
-			n := x - 1;
-			y := y + Exp(2, n);
-		endif
-
-		x := x + 1;
-
-	endwhile
-
-	return y;
-
-endfunction
-
-
-function FlagCheck(flag, bit);
-
-	var flagarray := BitOut(flag);
-	bit := 9 - bit;
-
-	if (flagarray[bit] == 1)
-		return 1;
-	else
-		return 0;
-	endif
-
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/bounty.inc
===================================================================
--- trunk/096/scripts/include/bounty.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/bounty.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,59 +0,0 @@
-use datafile;
-
-var bountyfile := DFOpenDataFile("BountySystem", 1);
-
-function AddBounty(killer, amt)
-  var entry := DFFindElement(bountyfile, CStr(killer.serial), 1);
-  print(entry);
-  entry.SetProp("Name", killer.name);
-  entry.SetProp("Bounty", CInt(DFGetProp(entry, "Bounty", 1, 0) + amt));
-  entry.SetProp("Murders", CInt(DFGetProp(entry, "Murders", 1, 0) + 1));
-  entry.SetProp("Expires", ReadGameClock() + 1209600);
-endfunction
-
-function FindBounty(who, serial)
-  who := who; // stops ecompile "not used" warning
-  var elem := DFFindElement(bountyfile, CStr(serial));
-  if(elem)
-    var holder := array;
-    holder.append(DFGetProp(elem, "Name"));
-    holder.append(DFGetProp(elem, "Bounty"));
-    holder.append(DFGetProp(elem, "Murders"));
-    bountyfile.DeleteElement(CStr(serial));
-    return holder;
-  else
-    return 0;
-  endif
-endfunction
-
-function ComposeBountyBoard()
-  var pnames := bountyfile.keys();
-  var data := array;
-  Foreach thing in pnames
-    var elem := DFFindElement(bountyfile, thing);
-    var holder := array;
-    holder.append(DFGetProp(elem, "Name"));
-    holder.append(CInt(thing));
-    holder.append(DFGetProp(elem, "Bounty"));
-    holder.append(DFGetProp(elem, "Murders", 1, 1));
-    data.append(holder);
-  endforeach
-  return bubble_sort_array(data, 3);
-endfunction
-
-function MaintainBountySystem()
-  var count := 0;
-  foreach thing in (bountyfile.keys())
-    var elem := DFFindElement(bountyfile, thing);
-    if(ReadGameClock() > DFGetProp(elem, "Expires"))
-      bountyfile.DeleteElement(thing);
-      count := count + 1;
-    endif
-    sleep(1);
-  endforeach
-  print("//////////////////////////////////////////");
-  print("// Bounty System Maintenance");
-  print("// Removed " + count + " expired bounties.");
-  print("//////////////////////////////////////////");
-endfunction
-

Deleted: trunk/096/scripts/include/canAccess.inc
===================================================================
--- trunk/096/scripts/include/canAccess.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/canAccess.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,25 +0,0 @@
-
-function can_access(who, item, flags := 0)
-  var owner := Cint(GetObjProperty(item, "Owner"));
-  if((owner) and (owner != who.serial))
-    SendSysMessage(who, "You cannot use that (1) " + item.desc);
-    return 0;
-  elseif(GetObjProperty(item, "Vendored"))
-    SendSysMessage(who, "You cannot use that (2) " + item.desc);
-    return 0;
-  elseif(!Accessible(who, item))
-    SendSysMessage(who, "You cannot use that (3) " + item.desc);
-    return 0;
-  elseif((!flags["distance"]) and ((Distance(who, item) > 2)))
-    SendSysMessage(who, "That item is too far away.");
-    return 0;
-  elseif((!flags["unmovable"]) and (item.movable == 0))
-    SendSysMessage(who, "You cannot use that while locked down.");
-    return 0;
-  elseif(!ReserveItem(item))
-    SendSysMessage(who, "That item is already in use.");
-    return 0;
-  else
-    return 1;
-  endif
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/clock.inc
===================================================================
--- trunk/096/scripts/include/clock.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/clock.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,67 +0,0 @@
-use uo;
-use cfgfile;
-
-function GetTime()
-  var cfg := ReadConfigFile( ":daynight:config/days" );
-  var elem := FindConfigElem( cfg, "WholeDay" );
-  var length := GetConfigInt( elem, "Length" );
-  var day_length := (60 * length);
-  var x := ReadGameClock();
-  var bigpart := x / day_length;
-  var smallpart := bigpart * day_length;
-  x := (x - smallpart);
-  return ( x );
-endfunction
-
-function GetTransition()
-  var cfg := ReadConfigFile( ":daynight:config/days" );
-  var elem := FindConfigElem( cfg, "Transition" );
-  var length := GetConfigInt( elem, "Length" );
-  return length;
-endfunction
-
-function GetDayLength()
-  var cfg := ReadConfigFile( ":daynight:config/days" );
-  var elem := FindConfigElem( cfg, "WholeDay" );
-  var length := GetConfigInt( elem, "Length" );
-  return length;
-endfunction
-
-function GetTimeofDay()
-  var time_sec := GetTime();
-  var length := (GetDayLength() * 60) * 1.0;
-  var temp := length / time_sec;
-  var raw_time := 24.0 / temp;
-  var hours := CInt(raw_time);
-  var remainder := raw_time - hours;
-  var minutes := CInt( remainder * 60 );
-  if( len(CStr(minutes)) == 1 )
-	minutes := "0" + CStr(minutes);
-  endif
-  if( len(CStr(hours)) == 1 )
-	hours := "0" + CStr(hours);
-  endif
-  return (hours+":"+minutes);
-endfunction
-
-function GetHourOfDay()
-  var time := GetTimeofDay();
-  var colon := find(time, ":", 1);
-  return CInt(time[1, colon]);
-endfunction
-
-function HourWithinRange(hr, hrstart, hrend)
-  hr := CInt(hr) + 24;
-  hrstart := CInt(hrstart) + 24;
-  hrend := CInt(hrend) + 24;
-  if (hrstart > hrend)
-	if (hr >= hrstart || hr < hrend)
-	  return 1;
-	endif
-  else
-	if (hr >= hrstart && hr <= hrend)
-	  return 1;
-	endif
-  endif
-  return 0;
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/coords.inc
===================================================================
--- trunk/096/scripts/include/coords.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/coords.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,25 +0,0 @@
-use basic;
-use math;
-
-function ToSextant(x, y)
-  var latitude_direction, longitude_direction;
-  var latitude_degrees, longitude_degrees;
-  var latitude_minutes, longitude_minutes;
-  latitude_degrees := (y-1624)*0.087890625;
-  longitude_degrees := (x-1323)*0.0703125;
-  if(latitude_degrees < 0)
-	latitude_direction := "N";
-  else
-	latitude_direction := "S";
-  endif
-  if(longitude_degrees < 0)
-	longitude_direction := "W";
-  else
-	longitude_direction := "E";
-  endif
-  latitude_degrees := Abs(latitude_degrees);
-  longitude_degrees := Abs(longitude_degrees);
-  latitude_minutes := CInt((CInt((latitude_degrees-Floor(latitude_degrees))*100)*60)/100);
-  longitude_minutes := CInt((CInt((longitude_degrees-Floor(longitude_degrees))*100)*60)/100);
-  return(Floor(latitude_degrees) + "o " + latitude_minutes + "'" + latitude_direction + ", " + Floor(longitude_degrees) + "o " + longitude_minutes + "'" + longitude_direction);
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/dist.inc
===================================================================
--- trunk/096/scripts/include/dist.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/dist.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,52 +0,0 @@
-/*
- *  dist( obj1, obj2 )
- *      - returns the largest of the x-distance and y-distance 
- *        between two objects.
- */
-
-use uo;
-
-function dist( obj1, obj2 )
-    return Distance( obj1, obj2 );
-
-            /* implements:
-                while (obj1.container)
-                    obj1 := obj1.container;
-                endwhile
-    
-                while (obj2.container)
-                    obj2 := obj2.container;
-                endwhile
-
-                var xd := obj1.x - obj2.x;
-                var yd := obj1.y - obj2.y;
-                if (xd < 0)
-                    xd := -xd;
-                endif
-                if (yd < 0)
-                    yd := -yd;
-                endif
-                if (xd > yd)
-                    return xd;
-                else
-                    return yd;
-                endif
-            */
-endfunction
-
-function coordist( x1, y1, x2, y2 )
-
-   var xd := x1 - x2;
-   var yd := y1 - y2;
-   if (xd < 0)
-      xd := -xd;
-   endif
-   if (yd < 0)
-      yd := -yd;
-   endif
-   if (xd > yd)
-      return xd;
-   else
-     return yd;
-   endif
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/eventID.inc
===================================================================
--- trunk/096/scripts/include/eventID.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/eventID.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,84 +0,0 @@
-//
-// event IDs to be returned in eventid member of wait_for_event
-// result.
-//
-// See documentation for details.
-//
-// TODO: move this to OS.EM, when .EM files can have constants.
-//
-// Author: ens
-//
-// Last modification: 01/22/1999
-//
-
-
-//const EVID_SPEECH           := 0x0001;
-
-const EVID_ENGAGED          := 0x0002;
-const EVID_DISENGAGED       := 0x0004;
-const EVID_NODE             := 0x0005;
-const EVID_DAMAGED          := 0x0008;
-const EVID_HERDING          := 0x1111;
-const EVID_WAKEUP           := 0x1112;
-const EVID_SKILLCAP         := 0x1113;
-const EVID_STATCAP          := 0x1114;
-const EVID_SPAWNREGION      := 0x1115;
-const EVID_SR_DEATH         := 0x1116;
-const EVID_SR_PENDING       := 0x1117;
-const EVID_ENTEREDAREA      := 0x0010;
-const EVID_STAFF_LOGIN      := 0x0011;
-const EVID_PLAYER_LOGIN     := 0x0012;
-const EVID_PLAYER_LOGOFF    := 0x0013;
-const EVID_PLAYER_DELAY     := 0x0014;
-const EVID_FIND_COUN        := 0x0015;
-const EVID_FIND_GM          := 0x0016;
-const EVID_GUILD_DISBAND    := 0x0017;
-const EVID_GUILD_CREATED    := 0x0018;
-
-const EVID_ALL_ATTACK_CMD := 0x12;
-const EVID_ALL_FOLLOW_CMD := 0x11;
-
-const EVID_LEFTAREA         := 0x0020;
-
-const EVID_OPPONENT_MOVED   := 0x0040;
-
-const EVID_HOSTILE_MOVED    := 0x0080; // not implemented
-
-const EVID_MERCHANT_BOUGHT  := 0x0100;
-const EVID_MERCHANT_SOLD    := 0x0200;
-
-const EVID_ITEM_GIVEN       := 0x0400;
-const EVID_DOUBLECLICKED    := 0x0800;
-
-const EVID_RESERVED_1000    := 0x00001000;
-const EVID_RESERVED_2000    := 0x00002000;
-const EVID_RESERVED_4000    := 0x00004000;
-const EVID_RESERVED_8000    := 0x00008000;
-
-const EVID_SPAWNPOINT_CREATED	:= 1010;
-const EVID_SPAWNPOINT_DESTROYED := 1020;
-const EVID_SPAWNPOINT_RESET		:= 1040;
-const EVID_SPAWNPOINT_CHANGED	:= 1080;
-const EVID_SPAWN_DEATH			:= 1100;
-const EVID_SPAWNREGION_DEATH	:= 3001;
-const EVID_RESERVED_00010000    := 0x00010000;
-const EVID_RESERVED_00020000    := 0x00020000;
-const EVID_RESERVED_00040000    := 0x00040000;
-const EVID_RESERVED_00080000    := 0x00080000;
-const EVID_RESERVED_00100000    := 0x00100000;
-const EVID_RESERVED_00200000    := 0x00200000;
-const EVID_RESERVED_00400000    := 0x00400000;
-const EVID_RESERVED_00800000    := 0x00800000;
-const EVID_RESERVED_01000000    := 0x01000000;
-const EVID_RESERVED_02000000    := 0x02000000;
-const EVID_RESERVED_04000000    := 0x04000000;
-const EVID_RESERVED_08000000    := 0x08000000;
-const EVID_RESERVED_10000000    := 0x10000000;
-const EVID_RESERVED_20000000    := 0x20000000;
-const EVID_RESERVED_40000000    := 0x40000000;
-const EVID_RESERVED_80000000    := 0x80000000;
-
-/* FIXME: these need to be renumbered, one clashes with a reserved event */
-const EVID_SPELL_ATTACK     := 0x0800;
-const EVID_BUDDYATTACKED     := 0x1600;
-const EVID_PEACEMADE         := 0x90000000;
\ No newline at end of file

Deleted: trunk/096/scripts/include/exception.inc
===================================================================
--- trunk/096/scripts/include/exception.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/exception.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,35 +0,0 @@
-/* $Id: exception.inc,v 1.1 2004/03/16 14:05:46 folko Exp $
- *
- * Purpose
- * Provides various functions and constants for exceptions.
- *
- */
-use uo;
-
-include "include/log";
-
-
-/*
- * Exception(what)
- *
- * Author: Folko
- *
- * Purpose
- * Raises and exception and logs it to the error log.
- *
- * Parameters
- * what:        A string describing the error
- *
- * Return value
- * Always returns an error-object
- *
- * Notes
- * Only use this for script errors etc., we don't want spam in the error log.
- *
- */
-function Exception(what)
-	print("******Exception: " + what + "******");
-	Log(LOG_ERROR, "Exception: " + what);
-
-	return(error);
-endfunction

Deleted: trunk/096/scripts/include/fields.inc
===================================================================
--- trunk/096/scripts/include/fields.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/fields.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,67 +0,0 @@
-function get_direction(who)
-  var ret;
-  if(who.facing in array(1, 3, 5, 7))
-    case (RandomInt(2))
-      0: ret := "NS";
-      1: ret := "EW";
-	endcase
-  else
-    case(who.facing)
-      2: ret := "EW";
-      4: ret := "NS";
-      6: ret := "EW";
-      0: ret := "NS";
-    endcase
-  endif
-  return ret;
-endfunction
-
-function CreateNorthSouthField(caster, fieldtype,x,y,z, length := 5)
-  var counter := 0;
-  var i;
-  var fires := { };
-  var tester := CreateItemAtLocation(x,y,z, 0xeed, 1, caster.realm);
-  for ( i := x - 2; i <= x - 2 + length; i := i + 1)
-    counter := counter  + 1;
-    if(fieldtype == 0x80)
-      if((CheckLosAt(tester, i, y, z )) and (len(ListMobilesNearLocation(i, y, z, 0, caster.realm)) == 0))
-        fires[counter] := CreateItemAtLocation( i, y, z, fieldtype, 1, caster.realm);
-        SetObjProperty(fires[counter], "f","1");
-        SetObjProperty(fires[counter], "creater", caster.serial);
-      endif
-    else
-      if(CheckLosAt(tester, i, y, z ))
-        fires[counter] := CreateItemAtLocation( i,y,z,fieldtype, 1, caster.realm );
-        SetObjProperty(fires[counter], "creater", caster.serial);
-        SetObjProperty(fires[counter], "f","1");
-      endif
-    endif
-  endfor
-  DestroyItem(tester);
-  return fires;
-endfunction
-
-function CreateEastWestField(caster, fieldtype,x,y,z, length)
-  var counter := 0;
-  var i;
-  var fires := { };
-  var tester := CreateItemAtLocation(x,y,z, 0xeed, 1, caster.realm);
-  for ( i := y - 2; i <= y - 2 + length; i := i + 1)
-    counter := counter  + 1;
-    if(fieldtype == 0x80)
-      if((CheckLosAt(tester, x, i, z )) and (len(ListMobilesNearLocation(x, i, z, 0, caster.realm)) == 0))
-        fires[counter] := CreateItemAtLocation( x,i,z,fieldtype, 1, caster.realm );
-        SetObjProperty(fires[counter], "f","1");
-        SetObjProperty(fires[counter], "creater", caster.serial);
-      endif
-    else
-      if(CheckLosAt(tester, x, i, z ))
-        fires[counter] := CreateItemAtLocation( x,i,z,fieldtype, 1, caster.realm );
-        SetObjProperty(fires[counter], "f","1");
-        SetObjProperty(fires[counter], "creater", caster.serial);
-      endif
-    endif
-  endfor
-  DestroyItem(tester);
-  return fires;
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/findCity.inc
===================================================================
--- trunk/096/scripts/include/findCity.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/findCity.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,47 +0,0 @@
-use os;
-use uo;
-
-function FindCity(me)
-  if(me.x>=1244 && me.y>=1530 && me.x<=1704 && me.y<=1758)
-    return "Britain";
-  elseif(me.x>=4379 && me.y>=1045 && me.x<=4487 && me.y<=1178)
-    return "Moonglow";
-  elseif(me.x>=5137 && me.y>=3948 && me.x<=5196 && me.y<=4082)
-    return "Delucia";
-  elseif(me.x>=5196 && me.y>=3923 && me.x<=5322 && me.y<=4085)
-    return "Delucia";
-  elseif(me.x>=5638 && me.y>=3083 && me.x<=5799 && me.y<=3328)
-    return "Papua";
-  elseif(me.x>=5799 && me.y>=3121 && me.x<=5822 && me.y<=3327)
-    return "Papua";
-  elseif(me.x>=1294 && me.y>=3664 && me.x<=1506 && me.y<=3886)
-    return "Jhelom";
-  elseif(me.x>=494 && me.y>=926 && me.x<=600 && me.y<=1034)
-    return "Yew";
-  elseif(me.x>=590 && me.y>=796 && me.x<=670 && me.y<=886)
-    return "Empath Abbey";
-  elseif(me.x>=2394 && me.y>=370 && me.x<=2624 && me.y<=632)
-    return "Minoc";
-  elseif(me.x>=1794 && me.y>=2638 && me.x<=2136 && me.y<=2902)
-    return "Trinsic";
-  elseif(me.x>=538 && me.y>=2106 && me.x<=686 && me.y<=2274)
-    return "Skara Brae";
-  elseif(me.x>=3646 && me.y>=2040 && me.x<=3814 && me.y<=2280)
-    return "Magincia";
-  elseif(me.x>=3588 && me.y>=2446 && me.x<=3762 && me.y<=2690)
-    return "Occlo";
-  elseif(me.x>=2612 && me.y>=2082 && me.x<=2772 && me.y<=2256)
-    return "Buccaneers Den";
-  elseif(me.x>=3496 && me.y>=1062 && me.x<=3808 && me.y<=1400)
-    return "Nujelm";
-  elseif(me.x>=2794 && me.y>=634 && me.x<=3026 && me.y<=1000)
-    return "Vesper";
-  elseif(me.x>=2206 && me.y>=1116 && me.x<=2290 && me.y<=1236)
-    return "Cove";
-  elseif(me.x>=5120 && me.y>=0 && me.x<=5374 && me.y<=254)
-    return "Wind";
-  elseif(me.x>=1382 && me.y>=3955 && me.x<=1528 && me.y<=4044)
-    return "Jhelom";
-  endif
-  return "no city";
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/firewall.inc
===================================================================
--- trunk/096/scripts/include/firewall.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/firewall.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,66 +0,0 @@
-use os;
-use util;
-use uo;
-
-include "include/client";
-include "include/fields";
-
-const SOUND_EFFECT_FIREFIELD:= 0x1de;
-const UOBJ_FIREFIELD_NS := 0x398c;
-const UOBJ_FIREFIELD_EW := 0x3996;
-const SOUND_EFFECT_POISON := 0x247;
-const EFFECT_RED_SPARKLE := 0x374a;
-
-/*
-function DoFireField( caster )
-var thetarget;
-var x;
-var y;
-var z;
-var i;
-var fires := { };
-var duration;
-var listeners := { };
-var sufferers := { };
-thetarget := TargetCoordinates(caster);
-if ((!thetarget))
-        SendSysMessage(caster, "Targetting cancelled.");
-endif
-x := thetarget.x;
-y := thetarget.y;
-z := thetarget.z;
-if (!CheckLosAt( caster, x, y, z ))
-        SendSysMessage(caster, "You can't see that!");
-        return;
-endif
-var dir := get_direction(caster, x, y, z);
-case dir
-	"north" : fires:= CreateNorthSouthField(caster, UOBJ_FIREFIELD_NS, x, y, z, 5);
-	"south"  :fires:= CreateNorthSouthField(caster, UOBJ_FIREFIELD_NS, x, y, z, 5);
-	"east"  : fires:= CreateEastWestField(caster, UOBJ_FIREFIELD_EW, x, y, z, 5);
-        "west"  : fires:= CreateEastWestField(caster, UOBJ_FIREFIELD_EW, x, y, z, 5);
-        default:  var firetype := RandomInt(2) + 1;
-        	  case firetype
-        	  	1: fires:= CreateNorthSouthField(caster, UOBJ_FIREFIELD_NS, x, y, z, 5);
-        	  	2: fires:= CreateEastWestField(caster, UOBJ_FIREFIELD_EW, x, y, z, 5);
-        	  endcase
-endcase
-Detach();
-foreach fire in fires
-        PlaySoundEffect(fire, SOUND_EFFECT_FIREFIELD);
-endforeach
-var counter := 0;
-duration := CInt(GetEffectiveSkill( caster, SKILLID_MAGERY ) );
-for (counter := 1; counter <= duration; counter := counter + 1)
-foreach fire in fires
-	if (fire)
-        PlaySoundEffect(fire, SOUND_EFFECT_FIREFIELD);
-    endif
-endforeach
-sleep(1);
-endfor
-foreach fire in fires
-    DestroyItem( fire );
-endforeach
-endfunction
-*/
\ No newline at end of file

Deleted: trunk/096/scripts/include/guildFunctions.inc
===================================================================
--- trunk/096/scripts/include/guildFunctions.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/guildFunctions.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,337 +0,0 @@
-use uo;
-use os;
-
-var guildinitlayout := {
-	"page 0",
-	"resizepic 30 30 3000 400 200",
-	"text 163 43 5 0",
-	"text 50 65 5 1",
-	"text 80 85 35 2",
-	"text 50 105 5 3",
-	"text 80 125 35 4",
-	"text 50 145 5 5",
-	"text 80 165 35 6",
-	"button 230 195 2119 2120 1 0 1",
-	"button 165 195 2130 2129 1 0 2"
-};
-
-var guildinitdata := {
-	"Guild Information",
-	"Guild Name:",
-	"Guildname",
-	"Guild Abbreviation:",
-	"Guildabbr",
-	"Guildmaster:",
-	"Guildmaster"
-};
-// ResetGuildStone(stone)
-//
-// This function will initialize a guildstone.  It will wipe all
-// existing guild data from the stone, queue all of the guild's
-// players so their guild info is removed, and remove the guild from
-// the registry.
-
-function ResetGuildStone(stone)
-
-	var i, x;
-	var empty := {};
-
-	var guildmembers := GetObjProperty(stone, "MemberSerials");
-
-	SetObjProperty(stone, "GuildName", "NONE");
-	SetObjProperty(stone, "GuildAbbr", "NONE");
-	SetObjProperty(stone, "GuildAlign", "NONE");
-	SetObjProperty(stone, "MemberSerials", empty);
-	SetObjProperty(stone, "MemberNames", empty);
-	SetObjProperty(stone, "MemberTitles", empty);
-	SetObjProperty(stone, "Enemies", empty);
-	SetObjProperty(stone, "Allies", empty);
-	SetObjProperty(stone, "PendingAction", empty);
-
-	set_critical(1);
-	var guildregistry := GetGlobalProperty("GuildRegistry");
-	var newregistry := {};
-	var newreglen := 0;
-	for (i := 1; i <= len(guildregistry); i := i + 1);
-		if (stone.serial != guildregistry[i])
-			newreglen := newreglen + 1;
-			newregistry[newreglen] := guildregistry[i];
-		endif
-	endfor
-	SetGlobalProperty("GuildRegistry", newregistry);
-	set_critical(0);
-
-	foreach x in guildmembers
-		GuildAction(x.serial, stone, "Disband");
-	endforeach
-
-	PrintTextAbove(stone, "Guildstone has been reset.");
-
-endfunction
-
-
-// GuildAction(destination, source, action)
-//
-// This function adds a PendingAction to a guildstone.  It can be used
-// to declare war, peace, or alliances with other guildstones, (in
-// which case destination = target guild's stone serial, source = 
-// the declarer's guildstone, and the action = "War", "Peace", or 
-// "Ally"), or it can be used to remove or retitle other members of
-// the guild  (in which case destination = target's serial, source =
-// the stone, and action = "Remove", "Disband", "Add", etc).  If a 
-// player is changed, and the player is not online, then the action
-// is posted to the global queue.  The function returns 1 on success, 
-// 2 if the target was offline, and 0 for failure.
-
-function GuildAction(destination, source, action)
-
-	var i, x;
-	var targobj;
-	var pendingaction;
-
-	var guildname := GetObjProperty(source, "GuildName");
-
-	if ( (action == "War") || (action == "Peace") || (action == "Ally") )
-		targobj := SystemFindObjectBySerial(destination);
-		pendingaction := GetObjProperty(targobj, "PendingAction");
-		x := len(pendingaction) + 1;
-		pendingaction[x] := source.serial;
-		x := x + 1;
-		pendingaction[x] := action;
-		SetObjProperty(targobj, "PendingAction", pendingaction);
-		return 1;
-	elseif ( (action == "Remove") || (action == "Disband") || (action == "Retitle") || (action == "Add"))
-		i := 0;
-		foreach x in EnumerateOnlineCharacters()
-			if (x.serial == destination)
-				targobj := x;
-				i := 1;
-			endif
-		endforeach
-		if (i == 1)
-			case(action)
-				"Remove":
-				SendSysMessage(targobj, "You have been removed from " + guildname + "!");
-				EraseObjProperty(targobj, "Guild");
-				targobj.name := GetObjProperty(targobj, "OldName");
-				EraseObjProperty(targobj, "GuildTitle");
-				EraseObjProperty(targobj, "OldName");
-				return 1;
-
-				"Disband":
-				SendSysMessage(targobj, "Your guild, " + guildname + ", has disbanded.");
-				EraseObjProperty(targobj, "Guild");
-				targobj.name := GetObjProperty(targobj, "OldName");
-				EraseObjProperty(targobj, "GuildTitle");
-				EraseObjProperty(targobj, "OldName");
-				return 1;
-
-				"Retitle":
-				SendSysMessage(targobj, "You have been granted a new guild title.  Go to the guildstone and update your information.");
-				return 1;
-
-				"Add":
-				SendSysMessage(targobj, "You have been recruited into " + guildname + ".");
-				SetObjProperty(targobj, "OldName", targobj.name);
-				SetObjProperty(targobj, "Guild", source.serial);
-				SetObjProperty(targobj, "GuildTitle", "Initiate");
-				return 1;
-
-			endcase
-		else
-			set_critical(1);
-			var guildpendingaction := GetGlobalProperty("GuildPendingAction");
-			i := len(guildpendingaction) + 1;
-			guildpendingaction[x] := destination;
-			x := x + 1;
-			guildpendingaction[x] := action;
-			SetGlobalProperty("GuildPendingAction", guildpendingaction);
-			set_critical(0);
-			return 2;
-		endif	
-	else
-		print("Error selecting action type.");
-		return 0;
-	endif
-
-endfunction
-
-
-// FindPosition(who, stone)
-//
-// This function will find the array position in the guild data for
-// member <who>.  If the person is not in the guild, the function 
-// returns a 0.
-
-function FindPosition(who, stone)
-
-	var memberserials := GetObjProperty(stone, "MemberSerials");
-	var i;
-	var guildslot := 0;
-
-	for (i := 1; i <= len(memberserials); i := i + 1)
-		if (memberserials[i] == who.serial)
-			guildslot := i;
-		endif
-	endfor
-
-	return guildslot;
-
-endfunction
-
-
-// RemoveMember(who, stone)
-//
-// This function will remove an individual from a guildstone.  In this
-// case, <who> is the SERIAL NUMBER of the person to be removed.
-
-function RemoveMember(who, stone)
-
-	var i := 0;
-	var x := 0;
-	var newserials := {};
-	var newnames := {};
-	var newtitles := {};
-
-	var memberserials := GetObjProperty(stone, "MemberSerials");
-	var membernames := GetObjProperty(stone, "MemberNames");
-	var membertitles := GetObjProperty(stone, "MemberTitles");
-
-	for (i := 1; i <= len(memberserials); i := i + 1)
-		if (i != who)
-			x := x + 1;
-			newserials[x] := memberserials[i];
-			x := x + 1;
-			newnames[x] := membernames[i];
-			x := x + 1;
-			newtitles[x] := membertitles[i];
-		endif
-	endfor
-
-	SetObjProperty(stone, "MemberSerials", newserials);
-	SetObjProperty(stone, "MemberNames", newnames);
-	SetObjProperty(stone, "MemberTitles", newtitles);
-
-	GuildAction(who, stone, "Remove");
-
-endfunction
-
-
-// AddMember(who, stone)
-//
-// This function will add a member to a guildstone.  If the player is
-// already a member, the function will return 0.  The "title" field
-// is optional, and will return "Initiate" if omitted.
-
-function AddMember(who, stone, title := "Initiate")
-
-	if ( FindPosition(who, stone) > 0 )
-		PrintTextAbove(stone, "That person is already a member!");
-		return 0;
-	endif
-
-	var memberserials := GetObjProperty(stone, "MemberSerials");
-	var membernames := GetObjProperty(stone, "MemberNames");
-	var membertitles := GetObjProperty(stone, "MemberTitles");
-
-	var i := len(memberserials) + 1;
-
-	memberserials[i] := who.serial;
-	membernames[i] := who.name;
-	membertitles[i] := title;
-
-	SetObjProperty(stone, "MemberSerials", memberserials);
-	SetObjProperty(stone, "MemberNames", membernames);
-	SetObjProperty(stone, "MemberTitles", membertitles);
-
-	GuildAction(who.serial, stone, "Add");
-
-endfunction
-
-
-// InitializeGuild(who, guildstone)
-//
-// This function runs when the guildstone is first placed, or after
-// it has been wiped and the guild disbanded.   The first person to
-// use the stone after it is placed becomes the guildmaster.  This
-// function just sets the name and abbreviation of the guild, and
-// sets the title of the guildmaster.   It will then return to the
-// main guildstone program, where the guildmaster can add members
-// and make adjustments as needed.
-
-function InitializeGuild(who, stone)
-
-	var success := 0;
-	var guildname, guildabbr, guildtitle;
-
-	while (success == 0)
-		guildname := RequestInput(who, stone, "Enter a your Guild's name (5-40 characters):");
-		if ( (len(guildname) > 40) || (len(guildname) < 5) )
-			SendSysMessage(who, "Invalid Name.");
-		else
-			success := 1;
-		endif
-	endwhile
-	guildinitdata[3] := guildname;
-
-	success := 0;
-	while (success == 0)
-		guildabbr := RequestInput(who, stone, "Enter a your Guild's short name, displayed in your members' titles (3-16 characters):");
-		SendSysMessage(who, guildabbr);
-		if ( (len(guildabbr) > 16) || (len(guildname) < 3) )
-			SendSysMessage(who, "Invalid Name.");
-		else
-			success := 1;
-		endif
-	endwhile
-	guildinitdata[5] := guildabbr;
-
-	success := 0;
-	while (success == 0)
-		guildtitle := RequestInput(who, stone, "Enter your title (3-16 characters):");
-		SendSysMessage(who, guildtitle);
-		if ( (len(guildtitle) > 16) || (len(guildname) < 3) )
-			SendSysMessage(who, "Invalid Name.");
-		else
-			success := 1;
-		endif
-	endwhile
-	guildinitdata[7] := guildtitle;
-
-	SendSysMessage(who, "Is this information correct?");
-	var res := SendDialogGump(who, guildinitlayout, guildinitdata);
-	if (res[0] == 2)
-
-		set_critical(1);
-		var masterlist := GetGlobalProperty("GuildRegistry");
-		success := len(masterlist) + 1;
-		masterlist[success] := stone.serial;	
-		SetGlobalProperty("GuildRegistry", masterlist);
-		set_critical(0);
-
-		var memberserials := { who.serial };
-		var membernames := { who.name };
-		var membertitles := { guildtitle };
-		var empty := { };
-
-		SetObjProperty(stone, "GuildName", guildname);
-		SetObjProperty(stone, "GuildAbbr", guildabbr);
-		SetObjProperty(stone, "GuildAlign", "NONE");
-		SetObjProperty(stone, "MemberSerials", memberserials);
-		SetObjProperty(stone, "MemberNames", membernames);
-		SetObjProperty(stone, "MemberTitles", membertitles);
-		SetObjProperty(stone, "GuildEnemies", empty);
-		SetObjProperty(stone, "GuildAllies", empty);
-		SetObjProperty(stone, "PendingAction", empty);
-
-		SetObjProperty(who, "Guild", stone.serial);
-		SetObjProperty(who, "OldName", who.name);
-		SetObjProperty(who, "GuildTitle", guildtitle);
-		who.name := who.name + ", " + guildtitle + " [" + guildabbr + "]";
-		SendSysMessage(who, "Guildstone initialized.");
-		return 1;
-	else
-		return 0;
-	endif
-
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/help.inc
===================================================================
--- trunk/096/scripts/include/help.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/help.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,63 +0,0 @@
-var onlinecounselors;
-var onlinestaff;
-
-onlinecounselors := staffcheck("coun");
-onlinestaff := staffcheck("gm");
-
-function Icanpage(thechar)
-  foreach person in EnumerateOnlineCharacters()
-    if ((GetObjProperty(person,"canpage")) && (person.serial != thechar.serial))
-      return 0;
-    endif
-  endforeach
-  SetObjProperty(thechar, "canpage", 1);
-  return 1;
-endfunction
-
-function staffcheck(type)
-  var stafflist := GetProcess(GetGlobalProperty("#stafflist"));
-  var k := struct;
-  case(type)
-    "coun": k.+type := EVID_FIND_COUN;
-    "gm":   k.+type := EVID_FIND_GM;
-  endcase
-  k.+pid := getpid();
-  stafflist.sendevent(k);
-  var ev := wait_for_event(10);
-  var evdata := ev.data;
-  return evdata;
-endfunction
-
-function pagecheck(serial, type)
-  var cserial := CInt(serial);
-  var retval := 0;
-  var i;
-  case(CInt(type))
-    1: var maxi := gmpages.size();
-	   for(i := 0; i < maxi; i := i + 1)
-		 if (cserial == CInt(gmpages[i]))
-		   retval := i;
-		   break;
-		 endif
-	   endfor
-    2: var maxi := counpages.size();
-	   for(i := 0; i < maxi; i := i + 1)
-		 if (cserial == CInt(counpages[i]))
-		   retval := i;
-		   break;
-		 endif
-	   endfor
-  endcase
-  return retval;
-endfunction
-
-function pagewarning(type, thepage, who)
-  case(type)
-    1: foreach char in onlinestaff
-		 SendSysMessage( char, "Page from " + who.name + ": " + thepage);
-	   endforeach
-    2: foreach char in onlinecounselors
-		 SendSysMessage( char, "Page from " + who.name +  ": " + thepage);
-	   endforeach
-  endcase
-endfunction

Deleted: trunk/096/scripts/include/innCheck.inc
===================================================================
--- trunk/096/scripts/include/innCheck.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/innCheck.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,22 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-use util;
-
-function Inncheck(character)
-
-  var element, rect;
-  var cfgfile := ReadConfigFile("::innlocation");
-  var entries := GetConfigStringKeys(cfgfile);
-  foreach listing in entries
-    element :=  cfgfile[listing];
-    rect := element.rect;
-    rect := SplitWords(rect);
-    if((character.x >= CInt(rect[1])) && (character.x <= CInt(rect[3])) && (character.y >= CInt(rect[2])) && (character.y <= CInt(rect[4])))
-      return 1;
-      break;
-    endif
-  endforeach
-  return 0;
-
-endfunction 
\ No newline at end of file

Deleted: trunk/096/scripts/include/isValidLoc.inc
===================================================================
--- trunk/096/scripts/include/isValidLoc.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/isValidLoc.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,57 +0,0 @@
-use uo;
-use polsys;
-
-function isValidLoc(x, y, realm := "britannia" )
- 
-  if(realm == "britannia" || realm == "britannia_alt")
-  
-	  if((x >= 5112) && (x <= 5213))
-	    if((y >= 1093) && (y <= 1213))
-	      return 0;
-	    endif
-	  endif
-	
-	  if((x >= 5120) && (x <= 5374))
-	    if((y >= 265) && (y <= 512))
-	      return 0;
-	    endif
-	  endif
-	
-	  if((x >= 5890) && (x <= 6142))
-	    if((y >= 514) && (y <= 1278))
-	      return 0;
-	    endif
-	  endif
-	
-	  if((x >= 5376) && (x <= 5910))
-	    if((y >= 1030) && (y <= 1276))
-	      return 0;
-	    endif
-	  endif
-	
-	  if((x >= 5422) && (x <= 6142))
-	    if((y >= 1536) && (y <= 1796))
-	      return 0;
-	    endif
-	  endif
-	
-	  if((x >= 5632) && (x <= 6142))
-	    if((y >= 1784) && (y <= 2303))
-	      return 0;
-	    endif
-	  endif
-	
-	  if((x >= 5120) && (x <= 5680))
-	    if((y >= 2048) && (y <= 2303))
-	      return 0;
-	    endif
-	  endif
-  
-  else
-  	var realm := Realms()[realm];
-  	if( x >= realm.width || y >= realm.height )
-  		return 0;
-  	endif
-  endif
-  return 1;
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/magic.inc
===================================================================
--- trunk/096/scripts/include/magic.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/magic.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,96 +0,0 @@
-const EVID_DISCHARGE := 0x123457;
-
-include ":attributes:attributes";
-
-
-function Resisted(circle, caster, cast_on, amt)
-  // Purpose: to check for resistance to spells cast upon a character
-  // called by: most spells
-  // returns: amount of damage not resisted?
-
-  var magery := CInt(AP_GetSkill(caster, MAGERY));
-  var evalint := CInt(AP_GetSkill(caster, EVALINT));
-  var resist := CInt(AP_GetSkill(cast_on, RESISTING_SPELLS));
-        
-  // chk1 relates to the resist ability.
-  var chk1 := (resist / 5);
-  // chk2 relates to the difficulty level
-  var chk2 := resist - (((magery - 20) / 5) + (circle * 5));
-        
-  if(chk1 < 1)
-    chk1 := 1;
-  endif
-  if(chk2 < 1)
-    chk2 := 1;
-  endif
-        
-  // What an odd construct.  
-  // If you're hit with an easy spell then you have a difficulty of your resist
-  var diff := 0;
-  if(chk1 > chk2)
-    diff := chk1;
-  else
-    diff := chk2;
-  endif
-        
-  if(cast_on.dead)
-    return 0;
-  endif
-  if( SkillCheck(cast_on, RESISTING_SPELLS, diff) > 0 )
-    SendSysMessage(cast_on, "You feel yourself resisting magical energy!");
-    //PlaySoundEffect(cast_on, SFX_SPELL_WEAKEN);
-    //PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 5,5);
-    amt := (amt * 0.5);
-    if(amt < 1)
-      amt := 1;
-    endif
-  endif
-  var modamt := 1;
-  if(resist > evalint)
-    modamt := (1 + ((evalint - resist) / 200.0));
-  elseif(evalint > resist)
-    modamt := (1 + ((evalint - resist) / 500.0));
-  endif
-  amt := (amt * modamt);
-  return CInt(amt);
-endfunction
-
-function getresistpoints(c, victim, skillid)
-  var points;
-  var diff;
-  case(c)
-    1:   points :=  20; diff := 20;
-    2:   points :=  40; diff := 30;
-    3:   points :=  80; diff := 40;
-    4:   points := 100; diff := 50;
-    5:   points := 120; diff := 60;
-    6:   points := 140; diff := 70;
-    7:   points := 160; diff := 86;
-    8:   points := 180; diff := 100;
-  endcase
-  var skill := AP_GetSkill(victim, skillid);
-  if(skill > (diff - 20))
-    if((skill - diff) <= 5)
-      points := points;
-    elseif((skill - diff) <= 10)
-      points := (points * 3) / 4;
-    elseif((skill - diff) <= 15)
-      points := points / 2;
-    elseif((skill - diff) <= 15)
-      points := points / 4;
-    else
-      points := 0;
-    endif
-  endif
-  return points;
-endfunction
-
-function CalcSpellDamage(circle, caster)
-  var die_string := circle+"d8";
-  var dmg := RandomDiceRoll(die_string);
-  dmg := dmg + CInt(AP_GetSkill(caster, MAGERY)/10);
-  if(dmg > (circle * 8))
-    dmg := circle * 8;
-  endif
-  return dmg;
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/math.inc
===================================================================
--- trunk/096/scripts/include/math.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/math.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,608 +0,0 @@
-////////////////////////////////////////////////////////////
-////////////////////////////////////////////////////////////
-//
-//
-// math.inc
-//
-// Siggy's Improved Math Include, v2.0
-// Revision Date:  8/01/03
-//
-// Questions, comments, flames?   Send to:
-// EMail: cjtdennis at comcast.net
-// ICQ: 10520050
-//
-////////////////////////////////////////////////////////////
-////////////////////////////////////////////////////////////
-//
-// History:
-//
-// v2.0:
-//	- Added Min and Max functions.
-//	- Added Bounded function.
-//	- Added SplitLog function.
-// 
-// v1.5:
-//	- Factorial(x) now returns 1 if x==0.
-//	- Log(x, y) now uses Log10 instead of successive
-//	  approximation.
-//
-// v1.4:
-//	- Fixed errors in Mean and StdDev.
-//	- Minor code cleanup across include.
-//
-// v1.3:
-//	- Removed items duplicated in math.em.
-//
-////////////////////////////////////////////////////////////
-////////////////////////////////////////////////////////////
-
-use math;
-
-
-const CONST_E := 2.718282;
-const CONST_PI := 3.141592;
-
-
-
-function Log(b, x)
-
-// Finds the logarithm to base <b> of <x>.
-
-	if (x<=0)
-		return 0;
-	endif
-	return (Log10(x) / Log10(b));
-
-endfunction
-
-
-function SplitLog(x)
-// Returns array of {characteristic, mantissa} for x.
-// (If x==1.12345, the characteristic is "1", and the 
-// mantissa is (0.12345)
-
-	return { (CInt(x)), (x - CInt(x)) };
-endfunction
-
-
-function Bounded(x, i, y, inclusive := 1)
-// Checks to see if a number "i" falls between the two
-// bounds "x" and "y".  If inclusive is set to nonzero,
-// the function will return true if (i=x) || (i=y).
-	if (inclusive)
-		if ( (i >= Min({x, y})) && (i <= Max({x, y})) )
-			return 1;
-		else
-			return 0;
-		endif
-	else
-		if ( (i > Min({x, y})) && (i < Max({x, y})) )
-			return 1;
-		else
-			return 0;
-		endif
-	endif
-endfunction
-
-
-function Min(byref x)
-// returns the least value of array "x"
-	x.sort();
-	return x[1];
-endfunction
-
-
-function Max(byref x)
-// returns the greatest value of array "x"
-	x.sort();
-	return x[(len(x))];
-endfunction
-
-
-function Mod(Numerator, Denominator)
-
-// Returns the modulus of the fraction:
-//
-//		 Numerator
-//		-----------
-//		Denominator
-
-
-	return (Numerator - (CInt(Numerator/Denominator) * Denominator));
-	
-endfunction
-
-
-
-
-function Remainder(numerator, denominator)
-
-// Use this to get the remainder for non-integers.
-// Returns the remainder of the fraction:
-//
-//		 Numerator
-//		-----------
-//		Denominator
-
-	while (numerator >= denominator)
-		numerator := numerator - denominator;
-	endwhile
-
-	return numerator;
-
-endfunction
-
-
-function Trunc(number, places)
-
-// Truncates a dbl to a fixed amount of decimal places.
-
-	var base := Pow(10, places);
-
-	number := CDbl(CInt(number * Pow(10, places)));
-	number := number / base;
-
-	return number;
-
-endfunction
-
-
-function Fac(factorial);
-
-// Returns the factorial of a number:
-// Fac(10) = 10 * 9 * 8 * 7 * 6 * 5 * 4 * 3 * 2 * 1
-
-	factorial := CInt(factorial);
-	var x := 1
-
-	while (factorial > 0)
-		x := x * factorial;
-		factorial := factorial - 1;
-	endwhile
-	return x;
-
-endfunction
-
-
-function Exp(base, power)
-
-// Obsolete: math.em has Pow(b, p)
-
-	return Pow(base, power);
-
-endfunction
-
-
-function YRoot(x, y)
-
-// Returns the <y> root of a number <x>:
-	
-	var i := 0.000;
-	var n := 0.000;
-	var root := 2.000;
-	var a := CInt(Sqr(x));
-
-	if (a < 4)
-		a := 4;
-	endif
-
-	var success := 0;
-	while (!success)		
-		n := Pow(root, y);
-		i := x - n;
-		i := i / (a * root);
-		i := Trunc(i, 3);
-		root := root + i;
-		if (i = 0)
-			success := 1;
-			if ( Pow(Root, y) > x )
-				root := root - 0.001;
-			endif
-			if ( Pow((root + 0.001), y) = x)
-				root := root + 0.001;
-			endif
-		endif
-	endwhile
-
-	return root;
-
-endfunction
-
-
-function Inc(a)
-// Increments an integer by one.
-	return (a + 1);
-
-endfunction
-
-
-function Dec(a)
-// Decrements an integer by one.
-	return a - 1;
-
-endfunction
-
-
-function Mean(ArrayX)
-
-// Returns the arithmatic mean (average) of an array of numbers.
-
-	var n, i:=0.000;
-
-	foreach n in ArrayX
-		i := i + n;
-	endforeach
-
-	return (i / Len(ArrayX));
-
-endfunction
-
-
-function StdDev(ArrayX)
-// Returns the Standard Deviation of an array of numbers.
-
-	var m, n, i := 0.000;
-	var ArrayMean := Mean(ArrayX);
-	var ArrayLen := Len(ArrayX);
-
-	foreach m in ArrayX
-		n := m - ArrayMean;
-		n := Pow(n, 2);
-		i := i + n;
-	endforeach
-
-	i := i / (ArrayLen - 1);
-	n := Sqr (i);
-
-	return n;
-
-endfunction
-
-
-function ZTest(ArrayX, mu, sigma)
-// Returns the test statistic for a ZTest.   This is used to show
-// the likelihood that a sample is drawn from the population.  The 
-// mean and standard deviation for the population must be known.
-// The z-statistic is computed as follows:
-//
-//	z = (mean - mu) / (sigma / (Sqr(n))
-//
-// mean = the mean of the ArrayX data
-// mu = the mean of the entire population
-// sigma = the standard deviation of the population
-// n = the number of samples in the data
-
-	var i, n;
-	var z:= 0.000;
-	var ArrayMean := Mean(ArrayX);
-	var ArrayLen := Len(ArrayX);
-
-	i := ArrayMean - mu;
-	n := sigma / Sqr(ArrayLen);
-
-	z := i/n;
-
-	return := z;
-
-endfunction
-
-
-function TTest(ArrayX, mu)
-
-// Returns the test statistic for a TTest.   This is used to show
-// the likelihood that a sample is drawn from the population, when 
-// the mean and standard deviation for the entire population are
-// unknown.  The t-statistic is computed as follows:
-//
-//	t = (mean - mu) / (s / (Sqr(n))
-//
-// mean = the mean of the ArrayX data
-// mu = the estimated mean of the entire population
-// s = the standard deviation of the samples
-// n = the number of samples in the data
-
-
-	var i, n, s;
-	var t:= 0.000;
-	var ArrayMean := Mean(ArrayX);
-	var ArrayLen := Len(ArrayX);
-	var s := StdDev(ArrayX);
-
-	i := ArrayMean - mu;
-	n := s / Sqr(ArrayLen);
-
-	t := i/n;
-
-	return := t;
-
-endfunction
-
-
-
-//
-// BITWISE FUNCTIONS: These are very old, and not very efficient.
-// Use the standard $$, ||, etc. for bitwise comparisons.
-// Left intact to support any legacy code.
-
-
-function BitIn(ArrayX)
-
-// Takes an array of 8 bits and converts them into an integer.
-// This is used for the flag support.  IMPORTANT: bit positon is
-// *NOT* the same thing as the array position!   The first bit in 
-// the flag is the 8th bit in the array, and vice versa.  This is
-// because it processes the bit values in the following order:
-// 128, 64, 32, 16, 8, 4, 2, 1.
-
-	local i := 8;
-	local n;
-	local loop := 1;
-	local bitvalue := 0;
-
-	While (i >= 0)
-
-		n := 8 - i;
-		if (ArrayX[i] = 1)
-			bitvalue := bitvalue + Pow(2, n);
-		endif
-		i := i - 1;
-
-	endwhile
-
-	return bitvalue;
-
-endfunction
-
-
-function BitOut(x)
-
-// This function takes an unsigned, short integer (0-255) and returns
-// an array containing the individual bit values.   IMPORTANT: the 
-// first element of the array is NOT the first bit, it is the 8th
-// bit, and so on down.   See the desc for BitIn for the details.
-
-	x := Cint(x);
-	local loop := 1;
-	local bitvalue := 0;
-	local ArrayX := {0,0,0,0,0,0,0,0};
-	local n;
-
-	while (loop <= 8)
-
-		n := 8 - loop;
-		bitvalue := Pow(2, n);
-		if ( (x - bitvalue) >= 0)
-			ArrayX[loop] := 1;
-			x := x - bitvalue;
-		endif
-		loop := loop + 1;
-
-	endwhile
-
-	return ArrayX;
-
-endfunction
-
-
-function BitAnd(x, y)
-
-// Performs a bitwise logical conjunction for two unsigned, short
-// integers (0-255).  If both values for a position are set, then
-// that position in the result is set.   If either are reset, then
-// the position in the result is reset.
-
-	local ArrayX := BitOut(x);
-	local ArrayY := BitOut(y);
-	local z := 0;
-	local loop := 1;
-	local n;
-
-	while (loop <= 8)
-	
-		n := loop - 1;
-		if ( (ArrayX[loop] = 1) AND (ArrayY[loop] = 1) )
-			z := z + Pow(2, n);
-		endif
-		loop := loop + 1;
-
-	endwhile
-
-	return z;
-
-endfunction
-
-
-function BitOr(x, y)
-
-// Performs a bitwise logical disjunction for two unsigned, short
-// integers (0-255).  If either value (or both values) for a 
-// position are set, then that position in the result is set.   If 
-// both are reset, then the position in the result is reset.
-
-	local ArrayX := BitOut(x);
-	local ArrayY := BitOut(y);
-	local z := 0;
-	local loop := 1;
-	locan n;
-
-	while (loop <= 8)
-
-		n := loop - 1;
-		if ( (ArrayX[loop] = 1) OR (ArrayY[loop] = 1) )
-			z := z + Pow(2, n);
-		endif
-		loop := loop + 1;
-
-	endwhile
-
-	return z;
-
-endfunction
-
-
-function BitXor(x, y)
-
-// Performs a bitwise logical exclusion for two unsigned, short
-// integers (0-255).  If one and ONLY one value for a position is
-// set, then that position in the result is set.   If both are 
-// either set or reset, then the position in the result is reset.
-
-	local ArrayX := BitOut(x);
-	local ArrayY := BitOut(y);
-	local z := 0;
-	local loop := 1;
-	local n;
-
-	while (loop <= 8)
-
-		n := loop - 1;
-		if (ArrayX[loop] - ArrayY[loop] <> 0)
-			z := z + Pow(2, n);
-		endif
-		loop := loop + 1;
-
-	endwhile
-
-	return z;
-
-endfunction
-
-
-function BitEqv(x, y)
-
-// Performs a bitwise logical equivalence for two unsigned, short
-// integers (0-255).  If one and ONLY one value for a position is
-// set, then that position in the result is reset.   If both are 
-// either set or reset, then the position in the result is set.
-
-	local ArrayX := BitOut(x);
-	local ArrayY := BitOut(y);
-	local z := 0;
-	local loop := 1;
-	local n;
-
-	while (loop <= 8)
-
-		n := loop - 1;
-		if (ArrayX[loop] - ArrayY[loop] = 0)
-			z := z + Pow(2, n);
-		endif
-		loop := loop + 1;
-
-	endwhile
-
-	return z;
-
-endfunction
-
-
-function BitImp(x, y)
-
-// Performs a bitwise logical implication for two unsigned, short
-// integers (0-255).  If the a position in the first integer is set,
-// and the corresponding position for the second integer is reset,
-// then that position in the result is reset.  All other combinations
-// will result in the value being set.
-
-	local ArrayX := BitOut(x);
-	local ArrayY := BitOut(y);
-	local z := 0;
-	local loop := 1;
-	local n;
-
-	while (loop <= 8)
-
-		n := loop - 1;
-		if (ArrayX[loop] - ArrayY[loop] < 1)
-			z := z + Pow(2, n);
-		endif
-		loop := loop + 1;
-
-	endwhile
-
-	return z;
-
-endfunction
-
-
-function BitNot(x)
-
-// Performs a logical negation on a short, unsigned integer (0-255).
-// If a position in the integer is set, then that position in the
-// result is reset.  Conversely, if a position in the integer is 
-// reset, then that position in the result is set.
-
-	local ArrayX := BitOut(x);
-	local z := 0;
-	local loop := 1;
-	local n;
-
-	while (loop <= 8)
-
-		n := loop - 1;
-		if (ArrayX[loop] = 0)
-			ArrayX[loop] := 1;
-			z := z + Pow(2, n);
-		else
-			ArrayX[loop] := 0;
-		endif
-
-		loop := loop + 1;
-
-	endwhile
-
-	return z;
-
-endfunction
-
-
-function FlagSet(flag, bit);
-
-// This function will set the <bit> position in the <flag> register.
-// Both <flag> and <bit> are integers.
-
-	bit := 9 - bit;
-	
-	local FlagArray := BitOut(flag);
-	FlagArray[bit] := 1;
-
-	bit := BitIn(FlagArray);
-
-	return bit;
-
-endfunction
-
-
-function FlagReset(flag, bit);
-
-// This function will reset the <bit> position in the <flag> register.
-// Both <flag> and <bit> are integers.
-
-	bit := 9 - bit;
-	
-	local FlagArray := BitOut(flag);
-	FlagArray[bit] := 0;
-
-	bit := BitIn(FlagArray);
-
-	return bit;
-
-endfunction
-
-
-function FlagCheck(flag, bit);
-
-// This function will check the flag in the <bit> position of the
-// <flag> register.  It will return a 1 if the flag is set, and a 0
-// if the flag is reset.  Both <flag> and <bit> are integers.
-
-	local FlagArray := BitOut(flag);
-	bit := 9 - bit;
-
-	if (FlagArray[bit] = 1)
-		return 1;
-	else
-		return 0;
-	endif
-
-endfunction

Deleted: trunk/096/scripts/include/moveObject.inc
===================================================================
--- trunk/096/scripts/include/moveObject.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/moveObject.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,31 +0,0 @@
-/*
- * $Id$
- *
- * Purpose
- *
- * Functions for moving an item / mobile 
- * Will decide which function to use -
- * MoveItemToLocation, MoveCharacterToLocation, MoveObjectToRealm
- *
- */
-
-use uo;
-
-
-function MoveObjectToLocation(object, x, y, z, realm, flags:=MOVEITEM_NORMAL)
-	realm := Lower(realm);
-	
-	if ( realm != object.realm )
-		return MoveObjectToRealm(object, realm, x, y, z, flags);
-	else
-		if ( object.IsA(POLCLASS_MOBILE) )
-			return MoveCharacterToLocation(object, x, y, z, flags);
-		else
-			return MoveItemToLocation(object, x, y, z, flags);
-		endif
-	endif
-	
-	// Shouldn't ever reach this spot.
-	return 0;
-endfunction
-

Deleted: trunk/096/scripts/include/mrcSpawn.inc
===================================================================
--- trunk/096/scripts/include/mrcSpawn.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/mrcSpawn.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,321 +0,0 @@
-use cfgfile;
-include ":attributes:attributes";
-include "include/utility";
-
-var mrcspawn_cfg := ReadConfigFile("::mrcspawn");
-var itemconfig := ReadConfigFile(":*:itemdesc");
-var storage := find_or_create_storage("Merchant Storage");
-
-function FindMerchantType(mrctype)
-	var npcdesccfg	:= ReadConfigFile(":*:npcdesc");
-	var elem := FindConfigElem(npcdesccfg, mrctype);
-	var retval := 0;
-	foreach thing in GetConfigStringArray(elem, "Cprop")
-		var split := SplitWords(thing);
-		if(split[1] == "MerchantType")
-			retval := split[2] - split[2][1];
-			break;
-		endif
-	endforeach
-	return retval;
-endfunction
-
-function create_node_merc(merchanttype, name)
-	var inv_rs := find_or_create_item(storage, name + " RS");
-	var inv_fs := find_or_create_item(storage, name + " FS");
-	var inv_pb := find_or_create_item(storage, name + " PB");
-	var inv_1c := find_or_create_item(storage, name + " 1C");
-	SetObjProperty(inv_rs, "MerchantType", merchanttype);
-	SetObjProperty(inv_rs, "MyGold", 5000);
-	StockInventory(merchanttype, inv_rs);
-	RestockInitialInventory(inv_rs, inv_fs);
-endfunction
-
-function destroy_node_merc(name)
-	DestroyRootItemInStorageArea(storage, name + " RS");
-	DestroyRootItemInStorageArea(storage, name + " FS");
-	DestroyRootItemInStorageArea(storage, name + " PB");
-	DestroyRootItemInStorageArea(storage, name + " 1C");
-endfunction
-
-function StockInventory(merchanttype, inventory)
-	var mtype := FindConfigElem(mrcspawn_cfg, merchanttype);
-	if(mtype)
-		foreach productgroup in GetConfigStringArray(mtype, "Sells");
-			var pg_elem := FindConfigElem(mrcspawn_cfg, productgroup);
-			foreach itemstr in GetConfigStringArray(pg_elem, "Item")
-				SpawnItem(inventory, itemstr);
-				sleepms(10);
-			endforeach
-		endforeach
-	endif
-endfunction
-
-function SpawnItem(inventory, itemstr)
-	var split := SplitWords(itemstr);
-	var objtype := split[1];
-	var amt := Cint(split[2]);
-	var buyprice	:= itemconfig[objtype].VendorBuysFor;
-	var sellprice := itemconfig[objtype].VendorSellsFor;
-	if(Cint(objtype))
-		objtype := Cint(objtype);
-	else
-		objtype := Cint(GetObjtypeByName(objtype));
-	endif
-	if(!objtype)
-		syslog("Could not determine objtype for itemstr: " + itemstr);
-		return;
-	endif
-	var res;
-	if(amt > 0)
-		var i;
-		for( i := 1; i <= amt; i := i + 1 )
-			res := CreateItemInInventory(inventory, objtype, 1);
-			res.buyprice	:= buyprice;
-			res.sellprice := sellprice;
-		endfor
-	endif
-endfunction
-
-function checkstock(rs, pak)
-// purpose: to remove items that the vendor does not carry, but have been sold to it.
-// and replenish the purchasing gold supply for the vendor.
-	var mygold := Cint(GetObjProperty(rs, "MyGold"));
-	foreach thing in EnumerateItemsInContainer(pak)
-		var crs := Cint(GetObjProperty(thing, "ClearRestock"));
-		var cst;
-		if(crs)
-			if(ReadGameClock() > CInt(crs))
-				cst := CInt(itemconfig[thing.objtype].VendorBuysFor) + 5;
-				if(!cst)
-					cst := 1;
-				endif
-				mygold := CInt(mygold + (cst * thing.amount));
-				DestroyItem(thing);
-			endif
-		endif
-	endforeach
-	SetObjProperty(rs, "MyGold", mygold);
-endfunction
-
-function RestockInitialInventory(source, destination)
-// When vendors start up, they need a slightly different script.
-	var merchanttype := GetObjProperty(source, "MerchantType");
-	var multiplier, amt, mlt, things;
-	var newarray := {};
-	foreach thing in EnumerateItemsInContainer(source)
-		newarray.append(thing.objtype);
-		amt := 0;
-		multiplier := CInt(GetObjProperty(thing, "Multiplier"));
-		var chk := CountExisting(destination, thing.objtype);
-		things := chk[2];
-		amt := chk[1];
-		if(amt >= (thing.amount * multiplier))
-			multiplier := multiplier - 1;
-			if(multiplier < 1)
-				multiplier := 1;
-			endif
-		elseif(amt == 0)
-			multiplier := multiplier + 1;
-			if(multiplier > 20)
-				multiplier := 20;
-			endif
-		endif
-		SetObjProperty(thing, "Multiplier", multiplier);
-		mlt := Cint(thing.amount * multiplier);
-		var buyprice := Cint(thing.buyprice);
-		var sellprice := Cint(thing.sellprice);
-		var res;
-		if(amt != mlt)
-			foreach widget in things
-				DestroyItem(widget);
-			endforeach
-			if(amt > mlt)
-				res := CreateItemInInventory(destination, thing.objtype, mlt);
-				if(res)
-					res.sellprice := sellprice;
-					res.buyprice := buyprice;
-				endif
-			elseif(amt < mlt)
-				var i;
-				for(i:=1; i<= mlt; i := i+1)
-					var res := CreateItemInInventory(destination, thing.objtype, 1);
-					res.sellprice := sellprice;
-					res.buyprice := buyprice;
-					sleepms(1);
-				endfor
-			endif
-		endif
-		sleepms(1);
-	endforeach
-	foreach thing in EnumerateItemsInContainer(destination)
-		if((!(thing.objtype in newarray)) and (!GetObjProperty(thing, "ClearRestock")))
-			DestroyItem(thing);
-		endif
-	endforeach
-endfunction
-
-function RestockMyInventory(source, destination)
-	var merchanttype := GetObjProperty(source, "MerchantType");
-	var multiplier, amt, mlt, items, mygold;
-	var newarray := {}; // Array of what's for sale
-	// cycle through everything that's for sale
-	foreach thing in EnumerateItemsInContainer(source)// this is the "ideal" stock.
-		newarray.append(thing.objtype);
-		amt := 0;
-		mygold := GetObjProperty(source, "MyGold");
-		multiplier := CInt(GetObjProperty(thing, "Multiplier")); // multiplier of increments.
-		var chk := CountExisting(destination, thing.objtype); // to see what we got *really* for sale
-		items := chk[2];// returns all of a particular item, stacked or unstacked. (array)
-		amt := chk[1];
-		
-		// determine whether to increase or decrease stock.
-		if(amt >= (thing.amount * multiplier))
-			multiplier := multiplier - 1;
-			if(multiplier < 1)
-				multiplier := 1;
-			endif
-		elseif(amt == 0)
-			multiplier := multiplier + 1;
-			if(multiplier > 20)
-				multiplier := 20;
-			endif
-		endif
-		SetObjProperty(thing, "Multiplier", multiplier);
-		
-		mlt := Cint(thing.amount * multiplier); // mlt is the amount that should be in stock
-		
-		if(amt != mlt)
-			// define characteristics of the items
-			var buyprice := Cint(thing.buyprice);
-			var sellprice := Cint(thing.sellprice);
-
-			// remove what remains
-			foreach widget in items
-				mygold := mygold + Cint(widget.amount * buyprice);
-				DestroyItem(widget);
-			endforeach
-			var i;
-			// make one of everything you need
-			for(i:=1; i<= mlt; i := i+1)
-				if((mygold > buyprice) or (merchanttype == "Architect"))
-					var res := CreateItemInInventory(destination, thing.objtype, 1);
-					res.sellprice := sellprice;
-					res.buyprice := buyprice;
-					if(merchanttype != "Architect")
-						mygold := mygold - buyprice;
-					endif
-				sleepms(1);
-				endif
-			endfor
-		endif
-		SetObjProperty(source, "MyGold", mygold);
-		sleepms(1);
-	endforeach
-
-	// ditch the leftovers
-	foreach thing in EnumerateItemsInContainer(destination)
-		if((!(thing.objtype in newarray)) and (!GetObjProperty(thing, "ClearRestock")))
-			mygold := mygold + Cint(thing.amount * thing.buyprice);
-			DestroyItem(thing);
-		endif
-	endforeach
-	SetObjProperty(source, "MyGold", mygold);
-endfunction
-
-function CountExisting(container, objtype)
-	var amt := 0;
-	var things := {};
-	foreach thing in EnumerateItemsInContainer(container)
-		if((thing.objtype == objtype) and (Cint(GetObjProperty(thing, "ClearRestock")) == 0))
-			things.append(thing);
-			amt := amt + thing.amount;
-		endif
-	endforeach
-	var ary := {};
-	ary.append(amt);
-	ary.append(things);
-	return ary;
-endfunction
-
-function ModifyPCSellList(merchanttype, backpack)
-	var backpackitems := ListRootItemsInContainer(backpack);
-	var prodgroups := FindConfigElem(mrcspawn_cfg, merchanttype);
-	var buys := GetConfigStringArray(prodgroups, "Buys");
-	var normcost, normsell, percentage;
-	
-	//  If not buying lets call the whole thing off.
-	if(buys.size() < 1)
-		return 0;
-	endif
-
-	var iteminit := 0;
-	var itemmark := -1;
-	
-	// set buy price for each item to be 0 to start. This means it won't be sellable.
-	foreach item in backpackitems
-		item.buyprice := iteminit;
-	endforeach
-	
-	var buynobuyable := { }; 
-	var objtype;
-	var counter := 0;
-	
-	// Populate the array of items the vendor will buy.
-	foreach prodgroup in buys
-		foreach itemstr in GetConfigStringArray(FindConfigElem(mrcspawn_cfg, prodgroup), "Item")
-			itemstr := SplitWords(itemstr);
-			objtype := itemstr[1];
-			if(CInt(objtype))
-				objtype := CInt(objtype);
-			else
-				objtype := GetObjtypeByName(objtype);
-			endif
-			buynobuyable.append(objtype);
-		endforeach
-	endforeach
-	
-	// compare all the items in the top level of the backpack to things the vendor can buy and set the price.
-	if(buynobuyable.size())
-		foreach item in backpackitems
-			if((item.objtype in buynobuyable) && (!item.newbie))
-				counter := counter + 1;
-				if(!item.quality)
-					item.quality := 1;
-				endif
-				normcost := itemconfig[item.objtype].VendorBuysFor;
-				normsell := itemconfig[item.objtype].VendorSellsFor;
-				normcost := normcost * item.quality;
-				normsell := normsell * item.quality;
-				percentage := ((item.hp * 10) / item.maxhp);
-				if(percentage)
-					normcost := CInt((normcost * percentage) / 10);
-					normsell := CInt((normsell * percentage) / 10);
-					item.buyprice := normcost;
-					item.sellprice := normsell;
-				else
-					item.buyprice := itemmark;
-				endif
-			endif
-		endforeach
-	endif
-	return counter;
-endfunction
-
-/*
-function Merchants(merchantgroup)
-	var result := array;
-	var mrc := array;
-	mrc.+name;
-	mrc.+type;
-	var group_elem := FindConfigElem(mrcspawn_cfg, merchantgroup);
-	var count := GetConfigInt(group_elem, "MerchantCount" );
-	var i;
-	for( i := 1; i <= count; i := i + 1 )
-		mrc.name := GetConfigString(group_elem, "Merchant" + i);
-		mrc.type := GetConfigString(group_elem, "MerchantType"+i);
-		result[i] := mrc;
-	endfor
-	return result;
-endfunction
-*/
\ No newline at end of file

Deleted: trunk/096/scripts/include/myUtil.inc
===================================================================
--- trunk/096/scripts/include/myUtil.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/myUtil.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,97 +0,0 @@
-use cfgfile;
-
-//returns all the items in container of objtype
-function EnumerateItemsInContainerOfObjtype(container, objtype)
-
-	var ret := { };
-        foreach item in EnumerateItemsInContainer(container)
-		if ( item.objtype == objtype )
-			ret.append(item);
-		endif
-	endforeach
-
-	return ret;
-
-endfunction
-
-//returns all the 'top-level' items in container
-function ListRootItemsInContainer(container)
-
-	var ret := { };
-        foreach item in EnumerateItemsInContainer(container)
-		if ( item.container == container )
-			ret.append(item);
-		endif
-	endforeach
-
-	return ret;
-
-endfunction
-
-//returns all the 'top-level' items in container of objtype
-function ListRootItemsInContainerOfObjtype(container, objtype)
-
-	var ret := { };
-        foreach item in EnumerateItemsInContainer(container)
-		if ( (item.container == container) && (item.objtype == objtype) )
-			ret.append(item);
-		endif
-	endforeach
-
-	return ret;
-
-endfunction
-
-function InInventory(inventory, it)
-
-	foreach item in EnumerateItemsInContainer(inventory)
-		if (item == it)
-			return 1;
-		endif
-	endforeach
-
-	return 0;
-
-endfunction
-
-function IsContainer( it )
-
-	if (it.objtype == 0x7057)
-		return 0;//trashcans don't count as containers
-		         // random note- huh? trashcans are 0x7007...
-	endif
-
-	var waslocked := it.locked;
-	it.locked := 1;
-	if (it.locked)
-		it.locked := waslocked;
-		return 1;
-	else
-		return 0;
-	endif
-
-endfunction
-
-function IsDungeon( x, y )
-
-	if ( (x >= 5120) && (x <= 6143) )
-		if ( (y >= 0) && (y <= 2303) )
-			return 1;
-		endif
-	endif
-
-	return 0;
-
-endfunction
-
-function NoTeleportZone( x, y )
-
-	if ( (x >= 5120) && (x <= 6143) )
-		if ( (y >= 2080) && (y <= 2303) )
-			return 1;
-		endif
-	endif
-
-	return 0;
-
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/noto.inc
===================================================================
--- trunk/096/scripts/include/noto.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/noto.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,236 +0,0 @@
-use uo;
-use util;
-use math;
-
-include ":attributes:attributes";
-
-var nototitles :=
-{
-    {"Outcast",     "Wretched",     "Nefarious", "Dread",         "Dread"},
-    {"Despicable",  "Dastardly",    "Wicked",    "Evil",          "Evil"},
-    {"Scoundrel",   "Malicious",    "Vile",      "Villainous",    "Dark"},
-    {"Unsavory",    "Dishonorable", "Ignoble",   "Sinister",      "Sinister"},
-    {"Rude",        "Disreputable", "Notorious", "Infamous",      "Dishonored"},
-    {"None",        "Notable",      "Prominent", "Reknowned",     ""},
-    {"Fair",        "Upstanding",   "Reputable", "Distinguished", "Distinguished"},
-    {"Kind",        "Respectable",  "Proper",    "Eminent",       "Eminent"},
-    {"Good",        "Honorable",    "Admirable", "Noble",         "Noble"},
-    {"Honest",      "Commendable",  "Famed",     "Illustrious",   "Illustrious"},
-    {"Trustworthy", "Estimable",    "Great",     "Glorious",      "Glorious"}
-};
-
-function AdjustNoto(attacker, defender)
-  if(attacker.isA(POLCLASS_NPC))
-    return;
-  endif
-  var karma   := CInt(GetObjProperty(attacker, "Karma"));
-  var fame    := CInt(GetObjProperty(attacker, "Fame"));
-  var dkarma  := CInt(GetObjProperty(defender, "Karma"));
-  var dfame   := CInt(GetObjProperty(defender, "Fame"));
-  var dfchk, dkchk;
-  if(defender.isA(POLCLASS_MOBILE))
-    dkarma := dkarma / 100.0;
-    dkchk := dkarma * 10;
-  elseif(!AP_GetStat(defender, "Strength"))
-    dkarma := dkarma * 10;
-    dkchk := dkarma * 10;
-    dkchk := 0 - dkchk;
-  endif
-  if(defender.isA(POLCLASS_MOBILE))
-    dfame := dfame / 100.0;
-    dfchk := dfame * 10;
-  elseif(!AP_GetStat(defender, "Strength"))
-    dfchk := dfame * 100;
-    dfame := dfame * 10;
-  endif
-  var kmod      := GetKarmaLevel(karma) - 6;
-  var fmod      := GetFameLevel(fame);
-  var dkmod     := GetKarmaLevel(dkchk) - 6;
-  var dfmod     := GetFameLevel(dfchk);
-  var famegain  := dfame;
-  var karmagain := (0 - dkarma);
-  var chk := 0;
-  if(karmagain >= 0)
-    chk := 1;
-  endif
-  if(Abs(kmod) > Abs(dkmod))
-    karmagain := 0;
-  elseif(Abs(kmod) == Abs(dkmod))
-    karmagain := Abs(karmagain) / 4;
-    if(chk == 0)
-      karmagain := (0 - karmagain);
-    endif
-  else
-    karmagain := Abs(karmagain) / 2;
-    var holder := 0;
-    case(dkmod - kmod)
-      1: holder := 0.15;
-      2: holder := 0.30;
-      3: holder := 0.45;
-      4: holder := 0.60;
-      5: holder := 0.75;
-      6: holder := 0.90;
-    endcase
-    karmagain := karmagain + CInt(karmagain * holder);
-    if(chk == 0)
-      karmagain := (0 - karmagain);
-    endif
-  endif
-  if(fmod == dfmod)
-    famegain := famegain / 4;
-  elseif(fmod > dfmod)
-    famegain := 0;
-  else
-    famegain := famegain / 2;
-  endif
-  if(defender.isA(POLCLASS_MOBILE))
-    famegain := famegain / 100;
-    karmagain := karmagain / 100;
-  endif
-  karma := karma + karmagain;
-  fame := fame + famegain;
-  var online := 0;
-  if(!attacker.isA(POLCLASS_NPC))
-    foreach char in EnumerateOnlineCharacters()
-      if(char == attacker)
-        online := 1;
-        break;
-      endif
-    endforeach
-    if(online == 1)
-      SetObjProperty(attacker, "Karma", karma);
-      SetObjProperty(attacker, "Fame", fame);
-      SendGainMessage(attacker, "Fame", famegain);
-      SendGainMessage(attacker, "Karma", karmagain);
-    else
-      SetObjProperty(attacker, "ModKarma", kmod);
-      SetObjProperty(attacker, "ModFame", famegain);
-    endif
-  else
-    SetObjProperty(attacker, "Karma", karma);
-    SetObjProperty(attacker, "Fame", fame);
-  endif
-  if(attacker.isA(POLCLASS_MOBILE))
-    SetNotoTitle(attacker, karma, fame);
-  endif
-  if(defender.isA(POLCLASS_MOBILE))
-    SetNotoTitle(defender, kmod, fmod);
-  endif
-endfunction
-
-function GetFameLevel(fame)
-  var fmod := 0;
-  if((fame <= 1249) && (fame >= 0))
-    fmod := 1;
-  elseif((fame <= 2499) && (fame >= 1250))
-    fmod := 2;
-  elseif((fame <= 4999) && (fame >= 2500))
-    fmod := 3;
-  elseif((fame <= 9999) && (fame >= 5000))
-    fmod := 4;
-  elseif(fame >= 10000)
-    fmod := 5;
-  endif
-  return fmod;
-endfunction
-
-function GetKarmaLevel(karma)
-  var kmod := 0;
-  if(karma <= -10000)
-    kmod := 1;
-  elseif((karma <= -5000) && (karma >= -9999))
-    kmod := 2;
-  elseif((karma <= -2500) && (karma >= -4999))
-    kmod := 3;
-  elseif((karma <= -1250) && (karma >= -2499))
-    kmod := 4;
-  elseif((karma <=  -625) && (karma >= -1249))
-    kmod := 5;
-  elseif((karma <=   624) && (karma >=  -624))
-    kmod := 6;
-  elseif((karma <=  1249) && (karma >=   625))
-    kmod := 7;
-  elseif((karma <=  2499) && (karma >=  1250))
-    kmod := 8;
-  elseif((karma <=  4999) && (karma >=  2500))
-    kmod := 9;
-  elseif((karma <=  9999) && (karma >=  5000))
-    kmod := 10;
-  elseif(karma >= 10000)
-    kmod := 11;
-  endif
-  return kmod;
-endfunction
-
-function SetNotoTitle(who, karma, fame)
-  var kmod := GetKarmaLevel(karma);
-  var fmod := GetFameLevel(fame);
-  var newtitle := nototitles[ (kmod) ];
-  
-  // That trailing space seems to be unneeded
-  //newtitle := "The " + CStr(newtitle[fmod]) + " ";
-  newtitle := "The " + CStr(newtitle[fmod]);
-  
-  if(newtitle["None"])
-    newtitle := "";
-  endif
-  if(fmod == 5)
-    if(who.gender == 1)
-      newtitle := newtitle + " Lady";
-    else
-      newtitle := newtitle + " Lord";
-    endif
-  endif
-  if(newtitle != who.title_prefix)
-    who.title_prefix := newtitle;
-    SendSysMessage(who, "You are now known as " + newtitle + " " + who.name);
-  endif
-endfunction
-
-function SendGainMessage(who, type, amount)
-  var msgtext := "You have ";
-  if(amount < 0)
-    msgtext := msgtext + "lost ";
-    amount := Abs(amount);
-  else
-    msgtext := msgtext + "gained ";
-  endif
-  if(amount > 150)
-    msgtext := msgtext + "a great amount of ";
-  elseif(amount > 125)
-    msgtext := msgtext + "a lot of ";
-  elseif(amount > 75)
-    msgtext := msgtext + "a good amount of ";
-  elseif(amount > 30)
-    msgtext := msgtext + "some ";
-  elseif(amount > 0)
-    msgtext := msgtext + "a little ";
-  else
-    return 0;
-  endif
-  msgtext := msgtext + type + ".";
-  SendSysMessage(who, msgtext);
-endfunction
-
-function ExceptionalFameMod(who, skill, diff, points)
-  if(skill > (diff - 20))
-    if((skill - diff) <= 5)
-      points := points;
-    elseif((skill - diff) <= 10)
-      points := (points * 3) / 4;
-    elseif((skill - diff) <= 15)
-      points := points / 2;
-    elseif((skill - diff) <= 20)
-      points := points / 4;
-    else
-      points := 0;
-    endif
-    points := CInt(points);
-    var fame := CInt(GetObjProperty(who, "Fame"));
-    var famegain := fame + points;
-    SetObjProperty(who, "Fame", famegain);
-
-    SendGainMessage(who, "fame", points);
-    SetNotoTitle(who, CInt(GetObjProperty(who, "Karma")), CInt(GetObjProperty(who, "Fame")));
-  endif
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/objtype.inc
===================================================================
--- trunk/096/scripts/include/objtype.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/objtype.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,220 +0,0 @@
-/////////////////////////////////////////////////////////////////////////////
-//
-// include/objtype.inc - Object Type definitions
-//
-// TODO: consider moving these into include/client.inc
-//       or, moving CID_XX CONSTants in here
-//
-/////////////////////////////////////////////////////////////////////////////
-
-/////////////////////////////////////////////////////////////////////////////
-//
-// 0x0000 to 0x3FFF - "Standard" objects
-//
-/////////////////////////////////////////////////////////////////////////////
-
-CONST UOBJ_STONEWALL_NS := 0x005f;
-CONST UOBJ_STONEWALL_EW := 0x0060;
-CONST UOBJ_GUARDS       := 0xa340;
-CONST UOBJ_FISHSTEAK    := 0x097a;
-
-CONST UOBJ_BOX          := 0x09aa;
-
-CONST UOBJ_FISH_START   := 0x09cc;
-CONST UOBJ_FISH_END     := 0x09cf;
-
-CONST UOBJ_SFISH_START  := 0x0dd6;
-CONST UOBJ_SFISH_END    := 0x0dd9;
-
-CONST UOBJ_KINDLING     := 0x0de1;
-CONST UOBJ_CAMPFIRE     := 0x0de3;
-CONST UOBJ_EMBERS       := 0x0de9;
-CONST UOBJ_ASHES        := 0x0dea;
-
-CONST UOBJ_BANDAGE      := 0x0e21;
-CONST UOBJ_BLANK_SCROLL := 0x0e34;
-
-CONST UOBJ_BANKBOX      := 0x0e40;
-
-CONST UOBJ_DRUM         := 0x0e9c;
-CONST UOBJ_TAMB         := 0x0e9d;
-CONST UOBJ_HARP         := 0x0eb2;
-CONST UOBJ_LUTE         := 0x0eb3;
-
-CONST UOBJ_SPELLBOOK        := 0x0efa;
-
-CONST UOBJ_POISON_POTION    := 0x0f0a;
-CONST UOBJ_EMPTY_BOTTLE     := 0x0f0e;
-
-CONST UOBJ_GEM_START        := 0x0f0f;
-CONST UOBJ_GEM_END          := 0x0f30;
-
-CONST UOBJ_SHOVEL           := 0x0f39;
-
-CONST UOBJ_XBOW             := 0x0f4f;
-
-CONST UOBJ_BLUE_MOONGATE    := 0x0f6c;
-
-
-
-CONST UOBJ_CLAY             := 0xee19;
-CONST UOBJ_SAND             := 0xee18;
-
-
-
-
-CONST UOBJ_BLACK_PEARL      := 0x0f7a;
-CONST UOBJ_BLOOD_MOSS       := 0x0f7b;
-CONST UOBJ_BRIMSTONE        := 0x0f7f;
-CONST UOBJ_FERTILE_DIRT     := 0x0f81;
-CONST UOBJ_EXECUTIONERS_CAP := 0x0f83;
-CONST UOBJ_GARLIC           := 0x0f84;
-CONST UOBJ_GINSENG          := 0x0f85;
-CONST UOBJ_MANDRAKE_ROOT    := 0x0f86;
-CONST UOBJ_NIGHTSHADE       := 0x0f88;
-CONST UOBJ_OBSIDIAN         := 0x0f89;
-CONST UOBJ_PIG_IRON         := 0x0f8a;
-CONST UOBJ_SULFUROUS_ASH    := 0x0f8c; // CHECKME spelling
-CONST UOBJ_SPIDER_SILK      := 0x0f8d;
-CONST UOBJ_VOLCANIC_ASH     := 0x0f8f;
-
-CONST UOBJ_DEAD_WOOD    := 0x0f90;
-
-CONST UOBJ_CLOTH        := 0x0f95;
-CONST UOBJ_CLOTH_STARTS := 0x175d;
-CONST UOBJ_CLOTH_END    := 0x1768;
-CONST UOBJ_LOOM_START   := 0x105f;
-CONST UOBJ_LOOM_END     := 0x1066;
-CONST UOBJ_BOLT_START   := 0x0f95;
-CONST UOBJ_BOLT_END     := 0x0f9c;
-CONST UOBJ_THREAD_START := 0x0fa0;
-CONST UOBJ_THREAD_END   := 0x0fa1;
-CONST UOBJ_MUTLI_CLOTH  := 0x1766;
-CONST UOBJ_SEWING_KIT   := 0x0f9d;
-
-CONST UOBJ_ANVIL1       := 0x0faf;
-CONST UOBJ_ANVIL2       := 0x0fb0;
-CONST UOBJ_SMALL_FORGE  := 0xfb1;  // see also UOBJ_FORGE_START..UOBJ_FORGE_END
-CONST UOBJ_FORGE1       := 0x19a2;
-CONST UOBJ_FORGE2       := 0x19a6;
-CONST UOBJ_FORGE3       := 0x1982;
-CONST UOBJ_FORGE4       := 0x1996;
-CONST UOBJ_FORGE5       := 0x199a;
-CONST UOBJ_FORGE6       := 0x198e;
-CONST UOBJ_FORGE7       := 0x1992;
-CONST UOBJ_FORGE8       := 0x1986;
-CONST UOBJ_FORGE9       := 0x198a;
-
-CONST UOBJ_COPPER_KEY   := 0x100e;
-CONST UOBJ_GOLD_KEY     := 0x100f;
-CONST UOBJ_IRON_KEY     := 0x1010;
-CONST UOBJ_KEY_RING     := 0x1011;
-CONST UOBJ_MAGIC_KEY    := 0x1012;
-CONST UOBJ_RUSTY_IRON_KEY := 0x1013;
-
-CONST UOBJ_CLOCK   := 0x104c;
-CONST UOBJ_CLOCK_FRAME   := 0x104e;
-CONST UOBJ_CLOCK_PARTS   := 0x104f;
-CONST UOBJ_AXLE_AND_GEARS   := 0x1051;
-CONST UOBJ_GEARS   := 0x1053;
-CONST UOBJ_HINGE   := 0x1055;
-CONST UOBJ_SEXTANT   := 0x1057;
-CONST UOBJ_SEXTANT_PARTS   := 0x1059;
-CONST UOBJ_AXLE   := 0x105b;
-CONST UOBJ_SPRINGS   := 0x105d;
-
-CONST UOBJ_TDUMMYSWING_NS     := 0x1071;
-CONST UOBJ_TDUMMYFREEZE_NS    := 0x1070;
-CONST UOBJ_TDUMMYSWING_EW     := 0x1075;
-CONST UOBJ_TDUMMYFREEZE_EW    := 0x1074;
-
-CONST UOBJ_PDUMMYSWING_EW       := 0x1EC1;
-CONST UOBJ_PDUMMYFREEZE_EW      := 0x1EC0;
-CONST UOBJ_PDUMMYSWING_NS       := 0x1EC4;
-CONST UOBJ_PDUMMYFREEZE_NS      := 0x1EC3;
-
-CONST UOBJ_BLOOD        := 0x122d;
-
-CONST UOBJ_BOW          := 0x13b2;
-CONST UOBJ_HEAVY_XBOW   := 0x13fd;
-
-CONST UOBJ_MAP1         := 0x14eb;
-CONST UOBJ_MAP2         := 0x14ec;
-CONST UOBJ_ROLLED_MAP1  := 0x14ed;
-CONST UOBJ_ROLLED_MAP2  := 0x14ee;
-
-CONST UOBJ_HOUSE_DEED1  := 0x14ef;
-CONST UOBJ_SHIP_DEED1   := 0x14f1;
-CONST UOBJ_SHIP_DEED2   := 0x14f2;
-
-CONST UOBJ_CHEST        := 0x1940;
-
-CONST UOBJ_FORGE_START  := 0x197a;  // see also UOBJ_SMALL_FORGE
-CONST UOBJ_FORGE_END    := 0x19a9;
-
-CONST UOBJ_FEATHER      := 0x1bd1;
-CONST UOBJ_SHAFTS       := 0x1bd4;
-CONST UOBJ_LOGS         := 0x1bdd;
-
-CONST UOBJ_GLASS        := 0xee20;
-
-CONST UOBJ_ARM          := 0x1cec;
-CONST UOBJ_LEG          := 0x1ce2;
-CONST UOBJ_TRUNK        := 0x1cee;
-CONST UOBJ_HEART        := 0x1cef;
-CONST UOBJ_HEAD         := 0x1dae;
-
-CONST UOBJ_TINKER_TOOLS := 0x1ebc;
-
-
-CONST UOBJ_RUNE         := 0x1f14;
-
-CONST UOBJ_CORPSE       := 0x2006;
-
-CONST UOBJ_PARAFIELD_NS := 0x3967;
-CONST UOBJ_PARAFIELD_EW := 0x3979;
-CONST UOBJ_POISONFIELD_NS   := 0x3914;
-CONST UOBJ_POISONFIELD_EW   := 0x3920;
-CONST UOBJ_EFIELD_NS        := 0x3947;
-CONST UOBJ_EFIELD_EW        := 0x3956;
-
-CONST GID_PLANK_EXTENDED_FACING_WEST   := 0x3ed5;
-CONST GID_PLANK_RETRACTED_FACING_WEST  := 0x3eb1;
-CONST GID_PLANK_EXTENDED_FACING_EAST   := 0x3ed4;
-CONST GID_PLANK_RETRACTED_FACING_EAST  := 0x3eb2;
-CONST GID_PLANK_EXTENDED_FACING_SOUTH  := 0x3e84;
-CONST GID_PLANK_RETRACTED_FACING_SOUTH := 0x3e85;
-CONST GID_PLANK_EXTENDED_FACING_NORTH  := 0x3e89;
-CONST GID_PLANK_RETRACTED_FACING_NORTH := 0x3e8a;
-
-// ick! these are fine for humans, but not true for items..
-// these are more of a CID.
-CONST UOBJ_HUMAN_MALE   := 0x190;
-CONST UOBJ_HUMAN_FEMALE := 0x191;
-
-/////////////////////////////////////////////////////////////////////////////
-//
-// 0x4000 to 0x4FFF - Multis
-//
-/////////////////////////////////////////////////////////////////////////////
-
-/////////////////////////////////////////////////////////////////////////////
-//
-// 0x5000 to 0xEFFF - To Be Determined
-//
-/////////////////////////////////////////////////////////////////////////////
-
-
-/////////////////////////////////////////////////////////////////////////////
-//
-// 0xF000 to 0xFFFF - Reserved by system
-//
-/////////////////////////////////////////////////////////////////////////////
-
-        //
-        // Ship Components
-        //
-CONST EXTOBJ_TILLERMAN       := 0xf010;
-CONST EXTOBJ_PORT_PLANK      := 0xf011;
-CONST EXTOBJ_STARBOARD_PLANK := 0xf012;
-CONST EXTOBJ_HOLD            := 0xf013;

Modified: trunk/096/scripts/include/packets.inc
===================================================================
--- trunk/096/scripts/include/packets.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/packets.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,4 +1,4 @@
-/* $Id: packets.inc,v 1.1 2004/03/16 14:05:46 folko Exp $
+/* $Id$
  *
  * Purpose
  * Provide various functions and constants for raw packets.
@@ -38,11 +38,11 @@
  *
  */
 function SendFeatures(who, features)
-    var packet;
+	var packet;
     
-    packet := CreatePacket(PACKET_FEATURES, 0x03);
-    packet.SetInt16(1, features);
-    packet.SendPacket(who);
+	packet := CreatePacket(PACKET_FEATURES, 0x03);
+	packet.SetInt16(1, features);
+	packet.SendPacket(who);
 
-    return;
+	return 1;
 endfunction

Deleted: trunk/096/scripts/include/properties.inc
===================================================================
--- trunk/096/scripts/include/properties.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/properties.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,88 +0,0 @@
-/* $Id: properties.inc,v 1.1 2004/03/16 14:05:46 folko Exp $
- *
- * Purpose
- * Provide property names and functions. Properties starting with "+" are to be protected.
- *
- */
-use uo;
-
-include "include/log";
-
-const SECURE_MAGIC          := 0xBADC0DE;
-
-enum MOB_PROPS
-    PROP_STAFF_LEVEL        := "+StaffLevel",        // Text command access level
-    PROP_CREATION_TIME      := "CreationTime",       // Character creation time (UNIX timestamp)
-    MOB_CPROPS_END          := 0
-endenum
-
-enum ITEM_PROPS
-    ITEM_CPROPS_END         := 0
-endenum
-
-enum WORLD_PROPS
-    PROP_PID                := "#PID",              // Array with all resistent scripts
-    PROP_TIMESTAMP          := "TimeStamp",         // Struct describing the time
-    WORLD_PROPS_END         := 0
-endenum
-
-
-// These properties only exist for a short time
-enum TEMP_PROPS
-    TEMPPROP_JUST_CREATED   := "#JustCreated",      // Character was just created
-    TEMPPROP_SCHED_PID      := "#SchedPID",         // PID of script scheduler
-    TEMP_PROPS_END          := 0
-endenum
-
-
-/*
- * The following functions replace the default ObjProperty functions. Use these instead to avoid
- * changing secured properies. If your script is safe, pass SECURE_MAGIC as magic.
- *
- */
-function SetProperty(what, property, value, magic := 0)
-    if(property[1] == "+")
-        if(magic == SECURE_MAGIC)
-            Log(LOG_WARNING, "Overwrote secure property '" + property + "' with '" + CStr(value) + "' on '" +
-                GetLogInfo(what) + "'");
-        else
-            Log(LOG_ERROR, "Failed to overwrite secure property '" + property + "' with '" + CStr(value) + "' on '" +
-                GetLogInfo(what) + "'");
-            return(error);
-        endif
-    endif
-    return(SetObjProperty(what, property, value));
-endfunction
-
-function GetProperty(what, property, magic := 0)
-    if(property[1] == "+" && magic != SECURE_MAGIC)
-        Log(LOG_ERROR, "Refused to GetProperty on secure property '" + property + "' on '" + GetLogInfo(what) + "'");
-        return(error);
-    endif
-    return(GetObjProperty(what, property));
-endfunction
-
-function EraseProperty(what, property, magic := 0)
-    if(property[1] == "+" && magic != SECURE_MAGIC)
-        Log(LOG_ERROR, "Refused to erase secure property '" + property + "' on '" + GetLogInfo(what) + "'");
-        return(error);
-    endif
-    return(EraseObjProperty(what, property));
-endfunction
-
-function GetPropertyNames(what, magic := 0)
-    var props, i;
-
-    if(magic == SECURE_MAGIC)
-        return(GetObjPropertyNames(what));
-    endif
-    
-    props := GetObjPropertyNames(what);
-    for(i := 1; i <= props.size(); i := i + 1)
-        if(props[i][1] == "+")
-            props.erase(i);
-            i := i - 1;
-        endif
-    endfor
-    return(props);
-endfunction

Deleted: trunk/096/scripts/include/recallRune.inc
===================================================================
--- trunk/096/scripts/include/recallRune.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/recallRune.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,48 +0,0 @@
-use uo;
-use os;
-
-function Rename_Rune(who,rune)
-        if (GetObjProperty( rune, "x" ) == error)
-                SendSysMessage( who, "That rune is not marked." );
-                return;
-        endif
-
-	var mark := CInt(GetObjProperty( rune, "mark" ));
-        var descrip := "a ";
-
-	if (mark<4)
-               	if (mark<2)
-               		descrip := descrip + "nearly blanked";
-       		else
-               		descrip := descrip + "worn";
-       		endif
-       	endif
-
-	if (GetObjProperty( rune, "Place" ) == error)
-       		rune.name := descrip + " marked recall rune";
-	else
-		rune.name := descrip + " rune for " + GetObjProperty( rune, "Place" );
-        endif
-
-endfunction
-
-
-// chance is the #/10 for the rune to blank
-function Blank_Rune(who,rune,chance)
-        var mark := CInt(GetObjProperty( rune, "mark" ));
-
-	if (mark<1) // non initialized rune
-		mark := 6; // make it full (lucky guy !)
-		SetObjProperty(rune,"mark",mark);
-	endif
-
-        if (RandomInt(10)<chance)  // Rune is blanking
-                mark := mark - 1;
-		SetObjProperty(rune,"mark",mark);
-                if (mark == 0)
-                        DestroyItem(rune);
-                else
-			Rename_Rune(who,rune);
-		endif
-	endif
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/reportMurder.inc
===================================================================
--- trunk/096/scripts/include/reportMurder.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/reportMurder.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,116 +0,0 @@
-use uo;
-use os;
-
-//include "include/bounty";
-include ":gumps:include/gumps";
-include ":datafile:datafile";
-
-const LONG_COUNT_DECAY_TIME := 144000; //40 hours
-const SHORT_COUNT_DECAY_TIME := 28800; //8 hours
-
-//var reportables;
-//var reportdata := array{};
-
-function SendReportGump(who)
-	var reportables := who.reportables;
-	var report_data := array{};
-	
-	var gump := GFCreateGump();
-	GFPage(gump, 0);
-	GFDisposable(gump, 0);
-	GFClosable(gump, 0);
-	GFMovable(gump, 0);
-	GFResizePic(gump, 0, 0, 2600, 480, 480);
-	GFAddButton(gump, 380, 345, 249, 248, 1, 99);
-	GFTextLine(gump, 50, 20, 0, "Now is the time for retribution!");
-	GFTextLine(gump, 50, 50, 0, "Check zero or more players to report for your murder");
-	GFTextLine(gump, 50, 70, 0, "and press OKAY");
-	
-	FillInArrays(reportables, report_data, gump);
-	
-	SetObjProperty(who, "ReportMenu", report_data);
-	
-	var ret := GFSendGump(who, gump);
-	if( ret == 0 )
-		return;
-	endif
-	
-	EraseObjProperty(who, "ReportMenu");
-	EraseObjProperty(who, "LoginReport");
-	
-	var holder := array{};
-	foreach id in (ret.keys)
-		if( id in report_data )
-			var mob := SystemFindObjectBySerial(id, SYSFIND_SEARCH_OFFLINE_MOBILES);
-			if( !mob.ip )
-				SetObjProperty(mob.killer, "LoginNotify", who.serial);
-			else
-				AdjustNoto(mob, who);
-			endif
-			
-			holder.append(id);
-			AdjustMurderCounts(mob.killer);
-		endif
-		sleepms(2);
-	endforeach
-	
-	foreach reportable in (who.reportables)
-		who.removeReportable(reportable.serial, reportable.gameclock);
-		sleepms(2);
-	endforeach
-	
-	var parms := array{who, holder};
-	var script := start_script(":bountyboard:bounty", parms);
-	if ( script.errortext )
-		SysLog("ERROR SendReportGump():: Unable to start :bountyboard:bounty ->"+script.errortext);
-		return error;
-	endif
-	
-	return 1;
-endfunction
-
-function FillInArrays(reportables, byref report_data, byref gump)
-	var prev_y := 80;
-	var buttonret := 10;
-	GFPage(gump, 1);
-	foreach reportable in reportables
-		if( !(reportable.killer).cmdlevel )
-			if( buttonret == 21 )
-				prev_y := 80;
-			endif
-			report_data.append((reportable.killer).serial);
-			GFCheckBox(gump, 40, prev_y+20, 210, 211, 0, (reportable.killer).serial);
-			GFTextLine(gump, 60, prev_y+20, 0, (reportable.killer).name);
-			prev_y := prev_y+20;
-			buttonret := buttonret+1;
-		endif
-		
-		sleepms(2);
-	endforeach
-	
-	return 1;
-endfunction
-
-function AdjustMurderCounts(killer)
-	var onlinetime := GetObjProperty(killer, "onlinetimer");
-	var longcount := GetObjProperty(killer, "longmurders");
-	
-	if( !longcount )
-		longcount := 0;
-	endif
-	
-	longcount := longcount + 1;
-	SetObjProperty(killer, "longmurders", longcount);
-	
-	if( longcount > 4 )
-		killer.setMurderer(1);
-		SendSysMessage(killer, "You are now known as a murderer!");
-	endif
-	
-	SetObjProperty(killer, "decaylongcountat", (onlinetime+LONG_COUNT_DECAY_TIME));
-	
-	var shortcount := CInt(GetObjProperty(killer, "shortmurders"));
-	shortcount := shortcount + 1;
-	SetObjProperty(killer, "shortmurders", shortcount);
-	SetObjProperty(killer, "decayshortcountat", (onlinetime+SHORT_COUNT_DECAY_TIME));
-endfunction

Deleted: trunk/096/scripts/include/resurrection.inc
===================================================================
--- trunk/096/scripts/include/resurrection.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/resurrection.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,80 +0,0 @@
-/*
- * $Id$
- *
- * Uhh what the fuck is this anyway?
- *
- */
-
-use uo;
-use os;
-
-include ":attributes:attributes";
-include ":gumps:gumps";
-
-const MAXIMUM_LOSS := 0.20; //20% loss for 20 shortterm murders or more
-
-function ResNow(mobile)
-
-	var gump := GFCreateGump();
-	GFClosable(gump, 0);
-	GFGumpPic(gump, 300, 230, 2070);
-	GFAddButton(gump, 330, 305, 2073, 2072, GF_CLOSE_BTN, 10);
-	GFAddButton(gump, 400, 305, 2076, 2075, GF_CLOSE_BTN, 11);
-	GFTextLine(gump, 332, 264, 40, "Resurrect Now?");
-
-	var input := GFSendGump(mobile, gump);
-	input := input[0];
-	input := input-10;
-
-	if ( !input )
-		return 0;
-	else
-		return 1;
-	endif
-
-endfunction
-
-function MurdererStatLoss(who)
-
-	var shortc := GetObjProperty(who,"shortmurders");
-	if( !shortc )
-		return 0;
-	endif
-
-	if( shortc > 4 )
-		var multiplier := CInt(shortc)/100.0;
-		if( multiplier > MAXIMUM_LOSS )
-			multiplier := MAXIMUM_LOSS;
-		endif
-
-		multiplier := 1.0 - multiplier;
-
-		var str := AP_GetTrueStat(who, "strength");
-		var dex := AP_GetTrueStat(who, "dexterity");
-		var inte := AP_GetTrueStat(who, "intelligence");
-
-		str := CInt(str * multiplier);
-		dex := CInt(dex * multiplier);
-		inte := CInt(inte * multiplier);
-
-		AP_SetTrueStat(who, "strength", str);
-		AP_SetTrueStat(who, "dexterity", dex);
-		AP_SetTrueStat(who, "intelligence", inte);
-
-		AP_SetVital(who, "hits", AP_GetVitalMaximumValue(who, "hits"));
-		AP_SetVital(who, "stamina", AP_GetVitalMaximumValue(who, "stamina"));
-		AP_SetVital(who, "mana", AP_GetVitalMaximumValue(who, "mana"));
-
-		var newval;
-
-		foreach entry in (AP_ListAttributesByType("skill"))
-			var skill_level := AP_GetTrueSkill(who, entry);
-			if( skill_level > 0.0 )
-				newval := skill_level * multiplier;
-				AP_SetTrueSkill(who, entry, newval);
-			endif
-		endforeach
-		SendSysMessage(who,"Thy body pays the price for thy sins.");
-	endif
-
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/scripts.inc
===================================================================
--- trunk/096/scripts/include/scripts.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/scripts.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,29 +0,0 @@
-/* $Id$
- *
- * Purpose
- * Provide various functions for the script object.
- *
- */
-use os;
-
-
-/*
- * KillScript()
- *
- * Author: Folko
- *
- * Purpose
- * Kills the calling script.
- *
- * Parameters
- * No parameters
- *
- * Return value
- * This function will never return
- * 
- */
-function KillScript()
-	GetProcess(GetPID()).kill();
-
-	return; // This doesn't actually happen
-endfunction

Deleted: trunk/096/scripts/include/selChar.inc
===================================================================
--- trunk/096/scripts/include/selChar.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/selChar.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,133 +0,0 @@
-/////////////////////////////////////////////////////////////////////////////
-//
-// selchar.inc: 
-//
-// SelectOnlineCharacter( selector, charname, action )
-//
-// if charname is blank, prompts selector with a dialog box
-// 'action' is the text displayed above the column of buttons
-//
-/////////////////////////////////////////////////////////////////////////////
-
-use uo;
-
-
-function SelectOnlineCharacter( selector, charname, action )
-
-  if(!charname)
-
-    return SelectCharacterFromDialog( selector, "Goto" );
-  else
-    //print (who.name + " wants to visit " + whom);
-
-    charname := upper(charname);
-
-    foreach onlinechr in EnumerateOnlineCharacters()
-        if (upper(onlinechr.name) == charname)
-            return onlinechr;
-        endif
-    endforeach
-
-    return 0;
-
-  endif
-
-endfunction
-
-
-var playercount := 0;
-var pagecount := 1;
-
-var layout := array(
-
-"page 0",
-"nodispose",
-"gumppic 0 50 2620",
-"gumppic 20 50 2621",
-"gumppic 290 50 2622",
-"gumppic 0 68 2623",
-"gumppic 22 68 2624",
-"gumppic 288 68 2625",
-"gumppic 0 272 2623",
-"gumppic 22 272 2624",
-"gumppic 288 272 2625",
-"gumppic 0 476 2626",
-"gumppic 20 476 2627",
-"gumppic 290 476 2628",
-"gumppic 20 80 2621",   
-
-"text 20 59 40 0",
-"text 260 59 40 1"
-);
-
-var data := array(
-       "Player Name",         //0
-       "[action]"
-);
-
-
-function SelectCharacterFromDialog( selector, action )
-
-    var players := EnumerateOnlineCharacters();
-    var datalen;
-    var layoutlen;
-    var prev_y := CInt(80);
-    var datindx;
-    var buttonret := 1;
-   
-
-    layout[GetLayoutLength()+1] := "page " + pagecount;
-    if( len(players) > 19)
-        layout[GetLayoutLength()+1] := "button 285 465 2648 2647 0 " + (pagecount + 1);
-    endif
-
-    data[2] := action;
-
-    foreach player in players
-        playercount := playercount + 1;
-
-        datalen := GetDataLength();
-        layoutlen := GetLayoutLength();
-
-        datindx := datalen+1;
-        data[datindx] := player.name;
-        if( playercount == 20 || playercount == 39 || playercount == 58 || playercount == 77 || playercount == 96)
-
-            pagecount := pagecount + 1;
-            layout[GetLayoutLength()+1] := "page " + pagecount;
-            prev_y := 80;
-            //add page turners
-
-            layout[GetLayoutLength()+1] := "button 285 85 2650 2651 0 " + (pagecount - 1);
-            if( len(players) > playercount + 19)
-                layout[GetLayoutLength()+1] := "button 285 465 2648 2647 0 " + (pagecount + 1);
-            endif
-        endif
-
-        layout[GetLayoutLength()+1] := ("text 20 " + CStr(prev_y + 20) + " 40 " + datalen);
-        layout[GetLayoutLength()+1] := ("button 260 " + CStr(prev_y + 20) + " 2640 2641 1 0 " + buttonret);
-
-        prev_y := prev_y + 20;
-        buttonret := buttonret + 1;
-    endforeach
-
-    var result := SendDialogGump( selector, layout, data );
-
-    if (result)
-        return players[ result[0] ];
-    else
-        return 0;
-    endif
-   
-
-endfunction
-
-
-function GetLayoutLength();
-    return (len(layout));
-endfunction
-
-function GetDataLength();
-    return (len(data));
-endfunction
-

Deleted: trunk/096/scripts/include/skillLists.inc
===================================================================
--- trunk/096/scripts/include/skillLists.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/skillLists.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,99 +0,0 @@
-function getskilllist(me)
-  var mytemplate := lower(GetObjProperty(me, "MerchantType"));
-  case(mytemplate)
-    "healer":           return { "spiritspeaking", "healing", "anatomy", "camping", "fishing", "forensic evaluation" };
-    "stable":           return { "animal lore", "animal taming", "veterinary" };
-    "shipWright":       return { "wrestling", "tactics" };
-    "fisherman":        return { "fishing", "fencing" };
-    "innkeeper":        return { "fencing", "tactics" };
-    "farmer":           return { "swordsmanship", "animal lore", "herding", "veterinary" };
-    "weaponsmith":      return { "swordsmanship", "arms lore", "blacksmithy", "mining", "parrying", "tactics" };
-    "blacksmith":       return { "swordsmanship", "arms lore", "blacksmithy", "mining", "parrying", "tactics" };
-    "Armorer":          return { "mace fighting", "arms lore", "blacksmithy", "mining", "parrying", "tactics" };
-    "barkeep":          return { "mace fighting", "tactics" };
-    "barmaid":          return { "fencing", "tactics" };
-    "baker":            return { "wrestling", "cooking" };
-    "tinker":           return { "fencing", "alchemy", "lockpicking", "tinkering" };
-    "bard":             return { "fencing", "enticement", "musicianship", "provocation", "peacemaking" };
-    "butcher":          return { "mace fighting", "cooking", "taste identification" };
-    "cobbler":          return { "swordsmanship", "tailoring" };
-    "jeweler":          return { "fencing", "item identification" };
-    "mage":             return { "magic resistance", "inscription", "magery", "meditation", "wrestling" };
-    "Alchemist":        return { "magic resistance", "taste identification", "alchemy", "wrestling" };
-    "herbalist":        return { "magic resistance", "alchemy", "cooking", "taste identification", "wrestling" };
-    "tailor":           return { "tailoring", "fencing" };
-    "weaver":           return { "tailoring", "fencing" };
-    "leatherworker":    return { "parrying", "mace fighting" };
-    "provisioner":      return { "tactics", "parrying", "fencing" };
-    "carpenter":        return { "carpentry", "lumberjacking", "swordsmanship" };
-    "bowyer":           return { "archery", "bowcraft", "fencing" };
-    "architect":        return { "magic resistance", "wrestling" };
-    "scribe":           return { "magic resistance", "evaluating intelligence", "wrestling" };
-    "mapmaker":         return { "cartography", "wrestling" };
-    "vetrinarian":      return { "animal lore", "wrestling", "veterinary" };
-    "townguard":        return { "anatomy", "tactics", "swordsmanship", "detect hidden", "arms lore" };
-    "thief":            return { "snooping", "stealing", "remove trap", "stealth", "fencing", "poisoning", "lockpicking", "hiding" };
-    "beggar":           return { "begging", "wrestling", "cooking", "fishing" };
-    "fighter1":         return { "anatomy", "tactics", "swordsmanship", "arms lore" };
-    "fighter2":         return { "anatomy", "tactics", "swordsmanship", "arms lore" };
-    "fighter3":         return { "anatomy", "tactics", "swordsmanship", "arms lore" };
-    "fighter4":         return { "anatomy", "tactics", "swordsmanship", "arms lore" };
-    "paladin":          return { "anatomy", "tactics", "swordsmanship", "detect hidden", "arms lore" };
-    "artist":
-  endcase
-endfunction
-
-function FindSkillId(name)
-  case(name)
-    "alchemy":                  return  0;
-    "anatomy":                  return  1;
-    "animal lore":              return  2;
-    "item identification":      return  3;
-    "arms lore":                return  4;
-    "parrying":                 return  5;
-    "begging":                  return  6;
-    "blacksmithy":              return  7;
-    "bowcraft":                 return  8;
-    "peacemaking":              return  9;
-    "camping":                  return 10;
-    "carpentry":                return 11;
-    "cartography":              return 12;
-    "cooking":                  return 13;
-    "detect hidden":            return 14;
-    "enticement":               return 15;
-    "evaluating intelligence":  return 16;
-    "healing":                  return 17;
-    "fishing":                  return 18;
-    "forensic evaluation":      return 19;
-    "herding":                  return 20;
-    "hiding":                   return 21;
-    "provocation":              return 22;
-    "inscription":              return 23;
-    "lockpicking":              return 24;
-    "magery":                   return 25;
-    "magic resistance":         return 26;
-    "tactics":                  return 27;
-    "snooping":                 return 28;
-    "musicianship":             return 29;
-    "poisoning":                return 30;
-    "archery":                  return 31;
-    "spiritspeaking":           return 32;
-    "stealing":                 return 33;
-    "tailoring":                return 34;
-    "animal taming":            return 35;
-    "taste identification":     return 36;
-    "tinkering":                return 37;
-    "tracking":                 return 38;
-    "veterinary":               return 39;
-    "swordsmanship":            return 40;
-    "mace fighting":            return 41;
-    "fencing":                  return 42;
-    "wrestling":                return 43;
-    "lumberjacking":            return 44;
-    "mining":                   return 45;
-    "meditation":               return 46;
-    "stealth":                  return 47;
-    "remove trap":              return 48;
-  endcase
-endfunction
- 
\ No newline at end of file

Deleted: trunk/096/scripts/include/snooping.inc
===================================================================
--- trunk/096/scripts/include/snooping.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/snooping.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,7 +0,0 @@
-include ":attributes:attributes";
-
-function snoop(who, victim)
-  victim := victim; // stops "var not used" ecompile warning
-  SendSysMessage(who, "Snooping not implemented yet.");
-  return;
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/sorting.inc
===================================================================
--- trunk/096/scripts/include/sorting.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/sorting.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,20 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-function bubble_sort_array(data, pos)
-  var i := 1;
-  var l := len(data);
-  for(i:=1; i<=l; i:=i+1)
-    var ind := data[i];
-    var j := i;
-    while((j > 0) && (data[j-1][pos] > ind[pos]))
-      data[j] := data[j-1];
-      j := j - 1;
-      sleepms(1);
-    endwhile
-    data[j] := ind;
-    sleepms(1);
-  endfor
-  return data;
-endfunction

Deleted: trunk/096/scripts/include/sound.inc
===================================================================
--- trunk/096/scripts/include/sound.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/sound.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,711 +0,0 @@
-/* $Id$
- *
- */
-
-enum SFX_BASE
-	SFX_1     :=  0x0001, // forest
-	SFX_2     :=  0x0002, // forest
-	SFX_3     :=  0x0003, // forest
-	SFX_4     :=  0x0004, // jungle
-	SFX_5     :=  0x0005, // jungle
-	SFX_6     :=  0x0006, // jungle
-	SFX_7     :=  0x0007, // swamp
-	SFX_8     :=  0x0008, // swamp
-	SFX_9     :=  0x0009, // forest
-	SFX_A     :=  0x000a, // forest
-	SFX_B     :=  0x000b, // generic
-	SFX_C     :=  0x000c, // generic
-	SFX_D     :=  0x000d, // jungle
-	SFX_E     :=  0x000e, // jungle
-	SFX_F     :=  0x000f, // swamp
-	SFX_10    :=  0x0010, // swamp
-	SFX_11    :=  0x0011, // water
-	SFX_12    :=  0x0012, // water
-	SFX_13    :=  0x0013, // waves
-	SFX_14    :=  0x0014, // waves
-	SFX_15    :=  0x0015, // wind
-	SFX_16    :=  0x0016, // wind
-	SFX_17    :=  0x0017, // wind
-	SFX_18    :=  0x0018, // bird
-	SFX_19    :=  0x0019, // bird
-	SFX_1A    :=  0x001a, // bird
-	SFX_1B    :=  0x001b, // bird
-	SFX_1C    :=  0x001c, // bird
-	SFX_1D    :=  0x001d, // bird
-	SFX_1E    :=  0x001e, // bird
-	SFX_1F    :=  0x001f, // bird
-	SFX_20    :=  0x0020, // bird
-	SFX_21    :=  0x0021, // bubbles
-	SFX_22    :=  0x0022, // bubbles
-	SFX_23    :=  0x0023, // dripping
-	SFX_24    :=  0x0024, // dripping
-	SFX_25    :=  0x0025, // dripping
-	SFX_26    :=  0x0026, // splashing
-	SFX_27    :=  0x0027, // splashing
-	SFX_28    :=  0x0028, // splashing
-	SFX_29    :=  0x0029, // thundr01.wav, thunder
-	SFX_2A    :=  0x002a, // thundr02.wav, thunder
-	SFX_2B    :=  0x002b, // anvil.wav, anvil
-	SFX_2C    :=  0x002c, // bellows.wav, bellows
-	SFX_2D    :=  0x002d, // chstcls3.wav, chest close
-	SFX_2E    :=  0x002e, // chstopn2.wav, chest open
-	SFX_2F    :=  0x002f, // drawercl.wav, drawer close
-	SFX_30    :=  0x0030, // drawerop.wav, drawer open
-	SFX_31    :=  0x0031, // drink01.wav, drink
-	SFX_32    :=  0x0032, // drink05.wav, drink
-	SFX_33    :=  0x0033, // dropgem1.wav, drop gem
-	SFX_34    :=  0x0034, // dropgem2.wav, drop gem
-	SFX_35    :=  0x0035, // dropgem3.wav, drop gem
-	SFX_36    :=  0x0036, // dropmny1.wav, drop money
-	SFX_37    :=  0x0037, // dropmny2.wav, drop money
-	SFX_38    :=  0x0038, // dropmny3.wav, drop money
-	SFX_39    :=  0x0039, // drum01.wav, drum
-	SFX_3A    :=  0x003a, // drum01_b.wav, drum
-	SFX_3B    :=  0x003b, // eat01.wav, eat
-	SFX_3C    :=  0x003c, // eat03.wav, eat
-	SFX_3D    :=  0x003d, // eat06.wav,eat
-	SFX_3E    :=  0x003e, // flute01.wav, flute
-	SFX_3F    :=  0x003f, // glasbrk1.wav, glassbreak
-	SFX_40    :=  0x0040, // glasbrk2.wav, glassbreak
-	SFX_41    :=  0x0041, // glasbrk3.wav, glassbreak
-	SFX_42    :=  0x0042, // glasbrk4.wav, glassbreak
-	SFX_43    :=  0x0043, // hamer01.wav, hammer
-	SFX_44    :=  0x0044, // harp01.wav, harp
-	SFX_45    :=  0x0045, // harp01_b.wav, harp
-	SFX_46    :=  0x0046, // harp02.wav, harp
-	SFX_47    :=  0x0047, // harp02_b.wav, harp
-	SFX_48    :=  0x0048, // igntorch.wav, ignite torch
-	SFX_49    :=  0x0049, // leather1.wav, leather
-	SFX_4A    :=  0x004a, // lever01.wav, lever
-	SFX_4B    :=  0x004b, // lever02.wav, lever
-	SFX_4C    :=  0x004c, // lever05.wav, lever
-	SFX_4D    :=  0x004d, // lute01.wav, lute
-	SFX_4E    :=  0x004e, // lute01_b.wav, lute
-	SFX_4F    :=  0x004f, // pouring.wav, pouring
-	SFX_50    :=  0x0050, // rustle.wav, rustle
-	SFX_51    :=  0x0051, // swallow2.wav, swallow
-	SFX_52    :=  0x0052, // switch01.wav, switch
-	SFX_53    :=  0x0053, // tamborin.wav, tamborine
-	SFX_54    :=  0x0054, // tambrn_b.wav, tamborine
-	SFX_55    :=  0x0055, // torch01.wav, torch
-	SFX_56    :=  0x0056, // turnpage.wav, turn page
-	SFX_57    :=  0x0057, // unsheth1.wav, ?
-	SFX_58    :=  0x0058, // usecloth.wav, use cloth
-	SFX_59    :=  0x0059, // uselethr.wav, use leather
-	SFX_5A    :=  0x005a, // uselthr1.wav, use leather
-	SFX_5B    :=  0x005b, // aligatr1.wav, alligator
-	SFX_5C    :=  0x005c, // aligatr2.wav, alligator
-	SFX_5D    :=  0x005d, // aligatr3.wav, alligator
-	SFX_5E    :=  0x005e, // aligatr4.wav, alligator
-	SFX_5F    :=  0x005f, // aligatr5.wav, alligator
-	SFX_60    :=  0x0060, // bear1.wav, bear
-	SFX_61    :=  0x0061, // bear2.wav, bear
-	SFX_62    :=  0x0062, // bear3.wav, bear
-	SFX_63    :=  0x0063, // bear4.wav, bear
-	SFX_64    :=  0x0064, // bear5.wav, bear
-	SFX_65    :=  0x0065, // bull1.wav, bull
-	SFX_66    :=  0x0066, // bull2.wav, bull
-	SFX_67    :=  0x0067, // bull3.wav, bull
-	SFX_68    :=  0x0068, // bull4.wav, bull
-	SFX_69    :=  0x0069, // bull5.wav, bull
-	SFX_6A    :=  0x006a, // cat1.wav
-	SFX_6B    :=  0x006b, // cat2.wav
-	SFX_6C    :=  0x006c, // cat3.wav
-	SFX_6D    :=  0x006d, // cat4.wav
-	SFX_6E    :=  0x006e, // cat5.wav
-	SFX_6F    :=  0x006f, // chicken1.wav
-	SFX_70    :=  0x0070, // chicken2.wav
-	SFX_71    :=  0x0071, // chicken3.wav
-	SFX_72    :=  0x0072, // chicken4.wav
-	SFX_73    :=  0x0073, // chicken5.wav
-	SFX_74    :=  0x0074, // cougar1.wav
-	SFX_75    :=  0x0075, // cougar2.wav
-	SFX_76    :=  0x0076, // cougar3.wav
-	SFX_77    :=  0x0077, // cougar4.wav
-	SFX_78    :=  0x0078, // cougar5.wav
-	SFX_79    :=  0x0079, // cow1.wav
-	SFX_7A    :=  0x007a, // cow2.wav
-	SFX_7B    :=  0x007b, // cow3.wav
-	SFX_7C    :=  0x007c, // cow4.wav
-	SFX_7D    :=  0x007d, // cow5.wav
-	SFX_7E    :=  0x007e, // crow1.wav
-	SFX_7F    :=  0x007f, // crow2.wav
-	SFX_80    :=  0x0080, // crow3.wav
-	SFX_81    :=  0x0081, // crow4.wav
-	SFX_82    :=  0x0082, // crow5.wav
-	SFX_83    :=  0x0083, // deer3.wav
-	SFX_84    :=  0x0084, // deer4.wav
-	SFX_85    :=  0x0085, // deer5.wav
-	SFX_86    :=  0x0086, // dog1.wav
-	SFX_87    :=  0x0087, // dog2.wav
-	SFX_88    :=  0x0088, // dog3.wav
-	SFX_89    :=  0x0089, // dog4.wav
-	SFX_8A    :=  0x008a, // dog5.wav
-	SFX_8B    :=  0x008b, // dolphin1.wav
-	SFX_8C    :=  0x008c, // dolphin2.wav
-	SFX_8D    :=  0x008d, // dolphin3.wav
-	SFX_8E    :=  0x008e, // dolphin4.wav
-	SFX_8F    :=  0x008f, // dolphin5.wav
-	SFX_90    :=  0x0090, // eagle1.wav
-	SFX_91    :=  0x0091, // eagle2.wav
-	SFX_92    :=  0x0092, // eagle3.wav
-	SFX_93    :=  0x0093, // eagle4.wav
-	SFX_94    :=  0x0094, // eagle5.wav
-	SFX_95    :=  0x0095, // frstbrd1.wav
-	SFX_96    :=  0x0096, // frstbrd2.wav
-	SFX_97    :=  0x0097, // frstbrd3.wav
-	SFX_98    :=  0x0098, // frstbrd4.wav
-	SFX_99    :=  0x0099, // frstbrd5.wav
-	SFX_9A    :=  0x009a, // goat1.wav
-	SFX_9B    :=  0x009b, // goat2.wav
-	SFX_9C    :=  0x009c, // goat3.wav
-	SFX_9D    :=  0x009d, // goat4.wav
-	SFX_9E    :=  0x009e, // goat5.wav
-	SFX_9F    :=  0x009f, // gorilla1.wav
-	SFX_A0    :=  0x00a0, // gorilla2.wav
-	SFX_A1    :=  0x00a1, // gorilla3.wav
-	SFX_A2    :=  0x00a2, // gorilla4.wav
-	SFX_A3    :=  0x00a3, // gorilla5.wav
-	SFX_A4    :=  0x00a4, // grizzly1.wav
-	SFX_A5    :=  0x00a5, // grizzly2.wav
-	SFX_A6    :=  0x00a6, // grizzly3.wav
-	SFX_A7    :=  0x00a7, // grizzly4.wav
-	SFX_A8    :=  0x00a8, // grizzly5.wav
-	SFX_A9    :=  0x00a9, // horse1.wav
-	SFX_AA    :=  0x00aa, // horse2.wav
-	SFX_AB    :=  0x00ab, // horse3.wav
-	SFX_AC    :=  0x00ac, // horse4.wav
-	SFX_AD    :=  0x00ad, // horse5.wav
-	SFX_AE    :=  0x00ae, // jungbrd1.wav
-	SFX_AF    :=  0x00af, // jungbrd2.wav
-	SFX_B0    :=  0x00b0, // jungbrd3.wav
-	SFX_B1    :=  0x00b1, // jungbrd4.wav
-	SFX_B2    :=  0x00b2, // jungbrd5.wav
-	SFX_B3    :=  0x00b3, // lion1.wav
-	SFX_B4    :=  0x00b4, // lion2.wav
-	SFX_B5    :=  0x00b5, // lion3.wav
-	SFX_B6    :=  0x00b6, // lion4.wav
-	SFX_B7    :=  0x00b7, // lion5.wav
-	SFX_B8    :=  0x00b8, // llama3.wav
-	SFX_B9    :=  0x00b9, // llama4.wav
-	SFX_BA    :=  0x00ba, // llama5.wav
-	SFX_BB    :=  0x00bb, // panther1.wav
-	SFX_BC    :=  0x00bc, // panther2.wav
-	SFX_BD    :=  0x00bd, // panther3.wav
-	SFX_BE    :=  0x00be, // panther4.wav
-	SFX_BF    :=  0x00bf, // panther5.wav
-	SFX_C0    :=  0x00c0, // parrot1.wav
-	SFX_C1    :=  0x00c1, // parrot2.wav
-	SFX_C2    :=  0x00c2, // parrot3.wav
-	SFX_C3    :=  0x00c3, // parrot4.wav
-	SFX_C4    :=  0x00c4, // parrot5.wav
-	SFX_C5    :=  0x00c5, // pig1.wav
-	SFX_C6    :=  0x00c6, // pig2.wav
-	SFX_C7    :=  0x00c7, // pig3.wav
-	SFX_C8    :=  0x00c8, // pig4.wav
-	SFX_C9    :=  0x00c9, // pig5.wav
-	SFX_CA    :=  0x00ca, // rabbit3.wav
-	SFX_CB    :=  0x00cb, // rabbit4.wav
-	SFX_CC    :=  0x00cc, // rabbit5.wav
-	SFX_CD    :=  0x00cd, // rat1.wav
-	SFX_CE    :=  0x00ce, // rat2.wav
-	SFX_CF    :=  0x00cf, // rat3.wav
-	SFX_D0    :=  0x00d0, // rat4.wav
-	SFX_D1    :=  0x00d1, // rat5.wav
-	SFX_D2    :=  0x00d2, // raven1.wav
-	SFX_D3    :=  0x00d3, // raven2.wav
-	SFX_D4    :=  0x00d4, // raven3.wav
-	SFX_D5    :=  0x00d5, // raven4.wav
-	SFX_D6    :=  0x00d6, // raven5.wav
-	SFX_D7    :=  0x00d7, // sheep1.wav
-	SFX_D8    :=  0x00d8, // sheep2.wav
-	SFX_D9    :=  0x00d9, // sheep3.wav
-	SFX_DA    :=  0x00da, // sheep4.wav
-	SFX_DB    :=  0x00db, // sheep5.wav
-	SFX_DC    :=  0x00dc, // snake1.wav
-	SFX_DD    :=  0x00dd, // snake2.wav
-	SFX_DE    :=  0x00de, // snake3.wav
-	SFX_DF    :=  0x00df, // snake4.wav
-	SFX_E0    :=  0x00e0, // snake5.wav
-	SFX_E1    :=  0x00e1, // walrus1.wav
-	SFX_E2    :=  0x00e2, // walrus2.wav
-	SFX_E3    :=  0x00e3, // walrus3.wav
-	SFX_E4    :=  0x00e4, // walrus4.wav
-	SFX_E5    :=  0x00e5, // walrus5.wav
-	SFX_E6    :=  0x00e6, // wolf1.wav
-	SFX_E7    :=  0x00e7, // wolf2.wav
-	SFX_E8    :=  0x00e8, // wolf3.wav
-	SFX_E9    :=  0x00e9, // wolf4.wav
-	SFX_EA    :=  0x00ea, // wolf5.wav
-	SFX_EB    :=  0x00eb, // open01a.wav
-	SFX_EC    :=  0x00ec, // open03a.wav
-	SFX_ED    :=  0x00ed, // open04b.wav
-	SFX_EE    :=  0x00ee, // open09.wav
-	SFX_EF    :=  0x00ef, // portclos.wav
-	SFX_F0    :=  0x00f0, // portcul4.wav
-	SFX_F1    :=  0x00f1, // portcul5.wav
-	SFX_F2    :=  0x00f2, // shut03a.wav
-	SFX_F3    :=  0x00f3, // shut07a.wav
-	SFX_F4    :=  0x00f4, // shut14b.wav
-	SFX_F5    :=  0x00f5, // shut17.wav
-	SFX_F6    :=  0x00f6, // sfx01.wav
-	SFX_F7    :=  0x00f7, // sfx02.wav
-	SFX_F8    :=  0x00f8, // sfx04.wav
-	SFX_F9    :=  0x00f9, // sfx05.wav
-	SFX_FA    :=  0x00fa, // sfx06.wav
-	SFX_FB    :=  0x00fb, // sfx08.wav
-	SFX_FC    :=  0x00fc, // sfx10.wav
-	SFX_FD    :=  0x00fd, // sfx11.wav
-	SFX_FE    :=  0x00fe, // sfx12.wav
-	SFX_FF    :=  0x00ff, // sfx13.wav
-	SFX_100   :=  0x0100, // sfx14_l.wav
-	SFX_101   :=  0x0101, // sfx15_l.wav
-	SFX_102   :=  0x0102, // sfx16_l.wav
-	SFX_103   :=  0x0103, // sfx17_l.wav
-	SFX_104   :=  0x0104, // sfx18_l.wav
-	SFX_105   :=  0x0105, // sfx20_l.wav
-	SFX_106   :=  0x0106, // sfx21_l.wav
-	SFX_107   :=  0x0107, // sfx22_l.wav
-	SFX_108   :=  0x0108, // airelem1.wav
-	SFX_109   :=  0x0109, // airelem2.wav
-	SFX_10A   :=  0x010a, // airelem3.wav
-	SFX_10B   :=  0x010b, // airelem4.wav
-	SFX_10C   :=  0x010c, // airelem5.wav
-	SFX_10D   :=  0x010d, // erthel1.wav
-	SFX_10E   :=  0x010e, // erthel2.wav
-	SFX_10F   :=  0x010f, // erthel3.wav
-	SFX_110   :=  0x0110, // erthel4.wav
-	SFX_111   :=  0x0111, // erthel5.wav
-	SFX_112   :=  0x0112, // firelem1.wav
-	SFX_113   :=  0x0113, // firelem2.wav
-	SFX_114   :=  0x0114, // firelem3.wav
-	SFX_115   :=  0x0115, // firelem4.wav
-	SFX_116   :=  0x0116, // firelem5.wav
-	SFX_117   :=  0x0117, // watrel1.wav
-	SFX_118   :=  0x0118, // watrel2.wav
-	SFX_119   :=  0x0119, // watrel3.wav
-	SFX_11A   :=  0x011a, // watrel4.wav
-	SFX_11B   :=  0x011b, // watrel5.wav
-	SFX_11C   :=  0x011c, // exp01.wav
-	SFX_11D   :=  0x011d, // exp04.wav
-	SFX_11E   :=  0x011e, // exp05.wav
-	SFX_11F   :=  0x011f, // exp06.wav
-	SFX_120   :=  0x0120, // bigfoot1.wav
-	SFX_121   :=  0x0121, // bigfoot2.wav
-	SFX_122   :=  0x0122, // feet01a.wav
-	SFX_123   :=  0x0123, // feet01b.wav
-	SFX_124   :=  0x0124, // feet03a.wav
-	SFX_125   :=  0x0125, // feet03b.wav
-	SFX_126   :=  0x0126, // feet05a.wav
-	SFX_127   :=  0x0127, // feet05b.wav
-	SFX_128   :=  0x0128, // feet08a.wav
-	SFX_129   :=  0x0129, // feet08b.wav
-	SFX_12A   :=  0x012a, // feet10a.wav
-	SFX_12B   :=  0x012b, // feet10b.wav
-	SFX_12C   :=  0x012c, // feet12a.wav
-	SFX_12D   :=  0x012d, // feet12b1wav
-	SFX_12E   :=  0x012e, // feet13a.wav
-	SFX_12F   :=  0x012f, // feet13b.wav
-	SFX_130   :=  0x0130, // feet14a.wav
-	SFX_131   :=  0x0131, // feet14b.wav
-	SFX_132   :=  0x0132, // feet15a.wav
-	SFX_133   :=  0x0133, // feet15b.wav
-	SFX_134   :=  0x0134, // feet15c.wav
-	SFX_135   :=  0x0135, // feet15d.wav
-	SFX_136   :=  0x0136, // hit01.wav
-	SFX_137   :=  0x0137, // hit02.wav
-	SFX_138   :=  0x0138, // hit03.wav
-	SFX_139   :=  0x0139, // hit04.wav
-	SFX_13A   :=  0x013a, // hit05.wav
-	SFX_13B   :=  0x013b, // hit06.wav
-	SFX_13C   :=  0x013c, // hit07.wav
-	SFX_13D   :=  0x013d, // hit08.wav
-	SFX_13E   :=  0x013e, // hit09.wav
-	SFX_13F   :=  0x013f, // hit10.wav
-	SFX_140   :=  0x0140, // hit11.wav
-	SFX_141   :=  0x0141, // hit12.wav
-	SFX_142   :=  0x0142, // hit13.wav
-	SFX_143   :=  0x0143, // hit14.wav
-	SFX_144   :=  0x0144, // hit15.wav
-	SFX_145   :=  0x0145, // hit16.wav
-	SFX_146   :=  0x0146, // hit17.wav
-	SFX_147   :=  0x0147, // hit18.wav
-	SFX_148   :=  0x0148, // hit19.wav
-	SFX_149   :=  0x0149, // hit20.wav
-	SFX_14A   :=  0x014a, // hit21.wav
-	SFX_14B   :=  0x014b, // hit22.wav
-	SFX_14C   :=  0x014c, // foomph01.wav
-	SFX_14D   :=  0x014d, // foomph06.wav
-	SFX_14E   :=  0x014e, // foomph07.wav
-	SFX_14F   :=  0x014f, // foomph08.wav
-	SFX_150   :=  0x0150, // foomph09.wav
-	SFX_151   :=  0x0151, // f_die_01.wav
-	SFX_152   :=  0x0152, // f_die_02.wav
-	SFX_153   :=  0x0153, // f_die_03.wav
-	SFX_154   :=  0x0154, // f_die_04.wav
-	SFX_155   :=  0x0155, // moomph01.wav
-	SFX_156   :=  0x0156, // moomph02.wav
-	SFX_157   :=  0x0157, // moomph03.wav
-	SFX_158   :=  0x0158, // moomph04.wav
-	SFX_159   :=  0x0159, // moomph05.wav
-	SFX_15A   :=  0x015a, // moomph13.wav
-	SFX_15B   :=  0x015b, // m_die_01.wav
-	SFX_15C   :=  0x015c, // m_die_02.wav
-	SFX_15D   :=  0x015d, // m_die_03.wav
-	SFX_15E   :=  0x015e, // m_die_04.wav
-	SFX_15F   :=  0x015f, // fyrbal01.wav
-	SFX_160   :=  0x0160, // fyrbal02.wav
-	SFX_161   :=  0x0161, // fyrbal03.wav
-	SFX_162   :=  0x0162, // corpsr1.wav
-	SFX_163   :=  0x0163, // corpsr3.wav
-	SFX_164   :=  0x0164, // corpsr4.wav
-	SFX_165   :=  0x0165, // corpsr5.wav
-	SFX_166   :=  0x0166, // daemon1.wav
-	SFX_167   :=  0x0167, // daemon2.wav
-	SFX_168   :=  0x0168, // daemon3.wav
-	SFX_169   :=  0x0169, // daemon4.wav
-	SFX_16A   :=  0x016a, // daemon5.wav
-	SFX_16B   :=  0x016b, // dragon1.wav
-	SFX_16C   :=  0x016c, // dragon2.wav
-	SFX_16D   :=  0x016d, // dragon3.wav
-	SFX_16E   :=  0x016e, // dragon4.wav
-	SFX_16F   :=  0x016f, // dragon5.wav
-	SFX_170   :=  0x0170, // ettin1.wav
-	SFX_171   :=  0x0171, // ettin2.wav
-	SFX_172   :=  0x0172, // ettin3.wav
-	SFX_173   :=  0x0173, // ettin4.wav
-	SFX_174   :=  0x0174, // ettin5.wav
-	SFX_175   :=  0x0175, // gargyl1.wav
-	SFX_176   :=  0x0176, // gargyl2.wav
-	SFX_177   :=  0x0177, // gargyl3.wav
-	SFX_178   :=  0x0178, // gargyl4.wav
-	SFX_179   :=  0x0179, // gargyl5.wav
-	SFX_17A   :=  0x017a, // gazer1.wav
-	SFX_17B   :=  0x017b, // gazer2.wav
-	SFX_17C   :=  0x017c, // gazer3.wav
-	SFX_17D   :=  0x017d, // gazer4.wav
-	SFX_17E   :=  0x017e, // gazer5.wav
-	SFX_17F   :=  0x017f, // ghost1.wav
-	SFX_180   :=  0x0180, // ghost2.wav
-	SFX_181   :=  0x0181, // ghost3.wav
-	SFX_182   :=  0x0182, // ghost4.wav
-	SFX_183   :=  0x0183, // ghost5.wav
-	SFX_184   :=  0x0184, // gispidr1.wav
-	SFX_185   :=  0x0185, // gispidr2.wav
-	SFX_186   :=  0x0186, // gispidr3.wav
-	SFX_187   :=  0x0187, // gispidr4.wav
-	SFX_188   :=  0x0188, // gispidr5.wav
-	SFX_189   :=  0x0189, // grat1.wav
-	SFX_18A   :=  0x018a, // grat2.wav
-	SFX_18B   :=  0x018b, // grat3.wav
-	SFX_18C   :=  0x018c, // grat4.wav
-	SFX_18D   :=  0x018d, // grat5.wav
-	SFX_18E   :=  0x018e, // gscorp1.wav
-	SFX_18F   :=  0x018f, // gscorp2.wav
-	SFX_190   :=  0x0190, // gscorp3.wav
-	SFX_191   :=  0x0191, // gscorp4.wav
-	SFX_192   :=  0x0192, // gscorp5.wav
-	SFX_193   :=  0x0193, // harpy1.wav
-	SFX_194   :=  0x0194, // harpy2.wav
-	SFX_195   :=  0x0195, // harpy3.wav
-	SFX_196   :=  0x0196, // harpy4.wav
-	SFX_197   :=  0x0197, // harpy5.wav
-	SFX_198   :=  0x0198, // headls1.wav
-	SFX_199   :=  0x0199, // headls2.wav
-	SFX_19A   :=  0x019a, // headls3.wav
-	SFX_19B   :=  0x019b, // headls4.wav
-	SFX_19C   :=  0x019c, // headls5.wav
-	SFX_19D   :=  0x019d, // liche1.wav
-	SFX_19E   :=  0x019e, // liche2.wav
-	SFX_19F   :=  0x019f, // liche3.wav
-	SFX_1A0   :=  0x01a0, // liche4.wav
-	SFX_1A1   :=  0x01a1, // liche5.wav
-	SFX_1A2   :=  0x01a2, // lzrdmn1.wav
-	SFX_1A3   :=  0x01a3, // lzrdmn2.wav
-	SFX_1A4   :=  0x01a4, // lzrdmn3.wav
-	SFX_1A5   :=  0x01a5, // lzrdmn4.wav
-	SFX_1A6   :=  0x01a6, // lzrdmn5.wav
-	SFX_1A7   :=  0x01a7, // mngbat1.wav
-	SFX_1A8   :=  0x01a8, // mngbat2.wav
-	SFX_1A9   :=  0x01a9, // mngbat3.wav
-	SFX_1AA   :=  0x01aa, // mngbat4.wav
-	SFX_1AB   :=  0x01ab, // mngbat5.wav
-	SFX_1AC   :=  0x01ac, // ogre1.wav
-	SFX_1AD   :=  0x01ad, // ogre2.wav
-	SFX_1AE   :=  0x01ae, // ogre3.wav
-	SFX_1AF   :=  0x01af, // ogre4.wav
-	SFX_1B0   :=  0x01b0, // ogre5.wav
-	SFX_1B1   :=  0x01b1, // orc1.wav
-	SFX_1B2   :=  0x01b2, // orc2.wav
-	SFX_1B3   :=  0x01b3, // orc3.wav
-	SFX_1B4   :=  0x01b4, // orc4.wav
-	SFX_1B5   :=  0x01b5, // orc5.wav
-	SFX_1B6   :=  0x01b6, // ratman1.wav
-	SFX_1B7   :=  0x01b7, // ratman2.wav
-	SFX_1B8   :=  0x01b8, // ratman3.wav
-	SFX_1B9   :=  0x01b9, // ratman4.wav
-	SFX_1BA   :=  0x01ba, // ratman5.wav
-	SFX_1BB   :=  0x01bb, // reaper1.wav
-	SFX_1BC   :=  0x01bc, // reaper2.wav
-	SFX_1BD   :=  0x01bd, // reaper3.wav
-	SFX_1BE   :=  0x01be, // reaper4.wav
-	SFX_1BF   :=  0x01bf, // reaper5.wav
-	SFX_1C0   :=  0x01c0, // seaserp1.wav
-	SFX_1C1   :=  0x01c1, // seaserp3.wav
-	SFX_1C2   :=  0x01c2, // seaserp4.wav
-	SFX_1C3   :=  0x01c3, // seaserp5.wav
-	SFX_1C4   :=  0x01c4, // skletn1.wav
-	SFX_1C5   :=  0x01c5, // skletn2.wav
-	SFX_1C6   :=  0x01c6, // skletn3.wav
-	SFX_1C7   :=  0x01c7, // skletn4.wav
-	SFX_1C8   :=  0x01c8, // skletn5.wav
-	SFX_1C9   :=  0x01c9, // slime1.wav
-	SFX_1CA   :=  0x01ca, // slime2.wav
-	SFX_1CB   :=  0x01cb, // slime3.wav
-	SFX_1CC   :=  0x01cc, // slime4.wav
-	SFX_1CD   :=  0x01cd, // slime5.wav
-	SFX_1CE   :=  0x01ce, // troll1.wav
-	SFX_1CF   :=  0x01cf, // troll2.wav
-	SFX_1D0   :=  0x01d0, // troll3.wav
-	SFX_1D1   :=  0x01d1, // troll4.wav
-	SFX_1D2   :=  0x01d2, // troll5.wav
-	SFX_1D3   :=  0x01d3, // wisp1.wav
-	SFX_1D4   :=  0x01d4, // wisp2.wav
-	SFX_1D5   :=  0x01d5, // wisp3.wav
-	SFX_1D6   :=  0x01d6, // wisp4.wav
-	SFX_1D7   :=  0x01d7, // wisp5.wav
-	SFX_1D8   :=  0x01d8, // zombie1.wav
-	SFX_1D9   :=  0x01d9, // zombie2.wav
-	SFX_1DA   :=  0x01da, // zombie3.wav
-	SFX_1DB   :=  0x01db, // zombie4.wav
-	SFX_1DC   :=  0x01dc, // zombie5.wav
-	SFX_1DD   :=  0x01dd, // elec_l.wav
-	SFX_1DE   :=  0x01de, // fire_l.wav
-	SFX_1DF   :=  0x01df, // hiss_l.wav
-	SFX_1E0   :=  0x01e0, // clumsy.wav
-	SFX_1E1   :=  0x01e1, // cure.wav
-	SFX_1E2   :=  0x01e2, // curse.wav
-	SFX_1E3   :=  0x01e3, // c_food.wav
-	SFX_1E4   :=  0x01e4, // c_light.wav
-	SFX_1E5   :=  0x01e5, // feblmind.wav
-	SFX_1E6   :=  0x01e6, // m_arrow.wav
-	SFX_1E7   :=  0x01e7, // weaken.wav
-	SFX_1E8   :=  0x01e8, // agility.wav
-	SFX_1E9   :=  0x01e9, // archcure.wav
-	SFX_1EA   :=  0x01ea, // birdseye.wav
-	SFX_1EB   :=  0x01eb, // bless.wav
-	SFX_1EC   :=  0x01ec, // cunning.wav
-	SFX_1ED   :=  0x01ed, // identify.wav
-	SFX_1EE   :=  0x01ee, // protect.wav
-	SFX_1EF   :=  0x01ef, // strength.wav
-	SFX_1F0   :=  0x01f0, // trap.wav
-	SFX_1F1   :=  0x01f1, // untrap.wav
-	SFX_1F2   :=  0x01f2, // harm.wav
-	SFX_1F3   :=  0x01f3, // heal.wav
-	SFX_1F4   :=  0x01f4, // magic_fyrbal01.
-	SFX_1F5   :=  0x01f5, // m_lock.wav
-	SFX_1F6   :=  0x01f6, // teleknes.wav
-	SFX_1F7   :=  0x01f7, // walstone.wav
-	SFX_1F8   :=  0x01f8, // aprotect.wav
-	SFX_1F9   :=  0x01f9, // manadran.wav
-	SFX_1FA   :=  0x01fa, // manavamp.wav
-	SFX_1FB   :=  0x01fb, // mark.wav
-	SFX_1FC   :=  0x01fc, // masscurs.wav
-	SFX_1FD   :=  0x01fd, // recall.wav
-	SFX_1FE   :=  0x01fe, // reveal.wav
-	SFX_1FF   :=  0x01ff, // teleport.wav
-	SFX_200   :=  0x0200, // unlock.wav
-	SFX_201   :=  0x0201, // bladsprt.wav
-	SFX_202   :=  0x0202, // dispfild.wav
-	SFX_203   :=  0x0203, // gratheal.wav
-	SFX_204   :=  0x0204, // invisibl.wav
-	SFX_205   :=  0x0205, // paralyze.wav
-	SFX_206   :=  0x0206, // poison.wav
-	SFX_207   :=  0x0207, // thundr01.wav
-	SFX_208   :=  0x0208, // explode.wav
-	SFX_209   :=  0x0209, // flamstrk.wav
-	SFX_20A   :=  0x020a, // massdisp.wav
-	SFX_20B   :=  0x020b, // nrgybolt.wav
-	SFX_20C   :=  0x020c, // parafild.wav
-	SFX_20D   :=  0x020d, // posnfild.wav
-	SFX_20E   :=  0x020e, // earthqke.wav
-	SFX_20F   :=  0x020f, // gatetrvl.wav
-	SFX_210   :=  0x0210, // morph.wav
-	SFX_211   :=  0x0211, // nergyfld.wav
-	SFX_212   :=  0x0212, // nrgywind.wav
-	SFX_213   :=  0x0213, // dethvrtx.wav
-	SFX_214   :=  0x0214, // mindblst.wav
-	SFX_215   :=  0x0215, // resurect.wav
-	SFX_216   :=  0x0216, // sumncrtr.wav
-	SFX_217   :=  0x0217, // sumndemn.wav
-	SFX_218   :=  0x0218, // sumnelem.wav
-	SFX_219   :=  0x0219, // blade01.wav
-	SFX_21A   :=  0x021a, // blade02.wav
-	SFX_21B   :=  0x021b, // blade03.wav
-	SFX_21C   :=  0x021c, // blade04.wav
-	SFX_21D   :=  0x021d, // blade05.wav
-	SFX_21E   :=  0x021e, // boulder1.wav
-	SFX_21F   :=  0x021f, // boulder2.wav
-	SFX_220   :=  0x0220, // crumble1.wav
-	SFX_221   :=  0x0221, // crumble2.wav
-	SFX_222   :=  0x0222, // crumble3.wav
-	SFX_223   :=  0x0223, // crumble4.wav
-	SFX_224   :=  0x0224, // dart01.wav
-	SFX_225   :=  0x0225, // dart02.wav
-	SFX_226   :=  0x0226, // flame01.wav
-	SFX_227   :=  0x0227, // flame03.wav
-	SFX_228   :=  0x0228, // flame05.wav
-	SFX_229   :=  0x0229, // mushrm01.wav
-	SFX_22A   :=  0x022a, // mushrm02.wav
-	SFX_22B   :=  0x022b, // mushrm03.wav
-	SFX_22C   :=  0x022c, // spike01.wav
-	SFX_22D   :=  0x022d, // spike02.wav
-	SFX_22E   :=  0x022e, // spike03.wav
-	SFX_22F   :=  0x022f, // spike04.wav
-	SFX_230   :=  0x0230, // vapor01.wav
-	SFX_231   :=  0x0231, // vapor02.wav
-	SFX_232   :=  0x0232, // vapor03.wav
-	SFX_233   :=  0x0233, // axe01.wav
-	SFX_234   :=  0x0234, // blunt01.wav
-	SFX_235   :=  0x0235, // crossbow.wav
-	SFX_236   :=  0x0236, // gilotin1.wav
-	SFX_237   :=  0x0237, // hvyswrd1.wav
-	SFX_238   :=  0x0238, // hvyswrd4.wav
-	SFX_239   :=  0x0239, // swish01.wav
-	SFX_23A   :=  0x023a, // swish02.wav
-	SFX_23B   :=  0x023b, // swish03.wav
-	SFX_23C   :=  0x023c, // sword1.wav
-	SFX_23D   :=  0x023d, // sword7.wav
-	SFX_23E   :=  0x023e, // carpntry.wav
-	SFX_23F   :=  0x023f, // dye.wav
-	SFX_240   :=  0x0240, // fshsplsh.wav
-	SFX_241   :=  0x0241, // liquid.wav
-	SFX_242   :=  0x0242, // lockpick.wav
-	SFX_243   :=  0x0243, // mortar.wav
-	SFX_244   :=  0x0244, // mystery1.wav
-	SFX_245   :=  0x0245, // mystery2.wav
-	SFX_246   :=  0x0246, // mystery3.wav
-	SFX_247   :=  0x0247, // poison.wav
-	SFX_248   :=  0x0248, // powder.wav
-	SFX_249   :=  0x0249, // scissors.wav
-	SFX_24A   :=  0x024a, // scribe.wav
-	SFX_24B   :=  0x024b, // spirtspk.wav
-	SFX_24C   :=  0x024c, // z_horseft2.wav
-	SFX_24D   :=  0x024d, // z_horseft1.wav
-	SFX_24E   :=  0x024e, // Tera.Warrior 1
-	SFX_24F   :=  0x02ef  // Tera.Warrior 2
-endenum
-
-
-// Fill in the rest of the T2A sounds here.
-enum SFX_MUSIC
-	SFX_MUSIC_LUTE_GOOD           := SFX_4D,
-	SFX_MUSIC_LUTE_FAIL           := SFX_4E,
-	SFX_MUSIC_DRUM_GOOD           := SFX_39,
-	SFX_MUSIC_DRUM_FAIL           := SFX_3A,
-	SFX_MUSIC_HARP_LARGE_GOOD     := SFX_44,
-	SFX_MUSIC_HARP_LARGE_FAIL     := SFX_45,
-	SFX_MUSIC_HARP_LAP_GOOD       := SFX_46,
-	SFX_MUSIC_HARP_LAP_FAIL       := SFX_47,
-	SFX_MUSIC_TAMBORINE_GOOD      := SFX_53,
-	SFX_MUSIC_TAMBORINE_FAIL      := SFX_54
-endenum
-
-
-enum SFX_SPELLS
-	SFX_SPELL_CLUMSY              := SFX_1E0,
-	SFX_SPELL_CREATE_FOOD         := SFX_1E3,
-	SFX_SPELL_FEEBLEMIND          := SFX_1E5,
-	SFX_SPELL_HEAL                := SFX_1F3,
-	SFX_SPELL_MAGIC_ARROW         := SFX_1E6,
-	SFX_SPELL_NIGHT_SIGHT         := SFX_1E4,
-	SFX_SPELL_REACTIVE_ARMOR      := SFX_1F3,
-	SFX_SPELL_WEAKEN              := SFX_1E7,
-	SFX_SPELL_AGILITY             := SFX_1E8,
-	SFX_SPELL_CUNNING             := SFX_1EC,
-	SFX_SPELL_CURE                := SFX_1E1,
-	SFX_SPELL_HARM                := SFX_1F2,
-	SFX_SPELL_MAGIC_TRAP          := SFX_1F0,
-	SFX_SPELL_MAGIC_UNTRAP        := SFX_1F1,
-	SFX_SPELL_PROTECTION          := SFX_1EE,
-	SFX_SPELL_STRENGTH            := SFX_1EF,
-	SFX_SPELL_BLESS               := SFX_1EB,
-	SFX_SPELL_FIREBALL            := SFX_160,
-	SFX_SPELL_MAGIC_LOCK          := SFX_1F5,
-	SFX_SPELL_TELEKINESIS         := SFX_1F6,
-	SFX_SPELL_TELEPORT            := SFX_1FF,
-	SFX_SPELL_POISON              := SFX_247,
-	SFX_SPELL_UNLOCK              := SFX_200,
-	SFX_SPELL_WALL_OF_STONE       := SFX_1F7,
-	SFX_SPELL_ARCH_CURE           := SFX_1E9,
-	SFX_SPELL_ARCH_PROTECTION     := SFX_1F8,
-	SFX_SPELL_CURSE               := SFX_1E2,
-	SFX_SPELL_FIRE_FIELD          := SFX_226,
-	SFX_SPELL_GREATER_HEAL        := SFX_203,
-	SFX_SPELL_LIGHTNING           := SFX_2A,
-	SFX_SPELL_MANA_DRAIN          := SFX_1F9,
-	SFX_SPELL_RECALL              := SFX_1FD,
-	SFX_SPELL_BLADE_SPIRITS       := SFX_213,
-	SFX_SPELL_ENERGY_FIELD        := SFX_211, // used to say dispel field?
-	SFX_SPELL_INCOGNITO           := SFX_1ED,
-	SFX_SPELL_MAGIC_REFLECTION    := SFX_1E8,
-	SFX_SPELL_MIND_BLAST          := SFX_214,
-	SFX_SPELL_PARALYZE            := SFX_205,
-	SFX_SPELL_POISON_FIELD        := SFX_20D, // was 227 (??)
-	SFX_SPELL_SUMMON_CREATURE     := SFX_216,
-	SFX_SPELL_DISPEL              := SFX_202,
-	SFX_SPELL_ENERGY_BOLT         := SFX_20B,
-	SFX_SPELL_EXPLOSION           := SFX_208,
-	SFX_SPELL_INVISIBILITY        := SFX_204,
-	SFX_SPELL_MARK                := SFX_1FB,
-	SFX_SPELL_MASS_CURSE          := SFX_1FC,
-	SFX_SPELL_PARALYZE_FIELD      := SFX_212,
-	SFX_SPELL_REVEAL              := SFX_1FE,
-	SFX_SPELL_CHAIN_LIGHTNING     := SFX_30,
-	SFX_SPELL_PARA_FIELD          := SFX_20C,
-	SFX_SPELL_FLAME_STRIKE        := SFX_209,
-	SFX_SPELL_GATE_TRAVEL         := SFX_20F,
-	SFX_SPELL_MANA_VAMPIRE        := SFX_1FA,
-	SFX_SPELL_MASS_DISPEL         := SFX_20A,
-	SFX_SPELL_METEOR_SWARM        := SFX_161,
-	SFX_SPELL_POLYMORPH           := SFX_20A,
-	SFX_SPELL_EARTHQUAKE          := SFX_20E,
-	SFX_SPELL_ENERGY_VORTEX       := SFX_213,
-	SFX_SPELL_RESSURECTION        := SFX_215,
-	SFX_SPELL_SUMMON_ELEMENTAL    := SFX_218,
-	SFX_SPELL_SUMMON_DAEMON       := SFX_217
-endenum
-
-
-enum SFX_SKILLS
-	SFX_SKILL_SPIRITSPEAK	:= SFX_24B,
-	SFX_SKILL_LUMBERJACK	:= SFX_13F,
-	SFX_SKILL_LOCKPICK	:= SFX_242
-endenum
-
-
-enum SFX_ITEMS
-	SFX_TRAP_NEEDLE		:= SFX_225,
-	SFX_TRAP_POISON		:= SFX_206,
-	SFX_TRAP_EXPLOSION	:= SFX_208,
-	SFX_ANVIL		:= SFX_2B,
-	SFX_PICK		:= SFX_13B,
-	SFX_HAMMER		:= SFX_43,
-	SFX_GLASSBREAK4		:= SFX_42,
-	SFX_HARP_SUCC		:= SFX_46,
-	SFX_LUTE_SUCC		:= SFX_4D,
-	SFX_DRUM_SUCC		:= SFX_39,
-	SFX_TAMB_SUCC		:= SFX_53,
-	SFX_HARP_FAIL		:= SFX_47,
-	SFX_LUTE_FAIL		:= SFX_4E,
-	SFX_DRUM_FAIL		:= SFX_3A,
-	SFX_TAMB_FAIL		:= SFX_54
-endenum
-
-
-enum SFX_DOORS
-	SFX_OPEN_WOODEN_DOOR	:= SFX_EB,
-	SFX_CLOSE_WOODEN_DOOR	:= SFX_F2,
-	SFX_OPEN_METAL_DOOR	:= SFX_ED,
-	SFX_CLOSE_METAL_DOOR	:= SFX_F4
-endenum

Deleted: trunk/096/scripts/include/spellAttack.inc
===================================================================
--- trunk/096/scripts/include/spellAttack.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/spellAttack.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,14 +0,0 @@
-function send_attack(ttarget, source, spellid := 0)
-  var ev := array;
-  ev.+type;
-  ev.+source;
-  ev.type := 0x0002;
-  ev.source := source;
-  SendEvent(ttarget, ev);
-  if (spellid)
-    ev.+spell;
-    ev.type := 0x0800;
-    ev.spell := spellid;
-    SendEvent(ttarget, ev);
-  endif
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/spellRestrictions.inc
===================================================================
--- trunk/096/scripts/include/spellRestrictions.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/spellRestrictions.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,593 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-use util;
-
-include "include/fields";
-include "include/client";
-include "include/tileEffects";
-include "include/sound";
-include "include/objtype";
-include "include/statMod";
-include "include/firewall";
-include "include/spellAttack";
-include "include/dist";
-
-var caster;
-var npccfg := ReadConfigFile("::npcdesc");
-const EVID_DISCHARGE := 0x123457;
-
-
-function maincast(parms, delivery, circle, noto, id);
-  var cast_on;
-  var spellscroll := 0;
-  var scroll;
-  var tgtopt := TGTOPT_CHECK_LOS;
-  if(parms[1] == "#MOB")
-    caster := parms[2];
-    if(mobspellcast(caster, circle, spellscroll) == 0)
-      return 0;
-    endif
-    cast_on := parms[3];
-  elseif (parms[1] == "#scroll")
-    spellscroll := 1;
-    caster := parms[2];
-    EraseObjProperty(caster, "IsMeditating");
-    EraseObjProperty(caster, "HealTimer");
-    if(spellcast(caster, circle, spellscroll, id) == 0)
-      return 0;
-    endif
-    scroll := parms[3];
-    if(!ReserveItem(scroll))
-      SendSysMessage(caster,"You lost your concentration.", 3, 40);
-      return 0;
-    endif
-    if(delivery == "notarget")
-      cast_on := caster;
-      if(!can_cast(caster))
-        cast_on := 0;
-      endif
-    elseif(delivery == "direct")
-      if(noto == "helpful")
-        cast_on := CanTargetSpell(caster, circle, TGTOPT_HELPFUL | tgtopt);
-        if(!can_cast(caster))
-          cast_on := 0;
-        endif
-      elseif(noto == "neutral")
-        cast_on := CanTargetSpell(caster, circle, TGTOPT_NEUTRAL | tgtopt);
-        if(!can_cast(caster))
-          cast_on := 0;
-        endif
-      else
-        cast_on := CanTargetSpell(caster, circle, TGTOPT_HARMFUL | tgtopt);
-        if(!can_cast(caster))
-          cast_on := 0;
-        endif
-      endif
-      if(!cast_on)
-        return 0;
-      endif
-    elseif(delivery == "indirect")
-      cast_on := CanTargetArea(caster, circle);
-      if(!can_cast(caster))
-        cast_on := 0;
-      endif
-      if (!cast_on)
-        return 0;
-      endif
-    else
-      return 0;
-    endif
-  else
-    caster := parms;
-    EraseObjProperty(caster, "IsMeditating");
-    EraseObjProperty(caster, "HealTimer");
-    if (spellcast(caster, circle, spellscroll, id) == 0)
-      return 0;
-    endif
-    if (!ConsumeReagents(caster, id+100))
-      SendSysMessage(caster, "You do not have the proper reagents.");
-      return 0;
-    endif
-    if(delivery == "notarget")
-      cast_on := caster;
-      if(!can_cast(caster))
-        cast_on := 0;
-      endif
-    elseif(delivery == "direct")
-      if(noto == "helpful")
-        cast_on := CanTargetSpell(caster, circle, TGTOPT_HELPFUL | tgtopt);
-        if(!can_cast(caster))
-          cast_on := 0;
-        endif
-      elseif(noto == "neutral")
-        cast_on := CanTargetSpell(caster, circle, TGTOPT_NEUTRAL | tgtopt);
-        if(!can_cast(caster))
-          cast_on := 0;
-        endif
-      else
-        cast_on := CanTargetSpell(caster, circle, TGTOPT_HARMFUL | tgtopt);
-        if(!can_cast(caster))
-          cast_on := 0;
-        endif
-      endif
-      if (!cast_on)
-        return 0;
-      endif
-    elseif(delivery == "indirect")
-      cast_on := CanTargetArea(caster, circle);
-      if(!can_cast(caster))
-        cast_on := 0;
-      endif
-      if (!cast_on)
-        return 0;
-      endif
-    else
-      return 0;
-    endif
-  endif
-  if(newusemana(caster, circle, cast_on, delivery) == 0)
-    PlaySoundEffect(caster,0x005d);
-    PlayObjectCenteredEffect(caster, 0x3735,0x0a, 0x1e);
-    return 0;
-  endif
-  if(spellscroll == 1)
-    if(!SubtractAmount(scroll, 1))
-      return 0;
-    endif
-  endif
-  var points := getpoints(circle, spellscroll, SKILLID_MAGERY);
-  //AwardRawSkillPoints(caster, SKILLID_MAGERY, points);
-  var newparms := {};
-  newparms[1] := caster;
-  newparms[2] := cast_on;
-  return newparms;
-endfunction
-
-function can_cast(who)
-  var hand1 := (GetEquipmentByLayer(who, 1));
-  var hand2 := (GetEquipmentByLayer(who, 2));
-  if(hand1)
-    if(hand1.graphic != 0x0efa)
-      SendSysMessage(who,"You can't cast spells with things in your hands.", 3, 40);
-      return 0;
-    endif
-  endif
-  if(hand2)
-    if(hand2.graphic != 0x0efa)
-      SendSysMessage(who,"You can't cast spells with things in your hands.", 3, 40);
-      return 0;
-    endif
-  endif
-  return 1;
-endfunction
-
-function CanTargetSpell(caster, circle, targopt := (TGTOPT_NEUTRAL | TGTOPT_CHECK_LOS) )
-  circle := circle; // stops ecompile "not used" warning
-  if(!can_cast(caster))
-    return 0;
-  endif
-  var cast_on := Target(caster, targopt);
-  if(!cast_on)
-    return 0;
-  endif
-  if(cast_on.hidden)
-    SendSysMessage(caster,"You can't see that.", 3, 40);
-    return 0;
-  endif
-  if(dist(caster, cast_on) >= 12)
-    SendSysMessage(caster, "That is too far away.", 3, 40);
-    return 0;
-  endif
-  return cast_on;
-endfunction
-
-function CanTargetArea(caster, circle)
-  circle := circle; // stops ecompile "not used" warning
-  if (!can_cast(caster))
-    return 0;
-  endif
-  var cast_loc := TargetCoordinates(caster);
-  if (!cast_loc.x)
-    return 0;
-  endif
-  if (!CheckLosAt(caster, cast_loc.x, cast_loc.y, cast_loc.z))
-    SendSysMessage(caster, "You can't see that.", 3, 40);
-    return 0;
-  endif
-  if(coordist(caster.x, caster.y, cast_loc.x, cast_loc.y) >= 12)
-    SendSysMessage(caster, "That is too far away.", 3, 40);
-    return 0;
-  endif
-  return cast_loc;
-endfunction
-
-function Reflected(cast_on)
-  var mr := CInt(GetObjProperty(cast_on, "mr"));
-  if(mr >= 1)
-    PlaySoundEffect(cast_on, SFX_SPELL_MAGIC_REFLECTION);
-    PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 10,10);
-    SendSysMessage(cast_on, "Your magic reflect spell saved you!");
-    if(mr == 1)
-      EraseObjProperty(cast_on, "mr");
-    elseif(mr == 2)
-      var holder, pid;
-      var eqp := GetObjProperty(cast_on, "EquipTimers");
-      foreach thing in ListEquippedItems(cast_on)
-        foreach entry in eqp
-          if((thing.serial == entry[1]) and (entry[2] == "ref"))
-            holder := GetObjProperty(thing, "pid");
-            break;
-          endif
-        endforeach
-      endforeach
-      pid := getprocess(holder);
-      if(pid)
-        var k := struct;
-        k.+type := EVID_DISCHARGE;
-        pid.sendevent(k);
-      else
-        EraseObjProperty(cast_on, "mr");
-      endif
-    endif
-    return 1;
-  endif
-  return 0;
-endfunction
-
-function Resisted(circle, caster, cast_on, amt)
-	// Purpose: to check for resistance to spells cast upon a character
-	// called by: most spells
-	// returns: amount of damage not resisted?
-
-        var magery := CInt(AP_GetSkill(caster, SKILLID_MAGERY));
-        var evalint := CInt(AP_GetSkill(caster, SKILLID_EVALINT));
-        var resist := CInt(AP_GetSkill(cast_on, SKILLID_MAGICRESISTANCE));
-        
-        // chk1 relates to the resist ability.
-        var chk1 := (resist / 5);
-        // chk2 relates to the difficulty level
-        var chk2 := resist - (((magery - 20) / 5) + (circle * 5));
-        
-        if(chk1 < 1)
-                chk1 := 1;
-        endif
-        if(chk2 < 1)
-                chk2 := 1;
-        endif
-        
-        // What an odd construct.  
-        // If you're hit with an easy spell then you have a difficulty of your resist
-        var diff := 0;
-        if(chk1 > chk2)
-                diff := chk1;
-        else
-                diff := chk2;
-        endif
-        
-        var points := getresistpoints(circle, cast_on, SKILLID_MAGICRESISTANCE);
-        if(cast_on.dead)
-                return 0;
-        endif
-        if(CheckSkill(cast_on, SKILLID_MAGICRESISTANCE, diff, points))
-                SendSysMessage(cast_on, "You feel yourself resisting magical energy!");
-                PlaySoundEffect(cast_on, SFX_SPELL_WEAKEN);
-                PlayObjectCenteredEffect(cast_on, FX_CURSE_EFFECT, 5,5);
-                amt := (amt * 0.5);
-                if(amt < 1)
-                        amt := 1;
-                endif
-        endif
-        var modamt := 1;
-        if(resist > evalint)
-                modamt := (1 + ((evalint - resist) / 200.0));
-        elseif(evalint > resist)
-                modamt := (1 + ((evalint - resist) / 500.0));
-        endif
-        amt := (amt * modamt);
-        return CInt(amt);
-endfunction
-
-
-function CalcSpellDamage(circle, caster, cast_on)
-  var die_string := circle+"d8";
-  var dmg := RandomDiceRoll(die_string);
-  dmg := dmg + CInt(AP_GetSkill(caster, SKILLID_MAGERY)/10);
-  if(dmg > (circle * 8))
-    dmg := circle * 8;
-  endif
-  return dmg;
-endfunction
-
-function CanTargetThing(caster, circle, targopt := TGTOPT_CHECK_LOS)
-  if (!can_cast(caster))
-    return 0;
-  endif
-  var cast_on := Target(caster, targopt);
-  if(!cast_on)
-    return;
-  endif
-  return cast_on;
-endfunction
-
-function spellcast(me, circle, scroll, id)
-  var spellcfg := ReadConfigFile(":spells:spells");
-  var val := SplitWords(spellcfg[id].val);
-  var times := CInt(val[1]);
-  var slp   := CInt(val[2]);
-  var mhp := AP_GetVital(me, "Hits");
-  var umana, diff;
-  var n := 1;
-  if(scroll == 0)
-    case (circle)
-      1:   umana :=   4;     diff :=  10;
-      2:   umana :=   6;     diff :=  20;
-      3:   umana :=   9;     diff :=  30;
-      4:   umana :=  11;     diff :=  50;
-      5:   umana :=  14;     diff :=  60;
-      6:   umana :=  20;     diff :=  70;
-      7:   umana :=  40;     diff :=  85;
-      8:   umana :=  50;     diff :=  95;
-      9:   umana :=  75;     diff := 100;
-     10:   umana := 100;     diff := 100;
-    endcase
-  elseif(scroll == 1)
-    case (circle)
-      1:   umana :=   4;     diff := 10;
-      2:   umana :=   6;     diff := 10;
-      3:   umana :=   9;     diff := 10;
-      4:   umana :=  11;     diff := 20;
-      5:   umana :=  14;     diff := 30;
-      6:   umana :=  20;     diff := 50;
-      7:   umana :=  40;     diff := 60;
-      8:   umana :=  50;     diff := 70;
-      9:   umana :=  75;     diff := 85;
-     10:   umana := 100;     diff := 95;
-    endcase
-  else
-    return 0;
-  endif
-  if((mhp > AP_GetVital(me, "Hits")) && ((RandomInt(99)+1) > (AP_GetSkill(me, SKILLID_WRESTLING)/2)))
-    SendSysMessage(me,"You lost your concentration.", 3, 40);
-    return 0;
-  endif
-  if (umana > AP_GetVital(me, "Mana"))
-    me.frozen :=1;
-    PerformAction(me,ANIM_CAST_DIR);
-    sleepms(1200);
-    me.frozen :=0;
-    SendSysMessage(me,"You do not have enough mana to cast that.", 3, 40);
-    PlaySoundEffect(me,0x005d);
-    PlayObjectCenteredEffect(me, 0x3735,0x0a, 0x1e);
-    return 0;
-  endif
-  if(can_cast(me))
-    me.frozen :=1;
-    for (n:=1; n<=times; n:=n+1)
-      if((mhp > AP_GetVital(me, "Hits")) && ((RandomInt(99)+1) > (AP_GetSkill(me, SKILLID_WRESTLING)/2)))
-        SendSysMessage(me,"You lost your concentration.", 3, 40);
-        PlaySoundEffect(me,0x005d);
-        PlayObjectCenteredEffect(me, 0x3735,0x0a, 0x1e);
-        me.frozen :=0;
-        return 0;
-      endif
-      PerformAction(me,ANIM_CAST_DIR);
-      sleepms(900);
-    endfor
-    if(slp)
-      sleepms(slp * 100);
-    endif
-    me.frozen :=0;
-    if (CheckSkill(me,SKILLID_MAGERY, diff, 0))
-      if((mhp > AP_GetVital(me, "Hits")) && ((RandomInt(99)+1) > (AP_GetSkill(me, SKILLID_WRESTLING)/2)))
-        SendSysMessage(me,"You lost your concentration.", 3, 40);
-        return 0;
-      endif
-      return 1;
-    else
-      SendSysMessage(me,"The spell fizzles.", 3, 40);
-      PlaySoundEffect(me,0x005d);
-      PlayObjectCenteredEffect(me, 0x3735,0x0a, 0x1e);
-      return 0;
-    endif
-  endif
-endfunction
-
-function newusemana(who, circle, cast_on, delivery)
-  if(delivery == "direct")
-    if(!CheckLineOfSight(who, cast_on))
-      SendSysMessage(who, "You can't see that.", 3, 40);
-      return 0;
-    endif
-  elseif(delivery == "indirect")
-    if(!CheckLosAt(who, cast_on.x, cast_on.y, cast_on.z))
-      SendSysMessage(who, "You can't see that.", 3, 40);
-      return 0;
-    endif
-  endif
-  if(cdist(who.x, who.y, cast_on.x, cast_on.y) > 12)
-    var check := 0;
-    foreach thing in EnumerateItemsInContainer(who.backpack)
-      if(thing == cast_on)
-        check := 1;
-        break;
-      endif
-    endforeach
-    if(!check)
-      SendSysMessage(who,"The target is out of range.", 3, 40);
-      return 0;
-    endif
-  endif
-  var umana;
-    case (circle)
-    1: umana :=  4;
-    2: umana :=  6;
-    3: umana :=  9;
-    4: umana := 11;
-    5: umana := 14;
-    6: umana := 20;
-    7: umana := 40;
-    8: umana := 50;
-  endcase
-  var mana := AP_GetVital(who, "Mana");
-  if(mana >= umana)
-    AP_SetVital(who, "Mana", Cint(mana - umana));
-    return 1;
-  else
-    SendSysMessage(who,"You do not have enough mana to cast that.", 3, 40);
-    return 0;
-  endif
-endfunction
-
-function mobspellcast(me, circle, scroll)
-  scroll := scroll; // stops ecompile "not used" warning
-  var diff, points, umana;
-  case(circle)
-    1:   diff := 10;     points :=  20;    umana :=   4;
-    2:   diff := 20;     points :=  40;    umana :=   6;
-    3:   diff := 30;     points :=  80;    umana :=   9;
-    4:   diff := 50;     points := 100;    umana :=  11;
-    5:   diff := 60;     points := 130;    umana :=  14;
-    6:   diff := 70;     points := 160;    umana :=  20;
-    7:   diff := 85;     points := 190;    umana :=  40;
-    8:   diff := 95;     points := 210;    umana :=  50;
-  endcase
-  if(umana > AP_GetVital(me, "Mana"))
-    return 0;
-  endif
-  if(can_cast(me))
-    if(CheckSkill(me, SKILLID_MAGERY, (diff - 10), points))
-      return 1;
-    else
-      return 0;
-    endif
-  endif
-endfunction
-
-function getpoints(c, scroll, skillid)
-  var points;
-  var diff;
-  if(scroll == 1)
-    case(c)
-      1:   points :=  10; diff :=  0;
-      2:   points :=  20; diff := 10;
-      3:   points :=  20; diff := 10;
-      4:   points :=  40; diff := 20;
-      5:   points :=  60; diff := 30;
-      6:   points := 100; diff := 50;
-      7:   points := 120; diff := 60;
-      8:   points := 140; diff := 70;
-    endcase
-  else
-    case(c)
-      1:   points :=  20; diff := 20;
-      2:   points :=  40; diff := 30;
-      3:   points :=  80; diff := 40;
-      4:   points := 100; diff := 50;
-      5:   points := 120; diff := 60;
-      6:   points := 140; diff := 70;
-      7:   points := 160; diff := 86;
-      8:   points := 180; diff := 100;
-    endcase
-  endif
-  var skill := AP_GetSkill(caster, skillid);
-  if(skill > (diff - 20))
-    if((skill - diff) <= 5)
-      points := points;
-    elseif((skill - diff) <= 10)
-      points := (points * 3) / 4;
-    elseif((skill - diff) <= 15)
-      points := points / 2;
-    elseif((skill - diff) <= 15)
-      points := points / 4;
-    else
-      points := 0;
-    endif
-  endif
-  return points;
-endfunction
-
-function getresistpoints(c, victim, skillid)
-  var points;
-  var diff;
-  case(c)
-    1:   points :=  20; diff := 20;
-    2:   points :=  40; diff := 30;
-    3:   points :=  80; diff := 40;
-    4:   points := 100; diff := 50;
-    5:   points := 120; diff := 60;
-    6:   points := 140; diff := 70;
-    7:   points := 160; diff := 86;
-    8:   points := 180; diff := 100;
-  endcase
-  var skill := AP_GetSkill(victim, skillid);
-  if(skill > (diff - 20))
-    if((skill - diff) <= 5)
-      points := points;
-    elseif((skill - diff) <= 10)
-      points := (points * 3) / 4;
-    elseif((skill - diff) <= 15)
-      points := points / 2;
-    elseif((skill - diff) <= 15)
-      points := points / 4;
-    else
-      points := 0;
-    endif
-  endif
-  return points;
-endfunction
-
-function cdist(x1, y1, x2, y2)
-  var xd := x1 - x2;
-  var yd := y1 - y2;
-  if (xd < 0)
-    xd := -xd;
-  endif
-  if (yd < 0)
-    yd := -yd;
-  endif
-  if (xd > yd)
-    return xd;
-  else
-    return yd;
-  endif
-endfunction
-
-function usemana(who, circle, cast_on)
-  if(cast_on.mobile)
-    if(!CheckLineOfSight(who, cast_on))
-      SendSysMessage(who, "You can't see that.", 3, 40);
-      return 0;
-    endif
-  else
-    if(!CheckLosAt(who, cast_on.x, cast_on.y, cast_on.z))
-      SendSysMessage(who, "You can't see that.", 3, 40);
-      return 0;
-    endif
-  endif
-  if(cdist(who.x, who.y, cast_on.x, cast_on.y) > 12)
-    SendSysMessage(who,"The target is out of range.", 3, 40);
-    return 0;
-  endif
-  var umana;
-  case (circle)
-    1: umana :=   4;
-    2: umana :=   6;
-    3: umana :=   9;
-    4: umana :=  11;
-    5: umana :=  14;
-    6: umana :=  20;
-    7: umana :=  40;
-    8: umana :=  50;
-    9: umana :=  75;
-   10: umana := 100;
-  endcase
-  var mana := AP_GetVital(who, "Mana");
-  if(mana >= umana)
-    var ms := AP_SetVital(who, "Mana", Cint(mana - umana));
-    return 1;
-  else
-    SendSysMessage(who,"You do not have enough mana to cast that.", 3, 40);
-    return 0;
-  endif
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/startEqp.inc
===================================================================
--- trunk/096/scripts/include/startEqp.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/startEqp.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,595 +0,0 @@
-use uo;
-use cfgfile;
-use os;
-use util;
-
-include ":attributes:attributes";
-
-var unique_items_created := {};
-var starteqp_cfg;
-var template;
-var magicspawnchance := 0;
-var magicadjustment  := 0;
-var making_starting_equipment := 0;
-
-var thecritter;
-
-function MakeLoot(corpse, lootgroup)
-  var npcdesc := ReadConfigFile("::npcdesc");
-  var elem := FindConfigElem(npcdesc, corpse.npctemplate);
-  var mprop, madj;
-  if(elem)
-    mprop := CInt(GetConfigInt(elem, "Magicitemchance"));
-    madj  := CInt(GetConfigInt(elem, "MagicAdjustment"));
-  else
-    mprop := 1;
-    if(corpse.objtype == 0x9e40)
-      case(CInt(GetObjProperty(corpse,"level")))
-        1: madj := 0;
-        2: madj := 2;
-        3: madj := 4;
-        4: madj := 6;
-        5: madj := 8;
-      endcase
-    else
-      magicadjustment := 0;
-    endif
-  endif
-  if(AP_GetVital(corpse, "Hits"))
-    foreach thing in ListEquippedItems(corpse)
-      if(thing.objtype == 0xe75)
-        corpse := thing;
-        break;
-      endif
-    endforeach
-  endif
-  thecritter := corpse;
-  if(mprop)
-    magicspawnchance := 1;
-  else
-    if((corpse.objtype == 0x9e40) || (corpse.objtype == 0xe40))
-      magicspawnchance := 1;
-    else
-      magicspawnchance := 0;
-    endif
-  endif
-  magicadjustment  := madj;
-  starteqp_cfg := ReadConfigFile("::nlootgroup");
-  if(lootgroup)
-    CreateFromGroup(corpse, lootgroup);
-  else
-    var lootgroups := GetConfigStringArray(elem, "lootgroup");
-    foreach str in lootgroups
-      CreateFromGroup(corpse, CInt(str));
-    endforeach
-  endif
-endfunction
-
-function CreateStartingEquipment(who, skillids)
-  making_starting_equipment := 1;
-  starteqp_cfg := ReadConfigFile("::starteqp");
-  foreach skillid in skillids
-    var skillname := GetSkillName(CInt(skillid));
-    CreateFromGroup(who.backpack, skillname);
-  endforeach
-  CreateFromGroup(who.backpack, "all");
-endfunction
-
-function CreateFromGroup(who, group)
-  if(making_starting_equipment != 1)
-	starteqp_cfg := ReadConfigFile("::nlootgroup");
-  endif
-  var elem := starteqp_cfg[group];
-  foreach str in GetConfigStringArray(elem, "Stack")
-    CreateFromStackString(who, str);
-  endforeach
-  foreach str in GetConfigStringArray(elem, "Item")
-    CreateFromItemString(who, str);
-  endforeach
-  foreach str in GetConfigStringArray(elem, "Random")
-    CreateFromRandomString(who, str);
-  endforeach
-  foreach str in GetConfigStringArray(elem, "Group")
-    CreateFromGroup(who, str);
-  endforeach
-  foreach str in GetConfigStringArray(elem, "Unique")
-    CreateFromUniqueString(who, str);
-  endforeach
-endfunction
-
-function GetSkillName(skillid)
-  var cfg := ReadConfigFile("::skills");
-  return cfg[skillid].name;
-endfunction
-
-function CreateFromItemString(who, str)
-  var params := SplitWords(str);
-  var count, objname, color, chance;
-  var colors := ReadConfigFile("::colors");
-  count := RandomDiceRoll(CStr(params[1]));
-  params[1] := params[2];
-  params[2] := params[3];
-  params[3] := params[4];
-  if (!count)
-    count := 1;
-  endif
-  objname := params[1];
-  if(CInt(params[2]))
-    color := CInt(params[2]);
-  elseif (params[2])
-    color := 0;
-    var colorg := FindConfigElem(colors, params[2]);
-    if(colorg)
-      var str := GetConfigStringArray(colorg, "color");
-	  var ar := {};
-	  var rndint := RandomInt(len(str)) + 1;
-	  ar := SplitWords(str[rndint]);
-	  if(len(ar) > 1)
-	    if(CInt(ar[2]) > 0)
-	      color := RandomInt(CInt(ar[2]) - CInt(ar[1]))+1;
-	    else
-	      color := CInt(str[RandomInt(len(str))+1]);
-	    endif
-	  else
-            color := CInt(str[RandomInt(len(str))+1]);
-	  endif
-	  if(color == 1)
-	    color := 0;
-	  endif
-    endif
-  endif
-  if (!color)
-    color := 0;
-  endif
-  if(CInt(params[3]))
-    chance := CInt(params[3]);
-  else
-    chance := 100;
-  endif
-  if(CInt(RandomInt(100)+1) <= CInt(chance))
-    var i, canbemagic;
-    for(i:=1; i<=CInt(count); i:=i+1)
-      if (CInt(objname))
-        objname := CInt(objname);
-      endif
-      var item := CreateItemInContainer(who, objname);
-      item.color := color;
-      if(making_starting_equipment)
-        item.newbie := 1;
-        continue;
-      endif
-      if( (item.graphic in array( 0xdf2, 0xdf3, 0xdf4, 0xdf5, 0x13f9 )) && (magicspawnchance == 1))
-        ProcessWand(item);
-      else
-        if(magicspawnchance == 1)
-          canbemagic := MagicAllowedandType(objname);
-          case(canbemagic)
-            1: WeaponTable(item);
-            2: ArmorTable(item);
-            3: ClothTable(item);
-          endcase
-        endif
-      endif
-    endfor
-  endif
-endfunction
-
-function ProcessWand(item)
-  var amt;
-  case(RandomInt(10) + 1)
-    1: amt :=  15;   SetObjProperty(item, "SpellId",  1);   SetObjProperty(item, "damagemod", "of clumsiness");
-    2: amt :=  15;   SetObjProperty(item, "SpellId",  3);   SetObjProperty(item, "damagemod", "of feeblemindedness");
-    3: amt :=  15;   SetObjProperty(item, "SpellId",  4);   SetObjProperty(item, "damagemod", "of healing");
-    4: amt :=  15;   SetObjProperty(item, "SpellId",  8);   SetObjProperty(item, "damagemod", "of weakness");
-    5: amt :=  10;   SetObjProperty(item, "SpellId", 12);   SetObjProperty(item, "damagemod", "of harming");
-    6: amt :=   5;   SetObjProperty(item, "SpellId", 18);   SetObjProperty(item, "damagemod", "of fireballs");
-    7: amt :=   5;   SetObjProperty(item, "SpellId", 29);   SetObjProperty(item, "damagemod", "of greater healing");
-    8: amt :=   3;   SetObjProperty(item, "SpellId", 30);   SetObjProperty(item, "damagemod", "of lightning");
-    9: amt :=  10;   SetObjProperty(item, "SpellId", 31);   SetObjProperty(item, "damagemod", "of mana draining");
-   10: amt := 100;   SetObjProperty(item, "SpellId", 65);   SetObjProperty(item, "damagemod", "of identification");
-  endcase
-  SetObjProperty(item, "charges", (amt + RandomInt(10)));
-  item.usescript := ":wands:magicWands";
-  var dsc;
-  if(item.objtype == 0x13f9)
-    dsc := "gnarled staff";
-  else
-    dsc := "wand";
-  endif
-  SetName(item, "a magic " + dsc);
-endfunction
-
-function ClothTable(item)
-  var val := RandomInt(19) + 1;
-  if(val >= 14)
-    var charges := RandomDiceRoll("1d30") + 10;
-    SetObjProperty(item, "charges", charges);
-    SetObjProperty(item, "type", "sight");
-    SetObjProperty(item, "damagemod", " of nightsight");
-  elseif(val >= 11)
-    var charges := RandomDiceRoll("1d30") + 10;
-    SetObjProperty(item, "charges", charges);
-    SetObjProperty(item, "type", "protection");
-    SetObjProperty(item, "damagemod", " of protection");
-  elseif(val <= 8)
-    var charges := RandomDiceRoll("1d30") + 10;
-    SetObjProperty(item, "charges", charges);
-    SetObjProperty(item, "type", "strength");
-    SetObjProperty(item, "damagemod", " of strength");
-  elseif(val > 5)
-    var charges := RandomDiceRoll("1d30") + 10;
-    SetObjProperty(item, "charges", charges);
-    SetObjProperty(item, "type", "invisibility");
-    SetObjProperty(item, "damagemod", " of invisibility");
-  elseif(val == 3)
-    var charges := RandomDiceRoll("1d30") + 10;
-    SetObjProperty(item, "charges", charges);
-    SetObjProperty(item, "type", "blessing");
-    SetObjProperty(item, "damagemod", " of blessing");
-  else
-    var charges := RandomDiceRoll("1d30") + 10;
-    SetObjProperty(item, "charges", charges);
-    SetObjProperty(item, "type", "reflect");
-    SetObjProperty(item, "damagemod", " of magic reflection");
-  endif
-  AddName(item);
-endfunction
-
-function ArmorTable(item)
-  var newarray := {1, 2};
-  var count := RandomInt(99) + 1;
-  var counter;
-  if(count >= 40)
-    counter := 1;
-  else
-    counter := 2;
-  endif
-  count := 0;
-  var num;
-  while(count <= counter)
-    num := RandomInt(99) + 1;
-    if(num >=  50)
-      num := 1;
-    else
-      num := 2;
-    endif
-    case(num)
-      1: ApplyHPMod(item);
-      2: ApplyARMod(item);
-    endcase
-    newarray.erase(num);
-    count := count + 1;
-  endwhile
-  if((RandomInt(10)+1) <= 1)
-    ExtraArmorTable(item);
-  endif
-  AddName(item);
-endfunction
-
-function ExtraArmorTable(item)
-  var val := RandomInt(4) + 1;
-  case(val)
-    1: var charges := RandomDiceRoll("1d30") + 10;
-       SetObjProperty(item, "charges", charges);
-       SetObjProperty(item, "type", "protection");
-       var dmgmod := GetObjProperty(item, "damagemod");
-       if(dmgmod)
-         dmgmod := dmgmod + " and protection";
-         SetObjProperty(item, "damagemod", dmgmod);
-       else
-         dmgmod := " of protection";
-         SetObjProperty(item, "damagemod", dmgmod);
-       endif
-    2: var charges := RandomDiceRoll("1d30") + 10;
-       SetObjProperty(item, "charges", charges);
-       SetObjProperty(item, "type", "strength");
-       var dmgmod := GetObjProperty(item, "damagemod");
-       if(dmgmod)
-         dmgmod := dmgmod + " and strength";
-         SetObjProperty(item, "damagemod", dmgmod);
-       else
-         dmgmod := " of strength";
-         SetObjProperty(item, "damagemod", dmgmod);
-       endif
-    3:  var charges := RandomDiceRoll("1d30") + 10;
-       SetObjProperty(item, "charges", charges);
-       SetObjProperty(item, "type", "blessing");
-       var dmgmod := GetObjProperty(item, "damagemod");
-       if(dmgmod)
-         dmgmod := dmgmod + " and blessing";
-         SetObjProperty(item, "damagemod", dmgmod);
-       else
-         dmgmod := " of blessing";
-         SetObjProperty(item, "damagemod", dmgmod);
-       endif
-    4: var charges := RandomDiceRoll("1d30") + 10;
-       SetObjProperty(item, "charges", charges);
-       SetObjProperty(item, "type", "reflect");
-       var dmgmod := GetObjProperty(item, "damagemod");
-       if(dmgmod)
-         dmgmod := dmgmod + " and magic reflection";
-         SetObjProperty(item, "damagemod", dmgmod);
-       else
-         dmgmod := " of magic reflection";
-         SetObjProperty(item, "damagemod", dmgmod);
-       endif
-  endcase
-endfunction
-
-function WeaponTable(item)
-  var newarray := array(1, 2, 3);
-  var count := RandomInt(100) + 1;
-  var counter;
-  if(count >= 60)
-    counter := 1;
-  elseif(count >= 40)
-    counter := 2;
-  elseif(count >= 10)
-    counter := 3;
-  else
-    counter := 4;
-  endif
-  if(counter == 1)
-    DestroyItem(item);
-    return;
-  endif
-  count := 0;
-  var num, val;
-  while(count <= counter)
-    num := RandomInt(len(newarray)) + 1;
-    val := newarray[num];
-    case(val)
-      1: ApplyAccyMod(item);
-      2: ApplyHPMod(item);
-      3: ApplyDmgMod(item);
-    endcase
-    newarray.erase(num);
-    count := count + 1;
-  endwhile
-  AddName(item);
-endfunction
-
-function CreateFromRandomString(who, desc)
-  var params := SplitWords(desc);
-  var amt := Cint(params[1]);
-  var count := 1;
-  if(amt != 1)
-    count := RandomDiceRoll(Cstr(amt + 1));
-  endif
-  var group := params[2];
-  var chance := params[4];
-  var elem := FindConfigElem(starteqp_cfg, group);
-  if(elem == error)
-    syslog("Unable to find group " + group);
-    return;
-  endif
-  var items := GetConfigStringArray(elem, "Item");
-  if(items == error)
-    syslog("Group " + group + " does not contain items!");
-    return;
-  endif
-  if(!chance)
-    chance := 100;
-  endif
-  var rand := RandomInt(99)+1;
-  if(CInt(rand) <= CInt(chance))
-    if(count > len(items))
-      count := len(items);
-    endif
-    while(count)
-      var n := RandomInt(len(items)) + 1;
-      if(items[n])
-        CreateFromItemString(who, items[n]);
-        if(making_starting_equipment)
-          items[n] := "";
-        endif
-        count := count - 1;
-      endif
-    endwhile
-  endif
-endfunction
-
-function CreateFromUniqueString(who, str)
-  var params := SplitWords(str);
-  var objtype;
-  if (CInt(params[1]))
-    objtype := params[1];
-  else
-    objtype := GetObjtypeByName(params[1]);
-  endif
-  if(!objtype)
-    syslog("Don't know what a " + str + " is");
-    return;
-  endif
-  if(objtype in unique_items_created)
-    return;
-  endif
-  unique_items_created[len(unique_items_created) + 1] := objtype;
-  var newstr := "1 " + str;
-  CreateFromItemString(who, newstr);
-endfunction
-
-function CreateFromStackString(who, str)
-  var params := SplitWords(str);
-  var count;
-  var objname;
-  var color;
-  var chance;
-  count := RandomDiceRoll(CStr(params[1]));
-  params[1] := params[2];
-  params[2] := params[3];
-  params[3] := params[4];
-  if (!count)
-    count := 1;
-  endif
-  objname := params[1];
-  if(CInt(params[2]))
-    color := CInt(params[2]);
-  else
-    color := 0;
-  endif
-  if (CInt(params[3]))
-    chance := CInt(params[3]);
-  else
-    chance := 100;
-  endif
-  var rand := RandomInt(100)+1;
-  if(CInt(rand) <= CInt(chance))
-    if (CInt(objname))
-      objname := CInt(objname);
-    endif
-    var item := CreateItemInContainer(who, objname, count);
-    if(!item)
-      syslog("Unable to create " + objname + " on " + who.name + ".");
-    endif
-    item.color := color;
-    if(making_starting_equipment)
-      item.newbie := 1;
-    endif
-  endif
-endfunction
-
-function MagicAllowedandType(objname)
-  var magicweapcfg := ReadConfigFile(":combat:magicweaps");
-  var magicarmorcfg := ReadConfigFile(":combat:magicarmor");
-  var magicclothcfg := ReadConfigFile(":combat:magiccloth");
-  var elem1 := FindConfigElem(magicweapcfg, "1");
-  var data1 := GetConfigInt(elem1, objname);
-  if(data1)
-    return 1;
-  endif
-  var elem2 := FindConfigElem(magicarmorcfg, "1");
-  var data2 := GetConfigInt(elem2, objname);
-  if(data2)
-    return 2;
-  endif
-  var elem3 := FindConfigElem(magicclothcfg, "1");
-  var data3 := GetConfigInt(elem3, objname);
-  if(data3)
-    return 3;
-  endif
-  return 0;
-endfunction
-
-function ApplyDmgMod(item)
-  var numb := ((RandomInt(100)+1) - magicadjustment);
-  if(numb < 1)
-    numb := 1;
-  endif
-  if(numb >= 50)
-    item.dmg_mod := 1;
-    SetObjProperty(item, "damagemod", "of ruin");
-  elseif(numb >= 25)
-    item.dmg_mod := 3;
-    SetObjProperty(item, "damagemod", "of might");
-  elseif(numb >= 15)
-    item.dmg_mod := 5;
-    SetObjProperty(item, "damagemod", "of force");
-  elseif(numb >= 5)
-    item.dmg_mod := 7;
-    SetObjProperty(item, "damagemod", "of power");
-  elseif(numb >= 1)
-    item.dmg_mod := 9;
-    SetObjProperty(item, "damagemod", "of vanquishing");
-  endif
-  SilverMod(item);
-endfunction
-
-function ApplyAccyMod(item)
-  var numb := ((RandomInt(100)+1) - magicadjustment);
-  if(numb < 1)
-    numb := 1;
-  endif
-  var modifier := 0;
-  if(numb >= 50)
-    modifier := 5;
-    SetObjProperty(item, "accuracy", "accurate");
-  elseif(numb >= 25)
-    modifier := 10;
-    SetObjProperty(item, "accuracy", "surpassingly accurate");
-  elseif(numb >= 15)
-    modifier := 15;
-    SetObjProperty(item, "accuracy", "eminently accurate");
-  elseif(numb >= 5)
-    modifier := 20;
-    SetObjProperty(item, "accuracy", "exceedingly accurate");
-  elseif(numb >= 1)
-    modifier := 25;
-    SetObjProperty(item, "accuracy", "supremely accurate");
-  endif
-  SetObjProperty(item, "type", "accuracy");
-  SetObjProperty(item, "gain", modifier);
-endfunction
-
-function ApplyHPMod(item)
-  var numb := ((RandomInt(100)+1) - magicadjustment);
-  if(numb < 1)
-    numb := 1;
-  endif
-  if(numb >= 50)
-    item.maxhp_mod := item.maxhp_mod + 05;
-    SetObjProperty(item, "durability", "durable");
-  elseif(numb >= 25)
-    item.maxhp_mod := item.maxhp_mod + 10;
-    SetObjProperty(item, "durability", "substantial");
-  elseif(numb >= 15)
-    item.maxhp_mod := item.maxhp_mod + 15;
-    SetObjProperty(item, "durability", "massive");
-  elseif(numb >= 5)
-    item.maxhp_mod := item.maxhp_mod + 20;
-    SetObjProperty(item, "durability", "fortified");
-  elseif(numb >= 1)
-    item.maxhp_mod := item.maxhp_mod + 25;
-    SetObjProperty(item, "durability", "indestructable");
-  endif
-  item.hp := item.maxhp;
-endfunction
-
-function ApplyARMod(item)
-  var numb := ((RandomInt(100)+1) - magicadjustment);
-  if(numb < 1)
-    numb := 1;
-  endif
-  if(numb >= 50)
-    item.ar_mod := 5;
-    SetObjProperty(item, "damagemod", "of defense");
-  elseif(numb >= 25)
-    item.ar_mod := 10;
-    SetObjProperty(item, "damagemod", "of guarding");
-  elseif(numb >= 15)
-    item.ar_mod := 15;
-    SetObjProperty(item, "damagemod", "of hardening");
-  elseif(numb >= 5)
-    item.ar_mod := 20;
-    SetObjProperty(item, "damagemod", "of fortification");
-  elseif(numb >= 1)
-    item.ar_mod := 25;
-    SetObjProperty(item, "damagemod", "of invulnerability");
-  endif
-endfunction
-
-function SilverMod(item)
-  var numb := (RandomInt(10) + 1);
-  if(numb == 1)
-    var hits := GetObjProperty(item, "OnHit");
-    if(!hits)
-      hits := {};
-    endif
-    hits.append("silverHit");
-    SetObjProperty(item, "OnHit", hits);
-    SetObjProperty(item, "silvermod", 1);
-  endif
-endfunction
-
-function AddName(item)
-  var currdesc := item.desc;
-  if(currdesc[1] == "a")
-    var space := find(item.desc, " ", 1);
-    var newname := currdesc[space+1,len(item.desc)];
-    SetName(item,"a magic " + newname);
-  else
-    SetName(item, "magic " + currdesc);
-  endif
-endfunction
-
-

Deleted: trunk/096/scripts/include/statMod.inc
===================================================================
--- trunk/096/scripts/include/statMod.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/statMod.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,52 +0,0 @@
-use uo;
-use util;
-
-include ":attributes:attributes";
-
-function GetModAmount(magery)
-  var mod_amount := CInt(RandomInt(3) +(magery/10));
-  if(mod_amount > 10)
-    mod_amount := 10;
-  endif
-  return mod_amount;
-endfunction
-
-function GetModDuration(magery)
-  var duration := CInt(60 +((magery / 30) * 60));
-  return(duration);
-endfunction
-
-function CanMod(who, stat)
-  var mod;
-  case(stat)
-    "str": mod := "#ss";
-    "dex": mod := "#dd";
-    "int": mod := "#ii";
-    "p"  : mod := "#pp";
-    "ar" : mod := "#ar";
-  endcase
-  if(GetObjProperty(who, mod))
-    return 0;
-  else
-    return 1;
-  endif
-endfunction
-
-function DoTempMod(who, stat, amt, duration)
-  var mod;
-  case(stat)
-    "str":  mod := "#ss";  AP_SetStatMod(who, "Strength", AP_GetStatMod(who, "Strength") + amt);
-    "dex":  mod := "#dd";  AP_SetStatMod(who, "Dexterity", AP_GetStatMod(who, "Dexterity") + amt);
-    "int":  mod := "#ii";  AP_SetStatMod(who, "Intelligence", AP_GetStatMod(who, "Intelligence") + amt);
-    "ar" :  mod := "#ar";  who.ar_mod           := who.ar_mod + amt;
-	"p"  :  mod := "#pp";  who.setParalyzed(1);
-  endcase
-  SetObjProperty(who,mod,1);
-  var parms := {};
-  parms[2] := who;
-  parms[1] := stat;
-  parms[3] := amt;
-  parms[4] := duration;
-  parms[5] := who.serial;
-  start_script("::/misc/unmod", parms);
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/std.inc
===================================================================
--- trunk/096/scripts/include/std.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/std.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,517 +0,0 @@
-/***************************************************************************
-
-	STANDARD POL INCLUDE FILE v0.4
-
-	Last Update: 2001-03-02
-
-	This file is a collection of the most used (and useful) functions
-	available in the POL community. It's intended to be a replacement
-	for those include files that everyone has but were never released
-	to the public, providing a wide set of single functions.
-
-	This file is supposed to be kept by the community but administrated
-	by the one member. If you have a function to add to this file, or
-	have a code	tweak or optimization, don't hesitate to send an email to:
-	HellRaider <zion at uo.com.br>
-
-Functions (Alphabetical) List:
-		CreateStackArrayInContainer (container, objtype, amount, limit_per_stack := 60000)
-			- Creates a dynamic number os stacks into the given container,
-			based on the given amount, respecting a limit amount for each
-			stack.
-			Returns: array of ObjRefs to each created stack.
-			Examples:
-				CreateStackArrayInContainer(container, UOBJ_GOLDCOIN, 90000)
-					- Creates 2 piles of gold into the container, the first
-					with 60k coins, and the second with 30k coins.
-				CreateStackArrayInContainer(container, UOBJ_GOLDCOIN, 90000, 10000)
-					- Creates 9 piles of 10k gold into the container.
-
-		GetFormattedTime()
-			Returns: string containing the current in-game time in
-			military/internation format "HH:MM".
-
-		GetGoldInContainer(container)
-			- Loops through the given container looking for gold stacks.
-			Returns: an array where the first element is the sum of gold
-				within the container, and the following elements are ObjRefs
-				to the gold piles found.
-			Example: if used at a container with 2 piles of 10k gold, the
-				function would return {20000, 1st_pile, 2nd_pile}.
-
-		GetSpelledTime()
-			Returns: string containing the spelled in-game time, just like
-			in OSI Shards.
-			Examples:
-				"half past two in the morning."
-				"eight o'clock at night."
-				"midnight."
-
-		GetStacksOfTypeInContainer (container, objtype)
-			- Loops through the given container looking for item stacks from the
-			given objtype.
-			Returns: an array where the first element is the sum of items from the
-				given objtype within the container, and the following elements are
-				ObjRefs to the item stacks found.
-			Example: if used at a container with 2 stacks of 50 cloth, the function
-				would return {100, 1st_stack_of_cloth, 2nd_stack_of_cloth}.
-
-
-		GetStorageArea (areaname)
-			- Finds an storage area by name. If no matching storage area is found,
-			this function creates a new storage area with the given name.
-			Returns: reference to the storage area found or created.
-
-		GetStorageRoot (storage, rootname, objtype := 0x0E7C)
-			- Finds a container with the given name in the storage area.
-			If no matching root container is found, this function creates one
-			using the given objtype (default is a metalbox, like a bank box).
-			Returns: reference to the root container found or created.
-
-		GetStrAfter (needle, byref haystack)
-			- This function finds the first occurrence of needle within haystack
-			then returns the remaining characters in the string.
-			Returns: all characters found after needle in haystack.
-				GetStrAfter("this ", "this rocks") returns "rocks";
-				GetStrAfter("sky ", "the sky is blue") returns "is blue";
-
-		GetStrBefore (needle, byref haystack)
-			- This function finds the first occurrence of needle within haystack
-			then returns the preceding characters in the string.
-			Returns: all characters preceding needle in haystack.
-				GetStrBefore(" ", "pol rocks") returns "pol";
-				GetStrBefore(" is ", "the sky is blue") returns "the sky";
-
-		GetTimeOfDay()
-			Returns: elapsed seconds in the current UO day.
-
-		ListObjectsOfClassNearLocation(x, y, z, range, POLCLASS, flags := LISTEX_FLAG_NORMAL, realm := "britannia")
-			- Returns an array of itemrefs of the specified POLCLASS;
-			- flags can be a set of LISTEX_* constants, and are only used
-			with POLCLASS_UOBJECT, POLCLASS_MOBILE and POLCLASS_NPC.
-			Returns: array of ObjRefs found.
-
-		MoveItemToForcedLocation(item, x, y, z)
-			- Moves item ignoring it's movable state.
-			Returns: nonzero if successful, error otherwise.
-
-		MoveItem(item, byref place, flags := MOVEITEM_NORMAL)
-			- Moves item either to a container or to a place depending of
-			the parameter passed. Item will be moved to a container if the
-			parameter is a ContainerRef, or a location if it's an array.
-			- flags can be a set of MOVEITEM_* constants.
-			- If an array of 2 integers is passed as the 'place' paramemter
-			this function finds an appropriated 3rd parameter to be the Z
-			coordinate of the location; since this parameter is passed byref
-			the original array will have the 3rd parameter set once the function
-			returns.
-			Possible usages:
-				MoveItem(item, TargetCoordinates(player));
-				MoveItem(item, {1234, 5678});
-				MoveItem(item, {1234, 5678, 9});
-				MoveItem(item, player.backpack);
-			Returns: nonzero if successfull, error if the item couldn't be
-				moved or if an invalid parameter was passed.
-
-		RandomListInt (tableref)
-			- Returns a random integer based on a special config file "table".
-			The passed parameter must be a reference to a config file "table".
-			The table is meant to be structured like this:
-
-				List [table name]
-				{
-					Count 4
-					Elem0		1	5
-					Elem1		6	10
-					Elem2		11	15
-					Elem3		16
-				}
-
-			Count counts the number of "Elements" within the table. The elements
-			are inserted starting by zero. Each element may hold either, a number
-			or a range. In the previous example, the first 3 elements are ranges,
-			and the fourth element is an unique number. This function will first
-			choose a random element, and then check if it's a range or an unique
-			number, if it's an unique number the function will return the number,
-			otherwise the function will return a random number within the specified
-			range. Note that number 16 has a 25% chance to be picked up, while
-			each number (inclusive) from 1 to 15 has a 5% chance (75%/15).
-			Possible usages:
-				RandomListInt(ReadConfigFile("::colors")[ALL_COLORS]);
-				RandomListInt(config[24]);
-			Returns: random integer.
-
-		Season (player, season_id)
-			- Use this function to set one's client-side season.
-			- Possible values for seasons:
-				SEASON_SUMMER	: Looks like "old Britannia".
-				SEASON_FALL		: What it suggests.
-				SEASON_WINTER	: Ugly like a dog sucking mango.
-				SEASON_FELUCCA	: Chaotic look!
-				SEASON_SPRING	: Trammel, home of the care bears.
-			- Note that this function doesn't check the validity of the passed
-			season id, just because I don't want to sacrifice performance,
-			please use the constant values above to avoid problems.
-
-		SubtractFromStackArray (byref arrayofobjrefs, amount)
-			- Loops through the array of objects until the given amount of
-			items is subtracted, or the last item is destroyed. IE if 2 piles
-			of 10k gold are passed as the first argument, and 15000 is passed
-			as the second argument, the first pile will be destroyed and the
-			second pile will have 5000 gold subtracted from it.
-			- In case the array contains non-POL-items objects, those objects
-			are ignored.
-			Returns: amount of items successfully subtracted.
-
-		ToSextant(x, y)
-			Returns: a formated string containing the sextant coordinates
-				for the location; ie, 29o 52'N, 138o 57'W
-
-
-	A history of changes can be found at the end of this file.
-	The contants below can be adjusted to fit your Shard's design.
-
-***************************************************************************/
-
-const STD_DAY_LENGTH := 7200;	// A whole UO day in seconds (7200 is equivalent to 2 hours)
-const STD_GOLD := 0x0EED;		// ObjType for gold coins.
-
-// HellRaider <zion at uo.com.br> 2000-12-19
-// Required Modules: UO
-function CreateStackArrayInContainer (container, objtype, amount, limit_per_stack := 60000)
-	var result array;
-	for loops := 1 to (amount/limit_per_stack)
-		result.append(CreateItemInContainer(container, objtype, limit_per_stack));
-	endfor
-	result.append(CreateItemInContainer(container, objtype, amount-(amount/limit_per_stack)*limit_per_stack));
-	return result;
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-13
-// Required Modules: UO BASIC
-function GetFormattedTime()
-    var time := GetTimeOfDay();
-    var raw_time := 24.0/(CDbl(STD_DAY_LENGTH)/time);
-    var hours := CInt(raw_time);
-    var minutes := CInt((raw_time-hours)*60);
-    if (minutes < 10)
-		minutes := "0"+minutes;
-    endif
-    if (hours < 10)
-		hours := "0"+hours;
-    endif
-    return (hours+":"+minutes);
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-18
-// Required Modules: UO
-function GetGoldInContainer (container)
-	var result := {0};
-	foreach item in EnumerateItemsInContainer(container)
-		if (item.objtype = STD_GOLD)
-			result.append(item);
-			result[1] := result[1]+item.amount;
-		endif
-	endforeach
-	return result;
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-13
-// Required Modules: UO BASIC
-// Dependencies: SpellHour(hours)
-function GetSpelledTime()
-	var time := GetTimeOfDay();
-    var raw_time := 24.0/(CDbl(STD_DAY_LENGTH)/time);
-    var hours := CInt(raw_time);
-    var minutes := CInt((raw_time-hours)*60);
-	var ext;
-	if (hours<11)
-		ext := " in the morning.";
-	elseif (hours>11 and hours<19)
-		ext := " in the afternoon.";
-	else
-		ext := " at night.";
-	endif
-	if (hours>12)
-		hours := hours-12;
-	endif
-	if (minutes<15)
-		if (!hours or hours=12)
-			return SpellHour(hours);
-		else
-			return SpellHour(hours)+" o'clock"+ext;
-		endif
-	elseif (minutes > 14 and minutes < 30)
-		if (!hours or hours=12)
-			return "quarter past "+SpellHour(hours);
-		else
-			return "quarter past "+SpellHour(hours)+ext;
-		endif
-	elseif (minutes > 29 and minutes < 45)
-		if (!hours or hours=12)
-			return "half past "+SpellHour(hours);
-		else
-			return "half past "+SpellHour(hours)+ext;
-		endif
-	else
-		if (!hours or hours=12)
-			return "quarter to "+SpellHour(hours+1);
-		else
-			return "quarter to "+SpellHour(hours+1)+ext;
-		endif
-	endif
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-13
-function SpellHour (hours)
-	case (hours)
-		0:	return "midnight.";
-		1:	return "one";
-		2:	return "two";
-		3:	return "three";
-		4:	return "four";
-		5:	return "five";
-		6:	return "six";
-		7:	return "seven";
-		8:	return "eight";
-		9:	return "nine";
-		10:	return "ten";
-		11:	return "eleven";
-		12:	return "midday.";
-	endcase
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-18
-// Required Modules: UO
-function GetStacksOfTypeInContainer (container, objtype)
-	var result := {0};
-	foreach item in EnumerateItemsInContainer(container)
-		if (item.objtype = objtype)
-			result.append(item);
-			result[1] := result[1]+item.amount;
-		endif
-	endforeach
-	return result;
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-13
-// Required Modules: UO
-function GetStorageArea (areaname)
-	var area := FindStorageArea(areaname);
-	if (!area)
-		return CreateStorageArea(areaname);
-	endif
-	return area;
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-13
-// Required Modules: UO
-function GetStorageRoot (storage, rootname, objtype := 0x0E7C)
-	var item := FindRootItemInStorageArea(storage, rootname);
-	if (!item)
-		return CreateRootItemInStorageArea(storage, rootname, objtype);
-    endif
-	return item;
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-13
-// Required Modules: BASIC
-function GetStrAfter (needle, byref haystack)
-	return haystack[Find(haystack, needle, 1)+len(needle), len(haystack)];
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-13
-// Required Modules: BASIC
-function GetStrBefore (needle, byref haystack)
-	return haystack[1, Find(haystack, needle, 1)];
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-13
-// Required Modules: UO
-//function GetTimeOfDay()
-//    var time := ReadGameClock();
-//	return (time-((time/STD_DAY_LENGTH)*STD_DAY_LENGTH));
-//endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-13
-// Required Modules: UO
-// Notes: POLCLASS_UOBJECT will return both, mobiles and items.
-// This function is limited and it'd be a good idea to have core support for it.
-function ListObjectsOfClassNearLocation (x, y, z, range, POLCLASS, flags := LISTEX_FLAG_NORMAL, realm := "britannia")
-	case (POLCLASS)
-		POLCLASS_UOBJECT:
-			return ListObjectsInBox(x-range, y+range, z-10, x+range, y-range, z+10, realm);
-		POLCLASS_MOBILE: //I'll separate it from POLCLASS_NPC for performance purposes.
-			return ListMobilesNearLocationEx(x, y, z, range, flags, realm);
-		POLCLASS_NPC:
-			var result array;
-			foreach mobile in ListMobilesNearLocationEx(x, y, z, range, flags, realm)
-				if (mobile.isa(POLCLASS_NPC)) result.append(mobile); endif
-			endforeach
-			return result;
-		default:
-			var result array;
-			foreach item in ListItemsNearLocation(x, y, z, range, realm)
-				if (item.isa(POLCLASS)) result.append(item); endif
-			endforeach
-			return result;
-	endcase
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-13
-// Required Modules: UO
-// This function forces the move in every aspect: using MOVEITEM_FORCELOCATION
-// and setting the item movable state to 1 if it's zero. The movable state is
-// set back to it's original state.
-function MoveItemToForcedLocation (item, x, y, z)
-	if (!item.movable)
-		item.movable := 1;
-		var result := MoveItemToLocation(item, x, y, z, MOVEITEM_FORCELOCATION);
-		item.movable := 0;
-		return result;
-	endif
-	return MoveItemToLocation(item, x, y, z, MOVEITEM_FORCELOCATION);
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-13
-// Required Modules: UO
-function MoveItem (item, byref place, flags := MOVEITEM_NORMAL)
-	if (place.isa(POLCLASS_CONTAINER))
-		return MoveItemToContainer(item, place);
-	elseif (place=array)
-		case (place.size())
-			0:1:
-				var result := error;
-				result.+errortext := "Parameter place has less than 2 elements."
-				return result;
-			2:
-				place[3] := GetWorldHeight(place[1], place[2], item.realm);
-				continue;
-			default:
-				return MoveItemToLocation(item, place[1], place[2], place[3], flags);
-		endif
-	endif
-	var result := error;
-	result.+errortext := "Invalid place: expected an ContainerRef or Array, got "+place+".";
-	return result;
-endfunction
-
-// HellRaider <zion at uo.com.br> 2001-01-17
-// Required Modules: BASIC CFGFILE UTIL
-function RandomListInt (tableref)
-	var elem := SplitWords(GetConfigString(tableref, "Elem"+RandomInt(tableref.Count)));
-	elem[1] := CInt(elem[1]);
-	if (elem.Size()=1)
-		return elem[1];
-	else
-		return RandomInt(CInt(elem[2])-elem[1])+elem[1];
-	endif
-endfunction
-
-// HellRaider <zion at uo.com.br> 2001-03-02
-// Required Modules: UO
-const SEASON_SUMMER		:= 1;
-const SEASON_FALL		:= 2;
-const SEASON_WINTER		:= 3;
-const SEASON_FELUCCA	:= 4;
-const SEASON_SPRING		:= 5;
-function Season (player, season_id)
-	// Doesn't support cursor customization, yet.
-	SendPacket(player, "BC0"+season_id+"01");
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-18
-// Required Modules: UO
-function SubtractFromStackArray (byref arrayofobjrefs, amount)
-	var needed := amount;
-	foreach item in arrayofobjrefs
-		if (!item.isa(POLCLASS_ITEM)) continue; endif
-		if (item.amount<needed)
-			needed := needed-item.amount;
-			SubtractAmount(item, item.amount);
-		else
-			SubtractAmount(item, needed);
-			return amount;
-		endif
-	endforeach
-	return (amount-needed);
-endfunction
-
-// HellRaider <zion at uo.com.br> 2000-12-13
-// Required Modules: UO BASIC MATH
-// Note: For some (rare) coords this function returns the minutes with 1 tile off OSI's.
-// Each cartesian coord still have an unique sextant coord though (shouldn't be a problem).
-// OSI uses a special rounding function for it.
-function ToSextant(x, y)
-	var latitude_direction, longitude_direction;
-	var latitude_degrees, longitude_degrees;
-	var latitude_minutes, longitude_minutes;
-
-	latitude_degrees := (y-1624)*0.087890625;
-	longitude_degrees := (x-1323)*0.0703125;
-
-	if (latitude_degrees < 0)
-		latitude_direction := "N";
-	else
-		latitude_direction := "S";
-	endif
-
-	if (longitude_degrees < 0)
-		longitude_direction := "W";
-	else
-		longitude_direction := "E";
-	endif
-
-	latitude_degrees := Abs(latitude_degrees);
-	longitude_degrees := Abs(longitude_degrees);
-
-	//The next lines get the first 2 digits from the decimal part of the real variables
-	//and multiply by 60, returning an integer.
-	latitude_minutes := ((((latitude_degrees-Floor(latitude_degrees))*100)*60)/100);
-	longitude_minutes := ((((longitude_degrees-Floor(longitude_degrees))*100)*60)/100);
-
-	return(	Floor(latitude_degrees)+"o "+latitude_minutes+"'"+latitude_direction+", "+
-			Floor(longitude_degrees)+"o "+longitude_minutes+"'"+longitude_direction);
-endfunction
-
-/***************************************************************************
-
-	HISTORY OF CHANGES
-
-	Version 0.1
-		- Added the followind functions:
-			GetFormattedTime();
-			GetSpelledTime();
-			GetStorageArea (byref areaname);
-			GetStorageRoot (storage, byref rootname, objtype := 0x0E7C);
-			GetStrAfter (byref needle, byref haystack);
-			GetStrBefore (byref needle, byref haystack);
-			GetTimeOfDay();
-			ListObjectsOfClassNearLocation(x, y, z, range, POLCLASS, flags := LISTEX_FLAG_NORMAL);
-			MoveItemToForcedLocation(item, x, y, z);
-			MoveItem(item, byref place, flags := MOVEITEM_NORMAL);
-			ToSextant(x, y);
-
-	Version 0.2
-		- Added function GetGoldInContainer(container).
-
-	Version 0.3
-		- Added History of Changes.
-		- Added function CreateStackArrayInContainer (container, objtype, amount, limit_per_stack := 60000).
-		- Added function GetStacksOfTypeInContainer (container, objtype).
-		- Added function SubtractFromStackArray (byref arrayofobjrefs, amount).
-		- Fixed a bug in GetGoldInContainer(container) that would generate a compilation error.
-		- Fixed a bug in MoveItem (item, byref place, flags := MOVEITEM_NORMAL).
-		- Small tweak on the design of GetGoldInContainer(container). Since POL arrays don't support
-		elements at index zero, the function was changed so the first element (index one) is the sum
-		of the amount of gold found within the container, and the following elements are objrefs to
-		the piles of gold.
-
-	Version 0.4
-		- Added RandomListInt(tableref).
-		- Added Season(player, season_id).
-		
-	Version 0.5
-		- Racalac added realm param to ListObjectsOfClassNearLocation
-
-***************************************************************************/

Modified: trunk/096/scripts/include/string.inc
===================================================================
--- trunk/096/scripts/include/string.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/string.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -118,7 +118,7 @@
 
 	for (q := 1; q <= ArrayLen; q := q + 1)
 		for (i := 1; i <= ArrayLen; i := i + 1)
-			if (OldArray[q] = MainArray[i])
+			if (OldArray[q] == MainArray[i])
 				IndexArray[q] := i;
 				i := ArrayLen + 1;
 			endif
@@ -241,7 +241,7 @@
 
 	if (padding < 0)
 		return 0;
-	elseif (padding = 0)
+	elseif (padding == 0)
 		return x;
 	endif
 
@@ -267,7 +267,7 @@
 
 	var i;
 	for (i := 1; i <= len(myarray); i := i + 1)
-		if (myarray[i] = elementvalue)
+		if (myarray[i] == elementvalue)
 			return i;
 		endif
 	endfor
@@ -296,40 +296,35 @@
 // Makes the string lowercase, then capitalizes the first letter.
 function UCFirst(text)
 	text := CStr(text);
-	if ( len(text) > 1 )
-		text := lower(text);
-		text[1] := upper(text[1]);
+	if ( Len(text) > 1 )
+		text := Lower(text);
+		text[1] := Upper(text[1]);
 	endif
 	return text;
 endfunction
 
 // Removes spaces from a string based on the flags passed.
 function RemoveSpaces(text, flags:=CLR_LEADING_SPACES)
-	var pre := flags & CLR_LEADING_SPACES;
-	var post := flags & CLR_TRAILING_SPACES;
-	var dbl := flags & CLR_DOUBLE_SPACES;
-	var all := flags & CLR_ALL_SPACES;
-	
-	if ( all )
+	if ( flags & CLR_ALL_SPACES )
 		while ( text[" "] )
 			text[" "] := "";
 			sleepms(2);
 		endwhile
 	else
-		if ( pre )
+		if ( flags & CLR_LEADING_SPACES )
 			while ( text[1] == " " )
 				text[1] := "";
 				sleepms(2);
 			endwhile
 		endif
-		if ( post )
+		if ( flags & CLR_TRAILING_SPACES )
 			while ( text[len(text)] == " " )
 				text[len(text)] := "";
 				sleepms(2);
 			endwhile
 		endif
 	
-		if ( dbl )
+		if ( flags & CLR_DOUBLE_SPACES )
 			while ( text["  "] )
 				text["  "] := " ";
 				sleepms(2);

Deleted: trunk/096/scripts/include/stringArrays.inc
===================================================================
--- trunk/096/scripts/include/stringArrays.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/stringArrays.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,23 +0,0 @@
-
-function array2string(thearray)
-        var retval;
-
-        foreach word in thearray
-                retval := retval + " " + thearray;
-        endforeach
-
-        retval := retval[2,1000000];
-
-        return retval;
-endfunction
-
-
-function string2array(thestring)
-
-        var retval := array;
-        retval := SplitWords(thestring);
-
-endfunction
-
-
-       
\ No newline at end of file

Deleted: trunk/096/scripts/include/teleporters.inc
===================================================================
--- trunk/096/scripts/include/teleporters.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/teleporters.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,410 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-var teleporters := {
-////yew to t2a tunnel
-    { 312,   786,  -24,    5748,   361,    2},
-    { 313,   786,  -24,    5749,   361,    2},
-    { 314,   786,  -24,    5750,   361,    4},
-    {5748,   362,    2,     312,   787,  -24},
-    {5749,   362,    0,     313,   787,  -24},
-    {5750,   362,    3,     314,   787,  -24},
-           
-////jhelom teleporters
-    {1142,  3621,    5,    1414,  3828,    5},
-    {1406,  3996,    5,    1414,  3828,    5},
-    {1409,  3824,    5,    1124,  3623,    5},
-    {1419,  3832,    5,    1466,  4015,    5},
-
-//// moonglow teleporters
-    {4300,   968,    5,    4442,  1122,    5},
-    {4436,  1107,    5,    4300,   992,    5},
-    {4443,  1137,    5,    4487,  1475,    5},
-    {4449,  1107,    5,    4539,   890,   28},
-    {4449,  1115,    5,    4671,  1135,   10},
-    {4496,  1475,   15,    4442,  1122,    5},
-    {4540,   898,   32,    4442,  1122,    5},
-    {4663,  1134,   13,    4442,  1122,    5},
-
-////hedge maze
-    {1163,  2208,   60,    1171,  2202,    0},
-    {1165,  2205,   40,    1163,  2209,   60},
-    {1166,  2237,   60,    1163,  2208,    0},
-
-////destard
-//enterance
-    {1175,  2635,    0,    5242,  1006,    0},
-    {1176,  2635,    0,    5243,  1006,    0},
-    {1177,  2635,    0,    5244,  1006,    0},
-    {5242,  1007,    0,    1175,  2636,    0},
-    {5243,  1007,    0,    1176,  2636,    0},
-    {5244,  1007,    0,    1177,  2636,    0},
-//lvl1 - lvl2
-    {5129,   909,  -28,    5142,   798,   17},
-    {5130,   909,  -28,    5143,   798,   17},
-    {5131,   909,  -28,    5144,   798,   17},
-    {5132,   909,  -28,    5145,   798,   17},
-    {5142,   797,   22,    5129,   908,  -28},
-    {5143,   797,   22,    5130,   908,  -28},
-    {5144,   797,   22,    5131,   908,  -28},
-    {5145,   797,   22,    5132,   908,  -28},
-//lvl2 - lvl3 
-    {5153,   808,  -25,    5134,   984,   17},
-    {5153,   809,  -25,    5134,   985,   17},
-    {5153,   810,  -25,    5134,   986,   17},
-    {5153,   811,  -25,    5134,   987,   17},
-    {5133,   984,   22,    5152,   808,  -19},
-    {5133,   985,   22,    5152,   809,  -19},
-    {5133,   986,   22,    5152,   810,  -19},
-    {5133,   987,   22,    5152,   811,  -19},
-
-////shame
-//enterance
-    { 512,  1559,    0,    5394,   126,    0},
-    { 513,  1559,    0,    5395,   126,    0},
-    { 514,  1559,    0,    5396,   126,    0},
-    {5394,   127,    0,     512,  1560,    0},
-    {5395,   127,    0,     513,  1560,    0},
-    {5396,   127,    0,     514,  1560,    0},
-//lvl1 - lvl2
-    {5490,    19,  -30,    5514,    10,    0},
-    {5514,    10,    0,    5490,    19,  -30},
-//lvl2 - lvl3
-    {5604,   102,    5,    5514,   148,   25},
-    {5514,   148,   25,    5604,   102,    5},
-//lvl3 - lvl4
-    {5538,   170,    5,    5513,   176,    5},
-    {5513,   176,    5,    5538,   170,    5},
-//lvl4 - lvl5
-    {5507,   162,    5,    5875,    19,   -5},
-    {5875,    19,   -5,    5507,   162,    5},
-
-////deceit
-//enterance
-    {4110,   430,    5,    5187,   638,    0},
-    {4111,   430,    5,    5188,   638,    0},
-    {4112,   430,    5,    5189,   638,    0},
-    {5187,   639,    0,    4110,   431,    5},
-    {5188,   639,    0,    4111,   431,    5},
-    {5189,   639,    0,    4112,   431,    5},
-//lvl1 - lvl2
-    {5216,   587,  -18,    5304,   531,   12},
-    {5217,   587,  -18,    5305,   531,   12},
-    {5218,   587,  -18,    5306,   531,   12},
-    {5304,   530,   17,    5216,   586,  -13},
-    {5305,   530,   17,    5217,   586,  -13},
-    {5306,   530,   17,    5218,   586,  -13},
-//lvl2 - lvl3
-    {5346,   578,    5,    5137,   649,    5},
-    {5137,   649,    5,    5346,   578,    5},
-//lvl3 - lvl4
-    {5218,   761,  -28,    5305,   650,   12},
-    {5219,   761,  -28,    5306,   650,   12},
-    {5305,   649,   17,    5218,   760,    1},
-    {5306,   549,   17,    5219,   760,    1},
-
-////wrong
-//enterance
-    {2041,   215,   14,    5824,   630,    0},
-    {2042,   215,   14,    5825,   630,    0},
-    {2043,   215,   14,    5826,   630,    0},
-    {5824,   631,    0,    2041,   216,   14},
-    {5825,   631,    0,    2042,   216,   14},
-    {5826,   631,    0,    2043,   216,   14},
-//lvl1 - lvl2
-    {5826,   592,    0,    5690,   569,   25},
-    {5690,   569,   25,    5826,   592,    0},
-//lvl2 - lvl3
-    {5736,   551,   20,    5703,   639,    0},
-    {5698,   662,    0,    5736,   551,   20},
-
-////despise
-//enterance
-    {1296,  1080,    0,    5587,   630,   30},
-    {1296,  1081,    0,    5587,   631,   30},
-    {1296,  1082,    0,    5587,   632,   30},
-    {5588,   630,   30,    1297,  1080,    0},
-    {5588,   631,   30,    1297,  1081,    0},
-    {5588,   632,   30,    1297,  1082,    0},
-//lvl1 - lvl2
-    {5570,   628,   57,    5504,   569,   46},
-    {5570,   629,   57,    5504,   570,   46},
-    {5570,   630,   57,    5504,   571,   46},
-    {5505,   569,   41,    5571,   628,   52},
-    {5505,   570,   41,    5571,   629,   52},
-    {5505,   571,   41,    5571,   630,   52},
-//lvl2 - lvl3
-    {5571,   632,   12,    5522,   672,   32},
-    {5571,   633,   12,    5522,   673,   32},
-    {5571,   634,   12,    5522,   674,   32},
-    {5523,   672,   37,    5572,   632,   17},
-    {5523,   673,   37,    5572,   633,   17},
-    {5523,   674,   37,    5572,   634,   17},
-//lvl3 - lvl4
-    {5385,   755,  -13,    5410,   858,   57},
-    {5385,   756,  -13,    5410,   859,   57},
-    {5385,   757,  -13,    5410,   860,   57},
-    {5411,   858,   62,    5386,   755,   -8},
-    {5411,   859,   62,    5386,   756,   -8},
-    {5411,   860,   62,    5386,   757,   -8},
-
-////covetous
-//entrance
-    {5455,  1864,    0,    2498,   917,    0},
-    {5456,  1864,    0,    2499,   917,    0},
-    {5457,  1864,    0,    2500,   917,    0},
-    {2498,   916,    0,    5455,  1863,    0},
-    {2499,   916,    0,    5456,  1863,    0},
-    {2500,   916,    0,    5457,  1863,    0},
-//lvl1 - lvl2
-    {5392,  1959,    0,    2420,   883,    0},
-    {5393,  1959,    0,    2421,   883,    0},
-    {5394,  1959,    0,    2422,   883,    0},
-    {2420,   884,    0,    5392,  1958,    0},
-    {2421,   884,    0,    5393,  1958,    0},
-    {2422,   884,    0,    5394,  1958,    0},
-//lvl2 - lvl3
-    {2384,   836,    0,    5614,  1996,    0},
-    {2384,   837,    0,    5614,  1997,    0},
-    {2384,   838,    0,    5614,  1998,    0},
-    {5615,  1996,    0,    2385,   836,    0},
-    {5615,  1997,    0,    2385,   837,    0},
-    {5615,  1998,    0,    2385,   838,    0},
-//lvl3 - lvl4
-    {5388,  2027,    0,    2455,   859,    0},
-    {5389,  2027,    0,    2456,   859,    0},
-    {5390,  2027,    0,    2457,   859,    0},
-    {2455,   858,    0,    5388,  2026,    0},
-    {2456,   858,    0,    5389,  2026,    0},
-    {2457,   858,    0,    5390,  2026,    0},
-//lvl4 - lvl5
-    {2544,   846,    0,    5578,  1926,    0},
-    {2545,   846,    0,    5579,  1926,    0},
-    {2546,   846,    0,    5580,  1926,    0},
-    {5578,  1927,    0,    2544,   847,    0},
-    {5579,  1927,    0,    2545,   847,    0},
-    {5580,  1927,    0,    2546,   847,    0},
-//lvl5-lvl6a
-    {5556,  1827,  -15,    5551,  1805,   12},
-    {5557,  1827,  -15,    5552,  1805,   12},
-    {5551,  1804,   17,    5556,  1826,  -10},
-    {5552,  1804,   17,    5556,  1826,  -10},
-    {5552,  1804,   17,    5557,  1826,  -10},
-//lvl5 - lvl6b
-    {5595,  1840,  -14,    5466,  1804,   12},
-    {5595,  1841,  -14,    5466,  1805,   12},
-    {5465,  1804,   17,    5594,  1840,   -9},
-    {5465,  1805,   17,    5594,  1841,   -9},
-    {5465,  1805,   17,    5594,  1841,   -9},
-
-////hythloth
-//enterance
-    {5904,    17,   61,    4721,  3814,    0},
-    {5905,    17,   61,    4722,  3814,    0},
-    {5906,    17,   61,    4723,  3814,    0},
-    {4721,  3813,    0,    5904,    18,   56},
-    {4722,  3813,    0,    5905,    18,   56},
-    {4723,  3813,    0,    5906,    18,   56},
-//lvl1 - lvl2
-    {5905,    97,    0,    5976,   169,    0},
-    {5976,   169,    0,    5905,    97,    0},
-    {5976,   168,    0,    5905,    97,    0},
-    {5977,   169,    0,    5905,    97,    0},
-    {5977,   168,    0,    5905,    97,    0},
-//lvl2 - lvl3
-    {5922,   168,    7,    6081,   144,  -10},
-    {5922,   169,    7,    6081,   145,  -10},
-    {5922,   170,    7,    6081,   146,  -10},
-    {6080,   144,   -5,    5921,   169,   11},
-    {6080,   145,   -5,    5921,   169,   12},
-    {6080,   146,   -5,    5921,   169,   11},
-//lvl3 - lvl4
-    {6041,   192,    7,    6057,    87,   34},
-    {6041,   193,    7,    6057,    89,   34},
-    {6041,   194,    9,    6057,    90,   34},
-    {6056,    87,   39,    6040,   192,   12},
-    {6056,    89,   39,    6040,   193,   12},
-    {6056,    90,   39,    6040,   194,   12},
-
-////wind
-//enterance
-    {5166,   245,   15,    1361,   883,    0},
-    {1361,   883,    0,    5166,   245,   15},
-//NE exit
-    {5191,   152,    0,    1361,   883,    0},
-// wind - park
-    {5200,    71,   17,    5211,    22,   15},
-    {5217,    18,   15,    5200,    71,   17},
-    
-////ice dungeon
-//enterance
-    {5882,   241,    0,    1997,    81,    7},
-    {5882,   242,    0,    1997,    81,    7},
-    {5882,   243,    0,    1997,    81,    7},
-    {1997,    81,    7,    5881,   242,    0},
-//lvl1 - orc fort
-    {5849,   238,  -25,    5831,   324,   27},
-    {5850,   238,  -25,    5832,   324,   26},
-    {5851,   238,  -25,    5833,   324,   28},
-    {5852,   238,  -25,    5834,   324,   27},
-    {5853,   238,  -23,    5835,   324,   27},
-    {5831,   323,   34,    5849,   237,  -24},
-    {5832,   323,   34,    5850,   237,  -24},    
-    {5833,   323,   33,    5851,   237,  -24},    
-    {5834,   323,   33,    5852,   237,  -25},
-    {5835,   323,   33,    5853,   237,  -23},
-//lvl1 - lvl2
-    {5704,   145,  -45,    5705,   305,   12},
-    {5704,   146,  -45,    5705,   306,   12},   
-    {5704,   147,  -45,    5705,   307,   12},  
-    {5706,   303,   12,    5705,   146,  -45},
-    {5706,   304,   12,    5705,   146,  -45},
-    {5706,   305,   12,    5705,   146,  -45},
-    {5706,   306,   12,    5705,   147,  -45},
-    {5706,   307,   12,    5705,   147,  -45},
-    {5706,   308,   12,    5705,   147,  -45},
-//lvl1 - t2a exit
-    {5872,   144,   32,    5203,  2327,   27}, 
-    {5873,   144,   32,    5203,  2327,   27}, 
-    {5874,   144,   32,    5203,  2327,   27}, 
-    {5875,   144,   32,    5203,  2327,   27}, 
-    {5876,   144,   32,    5207,  2322,   27}, 
-    {5877,   144,   32,    5207,  2322,   27}, 
-    {5878,   144,   32,    5207,  2323,   26}, 
-    {5879,   144,   32,    5207,  2323,   26}, 
-    {5203,  2327,   27,    5874,   145,   30},
-    {5207,  2322, -255,    5875,   145,   30},
-    {5207,  2323, -255,    5876,   145,   30},
-
-////fire dungeon
-//enterance
-    {5827,  1502,    0,    2922,  3406,    8},
-    {5828,  1502,   -1,    2923,  3406,    9},
-    {5829,  1502,    2,    2924,  3406,    7},
-    {2922,  3405,    7,    5827,  1501,    0},
-    {2923,  3405,    6,    5828,  1501,    0},
-    {2924,  3405,    7,    5829,  1501,    1},
-//lvl1 - t2a exit
-    {5790,  1415,   39,    5758,  2907,   15},
-    {5790,  1416,   40,    5758,  2908,   15},
-    {5790,  1417,   38,    5758,  2909,   15},
-    {5757,  2907,   15,    5789,  1415,   42},
-    {5757,  2908,   14,    5789,  1416,   39},
-    {5757,  2909,   15,    5789,  1417,   38},
-//lvl1 - lvl2
-    {5786,  1335,  -13,    5701,  1318,    8},
-    {5787,  1335,  -13,    5702,  1318,    8},
-    {5788,  1335,  -13,    5703,  1318,    8},
-    {5701,  1319,   13,    5786,  1336,   -8},
-    {5702,  1319,   13,    5787,  1336,   -8},
-    {5703,  1319,   13,    5788,  1336,   -8},
-
-////volcano shop teleporter
-    {1653,  2963,    0,    1671,  2981,    0},
-    {1677,  2987,    0,    1675,  2987,   20},
-    
-////bucs den underground
-//enterance
-    {2674,  2242,    2,    2677,  2242,  -20},
-    {2676,  2242,  -18,    2675,  2242,    2},
-    {2676,  2242,  -18,    2675,  2242,    2},
-//exit
-    {2649,  2195,  -14,    2648,  2193,    4},
-    {2669,  2072,  -19,    2669,  2072,    5},
-    {2669,  2073,  -19,    2669,  2073,    5},
-
-////britain sewer
-//enterance
-    {6031,  1499,   35,    1490,  1640,   24},
-    {6031,  1501,   36,    1490,  1642,   24},
-    {1491,  1640,   24,    6032,  1499,   31},
-    {1491,  1642,   24,    6032,  1501,   31},
-//lvl1 - cave
-    {6140,  1431,    4,    6137,  1408,    2},
-    {6141,  1431,    4,    6138,  1408,    2},
-    {6137,  1409,    2,    6140,  1432,    4},
-    {6138,  1409,    2,    6141,  1432,    4},
-//cave - t2a exit
-    {6126,  1410,   15,    6074,  3333,    2},
-    {6127,  1410,   15,    6075,  3333,    2},    
-    {6074,  3332,    4,    6126,  1409,   13},
-    {6075,  3332,    4,    6127,  1409,   13},
-
-////minoc cave
-//enterance
-    {2399,   198,    0,    6087,  3675,   17},
-    {2400,   198,    0,    6087,  3676,   18},
-//exit to t2a
-    {6086,  3675,   15,    2399,   199,    0},
-    {6086,  3676,   16,    2400,   199,    0},
-
-////vesper graveyard
-//enterance
-    {2776,   894,  -23,    5685,   386,    1},
-    {2776,   895,  -23,    5685,   387,    2},
-    {5686,   386,    2,    2777,   894,  -23},
-    {5686,   387,    2,    2777,   895,  -23},
-//cave - t2a graveyard
-    {5658,   423,    8,    5697,  3659,    2},
-    {5697,  3660,   -5,    5658,   424,    0}, 
-
-////trinsic cave
-//enterance
-    {1628,  3320,    0,    5899,  1409,   41},
-    {1629,  3320,    0,    5900,  1409,   39}, 
-    {5898,  1411,   38,    1628,  3321,    0},
-    {5899,  1411,   43,    1628,  3321,    0},
-    {5900,  1411,   42,    1629,  3321,    0},
-//lvl1 - lvl2
-    {5918,  1410,  -29,    5962,  1407,   57},
-    {5918,  1411,  -29,    5962,  1408,   56},
-    {5918,  1412,  -29,    5962,  1409,   56},
-    {5961,  1407,   59,    5917,  1410,  -27},
-    {5961,  1408,   59,    5917,  1411,  -27},
-    {5961,  1409,   59,    5917,  1412,  -27},
-//lvl2 - west t2a
-    {6025,  1344,  -26,    5138,  3664,   31},
-    {6025,  1345,  -25,    5138,  3665,   32},
-    {6025,  1346,  -25,    5138,  3666,   32},
-    {5137,  3664,   27,    6024,  1345,  -25},
-    {5137,  3665,   31,    6024,  1346,  -25},
-//lvl2 - delucia
-    {6005,  1378,    0,    5151,  4062,   37},
-    {6005,  1379,    2,    5151,  4063,   37},
-    {6005,  1380,    1,    5151,  4064,   37},
-    {5150,  4062,   38,    6004,  1378,    1},
-    {5150,  4063,   38,    6004,  1379,   -1},
-    
-////terathan keep
-//enterance
-    {5426,  3122, -74,    5341,  1601,    0},
-    {5341,  1601,   0,    5426,  3121,  -65},
-
-////spirituality shrine
-    {1592,  2489,   17,    1600,  2489,   10},
-    {1600,  2489,   10,    1592,  2490,   17},
-    {1600,  2490,   10,    1592,  2490,   17}
-};
-
-function CreateTeleporters()
-  if(GetGlobalProperty("SystemTeleportersCreated") == 1)
-    return;
-  endif
-  foreach tele in teleporters
-    var fromx := tele[1];
-    var fromy := tele[2];
-    var fromz := tele[3];
-    var tox := tele[4];
-    var toy := tele[5];
-    var toz := tele[6];
-    var teleporter := CreateItemAtLocation(fromx, fromy, fromz, "systemteleporter", 1, "britannia"); //FIXME realms
-    if(teleporter)
-      teleporter.graphic := 3948;
-      SetObjProperty(teleporter, "DestX", tox);
-      SetObjProperty(teleporter, "DestY", toy);
-      SetObjProperty(teleporter, "DestZ", toz);
-    endif
-  endforeach
-  SetGlobalProperty("SystemTeleportersCreated", 1);
-endfunction

Deleted: trunk/096/scripts/include/tempMod.inc
===================================================================
--- trunk/096/scripts/include/tempMod.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/tempMod.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,44 +0,0 @@
-use os;
-
-function do_temp_mod(who, mod, amt, duration)
-  var parms := {};
-  parms[2] := who;
-  parms[1] := mod;
-  parms[3] := amt;
-  parms[4] := duration;
-  start_script("::/misc/demod", parms);
-endfunction
-
-function can_stat_mod(who, stat)
-  var mod;
-  case(stat)
-    "str": mod := "#ss";
-    "dex" : mod := "#dd";
-    "int" : mod := "#ii";
-    "ar"  : mod := "#aa";
-  endcase
-  if(GetObjProperty(who, mod))
-    return 0;
-  else
-    SetObjProperty(who, mod, 1);
-    return 1;
-  endif
-endfunction
-
-function allow_stat_mod(who, stat, duration)
-  Detach();
-  var mod;
-  case(stat)
-    "str": mod := "#ss";
-    "dex" : mod := "#dd";
-    "int" : mod := "#ii";
-    "ar"  : mod := "#aa";
-  endcase
-  while(1)
-    sleep(duration);
-    if(who)
-      EraseObjProperty(who, mod);
-      return;
-    endif
-  endwhile
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/toolWear.inc
===================================================================
--- trunk/096/scripts/include/toolWear.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/toolWear.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,71 +0,0 @@
-include ":attributes:attributes_ex";
-
-function CheckToolWear (who, tool, skillid)
-  var swings := GetObjProperty(tool,"swings");
-  if(!swings)
-    var mods := GetObjProperty(tool, "durability");
-    var bonus := 0;
-    case(mods)
-      "durable":        bonus := 10;
-      "substantial":    bonus := 20;
-      "massive":        bonus := 30;
-      "fortified":      bonus := 40;
-      "indestructable": bonus := 50;
-    endcase
-    swings := Cint(50 * tool.quality) + bonus;
-    SetObjProperty(tool,"swings", swings);
-  endif
-  if(swings <= 0)
-    DestroyItem(tool);
-    SendSysMessage(who,"Your tool broke.");
-  else
-    var skill := GetAttribute(who, AP_SkillIdToAttributeName(skillid));
-    if(skill > 80)
-      skill := 80;
-    elseif(skill < 20)
-      skill := 20;
-    endif
-    if((RandomInt(100)+1) > skill)
-      if(tool.isa(POLCLASS_WEAPON))
-        if(tool.hp > 1)
-          SetObjProperty(tool,"swings", (swings - 1));
-          tool.hp := tool.hp - 1;
-        elseif((tool.hp > tool.maxhp) or (tool.hp == 1))
-          SendSysMessage(who,"Your tool broke.");
-          DestroyItem(tool);
-        endif
-      else
-        SetObjProperty(tool,"swings", (swings - 1));
-      endif   
-    endif
-  endif
-endfunction 
-
-function SetToolDurability(who, tool, skillid)
-
-  var toolfile := ReadConfigFile(":*:itemdesc");
-  var toolscript := toolfile[tool.objtype].Script;
-
-  if(!toolscript.errortext)
-    if(!tool.isA(POLCLASS_CONTAINER) && !tool.isA(POLCLASS_ARMOR))
-      var myskill := GetEffectiveSkill(who, skillid);
-      var swings := 0;
-      var mods := GetObjProperty(tool, "durability");
-      var bonus := 0;
-      case(mods)
-        "durable":        bonus := 10;
-        "substantial":    bonus := 20;
-        "massive":        bonus := 30;
-        "fortified":      bonus := 40;
-        "indestructable": bonus := 50;
-        default: bonus := 0;
-      endcase
-      swings := Cint(50 + myskill) + bonus;
-      SetObjProperty(tool, "swings", swings);
-      if(!tool.quality or tool.quality == error)
-        tool.quality := 1.0;
-      endif
-    endif
-  endif
-
-endfunction 

Deleted: trunk/096/scripts/include/utility.inc
===================================================================
--- trunk/096/scripts/include/utility.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/utility.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,49 +0,0 @@
-use basic;
-
-include "include/myUtil";
-
-
-function find_or_create_storage( areaname )
-  var area;
-  area := FindStorageArea( areaname );
-  if(!area)
-	area := CreateStorageArea( areaname );
-    if(area)
-    endif
-  endif
-  return area;
-endfunction
-
-function find_or_create_item(storage, name, objtype := 0x966a)
-  var item := FindRootItemInStorageArea(storage, name);
-  if(item)
-	return item;
-  endif
-  item := CreateRootItemInStorageArea( storage, name, objtype);
-  return item;
-endfunction
-
-function IsLocationAccessible(character, x, y, z)
-  var xd, yd, zd;
-  xd := character.x - x;
-  if(xd < -1 || xd > 1)
-    return 0;
-  endif
-  yd := character.y - y;
-  if(yd < -1 || yd > 1)
-    return 0;
-  endif
-  zd := character.z - z;
-  if(zd < -10 || zd > 10)
-    return 0;
-  endif
-  return CheckLosAt( character, x, y, z );
-endfunction
-
-function min(x, y)
-  if(x<= y)
-    return x;
-  else
-    return y;
-  endif
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/webPage.inc
===================================================================
--- trunk/096/scripts/include/webPage.inc	2005-11-04 00:35:53 UTC (rev 885)
+++ trunk/096/scripts/include/webPage.inc	2005-11-04 02:19:06 UTC (rev 886)
@@ -1,34 +0,0 @@
-function OpenWebSite(who, url)
-	var packet := "A5" + WordPacket(Len(url) + 4);
-
-	foreach ascii_code in CAscZ(url)
-		packet:=packet+BytePacket(ascii_code);
-	endforeach
-	SendPacket(who, packet + "00");
-
-	return;
-endfunction
-
-
-function BytePacket(byte)
-	var packet := Hex(byte);
-	packet := "00" + packet[3, Len(packet) - 2];
-
-	return (packet[Len(packet) - 1, 2]);
-endfunction
-
-
-function WordPacket(word)
-	var packet := Hex(word);
-	packet := "0000" + packet[3, Len(packet) - 2];
-
-	return (packet[Len(packet) - 3, 4]);
-endfunction
-
-
-function DoubleWordPacket(doubleword)
-	var packet := Hex(doubleword);
-	packet := "00000000" + packet[3, Len(packet) - 2];
-
-	return (packet[Len(packet) - 7, 8]);
-endfunction



From panosl at berlios.de  Fri Nov  4 14:49:05 2005
From: panosl at berlios.de (Panos Laganakos at BerliOS)
Date: Fri, 4 Nov 2005 14:49:05 +0100
Subject: [Poldistro-svn] r900 - in trunk/096: pkg/mobiles/death/commands/seer scripts/include
Message-ID: <200511041349.jA4Dn5Bu028053@sheep.berlios.de>

Author: panosl
Date: 2005-11-04 14:48:31 +0100 (Fri, 04 Nov 2005)
New Revision: 900

Modified:
   trunk/096/pkg/mobiles/death/commands/seer/resurrect.src
   trunk/096/scripts/include/client.inc
   trunk/096/scripts/include/equipment.inc
   trunk/096/scripts/include/facings.inc
   trunk/096/scripts/include/itemdesc.inc
   trunk/096/scripts/include/messages.inc
   trunk/096/scripts/include/packets.inc
Log:


Modified: trunk/096/pkg/mobiles/death/commands/seer/resurrect.src
===================================================================
--- trunk/096/pkg/mobiles/death/commands/seer/resurrect.src	2005-11-04 07:49:13 UTC (rev 899)
+++ trunk/096/pkg/mobiles/death/commands/seer/resurrect.src	2005-11-04 13:48:31 UTC (rev 900)
@@ -1,40 +1,41 @@
-/*
- * $Id$
+/* $Id$
  *
  */
-
 use uo;
 
 include ":attributes:attributes";
+include "include/messages";
+include "include/localization";
 
-program textcmd_Resurrection(who)
-	if ( who.dead )
+
+program command_Resurrect(who, params)
+	if (params == "")
+		SendMessage(who, MSG_TARGET_CHAR, array{}, MSG_COMMAND);
+		if ((var targ := Target(who, TGTOPT_NOCHECK_LOS)) == 0)
+			SendMessage(who, MSG_CANCELLED, array{}, MSG_COMMAND);
+			return 0;
+		else
+			if (targ.isA(POLCLASS_CORPSE))
+				targ := SystemFindObjectBySerial(targ.ownerserial);
+				if (!targ)
+					SendSysMessage(who, "No owner could be found for that corpse.");
+					return 0;
+				endif
+					var result := Resurrect(targ);
+				if (result.errortext)
+					SendSysMessage(who, "Error - "+result.errortext);
+					return 0;
+				endif
+			endif
+		endif		
+	elseif (params == "me")
 		Resurrect(who);
 		AP_RefreshVitals(who);
 		return 1;
+	else
+		SendMessage(who, MSG_USE_HELP, array{}, MSG_COMMAND);
 	endif
 
-	SendSysMessage(who, "Select a player corpse or ghost to resurrect.");
-	var targ := Target(who);
-	if ( !targ )
-		SendSysMessage(who, "Cancelled.");
-		return 0;
-	endif
-
-	if ( targ.IsA(POLCLASS_CORPSE) )
-		targ := SystemFindObjectBySerial(targ.ownerserial);
-		if ( !targ )
-			SendSysMessage(who, "No owner could be found for that corpse.");
-			return 0;
-		endif
-	endif
-
-	var result := Resurrect(targ);
-	if ( result.errortext )
-		SendSysMessage(who, "Error - "+result.errortext);
-		return 0;
-	endif
-
-	SendSysMessage(who, "Done.");
+	SendMessage(who, MSG_DONE, array{}, MSG_COMMAND);
 	return 1;
 endprogram

Modified: trunk/096/scripts/include/client.inc
===================================================================
--- trunk/096/scripts/include/client.inc	2005-11-04 07:49:13 UTC (rev 899)
+++ trunk/096/scripts/include/client.inc	2005-11-04 13:48:31 UTC (rev 900)
@@ -1,8 +1,10 @@
-/* CLIENT.INC - defines client releated constants.
+/* $Id$
  *
+ * Purpose
  * This include file is designed to hold all the client lowlevel constants.
  * Not all constants might be usable as of now, but in the future, they
  * might be.
+ *
  */
 
 
@@ -165,7 +167,7 @@
 	SFX_BEAR_4C		:= 0x4C7,
 	SFX_BEAR_5C		:= 0x4C8,
 	
-	SFX_SPELL_FAIL		:= 0x5D,
+	SFX_SPELL_FAIL		:= 0x5D
 endenum
 
 enum GRAPHIC_EFFECTS

Modified: trunk/096/scripts/include/equipment.inc
===================================================================
--- trunk/096/scripts/include/equipment.inc	2005-11-04 07:49:13 UTC (rev 899)
+++ trunk/096/scripts/include/equipment.inc	2005-11-04 13:48:31 UTC (rev 900)
@@ -1,5 +1,4 @@
-/*
- * $Id$
+/* $Id$
  *
  * Purpose
  * Allows modifiers to be easily set and removed.
@@ -12,7 +11,6 @@
  * was chosen to be used in this script.
  *
  */
-
 use uo;
 use cfgfile;
 
@@ -23,6 +21,7 @@
 CONST	EQUIP_BOTH_MODS		:= 0x3;
 CONST	EQUIP_CSTM_OR_ITEMDESC	:= 0x4;
 
+
 /* 
  * GetEquipmentModifiers(item, flags:=EQUIP_CSTM_OR_ITEMDESC)
  *
@@ -77,6 +76,7 @@
 		return cstm_mods;
 	endif
 endfunction
+
 	
 /*
  * AddModifierToEquipment(item, attrib_name, modifier)
@@ -117,6 +117,7 @@
 	return SetObjProperty(item, "AttribMods", cstm_mods);
 endfunction
 
+
 /*
  * RemoveModifierFromEquipment(item, attrib_name)
  *
@@ -149,6 +150,7 @@
 	endif
 endfunction
 
+
 /* 
  * ApplyEquipmentMods(mobile, item)
  *
@@ -186,6 +188,7 @@
 	return 1;
 endfunction
 
+
 /* 
  * RemoveEquipmentMods(mobile, item)
  *

Modified: trunk/096/scripts/include/facings.inc
===================================================================
--- trunk/096/scripts/include/facings.inc	2005-11-04 07:49:13 UTC (rev 899)
+++ trunk/096/scripts/include/facings.inc	2005-11-04 13:48:31 UTC (rev 900)
@@ -1,12 +1,11 @@
-/*
- * $Id$
+/* $Id$
  *
  */
-
 use uo;
 use os;
 use math;
 
+
 /*
  * TurnObjectToward(object, x_pos, y_pos)
  *
@@ -30,6 +29,7 @@
 	return orig;
 endfunction
 
+
 /*
  * IsFacing(mobile, x_pos, y_pos)
  *
@@ -50,6 +50,7 @@
 	return ( mobile.facing == GetFacing(mobile.x, mobile.y, x, y) );
 endfunction
 
+
 /*
  * IsBehind(mobile, x_pos, y_pos)
  * Determines if a set of coordinates are behind a character.
@@ -69,12 +70,11 @@
  * Returns 0 if not.
  *
  */
-function IsBehind( tgt_mob, locx, locy )
+function IsBehind(tgt_mob, locx, locy)
 	var frot := Abs(((tgt_mob.facing+4)%8)-GetFacing(tgt_mob.x,tgt_mob.y,locx,locy));
-	if ( frot > 4 )
+	if (frot > 4)
 		frot := 8-frot;
 	endif
 
-	return ( frot < 2 );
+	return (frot < 2);
 endfunction
-

Modified: trunk/096/scripts/include/itemdesc.inc
===================================================================
--- trunk/096/scripts/include/itemdesc.inc	2005-11-04 07:49:13 UTC (rev 899)
+++ trunk/096/scripts/include/itemdesc.inc	2005-11-04 13:48:31 UTC (rev 900)
@@ -1,13 +1,12 @@
-/*
- * $Id$
+/* $Id$
  *
  */
-
 use uo;
 use os;
 use cfgfile;
 use polsys;
 
+
 /*
  * LoadItemDescCfgFile(package)
  *
@@ -36,6 +35,7 @@
 	return item_cfg;
 endfunction
 
+
 /*
  * GetItemDescInfo(obj_type)
  *
@@ -55,6 +55,7 @@
 	return item_cfg[obj_type];
 endfunction
 
+
 /*
  * GetObjTypeGraphic(obj_type)
  *
@@ -84,6 +85,7 @@
 	endif
 endfunction	
 
+
 /*
  * GetObjTypeDesc(obj_type, plural)
  *

Modified: trunk/096/scripts/include/messages.inc
===================================================================
--- trunk/096/scripts/include/messages.inc	2005-11-04 07:49:13 UTC (rev 899)
+++ trunk/096/scripts/include/messages.inc	2005-11-04 13:48:31 UTC (rev 900)
@@ -28,8 +28,6 @@
 /*
  * SendMessage(who, id, type)
  *
- * Author: Folko
- *
  * Purpose
  * Sends a message to a character.
  *
@@ -61,8 +59,6 @@
 /*
  * SendAll(id, parms, type)
  *
- * Author: Folko
- *
  * Purpose
  * Sends a message to all online characters.
  *
@@ -88,9 +84,6 @@
 /*
  * SendHTMLMessage(who, text)
  *
- * Author: Folko
- * Last-Edit: MuadDib
- *
  * Purpose
  * Sends a HTML gump containing the text to the character.
  *
@@ -117,8 +110,6 @@
 /*
  * SendCliloc(who, num, params, type, origin, hue, font)
  *
- * Author: Folko
- *
  * Purpose
  * Sends a localized message to the client.
  *
@@ -174,8 +165,6 @@
 /*
  * FormatMessage(message, parms)
  *
- * Author: Folko
- *
  * Purpose
  * Formats a message by inserting the parameters.
  *

Modified: trunk/096/scripts/include/packets.inc
===================================================================
--- trunk/096/scripts/include/packets.inc	2005-11-04 07:49:13 UTC (rev 899)
+++ trunk/096/scripts/include/packets.inc	2005-11-04 13:48:31 UTC (rev 900)
@@ -21,8 +21,6 @@
 /*
  * SendFeatures(who, features)
  *
- * Author: Folko
- *
  * Purpose
  * Enable OSI client features like the chat button or LBR graphics.
  *



From austin at berlios.de  Sat Nov  5 02:39:21 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sat, 5 Nov 2005 02:39:21 +0100
Subject: [Poldistro-svn] r901 - in trunk/096/pkg/skills/magery: . delay
Message-ID: <200511050139.jA51dLJP025058@sheep.berlios.de>

Author: austin
Date: 2005-11-05 02:38:58 +0100 (Sat, 05 Nov 2005)
New Revision: 901

Added:
   trunk/096/pkg/skills/magery/delay/
   trunk/096/pkg/skills/magery/delay/delayCheck.src
Removed:
   trunk/096/pkg/skills/magery/movementCheck.src
Modified:
   trunk/096/pkg/skills/magery/spellStarter.src
Log:
Updates to match the OSI style (thanks to Muad for 'splaining it)

Added: trunk/096/pkg/skills/magery/delay/delayCheck.src
===================================================================
--- trunk/096/pkg/skills/magery/delay/delayCheck.src	2005-11-04 13:48:31 UTC (rev 900)
+++ trunk/096/pkg/skills/magery/delay/delayCheck.src	2005-11-05 01:38:58 UTC (rev 901)
@@ -0,0 +1,20 @@
+use uo;
+use os;
+
+program MovementChecker(params)
+	var who := params[1];
+	var spell_starter := GetProcess(params[2]);
+	var orig_x := params[3];
+	var orig_y := params[4];
+	params := 0; // not needed anymore
+	
+	while ( spell_starter.pid )
+		if ( who.x != orig_x || who.y != orig_y )
+			spell_starter.SendEvent("moved");
+			return 1;
+		endif
+		sleepms(50);
+	endwhile
+	
+	return 1;
+endprogram

Deleted: trunk/096/pkg/skills/magery/movementCheck.src
===================================================================
--- trunk/096/pkg/skills/magery/movementCheck.src	2005-11-04 13:48:31 UTC (rev 900)
+++ trunk/096/pkg/skills/magery/movementCheck.src	2005-11-05 01:38:58 UTC (rev 901)
@@ -1,20 +0,0 @@
-use uo;
-use os;
-
-program MovementChecker(params)
-	var who := params[1];
-	var spell_starter := GetProcess(params[2]);
-	var orig_x := params[3];
-	var orig_y := params[4];
-	params := 0; // not needed anymore
-	
-	while ( spell_starter.pid )
-		if ( who.x != orig_x || who.y != orig_y )
-			spell_starter.SendEvent("moved");
-			return 1;
-		endif
-		sleepms(50);
-	endwhile
-	
-	return 1;
-endprogram

Modified: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-04 13:48:31 UTC (rev 900)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-05 01:38:58 UTC (rev 901)
@@ -13,26 +13,23 @@
 include "include/itemdesc";
 include "include/client";
 
-set_script_option(SCRIPTOPT_CAN_ACCESS_OFFLINE_MOBILES, 1);
-
 program SpellStarter(params)
 	var who		:= params[1]; // Caster.
 	var spell_id	:= params[2]; // Id # of the spell.
 	var scroll	:= params[3]; // Scroll object being used.
 	var targ	:= params[4]; // NPC target
-	params := 0; // No longer needed
+	params := 0;	// No longer needed
 	
 	Attach(who);
 	
 	var spell_elem := MS_GetSpellsCfgElem(spell_id);
 
-	// If spell is set to 'TestOnly 1', then it requires GM-cmdlevel or #TestSpell CProp
-	// before it can be used.
-	var can_cast := 1;
+	// If spell is set to 'TestOnly 1', then it requires cmdlevel or #SpellTester CProp before it can be used.
 	if ( spell_elem.TestOnly && (!who.cmdlevel) )
 		// They need #TestSpell to cast it
-		if ( GetObjProperty(who, "#TestSpell") == error )
-			can_cast := 0;
+		if ( !GetObjProperty(who, "#SpellTester") )
+			FailSpell(who);
+			return 0;
 		endif
 	elseif ( spell_elem.NPCOnly && !who.npctemplate )
 		PrintTextAbove(who, "Unable to cast - NPC only spell.");
@@ -44,7 +41,7 @@
 	var difficulty		:= spell_elem.Difficulty;
 	var mana_cost		:= spell_elem.ManaCost;
 	if ( !attribute )
-		attribute := "Magery";
+		attribute := MAGERY;
 	endif
 
 	if ( GetObjProperty(who, "#medding") )
@@ -57,16 +54,21 @@
 	if ( who.squelched && !who.npctemplate )
 		SendSysMessage(who, "Something prevents you from casting.");
 		FailSpell(who);
+		return 0;
 	elseif ( !ConsumeVital(who, MANA, mana_cost) )
 		SendSysMessage(who, "You are too tired to cast.");
 		FailSpell(who);
+		return 0;
 	elseif ( !CheckReagents(who, spell_elem, scroll) )
 		FailSpell(who);
+		return 0;
 	elseif ( !EquipmentCheck(who) )
 		FailSpell(who);
+		return 0;
 	elseif ( !CheckDelay(who, attribute, difficulty, delay) )
 		FailSpell(who);
-		SendSysMessage(who, "You break your concentration.");
+		SendSysMessage(who, "Your concentration has been broken.");
+		return 0;
 	else
 		var skill_check := SkillCheck(who, attribute, difficulty);
 		if ( skill_check > 0 )
@@ -80,8 +82,7 @@
 
 			var script := start_script(spell_elem.Script, {who, info});
 			if ( script.errortext )
-				PrintTextAbove(who, "Unable to start ["+spell_elem.script+"] -> "+script.errortext);
-				SendSysMessage(who, script.errortext);
+				SendSysMessage(who, "Unable to start ["+spell_elem.script+"] -> "+script.errortext);
 			endif
 
 			var ev;
@@ -174,29 +175,27 @@
 		return SubtractAmount(scroll, 1);
 	endif
 	
-	var reg_list := dictionary;
-
-	foreach line in GetConfigStringArray(spell_elem, "Reagent")
-		line := SplitWords(line);
-		var objtype := GetObjTypeByName(line[1]);
-		var amount := CInt(line[2]);
-
-		if ( reg_list[objtype] )
-			reg_list[objtype] := reg_list[objtype] + amount;
-		else
-			reg_list[objtype] := amount;
+	var reagent_costs := GetConfigStringDictionary(spell_elem, "RegCost");
+	
+	// Before consuming, verify that there is enough of everything.
+	foreach amount in ( reagent_costs )
+		amount := CInt(amount);
+		if ( !amount )
+			amount := 1;
 		endif
-
-		//if ( AmountInPack(who, objtype) < reg_list[objtype] )
-		//	SendSysMessage(who, "You do not have enough " + GetName(objtype, 1));
-		//	return 0;
-		//endif
-		sleepms(1);
+		var objtype := GetObjTypeByName(CInt(_amount_iter));
+		
+		if ( AmountInContainer(who.backpack, objtype) < amount )
+			SendSysMessage(who, "You do not have enough "+GetObjTypeDesc(objtype, (amount>1)));
+			return 0;
+		endif
+		sleepms(2);
 	endforeach
-
-	foreach key in (reg_list.keys())
-		ConsumeSubstance(who.backpack, key, reg_list[key]);
-		sleepms(1);
+	// Consume reagents - CInt() and < 1 checks already done in previous loop.
+	// Foreach is a pointer!
+	foreach amount in ( reagent_costs )
+		ConsumeSubstance(who.backpack, GetObjTypeByName(_amount_iter), amount);
+		sleepms(2);
 	endforeach
 
 	return 1;



From muaddiblsd at berlios.de  Sat Nov  5 08:46:45 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Sat, 5 Nov 2005 08:46:45 +0100
Subject: [Poldistro-svn] r902 - in trunk/096/pkg/packetHooks: PacketConfig/config RequestAttack StatHook WarAndPeace
Message-ID: <200511050746.jA57kjHS007582@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-05 08:46:41 +0100 (Sat, 05 Nov 2005)
New Revision: 902

Modified:
   trunk/096/pkg/packetHooks/PacketConfig/config/packetconfig.cfg
   trunk/096/pkg/packetHooks/RequestAttack/requestAttack.src
   trunk/096/pkg/packetHooks/StatHook/sendStats.src
   trunk/096/pkg/packetHooks/WarAndPeace/requestWar.src
Log:


Modified: trunk/096/pkg/packetHooks/PacketConfig/config/packetconfig.cfg
===================================================================
--- trunk/096/pkg/packetHooks/PacketConfig/config/packetconfig.cfg	2005-11-05 01:38:58 UTC (rev 901)
+++ trunk/096/pkg/packetHooks/PacketConfig/config/packetconfig.cfg	2005-11-05 07:46:41 UTC (rev 902)
@@ -8,4 +8,23 @@
 ConfigSet Target
 {
 	Enabled		1
+}
+
+ConfigSet RequestWar
+{
+	Enabled		1
+}
+
+# Mode:		0/3/4 = Mode type. 0 is Normal. 3 is Limited AOS, 4 is Full AOS.
+# Statlock:	0/1 1=Enabled. Send stat lock states with packet.
+ConfigSet StatusBar
+{
+	Enabled		1
+	Mode		0
+	Statlock	0
+}
+
+ConfigSet RequestAttack
+{
+	Enabled		1
 }
\ No newline at end of file

Modified: trunk/096/pkg/packetHooks/RequestAttack/requestAttack.src
===================================================================
--- trunk/096/pkg/packetHooks/RequestAttack/requestAttack.src	2005-11-05 01:38:58 UTC (rev 901)
+++ trunk/096/pkg/packetHooks/RequestAttack/requestAttack.src	2005-11-05 07:46:41 UTC (rev 902)
@@ -1,4 +1,4 @@
-/* $Id: requestAttack.src 677 2005-10-27 04:44:34Z muaddiblsd $
+/* $Id$
  *
  */
 ////////////////////////////////////////////////////////////////////////////////////////////////////
@@ -26,7 +26,6 @@
 
 
 exported function HandleAttackRequest( who, byref packet )
-
 	var defender := SystemFindObjectBySerial(packet.GetInt32(BYTE_DEFENDER));
 
 	if( distance(who, defender) >= 20 )
@@ -36,5 +35,4 @@
 	endif
 
 	return 0;
-
 endfunction
\ No newline at end of file

Modified: trunk/096/pkg/packetHooks/StatHook/sendStats.src
===================================================================
--- trunk/096/pkg/packetHooks/StatHook/sendStats.src	2005-11-05 01:38:58 UTC (rev 901)
+++ trunk/096/pkg/packetHooks/StatHook/sendStats.src	2005-11-05 07:46:41 UTC (rev 902)
@@ -16,10 +16,6 @@
 //            var STATCAP to be a variable if required for special rising stat cap systems.
 //
 // Const settings:
-// MODE      = 0 Ignore this, and send the packet unmodified for old style stats.
-//             3 Send simple AoS stats. Standard plus statcap, pet count, and pets max.
-//             4 All above, plus the elemental resists, luck, damage max/min, and thithing points.
-// STATLOCK:   0/1 Flagging. 1=Enabled. Send stat lock states with packet.
 // BIT_MASK  = 0x00000003 DO NOT CHANGE!
 //
 // Global Variables:
@@ -31,19 +27,27 @@
 
 include ":attributes:attributeConstants";
 include ":attributes:attributes";
+include ":config:config";
 
 program sendStats()
 	Print( "INSTALLING Outgoing Status PH..." );
 	return 1;
 endprogram
 
-CONST MODE     := 0;
-CONST STATLOCK := 1;
 CONST BIT_MASK := 0x00000003;
 
 var STATCAP := 225;
+var MODE    := 0;
+var STATLOCK:= 0;
 
 exported function HandleSendStats( character, byref packet )
+	var enabled := QueryConfigInt("Enabled", ":packetconfig:config/packetconfig", "StatusBar");
+	if( !enabled )
+		return 0;
+	endif
+	MODE := QueryConfigInt("Mode", ":packetconfig:config/packetconfig", "StatusBar");
+	STATLOCK := QueryConfigInt("Statlock", ":packetconfig:config/packetconfig", "StatusBar");
+
 	// Easiest method to decide which way to handle the packet. We could do this based on
 	// a Client version check too, but that would not be recommended since versions can be
 	// spoofed with software.

Modified: trunk/096/pkg/packetHooks/WarAndPeace/requestWar.src
===================================================================
--- trunk/096/pkg/packetHooks/WarAndPeace/requestWar.src	2005-11-05 01:38:58 UTC (rev 901)
+++ trunk/096/pkg/packetHooks/WarAndPeace/requestWar.src	2005-11-05 07:46:41 UTC (rev 902)
@@ -1,4 +1,4 @@
-/* $Id: requestWar.src 688 2005-10-28 13:04:01Z panosl $
+/* $Id$
  *
  */
 ////////////////////////////////////////////////////////////////////////////////////////////////////
@@ -19,8 +19,6 @@
 use uo;
 use polsys;
 
-include "include/client";
-
 CONST BYTE_FLAG := 1;
 
 program requestWar()
@@ -30,7 +28,6 @@
 
 
 exported function HandleWarRequest( who, byref packet )
-
 	// Let's see which mode the are requesting.
 	var flag := CInt(packet.GetInt8(BYTE_FLAG));
 	var allowWar := 1;



From muaddiblsd at berlios.de  Sat Nov  5 09:10:33 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Sat, 5 Nov 2005 09:10:33 +0100
Subject: [Poldistro-svn] r903 - in trunk/096: pkg/utils pkg/utils/itemUtils pkg/utils/itemUtils/config pkg/utils/itemUtils/include scripts/include scripts/include/OLD
Message-ID: <200511050810.jA58AXOt032138@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-05 09:10:21 +0100 (Sat, 05 Nov 2005)
New Revision: 903

Added:
   trunk/096/pkg/utils/itemUtils/
   trunk/096/pkg/utils/itemUtils/config/
   trunk/096/pkg/utils/itemUtils/config/icp.cfg
   trunk/096/pkg/utils/itemUtils/include/
   trunk/096/pkg/utils/itemUtils/include/canAccess.inc
   trunk/096/pkg/utils/itemUtils/include/dist.inc
   trunk/096/pkg/utils/itemUtils/include/fields.inc
   trunk/096/pkg/utils/itemUtils/include/itemdesc.inc
   trunk/096/pkg/utils/itemUtils/include/myUtil.inc
   trunk/096/pkg/utils/itemUtils/include/objtype.inc
   trunk/096/pkg/utils/itemUtils/include/toolWear.inc
   trunk/096/pkg/utils/itemUtils/include/utility.inc
   trunk/096/pkg/utils/itemUtils/pkg.cfg
Removed:
   trunk/096/scripts/include/OLD/canAccess.inc
   trunk/096/scripts/include/OLD/dist.inc
   trunk/096/scripts/include/OLD/fields.inc
   trunk/096/scripts/include/OLD/myUtil.inc
   trunk/096/scripts/include/OLD/objtype.inc
   trunk/096/scripts/include/OLD/toolWear.inc
   trunk/096/scripts/include/OLD/utility.inc
   trunk/096/scripts/include/itemdesc.inc
Log:
Created a Item Utilities package. More can be moved, but just starting it to see how well it can be utilizied.

I'll fix all the shit it breaks moving the stuff tomorrow, to damn tired right now, and wanted to get it started.

Added: trunk/096/pkg/utils/itemUtils/config/icp.cfg
===================================================================
--- trunk/096/pkg/utils/itemUtils/config/icp.cfg	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/pkg/utils/itemUtils/config/icp.cfg	2005-11-05 08:10:21 UTC (rev 903)
@@ -0,0 +1,18 @@
+# $Id$
+#
+#
+ICP Register
+{
+	Name		Item Utilities
+	Version		1.0
+	Description	Various includes for item handling and checks.
+
+	Creator		Distro Team
+	C_Email		distro at polserver.com
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}


Property changes on: trunk/096/pkg/utils/itemUtils/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/itemUtils/include/canAccess.inc
===================================================================
--- trunk/096/pkg/utils/itemUtils/include/canAccess.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/pkg/utils/itemUtils/include/canAccess.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -0,0 +1,27 @@
+/* $Id$
+ *
+ */
+function can_access(who, item, flags := 0)
+ 	var owner := Cint(GetObjProperty(item, "Owner"));
+ 	if( (owner) and (owner != who.serial) )
+		SendSysMessage(who, "You cannot use that (1) " + item.desc);
+		return 0;
+	elseif(GetObjProperty(item, "Vendored"))
+		SendSysMessage(who, "You cannot use that (2) " + item.desc);
+		return 0;
+	elseif(!Accessible(who, item))
+		SendSysMessage(who, "You cannot use that (3) " + item.desc);
+		return 0;
+	elseif((!flags["distance"]) and ((Distance(who, item) > 2)))
+		SendSysMessage(who, "That item is too far away.");
+		return 0;
+	elseif((!flags["unmovable"]) and (item.movable == 0))
+		SendSysMessage(who, "You cannot use that while locked down.");
+		return 0;
+	elseif(!ReserveItem(item))
+		SendSysMessage(who, "That item is already in use.");
+		return 0;
+	else
+		return 1;
+	endif
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/utils/itemUtils/include/canAccess.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/itemUtils/include/dist.inc
===================================================================
--- trunk/096/pkg/utils/itemUtils/include/dist.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/pkg/utils/itemUtils/include/dist.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -0,0 +1,26 @@
+/* $Id$
+ *
+ */
+/*
+ *  dist( obj1, obj2 )
+ *      - returns the largest of the x-distance and y-distance
+ *        between two objects.
+ */
+
+use uo;
+
+function coordist( x1, y1, x2, y2 )
+	var xd := x1 - x2;
+	var yd := y1 - y2;
+	if (xd < 0)
+		xd := -xd;
+	endif
+	if (yd < 0)
+		yd := -yd;
+	endif
+	if (xd > yd)
+		return xd;
+	else
+		return yd;
+	endif
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/utils/itemUtils/include/dist.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/itemUtils/include/fields.inc
===================================================================
--- trunk/096/pkg/utils/itemUtils/include/fields.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/pkg/utils/itemUtils/include/fields.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -0,0 +1,72 @@
+/* $Id$
+ *
+ */
+function get_direction(who)
+ 	var ret;
+ 	if(who.facing in array(1, 3, 5, 7))
+ 		case (RandomInt(2))
+ 			0: ret := "NS"; break;
+ 			1: ret := "EW"; break;
+		endcase
+	else
+		case(who.facing)
+			2: ret := "EW"; break;
+			4: ret := "NS"; break;
+			6: ret := "EW"; break;
+			0: ret := "NS"; break;
+		endcase
+	endif
+	return ret;
+endfunction
+
+
+function CreateNorthSouthField(caster, fieldtype,x,y,z, length := 5)
+	var counter := 0;
+	var i;
+	var fires := { };
+	var tester := CreateItemAtLocation(x,y,z, 0xeed, 1, caster.realm);
+	for ( i := x - 2; i <= x - 2 + length; i := i + 1)
+		counter := counter  + 1;
+		if(fieldtype == 0x80)
+			if((CheckLosAt(tester, i, y, z )) && (len(ListMobilesNearLocation(i, y, z, 0, caster.realm)) == 0))
+				fires[counter] := CreateItemAtLocation( i, y, z, fieldtype, 1, caster.realm);
+				SetObjProperty(fires[counter], "f","1");
+				SetObjProperty(fires[counter], "creater", caster.serial);
+			endif
+		else
+			if(CheckLosAt(tester, i, y, z ))
+				fires[counter] := CreateItemAtLocation( i,y,z,fieldtype, 1, caster.realm );
+				SetObjProperty(fires[counter], "creater", caster.serial);
+				SetObjProperty(fires[counter], "f","1");
+			endif
+		endif
+	endfor
+	DestroyItem(tester);
+	return fires;
+endfunction
+
+
+function CreateEastWestField(caster, fieldtype,x,y,z, length)
+	var counter := 0;
+	var i;
+	var fires := { };
+	var tester := CreateItemAtLocation(x,y,z, 0xeed, 1, caster.realm);
+	for ( i := y - 2; i <= y - 2 + length; i := i + 1)
+		counter := counter  + 1;
+		if(fieldtype == 0x80)
+			if((CheckLosAt(tester, x, i, z )) && (len(ListMobilesNearLocation(x, i, z, 0, caster.realm)) == 0))
+				fires[counter] := CreateItemAtLocation( x,i,z,fieldtype, 1, caster.realm );
+				SetObjProperty(fires[counter], "f","1");
+				SetObjProperty(fires[counter], "creater", caster.serial);
+			endif
+		else
+			if(CheckLosAt(tester, x, i, z ))
+				fires[counter] := CreateItemAtLocation( x,i,z,fieldtype, 1, caster.realm );
+				SetObjProperty(fires[counter], "f","1");
+				SetObjProperty(fires[counter], "creater", caster.serial);
+			endif
+		endif
+	endfor
+	DestroyItem(tester);
+	return fires;
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/utils/itemUtils/include/fields.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/itemUtils/include/itemdesc.inc
===================================================================
--- trunk/096/pkg/utils/itemUtils/include/itemdesc.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/pkg/utils/itemUtils/include/itemdesc.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -0,0 +1,184 @@
+/* $Id$
+ *
+ */
+use uo;
+use os;
+use cfgfile;
+use polsys;
+
+
+/*
+ * LoadItemDescCfgFile(package)
+ *
+ * Purpose
+ * Retrieves an itemdesc.cfg from a package or all of them.
+ *
+ * Parameters
+ * package:	Package name (e.g. "alchemy")
+ *		Note:
+ *			"*" - Will retrieve all itemdesc.cfg files.
+ *			"" - Will retrieve pol/config/itemdesc.cfg.
+ *
+ * Return value
+ * Returns a config file on success
+ * Returns an error on failure.
+ *
+ */
+function GetItemDescCfgFile(package:="")
+	var file_name := ":"+package+":itemdesc";
+	var item_cfg := ReadConfigFile(file_name);
+	
+	if ( item_cfg.errortext )
+		return error{"errortext":="Unable to open ["+file_name+"] ->"+item_cfg.errortext};
+	endif
+	
+	return item_cfg;
+endfunction
+
+
+/*
+ * GetItemDescInfo(obj_type)
+ *
+ * Purpose
+ * Retrieves the itemdesc.cfg elem for an object type.
+ *
+ * Parameters
+ * obj_type:	Object type to get the config elem for.
+ *
+ * Return value
+ * Returns a config elem on success.
+ * Returns an error on failure.
+ *
+ */
+function GetItemDescInfo(obj_type)
+	var item_cfg := GetItemDescCfgFile("*");
+	return item_cfg[obj_type];
+endfunction
+
+
+/*
+ * GetObjTypeGraphic(obj_type)
+ *
+ * Purpose
+ * Retrieves the proper graphic for an object type.
+ * For < 0x3FFF it will see if it has a graphic entry
+ * If it does not, it will return the object type (same thing as the graphic).
+ * 
+ * For > 0x3FFF it must contain a 'Graphic' entry to even start POL.
+ * 
+ * Parameters
+ * obj_type:	Object type to get the graphic for.
+ *
+ * Return value
+ * Returns an integer
+ *
+ */
+function GetObjTypeGraphic(obj_type)
+	obj_type := CInt(obj_type);
+	
+	var cfg_info := GetItemDescInfo(obj_type);
+	var graphic := CInt(cfg_info.Graphic);
+	if ( graphic )
+		return graphic;
+	else
+		return obj_type;
+	endif
+endfunction	
+
+
+/*
+ * GetObjTypeDesc(obj_type, plural)
+ *
+ * Purpose
+ * Retrieves the DESC entry from an itemdesc.cfg and parses it.
+ * e.g. bread loa%ves/f% could be "bread loaf" or "bread loaves"
+ * 
+ * Parameters
+ * objtype:	Object type (elem) to retrieve the description for.
+ * plural:	0 - Will parse the item description in singular form.
+ *		1 - Will parse the item in plural form.
+ *
+ * Return value
+ * Returns a string
+ *
+ */
+function GetObjTypeDesc(obj_type, plural:=0)
+	obj_type := CInt(obj_type);
+	
+	var cfg_info := GetItemDescInfo(obj_type);
+	if ( cfg_info.errortext )
+		return error{"errortext":="Object type not defined in any itemdesc.cfg"};
+	endif
+	
+	var name := "";
+	if ( cfg_info.Desc )
+		name := cfg_info.Desc;
+	elseif ( cfg_info.Name )
+		name := cfg_info.Name;
+	else
+		return error{"errortext":="Object type does not have a Name or Desc entry"};
+	endif
+
+	if ( !name["%"] ) // Plain desc line - easy enough to deal with.
+		if ( plural == 0 )
+			return name;
+		elseif ( name[Len(name)] in {"s"} )
+			return name;
+		elseif ( name[Len(name)] in {"h","j","x","z"} )
+			return name + "es";
+		else
+			return name + "s";
+		endif
+	endif
+
+	/* This section will deal with:
+	 	Bread Stick%s
+		Bread Loa%ves/f%
+		Lump%s% of Coal
+		Loa%ves/f% of Bread
+	*/
+	var first := Find(name, "%", 1);
+	var slash := Find(name, "/", first);
+	var second := Find(name, "%", first + 1);
+	
+	if ( slash && !second )
+		// Force-append a % if a '/' exists!
+		name := name + "%";
+		second := Len(name);
+	elseif ( !slash )
+		slash := second;
+	endif
+
+	// wwwww%xx[/yy]%[zzzzz]
+	// 12345678     9 01234
+	// 12345678 901 2 34567
+
+	var s_plur := name[first+1, slash-(first+1)];
+	var s_sing := "";
+	if ( slash != first )
+		s_sing := name[slash+1, second-(slash+1)];
+	endif
+
+	var s_first := name[1, first-1];
+	var s_middle := s_plur;
+	var s_last := "";
+	if ( len(name) > second )
+		s_last := name[second+1, len(name)-second];
+	endif
+
+	if ( plural == 0 )
+		s_middle := s_sing;
+	endif
+	
+	if ( !s_first )
+		s_first := "";
+	endif
+	if ( !s_middle )
+		s_middle := "";
+	endif
+	if ( !s_last )
+		s_last := "";
+	endif
+	
+	return s_first + s_middle + s_last;
+endfunction


Property changes on: trunk/096/pkg/utils/itemUtils/include/itemdesc.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/itemUtils/include/myUtil.inc
===================================================================
--- trunk/096/pkg/utils/itemUtils/include/myUtil.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/pkg/utils/itemUtils/include/myUtil.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -0,0 +1,92 @@
+/* $Id$
+ *
+ */
+use cfgfile;
+
+//returns all the items in container of objtype
+function EnumerateItemsInContainerOfObjtype(container, objtype)
+	var ret := { };
+        foreach item in EnumerateItemsInContainer(container)
+		if ( item.objtype == objtype )
+			ret.append(item);
+		endif
+	endforeach
+
+	return ret;
+endfunction
+
+
+//returns all the 'top-level' items in container
+function ListRootItemsInContainer(container)
+	var ret := { };
+        foreach item in EnumerateItemsInContainer(container)
+		if ( item.container == container )
+			ret.append(item);
+		endif
+	endforeach
+
+	return ret;
+endfunction
+
+
+//returns all the 'top-level' items in container of objtype
+function ListRootItemsInContainerOfObjtype(container, objtype)
+	var ret := { };
+        foreach item in EnumerateItemsInContainer(container)
+		if ( (item.container == container) && (item.objtype == objtype) )
+			ret.append(item);
+		endif
+	endforeach
+
+	return ret;
+endfunction
+
+
+function InInventory(inventory, it)
+	foreach item in EnumerateItemsInContainer(inventory)
+		if (item == it)
+			return 1;
+		endif
+	endforeach
+
+	return 0;
+endfunction
+
+
+function IsContainer( it )
+	if (it.objtype == 0x7057)
+		return 0;//trashcans don't count as containers
+		         // random note- huh? trashcans are 0x7007...
+	endif
+
+	var waslocked := it.locked;
+	it.locked := 1;
+	if (it.locked)
+		it.locked := waslocked;
+		return 1;
+	else
+		return 0;
+	endif
+endfunction
+
+
+function IsDungeon( x, y )
+	if ( (x >= 5120) && (x <= 6143) )
+		if ( (y >= 0) && (y <= 2303) )
+			return 1;
+		endif
+	endif
+
+	return 0;
+endfunction
+
+
+function NoTeleportZone( x, y )
+	if ( (x >= 5120) && (x <= 6143) )
+		if ( (y >= 2080) && (y <= 2303) )
+			return 1;
+		endif
+	endif
+
+	return 0;
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/utils/itemUtils/include/myUtil.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/itemUtils/include/objtype.inc
===================================================================
--- trunk/096/pkg/utils/itemUtils/include/objtype.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/pkg/utils/itemUtils/include/objtype.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -0,0 +1,220 @@
+/////////////////////////////////////////////////////////////////////////////
+//
+// include/objtype.inc - Object Type definitions
+//
+// TODO: consider moving these into include/client.inc
+//       or, moving CID_XX CONSTants in here
+//
+/////////////////////////////////////////////////////////////////////////////
+
+/////////////////////////////////////////////////////////////////////////////
+//
+// 0x0000 to 0x3FFF - "Standard" objects
+//
+/////////////////////////////////////////////////////////////////////////////
+
+CONST UOBJ_STONEWALL_NS := 0x005f;
+CONST UOBJ_STONEWALL_EW := 0x0060;
+CONST UOBJ_GUARDS       := 0xa340;
+CONST UOBJ_FISHSTEAK    := 0x097a;
+
+CONST UOBJ_BOX          := 0x09aa;
+
+CONST UOBJ_FISH_START   := 0x09cc;
+CONST UOBJ_FISH_END     := 0x09cf;
+
+CONST UOBJ_SFISH_START  := 0x0dd6;
+CONST UOBJ_SFISH_END    := 0x0dd9;
+
+CONST UOBJ_KINDLING     := 0x0de1;
+CONST UOBJ_CAMPFIRE     := 0x0de3;
+CONST UOBJ_EMBERS       := 0x0de9;
+CONST UOBJ_ASHES        := 0x0dea;
+
+CONST UOBJ_BANDAGE      := 0x0e21;
+CONST UOBJ_BLANK_SCROLL := 0x0e34;
+
+CONST UOBJ_BANKBOX      := 0x0e40;
+
+CONST UOBJ_DRUM         := 0x0e9c;
+CONST UOBJ_TAMB         := 0x0e9d;
+CONST UOBJ_HARP         := 0x0eb2;
+CONST UOBJ_LUTE         := 0x0eb3;
+
+CONST UOBJ_SPELLBOOK        := 0x0efa;
+
+CONST UOBJ_POISON_POTION    := 0x0f0a;
+CONST UOBJ_EMPTY_BOTTLE     := 0x0f0e;
+
+CONST UOBJ_GEM_START        := 0x0f0f;
+CONST UOBJ_GEM_END          := 0x0f30;
+
+CONST UOBJ_SHOVEL           := 0x0f39;
+
+CONST UOBJ_XBOW             := 0x0f4f;
+
+CONST UOBJ_BLUE_MOONGATE    := 0x0f6c;
+
+
+
+CONST UOBJ_CLAY             := 0xee19;
+CONST UOBJ_SAND             := 0xee18;
+
+
+
+
+CONST UOBJ_BLACK_PEARL      := 0x0f7a;
+CONST UOBJ_BLOOD_MOSS       := 0x0f7b;
+CONST UOBJ_BRIMSTONE        := 0x0f7f;
+CONST UOBJ_FERTILE_DIRT     := 0x0f81;
+CONST UOBJ_EXECUTIONERS_CAP := 0x0f83;
+CONST UOBJ_GARLIC           := 0x0f84;
+CONST UOBJ_GINSENG          := 0x0f85;
+CONST UOBJ_MANDRAKE_ROOT    := 0x0f86;
+CONST UOBJ_NIGHTSHADE       := 0x0f88;
+CONST UOBJ_OBSIDIAN         := 0x0f89;
+CONST UOBJ_PIG_IRON         := 0x0f8a;
+CONST UOBJ_SULFUROUS_ASH    := 0x0f8c; // CHECKME spelling
+CONST UOBJ_SPIDER_SILK      := 0x0f8d;
+CONST UOBJ_VOLCANIC_ASH     := 0x0f8f;
+
+CONST UOBJ_DEAD_WOOD    := 0x0f90;
+
+CONST UOBJ_CLOTH        := 0x0f95;
+CONST UOBJ_CLOTH_STARTS := 0x175d;
+CONST UOBJ_CLOTH_END    := 0x1768;
+CONST UOBJ_LOOM_START   := 0x105f;
+CONST UOBJ_LOOM_END     := 0x1066;
+CONST UOBJ_BOLT_START   := 0x0f95;
+CONST UOBJ_BOLT_END     := 0x0f9c;
+CONST UOBJ_THREAD_START := 0x0fa0;
+CONST UOBJ_THREAD_END   := 0x0fa1;
+CONST UOBJ_MUTLI_CLOTH  := 0x1766;
+CONST UOBJ_SEWING_KIT   := 0x0f9d;
+
+CONST UOBJ_ANVIL1       := 0x0faf;
+CONST UOBJ_ANVIL2       := 0x0fb0;
+CONST UOBJ_SMALL_FORGE  := 0xfb1;  // see also UOBJ_FORGE_START..UOBJ_FORGE_END
+CONST UOBJ_FORGE1       := 0x19a2;
+CONST UOBJ_FORGE2       := 0x19a6;
+CONST UOBJ_FORGE3       := 0x1982;
+CONST UOBJ_FORGE4       := 0x1996;
+CONST UOBJ_FORGE5       := 0x199a;
+CONST UOBJ_FORGE6       := 0x198e;
+CONST UOBJ_FORGE7       := 0x1992;
+CONST UOBJ_FORGE8       := 0x1986;
+CONST UOBJ_FORGE9       := 0x198a;
+
+CONST UOBJ_COPPER_KEY   := 0x100e;
+CONST UOBJ_GOLD_KEY     := 0x100f;
+CONST UOBJ_IRON_KEY     := 0x1010;
+CONST UOBJ_KEY_RING     := 0x1011;
+CONST UOBJ_MAGIC_KEY    := 0x1012;
+CONST UOBJ_RUSTY_IRON_KEY := 0x1013;
+
+CONST UOBJ_CLOCK   := 0x104c;
+CONST UOBJ_CLOCK_FRAME   := 0x104e;
+CONST UOBJ_CLOCK_PARTS   := 0x104f;
+CONST UOBJ_AXLE_AND_GEARS   := 0x1051;
+CONST UOBJ_GEARS   := 0x1053;
+CONST UOBJ_HINGE   := 0x1055;
+CONST UOBJ_SEXTANT   := 0x1057;
+CONST UOBJ_SEXTANT_PARTS   := 0x1059;
+CONST UOBJ_AXLE   := 0x105b;
+CONST UOBJ_SPRINGS   := 0x105d;
+
+CONST UOBJ_TDUMMYSWING_NS     := 0x1071;
+CONST UOBJ_TDUMMYFREEZE_NS    := 0x1070;
+CONST UOBJ_TDUMMYSWING_EW     := 0x1075;
+CONST UOBJ_TDUMMYFREEZE_EW    := 0x1074;
+
+CONST UOBJ_PDUMMYSWING_EW       := 0x1EC1;
+CONST UOBJ_PDUMMYFREEZE_EW      := 0x1EC0;
+CONST UOBJ_PDUMMYSWING_NS       := 0x1EC4;
+CONST UOBJ_PDUMMYFREEZE_NS      := 0x1EC3;
+
+CONST UOBJ_BLOOD        := 0x122d;
+
+CONST UOBJ_BOW          := 0x13b2;
+CONST UOBJ_HEAVY_XBOW   := 0x13fd;
+
+CONST UOBJ_MAP1         := 0x14eb;
+CONST UOBJ_MAP2         := 0x14ec;
+CONST UOBJ_ROLLED_MAP1  := 0x14ed;
+CONST UOBJ_ROLLED_MAP2  := 0x14ee;
+
+CONST UOBJ_HOUSE_DEED1  := 0x14ef;
+CONST UOBJ_SHIP_DEED1   := 0x14f1;
+CONST UOBJ_SHIP_DEED2   := 0x14f2;
+
+CONST UOBJ_CHEST        := 0x1940;
+
+CONST UOBJ_FORGE_START  := 0x197a;  // see also UOBJ_SMALL_FORGE
+CONST UOBJ_FORGE_END    := 0x19a9;
+
+CONST UOBJ_FEATHER      := 0x1bd1;
+CONST UOBJ_SHAFTS       := 0x1bd4;
+CONST UOBJ_LOGS         := 0x1bdd;
+
+CONST UOBJ_GLASS        := 0xee20;
+
+CONST UOBJ_ARM          := 0x1cec;
+CONST UOBJ_LEG          := 0x1ce2;
+CONST UOBJ_TRUNK        := 0x1cee;
+CONST UOBJ_HEART        := 0x1cef;
+CONST UOBJ_HEAD         := 0x1dae;
+
+CONST UOBJ_TINKER_TOOLS := 0x1ebc;
+
+
+CONST UOBJ_RUNE         := 0x1f14;
+
+CONST UOBJ_CORPSE       := 0x2006;
+
+CONST UOBJ_PARAFIELD_NS := 0x3967;
+CONST UOBJ_PARAFIELD_EW := 0x3979;
+CONST UOBJ_POISONFIELD_NS   := 0x3914;
+CONST UOBJ_POISONFIELD_EW   := 0x3920;
+CONST UOBJ_EFIELD_NS        := 0x3947;
+CONST UOBJ_EFIELD_EW        := 0x3956;
+
+CONST GID_PLANK_EXTENDED_FACING_WEST   := 0x3ed5;
+CONST GID_PLANK_RETRACTED_FACING_WEST  := 0x3eb1;
+CONST GID_PLANK_EXTENDED_FACING_EAST   := 0x3ed4;
+CONST GID_PLANK_RETRACTED_FACING_EAST  := 0x3eb2;
+CONST GID_PLANK_EXTENDED_FACING_SOUTH  := 0x3e84;
+CONST GID_PLANK_RETRACTED_FACING_SOUTH := 0x3e85;
+CONST GID_PLANK_EXTENDED_FACING_NORTH  := 0x3e89;
+CONST GID_PLANK_RETRACTED_FACING_NORTH := 0x3e8a;
+
+// ick! these are fine for humans, but not true for items..
+// these are more of a CID.
+CONST UOBJ_HUMAN_MALE   := 0x190;
+CONST UOBJ_HUMAN_FEMALE := 0x191;
+
+/////////////////////////////////////////////////////////////////////////////
+//
+// 0x4000 to 0x4FFF - Multis
+//
+/////////////////////////////////////////////////////////////////////////////
+
+/////////////////////////////////////////////////////////////////////////////
+//
+// 0x5000 to 0xEFFF - To Be Determined
+//
+/////////////////////////////////////////////////////////////////////////////
+
+
+/////////////////////////////////////////////////////////////////////////////
+//
+// 0xF000 to 0xFFFF - Reserved by system
+//
+/////////////////////////////////////////////////////////////////////////////
+
+        //
+        // Ship Components
+        //
+CONST EXTOBJ_TILLERMAN       := 0xf010;
+CONST EXTOBJ_PORT_PLANK      := 0xf011;
+CONST EXTOBJ_STARBOARD_PLANK := 0xf012;
+CONST EXTOBJ_HOLD            := 0xf013;


Property changes on: trunk/096/pkg/utils/itemUtils/include/objtype.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/itemUtils/include/toolWear.inc
===================================================================
--- trunk/096/pkg/utils/itemUtils/include/toolWear.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/pkg/utils/itemUtils/include/toolWear.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -0,0 +1,71 @@
+include ":attributes:attributes_ex";
+
+function CheckToolWear (who, tool, skillid)
+  var swings := GetObjProperty(tool,"swings");
+  if(!swings)
+    var mods := GetObjProperty(tool, "durability");
+    var bonus := 0;
+    case(mods)
+      "durable":        bonus := 10;
+      "substantial":    bonus := 20;
+      "massive":        bonus := 30;
+      "fortified":      bonus := 40;
+      "indestructable": bonus := 50;
+    endcase
+    swings := Cint(50 * tool.quality) + bonus;
+    SetObjProperty(tool,"swings", swings);
+  endif
+  if(swings <= 0)
+    DestroyItem(tool);
+    SendSysMessage(who,"Your tool broke.");
+  else
+    var skill := GetAttribute(who, AP_SkillIdToAttributeName(skillid));
+    if(skill > 80)
+      skill := 80;
+    elseif(skill < 20)
+      skill := 20;
+    endif
+    if((RandomInt(100)+1) > skill)
+      if(tool.isa(POLCLASS_WEAPON))
+        if(tool.hp > 1)
+          SetObjProperty(tool,"swings", (swings - 1));
+          tool.hp := tool.hp - 1;
+        elseif((tool.hp > tool.maxhp) or (tool.hp == 1))
+          SendSysMessage(who,"Your tool broke.");
+          DestroyItem(tool);
+        endif
+      else
+        SetObjProperty(tool,"swings", (swings - 1));
+      endif   
+    endif
+  endif
+endfunction 
+
+function SetToolDurability(who, tool, skillid)
+
+  var toolfile := ReadConfigFile(":*:itemdesc");
+  var toolscript := toolfile[tool.objtype].Script;
+
+  if(!toolscript.errortext)
+    if(!tool.isA(POLCLASS_CONTAINER) && !tool.isA(POLCLASS_ARMOR))
+      var myskill := GetEffectiveSkill(who, skillid);
+      var swings := 0;
+      var mods := GetObjProperty(tool, "durability");
+      var bonus := 0;
+      case(mods)
+        "durable":        bonus := 10;
+        "substantial":    bonus := 20;
+        "massive":        bonus := 30;
+        "fortified":      bonus := 40;
+        "indestructable": bonus := 50;
+        default: bonus := 0;
+      endcase
+      swings := Cint(50 + myskill) + bonus;
+      SetObjProperty(tool, "swings", swings);
+      if(!tool.quality or tool.quality == error)
+        tool.quality := 1.0;
+      endif
+    endif
+  endif
+
+endfunction 


Property changes on: trunk/096/pkg/utils/itemUtils/include/toolWear.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/itemUtils/include/utility.inc
===================================================================
--- trunk/096/pkg/utils/itemUtils/include/utility.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/pkg/utils/itemUtils/include/utility.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -0,0 +1,53 @@
+/* $Id$
+ *
+ */
+use basic;
+
+include "include/myUtil";
+
+
+function find_or_create_storage( areaname )
+	var area;
+	area := FindStorageArea( areaname );
+	if(!area)
+		area := CreateStorageArea( areaname );
+	endif
+	return area;
+endfunction
+
+
+function find_or_create_item(storage, name, objtype := 0x966a)
+	var item := FindRootItemInStorageArea(storage, name);
+	if(item)
+		return item;
+	endif
+	item := CreateRootItemInStorageArea( storage, name, objtype);
+	return item;
+endfunction
+
+
+function IsLocationAccessible(character, x, y, z)
+	var xd, yd, zd;
+	xd := character.x - x;
+	if(xd < -1 || xd > 1)
+		return 0;
+	endif
+	yd := character.y - y;
+	if(yd < -1 || yd > 1)
+		return 0;
+	endif
+	zd := character.z - z;
+	if(zd < -10 || zd > 10)
+		return 0;
+	endif
+	return CheckLosAt( character, x, y, z );
+endfunction
+
+
+function min(x, y)
+	if(x<= y)
+		return x;
+	else
+		return y;
+	endif
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/utils/itemUtils/include/utility.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/itemUtils/pkg.cfg
===================================================================
--- trunk/096/pkg/utils/itemUtils/pkg.cfg	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/pkg/utils/itemUtils/pkg.cfg	2005-11-05 08:10:21 UTC (rev 903)
@@ -0,0 +1,14 @@
+# $Id$
+#
+#
+Enabled		1
+Name		itemutils
+Version		1.0
+
+CoreRequired	92
+
+Maintainer	Distro Team
+Email		distro at polserver.com
+
+#Requires none
+#conflicts	none


Property changes on: trunk/096/pkg/utils/itemUtils/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/096/scripts/include/OLD/canAccess.inc
===================================================================
--- trunk/096/scripts/include/OLD/canAccess.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/scripts/include/OLD/canAccess.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -1,25 +0,0 @@
-
-function can_access(who, item, flags := 0)
-  var owner := Cint(GetObjProperty(item, "Owner"));
-  if((owner) and (owner != who.serial))
-    SendSysMessage(who, "You cannot use that (1) " + item.desc);
-    return 0;
-  elseif(GetObjProperty(item, "Vendored"))
-    SendSysMessage(who, "You cannot use that (2) " + item.desc);
-    return 0;
-  elseif(!Accessible(who, item))
-    SendSysMessage(who, "You cannot use that (3) " + item.desc);
-    return 0;
-  elseif((!flags["distance"]) and ((Distance(who, item) > 2)))
-    SendSysMessage(who, "That item is too far away.");
-    return 0;
-  elseif((!flags["unmovable"]) and (item.movable == 0))
-    SendSysMessage(who, "You cannot use that while locked down.");
-    return 0;
-  elseif(!ReserveItem(item))
-    SendSysMessage(who, "That item is already in use.");
-    return 0;
-  else
-    return 1;
-  endif
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/OLD/dist.inc
===================================================================
--- trunk/096/scripts/include/OLD/dist.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/scripts/include/OLD/dist.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -1,52 +0,0 @@
-/*
- *  dist( obj1, obj2 )
- *      - returns the largest of the x-distance and y-distance 
- *        between two objects.
- */
-
-use uo;
-
-function dist( obj1, obj2 )
-    return Distance( obj1, obj2 );
-
-            /* implements:
-                while (obj1.container)
-                    obj1 := obj1.container;
-                endwhile
-    
-                while (obj2.container)
-                    obj2 := obj2.container;
-                endwhile
-
-                var xd := obj1.x - obj2.x;
-                var yd := obj1.y - obj2.y;
-                if (xd < 0)
-                    xd := -xd;
-                endif
-                if (yd < 0)
-                    yd := -yd;
-                endif
-                if (xd > yd)
-                    return xd;
-                else
-                    return yd;
-                endif
-            */
-endfunction
-
-function coordist( x1, y1, x2, y2 )
-
-   var xd := x1 - x2;
-   var yd := y1 - y2;
-   if (xd < 0)
-      xd := -xd;
-   endif
-   if (yd < 0)
-      yd := -yd;
-   endif
-   if (xd > yd)
-      return xd;
-   else
-     return yd;
-   endif
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/OLD/fields.inc
===================================================================
--- trunk/096/scripts/include/OLD/fields.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/scripts/include/OLD/fields.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -1,67 +0,0 @@
-function get_direction(who)
-  var ret;
-  if(who.facing in array(1, 3, 5, 7))
-    case (RandomInt(2))
-      0: ret := "NS";
-      1: ret := "EW";
-	endcase
-  else
-    case(who.facing)
-      2: ret := "EW";
-      4: ret := "NS";
-      6: ret := "EW";
-      0: ret := "NS";
-    endcase
-  endif
-  return ret;
-endfunction
-
-function CreateNorthSouthField(caster, fieldtype,x,y,z, length := 5)
-  var counter := 0;
-  var i;
-  var fires := { };
-  var tester := CreateItemAtLocation(x,y,z, 0xeed, 1, caster.realm);
-  for ( i := x - 2; i <= x - 2 + length; i := i + 1)
-    counter := counter  + 1;
-    if(fieldtype == 0x80)
-      if((CheckLosAt(tester, i, y, z )) and (len(ListMobilesNearLocation(i, y, z, 0, caster.realm)) == 0))
-        fires[counter] := CreateItemAtLocation( i, y, z, fieldtype, 1, caster.realm);
-        SetObjProperty(fires[counter], "f","1");
-        SetObjProperty(fires[counter], "creater", caster.serial);
-      endif
-    else
-      if(CheckLosAt(tester, i, y, z ))
-        fires[counter] := CreateItemAtLocation( i,y,z,fieldtype, 1, caster.realm );
-        SetObjProperty(fires[counter], "creater", caster.serial);
-        SetObjProperty(fires[counter], "f","1");
-      endif
-    endif
-  endfor
-  DestroyItem(tester);
-  return fires;
-endfunction
-
-function CreateEastWestField(caster, fieldtype,x,y,z, length)
-  var counter := 0;
-  var i;
-  var fires := { };
-  var tester := CreateItemAtLocation(x,y,z, 0xeed, 1, caster.realm);
-  for ( i := y - 2; i <= y - 2 + length; i := i + 1)
-    counter := counter  + 1;
-    if(fieldtype == 0x80)
-      if((CheckLosAt(tester, x, i, z )) and (len(ListMobilesNearLocation(x, i, z, 0, caster.realm)) == 0))
-        fires[counter] := CreateItemAtLocation( x,i,z,fieldtype, 1, caster.realm );
-        SetObjProperty(fires[counter], "f","1");
-        SetObjProperty(fires[counter], "creater", caster.serial);
-      endif
-    else
-      if(CheckLosAt(tester, x, i, z ))
-        fires[counter] := CreateItemAtLocation( x,i,z,fieldtype, 1, caster.realm );
-        SetObjProperty(fires[counter], "f","1");
-        SetObjProperty(fires[counter], "creater", caster.serial);
-      endif
-    endif
-  endfor
-  DestroyItem(tester);
-  return fires;
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/OLD/myUtil.inc
===================================================================
--- trunk/096/scripts/include/OLD/myUtil.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/scripts/include/OLD/myUtil.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -1,97 +0,0 @@
-use cfgfile;
-
-//returns all the items in container of objtype
-function EnumerateItemsInContainerOfObjtype(container, objtype)
-
-	var ret := { };
-        foreach item in EnumerateItemsInContainer(container)
-		if ( item.objtype == objtype )
-			ret.append(item);
-		endif
-	endforeach
-
-	return ret;
-
-endfunction
-
-//returns all the 'top-level' items in container
-function ListRootItemsInContainer(container)
-
-	var ret := { };
-        foreach item in EnumerateItemsInContainer(container)
-		if ( item.container == container )
-			ret.append(item);
-		endif
-	endforeach
-
-	return ret;
-
-endfunction
-
-//returns all the 'top-level' items in container of objtype
-function ListRootItemsInContainerOfObjtype(container, objtype)
-
-	var ret := { };
-        foreach item in EnumerateItemsInContainer(container)
-		if ( (item.container == container) && (item.objtype == objtype) )
-			ret.append(item);
-		endif
-	endforeach
-
-	return ret;
-
-endfunction
-
-function InInventory(inventory, it)
-
-	foreach item in EnumerateItemsInContainer(inventory)
-		if (item == it)
-			return 1;
-		endif
-	endforeach
-
-	return 0;
-
-endfunction
-
-function IsContainer( it )
-
-	if (it.objtype == 0x7057)
-		return 0;//trashcans don't count as containers
-		         // random note- huh? trashcans are 0x7007...
-	endif
-
-	var waslocked := it.locked;
-	it.locked := 1;
-	if (it.locked)
-		it.locked := waslocked;
-		return 1;
-	else
-		return 0;
-	endif
-
-endfunction
-
-function IsDungeon( x, y )
-
-	if ( (x >= 5120) && (x <= 6143) )
-		if ( (y >= 0) && (y <= 2303) )
-			return 1;
-		endif
-	endif
-
-	return 0;
-
-endfunction
-
-function NoTeleportZone( x, y )
-
-	if ( (x >= 5120) && (x <= 6143) )
-		if ( (y >= 2080) && (y <= 2303) )
-			return 1;
-		endif
-	endif
-
-	return 0;
-
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/OLD/objtype.inc
===================================================================
--- trunk/096/scripts/include/OLD/objtype.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/scripts/include/OLD/objtype.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -1,220 +0,0 @@
-/////////////////////////////////////////////////////////////////////////////
-//
-// include/objtype.inc - Object Type definitions
-//
-// TODO: consider moving these into include/client.inc
-//       or, moving CID_XX CONSTants in here
-//
-/////////////////////////////////////////////////////////////////////////////
-
-/////////////////////////////////////////////////////////////////////////////
-//
-// 0x0000 to 0x3FFF - "Standard" objects
-//
-/////////////////////////////////////////////////////////////////////////////
-
-CONST UOBJ_STONEWALL_NS := 0x005f;
-CONST UOBJ_STONEWALL_EW := 0x0060;
-CONST UOBJ_GUARDS       := 0xa340;
-CONST UOBJ_FISHSTEAK    := 0x097a;
-
-CONST UOBJ_BOX          := 0x09aa;
-
-CONST UOBJ_FISH_START   := 0x09cc;
-CONST UOBJ_FISH_END     := 0x09cf;
-
-CONST UOBJ_SFISH_START  := 0x0dd6;
-CONST UOBJ_SFISH_END    := 0x0dd9;
-
-CONST UOBJ_KINDLING     := 0x0de1;
-CONST UOBJ_CAMPFIRE     := 0x0de3;
-CONST UOBJ_EMBERS       := 0x0de9;
-CONST UOBJ_ASHES        := 0x0dea;
-
-CONST UOBJ_BANDAGE      := 0x0e21;
-CONST UOBJ_BLANK_SCROLL := 0x0e34;
-
-CONST UOBJ_BANKBOX      := 0x0e40;
-
-CONST UOBJ_DRUM         := 0x0e9c;
-CONST UOBJ_TAMB         := 0x0e9d;
-CONST UOBJ_HARP         := 0x0eb2;
-CONST UOBJ_LUTE         := 0x0eb3;
-
-CONST UOBJ_SPELLBOOK        := 0x0efa;
-
-CONST UOBJ_POISON_POTION    := 0x0f0a;
-CONST UOBJ_EMPTY_BOTTLE     := 0x0f0e;
-
-CONST UOBJ_GEM_START        := 0x0f0f;
-CONST UOBJ_GEM_END          := 0x0f30;
-
-CONST UOBJ_SHOVEL           := 0x0f39;
-
-CONST UOBJ_XBOW             := 0x0f4f;
-
-CONST UOBJ_BLUE_MOONGATE    := 0x0f6c;
-
-
-
-CONST UOBJ_CLAY             := 0xee19;
-CONST UOBJ_SAND             := 0xee18;
-
-
-
-
-CONST UOBJ_BLACK_PEARL      := 0x0f7a;
-CONST UOBJ_BLOOD_MOSS       := 0x0f7b;
-CONST UOBJ_BRIMSTONE        := 0x0f7f;
-CONST UOBJ_FERTILE_DIRT     := 0x0f81;
-CONST UOBJ_EXECUTIONERS_CAP := 0x0f83;
-CONST UOBJ_GARLIC           := 0x0f84;
-CONST UOBJ_GINSENG          := 0x0f85;
-CONST UOBJ_MANDRAKE_ROOT    := 0x0f86;
-CONST UOBJ_NIGHTSHADE       := 0x0f88;
-CONST UOBJ_OBSIDIAN         := 0x0f89;
-CONST UOBJ_PIG_IRON         := 0x0f8a;
-CONST UOBJ_SULFUROUS_ASH    := 0x0f8c; // CHECKME spelling
-CONST UOBJ_SPIDER_SILK      := 0x0f8d;
-CONST UOBJ_VOLCANIC_ASH     := 0x0f8f;
-
-CONST UOBJ_DEAD_WOOD    := 0x0f90;
-
-CONST UOBJ_CLOTH        := 0x0f95;
-CONST UOBJ_CLOTH_STARTS := 0x175d;
-CONST UOBJ_CLOTH_END    := 0x1768;
-CONST UOBJ_LOOM_START   := 0x105f;
-CONST UOBJ_LOOM_END     := 0x1066;
-CONST UOBJ_BOLT_START   := 0x0f95;
-CONST UOBJ_BOLT_END     := 0x0f9c;
-CONST UOBJ_THREAD_START := 0x0fa0;
-CONST UOBJ_THREAD_END   := 0x0fa1;
-CONST UOBJ_MUTLI_CLOTH  := 0x1766;
-CONST UOBJ_SEWING_KIT   := 0x0f9d;
-
-CONST UOBJ_ANVIL1       := 0x0faf;
-CONST UOBJ_ANVIL2       := 0x0fb0;
-CONST UOBJ_SMALL_FORGE  := 0xfb1;  // see also UOBJ_FORGE_START..UOBJ_FORGE_END
-CONST UOBJ_FORGE1       := 0x19a2;
-CONST UOBJ_FORGE2       := 0x19a6;
-CONST UOBJ_FORGE3       := 0x1982;
-CONST UOBJ_FORGE4       := 0x1996;
-CONST UOBJ_FORGE5       := 0x199a;
-CONST UOBJ_FORGE6       := 0x198e;
-CONST UOBJ_FORGE7       := 0x1992;
-CONST UOBJ_FORGE8       := 0x1986;
-CONST UOBJ_FORGE9       := 0x198a;
-
-CONST UOBJ_COPPER_KEY   := 0x100e;
-CONST UOBJ_GOLD_KEY     := 0x100f;
-CONST UOBJ_IRON_KEY     := 0x1010;
-CONST UOBJ_KEY_RING     := 0x1011;
-CONST UOBJ_MAGIC_KEY    := 0x1012;
-CONST UOBJ_RUSTY_IRON_KEY := 0x1013;
-
-CONST UOBJ_CLOCK   := 0x104c;
-CONST UOBJ_CLOCK_FRAME   := 0x104e;
-CONST UOBJ_CLOCK_PARTS   := 0x104f;
-CONST UOBJ_AXLE_AND_GEARS   := 0x1051;
-CONST UOBJ_GEARS   := 0x1053;
-CONST UOBJ_HINGE   := 0x1055;
-CONST UOBJ_SEXTANT   := 0x1057;
-CONST UOBJ_SEXTANT_PARTS   := 0x1059;
-CONST UOBJ_AXLE   := 0x105b;
-CONST UOBJ_SPRINGS   := 0x105d;
-
-CONST UOBJ_TDUMMYSWING_NS     := 0x1071;
-CONST UOBJ_TDUMMYFREEZE_NS    := 0x1070;
-CONST UOBJ_TDUMMYSWING_EW     := 0x1075;
-CONST UOBJ_TDUMMYFREEZE_EW    := 0x1074;
-
-CONST UOBJ_PDUMMYSWING_EW       := 0x1EC1;
-CONST UOBJ_PDUMMYFREEZE_EW      := 0x1EC0;
-CONST UOBJ_PDUMMYSWING_NS       := 0x1EC4;
-CONST UOBJ_PDUMMYFREEZE_NS      := 0x1EC3;
-
-CONST UOBJ_BLOOD        := 0x122d;
-
-CONST UOBJ_BOW          := 0x13b2;
-CONST UOBJ_HEAVY_XBOW   := 0x13fd;
-
-CONST UOBJ_MAP1         := 0x14eb;
-CONST UOBJ_MAP2         := 0x14ec;
-CONST UOBJ_ROLLED_MAP1  := 0x14ed;
-CONST UOBJ_ROLLED_MAP2  := 0x14ee;
-
-CONST UOBJ_HOUSE_DEED1  := 0x14ef;
-CONST UOBJ_SHIP_DEED1   := 0x14f1;
-CONST UOBJ_SHIP_DEED2   := 0x14f2;
-
-CONST UOBJ_CHEST        := 0x1940;
-
-CONST UOBJ_FORGE_START  := 0x197a;  // see also UOBJ_SMALL_FORGE
-CONST UOBJ_FORGE_END    := 0x19a9;
-
-CONST UOBJ_FEATHER      := 0x1bd1;
-CONST UOBJ_SHAFTS       := 0x1bd4;
-CONST UOBJ_LOGS         := 0x1bdd;
-
-CONST UOBJ_GLASS        := 0xee20;
-
-CONST UOBJ_ARM          := 0x1cec;
-CONST UOBJ_LEG          := 0x1ce2;
-CONST UOBJ_TRUNK        := 0x1cee;
-CONST UOBJ_HEART        := 0x1cef;
-CONST UOBJ_HEAD         := 0x1dae;
-
-CONST UOBJ_TINKER_TOOLS := 0x1ebc;
-
-
-CONST UOBJ_RUNE         := 0x1f14;
-
-CONST UOBJ_CORPSE       := 0x2006;
-
-CONST UOBJ_PARAFIELD_NS := 0x3967;
-CONST UOBJ_PARAFIELD_EW := 0x3979;
-CONST UOBJ_POISONFIELD_NS   := 0x3914;
-CONST UOBJ_POISONFIELD_EW   := 0x3920;
-CONST UOBJ_EFIELD_NS        := 0x3947;
-CONST UOBJ_EFIELD_EW        := 0x3956;
-
-CONST GID_PLANK_EXTENDED_FACING_WEST   := 0x3ed5;
-CONST GID_PLANK_RETRACTED_FACING_WEST  := 0x3eb1;
-CONST GID_PLANK_EXTENDED_FACING_EAST   := 0x3ed4;
-CONST GID_PLANK_RETRACTED_FACING_EAST  := 0x3eb2;
-CONST GID_PLANK_EXTENDED_FACING_SOUTH  := 0x3e84;
-CONST GID_PLANK_RETRACTED_FACING_SOUTH := 0x3e85;
-CONST GID_PLANK_EXTENDED_FACING_NORTH  := 0x3e89;
-CONST GID_PLANK_RETRACTED_FACING_NORTH := 0x3e8a;
-
-// ick! these are fine for humans, but not true for items..
-// these are more of a CID.
-CONST UOBJ_HUMAN_MALE   := 0x190;
-CONST UOBJ_HUMAN_FEMALE := 0x191;
-
-/////////////////////////////////////////////////////////////////////////////
-//
-// 0x4000 to 0x4FFF - Multis
-//
-/////////////////////////////////////////////////////////////////////////////
-
-/////////////////////////////////////////////////////////////////////////////
-//
-// 0x5000 to 0xEFFF - To Be Determined
-//
-/////////////////////////////////////////////////////////////////////////////
-
-
-/////////////////////////////////////////////////////////////////////////////
-//
-// 0xF000 to 0xFFFF - Reserved by system
-//
-/////////////////////////////////////////////////////////////////////////////
-
-        //
-        // Ship Components
-        //
-CONST EXTOBJ_TILLERMAN       := 0xf010;
-CONST EXTOBJ_PORT_PLANK      := 0xf011;
-CONST EXTOBJ_STARBOARD_PLANK := 0xf012;
-CONST EXTOBJ_HOLD            := 0xf013;

Deleted: trunk/096/scripts/include/OLD/toolWear.inc
===================================================================
--- trunk/096/scripts/include/OLD/toolWear.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/scripts/include/OLD/toolWear.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -1,71 +0,0 @@
-include ":attributes:attributes_ex";
-
-function CheckToolWear (who, tool, skillid)
-  var swings := GetObjProperty(tool,"swings");
-  if(!swings)
-    var mods := GetObjProperty(tool, "durability");
-    var bonus := 0;
-    case(mods)
-      "durable":        bonus := 10;
-      "substantial":    bonus := 20;
-      "massive":        bonus := 30;
-      "fortified":      bonus := 40;
-      "indestructable": bonus := 50;
-    endcase
-    swings := Cint(50 * tool.quality) + bonus;
-    SetObjProperty(tool,"swings", swings);
-  endif
-  if(swings <= 0)
-    DestroyItem(tool);
-    SendSysMessage(who,"Your tool broke.");
-  else
-    var skill := GetAttribute(who, AP_SkillIdToAttributeName(skillid));
-    if(skill > 80)
-      skill := 80;
-    elseif(skill < 20)
-      skill := 20;
-    endif
-    if((RandomInt(100)+1) > skill)
-      if(tool.isa(POLCLASS_WEAPON))
-        if(tool.hp > 1)
-          SetObjProperty(tool,"swings", (swings - 1));
-          tool.hp := tool.hp - 1;
-        elseif((tool.hp > tool.maxhp) or (tool.hp == 1))
-          SendSysMessage(who,"Your tool broke.");
-          DestroyItem(tool);
-        endif
-      else
-        SetObjProperty(tool,"swings", (swings - 1));
-      endif   
-    endif
-  endif
-endfunction 
-
-function SetToolDurability(who, tool, skillid)
-
-  var toolfile := ReadConfigFile(":*:itemdesc");
-  var toolscript := toolfile[tool.objtype].Script;
-
-  if(!toolscript.errortext)
-    if(!tool.isA(POLCLASS_CONTAINER) && !tool.isA(POLCLASS_ARMOR))
-      var myskill := GetEffectiveSkill(who, skillid);
-      var swings := 0;
-      var mods := GetObjProperty(tool, "durability");
-      var bonus := 0;
-      case(mods)
-        "durable":        bonus := 10;
-        "substantial":    bonus := 20;
-        "massive":        bonus := 30;
-        "fortified":      bonus := 40;
-        "indestructable": bonus := 50;
-        default: bonus := 0;
-      endcase
-      swings := Cint(50 + myskill) + bonus;
-      SetObjProperty(tool, "swings", swings);
-      if(!tool.quality or tool.quality == error)
-        tool.quality := 1.0;
-      endif
-    endif
-  endif
-
-endfunction 

Deleted: trunk/096/scripts/include/OLD/utility.inc
===================================================================
--- trunk/096/scripts/include/OLD/utility.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/scripts/include/OLD/utility.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -1,49 +0,0 @@
-use basic;
-
-include "include/myUtil";
-
-
-function find_or_create_storage( areaname )
-  var area;
-  area := FindStorageArea( areaname );
-  if(!area)
-	area := CreateStorageArea( areaname );
-    if(area)
-    endif
-  endif
-  return area;
-endfunction
-
-function find_or_create_item(storage, name, objtype := 0x966a)
-  var item := FindRootItemInStorageArea(storage, name);
-  if(item)
-	return item;
-  endif
-  item := CreateRootItemInStorageArea( storage, name, objtype);
-  return item;
-endfunction
-
-function IsLocationAccessible(character, x, y, z)
-  var xd, yd, zd;
-  xd := character.x - x;
-  if(xd < -1 || xd > 1)
-    return 0;
-  endif
-  yd := character.y - y;
-  if(yd < -1 || yd > 1)
-    return 0;
-  endif
-  zd := character.z - z;
-  if(zd < -10 || zd > 10)
-    return 0;
-  endif
-  return CheckLosAt( character, x, y, z );
-endfunction
-
-function min(x, y)
-  if(x<= y)
-    return x;
-  else
-    return y;
-  endif
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/itemdesc.inc
===================================================================
--- trunk/096/scripts/include/itemdesc.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/scripts/include/itemdesc.inc	2005-11-05 08:10:21 UTC (rev 903)
@@ -1,184 +0,0 @@
-/* $Id$
- *
- */
-use uo;
-use os;
-use cfgfile;
-use polsys;
-
-
-/*
- * LoadItemDescCfgFile(package)
- *
- * Purpose
- * Retrieves an itemdesc.cfg from a package or all of them.
- *
- * Parameters
- * package:	Package name (e.g. "alchemy")
- *		Note:
- *			"*" - Will retrieve all itemdesc.cfg files.
- *			"" - Will retrieve pol/config/itemdesc.cfg.
- *
- * Return value
- * Returns a config file on success
- * Returns an error on failure.
- *
- */
-function GetItemDescCfgFile(package:="")
-	var file_name := ":"+package+":itemdesc";
-	var item_cfg := ReadConfigFile(file_name);
-	
-	if ( item_cfg.errortext )
-		return error{"errortext":="Unable to open ["+file_name+"] ->"+item_cfg.errortext};
-	endif
-	
-	return item_cfg;
-endfunction
-
-
-/*
- * GetItemDescInfo(obj_type)
- *
- * Purpose
- * Retrieves the itemdesc.cfg elem for an object type.
- *
- * Parameters
- * obj_type:	Object type to get the config elem for.
- *
- * Return value
- * Returns a config elem on success.
- * Returns an error on failure.
- *
- */
-function GetItemDescInfo(obj_type)
-	var item_cfg := GetItemDescCfgFile("*");
-	return item_cfg[obj_type];
-endfunction
-
-
-/*
- * GetObjTypeGraphic(obj_type)
- *
- * Purpose
- * Retrieves the proper graphic for an object type.
- * For < 0x3FFF it will see if it has a graphic entry
- * If it does not, it will return the object type (same thing as the graphic).
- * 
- * For > 0x3FFF it must contain a 'Graphic' entry to even start POL.
- * 
- * Parameters
- * obj_type:	Object type to get the graphic for.
- *
- * Return value
- * Returns an integer
- *
- */
-function GetObjTypeGraphic(obj_type)
-	obj_type := CInt(obj_type);
-	
-	var cfg_info := GetItemDescInfo(obj_type);
-	var graphic := CInt(cfg_info.Graphic);
-	if ( graphic )
-		return graphic;
-	else
-		return obj_type;
-	endif
-endfunction	
-
-
-/*
- * GetObjTypeDesc(obj_type, plural)
- *
- * Purpose
- * Retrieves the DESC entry from an itemdesc.cfg and parses it.
- * e.g. bread loa%ves/f% could be "bread loaf" or "bread loaves"
- * 
- * Parameters
- * objtype:	Object type (elem) to retrieve the description for.
- * plural:	0 - Will parse the item description in singular form.
- *		1 - Will parse the item in plural form.
- *
- * Return value
- * Returns a string
- *
- */
-function GetObjTypeDesc(obj_type, plural:=0)
-	obj_type := CInt(obj_type);
-	
-	var cfg_info := GetItemDescInfo(obj_type);
-	if ( cfg_info.errortext )
-		return error{"errortext":="Object type not defined in any itemdesc.cfg"};
-	endif
-	
-	var name := "";
-	if ( cfg_info.Desc )
-		name := cfg_info.Desc;
-	elseif ( cfg_info.Name )
-		name := cfg_info.Name;
-	else
-		return error{"errortext":="Object type does not have a Name or Desc entry"};
-	endif
-
-	if ( !name["%"] ) // Plain desc line - easy enough to deal with.
-		if ( plural == 0 )
-			return name;
-		elseif ( name[Len(name)] in {"s"} )
-			return name;
-		elseif ( name[Len(name)] in {"h","j","x","z"} )
-			return name + "es";
-		else
-			return name + "s";
-		endif
-	endif
-
-	/* This section will deal with:
-	 	Bread Stick%s
-		Bread Loa%ves/f%
-		Lump%s% of Coal
-		Loa%ves/f% of Bread
-	*/
-	var first := Find(name, "%", 1);
-	var slash := Find(name, "/", first);
-	var second := Find(name, "%", first + 1);
-	
-	if ( slash && !second )
-		// Force-append a % if a '/' exists!
-		name := name + "%";
-		second := Len(name);
-	elseif ( !slash )
-		slash := second;
-	endif
-
-	// wwwww%xx[/yy]%[zzzzz]
-	// 12345678     9 01234
-	// 12345678 901 2 34567
-
-	var s_plur := name[first+1, slash-(first+1)];
-	var s_sing := "";
-	if ( slash != first )
-		s_sing := name[slash+1, second-(slash+1)];
-	endif
-
-	var s_first := name[1, first-1];
-	var s_middle := s_plur;
-	var s_last := "";
-	if ( len(name) > second )
-		s_last := name[second+1, len(name)-second];
-	endif
-
-	if ( plural == 0 )
-		s_middle := s_sing;
-	endif
-	
-	if ( !s_first )
-		s_first := "";
-	endif
-	if ( !s_middle )
-		s_middle := "";
-	endif
-	if ( !s_last )
-		s_last := "";
-	endif
-	
-	return s_first + s_middle + s_last;
-endfunction



From muaddiblsd at berlios.de  Sat Nov  5 09:17:34 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Sat, 5 Nov 2005 09:17:34 +0100
Subject: [Poldistro-svn] r904 - in trunk/096: pkg/commands/seer pkg/commands/test pkg/items/doors pkg/items/runebook pkg/items/treasuremap pkg/mobiles/npcutils pkg/mobiles/oldAI pkg/skills/alchemy pkg/skills/begging pkg/skills/camping pkg/skills/carpentry pkg/skills/fishing pkg/skills/inscription pkg/skills/lockpicking pkg/skills/magery/OLD pkg/skills/mining pkg/skills/tailoring pkg/skills/tinkering pkg/systems/boat pkg/systems/combat/old pkg/systems/combat/useScripts pkg/systems/housing scripts/include/OLD scripts/items scripts/util
Message-ID: <200511050817.jA58HYfw032760@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-05 09:17:13 +0100 (Sat, 05 Nov 2005)
New Revision: 904

Modified:
   trunk/096/pkg/commands/seer/mark.src
   trunk/096/pkg/commands/seer/recall.src
   trunk/096/pkg/commands/test/makemap.src
   trunk/096/pkg/items/doors/doors.inc
   trunk/096/pkg/items/runebook/customSpells.inc
   trunk/096/pkg/items/treasuremap/decodeMap.src
   trunk/096/pkg/mobiles/npcutils/NPCBackpacks.inc
   trunk/096/pkg/mobiles/oldAI/animal.src
   trunk/096/pkg/mobiles/oldAI/barker.src
   trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
   trunk/096/pkg/mobiles/oldAI/cat.src
   trunk/096/pkg/mobiles/oldAI/chicken.src
   trunk/096/pkg/mobiles/oldAI/crier.src
   trunk/096/pkg/mobiles/oldAI/dumbKillPCs.src
   trunk/096/pkg/mobiles/oldAI/escortee.src
   trunk/096/pkg/mobiles/oldAI/firebreather.src
   trunk/096/pkg/mobiles/oldAI/goodCaster.src
   trunk/096/pkg/mobiles/oldAI/helpPCs.src
   trunk/096/pkg/mobiles/oldAI/immobile.src
   trunk/096/pkg/mobiles/oldAI/immobileSpell.src
   trunk/096/pkg/mobiles/oldAI/killAny.src
   trunk/096/pkg/mobiles/oldAI/killPCs.src
   trunk/096/pkg/mobiles/oldAI/meek.src
   trunk/096/pkg/mobiles/oldAI/packFirebreather.src
   trunk/096/pkg/mobiles/oldAI/poisonElemental.src
   trunk/096/pkg/mobiles/oldAI/poisonKillPCs.src
   trunk/096/pkg/mobiles/oldAI/slime.src
   trunk/096/pkg/mobiles/oldAI/spellFire.src
   trunk/096/pkg/mobiles/oldAI/spellKillPCs.src
   trunk/096/pkg/mobiles/oldAI/spiders.src
   trunk/096/pkg/mobiles/oldAI/townPerson.src
   trunk/096/pkg/mobiles/oldAI/undead.src
   trunk/096/pkg/mobiles/oldAI/undeadKillPCs.src
   trunk/096/pkg/mobiles/oldAI/vortexAI.src
   trunk/096/pkg/mobiles/oldAI/wolf.src
   trunk/096/pkg/mobiles/oldAI/worker.src
   trunk/096/pkg/skills/alchemy/potionKeg.src
   trunk/096/pkg/skills/begging/begging.src
   trunk/096/pkg/skills/camping/camping.src
   trunk/096/pkg/skills/carpentry/carpentryDeed.src
   trunk/096/pkg/skills/carpentry/loomDeed.src
   trunk/096/pkg/skills/carpentry/ovenDeed.src
   trunk/096/pkg/skills/fishing/fishing.src
   trunk/096/pkg/skills/fishing/fishnets.src
   trunk/096/pkg/skills/inscription/inscription.src
   trunk/096/pkg/skills/lockpicking/lockpicking.src
   trunk/096/pkg/skills/magery/OLD/energyField.src.temp
   trunk/096/pkg/skills/magery/OLD/gate.src.temp
   trunk/096/pkg/skills/magery/OLD/mark.src.temp
   trunk/096/pkg/skills/magery/OLD/pField.src.temp
   trunk/096/pkg/skills/magery/OLD/paraField.src.temp
   trunk/096/pkg/skills/magery/OLD/poisonField.src.temp
   trunk/096/pkg/skills/magery/OLD/recall.src.temp
   trunk/096/pkg/skills/mining/mining.src
   trunk/096/pkg/skills/mining/smelting.src
   trunk/096/pkg/skills/tailoring/makeClothItems.src
   trunk/096/pkg/skills/tailoring/scissors.src
   trunk/096/pkg/skills/tailoring/spinning.src
   trunk/096/pkg/skills/tailoring/tailor.src
   trunk/096/pkg/skills/tailoring/tailoring.src
   trunk/096/pkg/skills/tinkering/tinkering.src
   trunk/096/pkg/systems/boat/plank.src
   trunk/096/pkg/systems/boat/plankControl.src
   trunk/096/pkg/systems/boat/plankUtil.inc
   trunk/096/pkg/systems/boat/plankWalk.src
   trunk/096/pkg/systems/boat/shipDeed.src
   trunk/096/pkg/systems/boat/tillerman.src
   trunk/096/pkg/systems/combat/old/bladed.src
   trunk/096/pkg/systems/combat/useScripts/bladed.src
   trunk/096/pkg/systems/housing/houseDeed.src
   trunk/096/pkg/systems/housing/signControl.src
   trunk/096/scripts/include/OLD/spellRestrictions.inc
   trunk/096/scripts/items/key.src
   trunk/096/scripts/util/key.inc
Log:
Updated for itemutils/include/objtype.inc

Modified: trunk/096/pkg/commands/seer/mark.src
===================================================================
--- trunk/096/pkg/commands/seer/mark.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/commands/seer/mark.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,9 +1,9 @@
 use uo;
 
-include "include/objtype";
+include ":itemutils:objtype";
 
 program cast_mark( caster )
-       
+
     SendSysMessage( caster, "Select a rune to mark." );
     var cast_on := Target( caster, TGTOPT_CHECK_LOS );
 
@@ -25,5 +25,5 @@
 	SendSysMessage( caster, "You marked: " +  caster.x + " " + caster.y + " " + caster.z );
 
     SetName(cast_on, "a Marked Recall Rune");
-   
+
 endprogram
\ No newline at end of file

Modified: trunk/096/pkg/commands/seer/recall.src
===================================================================
--- trunk/096/pkg/commands/seer/recall.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/commands/seer/recall.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 
-include "include/objtype";
+include ":itemutils:objtype";
 
 program textcmd_recall( caster )
 

Modified: trunk/096/pkg/commands/test/makemap.src
===================================================================
--- trunk/096/pkg/commands/test/makemap.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/commands/test/makemap.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,6 +1,6 @@
 use uo;
 
-include "include/objtype";
+include ":itemutils:objtype";
 
 var mapdefs := array(
 	array( "yew",    0x0ec, 0x2e5, 0x2fe, 0x4f5, 0xc8, 0xc8 ),

Modified: trunk/096/pkg/items/doors/doors.inc
===================================================================
--- trunk/096/pkg/items/doors/doors.inc	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/items/doors/doors.inc	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,5 +1,5 @@
 include "include/client";
-include "include/objtype";
+include ":itemutils:objtype";
 
 
 function IsLocked(me, door, options := "no", closed := "no")

Modified: trunk/096/pkg/items/runebook/customSpells.inc
===================================================================
--- trunk/096/pkg/items/runebook/customSpells.inc	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/items/runebook/customSpells.inc	2005-11-05 08:17:13 UTC (rev 904)
@@ -3,7 +3,7 @@
 
 include "include/client";
 include "include/sound";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/spellRestrictions";
 include ":attributes:attributes";
 

Modified: trunk/096/pkg/items/treasuremap/decodeMap.src
===================================================================
--- trunk/096/pkg/items/treasuremap/decodeMap.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/items/treasuremap/decodeMap.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -4,7 +4,7 @@
 
 include ":attributes:attributes";
 include "include/client";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/canAccess";
 
 program decode_map( who, map )

Modified: trunk/096/pkg/mobiles/npcutils/NPCBackpacks.inc
===================================================================
--- trunk/096/pkg/mobiles/npcutils/NPCBackpacks.inc	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/npcutils/NPCBackpacks.inc	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,4 +1,4 @@
-include "include/objtype";
+include ":itemutils:objtype";
 
 function OpenTamedStorageAreas()
   var bank := FindStorageArea("Tamed Storage");

Modified: trunk/096/pkg/mobiles/oldAI/animal.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/animal.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/animal.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -7,7 +7,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopAnimal";

Modified: trunk/096/pkg/mobiles/oldAI/barker.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/barker.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/barker.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -7,7 +7,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopBarker";

Modified: trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -8,7 +8,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include ":npcutils:anchors";
 include "include/dist";
 include ":oldAI:main/setup";

Modified: trunk/096/pkg/mobiles/oldAI/cat.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/cat.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/cat.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -7,7 +7,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopCat";

Modified: trunk/096/pkg/mobiles/oldAI/chicken.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/chicken.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/chicken.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -7,7 +7,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopChicken";

Modified: trunk/096/pkg/mobiles/oldAI/crier.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/crier.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/crier.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -9,7 +9,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopCrier";

Modified: trunk/096/pkg/mobiles/oldAI/dumbKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/dumbKillPCs.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/dumbKillPCs.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -8,7 +8,7 @@
 include ":npcutils:names";
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";

Modified: trunk/096/pkg/mobiles/oldAI/escortee.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -13,7 +13,7 @@
 include ":oldAI:combat/fight";
 include ":oldAI:main/loot";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include ":oldAI:main/sleepMode";
 include "include/skillLists";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/firebreather.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/firebreather.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/firebreather.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -9,7 +9,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";

Modified: trunk/096/pkg/mobiles/oldAI/goodCaster.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/goodCaster.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/goodCaster.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -7,7 +7,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include ":npcutils:speech";
 include "include/dist";
 include ":npcutils:NPCCast";

Modified: trunk/096/pkg/mobiles/oldAI/helpPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/helpPCs.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/helpPCs.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -8,7 +8,7 @@
 include ":npcutils:names";
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:speech";
 include ":npcutils:anchors";

Modified: trunk/096/pkg/mobiles/oldAI/immobile.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/immobile.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/immobile.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -8,7 +8,7 @@
 include ":npcutils:names";
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopImmobile";

Modified: trunk/096/pkg/mobiles/oldAI/immobileSpell.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/immobileSpell.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/immobileSpell.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -25,7 +25,7 @@
 include ":npcutils:names";
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopImmobile";

Modified: trunk/096/pkg/mobiles/oldAI/killAny.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/killAny.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/killAny.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -24,7 +24,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include ":npcutils:anchors";
 include "include/dist";
 include ":oldAI:main/mainLoopKillAny";

Modified: trunk/096/pkg/mobiles/oldAI/killPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/killPCs.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/killPCs.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -9,7 +9,7 @@
 include ":npcutils:names";
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";

Modified: trunk/096/pkg/mobiles/oldAI/meek.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/meek.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/meek.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -24,7 +24,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include ":npcutils:speech";
 include "include/dist";
 include ":npcutils:anchors";

Modified: trunk/096/pkg/mobiles/oldAI/packFirebreather.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/packFirebreather.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/packFirebreather.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -9,7 +9,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/packKillPCsLoop";

Modified: trunk/096/pkg/mobiles/oldAI/poisonElemental.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -9,7 +9,7 @@
 include ":npcutils:names";
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:NPCCast";
 include ":npcutils:anchors";

Modified: trunk/096/pkg/mobiles/oldAI/poisonKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/poisonKillPCs.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/poisonKillPCs.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -7,7 +7,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";

Modified: trunk/096/pkg/mobiles/oldAI/slime.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/slime.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/slime.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -7,7 +7,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";

Modified: trunk/096/pkg/mobiles/oldAI/spellFire.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/spellFire.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/spellFire.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -9,7 +9,7 @@
 include ":npcutils:names";
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:NPCCast";
 include ":npcutils:anchors";

Modified: trunk/096/pkg/mobiles/oldAI/spellKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/spellKillPCs.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/spellKillPCs.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -10,7 +10,7 @@
 include ":npcutils:names";
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:NPCCast";
 include ":npcutils:anchors";

Modified: trunk/096/pkg/mobiles/oldAI/spiders.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/spiders.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/spiders.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -7,7 +7,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";

Modified: trunk/096/pkg/mobiles/oldAI/townPerson.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -15,7 +15,7 @@
 include ":oldAI:main/loot";
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include ":oldAI:setup/setup";
 include ":oldAI:main/sleepMode";
 include "include/skillLists";

Modified: trunk/096/pkg/mobiles/oldAI/undead.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/undead.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/undead.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -9,7 +9,7 @@
 include ":npcutils:names";
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 

Modified: trunk/096/pkg/mobiles/oldAI/undeadKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/undeadKillPCs.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/undeadKillPCs.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -8,7 +8,7 @@
 include ":npcutils:names";
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";

Modified: trunk/096/pkg/mobiles/oldAI/vortexAI.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/vortexAI.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/vortexAI.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -8,7 +8,7 @@
 include "include/client";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:combat/vortexCombatEvent";

Modified: trunk/096/pkg/mobiles/oldAI/wolf.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/wolf.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/wolf.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -7,7 +7,7 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopWolf";

Modified: trunk/096/pkg/mobiles/oldAI/worker.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -15,7 +15,7 @@
 include ":oldAI:main/loot";
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
-include "include/objtype";
+include ":itemutils:objtype";
 include ":oldAI:main/sleepMode";
 include "include/skillLists";
 include ":begging:begging";

Modified: trunk/096/pkg/skills/alchemy/potionKeg.src
===================================================================
--- trunk/096/pkg/skills/alchemy/potionKeg.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/alchemy/potionKeg.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -3,7 +3,7 @@
 use util;
 use cfgfile;
 
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/canAccess";
 include "potionKegs";
 

Modified: trunk/096/pkg/skills/begging/begging.src
===================================================================
--- trunk/096/pkg/skills/begging/begging.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/begging/begging.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -13,7 +13,7 @@
 include ":attributes:skillCheck";
 include "include/mobileID";
 include "include/client";
-include "include/objtype";
+include ":itemutils:objtype";
 
 CONST MINKARMA := 4000;
 CONST MINFAME := 4000;

Modified: trunk/096/pkg/skills/camping/camping.src
===================================================================
--- trunk/096/pkg/skills/camping/camping.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/camping/camping.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -3,7 +3,7 @@
 include ":attributes:attributeConstants";
 include ":attributes:attributes";
 include ":attributes:skillCheck";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/canAccess";
 
 program UseWood( who, wood )

Modified: trunk/096/pkg/skills/carpentry/carpentryDeed.src
===================================================================
--- trunk/096/pkg/skills/carpentry/carpentryDeed.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/carpentry/carpentryDeed.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -6,7 +6,7 @@
 use cfgfile;
 
 include "util/key";
-include "include/objtype";
+include ":itemutils:objtype";
 include ":gumps:yesno";
 
 const UOBJECT_DOORS_START   := 0x0675;

Modified: trunk/096/pkg/skills/carpentry/loomDeed.src
===================================================================
--- trunk/096/pkg/skills/carpentry/loomDeed.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/carpentry/loomDeed.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -6,7 +6,7 @@
 use cfgfile;
 
 include "util/key";
-include "include/objtype";
+include ":itemutils:objtype";
 include ":gumps:yesno";
 
 const UOBJECT_DOORS_START   := 0x0675;

Modified: trunk/096/pkg/skills/carpentry/ovenDeed.src
===================================================================
--- trunk/096/pkg/skills/carpentry/ovenDeed.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/carpentry/ovenDeed.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -6,7 +6,7 @@
 use cfgfile;
 
 include "util/key";
-include "include/objtype";
+include ":itemutils:objtype";
 include ":gumps:yesno";
 
 const UOBJECT_DOORS_START   := 0x0675;

Modified: trunk/096/pkg/skills/fishing/fishing.src
===================================================================
--- trunk/096/pkg/skills/fishing/fishing.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/fishing/fishing.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -11,7 +11,7 @@
 include ":attributes:include/attributeConstants";
 include ":attributes:include/attributes";
 include ":crafting:toolWear";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/startEqp";
 include "include/sysEvent";
 

Modified: trunk/096/pkg/skills/fishing/fishnets.src
===================================================================
--- trunk/096/pkg/skills/fishing/fishnets.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/fishing/fishnets.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -10,7 +10,7 @@
 include "fishingFunctions";
 include ":attributes:include/attributeConstants";
 include ":attributes:include/attributes";
-include "include/objtype";
+include ":itemutils:objtype";
 
 program use_FishNets(who, fishnet)
 

Modified: trunk/096/pkg/skills/inscription/inscription.src
===================================================================
--- trunk/096/pkg/skills/inscription/inscription.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/inscription/inscription.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,5 +1,5 @@
 include ":attributes:attributes";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/canAccess";
 include "include/noto";
 
@@ -47,7 +47,7 @@
         endif
       endforeach
     endif
-    
+
     if(!the_book)
       SendSysMessage(who, "You don't have a spellbook.");
       return;

Modified: trunk/096/pkg/skills/lockpicking/lockpicking.src
===================================================================
--- trunk/096/pkg/skills/lockpicking/lockpicking.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/lockpicking/lockpicking.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -4,7 +4,7 @@
 use util;
 
 include "include/dist";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/sound";
 include "include/startEqp";
 include "util/key";

Modified: trunk/096/pkg/skills/magery/OLD/energyField.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/energyField.src.temp	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/magery/OLD/energyField.src.temp	2005-11-05 08:17:13 UTC (rev 904)
@@ -4,7 +4,7 @@
 
 include "include/fields";
 include ":attributes:attributes";
-include "include/objtype";
+include ":itemutils:objtype";
 
 
 program spell_energyField( parms )

Modified: trunk/096/pkg/skills/magery/OLD/gate.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/gate.src.temp	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/magery/OLD/gate.src.temp	2005-11-05 08:17:13 UTC (rev 904)
@@ -2,7 +2,7 @@
 use uo;
 
 include "include/isValidLoc";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/client";
 include "include/sound";
 

Modified: trunk/096/pkg/skills/magery/OLD/mark.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/mark.src.temp	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/magery/OLD/mark.src.temp	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,7 +1,7 @@
 use uo;
 use util;
 
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/sound";
 include "include/tileEffects";
 

Modified: trunk/096/pkg/skills/magery/OLD/pField.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/pField.src.temp	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/magery/OLD/pField.src.temp	2005-11-05 08:17:13 UTC (rev 904)
@@ -3,7 +3,7 @@
 
 include "include/sound";
 include "include/tileEffects";
-include "include/objtype";
+include ":itemutils:objtype";
 
 
 program spell_pField(parms)

Modified: trunk/096/pkg/skills/magery/OLD/paraField.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/paraField.src.temp	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/magery/OLD/paraField.src.temp	2005-11-05 08:17:13 UTC (rev 904)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/fields";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/sound";
 include ":attributes:attributes";
 

Modified: trunk/096/pkg/skills/magery/OLD/poisonField.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/poisonField.src.temp	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/magery/OLD/poisonField.src.temp	2005-11-05 08:17:13 UTC (rev 904)
@@ -4,7 +4,7 @@
 
 include "include/fields";
 include ":attributes:attributes";
-include "include/objtype";
+include ":itemutils:objtype";
 
 
 program spell_poisonField( parms )

Modified: trunk/096/pkg/skills/magery/OLD/recall.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/recall.src.temp	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/magery/OLD/recall.src.temp	2005-11-05 08:17:13 UTC (rev 904)
@@ -3,7 +3,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/isValidLoc";
 
 

Modified: trunk/096/pkg/skills/mining/mining.src
===================================================================
--- trunk/096/pkg/skills/mining/mining.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/mining/mining.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -5,7 +5,7 @@
 include "include/client";
 include ":attributes:attributes";
 include "include/dist";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/startEqp";
 include "util/key";
 include "include/utility";

Modified: trunk/096/pkg/skills/mining/smelting.src
===================================================================
--- trunk/096/pkg/skills/mining/smelting.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/mining/smelting.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -2,7 +2,7 @@
 use os;
 
 include "include/client";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/canAccess";
 include ":attributes:attributes";
 

Modified: trunk/096/pkg/skills/tailoring/makeClothItems.src
===================================================================
--- trunk/096/pkg/skills/tailoring/makeClothItems.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/tailoring/makeClothItems.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -7,7 +7,7 @@
 include ":attributes:attributes";
 include "include/dist";
 include "include/client";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/canAccess";
 include "include/toolWear";
 include "include/noto";

Modified: trunk/096/pkg/skills/tailoring/scissors.src
===================================================================
--- trunk/096/pkg/skills/tailoring/scissors.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/tailoring/scissors.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,7 +1,7 @@
 use uo;
 use cfgfile;
 
-include "include/objtype";
+include ":itemutils:objtype";
 include ":attributes:attributes";
 include "include/client";
 include "include/canAccess";
@@ -68,7 +68,7 @@
       if(!material)
         SendSysMessage (who, "You can't use scissors on that.");
         return;
-      endif   
+      endif
     endif
     PlaySoundEffect(who, 0x0249);
     amt := CInt((material * AP_GetSkill(who,TAILORING) * 75) / 10000);
@@ -86,5 +86,5 @@
       return;
     endif
   endif
-  
+
 endprogram

Modified: trunk/096/pkg/skills/tailoring/spinning.src
===================================================================
--- trunk/096/pkg/skills/tailoring/spinning.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/tailoring/spinning.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -2,7 +2,7 @@
 use os;
 
 include "include/client";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/canAccess";
 
 const uobj_wheel_start := 0x1015;

Modified: trunk/096/pkg/skills/tailoring/tailor.src
===================================================================
--- trunk/096/pkg/skills/tailoring/tailor.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/tailoring/tailor.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -2,7 +2,7 @@
 use os;
 
 include "include/client";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/canAccess";
 
 program use_yarn(who, yarn)

Modified: trunk/096/pkg/skills/tailoring/tailoring.src
===================================================================
--- trunk/096/pkg/skills/tailoring/tailoring.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/tailoring/tailoring.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -2,7 +2,7 @@
 use os;
 
 include "include/client";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/canAccess";
 
 program use_thread(who, thread)

Modified: trunk/096/pkg/skills/tinkering/tinkering.src
===================================================================
--- trunk/096/pkg/skills/tinkering/tinkering.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/skills/tinkering/tinkering.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -8,7 +8,7 @@
 include ":attributes:attributes";
 include "include/client";
 include "include/sound";
-include "include/objtype";
+include ":itemutils:objtype";
 include "util/key";
 include "include/canAccess";
 include "include/toolWear";

Modified: trunk/096/pkg/systems/boat/plank.src
===================================================================
--- trunk/096/pkg/systems/boat/plank.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/systems/boat/plank.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -2,7 +2,7 @@
 use uo;
 
 include "util/key";
-include "include/objtype";
+include ":itemutils:objtype";
 include "plankUtil";
 
 program useplank(mob, plank)
@@ -19,7 +19,7 @@
     // so he doesn't get the message every time he gets on and off the ship.
     if ( (decay - ReadGameClock() ) < 860000 )
           SendSysMessage(mob, "Your ship has been refreshed.");
-    endif    
+    endif
     SetObjProperty( tillerman, 	  "decay",      (ReadGameClock()+ 864000));
   endif
 endif

Modified: trunk/096/pkg/systems/boat/plankControl.src
===================================================================
--- trunk/096/pkg/systems/boat/plankControl.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/systems/boat/plankControl.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -8,7 +8,7 @@
 use os;
 use uo;
 
-include "include/objtype";
+include ":itemutils:objtype";
 include "plankUtil";
 
 set_debug(1);

Modified: trunk/096/pkg/systems/boat/plankUtil.inc
===================================================================
--- trunk/096/pkg/systems/boat/plankUtil.inc	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/systems/boat/plankUtil.inc	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,4 +1,4 @@
-include "include/objtype";
+include ":itemutils:objtype";
 
 const KEYSTART := 0x100e;
 const KEYEND := 0x1013;
@@ -6,7 +6,7 @@
 
 function IsExtended( plank )
   return plank.graphic in { GID_PLANK_EXTENDED_FACING_EAST, GID_PLANK_EXTENDED_FACING_WEST, GID_PLANK_EXTENDED_FACING_NORTH, GID_PLANK_EXTENDED_FACING_SOUTH };
-endfunction                          
+endfunction
 
 function IsPlankOccupied( plank )
   return ListMobilesNearLocation( plank.x, plank.y, plank.z, 0, plank.realm ).size();
@@ -66,7 +66,7 @@
 		endif
 	  endforeach
 	endif
-  endforeach			
+  endforeach
   return 0;
 endfunction
 

Modified: trunk/096/pkg/systems/boat/plankWalk.src
===================================================================
--- trunk/096/pkg/systems/boat/plankWalk.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/systems/boat/plankWalk.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -2,7 +2,7 @@
 use uo;
 
 include "include/client";
-include "include/objtype";
+include ":itemutils:objtype";
 include "util/key";
 include "plankUtil";
 

Modified: trunk/096/pkg/systems/boat/shipDeed.src
===================================================================
--- trunk/096/pkg/systems/boat/shipDeed.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/systems/boat/shipDeed.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -5,7 +5,7 @@
 use os;
 
 include "util/key";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/canAccess";
 
 program useshipdeed(who, deed)

Modified: trunk/096/pkg/systems/boat/tillerman.src
===================================================================
--- trunk/096/pkg/systems/boat/tillerman.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/systems/boat/tillerman.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -2,7 +2,7 @@
 use uo;
 
 include "util/key";
-include "include/objtype";
+include ":itemutils:objtype";
 include "plankUtil";
 
 program renameboat(you, tillerman)

Modified: trunk/096/pkg/systems/combat/old/bladed.src
===================================================================
--- trunk/096/pkg/systems/combat/old/bladed.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/systems/combat/old/bladed.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,4 +1,4 @@
-// //$Id: bladed.src 806 2005-11-01 21:56:02Z austin $
+// //$Id$
 
 
 use cfgfile;
@@ -10,7 +10,7 @@
 include "include/sound";
 include ":attributes:attributes";
 include "include/string";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/canAccess";
 include "include/dist";
 include "include/toolWear";

Modified: trunk/096/pkg/systems/combat/useScripts/bladed.src
===================================================================
--- trunk/096/pkg/systems/combat/useScripts/bladed.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/systems/combat/useScripts/bladed.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,4 +1,4 @@
-// //$Id: bladed.src 806 2005-11-01 21:56:02Z austin $
+// //$Id$
 
 
 use cfgfile;
@@ -10,7 +10,7 @@
 include "include/sound";
 include ":attributes:attributes";
 include "include/string";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/canAccess";
 include "include/dist";
 include "include/toolWear";

Modified: trunk/096/pkg/systems/housing/houseDeed.src
===================================================================
--- trunk/096/pkg/systems/housing/houseDeed.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/systems/housing/houseDeed.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -4,7 +4,7 @@
 
 include "util/key";
 include ":containers:storageAreas";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/findCity";
 include "include/canAccess";
 include "include/isValidLoc";
@@ -156,8 +156,8 @@
   house.visible:=1;
   endif
 
- 
- 
+
+
   var result := struct;
   result.+packkey := packkey;
   result.+bankkey := bankkey;

Modified: trunk/096/pkg/systems/housing/signControl.src
===================================================================
--- trunk/096/pkg/systems/housing/signControl.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/pkg/systems/housing/signControl.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -5,7 +5,7 @@
 include "include/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
-include "include/objtype";
+include ":itemutils:objtype";
 
 program SignListener(sign)
   var house := GetObjProperty(sign, "house_serial");

Modified: trunk/096/scripts/include/OLD/spellRestrictions.inc
===================================================================
--- trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-05 08:17:13 UTC (rev 904)
@@ -7,7 +7,7 @@
 include "include/client";
 include "include/tileEffects";
 include "include/sound";
-include "include/objtype";
+include ":itemutils:objtype";
 include "include/statMod";
 include "include/firewall";
 include "include/spellAttack";
@@ -243,20 +243,20 @@
         var magery := CInt(AP_GetSkill(caster, SKILLID_MAGERY));
         var evalint := CInt(AP_GetSkill(caster, SKILLID_EVALINT));
         var resist := CInt(AP_GetSkill(cast_on, SKILLID_MAGICRESISTANCE));
-        
+
         // chk1 relates to the resist ability.
         var chk1 := (resist / 5);
         // chk2 relates to the difficulty level
         var chk2 := resist - (((magery - 20) / 5) + (circle * 5));
-        
+
         if(chk1 < 1)
                 chk1 := 1;
         endif
         if(chk2 < 1)
                 chk2 := 1;
         endif
-        
-        // What an odd construct.  
+
+        // What an odd construct.
         // If you're hit with an easy spell then you have a difficulty of your resist
         var diff := 0;
         if(chk1 > chk2)
@@ -264,7 +264,7 @@
         else
                 diff := chk2;
         endif
-        
+
         var points := getresistpoints(circle, cast_on, SKILLID_MAGICRESISTANCE);
         if(cast_on.dead)
                 return 0;

Modified: trunk/096/scripts/items/key.src
===================================================================
--- trunk/096/scripts/items/key.src	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/scripts/items/key.src	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 use boat;
-include "include/objtype";
+include ":itemutils:objtype";
 include ":gumps:yesno";
 include "include/myUtil";
 include "util/key";

Modified: trunk/096/scripts/util/key.inc
===================================================================
--- trunk/096/scripts/util/key.inc	2005-11-05 08:10:21 UTC (rev 903)
+++ trunk/096/scripts/util/key.inc	2005-11-05 08:17:13 UTC (rev 904)
@@ -1,5 +1,5 @@
 include "include/client";
-include "include/objtype";
+include ":itemutils:objtype";
 
 function AllocLockId()
   var lockid := GetGlobalProperty( "nextlockid" );



From muaddiblsd at berlios.de  Sat Nov  5 09:21:04 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Sat, 5 Nov 2005 09:21:04 +0100
Subject: [Poldistro-svn] r905 - in trunk/096: pkg/items/food pkg/items/guildstone pkg/items/magic pkg/items/ministatues pkg/items/repaircontract pkg/items/runebook pkg/items/traps pkg/items/treasuremap pkg/items/usestuff pkg/items/wands pkg/skills/alchemy pkg/skills/blacksmithy pkg/skills/bowcraft pkg/skills/camping pkg/skills/carpentry pkg/skills/cartography pkg/skills/cooking pkg/skills/fishing pkg/skills/healing pkg/skills/inscription pkg/skills/lockpicking pkg/skills/mining pkg/skills/musicianship pkg/skills/poisoning pkg/skills/removetrap pkg/skills/tailoring pkg/skills/tinkering pkg/systems/boat pkg/systems/combat/old pkg/systems/combat/useScripts pkg/systems/housing scripts/items
Message-ID: <200511050821.jA58L4fd000280@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-05 09:20:50 +0100 (Sat, 05 Nov 2005)
New Revision: 905

Modified:
   trunk/096/pkg/items/food/drink.src
   trunk/096/pkg/items/food/eat.src
   trunk/096/pkg/items/guildstone/guildDeed.src
   trunk/096/pkg/items/guildstone/guildMethods.src
   trunk/096/pkg/items/guildstone/guildMove.src
   trunk/096/pkg/items/guildstone/guildStone.src
   trunk/096/pkg/items/magic/chargedSpellItem.src
   trunk/096/pkg/items/magic/scroll.src
   trunk/096/pkg/items/ministatues/statueDeed.src
   trunk/096/pkg/items/ministatues/useStatue.src
   trunk/096/pkg/items/repaircontract/repairDeed.src
   trunk/096/pkg/items/runebook/runeInsert.src
   trunk/096/pkg/items/runebook/runebook.src
   trunk/096/pkg/items/traps/traps.src
   trunk/096/pkg/items/treasuremap/decodeMap.src
   trunk/096/pkg/items/usestuff/useStuff.src
   trunk/096/pkg/items/wands/magicWands.src
   trunk/096/pkg/skills/alchemy/alchemy.src
   trunk/096/pkg/skills/alchemy/blackPotion.src
   trunk/096/pkg/skills/alchemy/bluePotion.src
   trunk/096/pkg/skills/alchemy/explosionPotion.src
   trunk/096/pkg/skills/alchemy/greenPotion.src
   trunk/096/pkg/skills/alchemy/orangePotion.src
   trunk/096/pkg/skills/alchemy/potionKeg.src
   trunk/096/pkg/skills/alchemy/redPotion.src
   trunk/096/pkg/skills/alchemy/whitePotion.src
   trunk/096/pkg/skills/alchemy/yellowPotion.src
   trunk/096/pkg/skills/blacksmithy/makeBlacksmithItems.src
   trunk/096/pkg/skills/bowcraft/bowcraft.src
   trunk/096/pkg/skills/camping/bedroll.src
   trunk/096/pkg/skills/camping/camping.src
   trunk/096/pkg/skills/carpentry/carpentry.src
   trunk/096/pkg/skills/cartography/mapmakersPen.src
   trunk/096/pkg/skills/cooking/cooking.src
   trunk/096/pkg/skills/cooking/fillPitcher.src
   trunk/096/pkg/skills/fishing/SOSBottle.src
   trunk/096/pkg/skills/fishing/SOSMessage.src
   trunk/096/pkg/skills/fishing/fishing.src
   trunk/096/pkg/skills/fishing/fishnets.src
   trunk/096/pkg/skills/fishing/magicFish.src
   trunk/096/pkg/skills/healing/healing.src
   trunk/096/pkg/skills/inscription/inscription.src
   trunk/096/pkg/skills/lockpicking/lockpicking.src
   trunk/096/pkg/skills/mining/mining.src
   trunk/096/pkg/skills/mining/resmelt.src
   trunk/096/pkg/skills/mining/smelting.src
   trunk/096/pkg/skills/musicianship/musicianship.src
   trunk/096/pkg/skills/musicianship/peacemaking.src
   trunk/096/pkg/skills/musicianship/provocation.src
   trunk/096/pkg/skills/poisoning/poisonSkill.src
   trunk/096/pkg/skills/removetrap/removeTrap.src
   trunk/096/pkg/skills/tailoring/makeClothItems.src
   trunk/096/pkg/skills/tailoring/scissors.src
   trunk/096/pkg/skills/tailoring/spinning.src
   trunk/096/pkg/skills/tailoring/tailor.src
   trunk/096/pkg/skills/tailoring/tailoring.src
   trunk/096/pkg/skills/tinkering/makeComplexItem.src
   trunk/096/pkg/skills/tinkering/tinkerTraps.src
   trunk/096/pkg/skills/tinkering/tinkering.src
   trunk/096/pkg/systems/boat/shipDeed.src
   trunk/096/pkg/systems/combat/old/bladed.src
   trunk/096/pkg/systems/combat/useScripts/bladed.src
   trunk/096/pkg/systems/housing/changeOwner.src
   trunk/096/pkg/systems/housing/houseDeed.src
   trunk/096/scripts/items/coords.src
   trunk/096/scripts/items/key.src
   trunk/096/scripts/items/rune.src
   trunk/096/scripts/items/vendorDeed.src
Log:
Update for itemutils/include/canAccess.inc

Modified: trunk/096/pkg/items/food/drink.src
===================================================================
--- trunk/096/pkg/items/food/drink.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/food/drink.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 use util;
 use os;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":timedscripts:timedScripts";
 
 const SOUND_EFFECT_DRINK1 := 0x32;
@@ -102,4 +102,4 @@
     endif
   endif
 
-endprogram 
\ No newline at end of file
+endprogram
\ No newline at end of file

Modified: trunk/096/pkg/items/food/eat.src
===================================================================
--- trunk/096/pkg/items/food/eat.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/food/eat.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -5,7 +5,7 @@
 use util;
 use cfgfile;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":attributes:attributes";
 include ":timedscripts:timedScripts";
 include "include/client";

Modified: trunk/096/pkg/items/guildstone/guildDeed.src
===================================================================
--- trunk/096/pkg/items/guildstone/guildDeed.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/guildstone/guildDeed.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "guildData";
 
 program use_guild_deed(who, deed)

Modified: trunk/096/pkg/items/guildstone/guildMethods.src
===================================================================
--- trunk/096/pkg/items/guildstone/guildMethods.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/guildstone/guildMethods.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 use cfgfile;
 use util;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program Install()
   return 1;

Modified: trunk/096/pkg/items/guildstone/guildMove.src
===================================================================
--- trunk/096/pkg/items/guildstone/guildMove.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/guildstone/guildMove.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program packed_stone(who,stone)
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/items/guildstone/guildStone.src
===================================================================
--- trunk/096/pkg/items/guildstone/guildStone.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/guildstone/guildStone.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -2,7 +2,7 @@
 use os;
 
 include ":gumps:yesno";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "guildData";
 include ":gumps:include/old/old-gumps";
 include "include/webPage";

Modified: trunk/096/pkg/items/magic/chargedSpellItem.src
===================================================================
--- trunk/096/pkg/items/magic/chargedSpellItem.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/magic/chargedSpellItem.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 
 include "include/client";
 include "getSpellID";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program use_chargedspellitem( who, item )
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/items/magic/scroll.src
===================================================================
--- trunk/096/pkg/items/magic/scroll.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/magic/scroll.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -4,7 +4,7 @@
 
 include "include/client";
 include "getSpellID";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program use_scroll(who, scroll)
   EraseObjProperty(who, "IsMeditating");
@@ -23,7 +23,7 @@
     return;
   endif
   if(CInt(scroll.container.objtype) == CInt(0x0EFA))
-    return;  // Feel free to take this opportunity to report this 
+    return;  // Feel free to take this opportunity to report this
              // person as an injection user- that's the main known
              // way to try to use a scroll that is inside a spellbook.
   endif

Modified: trunk/096/pkg/items/ministatues/statueDeed.src
===================================================================
--- trunk/096/pkg/items/ministatues/statueDeed.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/ministatues/statueDeed.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -5,7 +5,7 @@
 use cfgfile;
 use util;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program use_StatueDeed(who, deed)
 

Modified: trunk/096/pkg/items/ministatues/useStatue.src
===================================================================
--- trunk/096/pkg/items/ministatues/useStatue.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/ministatues/useStatue.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -4,7 +4,7 @@
 use cfgfile;
 use uo;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program use_Statue(who, statue)
 

Modified: trunk/096/pkg/items/repaircontract/repairDeed.src
===================================================================
--- trunk/096/pkg/items/repaircontract/repairDeed.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/repaircontract/repairDeed.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -2,7 +2,7 @@
 use util;
 use cfgfile;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "include/dist";
 
 program usescript_repairDeed(who, deed)
@@ -91,7 +91,7 @@
   endif
 
   return 1;
-  
+
 endfunction
 
 function SelectiveRepair(who, skillid)

Modified: trunk/096/pkg/items/runebook/runeInsert.src
===================================================================
--- trunk/096/pkg/items/runebook/runeInsert.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/runebook/runeInsert.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 use uo;
 use os;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program on_insert(who, book, movetype, inserttype, item, existing_stack, amt);
 

Modified: trunk/096/pkg/items/runebook/runebook.src
===================================================================
--- trunk/096/pkg/items/runebook/runebook.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/runebook/runebook.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -6,7 +6,7 @@
 include "include/math";
 include "include/client";
 include "include/coords";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 const OBJTYPE_RUNE := 0x1f14;
 const X1 := 28;

Modified: trunk/096/pkg/items/traps/traps.src
===================================================================
--- trunk/096/pkg/items/traps/traps.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/traps/traps.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 use os;
 
 include "include/tileEffects";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "include/sound";
 
 

Modified: trunk/096/pkg/items/treasuremap/decodeMap.src
===================================================================
--- trunk/096/pkg/items/treasuremap/decodeMap.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/treasuremap/decodeMap.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -5,7 +5,7 @@
 include ":attributes:attributes";
 include "include/client";
 include ":itemutils:objtype";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program decode_map( who, map )
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/items/usestuff/useStuff.src
===================================================================
--- trunk/096/pkg/items/usestuff/useStuff.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/usestuff/useStuff.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 use os;
 use cfgfile;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 var config;
 var elem;

Modified: trunk/096/pkg/items/wands/magicWands.src
===================================================================
--- trunk/096/pkg/items/wands/magicWands.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/items/wands/magicWands.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 use cfgfile;
 
 include ":attributes:attributes";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "include/tileEffects";
 include "include/client";
 include "include/sound";

Modified: trunk/096/pkg/skills/alchemy/alchemy.src
===================================================================
--- trunk/096/pkg/skills/alchemy/alchemy.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/alchemy/alchemy.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -6,7 +6,7 @@
 
 include "include/client";
 include "potion";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "include/noto";
 
 CONST REAGENT_START := 0x0f78;
@@ -17,7 +17,7 @@
 CONST UOBJECT_EMPTY_BOTTLE := 0x0f0e;
 
 var conf := ReadConfigFile("alchemy");
-	
+
 program use_mortar (who, mortar)
 	EraseObjProperty(who, "IsMeditating");
 	EraseObjProperty(who, "HealTimer");

Modified: trunk/096/pkg/skills/alchemy/blackPotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/blackPotion.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/alchemy/blackPotion.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -2,7 +2,7 @@
 use uo;
 use cfgfile;
 include "drinkPotion";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program blackPotion(who, potion)
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/skills/alchemy/bluePotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/bluePotion.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/alchemy/bluePotion.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -4,7 +4,7 @@
 use cfgfile;
 include "drinkPotion";
 include "include/statMod";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program bluePotion (who, potion)
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/skills/alchemy/explosionPotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/explosionPotion.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/alchemy/explosionPotion.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 use util;
 use cfgfile;
 include "include/eventID";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program use_explosion(who, potion)
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/skills/alchemy/greenPotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/greenPotion.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/alchemy/greenPotion.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 use util;
 use cfgfile;
 include "drinkPotion";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program greenPotion(who, potion)
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/skills/alchemy/orangePotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/orangePotion.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/alchemy/orangePotion.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 use util;
 use cfgfile;
 include "drinkPotion";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":timedscripts:timedScripts";
 include ":timedscripts:poisonUtil";
 

Modified: trunk/096/pkg/skills/alchemy/potionKeg.src
===================================================================
--- trunk/096/pkg/skills/alchemy/potionKeg.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/alchemy/potionKeg.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include ":itemutils:objtype";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "potionKegs";
 
 const UOBJ_POTIONKEG := 0xf022;

Modified: trunk/096/pkg/skills/alchemy/redPotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/redPotion.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/alchemy/redPotion.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -4,7 +4,7 @@
 use cfgfile;
 include "drinkPotion";
 include ":attributes:attributes";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program redPotion (who, potion)
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/skills/alchemy/whitePotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/whitePotion.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/alchemy/whitePotion.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -4,7 +4,7 @@
 use cfgfile;
 include "drinkPotion";
 include "include/statMod";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program whitePotion (who, potion)
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/skills/alchemy/yellowPotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/yellowPotion.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/alchemy/yellowPotion.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -2,7 +2,7 @@
 use uo;
 use util;
 include "drinkPotion";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program yellowPotion (who, potion)
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/skills/blacksmithy/makeBlacksmithItems.src
===================================================================
--- trunk/096/pkg/skills/blacksmithy/makeBlacksmithItems.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/blacksmithy/makeBlacksmithItems.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -9,7 +9,7 @@
 include ":crafting:crafting";
 include ":crafting:craftingRepair";
 include ":crafting:toolWear";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 var item_config     := ReadConfigFile(":*:itemdesc");
 var craft_config    := ReadConfigFile(":blacksmithy:blacksmithy");

Modified: trunk/096/pkg/skills/bowcraft/bowcraft.src
===================================================================
--- trunk/096/pkg/skills/bowcraft/bowcraft.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/bowcraft/bowcraft.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -9,7 +9,7 @@
 include ":crafting:crafting";
 include ":crafting:craftingRepair";
 include ":crafting:toolWear";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 var item_config     := ReadConfigFile(":*:itemdesc");
 var craft_config    := ReadConfigFile(":bowcraft:bowcraft");

Modified: trunk/096/pkg/skills/camping/bedroll.src
===================================================================
--- trunk/096/pkg/skills/camping/bedroll.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/camping/bedroll.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -5,7 +5,7 @@
 use uo;
 use os;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 CONST LOGOUT_WAIT 	:= 30;
 CONST UOBJECT_CAMPFIRE  := 0xde3;

Modified: trunk/096/pkg/skills/camping/camping.src
===================================================================
--- trunk/096/pkg/skills/camping/camping.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/camping/camping.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -4,7 +4,7 @@
 include ":attributes:attributes";
 include ":attributes:skillCheck";
 include ":itemutils:objtype";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program UseWood( who, wood )
 

Modified: trunk/096/pkg/skills/carpentry/carpentry.src
===================================================================
--- trunk/096/pkg/skills/carpentry/carpentry.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/carpentry/carpentry.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -11,7 +11,7 @@
 include ":crafting:crafting";
 include ":crafting:craftingRepair";
 include ":crafting:toolWear";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 CONST CARP_WOOD_SOUND := 0x23e;
 

Modified: trunk/096/pkg/skills/cartography/mapmakersPen.src
===================================================================
--- trunk/096/pkg/skills/cartography/mapmakersPen.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/cartography/mapmakersPen.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -9,7 +9,7 @@
 include ":attributes:skillCheck";
 include ":crafting:crafting";
 include ":crafting:toolWear";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 var item_config     := ReadConfigFile(":cartography:itemdesc");
 var craft_config    := ReadConfigFile(":cartography:cartography");

Modified: trunk/096/pkg/skills/cooking/cooking.src
===================================================================
--- trunk/096/pkg/skills/cooking/cooking.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/cooking/cooking.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -5,7 +5,7 @@
 include "include/client";
 include ":attributes:attributes";
 include ":gumps:yesno";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program cook(who, item)
   EraseObjProperty(who, "IsMeditating");
@@ -63,7 +63,7 @@
   var cfg := ReadConfigFile(":cooking:cooking");
   var skill_needed := -1;
   var points       := cfg[item.objtype].points;
-  var elem      := FindConfigElem(cfg, item.objtype);  
+  var elem      := FindConfigElem(cfg, item.objtype);
   var products  := GetConfigStringArray(elem,"product");
   var product   := Cint(products[RandomInt(len(products))+1]);
   var ingredients := GetConfigStringArray(elem, "ingredient");
@@ -128,16 +128,16 @@
 var result := {};
 
   foreach list in ingredients
-  
+
     words := SplitWords(list);
     objtypes := {};
     foreach word in words
       objtypes.append(CInt(word));
     endforeach
-    
+
     SendSysMessage(who, "Select an ingredient for cooking this.");
     tgt := Target(who);
-    
+
     if (tgt.objtype in objtypes)
       SendSysMessage(who, "Good choice!");
       result.append(tgt);

Modified: trunk/096/pkg/skills/cooking/fillPitcher.src
===================================================================
--- trunk/096/pkg/skills/cooking/fillPitcher.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/cooking/fillPitcher.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -1,6 +1,6 @@
 use uo;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program fillpitcher (who, pitcher)
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/skills/fishing/SOSBottle.src
===================================================================
--- trunk/096/pkg/skills/fishing/SOSBottle.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/fishing/SOSBottle.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -7,7 +7,7 @@
 use os;
 use util;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program use_MessageBottle( who, bottle )
 

Modified: trunk/096/pkg/skills/fishing/SOSMessage.src
===================================================================
--- trunk/096/pkg/skills/fishing/SOSMessage.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/fishing/SOSMessage.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -6,7 +6,7 @@
 use os;
 
 include "include/coords";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":gumps:include/gumps";
 
 program use_SOSMessage( who, message )

Modified: trunk/096/pkg/skills/fishing/fishing.src
===================================================================
--- trunk/096/pkg/skills/fishing/fishing.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/fishing/fishing.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -7,7 +7,7 @@
 use math;
 
 include "fishingFunctions";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":attributes:include/attributeConstants";
 include ":attributes:include/attributes";
 include ":crafting:toolWear";

Modified: trunk/096/pkg/skills/fishing/fishnets.src
===================================================================
--- trunk/096/pkg/skills/fishing/fishnets.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/fishing/fishnets.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -6,7 +6,7 @@
 use os;
 use math;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "fishingFunctions";
 include ":attributes:include/attributeConstants";
 include ":attributes:include/attributes";

Modified: trunk/096/pkg/skills/fishing/magicFish.src
===================================================================
--- trunk/096/pkg/skills/fishing/magicFish.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/fishing/magicFish.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -8,7 +8,7 @@
 use util;
 
 include "include/statMod";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":timedscripts:timedScripts";
 include ":timedscripts:poisonUtil";
 

Modified: trunk/096/pkg/skills/healing/healing.src
===================================================================
--- trunk/096/pkg/skills/healing/healing.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/healing/healing.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -7,7 +7,7 @@
 include "include/dist";
 include "include/client";
 include "include/resurrection";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":attributes:attributes";
 include ":timedscripts:timedScripts";
 include ":timedscripts:poisonUtil";
@@ -128,7 +128,7 @@
 			SendSysMessage(who, "You cannot use those bandages.");
 		endif
 		return;
-		
+
 // Send the animals to vet.
 	elseif(patient.npctemplate)
 		if(dist(who, patient) >= 2)
@@ -149,7 +149,7 @@
 	var basehealamt := healamt;
 	var cycles;
 	var count := 0;
-	
+
 	// Determine how many attempts are made to heal.
 	if(patient == who)
 		var dexcheck := (AP_GetTrueStat(who, "Dexterity") / 20);
@@ -163,7 +163,7 @@
 			cycles := 3;
 		endif
 	endif
-	
+
 	// This loop has two functions:
 	//	1- provide wait-states for healing, during which, if it's interrupted, no healing occurs.
 	//	2- test for fumbles during the healing process and lower the amount of healing
@@ -174,7 +174,7 @@
 		if (counter%4 == 0)
 			SendSysMessage(patient, who.name + " continues to heal you.");
 		endif
-		
+
 		// break out if anyone does anything that should cause heal to stop.
 		if(!GetObjProperty(who, "HealTimer"))
 			SendSysMessage(who, "You stop healing your patient.");
@@ -213,8 +213,8 @@
 				cure(who, patient, counter);
 			endif
 			break;
-		
-		// Testing to see if things are fumbled.  If they fumble too badly, 
+
+		// Testing to see if things are fumbled.  If they fumble too badly,
 		elseif(AP_GetVital(who, "Hits") < chp)
 			if((RandomInt(basehealamt) + 1) >= AP_GetStat(who, "Dexterity"))
 				SendSysMessage(who, "Your fingers slip." );
@@ -225,7 +225,7 @@
 					count := count + 1;
 				endif
 			endif
-		
+
 		// The last cycle of the loop.  All actual healing is done here.
 		elseif(counter >= cycles)
 			var diff := 100 - Cint((AP_GetVital(patient, "Hits") * 100.0) / AP_GetVitalMaximumValue(patient, "Hits"));
@@ -250,7 +250,7 @@
 				break;
 			endif
 		endif
-		
+
 		counter := counter + 1;
 	endwhile
 endfunction

Modified: trunk/096/pkg/skills/inscription/inscription.src
===================================================================
--- trunk/096/pkg/skills/inscription/inscription.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/inscription/inscription.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -1,6 +1,6 @@
 include ":attributes:attributes";
 include ":itemutils:objtype";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "include/noto";
 
 var config_file;

Modified: trunk/096/pkg/skills/lockpicking/lockpicking.src
===================================================================
--- trunk/096/pkg/skills/lockpicking/lockpicking.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/lockpicking/lockpicking.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -8,7 +8,7 @@
 include "include/sound";
 include "include/startEqp";
 include "util/key";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 
 program skill_lockpicking( me, lockpick )

Modified: trunk/096/pkg/skills/mining/mining.src
===================================================================
--- trunk/096/pkg/skills/mining/mining.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/mining/mining.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -9,7 +9,7 @@
 include "include/startEqp";
 include "util/key";
 include "include/utility";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 var startx;
 var starty;

Modified: trunk/096/pkg/skills/mining/resmelt.src
===================================================================
--- trunk/096/pkg/skills/mining/resmelt.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/mining/resmelt.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -2,7 +2,7 @@
 use os;
 use cfgfile;
 
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":attributes:attributes";
 include "include/client";
 

Modified: trunk/096/pkg/skills/mining/smelting.src
===================================================================
--- trunk/096/pkg/skills/mining/smelting.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/mining/smelting.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 
 include "include/client";
 include ":itemutils:objtype";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":attributes:attributes";
 
 program smelt_that_ore (who, ore)

Modified: trunk/096/pkg/skills/musicianship/musicianship.src
===================================================================
--- trunk/096/pkg/skills/musicianship/musicianship.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/musicianship/musicianship.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -7,7 +7,7 @@
 include ":attributes:attributeConstants";
 include ":attributes:attributes";
 include ":attributes:skillCheck";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 var config;
 

Modified: trunk/096/pkg/skills/musicianship/peacemaking.src
===================================================================
--- trunk/096/pkg/skills/musicianship/peacemaking.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/musicianship/peacemaking.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -7,7 +7,7 @@
 include ":attributes:attributes";
 include ":attributes:skillCheck";
 include "include/eventID";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":musicianship:bard";
 
 program skill_Peacemaking(who)

Modified: trunk/096/pkg/skills/musicianship/provocation.src
===================================================================
--- trunk/096/pkg/skills/musicianship/provocation.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/musicianship/provocation.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -7,7 +7,7 @@
 include ":attributes:attributes";
 include ":attributes:skillCheck";
 include "include/eventID";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":musicianship:bard";
 
 program bard_provoke(who)

Modified: trunk/096/pkg/skills/poisoning/poisonSkill.src
===================================================================
--- trunk/096/pkg/skills/poisoning/poisonSkill.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/poisoning/poisonSkill.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "include/noto";
 
 program do_poisoning(who)

Modified: trunk/096/pkg/skills/removetrap/removeTrap.src
===================================================================
--- trunk/096/pkg/skills/removetrap/removeTrap.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/removetrap/removeTrap.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -7,7 +7,7 @@
 include "include/client";
 include "include/sound";
 include "include/tileEffects";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":attributes:attributes";
 
 program removeTrap(who)

Modified: trunk/096/pkg/skills/tailoring/makeClothItems.src
===================================================================
--- trunk/096/pkg/skills/tailoring/makeClothItems.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/tailoring/makeClothItems.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -8,7 +8,7 @@
 include "include/dist";
 include "include/client";
 include ":itemutils:objtype";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "include/toolWear";
 include "include/noto";
 

Modified: trunk/096/pkg/skills/tailoring/scissors.src
===================================================================
--- trunk/096/pkg/skills/tailoring/scissors.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/tailoring/scissors.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -4,7 +4,7 @@
 include ":itemutils:objtype";
 include ":attributes:attributes";
 include "include/client";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "include/toolWear";
 
 var scissors_cfg := ReadConfigFile("scissors");

Modified: trunk/096/pkg/skills/tailoring/spinning.src
===================================================================
--- trunk/096/pkg/skills/tailoring/spinning.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/tailoring/spinning.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 
 include "include/client";
 include ":itemutils:objtype";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 const uobj_wheel_start := 0x1015;
 const uobj_wheel_end := 0x101e;

Modified: trunk/096/pkg/skills/tailoring/tailor.src
===================================================================
--- trunk/096/pkg/skills/tailoring/tailor.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/tailoring/tailor.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 
 include "include/client";
 include ":itemutils:objtype";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program use_yarn(who, yarn)
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/skills/tailoring/tailoring.src
===================================================================
--- trunk/096/pkg/skills/tailoring/tailoring.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/tailoring/tailoring.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -3,7 +3,7 @@
 
 include "include/client";
 include ":itemutils:objtype";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program use_thread(who, thread)
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/skills/tinkering/makeComplexItem.src
===================================================================
--- trunk/096/pkg/skills/tinkering/makeComplexItem.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/tinkering/makeComplexItem.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -1,6 +1,6 @@
 
 include ":attributes:attributes";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 var tinker_cfg:= ReadConfigFile("tinker");
 var itemcfg := ReadConfigFile("itemdesc");
@@ -31,8 +31,8 @@
     default:
   endcase
 endprogram
-  
-  
+
+
 function make_complex_thing(who, desired_item, clicked_part, required_part)
     var skill     := tinker_cfg[desired_item].skill;
     var itemname  := tinker_cfg[desired_item].Name;

Modified: trunk/096/pkg/skills/tinkering/tinkerTraps.src
===================================================================
--- trunk/096/pkg/skills/tinkering/tinkerTraps.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/tinkering/tinkerTraps.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -6,7 +6,7 @@
 include "include/sound";
 include "include/tileEffects";
 include "include/client";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":attributes:attributes";
 
 program open_trapped_item(who, item)
@@ -110,4 +110,4 @@
   else
     return amt;
   endif
-endfunction  
\ No newline at end of file
+endfunction
\ No newline at end of file

Modified: trunk/096/pkg/skills/tinkering/tinkering.src
===================================================================
--- trunk/096/pkg/skills/tinkering/tinkering.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/skills/tinkering/tinkering.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -10,7 +10,7 @@
 include "include/sound";
 include ":itemutils:objtype";
 include "util/key";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "include/toolWear";
 include ":gumps:include/old/old-gumps";
 include "include/noto";

Modified: trunk/096/pkg/systems/boat/shipDeed.src
===================================================================
--- trunk/096/pkg/systems/boat/shipDeed.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/systems/boat/shipDeed.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -6,7 +6,7 @@
 
 include "util/key";
 include ":itemutils:objtype";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program useshipdeed(who, deed)
   if(DeedAlreadyBuiltFrom(deed))

Modified: trunk/096/pkg/systems/combat/old/bladed.src
===================================================================
--- trunk/096/pkg/systems/combat/old/bladed.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/systems/combat/old/bladed.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -11,7 +11,7 @@
 include ":attributes:attributes";
 include "include/string";
 include ":itemutils:objtype";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "include/dist";
 include "include/toolWear";
 include "include/noto";

Modified: trunk/096/pkg/systems/combat/useScripts/bladed.src
===================================================================
--- trunk/096/pkg/systems/combat/useScripts/bladed.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/systems/combat/useScripts/bladed.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -11,7 +11,7 @@
 include ":attributes:attributes";
 include "include/string";
 include ":itemutils:objtype";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "include/dist";
 include "include/toolWear";
 include "include/noto";

Modified: trunk/096/pkg/systems/housing/changeOwner.src
===================================================================
--- trunk/096/pkg/systems/housing/changeOwner.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/systems/housing/changeOwner.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -6,7 +6,7 @@
 
 include ":containers:storageAreas";
 include "util/key";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 const UOBJECT_DOORS_START := 0x0675;
 const UOBJECT_DOORS_END   := 0x06f4;

Modified: trunk/096/pkg/systems/housing/houseDeed.src
===================================================================
--- trunk/096/pkg/systems/housing/houseDeed.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/pkg/systems/housing/houseDeed.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -6,7 +6,7 @@
 include ":containers:storageAreas";
 include ":itemutils:objtype";
 include "include/findCity";
-include "include/canAccess";
+include ":itemutils:canAccess";
 include "include/isValidLoc";
 
 const UOBJECT_DOORS_START:=0x675;

Modified: trunk/096/scripts/items/coords.src
===================================================================
--- trunk/096/scripts/items/coords.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/scripts/items/coords.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -1,6 +1,6 @@
 use uo;
 include "include/coords";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program get_coords(who, item)
   if(!can_access(who, item))

Modified: trunk/096/scripts/items/key.src
===================================================================
--- trunk/096/scripts/items/key.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/scripts/items/key.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -5,7 +5,7 @@
 include ":gumps:yesno";
 include "include/myUtil";
 include "util/key";
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 const KEYSTART := 0x100e;
 const KEYEND := 0x1013;

Modified: trunk/096/scripts/items/rune.src
===================================================================
--- trunk/096/scripts/items/rune.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/scripts/items/rune.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -1,5 +1,5 @@
 use uo;
-include "include/canAccess";
+include ":itemutils:canAccess";
 
 program dblclick_rune(who, rune)
   if(!can_access(who, rune))

Modified: trunk/096/scripts/items/vendorDeed.src
===================================================================
--- trunk/096/scripts/items/vendorDeed.src	2005-11-05 08:17:13 UTC (rev 904)
+++ trunk/096/scripts/items/vendorDeed.src	2005-11-05 08:20:50 UTC (rev 905)
@@ -1,6 +1,6 @@
 use os;
 use uo;
-include "include/canAccess";
+include ":itemutils:canAccess";
 include ":attributes:attributes";
 
 const SEARCH_RANGE := 10;



From muaddiblsd at berlios.de  Sat Nov  5 09:30:47 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Sat, 5 Nov 2005 09:30:47 +0100
Subject: [Poldistro-svn] r906 - in trunk/096: pkg/mobiles/oldAI pkg/mobiles/playervendor pkg/skills/mining pkg/systems/merchantnodes scripts scripts/include/OLD
Message-ID: <200511050830.jA58UlEE000624@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-05 09:30:40 +0100 (Sat, 05 Nov 2005)
New Revision: 906

Modified:
   trunk/096/pkg/mobiles/oldAI/barber.src
   trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src
   trunk/096/pkg/mobiles/oldAI/merchant.src
   trunk/096/pkg/mobiles/oldAI/townHealer.src
   trunk/096/pkg/mobiles/playervendor/payCounter.src
   trunk/096/pkg/skills/mining/mining.src
   trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src
   trunk/096/pkg/systems/merchantnodes/restock.src
   trunk/096/scripts/include/OLD/mrcSpawn.inc
   trunk/096/scripts/start.src
Log:
Update for itemutils/include/utility.inc

Modified: trunk/096/pkg/mobiles/oldAI/barber.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/barber.src	2005-11-05 08:20:50 UTC (rev 905)
+++ trunk/096/pkg/mobiles/oldAI/barber.src	2005-11-05 08:30:40 UTC (rev 906)
@@ -5,7 +5,7 @@
 include "include/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
-include "include/utility";
+include ":itemutils:utility";;
 include "include/mrcSpawn";
 include ":npcutils:vetement";
 include ":npcutils:NPCBackpacks";

Modified: trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src	2005-11-05 08:20:50 UTC (rev 905)
+++ trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src	2005-11-05 08:30:40 UTC (rev 906)
@@ -6,7 +6,7 @@
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
-include "include/utility";
+include ":itemutils:utility";;
 include "include/mrcSpawn";
 include ":npcutils:vetement";
 include ":npcutils:NPCBackpacks";

Modified: trunk/096/pkg/mobiles/oldAI/merchant.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/merchant.src	2005-11-05 08:20:50 UTC (rev 905)
+++ trunk/096/pkg/mobiles/oldAI/merchant.src	2005-11-05 08:30:40 UTC (rev 906)
@@ -5,7 +5,7 @@
 include "include/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
-include "include/utility";
+include ":itemutils:utility";;
 include "include/mrcSpawn";
 include ":npcutils:vetement";
 include ":npcutils:NPCBackpacks";

Modified: trunk/096/pkg/mobiles/oldAI/townHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townHealer.src	2005-11-05 08:20:50 UTC (rev 905)
+++ trunk/096/pkg/mobiles/oldAI/townHealer.src	2005-11-05 08:30:40 UTC (rev 906)
@@ -7,7 +7,7 @@
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";
-include "include/utility";
+include ":itemutils:utility";;
 include "include/mrcSpawn";
 include ":npcutils:vetement";
 include ":npcutils:NPCBackpacks";

Modified: trunk/096/pkg/mobiles/playervendor/payCounter.src
===================================================================
--- trunk/096/pkg/mobiles/playervendor/payCounter.src	2005-11-05 08:20:50 UTC (rev 905)
+++ trunk/096/pkg/mobiles/playervendor/payCounter.src	2005-11-05 08:30:40 UTC (rev 906)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 
-include "include/utility";
+include ":itemutils:utility";;
 
 program paycounter(me)
   var gold, rsrv, tax;

Modified: trunk/096/pkg/skills/mining/mining.src
===================================================================
--- trunk/096/pkg/skills/mining/mining.src	2005-11-05 08:20:50 UTC (rev 905)
+++ trunk/096/pkg/skills/mining/mining.src	2005-11-05 08:30:40 UTC (rev 906)
@@ -8,7 +8,7 @@
 include ":itemutils:objtype";
 include "include/startEqp";
 include "util/key";
-include "include/utility";
+include ":itemutils:utility";;
 include ":itemutils:canAccess";
 
 var startx;

Modified: trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src	2005-11-05 08:20:50 UTC (rev 905)
+++ trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src	2005-11-05 08:30:40 UTC (rev 906)
@@ -7,7 +7,7 @@
 include ":attributes:attributes";
 include "include/sysEvent";
 include "include/mrcSpawn";
-include "include/utility";
+include ":itemutils:utility";;
 include "include/dist";
 
 var npclist := {};
@@ -24,7 +24,7 @@
 	sleep(RandomInt(60));
 
 // if all nodes are globally disabled, we sleep until they are enabled again.
-	if(GetGlobalProperty("nomerchants"))											
+	if(GetGlobalProperty("nomerchants"))
 		SetNodeName("globally disabled");
 		SetObjProperty(item, "#wait", 2);
 		while(GetGlobalProperty("nomerchants"))
@@ -32,7 +32,7 @@
 		endwhile
 	endif
 
-// 
+//
 	SetNodeName("enabled");
 	EraseObjProperty(item, "#wait");
 	rng := CInt(GetObjProperty(item, "Range"));
@@ -145,12 +145,12 @@
 			endif
 			DespawnAll();
 			ValidateSpawns();
-			
+
 			// hang out here until it gets turned back on again.
 			while((GetObjProperty(item, "Status") == "off") or (GetGlobalProperty("nomerchants")))
 				var ev := os::wait_for_event(120);
 			endwhile
-			
+
 			// Things have turned back on, so this stuff gets moving
 			SpawnAll();
 			ValidateSpawns();
@@ -235,7 +235,7 @@
 		var type	:= thing[1];
 		// 9-13-2005 Austin
 		// New function in math.em makes 'root' here not compile.
-		// I renamed the var to 'root_canal' which it often feels 
+		// I renamed the var to 'root_canal' which it often feels
 		// like I am getting when i work on old distro code.
 		var root_canal	:= thing[2];
 		var status 	:= thing[3];
@@ -302,10 +302,10 @@
 	if (text["appraise"] || text["stable"] || text["showinventory"] || text["showrestock"])
 		pass := 1;
 	endif
-	
+
 	// If the character wants to do something with a vendor:
 	if (text["buy"] || text["sell"] || text["train"] || text["teach"]||(pass))
-		
+
 		// Just pick the nearest vendor if the player isn't specific.
 		if( text["merchant"] || text["vendor"] || (pass) )
 			var dis := 7;

Modified: trunk/096/pkg/systems/merchantnodes/restock.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/restock.src	2005-11-05 08:20:50 UTC (rev 905)
+++ trunk/096/pkg/systems/merchantnodes/restock.src	2005-11-05 08:30:40 UTC (rev 906)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/mrcSpawn";
-include "include/utility";
+include ":itemutils:utility";;
 
 program restok(parms)
   var item := 0;
@@ -35,4 +35,3 @@
     endforeach
   endif
 endprogram
-       
\ No newline at end of file

Modified: trunk/096/scripts/include/OLD/mrcSpawn.inc
===================================================================
--- trunk/096/scripts/include/OLD/mrcSpawn.inc	2005-11-05 08:20:50 UTC (rev 905)
+++ trunk/096/scripts/include/OLD/mrcSpawn.inc	2005-11-05 08:30:40 UTC (rev 906)
@@ -1,6 +1,6 @@
 use cfgfile;
 include ":attributes:attributes";
-include "include/utility";
+include ":itemutils:utility";;
 
 var mrcspawn_cfg := ReadConfigFile("::mrcspawn");
 var itemconfig := ReadConfigFile(":*:itemdesc");
@@ -168,7 +168,7 @@
 		var chk := CountExisting(destination, thing.objtype); // to see what we got *really* for sale
 		items := chk[2];// returns all of a particular item, stacked or unstacked. (array)
 		amt := chk[1];
-		
+
 		// determine whether to increase or decrease stock.
 		if(amt >= (thing.amount * multiplier))
 			multiplier := multiplier - 1;
@@ -182,9 +182,9 @@
 			endif
 		endif
 		SetObjProperty(thing, "Multiplier", multiplier);
-		
+
 		mlt := Cint(thing.amount * multiplier); // mlt is the amount that should be in stock
-		
+
 		if(amt != mlt)
 			// define characteristics of the items
 			var buyprice := Cint(thing.buyprice);
@@ -243,7 +243,7 @@
 	var prodgroups := FindConfigElem(mrcspawn_cfg, merchanttype);
 	var buys := GetConfigStringArray(prodgroups, "Buys");
 	var normcost, normsell, percentage;
-	
+
 	//  If not buying lets call the whole thing off.
 	if(buys.size() < 1)
 		return 0;
@@ -251,16 +251,16 @@
 
 	var iteminit := 0;
 	var itemmark := -1;
-	
+
 	// set buy price for each item to be 0 to start. This means it won't be sellable.
 	foreach item in backpackitems
 		item.buyprice := iteminit;
 	endforeach
-	
-	var buynobuyable := { }; 
+
+	var buynobuyable := { };
 	var objtype;
 	var counter := 0;
-	
+
 	// Populate the array of items the vendor will buy.
 	foreach prodgroup in buys
 		foreach itemstr in GetConfigStringArray(FindConfigElem(mrcspawn_cfg, prodgroup), "Item")
@@ -274,7 +274,7 @@
 			buynobuyable.append(objtype);
 		endforeach
 	endforeach
-	
+
 	// compare all the items in the top level of the backpack to things the vendor can buy and set the price.
 	if(buynobuyable.size())
 		foreach item in backpackitems

Modified: trunk/096/scripts/start.src
===================================================================
--- trunk/096/scripts/start.src	2005-11-05 08:20:50 UTC (rev 905)
+++ trunk/096/scripts/start.src	2005-11-05 08:30:40 UTC (rev 906)
@@ -14,7 +14,7 @@
 
 include ":logger:exception";
 include ":logger:log";
-include "include/utility";
+include ":itemutils:utility";;
 include "include/teleporters";
 
 



From muaddiblsd at berlios.de  Sat Nov  5 09:33:00 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Sat, 5 Nov 2005 09:33:00 +0100
Subject: [Poldistro-svn] r907 - in trunk/096: pkg/skills/magery/OLD scripts/include/OLD
Message-ID: <200511050833.jA58X07i000693@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-05 09:32:43 +0100 (Sat, 05 Nov 2005)
New Revision: 907

Modified:
   trunk/096/pkg/skills/magery/OLD/energyField.src.temp
   trunk/096/pkg/skills/magery/OLD/fireField.src.temp
   trunk/096/pkg/skills/magery/OLD/paraField.src.temp
   trunk/096/pkg/skills/magery/OLD/poisonField.src.temp
   trunk/096/pkg/skills/magery/OLD/wallOfStone.src.temp
   trunk/096/scripts/include/OLD/firewall.inc
   trunk/096/scripts/include/OLD/spellRestrictions.inc
Log:
Yeah I know, said tomorrow.... here's your spoon.....

fix for fields.inc move

Modified: trunk/096/pkg/skills/magery/OLD/energyField.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/energyField.src.temp	2005-11-05 08:30:40 UTC (rev 906)
+++ trunk/096/pkg/skills/magery/OLD/energyField.src.temp	2005-11-05 08:32:43 UTC (rev 907)
@@ -2,7 +2,7 @@
 use uo;
 use util;
 
-include "include/fields";
+include ":itemutils:fields";
 include ":attributes:attributes";
 include ":itemutils:objtype";
 

Modified: trunk/096/pkg/skills/magery/OLD/fireField.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/fireField.src.temp	2005-11-05 08:30:40 UTC (rev 906)
+++ trunk/096/pkg/skills/magery/OLD/fireField.src.temp	2005-11-05 08:32:43 UTC (rev 907)
@@ -1,4 +1,4 @@
-include "include/fields";
+include ":itemutils:fields";
 include ":attributes:attributes";
 include "include/client";
 include "include/firewall";

Modified: trunk/096/pkg/skills/magery/OLD/paraField.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/paraField.src.temp	2005-11-05 08:30:40 UTC (rev 906)
+++ trunk/096/pkg/skills/magery/OLD/paraField.src.temp	2005-11-05 08:32:43 UTC (rev 907)
@@ -2,7 +2,7 @@
 use uo;
 use util;
 
-include "include/fields";
+include ":itemutils:fields";
 include ":itemutils:objtype";
 include "include/sound";
 include ":attributes:attributes";

Modified: trunk/096/pkg/skills/magery/OLD/poisonField.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/poisonField.src.temp	2005-11-05 08:30:40 UTC (rev 906)
+++ trunk/096/pkg/skills/magery/OLD/poisonField.src.temp	2005-11-05 08:32:43 UTC (rev 907)
@@ -2,7 +2,7 @@
 use uo;
 use util;
 
-include "include/fields";
+include ":itemutils:fields";
 include ":attributes:attributes";
 include ":itemutils:objtype";
 

Modified: trunk/096/pkg/skills/magery/OLD/wallOfStone.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/wallOfStone.src.temp	2005-11-05 08:30:40 UTC (rev 906)
+++ trunk/096/pkg/skills/magery/OLD/wallOfStone.src.temp	2005-11-05 08:32:43 UTC (rev 907)
@@ -2,7 +2,7 @@
 use uo;
 use util;
 
-include "include/fields";
+include ":itemutils:fields";
 include "include/sound";
 include ":attributes:attributes";
 

Modified: trunk/096/scripts/include/OLD/firewall.inc
===================================================================
--- trunk/096/scripts/include/OLD/firewall.inc	2005-11-05 08:30:40 UTC (rev 906)
+++ trunk/096/scripts/include/OLD/firewall.inc	2005-11-05 08:32:43 UTC (rev 907)
@@ -3,7 +3,7 @@
 use uo;
 
 include "include/client";
-include "include/fields";
+include ":itemutils:fields";
 
 const SOUND_EFFECT_FIREFIELD:= 0x1de;
 const UOBJ_FIREFIELD_NS := 0x398c;

Modified: trunk/096/scripts/include/OLD/spellRestrictions.inc
===================================================================
--- trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-05 08:30:40 UTC (rev 906)
+++ trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-05 08:32:43 UTC (rev 907)
@@ -3,7 +3,7 @@
 use cfgfile;
 use util;
 
-include "include/fields";
+include ":itemutils:fields";
 include "include/client";
 include "include/tileEffects";
 include "include/sound";



From panosl at berlios.de  Sat Nov  5 13:21:50 2005
From: panosl at berlios.de (Panos Laganakos at BerliOS)
Date: Sat, 5 Nov 2005 13:21:50 +0100
Subject: [Poldistro-svn] r908 - in trunk/096/pkg/mobiles/timedScripts: commands/gm config
Message-ID: <200511051221.jA5CLocv018230@sheep.berlios.de>

Author: panosl
Date: 2005-11-05 13:21:46 +0100 (Sat, 05 Nov 2005)
New Revision: 908

Modified:
   trunk/096/pkg/mobiles/timedScripts/commands/gm/addTimer.src
   trunk/096/pkg/mobiles/timedScripts/commands/gm/curePoisons.src
   trunk/096/pkg/mobiles/timedScripts/commands/gm/listTimers.src
   trunk/096/pkg/mobiles/timedScripts/commands/gm/lowerTimer.src
   trunk/096/pkg/mobiles/timedScripts/config/icp.cfg
Log:


Modified: trunk/096/pkg/mobiles/timedScripts/commands/gm/addTimer.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/commands/gm/addTimer.src	2005-11-05 08:32:43 UTC (rev 907)
+++ trunk/096/pkg/mobiles/timedScripts/commands/gm/addTimer.src	2005-11-05 12:21:46 UTC (rev 908)
@@ -1,37 +1,41 @@
-/*
- * $Id$
+/* $Id$
  *
  */
 use uo;
 
 include ":timedscripts:timedScripts";
+include "include/messages";
+include "include/localization";
 
-program cmd_AddPoison(who, text)
-	text := SplitWords(text);
+
+program command_AddPoison(who, params)
+	params := SplitWords(params);
 	
-	var timer_name	:= text[1];
-	var duration	:= CInt(text[2]);
-	var level	:= CInt(text[3]);
+	var timer_name	:= params[1];
+	var duration	:= CInt(params[2]);
+	var level	:= CInt(params[t3]);
 
-	if ( !level )
+	if (!level)
 		level := 1;
 	endif
 	
-	if ( !timer_name || !duration )
-		SendSysMessage(who, "Syntax: .addTimer <timer name> <duration> (level)");
+	if (!timer_name || !duration)
+		SendMessage(who, MSG_USE_HELP, array{}, MSG_COMMAND);
 		return;
 	endif
-	
-	SendSysMessage(who, "Target mobile to add timer to.");
+
+	SendMessage(who, MSG_TARGET_MOBILE, array{}, MSG_COMMAND);
+
 	var targ := target(who);
-	
-	if ( !targ.IsA(POLCLASS_MOBILE) )
-		SendSysMessage(who, "Cancelled.");
+	if (!targ.IsA(POLCLASS_MOBILE))
+		SendMessage(who, MSG_CANCELLED, array{}, MSG_COMMAND);
 		return 0;
 	endif
 	
 	TS_StartTimer(targ, timer_name, duration, level);
-	SendSysMessage(who, "Done.");
 
+	SendMessage(who, MSG_DONE, array{}, MSG_COMMAND);
+
 	return 1;
 endprogram
+

Modified: trunk/096/pkg/mobiles/timedScripts/commands/gm/curePoisons.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/commands/gm/curePoisons.src	2005-11-05 08:32:43 UTC (rev 907)
+++ trunk/096/pkg/mobiles/timedScripts/commands/gm/curePoisons.src	2005-11-05 12:21:46 UTC (rev 908)
@@ -1,5 +1,4 @@
-/*
- * $Id$
+/* $Id$
  *
  */
 use uo;
@@ -8,7 +7,7 @@
 include ":timedscripts:poisonUtil";
 
 
-program textcmd_LowerTimer(who, text)
+program command_LowerTimer(who, text)
 	text := SplitWords(text);
 	
 	var amount	:= CInt(text[1]);

Modified: trunk/096/pkg/mobiles/timedScripts/commands/gm/listTimers.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/commands/gm/listTimers.src	2005-11-05 08:32:43 UTC (rev 907)
+++ trunk/096/pkg/mobiles/timedScripts/commands/gm/listTimers.src	2005-11-05 12:21:46 UTC (rev 908)
@@ -1,28 +1,30 @@
-/*
- * $Id$
+/* $Id$
  *
  */
 use uo;
 use os;
 
 include ":timedscripts:timedScripts";
+include "include/messages";
+include "include/localization";
 
-program textcmd_ListTimers(who, type)
+
+program command_ListTimers(who, type)
+	var targ;
+	SendMessage(who, MSG_TARGET_MOB, array{}, MSG_COMMAND);
 	
-	SendSysMessage(who, "Select the mobile to list timers on.");
-	
-	var targ := target(who);
-	
-	if ( !targ.IsA(POLCLASS_MOBILE) )
-		SendSysMessage(who, "Cancelled");
+	targ := target(who, TGTOPT_NOCHECK_LOS);
+	if (!targ.IsA(POLCLASS_MOBILE))
+		SendMessage(who, MSG_CANCELLED, array{}, MSG_COMMAND);
 		return 0;
 	endif
-	
-	foreach timer_name in ( TS_GetTimerNames(targ, type) )
+
+	foreach timer_name in (TS_GetTimerNames(targ, type))
 		SendSysMessage(who, "->"+timer_name);
 		sleepms(2);
 	endforeach
-	
-	SendSysMessage(who, "Done.");
+
+	SendMessage(who, MSG_DONE, array{}, MSG_COMMAND);
+
 	return 1;
 endprogram

Modified: trunk/096/pkg/mobiles/timedScripts/commands/gm/lowerTimer.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/commands/gm/lowerTimer.src	2005-11-05 08:32:43 UTC (rev 907)
+++ trunk/096/pkg/mobiles/timedScripts/commands/gm/lowerTimer.src	2005-11-05 12:21:46 UTC (rev 908)
@@ -1,31 +1,33 @@
-/*
- * $Id$
+/* $Id$
  *
  */
 use uo;
 
 include ":timedscripts:timedScripts";
 
-program textcmd_LowerTimer(who, text)
-	text := SplitWords(text);
+
+program command_LowerTimer(who, params)
+	params := SplitWords(params);
 	
-	var timer_name	:= text[1];
-	var amount	:= CInt(text[2]);
+	var timer_name	:= params[1];
+	var amount	:= CInt(params[2]);
 	
-	if ( !timer_name || !amount )
-		SendSysMessage(who, "Syntax: .lowerTimer <timer name> <amount>");
+	if (!timer_name || !amount)
+		SendMessage(who, MSG_USE_HELP, array{}, MSG_COMMAND);
 		return 0;
 	endif
 
-	SendSysMessage(who, "Select a mobile to lower the timer on.");
+	SendMessage(who, MSG_TARGET_MOB, array{}, MSG_COMMAND);
 	var targ := target(who);
 	
 	if ( !targ.IsA(POLCLASS_MOBILE) )
-		SendSysMessage(who, "Cancelled.");
+		SendMessage(who, MSG_CANCELLED, array{}, MSG_COMMAND);
 		return 0;
 	endif
 	
 	TS_LowerDuration(targ, timer_name, amount);
-	SendSysMessage(who, "Done.");
+	SendMessage(who, MSG_DONE, array{}, MSG_COMMAND);
+
 	return 1;
-endprogram
\ No newline at end of file
+endprogram
+

Modified: trunk/096/pkg/mobiles/timedScripts/config/icp.cfg
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/config/icp.cfg	2005-11-05 08:32:43 UTC (rev 907)
+++ trunk/096/pkg/mobiles/timedScripts/config/icp.cfg	2005-11-05 12:21:46 UTC (rev 908)
@@ -1,4 +1,4 @@
-# $Id: icp.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+# $Id$
 #
 #
 ICP Register
@@ -16,7 +16,7 @@
 	Maintainer	Distro Team
 	M_Email		distro at polserver.com
 
-	#Script	cmdlevel path
+	#Script		cmdlevel path
 
 	#TextCmd	cmdlevel path
 }



From austin at berlios.de  Sat Nov  5 23:57:00 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sat, 5 Nov 2005 23:57:00 +0100
Subject: [Poldistro-svn] r909 - in trunk/096/pkg/skills/magery: . include
Message-ID: <200511052257.jA5Mv0lO011872@sheep.berlios.de>

Author: austin
Date: 2005-11-05 23:56:59 +0100 (Sat, 05 Nov 2005)
New Revision: 909

Modified:
   trunk/096/pkg/skills/magery/include/spells.inc
   trunk/096/pkg/skills/magery/spellStarter.src
Log:


Modified: trunk/096/pkg/skills/magery/include/spells.inc
===================================================================
--- trunk/096/pkg/skills/magery/include/spells.inc	2005-11-05 12:21:46 UTC (rev 908)
+++ trunk/096/pkg/skills/magery/include/spells.inc	2005-11-05 22:56:59 UTC (rev 909)
@@ -34,7 +34,7 @@
  * MS_GetSpellsCfgElem(elem_name, cfg_file)
  *
  * Purpose
- * Retrieves an elem from a config file. 
+ * Retrieves an elem from a config file.
  *
  * Parameters
  * elem_name:	A string matching the elem name to be retrieved.
@@ -48,7 +48,7 @@
 	if ( !cfg_file )
 		cfg_file := MS_GetSpellsCfgFile();
 	endif
-	
+
 	var elem := cfg_file[elem_name];
 
 	if ( elem.errortext )
@@ -58,7 +58,7 @@
 	return elem;
 endfunction
 
-/* 
+/*
  * MS_SpellDebug(who, text)
  *
  * Purpose
@@ -86,10 +86,10 @@
 	// Apply some of spell_strength to target if reflected.
 	// Lower spell_strength by how much was not reflected.
 	// Start the spell again and point it at who from targ.
-	
+
 endfunction
 
-/* 
+/*
  * MS_Target(who, targ, prompt, flags)
  *
  * Purpose
@@ -107,18 +107,18 @@
  */
 function MS_Target(byref who, byref targ:=0, byref prompt := "Select a target.", byref flags:=TGTOPT_CHECK_LOS+TGTOPT_NEUTRAL)
 	who.hidden := 0;
-	
+
 	if ( targ.IsA(POLCLASS_UOBJECT) )
 		return targ;
 	elseif ( who.npctemplate )
 		return 0;
 	endif
-	
+
 	var orig_x := who.x;
 	var orig_y := who.y;
-	
+
 	SendSysMessage(who, prompt);
-	
+
 	targ := Target(who, flags);
 	if ( Distance(who, targ) > MAX_RANGE )
 		SendSysMessage(who, "That is too far away.");
@@ -131,7 +131,7 @@
 	endif
 endfunction
 
-/* 
+/*
  * MS_TargetCoordinates(who, targ, prompt)
  *
  * Purpose
@@ -148,19 +148,19 @@
  */
 function MS_TargetCoordinates(byref who, byref targ:=0, byref prompt := "Select a target.")
 	who.hidden := 0;
-	
+
 	if ( targ )
 		return targ;
 	elseif ( who.npctemplate )
 		return 0;
 	endif
-	
+
 	var orig_x := who.x;
 	var orig_y := who.y;
-	
+
 	SendSysMessage(who, prompt);
 	targ := TargetCoordinates(who);
-	
+
 	if ( !targ )
 		SendSysMessage(who, "Cancelled.");
 		return 0;
@@ -195,7 +195,7 @@
 	var defense := AP_GetSkill(targ, RESISTING_SPELLS);
 
 	// Failed MR check results in only half your resistance being used!
-	if ( SkillCheck(targ, "Magic_Resistance", -1) < 0 )
+	if ( SkillCheck(targ, RESISTING_SPELLS, -1) < 0 )
 		defense := CInt(defense / 2);
 	endif
 
@@ -223,6 +223,6 @@
 function ReleaseScript(pid)
 	var process := GetProcess(pid);
 	process.SendEvent("done");
-	
+
 	return 1;
 endfunction

Modified: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-05 12:21:46 UTC (rev 908)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-05 22:56:59 UTC (rev 909)
@@ -10,7 +10,7 @@
 include ":attributes:attributes";
 include ":magery:spells";
 include ":containers:containers";
-include "include/itemdesc";
+include ":itemutils:itemdesc";
 include "include/client";
 
 program SpellStarter(params)
@@ -36,14 +36,6 @@
 		return 0;
 	endif
 
-	var attribute		:= spell_elem.Attribute;
-	var delay		:= spell_elem.BaseDelay;
-	var difficulty		:= spell_elem.Difficulty;
-	var mana_cost		:= spell_elem.ManaCost;
-	if ( !attribute )
-		attribute := MAGERY;
-	endif
-
 	if ( GetObjProperty(who, "#medding") )
 		SendSysMessage(who, "You can not cast right now.");
 		return 0;
@@ -55,7 +47,7 @@
 		SendSysMessage(who, "Something prevents you from casting.");
 		FailSpell(who);
 		return 0;
-	elseif ( !ConsumeVital(who, MANA, mana_cost) )
+	elseif ( !ConsumeVital(who, MANA, spell_elem.ManaCost) )
 		SendSysMessage(who, "You are too tired to cast.");
 		FailSpell(who);
 		return 0;
@@ -65,12 +57,21 @@
 	elseif ( !EquipmentCheck(who) )
 		FailSpell(who);
 		return 0;
-	elseif ( !CheckDelay(who, attribute, difficulty, delay) )
+	elseif ( !CheckDelay(who, spell_elem) )
 		FailSpell(who);
 		SendSysMessage(who, "Your concentration has been broken.");
 		return 0;
 	else
-		var skill_check := SkillCheck(who, attribute, difficulty);
+		var attribute		:= spell_elem.Attribute;
+		if ( !attribute )
+			attribute := MAGERY;
+		endif
+		
+		var difficulty		:= spell_elem.Difficulty;
+		if ( !difficulty )
+			difficulty := -1;
+		endif
+		var skill_check 	:= SkillCheck(who, attribute, difficulty);
 		if ( skill_check > 0 )
 			var info := struct;
 			info.+script		:= spell_elem.script;
@@ -97,73 +98,34 @@
 	EraseObjProperty(who, "#medding");
 endprogram
 
-function CheckDelay(who, attribute, difficulty, base_delay)
-	if ( who.npctemplate )
-		// NPCs are allowed to move.
-		return 1;
-	endif
+function CheckDelay(who, spell_elem)
 	
 	SendSysMessage(who, "You begin building the concentration needed to cast.");
-	var equip_delay := GetEquipmentDelay(who);
-		
-	var my_x := who.x;
-	var my_y := who.y;
 	
-	var skill := AP_GetSkill(who, attribute);
-	var delay := CInt(CDbl(base_delay) * (CDbl(difficulty) / CDbl(skill)));
-	delay := delay+equip_delay;
+	var script := start_script("movementCheck", {who, GetPid()});
 	
-	if ( delay < 50 )
-		delay := 50;
-	endif
-	var script := start_script("movementCheck", {who, GetPid(), my_x, my_y});
-	
+	var delay := spell_elem.Delay;
 	MS_SpellDebug(who, "Cast delay ->"+delay);
-	
 	sleepms(delay);
 	
-	// Delay is over, stop the movement checker.
 	script.kill();
-	
-	if ( Events_Waiting() > 0 )
-		// movementCheck.ecl sent a "moved" event.
-		return 0;
-	else
-		// Player stood still and can move on.
-		return 1;
-	endif
+	return ( Events_Waiting() > 0 );
 endfunction
 
-function GetEquipmentDelay(who)
-	/*
-	var weight := 0;
-	var ar := 0;
-	foreach item in EnumeratePhysicalItems(who)
-		weight := weight+item.weight;
-		ar := ar+item.ar;
-	endforeach
-	
-	return {weight, ar};
-	*/
-	
-	var cfg := ReadConfigFile(":*:itemdesc");
-	var delay := 0;
-	foreach item in ListEquippedItems(who)
-		delay := delay+CInt(cfg[item.objtype].CastDelay);
-		sleepms(2);
-	endforeach
-	
-	return delay;
-endfunction
-
 function EquipmentCheck(who)
-	var item_cfg := ReadConfigFile(":*:itemdesc");
-	foreach item in ListEquippedItems(who)
-		if ( item_cfg[item.objtype].BlocksCastingIfInHand ) // God thats long!
+	var hand_1 := GetEquipmentByLayer(who, LAYER_HAND1);
+	if ( hand_1 )
+		if ( !hand_1.IsA(POLCLASS_SPELLBOOK) )
 			return 0;
 		endif
-		sleepms(2);
-	endforeach
+	endif
+	var hand_2 := GetEquipmentByLayer(who, LAYER_HAND2);
+	if ( hand_2 )
+		if ( !hand_2.IsA(POLCLASS_SPELLBOOK) )
+			return 0;
+		endif
+	endif
+	
 	return 1;
 endfunction
 
@@ -207,4 +169,6 @@
 	EraseObjProperty(who, "#medding");
 	PlayObjectCenteredEffect(who, GFX_SPELL_FAIL, 5, 50);
 	PlaySoundEffect(who, SFX_SPELL_FAIL);
+	
+	return 1;
 endfunction



From austin at berlios.de  Sun Nov  6 00:11:08 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 00:11:08 +0100
Subject: [Poldistro-svn] r910 - in trunk/096: pkg/items/repaircontract pkg/mobiles/oldAI pkg/mobiles/oldAI/combat pkg/mobiles/oldAI/main pkg/skills/healing pkg/skills/lockpicking pkg/skills/mining pkg/skills/tailoring pkg/skills/tinkering pkg/skills/veterinary pkg/systems/combat/old pkg/systems/combat/useScripts pkg/systems/merchantnodes pkg/systems/spellcasting scripts/include/OLD scripts/util
Message-ID: <200511052311.jA5NB87k013006@sheep.berlios.de>

Author: austin
Date: 2005-11-06 00:11:06 +0100 (Sun, 06 Nov 2005)
New Revision: 910

Modified:
   trunk/096/pkg/items/repaircontract/repairDeed.src
   trunk/096/pkg/mobiles/oldAI/animal.src
   trunk/096/pkg/mobiles/oldAI/barber.src
   trunk/096/pkg/mobiles/oldAI/barker.src
   trunk/096/pkg/mobiles/oldAI/battleMage.src
   trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
   trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src
   trunk/096/pkg/mobiles/oldAI/cat.src
   trunk/096/pkg/mobiles/oldAI/chicken.src
   trunk/096/pkg/mobiles/oldAI/combat/bladeFight.inc
   trunk/096/pkg/mobiles/oldAI/combat/defaultCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/fight.inc
   trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/immobileFight.inc
   trunk/096/pkg/mobiles/oldAI/combat/packFight.inc
   trunk/096/pkg/mobiles/oldAI/combat/spellCombatEvent.inc
   trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc
   trunk/096/pkg/mobiles/oldAI/crier.src
   trunk/096/pkg/mobiles/oldAI/davesHealer.src
   trunk/096/pkg/mobiles/oldAI/dumbKillPCs.src
   trunk/096/pkg/mobiles/oldAI/employed.src
   trunk/096/pkg/mobiles/oldAI/entranced.src
   trunk/096/pkg/mobiles/oldAI/escortee.src
   trunk/096/pkg/mobiles/oldAI/firebreather.src
   trunk/096/pkg/mobiles/oldAI/goodCaster.src
   trunk/096/pkg/mobiles/oldAI/helpPCs.src
   trunk/096/pkg/mobiles/oldAI/immobile.src
   trunk/096/pkg/mobiles/oldAI/immobileSpell.src
   trunk/096/pkg/mobiles/oldAI/killAny.src
   trunk/096/pkg/mobiles/oldAI/killPCs.src
   trunk/096/pkg/mobiles/oldAI/main/closeDistance.inc
   trunk/096/pkg/mobiles/oldAI/main/killPCsLoop.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoop.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopAnimal.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopBarker.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopCat.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopChicken.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopCow.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopKillAny.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopMeek.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc
   trunk/096/pkg/mobiles/oldAI/main/mainLoopWolf.inc
   trunk/096/pkg/mobiles/oldAI/main/meanLoop.inc
   trunk/096/pkg/mobiles/oldAI/main/packKillPCsLoop.inc
   trunk/096/pkg/mobiles/oldAI/meek.src
   trunk/096/pkg/mobiles/oldAI/merchant.src
   trunk/096/pkg/mobiles/oldAI/packFirebreather.src
   trunk/096/pkg/mobiles/oldAI/person.src
   trunk/096/pkg/mobiles/oldAI/poisonElemental.src
   trunk/096/pkg/mobiles/oldAI/poisonKillPCs.src
   trunk/096/pkg/mobiles/oldAI/slime.src
   trunk/096/pkg/mobiles/oldAI/spellFire.src
   trunk/096/pkg/mobiles/oldAI/spellKillPCs.src
   trunk/096/pkg/mobiles/oldAI/spiders.src
   trunk/096/pkg/mobiles/oldAI/tamed.src
   trunk/096/pkg/mobiles/oldAI/townGuard.src
   trunk/096/pkg/mobiles/oldAI/townHealer.src
   trunk/096/pkg/mobiles/oldAI/townPerson.src
   trunk/096/pkg/mobiles/oldAI/undead.src
   trunk/096/pkg/mobiles/oldAI/undeadKillPCs.src
   trunk/096/pkg/mobiles/oldAI/vortexAI.src
   trunk/096/pkg/mobiles/oldAI/wolf.src
   trunk/096/pkg/mobiles/oldAI/worker.src
   trunk/096/pkg/skills/healing/healing.src
   trunk/096/pkg/skills/lockpicking/lockpicking.src
   trunk/096/pkg/skills/mining/mining.src
   trunk/096/pkg/skills/tailoring/makeClothItems.src
   trunk/096/pkg/skills/tailoring/tailoringFunctions.inc
   trunk/096/pkg/skills/tinkering/tinkerTraps.src
   trunk/096/pkg/skills/veterinary/vet.src
   trunk/096/pkg/systems/combat/old/bladed.src
   trunk/096/pkg/systems/combat/useScripts/bladed.src
   trunk/096/pkg/systems/merchantnodes/guardNodeControl.src
   trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src
   trunk/096/pkg/systems/spellcasting/spellcast.src
   trunk/096/scripts/include/OLD/spellRestrictions.inc
   trunk/096/scripts/util/repair.inc
Log:
dist() to Distance()
coordist() to CoordinateDistance()

Modified: trunk/096/pkg/items/repaircontract/repairDeed.src
===================================================================
--- trunk/096/pkg/items/repaircontract/repairDeed.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/items/repaircontract/repairDeed.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -3,7 +3,6 @@
 use cfgfile;
 
 include ":itemutils:canAccess";
-include "include/dist";
 
 program usescript_repairDeed(who, deed)
 
@@ -105,7 +104,7 @@
     SendSysMessage(who, "You cannot repair that");
     return;
   endif
-  if((!Accessible(who, use_on)) or (dist(who, use_on) > 2))
+  if((!Accessible(who, use_on)) or (Distance(who, use_on) > 2))
     SendSysMessage(who, "You cannot reach that");
     return;
   endif

Modified: trunk/096/pkg/mobiles/oldAI/animal.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/animal.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/animal.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -8,7 +8,6 @@
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopAnimal";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/barber.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/barber.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/barber.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -12,7 +12,6 @@
 include "include/client";
 include ":npcutils:anchors";
 include "include/findCity";
-include "include/dist";
 include ":begging:begging";
 include ":attributes:attributes";
 include ":npcutils:trainSkill";
@@ -141,7 +140,7 @@
 		if(ReadGameClock() >= next_wander)
 			begpurse(me);
 			wander();
-			if(coordist(me.x, me.y, myanchor[1], myanchor[2]) > 5)
+			if(CoordinateDistance(me.x, me.y, myanchor[1], myanchor[2]) > 5)
 				MoveCharacterToLocation(me, myanchor[1], myanchor[2], myanchor[3], MOVECHAR_FORCELOCATION);
 			endif
 			next_wander := ReadGameClock() +(RandomInt(9) + 21);

Modified: trunk/096/pkg/mobiles/oldAI/barker.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/barker.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/barker.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -8,7 +8,6 @@
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopBarker";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/battleMage.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/battleMage.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/battleMage.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -5,11 +5,10 @@
 
 include "include/client";
 include ":attributes:attributes";
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";
-include "include/dist";
 include ":npcutils:anchors";
 include ":npcutils:NPCBackpacks";
 include "include/skillLists";
@@ -58,7 +57,7 @@
       endcase
 	endif
 	if(ReadGameClock() >= next_wander)
-      if(coordist(me.x, me.y, myanchor[1], myanchor[2]) > 15)
+      if( CoordinateDistance(me.x, me.y, myanchor[1], myanchor[2]) > 15)
         MoveCharacterToLocation(me, myanchor[1], myanchor[2], myanchor[3], MOVECHAR_FORCELOCATION);
       endif
       next_wander := ReadGameClock() + 10;
@@ -72,7 +71,7 @@
 
 function WanderMe()
   wander();
-  if(coordist(me.x, me.y, myanchor[1], myanchor[2]) > 15)
+  if(CoordinateDistance(me.x, me.y, myanchor[1], myanchor[2]) > 15)
     MoveCharacterToLocation(me, myanchor[1], myanchor[2], myanchor[3], MOVECHAR_FORCELOCATION);
   endif
 endfunction

Modified: trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -10,7 +10,6 @@
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
 include ":npcutils:anchors";
-include "include/dist";
 include ":oldAI:main/setup";
 include ":oldAI:main/sleepMode";
 include ":npcutils:animal";
@@ -91,7 +90,7 @@
   prepare_for_fight(opponent);
   var loops := 0;
   waittime := 0;
-  while((opponent) && not (opponent.dead || opponent.hidden || opponent.concealed) && (dist(me,opponent) < 20) )
+  while((opponent) && not (opponent.dead || opponent.hidden || opponent.concealed) && (Distance(me,opponent) < 20) )
 	if(!CloseDistance(opponent))
 	  loops := loops + 1;
 	  waittime := 0;
@@ -208,7 +207,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -225,7 +224,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -12,7 +12,6 @@
 include ":npcutils:NPCBackpacks";
 include "include/client";
 include ":npcutils:anchors";
-include "include/dist";
 include "include/findCity";
 include ":begging:begging";
 include ":npcutils:trainSkill";
@@ -132,7 +131,7 @@
 	if(ReadGameClock() >= next_wander)
 	  begpurse(me);
       wander();
-      if(coordist(me.x, me.y, myanchor[1], myanchor[2]) > 5)
+      if(CoordinateDistance(me.x, me.y, myanchor[1], myanchor[2]) > 5)
         MoveCharacterToLocation(me, myanchor[1], myanchor[2], myanchor[3], MOVECHAR_FORCELOCATION);
       endif
       next_wander := ReadGameClock() + 30;

Modified: trunk/096/pkg/mobiles/oldAI/cat.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/cat.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/cat.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -8,7 +8,6 @@
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopCat";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/chicken.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/chicken.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/chicken.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -8,7 +8,6 @@
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopChicken";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/combat/bladeFight.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/bladeFight.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/combat/bladeFight.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -10,7 +10,7 @@
   var loops := 0;
   var ev;
   var waittime := 0;
-  while((opponent) && not (opponent.dead || opponent.hidden || opponent.concealed) && (dist(me,opponent) < 20) )
+  while((opponent) && not (opponent.dead || opponent.hidden || opponent.concealed) && (Distance(me,opponent) < 20) )
 	if(!CloseDistance(opponent))
 	  loops := loops + 1;
 	  waittime := 0;

Modified: trunk/096/pkg/mobiles/oldAI/combat/defaultCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/defaultCombatEvent.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/combat/defaultCombatEvent.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -13,7 +13,7 @@
 
 function in_combat_event_loop(opponent, loops)
   if(loops > 50)
-    if((dist(me, opponent) > 12) && (!CheckLineOfSight(me, opponent)))
+    if((Distance(me, opponent) > 12) && (!CheckLineOfSight(me, opponent)))
 	  RestartScript(me);
 	  return;
     endif

Modified: trunk/096/pkg/mobiles/oldAI/combat/fight.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/fight.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/combat/fight.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -10,7 +10,7 @@
   TurnToward(opponent);
   var loops := 0;
 
-  while((opponent) && (!opponent.dead) && (!opponent.hidden) && (!opponent.concealed) && (dist(me,opponent) < 20))
+  while((opponent) && (!opponent.dead) && (!opponent.hidden) && (!opponent.concealed) && (Distance(me,opponent) < 20))
 	if(!CloseDistance(opponent))
 	  loops := loops + 1;
 	  waittime := 0;
@@ -26,7 +26,7 @@
                             opponent := ev.source;
 			  		        SetOpponent(opponent);
 					        TurnToward(opponent);
-                          elseif((dist(me, ev.source) < dist(me, opponent)) || (!CheckLineOfSight(me, opponent)) || (!opponent))
+                          elseif((Distance(me, ev.source) < Distance(me, opponent)) || (!CheckLineOfSight(me, opponent)) || (!opponent))
 					        opponent := ev.source;
 			  		        SetOpponent(opponent);
 					        TurnToward(opponent);
@@ -84,7 +84,7 @@
 	  WalkAwayFrom(opponent);
 	  runs := runs +1;
 	  case (ev.type)
-        SYSEVENT_DAMAGED: if(((ev.source.npctemplate) and (CheckLineOfSight(me, ev.source))) ||(dist(me, ev.source) < dist(me, opponent)) || (!CheckLineOfSight(me, opponent)) || (!opponent) || (RandomInt(3)==1))
+        SYSEVENT_DAMAGED: if(((ev.source.npctemplate) and (CheckLineOfSight(me, ev.source))) ||(Distance(me, ev.source) < Distance(me, opponent)) || (!CheckLineOfSight(me, opponent)) || (!opponent) || (RandomInt(3)==1))
 					        opponent := ev.source;
 			  		        SetOpponent(opponent);
 			              endif

Modified: trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -15,7 +15,7 @@
   if(RandomInt(4) != 1)
     return;
   endif
-  if(CheckLineOfSight(me, opponent) && (dist(me, opponent) < 10))
+  if(CheckLineOfSight(me, opponent) && (Distance(me, opponent) < 10))
     PerformAction(me,0x0c);
     sleep(1);
     PlaySoundEffect(me, 0x16b);

Modified: trunk/096/pkg/mobiles/oldAI/combat/immobileFight.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/immobileFight.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/combat/immobileFight.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -10,7 +10,7 @@
   TurnToward(opponent);
   var loops := 0;
   waittime := 0;
-  while((opponent) && not (opponent.dead || opponent.hidden || opponent.concealed) && (dist(me,opponent) < 20) )
+  while((opponent) && not (opponent.dead || opponent.hidden || opponent.concealed) && (Distance(me,opponent) < 20) )
 	if(!CloseDistance(opponent))
 	  loops := loops + 1;
 	  waittime := 0;
@@ -21,7 +21,7 @@
 	process_combat_event(opponent);
 	ev := wait_for_event(waittime);
 	case (ev.type)
-      SYSEVENT_DAMAGED: if((dist(me, ev.source) < dist(me, opponent)) || (!CheckLineOfSight(me, opponent)) || (!opponent))
+      SYSEVENT_DAMAGED: if((Distance(me, ev.source) < Distance(me, opponent)) || (!CheckLineOfSight(me, opponent)) || (!opponent))
 					      opponent := ev.source;
 			  		      SetOpponent(opponent);
 					      TurnToward(opponent);

Modified: trunk/096/pkg/mobiles/oldAI/combat/packFight.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/packFight.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/combat/packFight.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -17,7 +17,7 @@
   TurnToward( opponent );
   var loops := 0;
   waittime := 0;
-  while ( (opponent) && not (opponent.dead || opponent.hidden || opponent.concealed) && (dist(me,opponent) < 20) )
+  while ( (opponent) && not (opponent.dead || opponent.hidden || opponent.concealed) && (Distance(me,opponent) < 20) )
     if (!CloseDistance( opponent ) )
       loops := loops + 1;
       waittime := 0;

Modified: trunk/096/pkg/mobiles/oldAI/combat/spellCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/spellCombatEvent.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/combat/spellCombatEvent.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -33,7 +33,7 @@
 function spellattack(opponent)
   if(LAST_BREATH > ReadGameClock())
     return;
-  elseif((CheckLineOfSight(me, opponent)) and (dist(me, opponent) <= 12))
+  elseif((CheckLineOfSight(me, opponent)) and (Distance(me, opponent) <= 12))
     cast_offensive_spell(me, opponent);
     LAST_BREATH := Cint(ReadGameClock() + (RandomInt(4) + 4));
   endif

Modified: trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/combat/spellFireEvent.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -35,7 +35,7 @@
   if(LAST_BREATH > ReadGameClock())
     return;
   endif
-  if((CheckLineOfSight(me, opponent)) and (dist(me, opponent) <= 15))
+  if((CheckLineOfSight(me, opponent)) and (Distance(me, opponent) <= 15))
     if(RandomInt(4) == 1)
       PerformAction(me,0x0c);
       PlaySoundEffect(me, 0x16b);

Modified: trunk/096/pkg/mobiles/oldAI/crier.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/crier.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/crier.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -10,7 +10,6 @@
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopCrier";
 include ":oldAI:combat/fight";
@@ -71,7 +70,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     1:
     0:       return 1;
     default: WalkTowardLocation(lx, ly);

Modified: trunk/096/pkg/mobiles/oldAI/davesHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/davesHealer.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/davesHealer.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -9,7 +9,6 @@
 include ":npcutils:vetement";
 include "include/eventID";
 include "include/sysEvent";
-include "include/dist";
 include ":npcutils:anchors";
 include ":npcutils:speech";
 include "include/client";
@@ -76,7 +75,7 @@
   SetOpponent(opponent);
   var waittime;
   outer:
-  while (opponent && not (opponent.dead || opponent.hidden || opponent.concealed) && (dist(me,opponent) < 15))
+  while (opponent && not (opponent.dead || opponent.hidden || opponent.concealed) && (Distance(me,opponent) < 15))
     waittime := CloseDistance(opponent) * 15;
     var ev := wait_for_event(waittime);
     repeat

Modified: trunk/096/pkg/mobiles/oldAI/dumbKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/dumbKillPCs.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/dumbKillPCs.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -9,7 +9,6 @@
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/employed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -9,7 +9,6 @@
 include ":npcutils:NPCBackpacks";
 include ":npcutils:NPCCast";
 include ":npcutils:names";
-include "include/dist";
 include ":timedscripts:timedScripts";
 
 set_priority(5);
@@ -281,7 +280,7 @@
   SetOpponent(opponent);
   var ev;
   var loops := 0;
-  while((opponent) && (!opponent.dead || !opponent.hidden || !opponent.concealed) && (dist(me,opponent) < 15))
+  while((opponent) && (!opponent.dead || !opponent.hidden || !opponent.concealed) && (Distance(me,opponent) < 15))
 	if(!CloseDistance(opponent))
 	  loops := loops + 1;
 	  waittime := 0;
@@ -462,7 +461,7 @@
       return;
     endforeach
   endif
-  if( (!AP_GetStat(guarding, "Strength")) || (guarding.dead) || (dist(me,guarding) > 15) )
+  if( (!AP_GetStat(guarding, "Strength")) || (guarding.dead) || (Distance(me,guarding) > 15) )
     guarding := 0;
   endif
 endfunction
@@ -490,7 +489,7 @@
       waittime := 0;
     endif
   endif
-  if( (!AP_GetStat(escortee, "Strength")) || (escortee.dead) || (dist(me,escortee) > 15) )
+  if( (!AP_GetStat(escortee, "Strength")) || (escortee.dead) || (Distance(me,escortee) > 15) )
     guarding := 0;
   endif
   if(guarding)

Modified: trunk/096/pkg/mobiles/oldAI/entranced.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/entranced.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/entranced.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -6,7 +6,6 @@
 include "include/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
-include "include/dist";
 
 var me := Self();
 

Modified: trunk/096/pkg/mobiles/oldAI/escortee.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -7,7 +7,6 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:anchors";
-include "include/dist";
 include ":oldAI:main/mainLoopGood";
 include ":oldAI:combat/animalCombatEvent";
 include ":oldAI:combat/fight";
@@ -194,7 +193,7 @@
       waittime := 0;
     endif
   endif
-  if((!AP_GetStat(escortee, "Strength")) || (escortee.dead) || (dist(me,escortee) > 15) )
+  if((!AP_GetStat(escortee, "Strength")) || (escortee.dead) || (Distance(me,escortee) > 15) )
     following := 0;
   endif
 endfunction
@@ -222,7 +221,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -239,7 +238,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/firebreather.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/firebreather.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/firebreather.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -10,7 +10,6 @@
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/goodCaster.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/goodCaster.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/goodCaster.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -9,7 +9,6 @@
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
 include ":npcutils:speech";
-include "include/dist";
 include ":npcutils:NPCCast";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopGood";
@@ -61,7 +60,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -78,7 +77,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/helpPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/helpPCs.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/helpPCs.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -9,7 +9,6 @@
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:speech";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopGood";
@@ -56,7 +55,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -73,7 +72,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/immobile.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/immobile.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/immobile.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -9,7 +9,6 @@
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopImmobile";
 include ":oldAI:combat/fight";
@@ -50,7 +49,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -67,7 +66,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/immobileSpell.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/immobileSpell.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/immobileSpell.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -26,7 +26,6 @@
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopImmobile";
 include ":oldAI:combat/immobileFight";
@@ -69,7 +68,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -86,7 +85,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/killAny.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/killAny.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/killAny.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -26,7 +26,6 @@
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
 include ":npcutils:anchors";
-include "include/dist";
 include ":oldAI:main/mainLoopKillAny";
 include ":oldAI:combat/fight";
 include ":oldAI:main/defaultNonCombatEvent";

Modified: trunk/096/pkg/mobiles/oldAI/killPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/killPCs.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/killPCs.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -10,7 +10,6 @@
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/main/closeDistance.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/closeDistance.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/closeDistance.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -45,18 +45,18 @@
   for X:=1 to 24
     sleepms(1);
     if (CheckLOSat(me, me.x + X - 12, me.y, me.z) and CheckLOSat(destination, me.x + X - 12, me.y, me.z))
-      if(coordist(destination.x , destination.y , me.x+X-12 , me.y) < maxdist)
+      if(CoordinateDistance(destination.x , destination.y , me.x+X-12 , me.y) < maxdist)
         dX := me.x+X-12;
         dY := me.y;
-        maxdist := coordist(destination.x , destination.y , me.x+X-12 , me.y );
+        maxdist := CoordinateDistance(destination.x , destination.y , me.x+X-12 , me.y );
       endif
     else
       for Y:=1 to 24
         if(CheckLOSat(me, me.x + X - 12, me.y + Y - 12, me.z) and CheckLOSat(destination, me.x+X-12, me.y+Y-12, me.z))
-          if(coordist(destination.x , destination.y , me.x+X-12 , me.y+Y-12 ) < maxdist)
+          if(CoordinateDistance(destination.x , destination.y , me.x+X-12 , me.y+Y-12 ) < maxdist)
             dX := me.x+X-12;
             dY := me.y+Y-12;
-            maxdist := coordist(destination.x , destination.y , me.x + X - 12 , me.y);
+            maxdist := CoordinateDistance(destination.x , destination.y , me.x + X - 12 , me.y);
           endif
         endif
       endfor
@@ -80,7 +80,7 @@
       chk := chk + 1;
     endif
     lastface := face;
-  until((coordist( me.x , me.y , x , y ) <= 0) or (chk > 1));
+  until((CoordinateDistance( me.x , me.y , x , y ) <= 0) or (chk > 1));
   if(chk > 1)
     return 1;
   endif

Modified: trunk/096/pkg/mobiles/oldAI/main/killPCsLoop.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/killPCsLoop.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/killPCsLoop.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -72,7 +72,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -89,7 +89,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoop.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoop.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoop.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -71,7 +71,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -88,7 +88,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopAnimal.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopAnimal.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopAnimal.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -24,7 +24,7 @@
 
 function RunLikeHell(opponent)
   var ev;
-  while((opponent)&& not(opponent.dead || opponent.hidden || opponent.concealed)&&(dist(me,opponent)< 25))
+  while((opponent)&& not(opponent.dead || opponent.hidden || opponent.concealed)&&(Distance(me,opponent)< 25))
     WalkAwayFrom(opponent);
     repeat
       case(ev.type)
@@ -62,7 +62,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -79,7 +79,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopBarker.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopBarker.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopBarker.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -27,7 +27,7 @@
 endfunction
 
 function RunLikeHell(opponent)
-  while((opponent)&& not(opponent.dead || opponent.hidden || opponent.concealed)&&(dist(me,opponent)< 25))
+  while((opponent)&& not(opponent.dead || opponent.hidden || opponent.concealed)&&(Distance(me,opponent)< 25))
     WalkAwayFrom(opponent);
     repeat
       case(ev.type)
@@ -121,7 +121,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -138,7 +138,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopCat.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopCat.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopCat.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -62,7 +62,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -79,7 +79,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopChicken.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopChicken.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopChicken.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -40,7 +40,7 @@
 endfunction
 
 function RunLikeHell(opponent)
-  while((opponent)&& not (opponent.dead || opponent.hidden || opponent.concealed)&& (dist(me,opponent)< 25))
+  while((opponent)&& not (opponent.dead || opponent.hidden || opponent.concealed)&& (Distance(me,opponent)< 25))
     RunAwayFrom(opponent);
     repeat
     until(!(ev := os::wait_for_event(1)));
@@ -76,7 +76,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -93,7 +93,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopCow.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopCow.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopCow.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -31,7 +31,7 @@
 
 function RunLikeHell(opponent)
 
-  while((opponent)&& not(opponent.dead || opponent.hidden || opponent.concealed)&&(dist(me,opponent)< 25))
+  while((opponent)&& not(opponent.dead || opponent.hidden || opponent.concealed)&&(Distance(me,opponent)< 25))
     WalkAwayFrom(opponent);
     repeat
       case(ev.type)
@@ -70,7 +70,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -87,7 +87,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopKillAny.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopKillAny.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopKillAny.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -61,7 +61,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -78,7 +78,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopMeek.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopMeek.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopMeek.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -72,7 +72,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -89,7 +89,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -54,7 +54,7 @@
 
 function RunLikeHell(opponent)
   opponent := opponent;
-  while((opponent) && not (opponent.dead || opponent.hidden || opponent.concealed) && (dist(me,opponent) < 25))
+  while((opponent) && not (opponent.dead || opponent.hidden || opponent.concealed) && (Distance(me,opponent) < 25))
         RunAwayFrom(opponent);
     repeat
         case (ev.type)
@@ -96,7 +96,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -113,7 +113,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopWolf.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopWolf.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopWolf.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -87,7 +87,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -104,7 +104,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/meanLoop.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/meanLoop.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/meanLoop.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -74,7 +74,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -91,7 +91,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/main/packKillPCsLoop.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/packKillPCsLoop.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/main/packKillPCsLoop.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -119,7 +119,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -136,7 +136,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/meek.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/meek.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/meek.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -26,7 +26,6 @@
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
 include ":npcutils:speech";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopMeek";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/merchant.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/merchant.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/merchant.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -12,7 +12,6 @@
 include "include/client";
 include ":npcutils:anchors";
 include "include/findCity";
-include "include/dist";
 include ":begging:begging";
 include ":attributes:attributes";
 include ":npcutils:trainSkill";
@@ -125,7 +124,7 @@
 	if(ReadGameClock() >= next_wander)
 	  begpurse(me);
       wander();
-      if(coordist(me.x, me.y, myanchor[1], myanchor[2]) > 5)
+      if(CoordinateDistance(me.x, me.y, myanchor[1], myanchor[2]) > 5)
         MoveCharacterToLocation(me, myanchor[1], myanchor[2], myanchor[3], MOVECHAR_FORCELOCATION);
       endif
       next_wander := ReadGameClock() + 30;

Modified: trunk/096/pkg/mobiles/oldAI/packFirebreather.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/packFirebreather.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/packFirebreather.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -10,7 +10,6 @@
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/packKillPCsLoop";
 include ":oldAI:combat/packFight";

Modified: trunk/096/pkg/mobiles/oldAI/person.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/person.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/person.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -19,7 +19,6 @@
 include ":npcutils:vetement";
 include ":npcutils:speech";
 include ":npcutils:anchors";
-include "include/dist";
 include ":oldAI:main/loot";
 include ":begging:begging";
 

Modified: trunk/096/pkg/mobiles/oldAI/poisonElemental.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -10,7 +10,6 @@
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:NPCCast";
 include ":npcutils:anchors";
 include "include/spellRestrictions";
@@ -84,7 +83,7 @@
   if(LAST_BREATH > ReadGameClock())
     return;
   endif
-  if((CheckLineOfSight(me, opponent)) and (dist(me, opponent) <= 15))
+  if((CheckLineOfSight(me, opponent)) and (Distance(me, opponent) <= 15))
     cast_offensive_spell(me, opponent);
     LAST_BREATH := Cint(ReadGameClock() + (RandomInt(4) + 4));
   endif

Modified: trunk/096/pkg/mobiles/oldAI/poisonKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/poisonKillPCs.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/poisonKillPCs.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -8,7 +8,6 @@
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/slime.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/slime.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/slime.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -8,7 +8,6 @@
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/spellFire.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/spellFire.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/spellFire.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -10,7 +10,6 @@
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:NPCCast";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";

Modified: trunk/096/pkg/mobiles/oldAI/spellKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/spellKillPCs.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/spellKillPCs.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -11,7 +11,6 @@
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:NPCCast";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";

Modified: trunk/096/pkg/mobiles/oldAI/spiders.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/spiders.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/spiders.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -8,7 +8,6 @@
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/tamed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -9,7 +9,6 @@
 include ":npcutils:NPCBackpacks";
 include ":npcutils:NPCCast";
 include ":npcutils:names";
-include "include/dist";
 include "include/snooping";
 include "include/tileEffects";
 
@@ -203,7 +202,7 @@
   var ev;
   var loops := 0;
   var f_waittime := 0;
-  while((opponent) && (!opponent.dead || !opponent.hidden || !opponent.concealed)&&(dist(me,opponent)< 15))
+  while((opponent) && (!opponent.dead || !opponent.hidden || !opponent.concealed)&&(Distance(me,opponent)< 15))
     if(!CloseDistance(opponent))
       loops := loops + 1;
       f_waittime := 0;
@@ -254,7 +253,7 @@
     endif
     if(firebreather and caster)
       if(LAST_BREATH <= ReadGameClock())
-        if((CheckLineOfSight(me, opponent)) and (dist(me, opponent) <= 15))
+        if((CheckLineOfSight(me, opponent)) and (Distance(me, opponent) <= 15))
           if(RandomInt(4) == 1)
             cast_meteor(opponent);
           else
@@ -265,7 +264,7 @@
       endif
     elseif(caster)
       if(LAST_BREATH <= ReadGameClock())
-        if((CheckLineOfSight(me, opponent)) and (dist(me, opponent) <= 15))
+        if((CheckLineOfSight(me, opponent)) and (Distance(me, opponent) <= 15))
           cast_offensive_spell(me, opponent);
           LAST_BREATH := Cint(ReadGameClock() + (RandomInt(4) + 4));
         endif
@@ -611,7 +610,7 @@
       return;
     endforeach
   endif
-  if((!AP_GetStat(guarding, "Strength"))||(guarding.dead)||(dist(me,guarding)> 15))
+  if((!AP_GetStat(guarding, "Strength"))||(guarding.dead)||(Distance(me,guarding)> 15))
     guarding := 0;
   endif
 endfunction

Modified: trunk/096/pkg/mobiles/oldAI/townGuard.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townGuard.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/townGuard.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -9,7 +9,6 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";
-include "include/dist";
 include ":npcutils:anchors";
 include ":npcutils:NPCBackpacks";
 include ":begging:begging";
@@ -81,7 +80,7 @@
 
 function WanderMe()
   wander();
-  if(coordist(me.x, me.y, myanchor[1], myanchor[2]) > 15)
+  if(CoordinateDistance(me.x, me.y, myanchor[1], myanchor[2]) > 15)
     MoveCharacterToLocation(me, myanchor[1], myanchor[2], myanchor[3], MOVECHAR_FORCELOCATION);
   endif
 endfunction
@@ -161,7 +160,7 @@
   var loops := 0;
   var ev;
   var waittime := 0;
-  while((opponent) && (!opponent.dead) && (!opponent.hidden) && (!opponent.concealed) && (dist(me,opponent) < 20))
+  while((opponent) && (!opponent.dead) && (!opponent.hidden) && (!opponent.concealed) && (Distance(me,opponent) < 20))
 	if(!CloseDistance(opponent))
 	  loops := loops + 1;
 	  waittime := 0;

Modified: trunk/096/pkg/mobiles/oldAI/townHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townHealer.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/townHealer.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -13,7 +13,6 @@
 include ":npcutils:NPCBackpacks";
 include "include/client";
 include ":npcutils:anchors";
-include "include/dist";
 include "include/resurrection";
 include "include/findCity";
 include ":begging:begging";
@@ -128,7 +127,7 @@
 	if(ReadGameClock() >= next_wander)
 	  begpurse(me);
       wander();
-      if(coordist(me.x, me.y, myanchor[1], myanchor[2]) > 5)
+      if(CoordinateDistance(me.x, me.y, myanchor[1], myanchor[2]) > 5)
         MoveCharacterToLocation(me, myanchor[1], myanchor[2], myanchor[3], MOVECHAR_FORCELOCATION);
       endif
       next_wander := ReadGameClock() + 30;

Modified: trunk/096/pkg/mobiles/oldAI/townPerson.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -8,7 +8,6 @@
 include ":npcutils:names";
 include ":npcutils:speech";
 include ":npcutils:anchors";
-include "include/dist";
 include ":oldAI:main/mainLoopGood";
 include ":oldAI:combat/warriorcombatevent";
 include ":oldAI:combat/fight";
@@ -218,7 +217,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -235,7 +234,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/undead.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/undead.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/undead.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -10,7 +10,6 @@
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 
 const HALT_THRESHOLD := 8; // how close before he attacks?
@@ -76,7 +75,7 @@
   var loops := 0;
   var ev;
   var waittime := 0;
-  while((opponent) && (!opponent.dead) && (!opponent.hidden) && (!opponent.concealed) && (dist(me,opponent) < 20))
+  while((opponent) && (!opponent.dead) && (!opponent.hidden) && (!opponent.concealed) && (Distance(me,opponent) < 20))
 	if(!CloseDistance(opponent))
 	  loops := loops + 1;
 	  waittime := 0;
@@ -110,7 +109,7 @@
 
 function in_combat_event_loop(opponent, loops)
   if(loops > 50)
-    if((dist(me, opponent) > 12) && (!CheckLineOfSight(me, opponent)))
+    if((Distance(me, opponent) > 12) && (!CheckLineOfSight(me, opponent)))
 	  RestartScript(me);
 	  return;
     endif

Modified: trunk/096/pkg/mobiles/oldAI/undeadKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/undeadKillPCs.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/undeadKillPCs.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -9,7 +9,6 @@
 include ":npcutils:vetement";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/killPCsLoop";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/vortexAI.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/vortexAI.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/vortexAI.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -9,7 +9,6 @@
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:combat/vortexCombatEvent";
 include ":oldAI:setup/setup";
@@ -84,7 +83,7 @@
   TurnToward(opponent);
   var loops := 0;
   waittime := 0;
-  while((opponent) && (!opponent.dead) && (!opponent.hidden) && (!opponent.concealed) && (dist(me,opponent) < 20))
+  while((opponent) && (!opponent.dead) && (!opponent.hidden) && (!opponent.concealed) && (Distance(me,opponent) < 20))
 	if(!CloseDistance(opponent))
 	  loops := loops + 1;
 	  waittime := 0;
@@ -156,7 +155,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -173,7 +172,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/mobiles/oldAI/wolf.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/wolf.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/wolf.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -8,7 +8,6 @@
 include ":npcutils:names";
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
-include "include/dist";
 include ":npcutils:anchors";
 include ":oldAI:main/mainLoopWolf";
 include ":oldAI:combat/fight";

Modified: trunk/096/pkg/mobiles/oldAI/worker.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -8,7 +8,6 @@
 include ":npcutils:names";
 include ":npcutils:speech";
 include ":npcutils:anchors";
-include "include/dist";
 include ":oldAI:main/mainLoopGood";
 include ":oldAI:combat/warriorcombatevent";
 include ":oldAI:combat/fight";
@@ -307,7 +306,7 @@
 	  loops := 0;
 	  waittime := 1;
 	endif
-	if((loops >= 30) or (coordist(me.x, me.y, lx, ly) <= 1))
+	if((loops >= 30) or (CoordinateDistance(me.x, me.y, lx, ly) <= 1))
 	  break;
 	endif
 	ev := wait_for_event(waittime);
@@ -324,7 +323,7 @@
 endfunction
 
 function CloseIn(me, lx, ly)
-  case (coordist(me.x, me.y, lx, ly))
+  case (CoordinateDistance(me.x, me.y, lx, ly))
     0:       return 1;
     default: WalkTowardLocation(lx, ly);
              return 0;

Modified: trunk/096/pkg/skills/healing/healing.src
===================================================================
--- trunk/096/pkg/skills/healing/healing.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/skills/healing/healing.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -4,7 +4,6 @@
 use util;
 use cfgfile;
 
-include "include/dist";
 include "include/client";
 include "include/resurrection";
 include ":itemutils:canAccess";
@@ -30,7 +29,7 @@
 		return;
 	endif
 	var poisons := TS_GetTimerNames(patient, "P");
-	if(dist(who, patient) >= 2)
+	if(Distance(who, patient) >= 2)
 		SendSysMessage(who, "Your patient is too far away.");
 		return;
 	elseif(!CheckLineOfSight(who,patient))
@@ -72,7 +71,7 @@
 						resurrect_pc(who, patient, 0);
 					endif
 				endif
-			elseif(dist(who, patient) > 1)
+			elseif(Distance(who, patient) > 1)
 				SendSysMessage(who, "Your patient is too far away.");
 			elseif(!CheckLineOfSight(who, patient))
 				SendSysMessage(who,"You can't see your patient.");
@@ -100,7 +99,7 @@
 						resurrect_pc(who, patient, 0);
 					endif
 				endif
-			elseif(dist(who, patient) > 1)
+			elseif(Distance(who, patient) > 1)
 				SendSysMessage(who, "Your patient is too far away.");
 			elseif(!CheckLineOfSight(who, patient))
 				SendSysMessage(who,"You can't see your patient.");
@@ -120,7 +119,7 @@
 			SendSysMessage(who, "You have no chance of reviving your patient.");
 		elseif(!CheckLineOfSight(who,patient))
 			SendSysMessage(who,"You can't see your patient anymore.");
-		elseif(dist(who, patient) > 1)
+		elseif(Distance(who, patient) > 1)
 			SendSysMessage(who, "Your patient is too far away.");
 		elseif(SubtractAmount(item, 1))
 			resurrect_pc(who, patient, 0);
@@ -131,7 +130,7 @@
 
 // Send the animals to vet.
 	elseif(patient.npctemplate)
-		if(dist(who, patient) >= 2)
+		if(Distance(who, patient) >= 2)
 			SendSysMessage(who, "Your patient is too far away.");
 		elseif(SubtractAmount(Item, 1))
 			var parms := array(patient, who);
@@ -181,7 +180,7 @@
 			break;
 		elseif(clock != GetObjProperty(who, "HealTimer"))
 			break;
-		elseif(dist(who, patient) > 1)
+		elseif(Distance(who, patient) > 1)
 			SendSysMessage(who,"Your patient isn't close enough.");
 			SendSysMessage(patient, who.name + "has stopped healing you.");
 			break;
@@ -280,7 +279,7 @@
 			break;
 		elseif(clock != GetObjProperty(who, "HealTimer"))
 			break;
-		elseif(dist(who, patient) > 1)
+		elseif(Distance(who, patient) > 1)
 			SendSysMessage(who, "Your patient isn't close enough.");
 			SendSysMessage(patient, who.name + " has stopped healing you.");
 			break;
@@ -340,7 +339,7 @@
 			break;
 		elseif(clock != GetObjProperty(who, "HealTimer"))
 			break;
-		elseif(dist(who, patient) > 1)
+		elseif(Distance(who, patient) > 1)
 			SendSysMessage(who,"Your patient isn't close enough.");
 			SendSysMessage(patient, who.name + "has stopped healing you.");
 			break;

Modified: trunk/096/pkg/skills/lockpicking/lockpicking.src
===================================================================
--- trunk/096/pkg/skills/lockpicking/lockpicking.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/skills/lockpicking/lockpicking.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -3,7 +3,6 @@
 use cfgfile;
 use util;
 
-include "include/dist";
 include ":itemutils:objtype";
 include "include/sound";
 include "include/startEqp";

Modified: trunk/096/pkg/skills/mining/mining.src
===================================================================
--- trunk/096/pkg/skills/mining/mining.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/skills/mining/mining.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -4,7 +4,6 @@
 
 include "include/client";
 include ":attributes:attributes";
-include "include/dist";
 include ":itemutils:objtype";
 include "include/startEqp";
 include "util/key";
@@ -66,7 +65,7 @@
       return;
     endif
     SetObjProperty(who, "IsMining", ReadGameClock() + 1);
-	if((coordist(who.x, who.y, use_on.x, use_on.y)) > 2 )
+	if((CoordinateDistance(who.x, who.y, use_on.x, use_on.y)) > 2 )
 	  SendSysMessage(who,"That is too far away.");
 	  return;
 	endif
@@ -150,7 +149,7 @@
 	PerformAction(who, 0x0b);
 	PlaySoundEffect(who, 0x126);
     var range := GetRange( who );
-    var distn := coordist( dig.x, dig.y, chestx, chesty );
+    var distn := CoordinateDistance( dig.x, dig.y, chestx, chesty );
 //    var dirns := "None";
 //    var direw := "None";
     var maxrange := 20;
@@ -349,7 +348,7 @@
 endfunction
 
 function GetOre(who, location, info, tool)
-  if(coordist(who.x, who.y, location.x, location.y) > 2)
+  if(CoordinateDistance(who.x, who.y, location.x, location.y) > 2)
     SendSysMessage(who, "You stop mining.");
     return 1;
   endif

Modified: trunk/096/pkg/skills/tailoring/makeClothItems.src
===================================================================
--- trunk/096/pkg/skills/tailoring/makeClothItems.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/skills/tailoring/makeClothItems.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -5,7 +5,6 @@
 
 include ":gumps:include/old/old-gumps";
 include ":attributes:attributes";
-include "include/dist";
 include "include/client";
 include ":itemutils:objtype";
 include ":itemutils:canAccess";

Modified: trunk/096/pkg/skills/tailoring/tailoringFunctions.inc
===================================================================
--- trunk/096/pkg/skills/tailoring/tailoringFunctions.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/skills/tailoring/tailoringFunctions.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -1,6 +1,6 @@
 
 function process_wool(who, blade, sheep)
-  if((!CheckLineOfSight(who, sheep)) or (dist(who, sheep) > 2))
+  if((!CheckLineOfSight(who, sheep)) or (Distance(who, sheep) > 2))
     SendSysMessage(who, "You cannot use that.");
     return;
   endif

Modified: trunk/096/pkg/skills/tinkering/tinkerTraps.src
===================================================================
--- trunk/096/pkg/skills/tinkering/tinkerTraps.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/skills/tinkering/tinkerTraps.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -2,7 +2,6 @@
 use util;
 use os;
 
-include "include/dist";
 include "include/sound";
 include "include/tileEffects";
 include "include/client";
@@ -51,7 +50,7 @@
        EraseObjProperty(item, "trap_strength");
     2: PlaySoundEffect(who, SFX_232);
        PrintTextAbovePrivate(who, "You set off a poison trap!", who);
-       if(dist(who, item) < 3)
+       if(Distance(who, item) < 3)
          PlayObjectCenteredEffect(who, FX_POISON_GAS, 10,10);
          var passparms := {who, who, "poison trap", trapstrength};
          start_script(":spells:poisonDamage", passparms);
@@ -63,7 +62,7 @@
        EraseObjProperty(item, "trap_strength");
     3: PlaySoundEffect(who, SFX_208);
        SendSysMessage(who, "You set off an explosion trap!");
-       if(dist(who, item) < 3)
+       if(Distance(who, item) < 3)
          PlayObjectCenteredEffect(who, FX_EXPLODE_3, 10,10);
          var dmg :=(RandomInt(20) + CInt(trapstrength));
          ApplyRawDamage(who, dmg);
@@ -80,7 +79,7 @@
        var oldstrength := GetObjProperty(item, "oldstrength");
        var oldtype := GetObjProperty(item, "oldtype");
        SendSysMessage(who, "You set off an explosion trap!");
-       if(dist(who, item) < 3)
+       if(Distance(who, item) < 3)
          PlayObjectCenteredEffect(who, FX_EXPLODE_3, 10,10);
          var dmg := Resist(who, (RandomInt(20) + trapstrength));
          ApplyRawDamage(who, dmg);

Modified: trunk/096/pkg/skills/veterinary/vet.src
===================================================================
--- trunk/096/pkg/skills/veterinary/vet.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/skills/veterinary/vet.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -5,7 +5,6 @@
 
 include "include/client";
 include ":attributes:attributes";
-include "include/dist";
 include ":timedscripts:timedScripts";
 include ":timedscripts:poisonUtil";
 
@@ -20,7 +19,7 @@
   EraseObjProperty(who, "IsMeditating");
   //var sleeptime;
   var anatomy:= AP_GetSkill(who, ANATOMY);
-  if(dist(who, patient) > 2)
+  if(Distance(who, patient) > 2)
     SendSysMessage(who, "Your patient is too far away.");
     return;
   elseif(!CheckLineOfSight(who,patient))
@@ -37,7 +36,7 @@
       SendSysMessage(who,"You can't see your patient.");
       return;
     endif
-    if(dist(who, patient) <= 2)
+    if(Distance(who, patient) <= 2)
       SendSysMessage(who,"You start to cure "+patient.name+".");
       cure(who, patient);
     else
@@ -49,7 +48,7 @@
 	  SendSysMessage(who,"You can't see your patient.");
       return;
     endif
-    if(dist(who, patient) <= 2)
+    if(Distance(who, patient) <= 2)
       SendSysMessage(who,"You start to heal "+patient.name + ".");
       heal(who, patient);
     else
@@ -90,7 +89,7 @@
     endif
     chp:=AP_GetVital(who, HITS);
     sleep(1);
-    if(dist(who, patient) > 2)
+    if(Distance(who, patient) > 2)
       SendSysMessage(who,"Your patient isn't close enough.");
       break;
     endif
@@ -166,7 +165,7 @@
     endif
     chp:=AP_GetVital(who, HITS);
     sleep(1);
-    if(dist(who, patient) > 1)
+    if(Distance(who, patient) > 1)
       SendSysMessage(who,"Your patient isn't close enough.");
       break;
     endif

Modified: trunk/096/pkg/systems/combat/old/bladed.src
===================================================================
--- trunk/096/pkg/systems/combat/old/bladed.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/systems/combat/old/bladed.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -12,7 +12,6 @@
 include "include/string";
 include ":itemutils:objtype";
 include ":itemutils:canAccess";
-include "include/dist";
 include "include/toolWear";
 include "include/noto";
 include ":tailoring:tailoringFunctions";
@@ -82,7 +81,7 @@
 
 function CarveTree(who, blade, use_on)
 
-	if(dist(who, use_on) > 2)
+	if(Distance(who, use_on) > 2)
 		SendSysMessage(who, "You cannot use that");
 		return;
 	endif

Modified: trunk/096/pkg/systems/combat/useScripts/bladed.src
===================================================================
--- trunk/096/pkg/systems/combat/useScripts/bladed.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/systems/combat/useScripts/bladed.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -12,7 +12,6 @@
 include "include/string";
 include ":itemutils:objtype";
 include ":itemutils:canAccess";
-include "include/dist";
 include "include/toolWear";
 include "include/noto";
 include ":tailoring:tailoringFunctions";
@@ -82,7 +81,7 @@
 
 function CarveTree(who, blade, use_on )
 
-	if ( dist(who, use_on) > 2 )
+	if ( Distance(who, use_on) > 2 )
 		SendSysMessage(who, "You cannot use that");
 		return 0;
 	endif

Modified: trunk/096/pkg/systems/merchantnodes/guardNodeControl.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/guardNodeControl.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/systems/merchantnodes/guardNodeControl.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -8,7 +8,6 @@
 include "include/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
-include "include/dist";
 
 var npclist := {};
 var spawn, amt, item, status;

Modified: trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -8,7 +8,6 @@
 include "include/sysEvent";
 include "include/mrcSpawn";
 include ":itemutils:utility";;
-include "include/dist";
 
 var npclist := {};
 var spawn, amt, item, status, rng, tmplate;
@@ -273,7 +272,7 @@
 		var dis := 15;
 		foreach mob in npclist
 			if(CheckLineOfSight(ev.source, mob))
-				var dst := dist(who, mob);
+				var dst := Distance(who, mob);
 				if(dst < dis)
 					dis := dst;
 					npc := mob;
@@ -311,7 +310,7 @@
 			var dis := 7;
 			foreach mob in npclist
 				if(CheckLineOfSight(who, mob))
-					var dst := dist(who, mob);
+					var dst := Distance(who, mob);
 					if(dst < dis)
 						dis := dst;
 						npc := mob;

Modified: trunk/096/pkg/systems/spellcasting/spellcast.src
===================================================================
--- trunk/096/pkg/systems/spellcasting/spellcast.src	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/pkg/systems/spellcasting/spellcast.src	2005-11-05 23:11:06 UTC (rev 910)
@@ -5,7 +5,6 @@
 
 include "spellcastFunctions";
 include ":attributes:attributes";
-include "include/dist";
 
 program spellcast(who, spellid)
 
@@ -173,7 +172,7 @@
       SendSysMessage(who, "You can't see that.", 3, 40);
       return 0;
     endif
-    if (coordist(who.x, who.y, castOn.x, castOn.y) >= 12)
+    if (CoordinateDistance(who.x, who.y, castOn.x, castOn.y) >= 12)
       SendSysMessage(who, "That is too far away.", 3, 40);
       return 0;
     endif

Modified: trunk/096/scripts/include/OLD/spellRestrictions.inc
===================================================================
--- trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -11,7 +11,6 @@
 include "include/statMod";
 include "include/firewall";
 include "include/spellAttack";
-include "include/dist";
 
 var caster;
 var npccfg := ReadConfigFile("::npcdesc");
@@ -175,7 +174,7 @@
     SendSysMessage(caster,"You can't see that.", 3, 40);
     return 0;
   endif
-  if(dist(caster, cast_on) >= 12)
+  if(Distance(caster, cast_on) >= 12)
     SendSysMessage(caster, "That is too far away.", 3, 40);
     return 0;
   endif
@@ -195,7 +194,7 @@
     SendSysMessage(caster, "You can't see that.", 3, 40);
     return 0;
   endif
-  if(coordist(caster.x, caster.y, cast_loc.x, cast_loc.y) >= 12)
+  if(CoordinateDistance(caster.x, caster.y, cast_loc.x, cast_loc.y) >= 12)
     SendSysMessage(caster, "That is too far away.", 3, 40);
     return 0;
   endif
@@ -405,7 +404,7 @@
       return 0;
     endif
   endif
-  if(cdist(who.x, who.y, cast_on.x, cast_on.y) > 12)
+  if(cDistance(who.x, who.y, cast_on.x, cast_on.y) > 12)
     var check := 0;
     foreach thing in EnumerateItemsInContainer(who.backpack)
       if(thing == cast_on)
@@ -537,7 +536,7 @@
   return points;
 endfunction
 
-function cdist(x1, y1, x2, y2)
+function cDistance(x1, y1, x2, y2)
   var xd := x1 - x2;
   var yd := y1 - y2;
   if (xd < 0)
@@ -565,7 +564,7 @@
       return 0;
     endif
   endif
-  if(cdist(who.x, who.y, cast_on.x, cast_on.y) > 12)
+  if(cDistance(who.x, who.y, cast_on.x, cast_on.y) > 12)
     SendSysMessage(who,"The target is out of range.", 3, 40);
     return 0;
   endif

Modified: trunk/096/scripts/util/repair.inc
===================================================================
--- trunk/096/scripts/util/repair.inc	2005-11-05 22:56:59 UTC (rev 909)
+++ trunk/096/scripts/util/repair.inc	2005-11-05 23:11:06 UTC (rev 910)
@@ -146,7 +146,7 @@
     SendSysMessage(who, "You cannot repair that.");
     return;
   endif
-  if((!Accessible(who, use_on)) or (dist(who, use_on) > 2))
+  if((!Accessible(who, use_on)) or (Distance(who, use_on) > 2))
     SendSysMessage(who, "You cannot reach that.");
     return;
   endif



From austin at berlios.de  Sun Nov  6 00:20:58 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 00:20:58 +0100
Subject: [Poldistro-svn] r911 - in trunk/096: pkg/items/guildstone pkg/mobiles/oldAI pkg/skills/alchemy pkg/skills/herding pkg/skills/musicianship pkg/skills/taming pkg/systems/boat pkg/systems/housing pkg/systems/merchantnodes pkg/systems/stafflist scripts/control scripts/misc
Message-ID: <200511052320.jA5NKwDY013479@sheep.berlios.de>

Author: austin
Date: 2005-11-06 00:20:56 +0100 (Sun, 06 Nov 2005)
New Revision: 911

Modified:
   trunk/096/pkg/items/guildstone/guildManager.src
   trunk/096/pkg/mobiles/oldAI/animal.src
   trunk/096/pkg/mobiles/oldAI/barber.src
   trunk/096/pkg/mobiles/oldAI/barker.src
   trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
   trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src
   trunk/096/pkg/mobiles/oldAI/cat.src
   trunk/096/pkg/mobiles/oldAI/chicken.src
   trunk/096/pkg/mobiles/oldAI/crier.src
   trunk/096/pkg/mobiles/oldAI/davesHealer.src
   trunk/096/pkg/mobiles/oldAI/dumbKillPCs.src
   trunk/096/pkg/mobiles/oldAI/employed.src
   trunk/096/pkg/mobiles/oldAI/entranced.src
   trunk/096/pkg/mobiles/oldAI/escortee.src
   trunk/096/pkg/mobiles/oldAI/firebreather.src
   trunk/096/pkg/mobiles/oldAI/goodCaster.src
   trunk/096/pkg/mobiles/oldAI/helpPCs.src
   trunk/096/pkg/mobiles/oldAI/immobile.src
   trunk/096/pkg/mobiles/oldAI/immobileSpell.src
   trunk/096/pkg/mobiles/oldAI/killAny.src
   trunk/096/pkg/mobiles/oldAI/killPCs.src
   trunk/096/pkg/mobiles/oldAI/meek.src
   trunk/096/pkg/mobiles/oldAI/merchant.src
   trunk/096/pkg/mobiles/oldAI/packFirebreather.src
   trunk/096/pkg/mobiles/oldAI/person.src
   trunk/096/pkg/mobiles/oldAI/pirate.src
   trunk/096/pkg/mobiles/oldAI/poisonElemental.src
   trunk/096/pkg/mobiles/oldAI/poisonKillPCs.src
   trunk/096/pkg/mobiles/oldAI/slime.src
   trunk/096/pkg/mobiles/oldAI/spellFire.src
   trunk/096/pkg/mobiles/oldAI/spellKillPCs.src
   trunk/096/pkg/mobiles/oldAI/spiders.src
   trunk/096/pkg/mobiles/oldAI/tamed.src
   trunk/096/pkg/mobiles/oldAI/townGuard.src
   trunk/096/pkg/mobiles/oldAI/townHealer.src
   trunk/096/pkg/mobiles/oldAI/townPerson.src
   trunk/096/pkg/mobiles/oldAI/undead.src
   trunk/096/pkg/mobiles/oldAI/undeadKillPCs.src
   trunk/096/pkg/mobiles/oldAI/vortexAI.src
   trunk/096/pkg/mobiles/oldAI/wolf.src
   trunk/096/pkg/mobiles/oldAI/worker.src
   trunk/096/pkg/skills/alchemy/explosionPotion.src
   trunk/096/pkg/skills/herding/herd.src
   trunk/096/pkg/skills/musicianship/peacemaking.src
   trunk/096/pkg/skills/musicianship/provocation.src
   trunk/096/pkg/skills/taming/taming.src
   trunk/096/pkg/systems/boat/boat.src
   trunk/096/pkg/systems/housing/signControl.src
   trunk/096/pkg/systems/merchantnodes/guardNodeControl.src
   trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src
   trunk/096/pkg/systems/stafflist/staffList.src
   trunk/096/scripts/control/onInsert.src
   trunk/096/scripts/control/shelfInsert.src
   trunk/096/scripts/misc/dblclickself.src
   trunk/096/scripts/misc/help.src
   trunk/096/scripts/misc/logoff.src
   trunk/096/scripts/misc/logofftest.src
   trunk/096/scripts/misc/logon.src
Log:
Updated include/eventID to include/OLD/eventID

Modified: trunk/096/pkg/items/guildstone/guildManager.src
===================================================================
--- trunk/096/pkg/items/guildstone/guildManager.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/items/guildstone/guildManager.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 
-include "include/eventID";
+include "include/OLD/eventID";
 
 var proc := GetProcess(GetPid());
 var guilds;

Modified: trunk/096/pkg/mobiles/oldAI/animal.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/animal.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/animal.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/barber.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/barber.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/barber.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -2,7 +2,7 @@
 use os;
 use uo;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":itemutils:utility";;

Modified: trunk/096/pkg/mobiles/oldAI/barker.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/barker.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/barker.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -2,7 +2,7 @@
 use os;
 use uo;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/cat.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/cat.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/cat.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/chicken.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/chicken.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/chicken.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/crier.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/crier.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/crier.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -5,7 +5,7 @@
 
 const HALT_THRESHOLD := 8;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/davesHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/davesHealer.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/davesHealer.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -7,7 +7,7 @@
 include ":npcutils:NPCBackpacks";
 include ":npcutils:names";
 include ":npcutils:vetement";
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:anchors";
 include ":npcutils:speech";

Modified: trunk/096/pkg/mobiles/oldAI/dumbKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/dumbKillPCs.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/dumbKillPCs.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/employed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/employed.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:NPCBackpacks";

Modified: trunk/096/pkg/mobiles/oldAI/entranced.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/entranced.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/entranced.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 

Modified: trunk/096/pkg/mobiles/oldAI/escortee.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -2,7 +2,7 @@
 use os;
 use uo;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/firebreather.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/firebreather.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/firebreather.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -4,7 +4,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/goodCaster.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/goodCaster.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/goodCaster.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/helpPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/helpPCs.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/helpPCs.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/immobile.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/immobile.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/immobile.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/immobileSpell.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/immobileSpell.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/immobileSpell.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -20,7 +20,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/killAny.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/killAny.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/killAny.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -20,7 +20,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/killPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/killPCs.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/killPCs.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/meek.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/meek.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/meek.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -20,7 +20,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/merchant.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/merchant.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/merchant.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -2,7 +2,7 @@
 use os;
 use uo;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":itemutils:utility";;

Modified: trunk/096/pkg/mobiles/oldAI/packFirebreather.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/packFirebreather.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/packFirebreather.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -4,7 +4,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/person.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/person.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/person.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -13,7 +13,7 @@
 use os;
 use uo;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/pirate.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/pirate.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/pirate.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -18,7 +18,7 @@
 const aggression  := 250;
 
 include "util/conflicts";
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/poisonElemental.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/poisonKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/poisonKillPCs.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/poisonKillPCs.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/slime.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/slime.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/slime.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/spellFire.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/spellFire.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/spellFire.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/spellKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/spellKillPCs.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/spellKillPCs.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/spiders.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/spiders.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/spiders.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/tamed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:NPCBackpacks";

Modified: trunk/096/pkg/mobiles/oldAI/townGuard.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townGuard.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/townGuard.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -5,7 +5,7 @@
 
 include "include/client";
 include ":attributes:attributes";
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/townHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townHealer.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/townHealer.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use os;
 use uo;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/townPerson.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -2,7 +2,7 @@
 use os;
 use uo;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/undead.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/undead.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/undead.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/undeadKillPCs.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/undeadKillPCs.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/undeadKillPCs.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:vetement";

Modified: trunk/096/pkg/mobiles/oldAI/vortexAI.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/vortexAI.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/vortexAI.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include "include/client";
 include ":npcutils:names";

Modified: trunk/096/pkg/mobiles/oldAI/wolf.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/wolf.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/wolf.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include ":npcutils:names";
 include ":npcutils:NPCUtil";

Modified: trunk/096/pkg/mobiles/oldAI/worker.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -2,7 +2,7 @@
 use os;
 use uo;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":npcutils:names";

Modified: trunk/096/pkg/skills/alchemy/explosionPotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/explosionPotion.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/skills/alchemy/explosionPotion.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -2,7 +2,7 @@
 use os;
 use util;
 use cfgfile;
-include "include/eventID";
+include "include/OLD/eventID";
 include ":itemutils:canAccess";
 
 program use_explosion(who, potion)

Modified: trunk/096/pkg/skills/herding/herd.src
===================================================================
--- trunk/096/pkg/skills/herding/herd.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/skills/herding/herd.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -5,7 +5,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 
 program herd(who)

Modified: trunk/096/pkg/skills/musicianship/peacemaking.src
===================================================================
--- trunk/096/pkg/skills/musicianship/peacemaking.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/skills/musicianship/peacemaking.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -6,7 +6,7 @@
 include ":attributes:attributeConstants";
 include ":attributes:attributes";
 include ":attributes:skillCheck";
-include "include/eventID";
+include "include/OLD/eventID";
 include ":itemutils:canAccess";
 include ":musicianship:bard";
 

Modified: trunk/096/pkg/skills/musicianship/provocation.src
===================================================================
--- trunk/096/pkg/skills/musicianship/provocation.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/skills/musicianship/provocation.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -6,7 +6,7 @@
 include ":attributes:attributeConstants";
 include ":attributes:attributes";
 include ":attributes:skillCheck";
-include "include/eventID";
+include "include/OLD/eventID";
 include ":itemutils:canAccess";
 include ":musicianship:bard";
 

Modified: trunk/096/pkg/skills/taming/taming.src
===================================================================
--- trunk/096/pkg/skills/taming/taming.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/skills/taming/taming.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use uo;
 use os;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/client";
 

Modified: trunk/096/pkg/systems/boat/boat.src
===================================================================
--- trunk/096/pkg/systems/boat/boat.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/systems/boat/boat.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -14,7 +14,7 @@
 use util;
 use boat;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/sysEvent";
 include "include/myUtil";
 include "include/client";

Modified: trunk/096/pkg/systems/housing/signControl.src
===================================================================
--- trunk/096/pkg/systems/housing/signControl.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/systems/housing/signControl.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -2,7 +2,7 @@
 use os;
 use basic;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include ":itemutils:objtype";

Modified: trunk/096/pkg/systems/merchantnodes/guardNodeControl.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/guardNodeControl.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/systems/merchantnodes/guardNodeControl.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -5,7 +5,7 @@
 use util;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 

Modified: trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -3,7 +3,7 @@
 use util;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
 include "include/mrcSpawn";

Modified: trunk/096/pkg/systems/stafflist/staffList.src
===================================================================
--- trunk/096/pkg/systems/stafflist/staffList.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/pkg/systems/stafflist/staffList.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -4,7 +4,7 @@
 use math;
 
 include "include/math";
-include "include/eventID";
+include "include/OLD/eventID";
 var stff := {};
 var players := {};
 var coun := {};

Modified: trunk/096/scripts/control/onInsert.src
===================================================================
--- trunk/096/scripts/control/onInsert.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/scripts/control/onInsert.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include ":containers:insertSound";
 
 //if inserttype == INSERT_INCREASE_STACK, adding_item is uninit

Modified: trunk/096/scripts/control/shelfInsert.src
===================================================================
--- trunk/096/scripts/control/shelfInsert.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/scripts/control/shelfInsert.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -2,7 +2,7 @@
 use os;
 use util;
 
-include "include/eventID";
+include "include/OLD/eventID";
 
 program on_insert(who, backpack, item, amtadded, movetype)
 

Modified: trunk/096/scripts/misc/dblclickself.src
===================================================================
--- trunk/096/scripts/misc/dblclickself.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/scripts/misc/dblclickself.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -9,7 +9,7 @@
 use os;
 use npc;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/client";
 include ":mounts:mounts";
 

Modified: trunk/096/scripts/misc/help.src
===================================================================
--- trunk/096/scripts/misc/help.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/scripts/misc/help.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -2,7 +2,7 @@
 use os;
 
 include "include/help";
-include "include/eventID";
+include "include/OLD/eventID";
 var layout := {
 
 "resizepic 0 0 2600 600 450",

Modified: trunk/096/scripts/misc/logoff.src
===================================================================
--- trunk/096/scripts/misc/logoff.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/scripts/misc/logoff.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -11,7 +11,7 @@
 use os;
 
 include "include/math";
-include "include/eventID";
+include "include/OLD/eventID";
 include ":attributes:attributes";
 
 const EVID_UNEQUIP   := 0x123456;

Modified: trunk/096/scripts/misc/logofftest.src
===================================================================
--- trunk/096/scripts/misc/logofftest.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/scripts/misc/logofftest.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -7,7 +7,7 @@
  */
 use uo;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/innCheck";
 
 include ":timedscripts:timedScripts";

Modified: trunk/096/scripts/misc/logon.src
===================================================================
--- trunk/096/scripts/misc/logon.src	2005-11-05 23:11:06 UTC (rev 910)
+++ trunk/096/scripts/misc/logon.src	2005-11-05 23:20:56 UTC (rev 911)
@@ -11,7 +11,7 @@
 use math;
 use cfgfile;
 
-include "include/eventID";
+include "include/OLD/eventID";
 include "include/myUtil";
 include ":attributes:attributes";
 include ":combat:equip";



From austin at berlios.de  Sun Nov  6 00:23:41 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 00:23:41 +0100
Subject: [Poldistro-svn] r912 - in trunk/096: pkg/systems/boat pkg/utils/itemUtils/include scripts/items scripts/misc
Message-ID: <200511052323.jA5NNfFS013602@sheep.berlios.de>

Author: austin
Date: 2005-11-06 00:23:40 +0100 (Sun, 06 Nov 2005)
New Revision: 912

Modified:
   trunk/096/pkg/systems/boat/boat.src
   trunk/096/pkg/utils/itemUtils/include/utility.inc
   trunk/096/scripts/items/key.src
   trunk/096/scripts/misc/logon.src
Log:
Updated include/myUtil to :itemutils:myUtil

Modified: trunk/096/pkg/systems/boat/boat.src
===================================================================
--- trunk/096/pkg/systems/boat/boat.src	2005-11-05 23:20:56 UTC (rev 911)
+++ trunk/096/pkg/systems/boat/boat.src	2005-11-05 23:23:40 UTC (rev 912)
@@ -16,7 +16,7 @@
 
 include "include/OLD/eventID";
 include "include/sysEvent";
-include "include/myUtil";
+include ":itemutils:myUtil";
 include "include/client";
 include "include/sound";
 include ":gumps:yesno";

Modified: trunk/096/pkg/utils/itemUtils/include/utility.inc
===================================================================
--- trunk/096/pkg/utils/itemUtils/include/utility.inc	2005-11-05 23:20:56 UTC (rev 911)
+++ trunk/096/pkg/utils/itemUtils/include/utility.inc	2005-11-05 23:23:40 UTC (rev 912)
@@ -3,7 +3,7 @@
  */
 use basic;
 
-include "include/myUtil";
+include ":itemutils:myUtil";
 
 
 function find_or_create_storage( areaname )

Modified: trunk/096/scripts/items/key.src
===================================================================
--- trunk/096/scripts/items/key.src	2005-11-05 23:20:56 UTC (rev 911)
+++ trunk/096/scripts/items/key.src	2005-11-05 23:23:40 UTC (rev 912)
@@ -3,7 +3,7 @@
 use boat;
 include ":itemutils:objtype";
 include ":gumps:yesno";
-include "include/myUtil";
+include ":itemutils:myUtil";
 include "util/key";
 include ":itemutils:canAccess";
 

Modified: trunk/096/scripts/misc/logon.src
===================================================================
--- trunk/096/scripts/misc/logon.src	2005-11-05 23:20:56 UTC (rev 911)
+++ trunk/096/scripts/misc/logon.src	2005-11-05 23:23:40 UTC (rev 912)
@@ -12,7 +12,7 @@
 use cfgfile;
 
 include "include/OLD/eventID";
-include "include/myUtil";
+include ":itemutils:myUtil";
 include ":attributes:attributes";
 include ":combat:equip";
 include "include/noto";



From austin at berlios.de  Sun Nov  6 00:28:28 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 00:28:28 +0100
Subject: [Poldistro-svn] r913 - in trunk/096: config pkg/systems/loot/configs pkg/systems/loot/configs/OLD
Message-ID: <200511052328.jA5NSSJn013810@sheep.berlios.de>

Author: austin
Date: 2005-11-06 00:28:28 +0100 (Sun, 06 Nov 2005)
New Revision: 913

Added:
   trunk/096/pkg/systems/loot/configs/OLD/
   trunk/096/pkg/systems/loot/configs/OLD/lootgroup.cfg
   trunk/096/pkg/systems/loot/configs/OLD/nlootgroup.cfg
Removed:
   trunk/096/config/lootgroup.cfg
   trunk/096/config/nlootgroup.cfg
Log:
Moved old distro loot information configs to the new loot package (so they can be referenced for making the new loot configs and then.. fully deleted)

Deleted: trunk/096/config/lootgroup.cfg
===================================================================
--- trunk/096/config/lootgroup.cfg	2005-11-05 23:23:40 UTC (rev 912)
+++ trunk/096/config/lootgroup.cfg	2005-11-05 23:28:28 UTC (rev 913)
@@ -1,317 +0,0 @@
-#  Lootgroup config file
-# sets up a "lootgroup" -- a random group of loot you can assign to a creature. When the loot is created a certain number
-# of loot items are selected from the "item" listings in the lootgroup.
-#Basically, you set up a big list of items the creature could get, then set the number of items they do get.
-#their loot is a random selection from that list
-
-#Example:
-#lootgroup 2      : lootgroup number
-#rich             : a description I popped in there
-#always [n]       : always give n'th item, in addition to get_items randomly chosen
-#get_items 2      : a given creature will have 2 items. Can also be a diestring (ie, 3d6, for 3-18 items)
-#item 11          : each item that the creature could get. Items are entries in the loot.cfg file
-#item 12
-#item 13
-#item 14
-
-
-
-lootgroup 1
-{
-    #cheap
-    get_items 1d3+0
-    always 1
-    item 1
-    item 2
-    item 3
-    item 4
-    item 5
-    item 6
-    item 7
-    item 8
-    item 9
-    item 10
-    item 41
-    item 42
-    item 43
-    item 44
-    item 45
-    item 46
-    item 47
-    item 48
-    item 49
-    item 50
-    item 51
-    item 52
-    item 53
-    item 54
-    item 55
-    item 56
-    item 57
-    item 58
-    item 59
-    item 60
-    item 61
-    item 62
-    item 63
-    item 64
-    item 65
-    item 66
-}
-
-lootgroup 2
-{
-    #rich
-    get_items 1d2+0
-    always 11
-    item 11
-    item 12
-    item 13
-    item 14
-}
-
-lootgroup 3
-{
-    #very nice
-    always 17
-    item  15
-    item  16
-    item  17
-}
-
-lootgroup 4
-{
-    # reagents
-    get_items 2d4+0
-    always 1
-    item 18
-    item 19
-    item 20
-    item 21
-    item 22
-    item 23
-    item 24
-    item 25
-    item 26
-    item 27
-    item 28
-    item 29
-    item 30
-    item 31
-    item 32
-    item 33
-    item 34
-    item 35
-    item 36
-    item 37
-    item 38
-    item 39
-    item 40
-}
-
-lootgroup 5
-{
-    #level1chest
-    get_items 2d4+0
-    always 67
-    item 12
-    item 13
-    item 15
-    item 19
-    item 20
-    item 21
-    item 22
-    item 23
-    item 24
-    item 25
-    item 41
-    item 42
-    item 43
-    item 44
-    item 45
-    item 46
-    item 47
-    item 48
-    item 50
-    item 51
-    item 52
-    item 53
-    item 54
-    item 55
-    item 56
-    item 57
-    item 58
-    item 59
-    item 60
-    item 61
-    item 62
-    item 63
-    item 64
-    item 66
-    item 65
-}
-
-lootgroup 6
-{
-    #level2chest
-    get_items 3d4+0
-    always 68
-    item 12
-    item 13
-    item 15
-    item 19
-    item 20
-    item 21
-    item 22
-    item 23
-    item 24
-    item 25
-    item 41
-    item 42
-    item 43
-    item 44
-    item 45
-    item 46
-    item 47
-    item 48
-    item 50
-    item 51
-    item 52
-    item 53
-    item 54
-    item 55
-    item 56
-    item 57
-    item 58
-    item 59
-    item 60
-    item 61
-    item 62
-    item 63
-    item 64
-    item 66
-    item 65
-}
-lootgroup 7
-{
-    #level3chest
-    get_items 4d4+0
-    always 69
-    item 12
-    item 13
-    item 15
-    item 19
-    item 20
-    item 21
-    item 22
-    item 23
-    item 24
-    item 25
-    item 41
-    item 42
-    item 43
-    item 44
-    item 45
-    item 46
-    item 47
-    item 48
-    item 50
-    item 51
-    item 52
-    item 53
-    item 54
-    item 55
-    item 56
-    item 57
-    item 58
-    item 59
-    item 60
-    item 61
-    item 62
-    item 63
-    item 64
-    item 66
-    item 65
-}
-lootgroup 8
-{
-    #level4chest
-    get_items 4d5+0
-    always 70
-    item 12
-    item 13
-    item 15
-    item 19
-    item 20
-    item 21
-    item 22
-    item 23
-    item 24
-    item 25
-    item 41
-    item 42
-    item 43
-    item 44
-    item 45
-    item 46
-    item 47
-    item 48
-    item 50
-    item 51
-    item 52
-    item 53
-    item 54
-    item 55
-    item 56
-    item 57
-    item 58
-    item 59
-    item 60
-    item 61
-    item 62
-    item 63
-    item 64
-    item 66
-    item 65
-}
-lootgroup 9
-{
-    #level5chest
-    get_items 5d5+0
-    always 71
-    item 12
-    item 13
-    item 15
-    item 19
-    item 20
-    item 21
-    item 22
-    item 23
-    item 24
-    item 25
-    item 41
-    item 42
-    item 43
-    item 44
-    item 45
-    item 46
-    item 47
-    item 48
-    item 50
-    item 51
-    item 52
-    item 53
-    item 54
-    item 55
-    item 56
-    item 57
-    item 58
-    item 59
-    item 60
-    item 61
-    item 62
-    item 63
-    item 64
-    item 66
-    item 65
-}

Deleted: trunk/096/config/nlootgroup.cfg
===================================================================
--- trunk/096/config/nlootgroup.cfg	2005-11-05 23:23:40 UTC (rev 912)
+++ trunk/096/config/nlootgroup.cfg	2005-11-05 23:28:28 UTC (rev 913)
@@ -1,967 +0,0 @@
-# $Id$
-#
-#
-###############################################
-#  NLOOTGROUP.CFG - Loot definitions
-#
-#  Format:
-#      Stack {n=1} [ObjName] {color=0} {chancetospawn=100} Stacks the amount. DO NOT use on
-#            non-stackable items such as arms and armor! Use "Item" for those.
-#      Item {n=1} [ObjName] {color=0} {chancetospawn=100}  include 1 of ObjName
-#      Random [n] [GroupName] {chancetospawn=100} pick n Items from GroupName randomly
-#      Group [GroupName]       include GroupName too
-#      Unique [ObjName]         don't give more than one
-###############################################
-lootgroup 1             #orc
-{
-    Stack  1d50         GoldCoin
-}
-
-lootgroup 2             #orc
-{
-    Stack  1d50         GoldCoin
-}
-
-lootgroup 3             #lizardman
-{
-    Stack  1d50         GoldCoin
-}
-
-lootgroup 4             #spectre
-{
-    stack  1d100+50     GoldCoin
-    Random 1            NormalEquipment 0 5
-    Random 1d2          Gems
-    Random 1            BoneArmor       0 15
-}
-
-lootgroup 5             #level1map
-{
-    Random 1            Circle1Scrolls
-    Random 2            Circle2Scrolls
-    Random 2            Circle3Scrolls
-    Stack  1000         GoldCoin
-    Random 1d6+14       Reagents
-    Random 6            NormalEquipment
-    Random 10           Gems
-}
-
-lootgroup 6             #level2map
-{
-    Random 2            Circle1Scrolls
-    Random 3            Circle2Scrolls
-    Random 4            Circle3Scrolls
-    Random 5            Circle4Scrolls
-    Stack  2000         GoldCoin
-    Random 1d21+19      Reagents
-    Random 20           Gems
-    Random 1d6+9        NormalEquipment
-}
-
-lootgroup 7             #level3map
-{
-    Random 3            Circle3Scrolls
-    Random 4            Circle4Scrolls
-    Random 6            Circle5Scrolls
-    Random 7            Circle6Scrolls
-    Stack  3000         GoldCoin
-    Random 1d21+19      Reagents
-    Random 30           Gems
-    Random 1d6+14       NormalEquipment
-}
-
-lootgroup 8             #level4map
-{
-    Random 3            Circle3Scrolls
-    Random 3            Circle4Scrolls
-    Random 6            Circle5Scrolls
-    Random 6            Circle6Scrolls
-    Random 6            Circle7Scrolls
-    Random 6            Circle7Scrolls
-    Stack  4000         GoldCoin
-    Random 1d41+39      Reagents
-    Random 40           Gems
-    Random 1d6+14       NormalEquipment
-}
-
-lootgroup 9             #level5map
-{
-    Random 5            Circle4Scrolls
-    Random 6            Circle5Scrolls
-    Random 7            Circle6Scrolls
-    Random 8            Circle7Scrolls
-    Random 4            Circle8Scrolls
-    Stack  5000         GoldCoin
-    Random 1d51+99      Reagents
-    Random 50           Gems
-    Random 1d6+19       NormalEquipment
-}
-
-lootgroup 10            #ratman
-{
-    Stack  1d50         GoldCoin
-}
-
-lootgroup 11            #skeletal knight
-{
-    Stack  1d50+100     GoldCoin
-    Item   1            OrcMask         0   20
-    Random 1            Potions
-    Random 1            Gems
-    Stack  10           Arrow           0   80
-}
-
-lootgroup 12            #skeletal mage
-{
-    Random 1            Circle4Scrolls
-    Random 1d3          Reagents
-}
-
-lootgroup 13            #orc lord
-{
-    Stack 1d150+150     GoldCoin
-    Random 1            NormalEquipment 0 10
-    Random 1            Gems
-}
-
-lootgroup 14            #ettin
-{
-    Stack  1d100+50     GoldCoin
-    Stack  10           Arrow           0   80
-    Random 2            Gems
-    Random 1            potions
-}
-
-lootgroup 15            #skeleton
-{
-    Stack  1d50         GoldCoin
-    Random 1            BoneArmor       0 30
-}
-
-lootgroup 16            #bone knight
-{
-    Stack 1d150         GoldCoin
-    Item  1             OrcMask         0   20
-}
-
-lootgroup 17            #ogre
-{
-    Stack  1d50+100     GoldCoin
-    Stack  3d5          Arrow           0   80
-    Random 1d2          Gems
-    Random 1            potions
-}
-
-lootgroup 18            #troll
-{
-    Item   1            Level1map           0   3
-    Stack  1d50+150     GoldCoin
-    Stack  3d5          Arrow           0   80
-    Random 1            potions
-}
-
-lootgroup 21            #ogre lord
-{
-    Item   1            Level3map           0   3
-    Stack  1d50+200     GoldCoin
-    Random 1d3          NormalEquipment 0 30
-}
-
-lootgroup 22            #fire ele
-{
-    Item   1            Level2map           0   3
-    Stack  1d150+150    GoldCoin
-    Item   1d4          SulphurousAsh
-    Random 2            Gems
-}
-
-lootgroup 23            #water ele
-{
-    Item   1            Level2map           0   3
-    Stack  1d50+200     GoldCoin
-    Random 3            Reagents
-    Random 1            Potions
-}
-
-lootgroup 24            #earth ele
-{
-    Item   1            level2map       0   3
-    Stack  10           IronOre
-    Random 2            Gems
-}
-
-lootgroup 25            #air elemental
-{
-    Item   1            Level2map           0   3
-    Random 1            Scrolls
-    Stack 1d100+400     GoldCoin
-    Random 1            Potions
-}
-
-lootgroup 26            #daemon
-{
-    Random 1d2          Scrolls
-    Random 1            Circle8Scrolls  0 30
-    Stack  1d450+150    GoldCoin
-    Random 1d2          NormalEquipment
-    Item   1            Level4map       0   3
-    Random 1d5          Gems
-}
-
-lootgroup 27            #liche
-{
-    Random 1d2          Scrolls
-    Stack  1d50+200     GoldCoin
-    Random 2d3          Reagents
-    Random 1d3          Gems
-    Random 1            Wands
-    Random 1            NormalEquipment 0 5
-    Item   1            Level3map       0   3
-}
-
-lootgroup 28            #zombie
-{
-    Stack  1d20         GoldCoin
-    Random 1            BoneArmor       0 30
-}
-
-lootgroup 29            #shade
-{
-    Random 1            Scrolls
-    Stack  1d50+100     GoldCoin
-}
-
-lootgroup 30            #wraith
-{
-    Stack  1d50+100     GoldCoin
-    Random 1            NormalEquipment 0 5
-    Random 1            Gems
-}
-####################################
-#  31      32
-####################################
-lootgroup 33            #harpy
-{
-    Stack 1d100+50      GoldCoin
-}
-
-lootgroup 34            #gazer
-{
-    Item   1            level3map       0   3
-    Stack  1d50+100     GoldCoin
-    Stack  3d5          Arrow           0   85
-    Stack  3d5          Nightshade      0   90
-    Random 1            Potions
-    Random 1            NormalEquipment 0 5
-    Random 1            Scrolls         0 60
-}
-
-lootgroup 35            #orcmage
-{
-    Item   1            Level1map           0   3
-    Random 1            Scrolls         0 50
-    Stack  1d100+50     GoldCoin
-    Stack  3d5          Arrow           0   45
-    Random 1d2          Gems
-    Random 1d4          Reagents
-}
-
-lootgroup 36            #corpser
-{
-    Stack 1d50          GoldCoin
-    Stack 10            Logs
-}
-
-lootgroup 37            #imp
-{
-    Stack 1d50          GoldCoin
-}
-
-lootgroup 38            #reaper
-{
-    Item   1            Level2map           0   3
-    Stack 1d150         GoldCoin
-    Stack 10            Logs
-    Random 1d2          Reagents
-}
-
-lootgroup 39            #ancient wyrm
-{
-    Item   1            level5map       0   3
-    Random 2d8          Gems
-    Stack 1d200+1200    GoldCoin
-    Random 1d6          NormalEquipment
-}
-
-lootgroup 40           #drake
-{
-    Stack  1d50+200    GoldCoin
-    Item   1           level3map        0   3
-}
-
-lootgroup 41            #dragon
-{
-    Stack  1d200+1200   GoldCoin
-    Random 1d4          NormalEquipment
-    Item   1            level4map       0   3
-    Random 2d5          Gems
-}
-
-lootgroup 42            #gargoyle
-{
-    Item   1            level2map       0   3
-    Stack  1d50+100     GoldCoin
-    Random 1            Scrolls         0 40
-    Stack  10           Arrow           0   50
-    Random 1d2          Gems
-    Random 1            potions
-}
-
-lootgroup 43            #bone magi
-{
-    Random 1            Scrolls         0 40
-    Random 1            NormalEquipment 0 5
-    Stack  1d150+50     GoldCoin
-    Random 1d2          Gems
-}
-
-
-lootgroup 45            #elder gazer
-{
-    stack  1000         GoldCoin
-    Random 1d5          NormalEquipment
-    Random 2d4          Gems
-}
-
-lootgroup 46            #ghoul
-{
-    stack  1d100+50     GoldCoin
-    Random 1d5          NormalEquipment 0 3
-    Random 1d2          Gems
-    Random 1            BoneArmor       0 15
-}
-
-lootgroup 47            #headless
-{
-    stack  1d50+1       GoldCoin
-}
-
-lootgroup 48            #evilmage
-{
-    Random 2d2          Scrolls
-    Stack  1d50         GoldCoin
-    Random 2d4          Reagents
-    Random 1d4          Gems
-}
-
-lootgroup 49            #magelord
-{
-    Random 2d3          Scrolls
-    Stack  1d50+200     GoldCoin
-    Random 2d4          Reagents
-    Random 1d4          Gems
-}
-
-lootgroup 50            #poison elemental
-{
-    Item   1            level5map       0   3
-    Stack  1d300+800    GoldCoin
-    Random 1d3          NormalEquipment 0 50
-    Random 1d4          Gems
-}
-
-lootgroup 51            #terathan warrior
-{
-    Item   1            Level1map           0   3
-    Stack  1d50+200     GoldCoin
-    Random 1            Potions
-}
-
-lootgroup 52            #mummy
-{
-    Item   1            Level2map           0   3
-    Stack  1d150        GoldCoin
-}
-
-lootgroup 53            #ophidian shaman
-{
-    Random 1d2          Scrolls
-    Stack  1d50+200     GoldCoin
-    Random 2d3          Reagents
-    Random 1d3          Gems
-    Random 1            NormalEquipment 0 5
-    Item   1            Level3map       0   3
-}
-
-lootgroup 54            #wyvern
-{
-    Stack  1d200+1200   GoldCoin
-    Random 1d4          NormalEquipment
-    Item   1            level2map       0   3
-    Random 2d5          Gems
-}
-
-lootgroup 55            #cyclopse
-{
-    Stack  1d50+200     GoldCoin
-    Random 1d3          Gems
-    Random 1            NormalEquipment 0 5
-    Item   1            Level3map       0   3
-}
-
-lootgroup 56            #ophidian enforcer
-{
-    Item   1            Level1map           0   3
-    Stack  1d100+200    GoldCoin
-    Random 1d3          NormalEquipment 0 50
-    Random 1d4          Gems
-}
-
-lootgroup 57            #efreet
-{
-    Item   1            Level3map           0   3
-    Random 1            Scrolls
-    Stack 1d100+300     GoldCoin
-    Random 1            Potions
-}
-
-lootgroup 58            #ophidian knight errant
-{
-    Item   1            Level3map           0   3
-    Stack  1d100+250    GoldCoin
-    Random 1d3          NormalEquipment     0 50
-}
-
-lootgroup 59            #ophidian/terathan matriarch
-{
-    Item   1            Level4map           0   3
-    Stack  1d100+400    GoldCoin
-    Random 1d3          NormalEquipment 0 70
-    Random 2d6          Reagents
-    Random 1d4          Gems
-}
-
-lootgroup 60            #titan
-{
-    Random 1d2          Scrolls
-    Stack  1d50+200     GoldCoin
-    Random 2d3          Reagents
-    Random 1d3          Gems
-    Random 1            Wands
-    Random 1            NormalEquipment 0 5
-    Item   1            Level4map       0   3
-}
-
-lootgroup 61            #brigand1
-{
-    Stack  1d50+50      GoldCoin
-}
-
-lootgroup 62            # ice elemental
-{
-    Item   1            Level3map       0   3
-	Stack 1d200+300     GoldCoin
-    Random 1            Potions
-    Random 2            Gems
-}
-#####################################
-#         63                64
-#####################################
-lootgroup 65            #lichelord
-{
-    Item   1            Level4map           0   3
-    Random 1d3          Scrolls
-    Stack  1d100+300    GoldCoin
-    Random 2d6          Reagents
-    Random 1d5          NormalEquipment 0 5
-    Random 1d4          Gems
-}
-
-lootgroup 67            #balron
-{
-    Random 1d2          Scrolls
-    Random 1            Circle8Scrolls      0 65
-    Stack  1d400+800    GoldCoin
-    Item   1            Level5map           0   3
-    Item   1            BroadSword
-    Random 3            NormalEquipment     0 40
-}
-
-lootgroup 68            # blood elemental
-{
-    Item   1            level5map       0   3
-    Random 1            NormalEquipment     0 20
-	Random 1            Scrolls
-	Stack  1d500+500    GoldCoin
-	Random 2d6          Gems
-}
-
-lootgroup 69            # chestspawn1
-{
-	Stack  1d30         GoldCoin
-	random 1            Gems          0 50
-    random 1            Potions            0 70
-}
-
-lootgroup 70            # chestspawn2
-{
-	Stack  2d30         GoldCoin
-	random 2            Gems               0 50
-	random 1            Potions           0  50
-}
-
-lootgroup 71            # chestspawn3
-{
-	Stack  3d30         GoldCoin
-	random 2            Gems              0  50
-	random 1            Potions           0  50
-	Random 2            Scrolls           0  25
-}
-
-lootgroup 72            # chestspawn4
-{
-	Stack  4d30         GoldCoin
-	random 4            Gems               0 50
-	random 1            Potions            0 50
-	Random 2            Scrolls            0 50
-	Random 1            NormalEquipment    0 30
-}
-
-lootgroup 73            # chestspawn5
-{
-	Stack  6d30         GoldCoin
-	random 5            Gems               0 50
-	random 1            Potions            0 50
-	Random 2            Scrolls            0 80
-	Random 2            NormalEquipment    0 40
-}
-
-lootgroup 74            # dread spider
-{
-    Item   1            Level3map       0   3
-	Stack 1d50+200      GoldCoin
-    Random 1            Potions
-}
-
-lootgroup 75            # hellhound
-{
-	Stack 1d150         GoldCoin
-    Item  5             SulphurousAsh
-}
-########################
-#-----------------Groups---------------------#
-########################
-Group Potions
-{
-    Item 1 LesserHeal
-    Item 1 LesserPoison
-    Item 1 LesserExplosion
-    Item 1 AgilityPotion
-    Item 1 RefreshPotion
-    Item 1 StrengthPotion
-    Item 1 Nightsight
-    Item 1 LesserCure
-}
-
-Group Reagents
-{
-    Item 1d6 BloodMoss
-    Item 1d6 Nightshade
-    Item 1d6 Garlic
-    Item 1d6 SpiderSilk
-    Item 1d6 MandrakeRoot
-    Item 1d6 SulphurousAsh
-    Item 1d6 BlackPearl
-    Item 1d6 Ginseng
-}
-
-Group NormalEquipment
-{
-    Item 1 Longsword
-    Item 1 WarAxe
-    Item 1 Bow
-    Item 1 Crossbow
-    Item 1 HeavyCrossbow
-    Item 1 Axe
-    Item 1 BattleAxe
-    Item 1 DoubleAxe
-    Item 1 ExecutionersAxe
-    Item 1 LargeBattleAxe
-    Item 1 TwoHandedAxe
-    Item 1 HammerPick
-    Item 1 Mace
-    Item 1 Maul
-    Item 1 WarHammer
-    Item 1 WarMace
-    Item 1 Bardiche
-    Item 1 Halberd
-    Item 1 ShortSpear
-    Item 1 Spear
-    Item 1 WarFork
-    Item 1 BroadSword
-    Item 1 Cutlass
-    Item 1 Dagger
-    Item 1 Katana
-    Item 1 Kryss
-    Item 1 Scimitar
-    Item 1 VikingSword
-    Item 1 Hatchet
-    Item 1 PickAxe
-    Item 1 ButcherKnife
-    Item 1 Cleaver
-    Item 1 SkinningKnife
-    Item 1 Club
-    Item 1 SmithyHammer
-    Item 1 PitchFork
-    Item 1 BlackStaff
-    Item 1 GnarledStaff
-    Item 1 QuarterStaff
-    Item 1 ShepherdsCrook
-    Item 1 LeatherGorget
-    Item 1 LeatherSleeves
-    Item 1 LeatherGloves
-    Item 1 LeatherCap
-    Item 1 LeatherLeggings
-    Item 1 LeatherTunic
-    Item 1 LeatherTunic2
-    Item 1 StuddedGorget
-    Item 1 StuddedGloves
-    Item 1 StuddedSleeves
-    Item 1 StuddedLeggings
-    Item 1 StuddedTunic
-    Item 1 FemaleStudded
-    Item 1 FemaleLeather
-    Item 1 LeatherSkirt
-    Item 1 LeatherBustier
-    Item 1 StuddedBustier
-    Item 1 LeatherShorts
-    Item 1 LeatherBoots
-    Item 1 ThighBoots
-    Item 1 ChainmailCoif
-    Item 1 ChainmailLeggings
-    Item 1 ChainmailTunic
-    Item 1 CloseHelm
-    Item 1 Helmet
-    Item 1 Bascinet
-    Item 1 NoseHelm
-    Item 1 PlateHelm
-    Item 1 BronzeShield
-    Item 1 Buckler
-    Item 1 KiteShield
-    Item 1 HeaterShield
-    Item 1 KiteShieldB1
-    Item 1 WoodenShield
-    Item 1 MetalShield
-    Item 1 RingmailTunic
-    Item 1 RingmailSleeves
-    Item 1 RingmailLeggings
-    Item 1 RingmailGloves
-    Item 1 PlatemailBreastplate
-    Item 1 PlatemailArms
-    Item 1 PlatemailLegs
-    Item 1 PlatemailGorget
-    Item 1 Platemailgloves
-    Item 1 Robe
-    Item 1 ring
-    Item 1 silvernecklace
-    Item 1 bracelet
-    Item 1 earings
-    Item 1 roundnecklace
-    Item 1 longnecklace
-    Item 1 ring
-    Item 1 Cloak
-}
-
-Group NormalWeapons
-{
-    Item 1 Longsword
-    Item 1 WarAxe
-    Item 1 Bow
-    Item 1 Crossbow
-    Item 1 HeavyCrossbow
-    Item 1 Axe
-    Item 1 BattleAxe
-    Item 1 DoubleAxe
-    Item 1 ExecutionersAxe
-    Item 1 LargeBattleAxe
-    Item 1 TwoHandedAxe
-    Item 1 HammerPick
-    Item 1 Mace
-    Item 1 Maul
-    Item 1 WarHammer
-    Item 1 WarMace
-    Item 1 Bardiche
-    Item 1 Halberd
-    Item 1 ShortSpear
-    Item 1 Spear
-    Item 1 WarFork
-    Item 1 BroadSword
-    Item 1 Cutlass
-    Item 1 Dagger
-    Item 1 Katana
-    Item 1 Kryss
-    Item 1 Scimitar
-    Item 1 VikingSword
-    Item 1 Hatchet
-    Item 1 PickAxe
-    Item 1 ButcherKnife
-    Item 1 Cleaver
-    Item 1 SkinningKnife
-    Item 1 Club
-    Item 1 SmithyHammer
-    Item 1 PitchFork
-    Item 1 BlackStaff
-    Item 1 QuarterStaff
-    Item 1 ShepherdsCrook
-}
-
-Group NormalArmor
-{
-    Item 1 LeatherGorget
-    Item 1 LeatherSleeves
-    Item 1 LeatherGloves
-    Item 1 LeatherCap
-    Item 1 LeatherLeggings
-    Item 1 LeatherTunic
-    Item 1 LeatherTunic2
-    Item 1 StuddedGorget
-    Item 1 StuddedGloves
-    Item 1 StuddedSleeves
-    Item 1 StuddedLeggings
-    Item 1 StuddedTunic
-    Item 1 FemaleStudded
-    Item 1 FemaleLeather
-    Item 1 LeatherSkirt
-    Item 1 LeatherBustier
-    Item 1 StuddedBustier
-    Item 1 LeatherShorts
-    Item 1 LeatherBoots
-    Item 1 ThighBoots
-    Item 1 ChainmailCoif
-    Item 1 ChainmailLeggings
-    Item 1 ChainmailTunic
-    Item 1 CloseHelm
-    Item 1 Helmet
-    Item 1 Bascinet
-    Item 1 NoseHelm
-    Item 1 PlateHelm
-    Item 1 BronzeShield
-    Item 1 Buckler
-    Item 1 KiteShield
-    Item 1 HeaterShield
-    Item 1 KiteShieldB1
-    Item 1 WoodenShield
-    Item 1 MetalShield
-    Item 1 RingmailTunic
-    Item 1 RingmailSleeves
-    Item 1 RingmailLeggings
-    Item 1 RingmailGloves
-    Item 1 PlatemailBreastplate
-    Item 1 PlatemailArms
-    Item 1 PlatemailLegs
-    Item 1 PlatemailGorget
-    Item 1 Robe
-}
-
-Group BoneArmor
-{
-    Item 1 Bonegloves
-    Item 1 BoneArms
-    Item 1 Bonelegs
-    Item 1 Bonetunic
-    Item 1 Bonehelm
-}
-
-Group Circle1Scrolls
-{
-    Item 1 reactivearmorscroll
-    Item 1 clumsyscroll
-    Item 1 createfoodscroll
-    Item 1 feeblemindscroll
-    Item 1 healscroll
-    Item 1 magicarrowscroll
-    Item 1 nightsightscroll
-    Item 1 weakenscroll
-}
-
-Group Circle2Scrolls
-{
-    Item 1 agilityscroll
-    Item 1 cunningscroll
-    Item 1 curescroll
-    Item 1 harmscroll
-    Item 1 magictrapscroll
-    Item 1 magicuntrapscroll
-    Item 1 protectionscroll
-    Item 1 strengthscroll
-}
-
-Group Circle3Scrolls
-{
-    Item 1 blessscroll
-    Item 1 fireballscroll
-    Item 1 magiclockscroll
-    Item 1 poisonscroll
-    Item 1 telekinesisscroll
-    Item 1 teleportscroll
-    Item 1 magicunlockscroll
-    Item 1 wallofstonescroll
-}
-
-Group Circle4Scrolls
-{
-    Item 1 archcurescroll
-    Item 1 archprotectionscroll
-    Item 1 cursecroll
-    Item 1 firefieldscroll
-    Item 1 greaterhealscroll
-    Item 1 lightningscroll
-    Item 1 manadrainscroll
-    Item 1 recallscroll
-}
-
-Group Circle5Scrolls
-{
-    Item 1 bladespiritscroll
-    Item 1 dispelfieldscroll
-    Item 1 incognitoscroll
-    Item 1 magicrelfectscroll
-    Item 1 mindblastscroll
-    Item 1 paralyzescroll
-    Item 1 poisonfieldscroll
-    Item 1 summoncreaturescroll
-}
-
-Group Circle6Scrolls
-{
-    Item 1 dispelscroll
-    Item 1 energyboltscroll
-    Item 1 explosionscroll
-    Item 1 invisibilityscroll
-    Item 1 markscroll
-    Item 1 masscursescroll
-    Item 1 paralyzefieldscroll
-    Item 1 revealscroll
-}
-
-Group Circle7Scrolls
-{
-    Item 1 chainlightningscroll
-    Item 1 energyfieldscroll
-    Item 1 flamestrikescroll
-    Item 1 gatetravelscroll
-    Item 1 manavampirescroll
-    Item 1 massdispelscroll
-    Item 1 meteorswarmscroll
-    Item 1 polymorphscroll
-}
-
-Group Circle8Scrolls
-{
-    Item 1 earthquakescroll
-    Item 1 energyvortexscroll
-    Item 1 resurrectionscroll
-    Item 1 summonairelemscroll
-    Item 1 summondaemonscroll
-    Item 1 summonearthelemscroll
-    Item 1 summonfireelemscroll
-    Item 1 summonwaterelemscroll
-}
-
-Group Gems
-{
-    Item 1d2 starsapphire
-    Item 1d2 emerald
-    Item 1d2 sapphire
-    Item 1d2 ruby
-    Item 1d2 citrine
-    Item 1d2 amethyst
-    Item 1d2 tourmaline
-    Item 1d2 amber
-    Item 1d2 diamond
-}
-
-Group Wands
-{
-    Item 1 magicwand1
-    Item 1 magicwand2
-    Item 1 magicwand3
-    Item 1 magicwand4
-    Item 1 GnarledStaff
-}
-
-Group Scrolls
-{
-    Item 1 archcurescroll
-    Item 1 archprotectionscroll
-    Item 1 cursecroll
-    Item 1 firefieldscroll
-    Item 1 greaterhealscroll
-    Item 1 lightningscroll
-    Item 1 manadrainscroll
-    Item 1 recallscroll
-    Item 1 archcurescroll
-    Item 1 archprotectionscroll
-    Item 1 cursecroll
-    Item 1 firefieldscroll
-    Item 1 greaterhealscroll
-    Item 1 lightningscroll
-    Item 1 manadrainscroll
-    Item 1 recallscroll
-    Item 1 archcurescroll
-    Item 1 archprotectionscroll
-    Item 1 cursecroll
-    Item 1 firefieldscroll
-    Item 1 greaterhealscroll
-    Item 1 lightningscroll
-    Item 1 manadrainscroll
-    Item 1 recallscroll
-    Item 1 bladespiritscroll
-    Item 1 dispelfieldscroll
-    Item 1 incognitoscroll
-    Item 1 magicrelfectscroll
-    Item 1 mindblastscroll
-    Item 1 paralyzescroll
-    Item 1 poisonfieldscroll
-    Item 1 summoncreaturescroll
-    Item 1 bladespiritscroll
-    Item 1 dispelfieldscroll
-    Item 1 incognitoscroll
-    Item 1 magicrelfectscroll
-    Item 1 mindblastscroll
-    Item 1 paralyzescroll
-    Item 1 poisonfieldscroll
-    Item 1 summoncreaturescroll
-    Item 1 bladespiritscroll
-    Item 1 dispelfieldscroll
-    Item 1 incognitoscroll
-    Item 1 magicrelfectscroll
-    Item 1 mindblastscroll
-    Item 1 paralyzescroll
-    Item 1 poisonfieldscroll
-    Item 1 summoncreaturescroll
-    Item 1 dispelscroll
-    Item 1 energyboltscroll
-    Item 1 explosionscroll
-    Item 1 invisibilityscroll
-    Item 1 markscroll
-    Item 1 masscursescroll
-    Item 1 paralyzefieldscroll
-    Item 1 revealscroll
-    Item 1 dispelscroll
-    Item 1 energyboltscroll
-    Item 1 explosionscroll
-    Item 1 invisibilityscroll
-    Item 1 markscroll
-    Item 1 masscursescroll
-    Item 1 paralyzefieldscroll
-    Item 1 revealscroll
-    Item 1 chainlightningscroll
-    Item 1 energyfieldscroll
-    Item 1 flamestrikescroll
-    Item 1 gatetravelscroll
-    Item 1 manavampirescroll
-    Item 1 massdispelscroll
-    Item 1 meteorswarmscroll
-    Item 1 polymorphscroll
-}
\ No newline at end of file

Added: trunk/096/pkg/systems/loot/configs/OLD/lootgroup.cfg
===================================================================
--- trunk/096/pkg/systems/loot/configs/OLD/lootgroup.cfg	2005-11-05 23:23:40 UTC (rev 912)
+++ trunk/096/pkg/systems/loot/configs/OLD/lootgroup.cfg	2005-11-05 23:28:28 UTC (rev 913)
@@ -0,0 +1,317 @@
+#  Lootgroup config file
+# sets up a "lootgroup" -- a random group of loot you can assign to a creature. When the loot is created a certain number
+# of loot items are selected from the "item" listings in the lootgroup.
+#Basically, you set up a big list of items the creature could get, then set the number of items they do get.
+#their loot is a random selection from that list
+
+#Example:
+#lootgroup 2      : lootgroup number
+#rich             : a description I popped in there
+#always [n]       : always give n'th item, in addition to get_items randomly chosen
+#get_items 2      : a given creature will have 2 items. Can also be a diestring (ie, 3d6, for 3-18 items)
+#item 11          : each item that the creature could get. Items are entries in the loot.cfg file
+#item 12
+#item 13
+#item 14
+
+
+
+lootgroup 1
+{
+    #cheap
+    get_items 1d3+0
+    always 1
+    item 1
+    item 2
+    item 3
+    item 4
+    item 5
+    item 6
+    item 7
+    item 8
+    item 9
+    item 10
+    item 41
+    item 42
+    item 43
+    item 44
+    item 45
+    item 46
+    item 47
+    item 48
+    item 49
+    item 50
+    item 51
+    item 52
+    item 53
+    item 54
+    item 55
+    item 56
+    item 57
+    item 58
+    item 59
+    item 60
+    item 61
+    item 62
+    item 63
+    item 64
+    item 65
+    item 66
+}
+
+lootgroup 2
+{
+    #rich
+    get_items 1d2+0
+    always 11
+    item 11
+    item 12
+    item 13
+    item 14
+}
+
+lootgroup 3
+{
+    #very nice
+    always 17
+    item  15
+    item  16
+    item  17
+}
+
+lootgroup 4
+{
+    # reagents
+    get_items 2d4+0
+    always 1
+    item 18
+    item 19
+    item 20
+    item 21
+    item 22
+    item 23
+    item 24
+    item 25
+    item 26
+    item 27
+    item 28
+    item 29
+    item 30
+    item 31
+    item 32
+    item 33
+    item 34
+    item 35
+    item 36
+    item 37
+    item 38
+    item 39
+    item 40
+}
+
+lootgroup 5
+{
+    #level1chest
+    get_items 2d4+0
+    always 67
+    item 12
+    item 13
+    item 15
+    item 19
+    item 20
+    item 21
+    item 22
+    item 23
+    item 24
+    item 25
+    item 41
+    item 42
+    item 43
+    item 44
+    item 45
+    item 46
+    item 47
+    item 48
+    item 50
+    item 51
+    item 52
+    item 53
+    item 54
+    item 55
+    item 56
+    item 57
+    item 58
+    item 59
+    item 60
+    item 61
+    item 62
+    item 63
+    item 64
+    item 66
+    item 65
+}
+
+lootgroup 6
+{
+    #level2chest
+    get_items 3d4+0
+    always 68
+    item 12
+    item 13
+    item 15
+    item 19
+    item 20
+    item 21
+    item 22
+    item 23
+    item 24
+    item 25
+    item 41
+    item 42
+    item 43
+    item 44
+    item 45
+    item 46
+    item 47
+    item 48
+    item 50
+    item 51
+    item 52
+    item 53
+    item 54
+    item 55
+    item 56
+    item 57
+    item 58
+    item 59
+    item 60
+    item 61
+    item 62
+    item 63
+    item 64
+    item 66
+    item 65
+}
+lootgroup 7
+{
+    #level3chest
+    get_items 4d4+0
+    always 69
+    item 12
+    item 13
+    item 15
+    item 19
+    item 20
+    item 21
+    item 22
+    item 23
+    item 24
+    item 25
+    item 41
+    item 42
+    item 43
+    item 44
+    item 45
+    item 46
+    item 47
+    item 48
+    item 50
+    item 51
+    item 52
+    item 53
+    item 54
+    item 55
+    item 56
+    item 57
+    item 58
+    item 59
+    item 60
+    item 61
+    item 62
+    item 63
+    item 64
+    item 66
+    item 65
+}
+lootgroup 8
+{
+    #level4chest
+    get_items 4d5+0
+    always 70
+    item 12
+    item 13
+    item 15
+    item 19
+    item 20
+    item 21
+    item 22
+    item 23
+    item 24
+    item 25
+    item 41
+    item 42
+    item 43
+    item 44
+    item 45
+    item 46
+    item 47
+    item 48
+    item 50
+    item 51
+    item 52
+    item 53
+    item 54
+    item 55
+    item 56
+    item 57
+    item 58
+    item 59
+    item 60
+    item 61
+    item 62
+    item 63
+    item 64
+    item 66
+    item 65
+}
+lootgroup 9
+{
+    #level5chest
+    get_items 5d5+0
+    always 71
+    item 12
+    item 13
+    item 15
+    item 19
+    item 20
+    item 21
+    item 22
+    item 23
+    item 24
+    item 25
+    item 41
+    item 42
+    item 43
+    item 44
+    item 45
+    item 46
+    item 47
+    item 48
+    item 50
+    item 51
+    item 52
+    item 53
+    item 54
+    item 55
+    item 56
+    item 57
+    item 58
+    item 59
+    item 60
+    item 61
+    item 62
+    item 63
+    item 64
+    item 66
+    item 65
+}

Added: trunk/096/pkg/systems/loot/configs/OLD/nlootgroup.cfg
===================================================================
--- trunk/096/pkg/systems/loot/configs/OLD/nlootgroup.cfg	2005-11-05 23:23:40 UTC (rev 912)
+++ trunk/096/pkg/systems/loot/configs/OLD/nlootgroup.cfg	2005-11-05 23:28:28 UTC (rev 913)
@@ -0,0 +1,967 @@
+# $Id: nlootgroup.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+###############################################
+#  NLOOTGROUP.CFG - Loot definitions
+#
+#  Format:
+#      Stack {n=1} [ObjName] {color=0} {chancetospawn=100} Stacks the amount. DO NOT use on
+#            non-stackable items such as arms and armor! Use "Item" for those.
+#      Item {n=1} [ObjName] {color=0} {chancetospawn=100}  include 1 of ObjName
+#      Random [n] [GroupName] {chancetospawn=100} pick n Items from GroupName randomly
+#      Group [GroupName]       include GroupName too
+#      Unique [ObjName]         don't give more than one
+###############################################
+lootgroup 1             #orc
+{
+    Stack  1d50         GoldCoin
+}
+
+lootgroup 2             #orc
+{
+    Stack  1d50         GoldCoin
+}
+
+lootgroup 3             #lizardman
+{
+    Stack  1d50         GoldCoin
+}
+
+lootgroup 4             #spectre
+{
+    stack  1d100+50     GoldCoin
+    Random 1            NormalEquipment 0 5
+    Random 1d2          Gems
+    Random 1            BoneArmor       0 15
+}
+
+lootgroup 5             #level1map
+{
+    Random 1            Circle1Scrolls
+    Random 2            Circle2Scrolls
+    Random 2            Circle3Scrolls
+    Stack  1000         GoldCoin
+    Random 1d6+14       Reagents
+    Random 6            NormalEquipment
+    Random 10           Gems
+}
+
+lootgroup 6             #level2map
+{
+    Random 2            Circle1Scrolls
+    Random 3            Circle2Scrolls
+    Random 4            Circle3Scrolls
+    Random 5            Circle4Scrolls
+    Stack  2000         GoldCoin
+    Random 1d21+19      Reagents
+    Random 20           Gems
+    Random 1d6+9        NormalEquipment
+}
+
+lootgroup 7             #level3map
+{
+    Random 3            Circle3Scrolls
+    Random 4            Circle4Scrolls
+    Random 6            Circle5Scrolls
+    Random 7            Circle6Scrolls
+    Stack  3000         GoldCoin
+    Random 1d21+19      Reagents
+    Random 30           Gems
+    Random 1d6+14       NormalEquipment
+}
+
+lootgroup 8             #level4map
+{
+    Random 3            Circle3Scrolls
+    Random 3            Circle4Scrolls
+    Random 6            Circle5Scrolls
+    Random 6            Circle6Scrolls
+    Random 6            Circle7Scrolls
+    Random 6            Circle7Scrolls
+    Stack  4000         GoldCoin
+    Random 1d41+39      Reagents
+    Random 40           Gems
+    Random 1d6+14       NormalEquipment
+}
+
+lootgroup 9             #level5map
+{
+    Random 5            Circle4Scrolls
+    Random 6            Circle5Scrolls
+    Random 7            Circle6Scrolls
+    Random 8            Circle7Scrolls
+    Random 4            Circle8Scrolls
+    Stack  5000         GoldCoin
+    Random 1d51+99      Reagents
+    Random 50           Gems
+    Random 1d6+19       NormalEquipment
+}
+
+lootgroup 10            #ratman
+{
+    Stack  1d50         GoldCoin
+}
+
+lootgroup 11            #skeletal knight
+{
+    Stack  1d50+100     GoldCoin
+    Item   1            OrcMask         0   20
+    Random 1            Potions
+    Random 1            Gems
+    Stack  10           Arrow           0   80
+}
+
+lootgroup 12            #skeletal mage
+{
+    Random 1            Circle4Scrolls
+    Random 1d3          Reagents
+}
+
+lootgroup 13            #orc lord
+{
+    Stack 1d150+150     GoldCoin
+    Random 1            NormalEquipment 0 10
+    Random 1            Gems
+}
+
+lootgroup 14            #ettin
+{
+    Stack  1d100+50     GoldCoin
+    Stack  10           Arrow           0   80
+    Random 2            Gems
+    Random 1            potions
+}
+
+lootgroup 15            #skeleton
+{
+    Stack  1d50         GoldCoin
+    Random 1            BoneArmor       0 30
+}
+
+lootgroup 16            #bone knight
+{
+    Stack 1d150         GoldCoin
+    Item  1             OrcMask         0   20
+}
+
+lootgroup 17            #ogre
+{
+    Stack  1d50+100     GoldCoin
+    Stack  3d5          Arrow           0   80
+    Random 1d2          Gems
+    Random 1            potions
+}
+
+lootgroup 18            #troll
+{
+    Item   1            Level1map           0   3
+    Stack  1d50+150     GoldCoin
+    Stack  3d5          Arrow           0   80
+    Random 1            potions
+}
+
+lootgroup 21            #ogre lord
+{
+    Item   1            Level3map           0   3
+    Stack  1d50+200     GoldCoin
+    Random 1d3          NormalEquipment 0 30
+}
+
+lootgroup 22            #fire ele
+{
+    Item   1            Level2map           0   3
+    Stack  1d150+150    GoldCoin
+    Item   1d4          SulphurousAsh
+    Random 2            Gems
+}
+
+lootgroup 23            #water ele
+{
+    Item   1            Level2map           0   3
+    Stack  1d50+200     GoldCoin
+    Random 3            Reagents
+    Random 1            Potions
+}
+
+lootgroup 24            #earth ele
+{
+    Item   1            level2map       0   3
+    Stack  10           IronOre
+    Random 2            Gems
+}
+
+lootgroup 25            #air elemental
+{
+    Item   1            Level2map           0   3
+    Random 1            Scrolls
+    Stack 1d100+400     GoldCoin
+    Random 1            Potions
+}
+
+lootgroup 26            #daemon
+{
+    Random 1d2          Scrolls
+    Random 1            Circle8Scrolls  0 30
+    Stack  1d450+150    GoldCoin
+    Random 1d2          NormalEquipment
+    Item   1            Level4map       0   3
+    Random 1d5          Gems
+}
+
+lootgroup 27            #liche
+{
+    Random 1d2          Scrolls
+    Stack  1d50+200     GoldCoin
+    Random 2d3          Reagents
+    Random 1d3          Gems
+    Random 1            Wands
+    Random 1            NormalEquipment 0 5
+    Item   1            Level3map       0   3
+}
+
+lootgroup 28            #zombie
+{
+    Stack  1d20         GoldCoin
+    Random 1            BoneArmor       0 30
+}
+
+lootgroup 29            #shade
+{
+    Random 1            Scrolls
+    Stack  1d50+100     GoldCoin
+}
+
+lootgroup 30            #wraith
+{
+    Stack  1d50+100     GoldCoin
+    Random 1            NormalEquipment 0 5
+    Random 1            Gems
+}
+####################################
+#  31      32
+####################################
+lootgroup 33            #harpy
+{
+    Stack 1d100+50      GoldCoin
+}
+
+lootgroup 34            #gazer
+{
+    Item   1            level3map       0   3
+    Stack  1d50+100     GoldCoin
+    Stack  3d5          Arrow           0   85
+    Stack  3d5          Nightshade      0   90
+    Random 1            Potions
+    Random 1            NormalEquipment 0 5
+    Random 1            Scrolls         0 60
+}
+
+lootgroup 35            #orcmage
+{
+    Item   1            Level1map           0   3
+    Random 1            Scrolls         0 50
+    Stack  1d100+50     GoldCoin
+    Stack  3d5          Arrow           0   45
+    Random 1d2          Gems
+    Random 1d4          Reagents
+}
+
+lootgroup 36            #corpser
+{
+    Stack 1d50          GoldCoin
+    Stack 10            Logs
+}
+
+lootgroup 37            #imp
+{
+    Stack 1d50          GoldCoin
+}
+
+lootgroup 38            #reaper
+{
+    Item   1            Level2map           0   3
+    Stack 1d150         GoldCoin
+    Stack 10            Logs
+    Random 1d2          Reagents
+}
+
+lootgroup 39            #ancient wyrm
+{
+    Item   1            level5map       0   3
+    Random 2d8          Gems
+    Stack 1d200+1200    GoldCoin
+    Random 1d6          NormalEquipment
+}
+
+lootgroup 40           #drake
+{
+    Stack  1d50+200    GoldCoin
+    Item   1           level3map        0   3
+}
+
+lootgroup 41            #dragon
+{
+    Stack  1d200+1200   GoldCoin
+    Random 1d4          NormalEquipment
+    Item   1            level4map       0   3
+    Random 2d5          Gems
+}
+
+lootgroup 42            #gargoyle
+{
+    Item   1            level2map       0   3
+    Stack  1d50+100     GoldCoin
+    Random 1            Scrolls         0 40
+    Stack  10           Arrow           0   50
+    Random 1d2          Gems
+    Random 1            potions
+}
+
+lootgroup 43            #bone magi
+{
+    Random 1            Scrolls         0 40
+    Random 1            NormalEquipment 0 5
+    Stack  1d150+50     GoldCoin
+    Random 1d2          Gems
+}
+
+
+lootgroup 45            #elder gazer
+{
+    stack  1000         GoldCoin
+    Random 1d5          NormalEquipment
+    Random 2d4          Gems
+}
+
+lootgroup 46            #ghoul
+{
+    stack  1d100+50     GoldCoin
+    Random 1d5          NormalEquipment 0 3
+    Random 1d2          Gems
+    Random 1            BoneArmor       0 15
+}
+
+lootgroup 47            #headless
+{
+    stack  1d50+1       GoldCoin
+}
+
+lootgroup 48            #evilmage
+{
+    Random 2d2          Scrolls
+    Stack  1d50         GoldCoin
+    Random 2d4          Reagents
+    Random 1d4          Gems
+}
+
+lootgroup 49            #magelord
+{
+    Random 2d3          Scrolls
+    Stack  1d50+200     GoldCoin
+    Random 2d4          Reagents
+    Random 1d4          Gems
+}
+
+lootgroup 50            #poison elemental
+{
+    Item   1            level5map       0   3
+    Stack  1d300+800    GoldCoin
+    Random 1d3          NormalEquipment 0 50
+    Random 1d4          Gems
+}
+
+lootgroup 51            #terathan warrior
+{
+    Item   1            Level1map           0   3
+    Stack  1d50+200     GoldCoin
+    Random 1            Potions
+}
+
+lootgroup 52            #mummy
+{
+    Item   1            Level2map           0   3
+    Stack  1d150        GoldCoin
+}
+
+lootgroup 53            #ophidian shaman
+{
+    Random 1d2          Scrolls
+    Stack  1d50+200     GoldCoin
+    Random 2d3          Reagents
+    Random 1d3          Gems
+    Random 1            NormalEquipment 0 5
+    Item   1            Level3map       0   3
+}
+
+lootgroup 54            #wyvern
+{
+    Stack  1d200+1200   GoldCoin
+    Random 1d4          NormalEquipment
+    Item   1            level2map       0   3
+    Random 2d5          Gems
+}
+
+lootgroup 55            #cyclopse
+{
+    Stack  1d50+200     GoldCoin
+    Random 1d3          Gems
+    Random 1            NormalEquipment 0 5
+    Item   1            Level3map       0   3
+}
+
+lootgroup 56            #ophidian enforcer
+{
+    Item   1            Level1map           0   3
+    Stack  1d100+200    GoldCoin
+    Random 1d3          NormalEquipment 0 50
+    Random 1d4          Gems
+}
+
+lootgroup 57            #efreet
+{
+    Item   1            Level3map           0   3
+    Random 1            Scrolls
+    Stack 1d100+300     GoldCoin
+    Random 1            Potions
+}
+
+lootgroup 58            #ophidian knight errant
+{
+    Item   1            Level3map           0   3
+    Stack  1d100+250    GoldCoin
+    Random 1d3          NormalEquipment     0 50
+}
+
+lootgroup 59            #ophidian/terathan matriarch
+{
+    Item   1            Level4map           0   3
+    Stack  1d100+400    GoldCoin
+    Random 1d3          NormalEquipment 0 70
+    Random 2d6          Reagents
+    Random 1d4          Gems
+}
+
+lootgroup 60            #titan
+{
+    Random 1d2          Scrolls
+    Stack  1d50+200     GoldCoin
+    Random 2d3          Reagents
+    Random 1d3          Gems
+    Random 1            Wands
+    Random 1            NormalEquipment 0 5
+    Item   1            Level4map       0   3
+}
+
+lootgroup 61            #brigand1
+{
+    Stack  1d50+50      GoldCoin
+}
+
+lootgroup 62            # ice elemental
+{
+    Item   1            Level3map       0   3
+	Stack 1d200+300     GoldCoin
+    Random 1            Potions
+    Random 2            Gems
+}
+#####################################
+#         63                64
+#####################################
+lootgroup 65            #lichelord
+{
+    Item   1            Level4map           0   3
+    Random 1d3          Scrolls
+    Stack  1d100+300    GoldCoin
+    Random 2d6          Reagents
+    Random 1d5          NormalEquipment 0 5
+    Random 1d4          Gems
+}
+
+lootgroup 67            #balron
+{
+    Random 1d2          Scrolls
+    Random 1            Circle8Scrolls      0 65
+    Stack  1d400+800    GoldCoin
+    Item   1            Level5map           0   3
+    Item   1            BroadSword
+    Random 3            NormalEquipment     0 40
+}
+
+lootgroup 68            # blood elemental
+{
+    Item   1            level5map       0   3
+    Random 1            NormalEquipment     0 20
+	Random 1            Scrolls
+	Stack  1d500+500    GoldCoin
+	Random 2d6          Gems
+}
+
+lootgroup 69            # chestspawn1
+{
+	Stack  1d30         GoldCoin
+	random 1            Gems          0 50
+    random 1            Potions            0 70
+}
+
+lootgroup 70            # chestspawn2
+{
+	Stack  2d30         GoldCoin
+	random 2            Gems               0 50
+	random 1            Potions           0  50
+}
+
+lootgroup 71            # chestspawn3
+{
+	Stack  3d30         GoldCoin
+	random 2            Gems              0  50
+	random 1            Potions           0  50
+	Random 2            Scrolls           0  25
+}
+
+lootgroup 72            # chestspawn4
+{
+	Stack  4d30         GoldCoin
+	random 4            Gems               0 50
+	random 1            Potions            0 50
+	Random 2            Scrolls            0 50
+	Random 1            NormalEquipment    0 30
+}
+
+lootgroup 73            # chestspawn5
+{
+	Stack  6d30         GoldCoin
+	random 5            Gems               0 50
+	random 1            Potions            0 50
+	Random 2            Scrolls            0 80
+	Random 2            NormalEquipment    0 40
+}
+
+lootgroup 74            # dread spider
+{
+    Item   1            Level3map       0   3
+	Stack 1d50+200      GoldCoin
+    Random 1            Potions
+}
+
+lootgroup 75            # hellhound
+{
+	Stack 1d150         GoldCoin
+    Item  5             SulphurousAsh
+}
+########################
+#-----------------Groups---------------------#
+########################
+Group Potions
+{
+    Item 1 LesserHeal
+    Item 1 LesserPoison
+    Item 1 LesserExplosion
+    Item 1 AgilityPotion
+    Item 1 RefreshPotion
+    Item 1 StrengthPotion
+    Item 1 Nightsight
+    Item 1 LesserCure
+}
+
+Group Reagents
+{
+    Item 1d6 BloodMoss
+    Item 1d6 Nightshade
+    Item 1d6 Garlic
+    Item 1d6 SpiderSilk
+    Item 1d6 MandrakeRoot
+    Item 1d6 SulphurousAsh
+    Item 1d6 BlackPearl
+    Item 1d6 Ginseng
+}
+
+Group NormalEquipment
+{
+    Item 1 Longsword
+    Item 1 WarAxe
+    Item 1 Bow
+    Item 1 Crossbow
+    Item 1 HeavyCrossbow
+    Item 1 Axe
+    Item 1 BattleAxe
+    Item 1 DoubleAxe
+    Item 1 ExecutionersAxe
+    Item 1 LargeBattleAxe
+    Item 1 TwoHandedAxe
+    Item 1 HammerPick
+    Item 1 Mace
+    Item 1 Maul
+    Item 1 WarHammer
+    Item 1 WarMace
+    Item 1 Bardiche
+    Item 1 Halberd
+    Item 1 ShortSpear
+    Item 1 Spear
+    Item 1 WarFork
+    Item 1 BroadSword
+    Item 1 Cutlass
+    Item 1 Dagger
+    Item 1 Katana
+    Item 1 Kryss
+    Item 1 Scimitar
+    Item 1 VikingSword
+    Item 1 Hatchet
+    Item 1 PickAxe
+    Item 1 ButcherKnife
+    Item 1 Cleaver
+    Item 1 SkinningKnife
+    Item 1 Club
+    Item 1 SmithyHammer
+    Item 1 PitchFork
+    Item 1 BlackStaff
+    Item 1 GnarledStaff
+    Item 1 QuarterStaff
+    Item 1 ShepherdsCrook
+    Item 1 LeatherGorget
+    Item 1 LeatherSleeves
+    Item 1 LeatherGloves
+    Item 1 LeatherCap
+    Item 1 LeatherLeggings
+    Item 1 LeatherTunic
+    Item 1 LeatherTunic2
+    Item 1 StuddedGorget
+    Item 1 StuddedGloves
+    Item 1 StuddedSleeves
+    Item 1 StuddedLeggings
+    Item 1 StuddedTunic
+    Item 1 FemaleStudded
+    Item 1 FemaleLeather
+    Item 1 LeatherSkirt
+    Item 1 LeatherBustier
+    Item 1 StuddedBustier
+    Item 1 LeatherShorts
+    Item 1 LeatherBoots
+    Item 1 ThighBoots
+    Item 1 ChainmailCoif
+    Item 1 ChainmailLeggings
+    Item 1 ChainmailTunic
+    Item 1 CloseHelm
+    Item 1 Helmet
+    Item 1 Bascinet
+    Item 1 NoseHelm
+    Item 1 PlateHelm
+    Item 1 BronzeShield
+    Item 1 Buckler
+    Item 1 KiteShield
+    Item 1 HeaterShield
+    Item 1 KiteShieldB1
+    Item 1 WoodenShield
+    Item 1 MetalShield
+    Item 1 RingmailTunic
+    Item 1 RingmailSleeves
+    Item 1 RingmailLeggings
+    Item 1 RingmailGloves
+    Item 1 PlatemailBreastplate
+    Item 1 PlatemailArms
+    Item 1 PlatemailLegs
+    Item 1 PlatemailGorget
+    Item 1 Platemailgloves
+    Item 1 Robe
+    Item 1 ring
+    Item 1 silvernecklace
+    Item 1 bracelet
+    Item 1 earings
+    Item 1 roundnecklace
+    Item 1 longnecklace
+    Item 1 ring
+    Item 1 Cloak
+}
+
+Group NormalWeapons
+{
+    Item 1 Longsword
+    Item 1 WarAxe
+    Item 1 Bow
+    Item 1 Crossbow
+    Item 1 HeavyCrossbow
+    Item 1 Axe
+    Item 1 BattleAxe
+    Item 1 DoubleAxe
+    Item 1 ExecutionersAxe
+    Item 1 LargeBattleAxe
+    Item 1 TwoHandedAxe
+    Item 1 HammerPick
+    Item 1 Mace
+    Item 1 Maul
+    Item 1 WarHammer
+    Item 1 WarMace
+    Item 1 Bardiche
+    Item 1 Halberd
+    Item 1 ShortSpear
+    Item 1 Spear
+    Item 1 WarFork
+    Item 1 BroadSword
+    Item 1 Cutlass
+    Item 1 Dagger
+    Item 1 Katana
+    Item 1 Kryss
+    Item 1 Scimitar
+    Item 1 VikingSword
+    Item 1 Hatchet
+    Item 1 PickAxe
+    Item 1 ButcherKnife
+    Item 1 Cleaver
+    Item 1 SkinningKnife
+    Item 1 Club
+    Item 1 SmithyHammer
+    Item 1 PitchFork
+    Item 1 BlackStaff
+    Item 1 QuarterStaff
+    Item 1 ShepherdsCrook
+}
+
+Group NormalArmor
+{
+    Item 1 LeatherGorget
+    Item 1 LeatherSleeves
+    Item 1 LeatherGloves
+    Item 1 LeatherCap
+    Item 1 LeatherLeggings
+    Item 1 LeatherTunic
+    Item 1 LeatherTunic2
+    Item 1 StuddedGorget
+    Item 1 StuddedGloves
+    Item 1 StuddedSleeves
+    Item 1 StuddedLeggings
+    Item 1 StuddedTunic
+    Item 1 FemaleStudded
+    Item 1 FemaleLeather
+    Item 1 LeatherSkirt
+    Item 1 LeatherBustier
+    Item 1 StuddedBustier
+    Item 1 LeatherShorts
+    Item 1 LeatherBoots
+    Item 1 ThighBoots
+    Item 1 ChainmailCoif
+    Item 1 ChainmailLeggings
+    Item 1 ChainmailTunic
+    Item 1 CloseHelm
+    Item 1 Helmet
+    Item 1 Bascinet
+    Item 1 NoseHelm
+    Item 1 PlateHelm
+    Item 1 BronzeShield
+    Item 1 Buckler
+    Item 1 KiteShield
+    Item 1 HeaterShield
+    Item 1 KiteShieldB1
+    Item 1 WoodenShield
+    Item 1 MetalShield
+    Item 1 RingmailTunic
+    Item 1 RingmailSleeves
+    Item 1 RingmailLeggings
+    Item 1 RingmailGloves
+    Item 1 PlatemailBreastplate
+    Item 1 PlatemailArms
+    Item 1 PlatemailLegs
+    Item 1 PlatemailGorget
+    Item 1 Robe
+}
+
+Group BoneArmor
+{
+    Item 1 Bonegloves
+    Item 1 BoneArms
+    Item 1 Bonelegs
+    Item 1 Bonetunic
+    Item 1 Bonehelm
+}
+
+Group Circle1Scrolls
+{
+    Item 1 reactivearmorscroll
+    Item 1 clumsyscroll
+    Item 1 createfoodscroll
+    Item 1 feeblemindscroll
+    Item 1 healscroll
+    Item 1 magicarrowscroll
+    Item 1 nightsightscroll
+    Item 1 weakenscroll
+}
+
+Group Circle2Scrolls
+{
+    Item 1 agilityscroll
+    Item 1 cunningscroll
+    Item 1 curescroll
+    Item 1 harmscroll
+    Item 1 magictrapscroll
+    Item 1 magicuntrapscroll
+    Item 1 protectionscroll
+    Item 1 strengthscroll
+}
+
+Group Circle3Scrolls
+{
+    Item 1 blessscroll
+    Item 1 fireballscroll
+    Item 1 magiclockscroll
+    Item 1 poisonscroll
+    Item 1 telekinesisscroll
+    Item 1 teleportscroll
+    Item 1 magicunlockscroll
+    Item 1 wallofstonescroll
+}
+
+Group Circle4Scrolls
+{
+    Item 1 archcurescroll
+    Item 1 archprotectionscroll
+    Item 1 cursecroll
+    Item 1 firefieldscroll
+    Item 1 greaterhealscroll
+    Item 1 lightningscroll
+    Item 1 manadrainscroll
+    Item 1 recallscroll
+}
+
+Group Circle5Scrolls
+{
+    Item 1 bladespiritscroll
+    Item 1 dispelfieldscroll
+    Item 1 incognitoscroll
+    Item 1 magicrelfectscroll
+    Item 1 mindblastscroll
+    Item 1 paralyzescroll
+    Item 1 poisonfieldscroll
+    Item 1 summoncreaturescroll
+}
+
+Group Circle6Scrolls
+{
+    Item 1 dispelscroll
+    Item 1 energyboltscroll
+    Item 1 explosionscroll
+    Item 1 invisibilityscroll
+    Item 1 markscroll
+    Item 1 masscursescroll
+    Item 1 paralyzefieldscroll
+    Item 1 revealscroll
+}
+
+Group Circle7Scrolls
+{
+    Item 1 chainlightningscroll
+    Item 1 energyfieldscroll
+    Item 1 flamestrikescroll
+    Item 1 gatetravelscroll
+    Item 1 manavampirescroll
+    Item 1 massdispelscroll
+    Item 1 meteorswarmscroll
+    Item 1 polymorphscroll
+}
+
+Group Circle8Scrolls
+{
+    Item 1 earthquakescroll
+    Item 1 energyvortexscroll
+    Item 1 resurrectionscroll
+    Item 1 summonairelemscroll
+    Item 1 summondaemonscroll
+    Item 1 summonearthelemscroll
+    Item 1 summonfireelemscroll
+    Item 1 summonwaterelemscroll
+}
+
+Group Gems
+{
+    Item 1d2 starsapphire
+    Item 1d2 emerald
+    Item 1d2 sapphire
+    Item 1d2 ruby
+    Item 1d2 citrine
+    Item 1d2 amethyst
+    Item 1d2 tourmaline
+    Item 1d2 amber
+    Item 1d2 diamond
+}
+
+Group Wands
+{
+    Item 1 magicwand1
+    Item 1 magicwand2
+    Item 1 magicwand3
+    Item 1 magicwand4
+    Item 1 GnarledStaff
+}
+
+Group Scrolls
+{
+    Item 1 archcurescroll
+    Item 1 archprotectionscroll
+    Item 1 cursecroll
+    Item 1 firefieldscroll
+    Item 1 greaterhealscroll
+    Item 1 lightningscroll
+    Item 1 manadrainscroll
+    Item 1 recallscroll
+    Item 1 archcurescroll
+    Item 1 archprotectionscroll
+    Item 1 cursecroll
+    Item 1 firefieldscroll
+    Item 1 greaterhealscroll
+    Item 1 lightningscroll
+    Item 1 manadrainscroll
+    Item 1 recallscroll
+    Item 1 archcurescroll
+    Item 1 archprotectionscroll
+    Item 1 cursecroll
+    Item 1 firefieldscroll
+    Item 1 greaterhealscroll
+    Item 1 lightningscroll
+    Item 1 manadrainscroll
+    Item 1 recallscroll
+    Item 1 bladespiritscroll
+    Item 1 dispelfieldscroll
+    Item 1 incognitoscroll
+    Item 1 magicrelfectscroll
+    Item 1 mindblastscroll
+    Item 1 paralyzescroll
+    Item 1 poisonfieldscroll
+    Item 1 summoncreaturescroll
+    Item 1 bladespiritscroll
+    Item 1 dispelfieldscroll
+    Item 1 incognitoscroll
+    Item 1 magicrelfectscroll
+    Item 1 mindblastscroll
+    Item 1 paralyzescroll
+    Item 1 poisonfieldscroll
+    Item 1 summoncreaturescroll
+    Item 1 bladespiritscroll
+    Item 1 dispelfieldscroll
+    Item 1 incognitoscroll
+    Item 1 magicrelfectscroll
+    Item 1 mindblastscroll
+    Item 1 paralyzescroll
+    Item 1 poisonfieldscroll
+    Item 1 summoncreaturescroll
+    Item 1 dispelscroll
+    Item 1 energyboltscroll
+    Item 1 explosionscroll
+    Item 1 invisibilityscroll
+    Item 1 markscroll
+    Item 1 masscursescroll
+    Item 1 paralyzefieldscroll
+    Item 1 revealscroll
+    Item 1 dispelscroll
+    Item 1 energyboltscroll
+    Item 1 explosionscroll
+    Item 1 invisibilityscroll
+    Item 1 markscroll
+    Item 1 masscursescroll
+    Item 1 paralyzefieldscroll
+    Item 1 revealscroll
+    Item 1 chainlightningscroll
+    Item 1 energyfieldscroll
+    Item 1 flamestrikescroll
+    Item 1 gatetravelscroll
+    Item 1 manavampirescroll
+    Item 1 massdispelscroll
+    Item 1 meteorswarmscroll
+    Item 1 polymorphscroll
+}
\ No newline at end of file



From austin at berlios.de  Sun Nov  6 00:29:57 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 00:29:57 +0100
Subject: [Poldistro-svn] r914 - in trunk/096: config pkg/systems/spawnSystem/config pkg/systems/spawnSystem/config/OLD
Message-ID: <200511052329.jA5NTvUa013876@sheep.berlios.de>

Author: austin
Date: 2005-11-06 00:29:57 +0100 (Sun, 06 Nov 2005)
New Revision: 914

Added:
   trunk/096/pkg/systems/spawnSystem/config/OLD/
   trunk/096/pkg/systems/spawnSystem/config/OLD/spawngroups.cfg
   trunk/096/pkg/systems/spawnSystem/config/OLD/spawnregions.cfg
Removed:
   trunk/096/config/spawngroups.cfg
   trunk/096/config/spawnregions.cfg
Log:
Moved old spawner config files to the spawner system so they can be referenced into the new system before being fully deleted.

Deleted: trunk/096/config/spawngroups.cfg
===================================================================
--- trunk/096/config/spawngroups.cfg	2005-11-05 23:28:28 UTC (rev 913)
+++ trunk/096/config/spawngroups.cfg	2005-11-05 23:29:57 UTC (rev 914)
@@ -1,657 +0,0 @@
-
-group zoo_swamp
-{
-	npc	grat
-	npc	giant_serpent
-	npc	alligator
-	npc	lizardman1
-}
-
-group zoo_ice
-{
-	npc	walrus
-	npc	polar
-	npc	frosttroll
-}
-
-group zoo_forest2
-{
-	npc	ogre
-	npc	bear
-	npc	ettin
-	npc	reaper
-}
-
-group zoo_forest1
-{
-	npc	mongbat
-	npc	harpy
-	npc	headless
-}
-
-group zoo_desert
-{
-	npc	giant_serpent
-	npc	giantscorp
-	npc	snake
-	npc	giantscorp
-}
-
-group Zombie
-{
-	npc	zombie
-}
-
-group weakundead
-{
-	npc	skeleton
-	npc	zombie
-	npc	skeleton
-	npc	zombie
-	npc	skeleton
-}
-
-group weakorcs
-{
-	npc	orc1
-	npc	orc2
-}
-
-group weaklizardmen
-{
-	npc	lizardman1
-	npc	lizardman1
-	npc	lizardman1
-	npc	lizardman2
-	npc	lizardman2
-	npc	lizardman2
-	npc	lizardman3
-	npc	lizardman3
-	npc	lizardman3
-}
-
-group weakforestmonsters
-{
-	npc	mongbat
-	npc	mongbat
-	npc	mongbat
-	npc	giantspider
-	npc	giantspider
-	npc	harpy
-	npc	harpy
-	npc	headless
-	npc	headless
-	npc	corpser
-}
-
-group Waterelemental
-{
-	npc	waterelemental
-}
-
-group undead
-{
-	npc	zombie
-	npc	zombie
-	npc	zombie
-	npc	skeleton
-	npc	skeleton
-	npc	skeleton
-	npc	shade
-	npc	shade
-}
-
-group trolls
-{
-	npc	troll1
-	npc	troll2
-	npc	troll3
-}
-
-group townies
-{
-	npc	employee
-}
-
-group towncreatures
-{
-	npc	bird
-	npc	dog
-	npc	cat
-	npc	bird
-	npc	bird
-	npc	dog
-}
-
-group terathans_greater
-{
-	npc	terathanmatriarch
-	npc	terathanavenger
-	npc	terathanavenger
-}
-
-group terathans
-{
-	npc	terathandrone
-	npc	terathanwarrior
-}
-
-group t2adesert
-{
-	npc	desertostard
-	npc	desertostard
-	npc	desertostard
-	npc	giantscorp
-	npc	giantscorp
-	npc	giantscorp
-	npc	giantspider
-	npc	giantspider
-	npc	giantspider
-	npc	imp
-	npc	imp
-	npc	stonegargoyle
-	npc	stonegargoyle
-	npc	stonegargoyle
-	npc	giant_serpent
-	npc	giant_serpent
-}
-
-group T2A_eastern_swamp
-{
-	npc	bullfrog
-	npc	gianttoad
-	npc	waterelemental
-	npc	corpser
-	npc	alligator
-	npc	bullfrog
-	npc	gianttoad
-}
-
-group strongorcs
-{
-	npc	orclord
-	npc	orclord
-	npc	orcmage
-}
-
-group stronghumanoids
-{
-	npc	cyclopse
-	npc	cyclopse
-	npc	cyclopse
-	npc	titan
-	npc	ogrelord
-}
-
-group strongforestmonsters
-{
-	npc	harpy
-	npc	harpy
-	npc	corpser
-	npc	corpser
-	npc	direwolf
-	npc	gargoyle
-	npc	gazer
-	npc	reaper
-}
-
-group Slime
-{
-	npc	slime
-}
-
-group Skeleton
-{
-	npc	skeleton
-}
-
-group Shade
-{
-	npc	shade
-}
-
-group ratmen
-{
-	npc	ratman1
-	npc	ratman2
-	npc	ratman3
-}
-
-group ratfodder
-{
-	npc	sheep
-	npc	goat
-}
-
-group randomother
-{
-	npc	airelemental
-	npc	airelemental
-	npc	waterelemental
-	npc	waterelemental
-	npc	gargoyle
-	npc	ettin
-	npc	ettin2
-}
-
-group plainswalkers
-{
-	npc	chicken
-	npc	chicken
-	npc	cow
-	npc	cow
-	npc	sheep
-	npc	sheep
-	npc	goat
-	npc	goat
-	npc	bull
-	npc	deer
-	npc	deer
-	npc	ghart
-}
-
-group ophidians_greater
-{
-	npc	ophidianmatriarch
-	npc	ophidianavenger
-	npc	ophidianknighterrant
-	npc	ophidianshaman
-	npc	ophidianshaman
-}
-
-group ophidians
-{
-	npc	ophidianenforcer
-	npc	ophidianwarrior
-	npc	ophidianwarrior
-	npc	ophidianenforcer
-	npc	ophidianmage
-}
-
-group ogrelord
-{
-	npc	ogrelord
-}
-
-group newbieforest
-{
-	npc	chicken
-	npc	cow
-	npc	goat
-	npc	pig
-	npc	bull
-	npc	bird
-	npc	bird
-	npc	bird
-	npc	bird
-	npc	llama
-	npc	deer
-	npc	deer
-	npc	rabbit
-	npc	rat
-	npc	snake
-	npc	eagle
-	npc	ghart
-	npc	bear
-	npc	blackbear
-}
-
-group newbie
-{
-	npc	mongbat
-	npc	mongbat
-	npc	snake
-	npc	headless
-	npc	headless
-	npc	lizardman1
-	npc	lizardman2
-	npc	lizardman3
-	npc	orc1
-	npc	orc2
-	npc	ratman1
-	npc	ratman2
-	npc	ratman3
-}
-
-group llord
-{
-	npc	lichelord
-}
-
-group liche
-{
-	npc	liche
-}
-
-group lesserundead
-{
-	npc	zombie
-	npc	zombie
-	npc	zombie
-	npc	skeleton
-	npc	skeleton
-	npc	skeleton
-	npc	shade
-}
-
-group lesserorcs
-{
-	npc	orc1
-	npc	orc2
-}
-
-group junglemonsters
-{
-	npc	grat
-	npc	grat
-	npc	grat
-	npc	mongbat
-	npc	mongbat
-	npc	mongbat
-	npc	headless
-	npc	headless
-	npc	giantspider
-	npc	giantspider
-	npc	corpser
-	npc	gazer
-	npc	harpy
-	npc	giant_serpent
-}
-
-group jungleanimalst2a
-{
-	npc	bird
-	npc	bird
-	npc	bird
-	npc	bird
-	npc	mongbat
-	npc	mongbat
-	npc	mongbat
-	npc	snake
-	npc	snake
-	npc	gorilla
-	npc	gorilla
-	npc	alligator
-	npc	alligator
-	npc	panther
-	npc	panther
-	npc	frenziedostard
-	npc	frenziedostard
-	npc	frenziedostard
-}
-
-group jungleanimals
-{
-	npc	bird
-	npc	bird
-	npc	bird
-	npc	snake
-	npc	snake
-	npc	mongbat
-	npc	mongbat
-	npc	gorilla
-	npc	gorilla
-	npc	alligator
-	npc	panther
-}
-
-group icybadstuff
-{
-	npc	frosttroll
-	npc	frostooze
-	npc	frostspider
-	npc	iceserpent
-	npc	iceelemental
-	npc	icesnake
-	npc	snowelemental
-}
-
-group humanoids
-{
-	npc	ogre
-	npc	ogre
-	npc	ettin
-	npc	ettin2
-}
-
-group humanmages
-{
-	npc	magelord
-	npc	evilmage
-}
-
-group horses
-{
-	npc	horse
-	npc	horse2
-	npc	horse3
-	npc	horse4
-}
-
-group hellhounds
-{
-	npc	hellhound
-}
-
-group healer
-{
-	npc	wanderinghealer
-}
-
-group harpy
-{
-	npc	airelemental
-}
-
-group greatdesert
-{
-	npc	earthelemental
-	npc	giantscorp
-	npc	giantscorp
-	npc	giantscorp
-	npc	giantspider
-	npc	giantspider
-	npc	giantspider
-	npc	gargoyle
-}
-
-group grat
-{
-	npc	grat
-}
-
-group giantspider
-{
-	npc	giantspider
-}
-
-group Giantserpent
-{
-	npc	giant_serpent
-}
-
-group Giantscorpion
-{
-	npc	giantscorp
-}
-
-group Giantrat
-{
-	npc	grat
-}
-
-group gazer
-{
-	npc	gazer
-}
-
-group forestanimalst2a
-{
-	npc	bird
-	npc	bird
-	npc	bird
-	npc	bird
-	npc	deer
-	npc	deer
-	npc	deer
-	npc	rabbit
-	npc	rabbit
-	npc	rat
-	npc	snake
-	npc	eagle
-	npc	eagle
-	npc	ghart
-	npc	ghart
-	npc	wolf
-	npc	wolf
-	npc	bear
-	npc	bear
-	npc	blackbear
-	npc	blackbear
-	npc	grizzly
-	npc	forestostard
-	npc	forestostard
-	npc	forestostard
-}
-
-group forestanimals
-{
-	npc	bird
-	npc	bird
-	npc	bird
-	npc	bird
-	npc	bird
-	npc	deer
-	npc	deer
-	npc	deer
-	npc	deer
-	npc	deer
-	npc	rabbit
-	npc	rabbit
-	npc	rabbit
-	npc	rat
-	npc	snake
-	npc	eagle
-	npc	eagle
-	npc	ghart
-	npc	ghart
-	npc	ghart
-	npc	wolf
-	npc	bear
-	npc	bear
-	npc	bear
-	npc	blackbear
-	npc	blackbear
-	npc	blackbear
-	npc	grizzly
-}
-
-group evilhuman
-{
-	npc	brigand1
-	npc	brigand1
-	npc	brigand1
-}
-
-group Earthelemental
-{
-	npc	earthelemental
-}
-
-group Drake
-{
-	npc	drake1
-	npc	drake2
-}
-
-group Dragon
-{
-	npc	dragon1
-	npc	dragon2
-}
-
-group domestic
-{
-	npc	chicken
-	npc	chicken
-	npc	cow
-	npc	cow
-	npc	cow
-	npc	cow
-	npc	sheep
-	npc	sheep
-	npc	sheep
-	npc	sheep
-	npc	sheep
-	npc	goat
-	npc	goat
-	npc	pig
-	npc	pig
-	npc	bull
-}
-
-group diablo
-{
-	npc	hellhound
-	npc	hellhound
-	npc	hellhound
-	npc	daemon
-}
-
-group desertt2a
-{
-	npc	giantscorp
-	npc	giantscorp
-	npc	giantscorp
-	npc	lavalizard
-	npc	lavalizard
-	npc	giant_serpent
-	npc	giant_serpent
-	npc	imp
-	npc	imp
-	npc	mummy
-	npc	stonegargoyle
-	npc	stonegargoyle
-	npc	gargoyle
-	npc	desertostard
-	npc	desertostard
-	npc	desertostard
-}
-
-group cove_orc_fort_outside
-{
-	npc	orc1
-	npc	orc2
-	npc	orc1
-	npc	orc2
-	npc	ettin
-	npc	ettin2
-}
-
-group balron
-{
-}
-
-group arcticmonsters
-{
-	npc	frostspider
-	npc	frostspider
-	npc	frostspider
-	npc	iceelemental
-	npc	iceelemental
-	npc	iceelemental
-	npc	frosttroll
-	npc	frosttroll
-}
-
-group arcticanimals
-{
-	npc	walrus
-	npc	walrus
-	npc	polar
-}
-
-group Airelemental
-{
-	npc	airelemental
-}

Deleted: trunk/096/config/spawnregions.cfg
===================================================================
--- trunk/096/config/spawnregions.cfg	2005-11-05 23:28:28 UTC (rev 913)
+++ trunk/096/config/spawnregions.cfg	2005-11-05 23:29:57 UTC (rev 914)
@@ -1,801 +0,0 @@
-
-region yew_west
-{
-	rect	256 932 494 1021
-	group	forestanimals 25 20
-}
-
-region yew_town_and_creature
-{
-	rect	522 956 579 1019
-	group	townies 3 10
-	group	towncreatures 15 5
-}
-
-region yew_south_west
-{
-	rect	494 1021 689 1215
-	group	forestanimals 50 10
-	group	healer 1 25
-}
-
-region yew_orc_fort
-{
-	rect	623 1478 645 1495
-	group	weakorcs 5 4
-	group	strongorcs 2 10
-}
-
-region yew_graveyard
-{
-	rect	712 1104 734 1134
-	group	weakundead 5 8
-}
-
-region yew_east
-{
-	rect	574 783 753 1066
-	group	forestanimals 30 10
-	group	healer 1 25
-}
-
-region wrong_lvl2_kitchen
-{
-	rect	5669 520 5703 543
-	group	ogrelord 2 10
-	group	trolls 3 6
-	group	lesserorcs 7 7
-}
-
-region w of trinsic, se of skara brae
-{
-	rect	976 2636 1364 2752
-	group	forestanimals 8
-	group	weakforestmonsters 2
-	group	strongforestmonsters 2
-	group	healer 1
-}
-
-region w of trinsic
-{
-	rect	1438 2568 1790 2836
-	group	forestanimals 6
-	group	weakforestmonsters 3
-	group	healer 1
-}
-
-region w of occlo
-{
-	rect	3396 2336 3602 2892
-	group	forestanimals 7
-	group	weakforestmonsters 2
-	group	healer 1
-}
-
-region w of minoc
-{
-	rect	1892 496 2269 769
-	group	forestanimals 7
-	group	weakforestmonsters 5
-	group	strongforestmonsters 1
-	group	healer 1
-}
-
-region w of magincia
-{
-	rect	3536 2086 3654 2180
-	group	jungleanimals 10
-	group	domestic 10
-	group	healer 1
-}
-
-region w of brit
-{
-	rect	594 1316 1050 1734
-	group	forestanimals 5
-	group	weakforestmonsters 2
-	group	strongforestmonsters 2
-	group	healer 1
-}
-
-region vesper_graveyard
-{
-	rect	2728 840 2782 894
-	group	weakundead 6 8
-}
-
-region vesper-minoc woods
-{
-	rect	2626 660 2792 824
-	group	forestanimals 10
-	group	domestic 10
-	group	healer 1
-}
-
-region vesper
-{
-	rect	2794 634 3026 1000
-	group	townies 10 5
-}
-
-region trinsic
-{
-	rect	1794 2638 2136 2902
-	group	townies 2 5
-	group	towncreatures 35 5
-}
-
-region terra sanctum
-{
-	rect	5955 2821 6132 3049
-	group	evilhuman 5 5
-	group	forestanimalst2a 5 5
-	group	stronghumanoids 3 5
-	group	randomother 8 5
-	group	healer 2 5
-}
-
-region T2A_tera_keep_south
-{
-	rect	5420 3145 5490 3165
-	group	terathans 10 10
-	group	terathans_greater 2 10
-}
-
-region T2A_tera_keep_outside
-{
-	rect	5405 3095 5425 3165
-	group	terathans 7 10
-	group	terathans_greater 1 10
-}
-
-region T2A_tera_keep_oph
-{
-	rect	5400 3045 5500 3100
-	group	ophidians 20 10
-	group	ophidians_greater 5 15
-}
-
-region T2A_keep_lower_outside
-{
-	rect	5296 1601 5367 1631
-	group	terathans 12 5
-	group	terathans_greater 6 6
-}
-
-region T2A_keep_lower_north
-{
-	rect	5326 1538 5363 1569
-	group	terathans 6 5
-}
-
-region T2A_keep_lower_enter
-{
-	rect	5296 1584 5368 1599
-	group	terathans 12 5
-	group	terathans_greater 3 7
-}
-
-region T2A_keep_balron
-{
-	rect	5337 1538 5352 1556
-	group	balron 2 10
-}
-
-region T2A_east_swamp
-{
-	rect	5900 3340 6090 3562
-	group	T2A_eastern_swamp 50 10
-}
-
-region t2a swamps
-{
-	rect	5314 3020 6142 3583
-	group	forestanimalst2a 1
-	group	jungleanimalst2a 2
-	group	ratmen 1
-	group	ratmen 2
-	group	randomother 1
-	group	healer 1
-}
-
-region t2a desert
-{
-	rect	5281 2478 5854 3001
-	group	desertt2a 2 5
-	group	diablo 1 5
-	group	stronghumanoids 2 5
-	group	healer 1 5
-}
-
-region swamp - w of trinsic
-{
-	rect	1099 2748 1270 3003
-	group	jungleanimals 12
-	group	junglemonsters 8
-	group	horses 2
-	group	healer 1
-}
-
-region sw of vesper
-{
-	rect	2630 828 2716 1112
-	group	forestanimals 12
-	group	domestic 12
-	group	healer 1
-}
-
-region sw of trinsic
-{
-	rect	2139 1330 2228 1415
-	group	jungleanimals 1
-	group	junglemonsters 2
-	group	randomother 2
-	group	horses 1
-	group	healer 1
-}
-
-region sw of minoc
-{
-	rect	2282 650 2468 802
-	group	forestanimals 10
-	group	weakforestmonsters 5
-	group	weakorcs 2
-	group	weaklizardmen 2
-	group	healer 1
-}
-
-region sw of brit
-{
-	rect	1200 1740 1432 1908
-	group	domestic 8
-	group	healer 1
-	group	forestanimals 8
-}
-
-region skara brae
-{
-	rect	538 2106 686 2274
-	group	townies 3 5
-	group	towncreatures 15 5
-}
-
-region Shame_lvl_2_uparea
-{
-	rect	5512 8 5578 119
-	group	Airelemental 20 20
-	group	Earthelemental 10 15
-	group	Giantscorpion 5 10
-	group	Giantrat 10 5
-}
-
-region Shame_lvl_2_downarea_lair
-{
-	rect	5583 7 5624 120
-	group	Earthelemental 8 15
-	group	Giantscorpion 6 10
-	group	Giantrat 10 5
-}
-
-region Shame_lvl_1
-{
-	rect	5379 2 5495 119
-	group	Earthelemental 20 20
-	group	Giantscorpion 15 10
-	group	Giantrat 15 5
-}
-
-region s of trinsic
-{
-	rect	1794 2890 2142 3124
-	group	domestic 7
-	group	healer 1
-}
-
-region s of brit
-{
-	rect	1230 1934 1584 2560
-	group	forestanimals 5
-	group	weakforestmonsters 3
-	group	strongforestmonsters 2
-	group	humanoids 2
-	group	healer 1
-}
-
-region ratman valley
-{
-	rect	938 1278 1090 1475
-	group	ratmen 36
-	group	ratfodder 87
-}
-
-region peninsula
-{
-	rect	1955 1444 2032 1553
-	group	plainswalkers 10 5
-	group	forestanimals 10 5
-	group	weakforestmonsters 1 20
-}
-
-region past hills n of delucia
-{
-	rect	5130 3090 5314 3835
-	group	forestanimalst2a 2
-	group	humanoids 2
-	group	strongforestmonsters 1
-	group	strongorcs 1
-	group	weakorcs 1
-	group	horses 2
-	group	healer 1
-}
-
-region past hills e of delucia
-{
-	rect	5384 3583 6142 4094
-	group	forestanimalst2a 1
-	group	humanoids 1
-	group	strongforestmonsters 1
-	group	weaklizardmen 1
-	group	horses 1
-	group	healer 1
-}
-
-region papua_town
-{
-	rect	5633 3106 5843 3326
-	group	townies 10 20
-	group	towncreatures 35 10
-}
-
-region papua
-{
-	rect	5655 3139 5805 3293
-	group	townies 4
-}
-
-region occlo
-{
-	rect	3592 2340 3798 2720
-	group	domestic 5
-}
-
-region nw iceland t2a
-{
-	rect	5134 2310 5574 2412
-	group	arcticanimals 6
-	group	arcticmonsters 10
-	group	icybadstuff 2
-}
-
-region nujelm
-{
-	rect	3496 1062 3808 1400
-	group	townies 1
-}
-
-region north moonglow
-{
-	rect	4236 790 4745 1254
-	group	domestic 3
-}
-
-region north mines
-{
-	rect	2412 85 2689 300
-	group	forestanimals 5
-	group	domestic 8
-	group	healer 1
-}
-
-region ne of brit
-{
-	rect	1600 1254 1876 1492
-	group	forestanimals 6
-	group	domestic 6
-	group	healer 1
-}
-
-region ne icelands t2a
-{
-	rect	5748 2314 6129 2462
-	group	arcticanimals 2
-	group	arcticmonsters 3
-	group	icybadstuff 2
-	group	healer 2
-}
-
-region n_yew_w_penninsula
-{
-	rect	826 345 855 421
-	group	strongforestmonsters 1 60
-	group	domestic 4 2
-}
-
-region n_yew_e_penninsula
-{
-	rect	938 290 1046 390
-	group	strongforestmonsters 1 60
-	group	forestanimals 7 5
-}
-
-region N trinsic swamp ruins
-{
-	rect	1808 2404 1837 2426
-	group	weakundead 10 5
-}
-
-region n of vesper
-{
-	rect	2654 360 2970 550
-	group	forestanimals 4
-	group	domestic 8
-	group	healer 1
-}
-
-region n of trinsic 2
-{
-	rect	1828 2246 2132 2402
-	group	jungleanimals 7
-	group	junglemonsters 3
-	group	weaklizardmen 3
-	group	healer 1
-}
-
-region n of trinsic 1
-{
-	rect	1576 2142 1874 2534
-	group	forestanimals 6
-	group	weakforestmonsters 3
-	group	strongforestmonsters 2
-	group	healer 1
-}
-
-region moonglow_zoo_swamp
-{
-	rect	4480 1376 4491 1398
-	group	zoo_swamp 4 2
-}
-
-region moonglow_zoo_jungle
-{
-	rect	4514 1354 4525 1362
-	group	jungleanimals 3 2
-}
-
-region moonglow_zoo_ice
-{
-	rect	4506 1390 4517 1398
-	group	zoo_ice 3 2
-}
-
-region moonglow_zoo_forest3
-{
-	rect	4493 1390 4504 1398
-	group	forestanimals 3 2
-}
-
-region moonglow_zoo_forest2
-{
-	rect	4487 1353 4499 1374
-	group	zoo_forest2 4 2
-}
-
-region moonglow_zoo_forest1
-{
-	rect	4501 1354 4512 1362
-	group	zoo_forest1 4 2
-}
-
-region moonglow_zoo_dungeon2
-{
-	rect	4525 1383 4535 1391
-	group	giantspider 1 1
-}
-
-region moonglow_zoo_dungeon1
-{
-	rect	4506 1369 4518 1384
-	group	gazer 1 1
-}
-
-region moonglow_zoo_desert1
-{
-	rect	4527 1354 4535 1373
-	group	zoo_desert 4 5
-}
-
-region moonglow_south_animals
-{
-	rect	4385 1181 4515 1336
-	group	domestic 25 2
-	group	plainswalkers 20 2
-}
-
-region moonglow_graveyard
-{
-	rect	4528 1297 4556 1334
-	group	undead 5 2
-	group	liche 1 120
-}
-
-region moonglow_east_animals
-{
-	rect	4276 1103 4368 1250
-	group	domestic 20 2
-	group	plainswalkers 20 2
-}
-
-region moonglow
-{
-	rect	4379 1045 4487 1178
-	group	townies 5
-}
-
-region minoc
-{
-	rect	2394 370 2624 632
-	group	townies 1
-}
-
-region magincia
-{
-	rect	3650 2016 3814 2273
-	group	domestic 7
-}
-
-region justice shrine area
-{
-	rect	1039 490 1654 700
-	group	forestanimals 4
-	group	ratmen 2
-	group	randomother 2
-	group	horses 2
-	group	healer 1
-}
-
-region jhelom
-{
-	rect	1294 3664 1506 3886
-	group	townies 2
-}
-
-region ice island
-{
-	rect	3862 174 4310 754
-	group	arcticanimals 30
-}
-
-region hills n of delucia
-{
-	rect	5140 3836 5314 3925
-	group	domestic 20
-	group	newbieforest 20
-	group	healer 1
-}
-
-region hills e of delucia
-{
-	rect	5314 3836 5383 4070
-	group	domestic 20
-	group	newbieforest 20
-	group	healer 1
-}
-
-region great desert
-{
-	rect	1834 832 1976 944
-	group	greatdesert             20  10
-}
-
-region far s of trinsic
-{
-	rect	1792 3124 2223 3514
-	group	evilhuman 1
-	group	forestanimals 2
-	group	strongorcs 1
-	group	weakforestmonsters 2
-	group	horses 1
-}
-
-region e skara brae
-{
-	rect	722 2062 1032 2434
-	group	domestic 5
-	group	newbieforest 5
-	group	healer 1
-}
-
-region Destard_lvl_2
-{
-	rect	5130 799 5177 872
-	group	Drake 8 10
-	group	Dragon 2 15
-	group	Giantserpent 2 10
-	group	Giantrat 3 5
-	group	Slime 5 5
-}
-
-region Destard_lvl_1_Waterarea
-{
-	rect	5318 919 5363 984
-	group	Waterelemental 1 5
-	group	Drake 3 10
-	group	Slime 4 4
-}
-
-region Destard_lvl_1_u_Shrine
-{
-	rect	5211 773 5324 857
-	group	Drake 5 7
-	group	Dragon 1 15
-	group	Giantserpent 4 10
-	group	Giantrat 7 5
-	group	Slime 10 5
-}
-
-region Destard_lvl_1_tolvl2
-{
-	rect	5148 899 5177 964
-	group	Drake 4 15
-	group	Giantserpent 2 12
-	group	Giantrat 3 5
-	group	Slime 3 4
-}
-
-region Destard_lvl_1_Shrine
-{
-	rect	5193 776 5222 799
-	group	Waterelemental 2 7
-	group	Slime 3 4
-}
-
-region Destard_lvl_1_entrancearea
-{
-	rect	5188 892 5289 986
-	group	Drake 10 10
-	group	Dragon 3 15
-	group	Giantserpent 7 9
-	group	Giantrat 10 5
-	group	Slime 15 5
-}
-
-region delucia
-{
-	rect	5140 3946 5307 4053
-	group	townies 5
-}
-
-region covetous_liche
-{
-	rect	5568 1852 5590 1866
-	group	liche 1 2
-	group	grat 2 5
-}
-
-region covetous_dragon_lake
-{
-	rect	5448 1795 5478 1824
-	group	Dragon 2 2
-	group	Drake 2 4
-}
-
-region cove_orc_fort_south
-{
-	rect	2152 1368 2206 1382
-	group	weakorcs 3 5
-	group	strongorcs 1 10
-}
-
-region cove_orc_fort_outside
-{
-	rect	2159 1280 2192 1335
-	group	cove_orc_fort_outside 5 10
-}
-
-region cove_orc_fort_north
-{
-	rect	2152 1344 2190 1367
-	group	weakorcs 5 5
-	group	strongorcs 2 10
-}
-
-region cove_orc_fort_docks
-{
-	rect	2176 1384 2191 1425
-	group	weakorcs 3 5
-}
-
-region cove
-{
-	rect	2206 1116 2290 1236
-	group	townies 10
-}
-
-region Britain_Graveyard
-{
-	rect	1337 1444 1389 1509
-	group	lesserundead 15 3
-}
-
-region britain ne woods bg
-{
-	rect	1826 1019 2007 1445
-	group	plainswalkers         50  10
-	group	healer                2   30
-}
-
-region brit_w_town_creatures
-{
-	rect	1411 1539 1489 1744
-	group	townies 5 10
-	group	towncreatures 30 5
-}
-
-region brit_e_town_creatures
-{
-	rect	1571 1529 1646 1774
-	group	townies 5 10
-	group	towncreatures 35 5
-}
-
-region brit/minoc swamp
-{
-	rect	2010 913 2055 1110
-	group	jungleanimals 25
-	group	junglemonsters 15
-	group	weaklizardmen 10
-}
-
-region brit nw forest (c)
-{
-	rect	1186 1330 1322 1532
-	group	newbieforest 28
-	group	newbie 25
-}
-
-region brit nw forest (a)
-{
-	rect	1186 1330 1322 1532
-	group	domestic 28
-	group	healer 1
-}
-
-region brit near n (c)
-{
-	rect	1330 1258 1590 1340
-	group	newbieforest 10
-	group	newbie 8
-}
-
-region brit near n (a)
-{
-	rect	1330 1258 1590 1340
-	group	domestic 10
-}
-
-region brit n (c)
-{
-	rect	1330 1258 1590 1340
-	group	newbieforest 20
-	group	newbie 18
-}
-
-region brit n (a)
-{
-	rect	1330 1258 1590 1340
-	group	domestic 15
-	group	healer 1
-}
-
-region brit farmlands
-{
-	rect	1150 1550 1282 1730
-	group	domestic 30
-	group	healer 1
-}
-
-region briggand fort
-{
-	rect	836 1672 870 1702
-	group	evilhuman 5
-}

Added: trunk/096/pkg/systems/spawnSystem/config/OLD/spawngroups.cfg
===================================================================
--- trunk/096/pkg/systems/spawnSystem/config/OLD/spawngroups.cfg	2005-11-05 23:28:28 UTC (rev 913)
+++ trunk/096/pkg/systems/spawnSystem/config/OLD/spawngroups.cfg	2005-11-05 23:29:57 UTC (rev 914)
@@ -0,0 +1,657 @@
+
+group zoo_swamp
+{
+	npc	grat
+	npc	giant_serpent
+	npc	alligator
+	npc	lizardman1
+}
+
+group zoo_ice
+{
+	npc	walrus
+	npc	polar
+	npc	frosttroll
+}
+
+group zoo_forest2
+{
+	npc	ogre
+	npc	bear
+	npc	ettin
+	npc	reaper
+}
+
+group zoo_forest1
+{
+	npc	mongbat
+	npc	harpy
+	npc	headless
+}
+
+group zoo_desert
+{
+	npc	giant_serpent
+	npc	giantscorp
+	npc	snake
+	npc	giantscorp
+}
+
+group Zombie
+{
+	npc	zombie
+}
+
+group weakundead
+{
+	npc	skeleton
+	npc	zombie
+	npc	skeleton
+	npc	zombie
+	npc	skeleton
+}
+
+group weakorcs
+{
+	npc	orc1
+	npc	orc2
+}
+
+group weaklizardmen
+{
+	npc	lizardman1
+	npc	lizardman1
+	npc	lizardman1
+	npc	lizardman2
+	npc	lizardman2
+	npc	lizardman2
+	npc	lizardman3
+	npc	lizardman3
+	npc	lizardman3
+}
+
+group weakforestmonsters
+{
+	npc	mongbat
+	npc	mongbat
+	npc	mongbat
+	npc	giantspider
+	npc	giantspider
+	npc	harpy
+	npc	harpy
+	npc	headless
+	npc	headless
+	npc	corpser
+}
+
+group Waterelemental
+{
+	npc	waterelemental
+}
+
+group undead
+{
+	npc	zombie
+	npc	zombie
+	npc	zombie
+	npc	skeleton
+	npc	skeleton
+	npc	skeleton
+	npc	shade
+	npc	shade
+}
+
+group trolls
+{
+	npc	troll1
+	npc	troll2
+	npc	troll3
+}
+
+group townies
+{
+	npc	employee
+}
+
+group towncreatures
+{
+	npc	bird
+	npc	dog
+	npc	cat
+	npc	bird
+	npc	bird
+	npc	dog
+}
+
+group terathans_greater
+{
+	npc	terathanmatriarch
+	npc	terathanavenger
+	npc	terathanavenger
+}
+
+group terathans
+{
+	npc	terathandrone
+	npc	terathanwarrior
+}
+
+group t2adesert
+{
+	npc	desertostard
+	npc	desertostard
+	npc	desertostard
+	npc	giantscorp
+	npc	giantscorp
+	npc	giantscorp
+	npc	giantspider
+	npc	giantspider
+	npc	giantspider
+	npc	imp
+	npc	imp
+	npc	stonegargoyle
+	npc	stonegargoyle
+	npc	stonegargoyle
+	npc	giant_serpent
+	npc	giant_serpent
+}
+
+group T2A_eastern_swamp
+{
+	npc	bullfrog
+	npc	gianttoad
+	npc	waterelemental
+	npc	corpser
+	npc	alligator
+	npc	bullfrog
+	npc	gianttoad
+}
+
+group strongorcs
+{
+	npc	orclord
+	npc	orclord
+	npc	orcmage
+}
+
+group stronghumanoids
+{
+	npc	cyclopse
+	npc	cyclopse
+	npc	cyclopse
+	npc	titan
+	npc	ogrelord
+}
+
+group strongforestmonsters
+{
+	npc	harpy
+	npc	harpy
+	npc	corpser
+	npc	corpser
+	npc	direwolf
+	npc	gargoyle
+	npc	gazer
+	npc	reaper
+}
+
+group Slime
+{
+	npc	slime
+}
+
+group Skeleton
+{
+	npc	skeleton
+}
+
+group Shade
+{
+	npc	shade
+}
+
+group ratmen
+{
+	npc	ratman1
+	npc	ratman2
+	npc	ratman3
+}
+
+group ratfodder
+{
+	npc	sheep
+	npc	goat
+}
+
+group randomother
+{
+	npc	airelemental
+	npc	airelemental
+	npc	waterelemental
+	npc	waterelemental
+	npc	gargoyle
+	npc	ettin
+	npc	ettin2
+}
+
+group plainswalkers
+{
+	npc	chicken
+	npc	chicken
+	npc	cow
+	npc	cow
+	npc	sheep
+	npc	sheep
+	npc	goat
+	npc	goat
+	npc	bull
+	npc	deer
+	npc	deer
+	npc	ghart
+}
+
+group ophidians_greater
+{
+	npc	ophidianmatriarch
+	npc	ophidianavenger
+	npc	ophidianknighterrant
+	npc	ophidianshaman
+	npc	ophidianshaman
+}
+
+group ophidians
+{
+	npc	ophidianenforcer
+	npc	ophidianwarrior
+	npc	ophidianwarrior
+	npc	ophidianenforcer
+	npc	ophidianmage
+}
+
+group ogrelord
+{
+	npc	ogrelord
+}
+
+group newbieforest
+{
+	npc	chicken
+	npc	cow
+	npc	goat
+	npc	pig
+	npc	bull
+	npc	bird
+	npc	bird
+	npc	bird
+	npc	bird
+	npc	llama
+	npc	deer
+	npc	deer
+	npc	rabbit
+	npc	rat
+	npc	snake
+	npc	eagle
+	npc	ghart
+	npc	bear
+	npc	blackbear
+}
+
+group newbie
+{
+	npc	mongbat
+	npc	mongbat
+	npc	snake
+	npc	headless
+	npc	headless
+	npc	lizardman1
+	npc	lizardman2
+	npc	lizardman3
+	npc	orc1
+	npc	orc2
+	npc	ratman1
+	npc	ratman2
+	npc	ratman3
+}
+
+group llord
+{
+	npc	lichelord
+}
+
+group liche
+{
+	npc	liche
+}
+
+group lesserundead
+{
+	npc	zombie
+	npc	zombie
+	npc	zombie
+	npc	skeleton
+	npc	skeleton
+	npc	skeleton
+	npc	shade
+}
+
+group lesserorcs
+{
+	npc	orc1
+	npc	orc2
+}
+
+group junglemonsters
+{
+	npc	grat
+	npc	grat
+	npc	grat
+	npc	mongbat
+	npc	mongbat
+	npc	mongbat
+	npc	headless
+	npc	headless
+	npc	giantspider
+	npc	giantspider
+	npc	corpser
+	npc	gazer
+	npc	harpy
+	npc	giant_serpent
+}
+
+group jungleanimalst2a
+{
+	npc	bird
+	npc	bird
+	npc	bird
+	npc	bird
+	npc	mongbat
+	npc	mongbat
+	npc	mongbat
+	npc	snake
+	npc	snake
+	npc	gorilla
+	npc	gorilla
+	npc	alligator
+	npc	alligator
+	npc	panther
+	npc	panther
+	npc	frenziedostard
+	npc	frenziedostard
+	npc	frenziedostard
+}
+
+group jungleanimals
+{
+	npc	bird
+	npc	bird
+	npc	bird
+	npc	snake
+	npc	snake
+	npc	mongbat
+	npc	mongbat
+	npc	gorilla
+	npc	gorilla
+	npc	alligator
+	npc	panther
+}
+
+group icybadstuff
+{
+	npc	frosttroll
+	npc	frostooze
+	npc	frostspider
+	npc	iceserpent
+	npc	iceelemental
+	npc	icesnake
+	npc	snowelemental
+}
+
+group humanoids
+{
+	npc	ogre
+	npc	ogre
+	npc	ettin
+	npc	ettin2
+}
+
+group humanmages
+{
+	npc	magelord
+	npc	evilmage
+}
+
+group horses
+{
+	npc	horse
+	npc	horse2
+	npc	horse3
+	npc	horse4
+}
+
+group hellhounds
+{
+	npc	hellhound
+}
+
+group healer
+{
+	npc	wanderinghealer
+}
+
+group harpy
+{
+	npc	airelemental
+}
+
+group greatdesert
+{
+	npc	earthelemental
+	npc	giantscorp
+	npc	giantscorp
+	npc	giantscorp
+	npc	giantspider
+	npc	giantspider
+	npc	giantspider
+	npc	gargoyle
+}
+
+group grat
+{
+	npc	grat
+}
+
+group giantspider
+{
+	npc	giantspider
+}
+
+group Giantserpent
+{
+	npc	giant_serpent
+}
+
+group Giantscorpion
+{
+	npc	giantscorp
+}
+
+group Giantrat
+{
+	npc	grat
+}
+
+group gazer
+{
+	npc	gazer
+}
+
+group forestanimalst2a
+{
+	npc	bird
+	npc	bird
+	npc	bird
+	npc	bird
+	npc	deer
+	npc	deer
+	npc	deer
+	npc	rabbit
+	npc	rabbit
+	npc	rat
+	npc	snake
+	npc	eagle
+	npc	eagle
+	npc	ghart
+	npc	ghart
+	npc	wolf
+	npc	wolf
+	npc	bear
+	npc	bear
+	npc	blackbear
+	npc	blackbear
+	npc	grizzly
+	npc	forestostard
+	npc	forestostard
+	npc	forestostard
+}
+
+group forestanimals
+{
+	npc	bird
+	npc	bird
+	npc	bird
+	npc	bird
+	npc	bird
+	npc	deer
+	npc	deer
+	npc	deer
+	npc	deer
+	npc	deer
+	npc	rabbit
+	npc	rabbit
+	npc	rabbit
+	npc	rat
+	npc	snake
+	npc	eagle
+	npc	eagle
+	npc	ghart
+	npc	ghart
+	npc	ghart
+	npc	wolf
+	npc	bear
+	npc	bear
+	npc	bear
+	npc	blackbear
+	npc	blackbear
+	npc	blackbear
+	npc	grizzly
+}
+
+group evilhuman
+{
+	npc	brigand1
+	npc	brigand1
+	npc	brigand1
+}
+
+group Earthelemental
+{
+	npc	earthelemental
+}
+
+group Drake
+{
+	npc	drake1
+	npc	drake2
+}
+
+group Dragon
+{
+	npc	dragon1
+	npc	dragon2
+}
+
+group domestic
+{
+	npc	chicken
+	npc	chicken
+	npc	cow
+	npc	cow
+	npc	cow
+	npc	cow
+	npc	sheep
+	npc	sheep
+	npc	sheep
+	npc	sheep
+	npc	sheep
+	npc	goat
+	npc	goat
+	npc	pig
+	npc	pig
+	npc	bull
+}
+
+group diablo
+{
+	npc	hellhound
+	npc	hellhound
+	npc	hellhound
+	npc	daemon
+}
+
+group desertt2a
+{
+	npc	giantscorp
+	npc	giantscorp
+	npc	giantscorp
+	npc	lavalizard
+	npc	lavalizard
+	npc	giant_serpent
+	npc	giant_serpent
+	npc	imp
+	npc	imp
+	npc	mummy
+	npc	stonegargoyle
+	npc	stonegargoyle
+	npc	gargoyle
+	npc	desertostard
+	npc	desertostard
+	npc	desertostard
+}
+
+group cove_orc_fort_outside
+{
+	npc	orc1
+	npc	orc2
+	npc	orc1
+	npc	orc2
+	npc	ettin
+	npc	ettin2
+}
+
+group balron
+{
+}
+
+group arcticmonsters
+{
+	npc	frostspider
+	npc	frostspider
+	npc	frostspider
+	npc	iceelemental
+	npc	iceelemental
+	npc	iceelemental
+	npc	frosttroll
+	npc	frosttroll
+}
+
+group arcticanimals
+{
+	npc	walrus
+	npc	walrus
+	npc	polar
+}
+
+group Airelemental
+{
+	npc	airelemental
+}

Added: trunk/096/pkg/systems/spawnSystem/config/OLD/spawnregions.cfg
===================================================================
--- trunk/096/pkg/systems/spawnSystem/config/OLD/spawnregions.cfg	2005-11-05 23:28:28 UTC (rev 913)
+++ trunk/096/pkg/systems/spawnSystem/config/OLD/spawnregions.cfg	2005-11-05 23:29:57 UTC (rev 914)
@@ -0,0 +1,801 @@
+
+region yew_west
+{
+	rect	256 932 494 1021
+	group	forestanimals 25 20
+}
+
+region yew_town_and_creature
+{
+	rect	522 956 579 1019
+	group	townies 3 10
+	group	towncreatures 15 5
+}
+
+region yew_south_west
+{
+	rect	494 1021 689 1215
+	group	forestanimals 50 10
+	group	healer 1 25
+}
+
+region yew_orc_fort
+{
+	rect	623 1478 645 1495
+	group	weakorcs 5 4
+	group	strongorcs 2 10
+}
+
+region yew_graveyard
+{
+	rect	712 1104 734 1134
+	group	weakundead 5 8
+}
+
+region yew_east
+{
+	rect	574 783 753 1066
+	group	forestanimals 30 10
+	group	healer 1 25
+}
+
+region wrong_lvl2_kitchen
+{
+	rect	5669 520 5703 543
+	group	ogrelord 2 10
+	group	trolls 3 6
+	group	lesserorcs 7 7
+}
+
+region w of trinsic, se of skara brae
+{
+	rect	976 2636 1364 2752
+	group	forestanimals 8
+	group	weakforestmonsters 2
+	group	strongforestmonsters 2
+	group	healer 1
+}
+
+region w of trinsic
+{
+	rect	1438 2568 1790 2836
+	group	forestanimals 6
+	group	weakforestmonsters 3
+	group	healer 1
+}
+
+region w of occlo
+{
+	rect	3396 2336 3602 2892
+	group	forestanimals 7
+	group	weakforestmonsters 2
+	group	healer 1
+}
+
+region w of minoc
+{
+	rect	1892 496 2269 769
+	group	forestanimals 7
+	group	weakforestmonsters 5
+	group	strongforestmonsters 1
+	group	healer 1
+}
+
+region w of magincia
+{
+	rect	3536 2086 3654 2180
+	group	jungleanimals 10
+	group	domestic 10
+	group	healer 1
+}
+
+region w of brit
+{
+	rect	594 1316 1050 1734
+	group	forestanimals 5
+	group	weakforestmonsters 2
+	group	strongforestmonsters 2
+	group	healer 1
+}
+
+region vesper_graveyard
+{
+	rect	2728 840 2782 894
+	group	weakundead 6 8
+}
+
+region vesper-minoc woods
+{
+	rect	2626 660 2792 824
+	group	forestanimals 10
+	group	domestic 10
+	group	healer 1
+}
+
+region vesper
+{
+	rect	2794 634 3026 1000
+	group	townies 10 5
+}
+
+region trinsic
+{
+	rect	1794 2638 2136 2902
+	group	townies 2 5
+	group	towncreatures 35 5
+}
+
+region terra sanctum
+{
+	rect	5955 2821 6132 3049
+	group	evilhuman 5 5
+	group	forestanimalst2a 5 5
+	group	stronghumanoids 3 5
+	group	randomother 8 5
+	group	healer 2 5
+}
+
+region T2A_tera_keep_south
+{
+	rect	5420 3145 5490 3165
+	group	terathans 10 10
+	group	terathans_greater 2 10
+}
+
+region T2A_tera_keep_outside
+{
+	rect	5405 3095 5425 3165
+	group	terathans 7 10
+	group	terathans_greater 1 10
+}
+
+region T2A_tera_keep_oph
+{
+	rect	5400 3045 5500 3100
+	group	ophidians 20 10
+	group	ophidians_greater 5 15
+}
+
+region T2A_keep_lower_outside
+{
+	rect	5296 1601 5367 1631
+	group	terathans 12 5
+	group	terathans_greater 6 6
+}
+
+region T2A_keep_lower_north
+{
+	rect	5326 1538 5363 1569
+	group	terathans 6 5
+}
+
+region T2A_keep_lower_enter
+{
+	rect	5296 1584 5368 1599
+	group	terathans 12 5
+	group	terathans_greater 3 7
+}
+
+region T2A_keep_balron
+{
+	rect	5337 1538 5352 1556
+	group	balron 2 10
+}
+
+region T2A_east_swamp
+{
+	rect	5900 3340 6090 3562
+	group	T2A_eastern_swamp 50 10
+}
+
+region t2a swamps
+{
+	rect	5314 3020 6142 3583
+	group	forestanimalst2a 1
+	group	jungleanimalst2a 2
+	group	ratmen 1
+	group	ratmen 2
+	group	randomother 1
+	group	healer 1
+}
+
+region t2a desert
+{
+	rect	5281 2478 5854 3001
+	group	desertt2a 2 5
+	group	diablo 1 5
+	group	stronghumanoids 2 5
+	group	healer 1 5
+}
+
+region swamp - w of trinsic
+{
+	rect	1099 2748 1270 3003
+	group	jungleanimals 12
+	group	junglemonsters 8
+	group	horses 2
+	group	healer 1
+}
+
+region sw of vesper
+{
+	rect	2630 828 2716 1112
+	group	forestanimals 12
+	group	domestic 12
+	group	healer 1
+}
+
+region sw of trinsic
+{
+	rect	2139 1330 2228 1415
+	group	jungleanimals 1
+	group	junglemonsters 2
+	group	randomother 2
+	group	horses 1
+	group	healer 1
+}
+
+region sw of minoc
+{
+	rect	2282 650 2468 802
+	group	forestanimals 10
+	group	weakforestmonsters 5
+	group	weakorcs 2
+	group	weaklizardmen 2
+	group	healer 1
+}
+
+region sw of brit
+{
+	rect	1200 1740 1432 1908
+	group	domestic 8
+	group	healer 1
+	group	forestanimals 8
+}
+
+region skara brae
+{
+	rect	538 2106 686 2274
+	group	townies 3 5
+	group	towncreatures 15 5
+}
+
+region Shame_lvl_2_uparea
+{
+	rect	5512 8 5578 119
+	group	Airelemental 20 20
+	group	Earthelemental 10 15
+	group	Giantscorpion 5 10
+	group	Giantrat 10 5
+}
+
+region Shame_lvl_2_downarea_lair
+{
+	rect	5583 7 5624 120
+	group	Earthelemental 8 15
+	group	Giantscorpion 6 10
+	group	Giantrat 10 5
+}
+
+region Shame_lvl_1
+{
+	rect	5379 2 5495 119
+	group	Earthelemental 20 20
+	group	Giantscorpion 15 10
+	group	Giantrat 15 5
+}
+
+region s of trinsic
+{
+	rect	1794 2890 2142 3124
+	group	domestic 7
+	group	healer 1
+}
+
+region s of brit
+{
+	rect	1230 1934 1584 2560
+	group	forestanimals 5
+	group	weakforestmonsters 3
+	group	strongforestmonsters 2
+	group	humanoids 2
+	group	healer 1
+}
+
+region ratman valley
+{
+	rect	938 1278 1090 1475
+	group	ratmen 36
+	group	ratfodder 87
+}
+
+region peninsula
+{
+	rect	1955 1444 2032 1553
+	group	plainswalkers 10 5
+	group	forestanimals 10 5
+	group	weakforestmonsters 1 20
+}
+
+region past hills n of delucia
+{
+	rect	5130 3090 5314 3835
+	group	forestanimalst2a 2
+	group	humanoids 2
+	group	strongforestmonsters 1
+	group	strongorcs 1
+	group	weakorcs 1
+	group	horses 2
+	group	healer 1
+}
+
+region past hills e of delucia
+{
+	rect	5384 3583 6142 4094
+	group	forestanimalst2a 1
+	group	humanoids 1
+	group	strongforestmonsters 1
+	group	weaklizardmen 1
+	group	horses 1
+	group	healer 1
+}
+
+region papua_town
+{
+	rect	5633 3106 5843 3326
+	group	townies 10 20
+	group	towncreatures 35 10
+}
+
+region papua
+{
+	rect	5655 3139 5805 3293
+	group	townies 4
+}
+
+region occlo
+{
+	rect	3592 2340 3798 2720
+	group	domestic 5
+}
+
+region nw iceland t2a
+{
+	rect	5134 2310 5574 2412
+	group	arcticanimals 6
+	group	arcticmonsters 10
+	group	icybadstuff 2
+}
+
+region nujelm
+{
+	rect	3496 1062 3808 1400
+	group	townies 1
+}
+
+region north moonglow
+{
+	rect	4236 790 4745 1254
+	group	domestic 3
+}
+
+region north mines
+{
+	rect	2412 85 2689 300
+	group	forestanimals 5
+	group	domestic 8
+	group	healer 1
+}
+
+region ne of brit
+{
+	rect	1600 1254 1876 1492
+	group	forestanimals 6
+	group	domestic 6
+	group	healer 1
+}
+
+region ne icelands t2a
+{
+	rect	5748 2314 6129 2462
+	group	arcticanimals 2
+	group	arcticmonsters 3
+	group	icybadstuff 2
+	group	healer 2
+}
+
+region n_yew_w_penninsula
+{
+	rect	826 345 855 421
+	group	strongforestmonsters 1 60
+	group	domestic 4 2
+}
+
+region n_yew_e_penninsula
+{
+	rect	938 290 1046 390
+	group	strongforestmonsters 1 60
+	group	forestanimals 7 5
+}
+
+region N trinsic swamp ruins
+{
+	rect	1808 2404 1837 2426
+	group	weakundead 10 5
+}
+
+region n of vesper
+{
+	rect	2654 360 2970 550
+	group	forestanimals 4
+	group	domestic 8
+	group	healer 1
+}
+
+region n of trinsic 2
+{
+	rect	1828 2246 2132 2402
+	group	jungleanimals 7
+	group	junglemonsters 3
+	group	weaklizardmen 3
+	group	healer 1
+}
+
+region n of trinsic 1
+{
+	rect	1576 2142 1874 2534
+	group	forestanimals 6
+	group	weakforestmonsters 3
+	group	strongforestmonsters 2
+	group	healer 1
+}
+
+region moonglow_zoo_swamp
+{
+	rect	4480 1376 4491 1398
+	group	zoo_swamp 4 2
+}
+
+region moonglow_zoo_jungle
+{
+	rect	4514 1354 4525 1362
+	group	jungleanimals 3 2
+}
+
+region moonglow_zoo_ice
+{
+	rect	4506 1390 4517 1398
+	group	zoo_ice 3 2
+}
+
+region moonglow_zoo_forest3
+{
+	rect	4493 1390 4504 1398
+	group	forestanimals 3 2
+}
+
+region moonglow_zoo_forest2
+{
+	rect	4487 1353 4499 1374
+	group	zoo_forest2 4 2
+}
+
+region moonglow_zoo_forest1
+{
+	rect	4501 1354 4512 1362
+	group	zoo_forest1 4 2
+}
+
+region moonglow_zoo_dungeon2
+{
+	rect	4525 1383 4535 1391
+	group	giantspider 1 1
+}
+
+region moonglow_zoo_dungeon1
+{
+	rect	4506 1369 4518 1384
+	group	gazer 1 1
+}
+
+region moonglow_zoo_desert1
+{
+	rect	4527 1354 4535 1373
+	group	zoo_desert 4 5
+}
+
+region moonglow_south_animals
+{
+	rect	4385 1181 4515 1336
+	group	domestic 25 2
+	group	plainswalkers 20 2
+}
+
+region moonglow_graveyard
+{
+	rect	4528 1297 4556 1334
+	group	undead 5 2
+	group	liche 1 120
+}
+
+region moonglow_east_animals
+{
+	rect	4276 1103 4368 1250
+	group	domestic 20 2
+	group	plainswalkers 20 2
+}
+
+region moonglow
+{
+	rect	4379 1045 4487 1178
+	group	townies 5
+}
+
+region minoc
+{
+	rect	2394 370 2624 632
+	group	townies 1
+}
+
+region magincia
+{
+	rect	3650 2016 3814 2273
+	group	domestic 7
+}
+
+region justice shrine area
+{
+	rect	1039 490 1654 700
+	group	forestanimals 4
+	group	ratmen 2
+	group	randomother 2
+	group	horses 2
+	group	healer 1
+}
+
+region jhelom
+{
+	rect	1294 3664 1506 3886
+	group	townies 2
+}
+
+region ice island
+{
+	rect	3862 174 4310 754
+	group	arcticanimals 30
+}
+
+region hills n of delucia
+{
+	rect	5140 3836 5314 3925
+	group	domestic 20
+	group	newbieforest 20
+	group	healer 1
+}
+
+region hills e of delucia
+{
+	rect	5314 3836 5383 4070
+	group	domestic 20
+	group	newbieforest 20
+	group	healer 1
+}
+
+region great desert
+{
+	rect	1834 832 1976 944
+	group	greatdesert             20  10
+}
+
+region far s of trinsic
+{
+	rect	1792 3124 2223 3514
+	group	evilhuman 1
+	group	forestanimals 2
+	group	strongorcs 1
+	group	weakforestmonsters 2
+	group	horses 1
+}
+
+region e skara brae
+{
+	rect	722 2062 1032 2434
+	group	domestic 5
+	group	newbieforest 5
+	group	healer 1
+}
+
+region Destard_lvl_2
+{
+	rect	5130 799 5177 872
+	group	Drake 8 10
+	group	Dragon 2 15
+	group	Giantserpent 2 10
+	group	Giantrat 3 5
+	group	Slime 5 5
+}
+
+region Destard_lvl_1_Waterarea
+{
+	rect	5318 919 5363 984
+	group	Waterelemental 1 5
+	group	Drake 3 10
+	group	Slime 4 4
+}
+
+region Destard_lvl_1_u_Shrine
+{
+	rect	5211 773 5324 857
+	group	Drake 5 7
+	group	Dragon 1 15
+	group	Giantserpent 4 10
+	group	Giantrat 7 5
+	group	Slime 10 5
+}
+
+region Destard_lvl_1_tolvl2
+{
+	rect	5148 899 5177 964
+	group	Drake 4 15
+	group	Giantserpent 2 12
+	group	Giantrat 3 5
+	group	Slime 3 4
+}
+
+region Destard_lvl_1_Shrine
+{
+	rect	5193 776 5222 799
+	group	Waterelemental 2 7
+	group	Slime 3 4
+}
+
+region Destard_lvl_1_entrancearea
+{
+	rect	5188 892 5289 986
+	group	Drake 10 10
+	group	Dragon 3 15
+	group	Giantserpent 7 9
+	group	Giantrat 10 5
+	group	Slime 15 5
+}
+
+region delucia
+{
+	rect	5140 3946 5307 4053
+	group	townies 5
+}
+
+region covetous_liche
+{
+	rect	5568 1852 5590 1866
+	group	liche 1 2
+	group	grat 2 5
+}
+
+region covetous_dragon_lake
+{
+	rect	5448 1795 5478 1824
+	group	Dragon 2 2
+	group	Drake 2 4
+}
+
+region cove_orc_fort_south
+{
+	rect	2152 1368 2206 1382
+	group	weakorcs 3 5
+	group	strongorcs 1 10
+}
+
+region cove_orc_fort_outside
+{
+	rect	2159 1280 2192 1335
+	group	cove_orc_fort_outside 5 10
+}
+
+region cove_orc_fort_north
+{
+	rect	2152 1344 2190 1367
+	group	weakorcs 5 5
+	group	strongorcs 2 10
+}
+
+region cove_orc_fort_docks
+{
+	rect	2176 1384 2191 1425
+	group	weakorcs 3 5
+}
+
+region cove
+{
+	rect	2206 1116 2290 1236
+	group	townies 10
+}
+
+region Britain_Graveyard
+{
+	rect	1337 1444 1389 1509
+	group	lesserundead 15 3
+}
+
+region britain ne woods bg
+{
+	rect	1826 1019 2007 1445
+	group	plainswalkers         50  10
+	group	healer                2   30
+}
+
+region brit_w_town_creatures
+{
+	rect	1411 1539 1489 1744
+	group	townies 5 10
+	group	towncreatures 30 5
+}
+
+region brit_e_town_creatures
+{
+	rect	1571 1529 1646 1774
+	group	townies 5 10
+	group	towncreatures 35 5
+}
+
+region brit/minoc swamp
+{
+	rect	2010 913 2055 1110
+	group	jungleanimals 25
+	group	junglemonsters 15
+	group	weaklizardmen 10
+}
+
+region brit nw forest (c)
+{
+	rect	1186 1330 1322 1532
+	group	newbieforest 28
+	group	newbie 25
+}
+
+region brit nw forest (a)
+{
+	rect	1186 1330 1322 1532
+	group	domestic 28
+	group	healer 1
+}
+
+region brit near n (c)
+{
+	rect	1330 1258 1590 1340
+	group	newbieforest 10
+	group	newbie 8
+}
+
+region brit near n (a)
+{
+	rect	1330 1258 1590 1340
+	group	domestic 10
+}
+
+region brit n (c)
+{
+	rect	1330 1258 1590 1340
+	group	newbieforest 20
+	group	newbie 18
+}
+
+region brit n (a)
+{
+	rect	1330 1258 1590 1340
+	group	domestic 15
+	group	healer 1
+}
+
+region brit farmlands
+{
+	rect	1150 1550 1282 1730
+	group	domestic 30
+	group	healer 1
+}
+
+region briggand fort
+{
+	rect	836 1672 870 1702
+	group	evilhuman 5
+}



From austin at berlios.de  Sun Nov  6 00:39:10 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 00:39:10 +0100
Subject: [Poldistro-svn] r915 - in trunk/096: pkg/items/wands pkg/mobiles/npcutils pkg/mobiles/oldAI pkg/skills/alchemy pkg/skills/fishing pkg/skills/healing pkg/systems/housing pkg/systems/merchantnodes pkg/systems/merchantnodes/commands/admin pkg/systems/merchantnodes/commands/gm scripts scripts/include/OLD
Message-ID: <200511052339.jA5NdAFq026915@sheep.berlios.de>

Author: austin
Date: 2005-11-06 00:39:07 +0100 (Sun, 06 Nov 2005)
New Revision: 915

Modified:
   trunk/096/pkg/items/wands/magicWands.src
   trunk/096/pkg/mobiles/npcutils/NPCCast.inc
   trunk/096/pkg/mobiles/npcutils/trainSkill.inc
   trunk/096/pkg/mobiles/oldAI/barber.src
   trunk/096/pkg/mobiles/oldAI/battleMage.src
   trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src
   trunk/096/pkg/mobiles/oldAI/davesHealer.src
   trunk/096/pkg/mobiles/oldAI/escortee.src
   trunk/096/pkg/mobiles/oldAI/merchant.src
   trunk/096/pkg/mobiles/oldAI/townHealer.src
   trunk/096/pkg/mobiles/oldAI/townPerson.src
   trunk/096/pkg/mobiles/oldAI/worker.src
   trunk/096/pkg/skills/alchemy/bluePotion.src
   trunk/096/pkg/skills/alchemy/whitePotion.src
   trunk/096/pkg/skills/fishing/magicFish.src
   trunk/096/pkg/skills/healing/healing.src
   trunk/096/pkg/systems/housing/houseDeed.src
   trunk/096/pkg/systems/merchantnodes/commands/admin/seednode.src
   trunk/096/pkg/systems/merchantnodes/commands/gm/resetstock.src
   trunk/096/pkg/systems/merchantnodes/merchantNode.src
   trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src
   trunk/096/pkg/systems/merchantnodes/merchantNodeDestroy.src
   trunk/096/pkg/systems/merchantnodes/restock.src
   trunk/096/scripts/doRes.src
   trunk/096/scripts/ecompile.cfg
   trunk/096/scripts/include/OLD/spellRestrictions.inc
Log:
Updated include paths.

Modified: trunk/096/pkg/items/wands/magicWands.src
===================================================================
--- trunk/096/pkg/items/wands/magicWands.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/items/wands/magicWands.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -7,7 +7,7 @@
 include "include/tileEffects";
 include "include/client";
 include "include/sound";
-include "include/statMod";
+include "include/OLD/statMod";
 
 
 var EVID_DISCHARGE := 0x123457;

Modified: trunk/096/pkg/mobiles/npcutils/NPCCast.inc
===================================================================
--- trunk/096/pkg/mobiles/npcutils/NPCCast.inc	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/mobiles/npcutils/NPCCast.inc	2005-11-05 23:39:07 UTC (rev 915)
@@ -4,7 +4,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/statMod";
+include "include/OLD/statMod";
 
 function castspell(caster, cast_on, spellname)
   var spellid := GetSpellID(spellname);

Modified: trunk/096/pkg/mobiles/npcutils/trainSkill.inc
===================================================================
--- trunk/096/pkg/mobiles/npcutils/trainSkill.inc	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/mobiles/npcutils/trainSkill.inc	2005-11-05 23:39:07 UTC (rev 915)
@@ -1,4 +1,4 @@
-include "include/skillLists";
+include "include/OLD/skillLists";
 include ":attributes:attributes_ex";
 
 var cost;

Modified: trunk/096/pkg/mobiles/oldAI/barber.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/barber.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/mobiles/oldAI/barber.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -6,12 +6,12 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":itemutils:utility";;
-include "include/mrcSpawn";
+include "include/OLD/mrcSpawn";
 include ":npcutils:vetement";
 include ":npcutils:NPCBackpacks";
 include "include/client";
 include ":npcutils:anchors";
-include "include/findCity";
+include "include/OLD/findCity";
 include ":begging:begging";
 include ":attributes:attributes";
 include ":npcutils:trainSkill";

Modified: trunk/096/pkg/mobiles/oldAI/battleMage.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/battleMage.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/mobiles/oldAI/battleMage.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -11,7 +11,7 @@
 include ":npcutils:vetement";
 include ":npcutils:anchors";
 include ":npcutils:NPCBackpacks";
-include "include/skillLists";
+include "include/OLD/skillLists";
 include ":timedscripts:timedScripts";
 
 var flee_point := 0;

Modified: trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -7,12 +7,12 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":itemutils:utility";;
-include "include/mrcSpawn";
+include "include/OLD/mrcSpawn";
 include ":npcutils:vetement";
 include ":npcutils:NPCBackpacks";
 include "include/client";
 include ":npcutils:anchors";
-include "include/findCity";
+include "include/OLD/findCity";
 include ":begging:begging";
 include ":npcutils:trainSkill";
 

Modified: trunk/096/pkg/mobiles/oldAI/davesHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/davesHealer.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/mobiles/oldAI/davesHealer.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -12,7 +12,7 @@
 include ":npcutils:anchors";
 include ":npcutils:speech";
 include "include/client";
-include "include/resurrection";
+include "include/OLD/resurrection";
 include ":begging:begging";
 
 const SOUND_EFFECT_RES := 0x215;

Modified: trunk/096/pkg/mobiles/oldAI/escortee.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/mobiles/oldAI/escortee.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -14,7 +14,7 @@
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
 include ":oldAI:main/sleepMode";
-include "include/skillLists";
+include "include/OLD/skillLists";
 include ":npcutils:vetement";
 include ":begging:begging";
 

Modified: trunk/096/pkg/mobiles/oldAI/merchant.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/merchant.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/mobiles/oldAI/merchant.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -6,12 +6,12 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":itemutils:utility";;
-include "include/mrcSpawn";
+include "include/OLD/mrcSpawn";
 include ":npcutils:vetement";
 include ":npcutils:NPCBackpacks";
 include "include/client";
 include ":npcutils:anchors";
-include "include/findCity";
+include "include/OLD/findCity";
 include ":begging:begging";
 include ":attributes:attributes";
 include ":npcutils:trainSkill";

Modified: trunk/096/pkg/mobiles/oldAI/townHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townHealer.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/mobiles/oldAI/townHealer.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -8,13 +8,13 @@
 include "include/sysEvent";
 include ":npcutils:names";
 include ":itemutils:utility";;
-include "include/mrcSpawn";
+include "include/OLD/mrcSpawn";
 include ":npcutils:vetement";
 include ":npcutils:NPCBackpacks";
 include "include/client";
 include ":npcutils:anchors";
-include "include/resurrection";
-include "include/findCity";
+include "include/OLD/resurrection";
+include "include/OLD/findCity";
 include ":begging:begging";
 include ":npcutils:trainSkill";
 

Modified: trunk/096/pkg/mobiles/oldAI/townPerson.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/mobiles/oldAI/townPerson.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -17,7 +17,7 @@
 include ":itemutils:objtype";
 include ":oldAI:setup/setup";
 include ":oldAI:main/sleepMode";
-include "include/skillLists";
+include "include/OLD/skillLists";
 include ":begging:begging";
 
 const HALT_THRESHOLD := 2;

Modified: trunk/096/pkg/mobiles/oldAI/worker.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/mobiles/oldAI/worker.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -16,7 +16,7 @@
 include ":npcutils:NPCUtil";
 include ":itemutils:objtype";
 include ":oldAI:main/sleepMode";
-include "include/skillLists";
+include "include/OLD/skillLists";
 include ":begging:begging";
 
 const HALT_THRESHOLD := 2;

Modified: trunk/096/pkg/skills/alchemy/bluePotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/bluePotion.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/skills/alchemy/bluePotion.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -3,7 +3,7 @@
 use util;
 use cfgfile;
 include "drinkPotion";
-include "include/statMod";
+include "include/OLD/statMod";
 include ":itemutils:canAccess";
 
 program bluePotion (who, potion)

Modified: trunk/096/pkg/skills/alchemy/whitePotion.src
===================================================================
--- trunk/096/pkg/skills/alchemy/whitePotion.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/skills/alchemy/whitePotion.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -3,7 +3,7 @@
 use util;
 use cfgfile;
 include "drinkPotion";
-include "include/statMod";
+include "include/OLD/statMod";
 include ":itemutils:canAccess";
 
 program whitePotion (who, potion)

Modified: trunk/096/pkg/skills/fishing/magicFish.src
===================================================================
--- trunk/096/pkg/skills/fishing/magicFish.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/skills/fishing/magicFish.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -7,7 +7,7 @@
 use os;
 use util;
 
-include "include/statMod";
+include "include/OLD/statMod";
 include ":itemutils:canAccess";
 include ":timedscripts:timedScripts";
 include ":timedscripts:poisonUtil";

Modified: trunk/096/pkg/skills/healing/healing.src
===================================================================
--- trunk/096/pkg/skills/healing/healing.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/skills/healing/healing.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -5,7 +5,7 @@
 use cfgfile;
 
 include "include/client";
-include "include/resurrection";
+include "include/OLD/resurrection";
 include ":itemutils:canAccess";
 include ":attributes:attributes";
 include ":timedscripts:timedScripts";

Modified: trunk/096/pkg/systems/housing/houseDeed.src
===================================================================
--- trunk/096/pkg/systems/housing/houseDeed.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/systems/housing/houseDeed.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -5,7 +5,7 @@
 include "util/key";
 include ":containers:storageAreas";
 include ":itemutils:objtype";
-include "include/findCity";
+include "include/OLD/findCity";
 include ":itemutils:canAccess";
 include "include/isValidLoc";
 

Modified: trunk/096/pkg/systems/merchantnodes/commands/admin/seednode.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/commands/admin/seednode.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/systems/merchantnodes/commands/admin/seednode.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -2,7 +2,7 @@
 use os;
 use cfgfile;
 
-include "include/mrcSpawn";
+include "include/OLD/mrcSpawn";
 
 program textcmd_seednode(who)
   var cfg := ReadConfigFile("packedNodes");

Modified: trunk/096/pkg/systems/merchantnodes/commands/gm/resetstock.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/commands/gm/resetstock.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/systems/merchantnodes/commands/gm/resetstock.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -2,7 +2,7 @@
 use os;
 use cfgfile;
 
-include "include/mrcSpawn";
+include "include/OLD/mrcSpawn";
 
 program textcmd_restock_from_cfg(who, type)
   if(type != "")

Modified: trunk/096/pkg/systems/merchantnodes/merchantNode.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/merchantNode.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/systems/merchantnodes/merchantNode.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -3,7 +3,7 @@
 
 include ":gumps:include/old/old-gumps";
 include "include/client";
-include "include/mrcSpawn";
+include "include/OLD/mrcSpawn";
 
 var pid, proc, item, restock, respawn, apply, cancel, page := 0, chk := 0, sy := 60, type;
 

Modified: trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/systems/merchantnodes/merchantNodeControl.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -6,7 +6,7 @@
 include "include/OLD/eventID";
 include ":attributes:attributes";
 include "include/sysEvent";
-include "include/mrcSpawn";
+include "include/OLD/mrcSpawn";
 include ":itemutils:utility";;
 
 var npclist := {};

Modified: trunk/096/pkg/systems/merchantnodes/merchantNodeDestroy.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/merchantNodeDestroy.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/systems/merchantnodes/merchantNodeDestroy.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -2,7 +2,7 @@
 use os;
 use cfgfile;
 
-include "include/mrcSpawn";
+include "include/OLD/mrcSpawn";
 
 program destroy(item)
   set_critical(1);

Modified: trunk/096/pkg/systems/merchantnodes/restock.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/restock.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/pkg/systems/merchantnodes/restock.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -2,7 +2,7 @@
 use os;
 use util;
 
-include "include/mrcSpawn";
+include "include/OLD/mrcSpawn";
 include ":itemutils:utility";;
 
 program restok(parms)

Modified: trunk/096/scripts/doRes.src
===================================================================
--- trunk/096/scripts/doRes.src	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/scripts/doRes.src	2005-11-05 23:39:07 UTC (rev 915)
@@ -1,7 +1,7 @@
 use uo;
 use os;
 
-include "include/resurrection";
+include "include/OLD/resurrection";
 include "include/client";
 //include "include/poisons";
 

Modified: trunk/096/scripts/ecompile.cfg
===================================================================
--- trunk/096/scripts/ecompile.cfg	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/scripts/ecompile.cfg	2005-11-05 23:39:07 UTC (rev 915)
@@ -38,5 +38,5 @@
 UpdateOnlyOnAutoCompile		1
 OnlyCompileUpdatedScripts	1
 DisplaySummary			1
-GenerateDependencyInfo		0
+GenerateDependencyInfo		1
 DisplayUpToDateScripts		1

Modified: trunk/096/scripts/include/OLD/spellRestrictions.inc
===================================================================
--- trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-05 23:29:57 UTC (rev 914)
+++ trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-05 23:39:07 UTC (rev 915)
@@ -8,7 +8,7 @@
 include "include/tileEffects";
 include "include/sound";
 include ":itemutils:objtype";
-include "include/statMod";
+include "include/OLD/statMod";
 include "include/firewall";
 include "include/spellAttack";
 



From austin at berlios.de  Sun Nov  6 00:44:38 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 00:44:38 +0100
Subject: [Poldistro-svn] r916 - in trunk/096: pkg/commands/coun pkg/commands/gm pkg/items/doors pkg/items/runebook pkg/items/traps pkg/items/wands pkg/mobiles/death pkg/mobiles/oldAI/main pkg/skills/alchemy pkg/skills/detecthidden pkg/skills/forensicevaluation pkg/skills/inscription pkg/skills/lockpicking pkg/skills/poisoning pkg/skills/removetrap pkg/skills/spiritspeak pkg/skills/tailoring pkg/skills/tinkering pkg/skills/tracking pkg/systems/boat pkg/systems/combat/old pkg/systems/combat/useScripts pkg/systems/crafting/include pkg/systems/housing scripts/include/OLD scripts/items scripts/misc
Message-ID: <200511052344.jA5NicfS029758@sheep.berlios.de>

Author: austin
Date: 2005-11-06 00:44:32 +0100 (Sun, 06 Nov 2005)
New Revision: 916

Modified:
   trunk/096/pkg/commands/coun/tele.src
   trunk/096/pkg/commands/gm/lkill.src
   trunk/096/pkg/commands/gm/summon.inc
   trunk/096/pkg/items/doors/closeDoor.src
   trunk/096/pkg/items/doors/openDoor.src
   trunk/096/pkg/items/runebook/customSpells.inc
   trunk/096/pkg/items/traps/poisonTrapTriggered.src
   trunk/096/pkg/items/traps/traps.src
   trunk/096/pkg/items/wands/magicWands.src
   trunk/096/pkg/mobiles/death/npcdeath.src
   trunk/096/pkg/mobiles/death/plyrdeath.src
   trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc
   trunk/096/pkg/skills/alchemy/alchemy.src
   trunk/096/pkg/skills/detecthidden/detectHidden.src
   trunk/096/pkg/skills/forensicevaluation/forensic.src
   trunk/096/pkg/skills/inscription/inscription.src
   trunk/096/pkg/skills/lockpicking/lockpicking.src
   trunk/096/pkg/skills/poisoning/poisonSkill.src
   trunk/096/pkg/skills/removetrap/removeTrap.src
   trunk/096/pkg/skills/spiritspeak/spiritSpeak.src
   trunk/096/pkg/skills/tailoring/makeClothItems.src
   trunk/096/pkg/skills/tailoring/scissors.src
   trunk/096/pkg/skills/tinkering/tinkerTraps.src
   trunk/096/pkg/skills/tinkering/tinkering.src
   trunk/096/pkg/skills/tracking/tracking.src
   trunk/096/pkg/systems/boat/boat.src
   trunk/096/pkg/systems/combat/old/bladed.src
   trunk/096/pkg/systems/combat/useScripts/bladed.src
   trunk/096/pkg/systems/crafting/include/craftingRepair.inc
   trunk/096/pkg/systems/housing/houseDeed.src
   trunk/096/scripts/include/OLD/spellRestrictions.inc
   trunk/096/scripts/items/pickLock.src
   trunk/096/scripts/misc/logon.src
Log:
Updated include paths.

Modified: trunk/096/pkg/commands/coun/tele.src
===================================================================
--- trunk/096/pkg/commands/coun/tele.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/commands/coun/tele.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -3,7 +3,7 @@
 include "include/messages";
 include "include/localization";
 include "include/tileEffects";
-include "include/sound";
+include "include/OLD/sound";
 
 
 program command_tele(who)

Modified: trunk/096/pkg/commands/gm/lkill.src
===================================================================
--- trunk/096/pkg/commands/gm/lkill.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/commands/gm/lkill.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -5,7 +5,7 @@
 use uo;
 
 include ":attributes:attributes";
-include "include/sound";
+include "include/OLD/sound";
 
 program textcmd_Kill(who)
 	SendSysMessage(who, "Select a target to kill.");

Modified: trunk/096/pkg/commands/gm/summon.inc
===================================================================
--- trunk/096/pkg/commands/gm/summon.inc	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/commands/gm/summon.inc	2005-11-05 23:44:32 UTC (rev 916)
@@ -2,7 +2,7 @@
 use os;
 
 include "include/client";
-include "include/sound";
+include "include/OLD/sound";
 include ":attributes:attributes";
 
 

Modified: trunk/096/pkg/items/doors/closeDoor.src
===================================================================
--- trunk/096/pkg/items/doors/closeDoor.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/items/doors/closeDoor.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -2,7 +2,7 @@
 use uo;
 use os;
 
-include "include/sound";
+include "include/OLD/sound";
 
 
 program close_door(door)

Modified: trunk/096/pkg/items/doors/openDoor.src
===================================================================
--- trunk/096/pkg/items/doors/openDoor.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/items/doors/openDoor.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -2,7 +2,7 @@
 use uo;
 use os;
 
-include "include/sound";
+include "include/OLD/sound";
 
 
 program openDoor(door)

Modified: trunk/096/pkg/items/runebook/customSpells.inc
===================================================================
--- trunk/096/pkg/items/runebook/customSpells.inc	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/items/runebook/customSpells.inc	2005-11-05 23:44:32 UTC (rev 916)
@@ -2,7 +2,7 @@
 use os;
 
 include "include/client";
-include "include/sound";
+include "include/OLD/sound";
 include ":itemutils:objtype";
 include "include/spellRestrictions";
 include ":attributes:attributes";

Modified: trunk/096/pkg/items/traps/poisonTrapTriggered.src
===================================================================
--- trunk/096/pkg/items/traps/poisonTrapTriggered.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/items/traps/poisonTrapTriggered.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -1,6 +1,6 @@
 use uo;
 
-include "include/sound";
+include "include/OLD/sound";
 include ":timedscripts:timedScripts";
 
 

Modified: trunk/096/pkg/items/traps/traps.src
===================================================================
--- trunk/096/pkg/items/traps/traps.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/items/traps/traps.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -4,7 +4,7 @@
 
 include "include/tileEffects";
 include ":itemutils:canAccess";
-include "include/sound";
+include "include/OLD/sound";
 
 
 program open_trapped_item(who, item)

Modified: trunk/096/pkg/items/wands/magicWands.src
===================================================================
--- trunk/096/pkg/items/wands/magicWands.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/items/wands/magicWands.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -6,7 +6,7 @@
 include ":itemutils:canAccess";
 include "include/tileEffects";
 include "include/client";
-include "include/sound";
+include "include/OLD/sound";
 include "include/OLD/statMod";
 
 

Modified: trunk/096/pkg/mobiles/death/npcdeath.src
===================================================================
--- trunk/096/pkg/mobiles/death/npcdeath.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/mobiles/death/npcdeath.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -11,7 +11,7 @@
 use util;
 use cfgfile;
 
-include "include/noto";
+include "include/OLD/noto";
 include ":containers:merchantUtil";
 include ":timedscripts:timedScripts";
 include ":death:death";

Modified: trunk/096/pkg/mobiles/death/plyrdeath.src
===================================================================
--- trunk/096/pkg/mobiles/death/plyrdeath.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/mobiles/death/plyrdeath.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -10,7 +10,7 @@
 use os;
 use util;
 
-include "include/noto";
+include "include/OLD/noto";
 include "include/reportMurder";
 include ":attributes:attributes";
 include ":timedscripts:timedScripts";

Modified: trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/mobiles/oldAI/main/mainLoopSheep.inc	2005-11-05 23:44:32 UTC (rev 916)
@@ -1,4 +1,4 @@
-include "include/sound";
+include "include/OLD/sound";
 include "include/tileEffects";
 include ":attributes:attributes";
 

Modified: trunk/096/pkg/skills/alchemy/alchemy.src
===================================================================
--- trunk/096/pkg/skills/alchemy/alchemy.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/alchemy/alchemy.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -7,7 +7,7 @@
 include "include/client";
 include "potion";
 include ":itemutils:canAccess";
-include "include/noto";
+include "include/OLD/noto";
 
 CONST REAGENT_START := 0x0f78;
 CONST REAGENT_STOP := 0x0f91;

Modified: trunk/096/pkg/skills/detecthidden/detectHidden.src
===================================================================
--- trunk/096/pkg/skills/detecthidden/detectHidden.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/detecthidden/detectHidden.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -19,7 +19,7 @@
 include ":attributes:attributeConstants";
 include ":attributes:attributes";
 include ":attributes:skillCheck";
-include "include/sound";
+include "include/OLD/sound";
 include "include/tileEffects";
 
 CONST TRAP := "hiddentrap";

Modified: trunk/096/pkg/skills/forensicevaluation/forensic.src
===================================================================
--- trunk/096/pkg/skills/forensicevaluation/forensic.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/forensicevaluation/forensic.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -1,7 +1,7 @@
 use uo;
 
 include "include/client";
-include "include/noto";
+include "include/OLD/noto";
 
 
 const UOBJ_PROOF := 0xbe34;

Modified: trunk/096/pkg/skills/inscription/inscription.src
===================================================================
--- trunk/096/pkg/skills/inscription/inscription.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/inscription/inscription.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -1,7 +1,7 @@
 include ":attributes:attributes";
 include ":itemutils:objtype";
 include ":itemutils:canAccess";
-include "include/noto";
+include "include/OLD/noto";
 
 var config_file;
 

Modified: trunk/096/pkg/skills/lockpicking/lockpicking.src
===================================================================
--- trunk/096/pkg/skills/lockpicking/lockpicking.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/lockpicking/lockpicking.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -4,7 +4,7 @@
 use util;
 
 include ":itemutils:objtype";
-include "include/sound";
+include "include/OLD/sound";
 include "include/startEqp";
 include "util/key";
 include ":itemutils:canAccess";

Modified: trunk/096/pkg/skills/poisoning/poisonSkill.src
===================================================================
--- trunk/096/pkg/skills/poisoning/poisonSkill.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/poisoning/poisonSkill.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -5,7 +5,7 @@
 
 include "include/client";
 include ":itemutils:canAccess";
-include "include/noto";
+include "include/OLD/noto";
 
 program do_poisoning(who)
   EraseObjProperty(who, "IsMeditating");

Modified: trunk/096/pkg/skills/removetrap/removeTrap.src
===================================================================
--- trunk/096/pkg/skills/removetrap/removeTrap.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/removetrap/removeTrap.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -5,7 +5,7 @@
 use util;
 
 include "include/client";
-include "include/sound";
+include "include/OLD/sound";
 include "include/tileEffects";
 include ":itemutils:canAccess";
 include ":attributes:attributes";

Modified: trunk/096/pkg/skills/spiritspeak/spiritSpeak.src
===================================================================
--- trunk/096/pkg/skills/spiritspeak/spiritSpeak.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/spiritspeak/spiritSpeak.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -25,7 +25,7 @@
 include ":attributes:attributeConstants";
 include ":attributes:attributes";
 include ":attributes:skillCheck";
-include "include/sound";
+include "include/OLD/sound";
 
 CONST SS_RANGE   :=  3;
 CONST SS_TIMER   := 30;

Modified: trunk/096/pkg/skills/tailoring/makeClothItems.src
===================================================================
--- trunk/096/pkg/skills/tailoring/makeClothItems.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/tailoring/makeClothItems.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -8,8 +8,8 @@
 include "include/client";
 include ":itemutils:objtype";
 include ":itemutils:canAccess";
-include "include/toolWear";
-include "include/noto";
+include ":itemutils:toolWear";
+include "include/OLD/noto";
 
 const SCISSORS_SOUND    := 0x0249;
 

Modified: trunk/096/pkg/skills/tailoring/scissors.src
===================================================================
--- trunk/096/pkg/skills/tailoring/scissors.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/tailoring/scissors.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -5,7 +5,7 @@
 include ":attributes:attributes";
 include "include/client";
 include ":itemutils:canAccess";
-include "include/toolWear";
+include ":itemutils:toolWear";
 
 var scissors_cfg := ReadConfigFile("scissors");
 var cfg2 := ReadConfigFile("tailoring");

Modified: trunk/096/pkg/skills/tinkering/tinkerTraps.src
===================================================================
--- trunk/096/pkg/skills/tinkering/tinkerTraps.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/tinkering/tinkerTraps.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -2,7 +2,7 @@
 use util;
 use os;
 
-include "include/sound";
+include "include/OLD/sound";
 include "include/tileEffects";
 include "include/client";
 include ":itemutils:canAccess";

Modified: trunk/096/pkg/skills/tinkering/tinkering.src
===================================================================
--- trunk/096/pkg/skills/tinkering/tinkering.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/tinkering/tinkering.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -7,13 +7,13 @@
 
 include ":attributes:attributes";
 include "include/client";
-include "include/sound";
+include "include/OLD/sound";
 include ":itemutils:objtype";
 include "util/key";
 include ":itemutils:canAccess";
-include "include/toolWear";
+include ":itemutils:toolWear";
 include ":gumps:include/old/old-gumps";
-include "include/noto";
+include "include/OLD/noto";
 
 var keys := {0x100e, 0x100f, 0x100f, 0x1012, 0x1013};
 var tinker_cfg:= ReadConfigFile("tinker");

Modified: trunk/096/pkg/skills/tracking/tracking.src
===================================================================
--- trunk/096/pkg/skills/tracking/tracking.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/skills/tracking/tracking.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -5,7 +5,7 @@
 use os;
 
 include "include/client";
-include "include/sound";
+include "include/OLD/sound";
 include ":attributes:attributes";
 
 

Modified: trunk/096/pkg/systems/boat/boat.src
===================================================================
--- trunk/096/pkg/systems/boat/boat.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/systems/boat/boat.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -18,7 +18,7 @@
 include "include/sysEvent";
 include ":itemutils:myUtil";
 include "include/client";
-include "include/sound";
+include "include/OLD/sound";
 include ":gumps:yesno";
 include "include/math";
 include "util/key";

Modified: trunk/096/pkg/systems/combat/old/bladed.src
===================================================================
--- trunk/096/pkg/systems/combat/old/bladed.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/systems/combat/old/bladed.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -7,13 +7,13 @@
 use util;
 
 include "include/client";
-include "include/sound";
+include "include/OLD/sound";
 include ":attributes:attributes";
 include "include/string";
 include ":itemutils:objtype";
 include ":itemutils:canAccess";
-include "include/toolWear";
-include "include/noto";
+include ":itemutils:toolWear";
+include "include/OLD/noto";
 include ":tailoring:tailoringFunctions";
 include ":fishing:fishingFunctions";
 include ":containers:corpse/corpseFunctions";

Modified: trunk/096/pkg/systems/combat/useScripts/bladed.src
===================================================================
--- trunk/096/pkg/systems/combat/useScripts/bladed.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/systems/combat/useScripts/bladed.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -7,13 +7,13 @@
 use util;
 
 include "include/client";
-include "include/sound";
+include "include/OLD/sound";
 include ":attributes:attributes";
 include "include/string";
 include ":itemutils:objtype";
 include ":itemutils:canAccess";
-include "include/toolWear";
-include "include/noto";
+include ":itemutils:toolWear";
+include "include/OLD/noto";
 include ":tailoring:tailoringFunctions";
 include ":fishing:fishingFunctions";
 include ":containers:corpse/corpseFunctions";

Modified: trunk/096/pkg/systems/crafting/include/craftingRepair.inc
===================================================================
--- trunk/096/pkg/systems/crafting/include/craftingRepair.inc	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/systems/crafting/include/craftingRepair.inc	2005-11-05 23:44:32 UTC (rev 916)
@@ -18,7 +18,7 @@
 //
 ////////////////////////////////////////////////////////////////////////////////////////////////////
 
-include "include/sound";
+include "include/OLD/sound";
 
 function repair_item(character, what, craft_skill )
   var maxhp;

Modified: trunk/096/pkg/systems/housing/houseDeed.src
===================================================================
--- trunk/096/pkg/systems/housing/houseDeed.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/pkg/systems/housing/houseDeed.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -7,7 +7,7 @@
 include ":itemutils:objtype";
 include "include/OLD/findCity";
 include ":itemutils:canAccess";
-include "include/isValidLoc";
+include "include/OLD/isValidLoc";
 
 const UOBJECT_DOORS_START:=0x675;
 const UOBJECT_DOORS_END:=0x6f4;

Modified: trunk/096/scripts/include/OLD/spellRestrictions.inc
===================================================================
--- trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-05 23:44:32 UTC (rev 916)
@@ -6,7 +6,7 @@
 include ":itemutils:fields";
 include "include/client";
 include "include/tileEffects";
-include "include/sound";
+include "include/OLD/sound";
 include ":itemutils:objtype";
 include "include/OLD/statMod";
 include "include/firewall";

Modified: trunk/096/scripts/items/pickLock.src
===================================================================
--- trunk/096/scripts/items/pickLock.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/scripts/items/pickLock.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -3,7 +3,7 @@
 use util;
 
 include "include/client";
-include "include/sound";
+include "include/OLD/sound";
 include ":attributes:attributes";
 
 program picklock(who, lockpick)

Modified: trunk/096/scripts/misc/logon.src
===================================================================
--- trunk/096/scripts/misc/logon.src	2005-11-05 23:39:07 UTC (rev 915)
+++ trunk/096/scripts/misc/logon.src	2005-11-05 23:44:32 UTC (rev 916)
@@ -15,7 +15,7 @@
 include ":itemutils:myUtil";
 include ":attributes:attributes";
 include ":combat:equip";
-include "include/noto";
+include "include/OLD/noto";
 
 
 program core_logon(who)



From austin at berlios.de  Sun Nov  6 00:51:14 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 00:51:14 +0100
Subject: [Poldistro-svn] r917 - in trunk/096: pkg/commands/coun pkg/items/guildstone pkg/items/runebook pkg/mobiles/npcutils pkg/skills/fishing pkg/skills/lockpicking pkg/skills/mining pkg/skills/tinkering pkg/systems/daynight pkg/systems/merchantnodes pkg/systems/nature scripts/console scripts/items scripts/misc
Message-ID: <200511052351.jA5NpE4H003056@sheep.berlios.de>

Author: austin
Date: 2005-11-06 00:51:11 +0100 (Sun, 06 Nov 2005)
New Revision: 917

Modified:
   trunk/096/pkg/commands/coun/time.src
   trunk/096/pkg/items/guildstone/guildStone.src
   trunk/096/pkg/items/runebook/runebook.src
   trunk/096/pkg/mobiles/npcutils/NPCKeeper.src
   trunk/096/pkg/skills/fishing/SOSMessage.src
   trunk/096/pkg/skills/fishing/fishing.src
   trunk/096/pkg/skills/fishing/fishingFunctions.inc
   trunk/096/pkg/skills/lockpicking/lockpicking.src
   trunk/096/pkg/skills/mining/mining.src
   trunk/096/pkg/skills/tinkering/time.src
   trunk/096/pkg/systems/daynight/dayNight.src
   trunk/096/pkg/systems/merchantnodes/guardNode.src
   trunk/096/pkg/systems/merchantnodes/merchantNode.src
   trunk/096/pkg/systems/nature/dayNight.src
   trunk/096/pkg/systems/nature/moons.src
   trunk/096/scripts/console/about.src
   trunk/096/scripts/console/shutdown.src
   trunk/096/scripts/console/time.src
   trunk/096/scripts/items/coords.src
   trunk/096/scripts/misc/oncreate.src
   trunk/096/scripts/misc/ondelete.src
Log:
Include path updates.

Modified: trunk/096/pkg/commands/coun/time.src
===================================================================
--- trunk/096/pkg/commands/coun/time.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/commands/coun/time.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -1,6 +1,6 @@
 use uo;
 
-include "include/clock";
+include "include/OLD/clock";
 
 
 program command_time(who)

Modified: trunk/096/pkg/items/guildstone/guildStone.src
===================================================================
--- trunk/096/pkg/items/guildstone/guildStone.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/items/guildstone/guildStone.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -5,7 +5,7 @@
 include ":itemutils:canAccess";
 include "guildData";
 include ":gumps:include/old/old-gumps";
-include "include/webPage";
+include "include/OLD/webPage";
 
 var guildstone;
 var gm, guild, guild_id;

Modified: trunk/096/pkg/items/runebook/runebook.src
===================================================================
--- trunk/096/pkg/items/runebook/runebook.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/items/runebook/runebook.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -5,7 +5,7 @@
 include "customSpells";
 include "include/math";
 include "include/client";
-include "include/coords";
+include "include/OLD/coords";
 include ":itemutils:canAccess";
 
 const OBJTYPE_RUNE := 0x1f14;

Modified: trunk/096/pkg/mobiles/npcutils/NPCKeeper.src
===================================================================
--- trunk/096/pkg/mobiles/npcutils/NPCKeeper.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/mobiles/npcutils/NPCKeeper.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -3,7 +3,7 @@
 use uo;
 use os;
 
-include "include/startEqp";
+include "include/OLD/startEqp";
 include ":attributes:attributes";
 include ":npcutils:vetement";
 include ":npcutils:names";

Modified: trunk/096/pkg/skills/fishing/SOSMessage.src
===================================================================
--- trunk/096/pkg/skills/fishing/SOSMessage.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/skills/fishing/SOSMessage.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -5,7 +5,7 @@
 use uo;
 use os;
 
-include "include/coords";
+include "include/OLD/coords";
 include ":itemutils:canAccess";
 include ":gumps:include/gumps";
 

Modified: trunk/096/pkg/skills/fishing/fishing.src
===================================================================
--- trunk/096/pkg/skills/fishing/fishing.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/skills/fishing/fishing.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -12,7 +12,7 @@
 include ":attributes:include/attributes";
 include ":crafting:toolWear";
 include ":itemutils:objtype";
-include "include/startEqp";
+include "include/OLD/startEqp";
 include "include/sysEvent";
 
 program use_FishingPole(who, fishingpole)
@@ -86,7 +86,7 @@
 				SendSysMessage(who, "There doesn't seem to be any fish here.");
 				return 0;
 			endif
-			if( SkillCheck(who, ATTRIBUTE_FISHING, difficulty) > 0)
+			if( SkillCheck(who, FISHING, difficulty) > 0)
 				var fishreturned := HarvestResource("fish", targetsquare.x, targetsquare.y, 1, 1, who.realm);
 				if( !fishreturned )
 					SendSysMessage(who, "Oops, you let that one get away!");
@@ -111,7 +111,7 @@
 function GetTheCatch(who, targetsquare, fishingpole)
 
 	var fishtype;
-	var currentskill := AP_GetSkill(who, ATTRIBUTE_FISHING);
+	var currentskill := AP_GetSkill(who, FISHING);
 	var thisone := RandomInt(100)+ 1;
 	if(thisone <= 94)
 		fishtype := RandomInt(UOBJ_FISH_END - UOBJ_FISH_START)+ UOBJ_FISH_START;
@@ -161,7 +161,7 @@
 		endif
 	else
 		if( CreateItemInContainer(who.backpack, fishtype, 1) )
-			CheckToolWear (who, fishingpole, ATTRIBUTE_FISHING);
+			CheckToolWear (who, fishingpole, FISHING);
 		endif
         endif
 

Modified: trunk/096/pkg/skills/fishing/fishingFunctions.inc
===================================================================
--- trunk/096/pkg/skills/fishing/fishingFunctions.inc	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/skills/fishing/fishingFunctions.inc	2005-11-05 23:51:11 UTC (rev 917)
@@ -188,7 +188,7 @@
 function GetSOSTreasure(who, targetsquare, sosmsg)
 
 	targetsquare := targetsquare;
-	if( SkillCheck(who, ATTRIBUTE_FISHING, 80, 200) > 0 )
+	if( SkillCheck(who, FISHING, 80, 200) > 0 )
 		var itemcfg := ReadConfigFile(":*:itemdesc");
 		var it, oldname;
 		if( RandomInt(100) < 75 )

Modified: trunk/096/pkg/skills/lockpicking/lockpicking.src
===================================================================
--- trunk/096/pkg/skills/lockpicking/lockpicking.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/skills/lockpicking/lockpicking.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -5,7 +5,7 @@
 
 include ":itemutils:objtype";
 include "include/OLD/sound";
-include "include/startEqp";
+include "include/OLD/startEqp";
 include "util/key";
 include ":itemutils:canAccess";
 

Modified: trunk/096/pkg/skills/mining/mining.src
===================================================================
--- trunk/096/pkg/skills/mining/mining.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/skills/mining/mining.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -5,7 +5,7 @@
 include "include/client";
 include ":attributes:attributes";
 include ":itemutils:objtype";
-include "include/startEqp";
+include "include/OLD/startEqp";
 include "util/key";
 include ":itemutils:utility";;
 include ":itemutils:canAccess";

Modified: trunk/096/pkg/skills/tinkering/time.src
===================================================================
--- trunk/096/pkg/skills/tinkering/time.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/skills/tinkering/time.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -1,6 +1,6 @@
 use uo;
 
-include "include/clock";
+include "include/OLD/clock";
 
 program time(character)
   SendSysMessage(character, ("Time of Day: " + GetTimeofDay()));

Modified: trunk/096/pkg/systems/daynight/dayNight.src
===================================================================
--- trunk/096/pkg/systems/daynight/dayNight.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/systems/daynight/dayNight.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -3,7 +3,7 @@
 
 set_critical( 1);
 
-include "include/clock";
+include "include/OLD/clock";
 include ":daynight:moonlight";
 
 const NIGHT_NUMERATOR := 1.0;

Modified: trunk/096/pkg/systems/merchantnodes/guardNode.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/guardNode.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/systems/merchantnodes/guardNode.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -31,9 +31,9 @@
     amt := 1;
     SetObjProperty(item, "Amount", 1);
   endif
-  OldGFTextLine( 20,  50, COLOR_GREEN, "Guard Set Type:");
-  OldGFTextLine( 20,  80, COLOR_GREEN, "Guard Set Amount:");
-  OldGFTextLine(255,  80, COLOR_GREEN, "Current:");
+  OldGFTextLine( 20,  50, 0, "Guard Set Type:");
+  OldGFTextLine( 20,  80, 0, "Guard Set Amount:");
+  OldGFTextLine(255,  80, 0, "Current:");
   var npclist := GetObjProperty(item, "NpcList");
   var current := 0;
   var holder := array;
@@ -45,16 +45,16 @@
   endforeach
   SetObjProperty(item, "NpcList", holder);
   if(current == amt)
-    OldGFTextLine(350,  80, COLOR_BLUE,   current+"/"+amt);
+    OldGFTextLine(350,  80, 0,   current+"/"+amt);
   elseif(current == 0)
-    OldGFTextLine(350,  80, COLOR_RED,    current+"/"+amt);
+    OldGFTextLine(350,  80, 0,    current+"/"+amt);
   else
     OldGFTextLine(350,  80, 0x35, current+"/"+amt);
   endif
   OldGFGumpPic(171, 50, 2440);
   OldGFGumpPic(171, 80, 2444);
-  newtype     := OldGFTextEntry(178,  50, 200,  30, COLOR_GREEN, type);
-  newamt      := OldGFTextEntry(178,  80, 200,  30, COLOR_GREEN, amt);
+  newtype     := OldGFTextEntry(178,  50, 200,  30, 0, type);
+  newamt      := OldGFTextEntry(178,  80, 200,  30, 0, amt);
   apply   := OldGFButtonID( 20, 270, 2124, 2123, 1);
   cancel  := OldGFButtonID(100, 270, 2121, 2120, 1);
   GetStatus(item, respawn);
@@ -70,15 +70,15 @@
   var status := GetObjProperty(item, "Status");
   var color, txt;
     case(status)
-      "on":      color := COLOR_GREEN; txt := "Guard Node Enabled";
+      "on":      color := 0; txt := "Guard Node Enabled";
                  OldGFSetRadioGroup(1);
                  OldGFRadioButton(20, 150, 210, 211, 1, 200);
                  OldGFRadioButton(20, 175, 210, 211, 0, 201);
-      "off":     color := COLOR_RED; txt := "Guard Node Disabled";
+      "off":     color := 0; txt := "Guard Node Disabled";
                  OldGFSetRadioGroup(1);
                  OldGFRadioButton(20, 150, 210, 211, 0, 200);
                  OldGFRadioButton(20, 175, 210, 211, 1, 201);
-      default:   color := COLOR_GREEN; txt := "Guard Node Enabled";
+      default:   color := 0; txt := "Guard Node Enabled";
                  SetObjProperty(item, "Status", "on");
                  OldGFSetRadioGroup(1);
                  OldGFRadioButton(20, 150, 210, 211, 1, 200);
@@ -93,11 +93,11 @@
     txt := "Guard Nodes Are Disabled Globally";
   elseif(status != "off")
     respawn := OldGFCheckBox(  20, 120, 208, 209, 0, 300);
-    OldGFTextLine( 50, 120, COLOR_GREEN, "Respawn Guards");
+    OldGFTextLine( 50, 120, 0, "Respawn Guards");
   endif
   OldGFTextMid(150, 270, 300, color, txt);
-  OldGFTextLine(60, 150, COLOR_GREEN, "Enable Node");
-  OldGFTextLine(60, 175, COLOR_GREEN, "Disable Node");
+  OldGFTextLine(60, 150, 0, "Enable Node");
+  OldGFTextLine(60, 175, 0, "Disable Node");
 endfunction
 
 function ResetGuardNode(item, ret)

Modified: trunk/096/pkg/systems/merchantnodes/merchantNode.src
===================================================================
--- trunk/096/pkg/systems/merchantnodes/merchantNode.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/systems/merchantnodes/merchantNode.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -40,19 +40,19 @@
     SetObjProperty(item, "Type", type);
   endif
   var amt := len(type);
-  OldGFTextLine( 20, 40, COLOR_BLUE, "Type");
-  OldGFTextLine(150, 40, COLOR_BLUE, "X");
-  OldGFTextLine(210, 40, COLOR_BLUE, "Y");
-  OldGFTextLine(270, 40, COLOR_BLUE, "Z");
-  OldGFTextLine(310, 40, COLOR_BLUE, "Enable");
-  OldGFTextLine(360, 40, COLOR_BLUE, "Delete");
-  OldGFTextLine(420, 40, COLOR_BLUE, "Rebuild Stock");
+  OldGFTextLine( 20, 40, 0, "Type");
+  OldGFTextLine(150, 40, 0, "X");
+  OldGFTextLine(210, 40, 0, "Y");
+  OldGFTextLine(270, 40, 0, "Z");
+  OldGFTextLine(310, 40, 0, "Enable");
+  OldGFTextLine(360, 40, 0, "Delete");
+  OldGFTextLine(420, 40, 0, "Rebuild Stock");
   FillInPageData();
   if(len(type) < 10)
     OldGFTextLine(40, sy, 0x35, "Create a new merchant here?   (negates all other choices)");
     OldGFButtonID(20, sy, 210, 211, 1, sy);
   endif
-  OldGFTextLine( 20, 20, COLOR_GREEN, "Current:");
+  OldGFTextLine( 20, 20, 0, "Current:");
   var npclist := GetObjProperty(item, "NpcList");
   var current := 0;
   var holder := array;
@@ -64,9 +64,9 @@
   endforeach
   SetObjProperty(item, "NpcList", holder);
   if(current == amt)
-    OldGFTextLine(90, 20, COLOR_BLUE,   current+"/"+amt);
+    OldGFTextLine(90, 20, 0,   current+"/"+amt);
   elseif(current == 0)
-    OldGFTextLine(90, 20, COLOR_RED,    current+"/"+amt);
+    OldGFTextLine(90, 20, 0,    current+"/"+amt);
   else
     OldGFTextLine(90, 20, 0x35, current+"/"+amt);
   endif
@@ -133,9 +133,9 @@
     var y        := current[2][2];
     var z        := current[2][3];
     var status   := current[3];
-    var color    := COLOR_GREEN;
+    var color    := 0;
     if(!status)
-      color := COLOR_RED;
+      color := 0;
     endif
     OldGFTextLine( 20, sy, color, template);
     OldGFTextLine(150, sy, color, x);
@@ -153,15 +153,15 @@
   var status := GetObjProperty(item, "Status");
   var color, txt;
     case(status)
-      "on":      color := COLOR_GREEN; txt := "Merchant Node Enabled";
+      "on":      color := 0; txt := "Merchant Node Enabled";
                  OldGFSetRadioGroup(1);
                  OldGFRadioButton(20, 320, 208, 209, 1, 200);
                  OldGFRadioButton(20, 340, 208, 209, 0, 201);
-      "off":     color := COLOR_RED; txt := "Merchant Node Disabled";
+      "off":     color := 0; txt := "Merchant Node Disabled";
                  OldGFSetRadioGroup(1);
                  OldGFRadioButton(20, 320, 208, 209, 0, 200);
                  OldGFRadioButton(20, 340, 208, 209, 1, 201);
-      default:   color := COLOR_GREEN; txt := "Merchant Node Enabled";
+      default:   color := 0; txt := "Merchant Node Enabled";
                  SetObjProperty(item, "Status", "on");
                  OldGFSetRadioGroup(1);
                  OldGFRadioButton(20, 320, 208, 209, 1, 200);
@@ -177,12 +177,12 @@
   elseif(status != "off")
     restock := OldGFCheckBox(340, 320, 208, 209, 0, 400);
     respawn := OldGFCheckBox(340, 340, 208, 209, 0, 300);
-    OldGFTextLine(370, 320, COLOR_GREEN, "Restock Merchants");
-    OldGFTextLine(370, 340, COLOR_GREEN, "Respawn Merchants");
+    OldGFTextLine(370, 320, 0, "Restock Merchants");
+    OldGFTextLine(370, 340, 0, "Respawn Merchants");
   endif
   OldGFTextMid(150, 370, 300, color, txt);
-  OldGFTextLine(50, 320, COLOR_GREEN, "Enable Node");
-  OldGFTextLine(50, 340, COLOR_GREEN, "Disable Node");
+  OldGFTextLine(50, 320, 0, "Enable Node");
+  OldGFTextLine(50, 340, 0, "Disable Node");
 endfunction
 
 function ResetMerchantNode(who, ret)

Modified: trunk/096/pkg/systems/nature/dayNight.src
===================================================================
--- trunk/096/pkg/systems/nature/dayNight.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/systems/nature/dayNight.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -3,7 +3,7 @@
 use os;
 use cfgfile;
 
-include "include/clock";
+include "include/OLD/clock";
 include "include/arrays";
 include "nature";
 include "include/std";

Modified: trunk/096/pkg/systems/nature/moons.src
===================================================================
--- trunk/096/pkg/systems/nature/moons.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/pkg/systems/nature/moons.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -3,7 +3,7 @@
 use os;
 use cfgfile;
 
-include "include/clock";
+include "include/OLD/clock";
 include "nature";
 
 var TLength := 60;

Modified: trunk/096/scripts/console/about.src
===================================================================
--- trunk/096/scripts/console/about.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/scripts/console/about.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -3,7 +3,7 @@
  */
 use uo;
 
-include "include/clock";
+include "include/OLD/clock";
 
 program console_about(cmd)
 

Modified: trunk/096/scripts/console/shutdown.src
===================================================================
--- trunk/096/scripts/console/shutdown.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/scripts/console/shutdown.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -5,7 +5,7 @@
 use os;
 use util;
 
-include "include/clock";
+include "include/OLD/clock";
 
 program cmd_shutdown( cmd )
 

Modified: trunk/096/scripts/console/time.src
===================================================================
--- trunk/096/scripts/console/time.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/scripts/console/time.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -3,7 +3,7 @@
  */
 use uo;
 
-include "include/clock";
+include "include/OLD/clock";
 
 
 program time(cmd)

Modified: trunk/096/scripts/items/coords.src
===================================================================
--- trunk/096/scripts/items/coords.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/scripts/items/coords.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -1,5 +1,5 @@
 use uo;
-include "include/coords";
+include "include/OLD/coords";
 include ":itemutils:canAccess";
 
 program get_coords(who, item)

Modified: trunk/096/scripts/misc/oncreate.src
===================================================================
--- trunk/096/scripts/misc/oncreate.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/scripts/misc/oncreate.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -7,7 +7,7 @@
  */
 use uo;
 
-include "include/startEqp";
+include "include/OLD/startEqp";
 
 
 program core_onCreate(who, skillids)

Modified: trunk/096/scripts/misc/ondelete.src
===================================================================
--- trunk/096/scripts/misc/ondelete.src	2005-11-05 23:44:32 UTC (rev 916)
+++ trunk/096/scripts/misc/ondelete.src	2005-11-05 23:51:11 UTC (rev 917)
@@ -6,7 +6,7 @@
  */
 use uo;
 
-include "include/startEqp";
+include "include/OLD/startEqp";
 
 
 program core_onDelete(who)



From austin at berlios.de  Sun Nov  6 01:03:25 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 01:03:25 +0100
Subject: [Poldistro-svn] r918 - in trunk/096/pkg/mobiles: death/commands/seer timedScripts/commands/gm
Message-ID: <200511060003.jA603PVH004776@sheep.berlios.de>

Author: austin
Date: 2005-11-06 01:03:23 +0100 (Sun, 06 Nov 2005)
New Revision: 918

Modified:
   trunk/096/pkg/mobiles/death/commands/seer/resurrect.src
   trunk/096/pkg/mobiles/timedScripts/commands/gm/addTimer.src
   trunk/096/pkg/mobiles/timedScripts/commands/gm/lowerTimer.src
Log:


Modified: trunk/096/pkg/mobiles/death/commands/seer/resurrect.src
===================================================================
--- trunk/096/pkg/mobiles/death/commands/seer/resurrect.src	2005-11-05 23:51:11 UTC (rev 917)
+++ trunk/096/pkg/mobiles/death/commands/seer/resurrect.src	2005-11-06 00:03:23 UTC (rev 918)
@@ -9,26 +9,27 @@
 
 
 program command_Resurrect(who, params)
-	if (params == "")
+	if ( params == "" )
 		SendMessage(who, MSG_TARGET_CHAR, array{}, MSG_COMMAND);
-		if ((var targ := Target(who, TGTOPT_NOCHECK_LOS)) == 0)
+		var targ := Target(who, TGTOPT_NOCHECK_LOS);
+		if ( !targ )
 			SendMessage(who, MSG_CANCELLED, array{}, MSG_COMMAND);
 			return 0;
 		else
-			if (targ.isA(POLCLASS_CORPSE))
+			if ( targ.isA(POLCLASS_CORPSE) )
 				targ := SystemFindObjectBySerial(targ.ownerserial);
-				if (!targ)
+				if ( !targ )
 					SendSysMessage(who, "No owner could be found for that corpse.");
 					return 0;
 				endif
-					var result := Resurrect(targ);
-				if (result.errortext)
+				var result := Resurrect(targ);
+				if ( result.errortext )
 					SendSysMessage(who, "Error - "+result.errortext);
 					return 0;
 				endif
 			endif
 		endif		
-	elseif (params == "me")
+	elseif ( params == "me" )
 		Resurrect(who);
 		AP_RefreshVitals(who);
 		return 1;

Modified: trunk/096/pkg/mobiles/timedScripts/commands/gm/addTimer.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/commands/gm/addTimer.src	2005-11-05 23:51:11 UTC (rev 917)
+++ trunk/096/pkg/mobiles/timedScripts/commands/gm/addTimer.src	2005-11-06 00:03:23 UTC (rev 918)
@@ -13,21 +13,21 @@
 	
 	var timer_name	:= params[1];
 	var duration	:= CInt(params[2]);
-	var level	:= CInt(params[t3]);
+	var level	:= CInt(params[3]);
 
-	if (!level)
+	if ( !level )
 		level := 1;
 	endif
 	
-	if (!timer_name || !duration)
+	if ( !timer_name || !duration )
 		SendMessage(who, MSG_USE_HELP, array{}, MSG_COMMAND);
 		return;
 	endif
 
-	SendMessage(who, MSG_TARGET_MOBILE, array{}, MSG_COMMAND);
+	SendMessage(who, MSG_TARGET_CHAR, array{}, MSG_COMMAND);
 
 	var targ := target(who);
-	if (!targ.IsA(POLCLASS_MOBILE))
+	if ( !targ.IsA(POLCLASS_MOBILE) )
 		SendMessage(who, MSG_CANCELLED, array{}, MSG_COMMAND);
 		return 0;
 	endif

Modified: trunk/096/pkg/mobiles/timedScripts/commands/gm/lowerTimer.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/commands/gm/lowerTimer.src	2005-11-05 23:51:11 UTC (rev 917)
+++ trunk/096/pkg/mobiles/timedScripts/commands/gm/lowerTimer.src	2005-11-06 00:03:23 UTC (rev 918)
@@ -4,8 +4,8 @@
 use uo;
 
 include ":timedscripts:timedScripts";
+include "include/messages";
 
-
 program command_LowerTimer(who, params)
 	params := SplitWords(params);
 	



From austin at berlios.de  Sun Nov  6 10:23:21 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 10:23:21 +0100
Subject: [Poldistro-svn] r919 - in trunk/096/pkg: skills/magery systems/attributes/hooks systems/combat/hooks
Message-ID: <200511060923.jA69NLVo012309@sheep.berlios.de>

Author: austin
Date: 2005-11-06 10:23:16 +0100 (Sun, 06 Nov 2005)
New Revision: 919

Removed:
   trunk/096/pkg/skills/magery/hooks/
Modified:
   trunk/096/pkg/skills/magery/itemdesc.cfg
   trunk/096/pkg/systems/attributes/hooks/vitalInit.src
   trunk/096/pkg/systems/combat/hooks/combatAdv.src
   trunk/096/pkg/systems/combat/hooks/parryAdv.src
Log:
Updated hook install messages to match packet hook ones.

Updated itemdesc.cfg in magery to use the SpellScroll item type for spell scrolls.

Modified: trunk/096/pkg/skills/magery/itemdesc.cfg
===================================================================
--- trunk/096/pkg/skills/magery/itemdesc.cfg	2005-11-06 00:03:23 UTC (rev 918)
+++ trunk/096/pkg/skills/magery/itemdesc.cfg	2005-11-06 09:23:16 UTC (rev 919)
@@ -8,856 +8,920 @@
 {
 	Name			Spellbook
 	Desc			spellbook
-	
+
 	Gump			0xFFFF
 	MinX			40
 	MaxX			60
 	MinY			20
 	MaxY			80
-	
+
 	SpellType		Magic
-	
+
 	Newbie			1
 	BlocksCastingIfInHand	0
 	RequiresAttention	0
 	
 	VendorSellsFor		22
 	VendorBuysFor		11
-	
+
 	Weight			1
-	
+
 	CanRemoveScript		:containers:container/noRemove
 }
 
 //--=[ MAGERY SCROLLS ]=-------------------------
-Item 0x1f2d
+SpellScroll 0x1F2D
 {
 	Name			reactivearmorscroll
 	Desc			Reactive Armor scroll
-	
+
 	SpellId			7
-	
+	SpellType		Magic
+
 	VendorBuysFor		6
 	VendorSellsFor		12
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f2e
+SpellScroll 0x1F2E
 {
 	Name			clumsyscroll
 	Desc			Clumsy scroll
-	
+
 	SpellId			1
-	
+	SpellType		Magic
+
 	VendorBuysFor		6
 	VendorSellsFor		12
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f2f
+SpellScroll 0x1F2F
 {
 	Name			createfoodscroll
 	Desc			Create Food scroll
-	
+
 	SpellId			2
-	
+	SpellType		Magic
+
 	VendorBuysFor		6
 	VendorSellsFor		12
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f30
+SpellScroll 0x1F30
 {
 	Name			feeblemindscroll
 	Desc			Feeblemind scroll
-	
+
 	SpellId			3
-	
+	SpellType		Magic
+
 	VendorBuysFor		6
 	VendorSellsFor		12
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f31
+SpellScroll 0x1F31
 {
 	Name			healscroll
 	Desc			Heal scroll
-	
+
 	SpellId			4
-	
+	SpellType		Magic
+
 	VendorBuysFor		6
 	VendorSellsFor		12
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f32
+SpellScroll 0x1F32
 {
 	Name			magicarrowscroll
 	Desc			Magic Arrow scroll
-	
+
 	SpellId			5
-	
+	SpellType		Magic
+
 	VendorBuysFor		6
 	VendorSellsFor		12
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f33
+SpellScroll 0x1F33
 {
 	Name			nightsightscroll
 	Desc			Nightsight scroll
-	
+
 	SpellId			6
-	
+	SpellType		Magic
+
 	VendorBuysFor		6
 	VendorSellsFor		12
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f34
+SpellScroll 0x1F34
 {
 	Name			weakenscroll
 	Desc			Weaken scroll
-	
+
 	SpellId			8
-	
+	SpellType		Magic
+
 	VendorBuysFor		6
 	VendorSellsFor		12
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f35
+SpellScroll 0x1F35
 {
 	Name			agilityscroll
 	Desc			Agility scroll
-	
+
 	SpellId			9
-	
+	SpellType		Magic
+
 	VendorBuysFor		11
 	VendorSellsFor		22
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f36
+SpellScroll 0x1F36
 {
 	Name			cunningscroll
 	Desc			Cunning scroll
-	
+
 	SpellId			10
-	
+	SpellType		Magic
+
 	VendorBuysFor		11
 	VendorSellsFor		22
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f37
+SpellScroll 0x1F37
 {
 	Name			curescroll
 	Desc			Cure scroll
-	
+
 	SpellId			11
-	
+	SpellType		Magic
+
 	VendorBuysFor		11
 	VendorSellsFor		22
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f38
+SpellScroll 0x1F38
 {
 	Name			harmscroll
 	Desc			Harm scroll
-	
+
 	SpellId			12
-	
+	SpellType		Magic
+
 	VendorBuysFor		11
 	VendorSellsFor		22
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f39
+SpellScroll 0x1F39
 {
 	Name			magictrapscroll
 	Desc			Magic Trap scroll
-	
+
 	SpellId			13
-	
+	SpellType		Magic
+
 	VendorBuysFor		11
 	VendorSellsFor		22
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f3a
+SpellScroll 0x1F3A
 {
 	Name			magicuntrapscroll
 	Desc			Magic Untrap scroll
-	
+
 	SpellId			14
-	
+	SpellType		Magic
+
 	VendorBuysFor		11
 	VendorSellsFor		22
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f3b
+SpellScroll 0x1F3B
 {
 	Name			protectionscroll
 	Desc			Protection scroll
-	
+
 	SpellId			15
-	
+	SpellType		Magic
+
 	VendorBuysFor		11
 	VendorSellsFor		22
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f3c
+SpellScroll 0x1F3C
 {
 	Name			strengthscroll
 	Desc			Strength scroll
-	
+
 	SpellId			16
-	
+	SpellType		Magic
+
 	VendorBuysFor		11
 	VendorSellsFor		22
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f3d
+SpellScroll 0x1F3D
 {
 	Name			blessscroll
 	Desc			Bless scroll
-	
+
 	SpellId			17
-	
+	SpellType		Magic
+
 	VendorBuysFor		16
 	VendorSellsFor		32
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f3e
+SpellScroll 0x1F3E
 {
 	Name			fireballscroll
 	Desc			Fireball scroll
-	
+
 	SpellId			18
-	
+	SpellType		Magic
+
 	VendorBuysFor		16
 	VendorSellsFor		32
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f3f
+SpellScroll 0x1F3F
 {
 	Name			magiclockscroll
 	Desc			Magic Lock scroll
-	
+
 	SpellId			19
-	
+	SpellType		Magic
+
 	VendorBuysFor		16
 	VendorSellsFor		32
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f40
+SpellScroll 0x1F40
 {
 	Name			poisonscroll
 	Desc			Poison scroll
-	
+
 	SpellId			20
-	
+	SpellType		Magic
+
 	VendorBuysFor		16
 	VendorSellsFor		32
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f41
+SpellScroll 0x1F41
 {
 	Name			telekinesisscroll
 	Desc			Telekinesis scroll
-	
+
 	SpellId			21
-	
+	SpellType		Magic
+
 	VendorBuysFor		16
 	VendorSellsFor		32
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f42
+SpellScroll 0x1F42
 {
 	Name			teleportscroll
 	Desc			Teleport scroll
-	
+
 	SpellId			22
-	
+	SpellType		Magic
+
 	VendorBuysFor		16
 	VendorSellsFor		32
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f43
+SpellScroll 0x1F43
 {
 	Name			magicunlockscroll
 	Desc			Magic Unlock scroll
-	
+
 	SpellId			23
-	
+	SpellType		Magic
+
 	VendorBuysFor		16
 	VendorSellsFor		32
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f44
+SpellScroll 0x1F44
 {
 	Name			wallofstonescroll
 	Desc			Wall of Stone scroll
-	
+
 	SpellId			24
-	
+	SpellType		Magic
+
 	VendorBuysFor		16
 	VendorSellsFor		32
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f45
+SpellScroll 0x1F45
 {
 	Name			archcurescroll
 	Desc			Archcure scroll
-	
+
 	SpellId			25
-	
+	SpellType		Magic
+
 	VendorBuysFor		21
 	VendorSellsFor		42
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f46
+SpellScroll 0x1F46
 {
 	Name			archprotectionscroll
 	Desc			Archprotection scroll
-	
+
 	SpellId			26
-	
+	SpellType		Magic
+
 	VendorBuysFor		21
 	VendorSellsFor		42
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f47
+SpellScroll 0x1F47
 {
 	Name			cursecroll
 	Desc			Curse scroll
-	
+
 	SpellId			27
-	
+	SpellType		Magic
+
 	VendorBuysFor		21
 	VendorSellsFor		42
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f48
+SpellScroll 0x1F48
 {
 	Name			firefieldscroll
 	Desc			Firefield scroll
-	
+
 	SpellId			28
-	
+	SpellType		Magic
+
 	VendorBuysFor		21
 	VendorSellsFor		42
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f49
+SpellScroll 0x1F49
 {
 	Name			greaterhealscroll
 	Desc			Greater Heal scroll
-	
+
 	SpellId			29
-	
+	SpellType		Magic
+
 	VendorBuysFor		21
 	VendorSellsFor		42
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f4a
+SpellScroll 0x1F4A
 {
 	Name			lightningscroll
 	Desc			Lightning scroll
-	
+
 	SpellId			30
-	
+	SpellType		Magic
+
 	VendorBuysFor		21
 	VendorSellsFor		42
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f4b
+SpellScroll 0x1F4B
 {
 	Name			manadrainscroll
 	Desc			Manadrain scroll
-	
+
 	SpellId			31
-	
+	SpellType		Magic
+
 	VendorBuysFor		21
 	VendorSellsFor		42
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f4c
+SpellScroll 0x1F4C
 {
 	Name			recallscroll
 	Desc			Recall scroll
-	
+
 	SpellId			32
-	
+	SpellType		Magic
+
 	VendorBuysFor		21
 	VendorSellsFor		42
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f4d
+SpellScroll 0x1F4D
 {
 	Name			bladespiritscroll
 	Desc			Blade Spirit scroll
-	
+
 	SpellId			33
-	
+	SpellType		Magic
+
 	VendorBuysFor		26
 	VendorSellsFor		52
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f4e
+SpellScroll 0x1F4E
 {
 	Name			dispelfieldscroll
 	Desc			Dispel Field scroll
-	
+
 	SpellId			34
-	
+	SpellType		Magic
+
 	VendorBuysFor		26
 	VendorSellsFor		52
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f4f
+SpellScroll 0x1F4F
 {
 	Name			incognitoscroll
 	Desc			Incognito scroll
-	
+
 	SpellId			35
-	
+	SpellType		Magic
+
 	VendorBuysFor		26
 	VendorSellsFor		52
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f50
+SpellScroll 0x1F50
 {
 	Name			magicrelfectscroll
 	Desc			Magic Reflect scroll
-	
+
 	SpellId			36
-	
+	SpellType		Magic
+
 	VendorBuysFor		26
 	VendorSellsFor		52
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f51
+SpellScroll 0x1F51
 {
 	Name			mindblastscroll
 	Desc			Mind Blast scroll
-	
+
 	SpellId			37
-	
+	SpellType		Magic
+
 	VendorBuysFor		26
 	VendorSellsFor		52
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f52
+SpellScroll 0x1F52
 {
 	Name			paralyzescroll
 	Desc			Paralyze scroll
-	
+
 	SpellId			38
-	
+	SpellType		Magic
+
 	VendorBuysFor		26
 	VendorSellsFor		52
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f53
+SpellScroll 0x1F53
 {
 	Name			poisonfieldscroll
 	Desc			Poison Field scroll
-	
+
 	SpellId			39
-	
+	SpellType		Magic
+
 	VendorBuysFor		26
 	VendorSellsFor		52
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f54
+SpellScroll 0x1F54
 {
 	Name			summoncreaturescroll
 	Desc			Summon Creature scroll
-	
+
 	SpellId			40
-	
+	SpellType		Magic
+
 	VendorBuysFor		26
 	VendorSellsFor		52
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f55
+SpellScroll 0x1F55
 {
 	Name			dispelscroll
 	Desc			Dispel scroll
-	
+
 	SpellId			41
-	
+	SpellType		Magic
+
 	VendorBuysFor		31
 	VendorSellsFor		62
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f56
+SpellScroll 0x1F56
 {
 	Name			energyboltscroll
 	Desc			Energy Bolt scroll
-	
+
 	SpellId			42
-	
+	SpellType		Magic
+
 	VendorBuysFor		31
 	VendorSellsFor		62
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f57
+SpellScroll 0x1F57
 {
 	Name			explosionscroll
 	Desc			Explosion scroll
-	
+
 	SpellId			43
-	
+	SpellType		Magic
+
 	VendorBuysFor		31
 	VendorSellsFor		62
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f58
+SpellScroll 0x1F58
 {
 	Name			invisibilityscroll
 	Desc			Invisibility scroll
-	
+
 	SpellId			44
-	
+	SpellType		Magic
+
 	VendorBuysFor		31
 	VendorSellsFor		62
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f59
+SpellScroll 0x1F59
 {
 	Name			markscroll
 	Desc			Mark scroll
-	
+
 	SpellId			45
-	
+	SpellType		Magic
+
 	VendorBuysFor		31
 	VendorSellsFor		62
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f5a
+SpellScroll 0x1F5A
 {
 	Name			masscursescroll
 	Desc			Mass Curse scroll
-	
+
 	SpellId			46
-	
+	SpellType		Magic
+
 	VendorBuysFor		31
 	VendorSellsFor		62
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f5b
+SpellScroll 0x1F5B
 {
 	Name			paralyzefieldscroll
 	Desc			Paralyze Field scroll
-	
+
 	SpellId			47
-	
+	SpellType		Magic
+
 	VendorBuysFor		31
 	VendorSellsFor		62
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f5c
+SpellScroll 0x1F5C
 {
 	Name			revealscroll
 	Desc			Reveal scroll
-	
+
 	SpellId			48
-	
+	SpellType		Magic
+
 	VendorBuysFor		31
 	VendorSellsFor		62
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f5d
+SpellScroll 0x1F5D
 {
 	Name			chainlightningscroll
 	Desc			Chain Lightning scroll
-	
+
 	SpellId			49
-	
+	SpellType		Magic
+
 	VendorBuysFor		36
 	VendorSellsFor		72
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f5e
+SpellScroll 0x1F5E
 {
 	Name			energyfieldscroll
 	Desc			Energy Field scroll
-	
+
 	SpellId			50
-	
+	SpellType		Magic
+
 	VendorBuysFor		36
 	VendorSellsFor		72
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f5f
+SpellScroll 0x1F5F
 {
 	Name			flamestrikescroll
 	Desc			Flamestrike scroll
-	
+
 	SpellId			51
-	
+	SpellType		Magic
+
 	VendorBuysFor		36
 	VendorSellsFor		72
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f60
+SpellScroll 0x1F60
 {
 	Name			gatetravelscroll
 	Desc			Gate Travel scroll
-	
+
 	SpellId			52
-	
+	SpellType		Magic
+
 	VendorBuysFor		36
 	VendorSellsFor		72
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f61
+SpellScroll 0x1F61
 {
 	Name			manavampirescroll
 	Desc			Mana Vampire scroll
-	
+
 	SpellId			53
-	
+	SpellType		Magic
+
 	VendorBuysFor		36
 	VendorSellsFor		72
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f62
+SpellScroll 0x1F62
 {
 	Name			massdispelscroll
 	Desc			Mass Dispel scroll
-	
+
 	SpellId			54
-	
+	SpellType		Magic
+
 	VendorBuysFor		36
 	VendorSellsFor		72
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f63
+SpellScroll 0x1F63
 {
 	Name			meteorswarmscroll
 	Desc			Meteor Swarm scroll
-	
+
 	SpellId			55
-	
+	SpellType		Magic
+
 	VendorBuysFor		36
 	VendorSellsFor		72
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f64
+SpellScroll 0x1F64
 {
 	Name			polymorphscroll
 	Desc			Polymorph scroll
-	
+
 	SpellId			56
-	
+	SpellType		Magic
+
 	VendorBuysFor		36
 	VendorSellsFor		72
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f65
+SpellScroll 0x1F65
 {
 	Name			earthquakescroll
 	Desc			Earthquake scroll
-	
+
 	SpellId			57
-	
+	SpellType		Magic
+
 	VendorBuysFor		41
 	VendorSellsFor		82
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f66
+SpellScroll 0x1F66
 {
 	Name			energyvortexscroll
 	Desc			Energy Vortex scroll
-	
+
 	SpellId			58
-	
+	SpellType		Magic
+
 	VendorBuysFor		41
 	VendorSellsFor		82
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f67
+SpellScroll 0x1F67
 {
 	Name			resurrectionscroll
 	Desc			Resurrection scroll
-	
+
 	SpellId			59
-	
+	SpellType		Magic
+
 	VendorBuysFor		41
 	VendorSellsFor		82
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f68
+SpellScroll 0x1F68
 {
 	Name			summonairelemscroll
 	Desc			Summon Air Elemental scroll
-	
+
 	SpellId			60
-	
+	SpellType		Magic
+
 	VendorBuysFor		41
 	VendorSellsFor		82
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f69
+SpellScroll 0x1F69
 {
 	Name			summondaemonscroll
 	Desc			Summon Daemon scroll
-	
+
 	SpellId			61
-	
+	SpellType		Magic
+
 	VendorBuysFor		41
 	VendorSellsFor		82
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f6a
+SpellScroll 0x1F6A
 {
 	Name			summonearthelemscroll
 	Desc			Summon Earth Elemental scroll
-	
+
 	SpellId			62
-	
+	SpellType		Magic
+
 	VendorBuysFor		41
 	VendorSellsFor		82
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f6b
+SpellScroll 0x1F6B
 {
 	Name			summonfireelemscroll
 	Desc			Summon Fire Elemental scroll
-	
+
 	SpellId			63
-	
+	SpellType		Magic
+
 	VendorBuysFor		41
 	VendorSellsFor		82
-	
+
 	Script			spellScroll/use
 }
 
-Item 0x1f6c
+SpellScroll 0x1F6C
 {
 	Name			summonwaterelemscroll
 	Desc			Summon Water Elemental scroll
-	
+
 	SpellId			64
-	
+	SpellType		Magic
+
 	VendorBuysFor		41
 	VendorSellsFor		82
-	
+
 	Script			spellScroll/use
 }
\ No newline at end of file

Modified: trunk/096/pkg/systems/attributes/hooks/vitalInit.src
===================================================================
--- trunk/096/pkg/systems/attributes/hooks/vitalInit.src	2005-11-06 00:03:23 UTC (rev 918)
+++ trunk/096/pkg/systems/attributes/hooks/vitalInit.src	2005-11-06 09:23:16 UTC (rev 919)
@@ -18,7 +18,7 @@
 include ":brainAI:include/npcUtil";
 
 program Install()
-	print("INSTALLED: Exported Vital - RegenRate and MaxValue functions... ok.");
+	print("INSTALLING: Exported Vital - RegenRate and MaxValue functions ...");
 	return 1;
 endprogram
 

Modified: trunk/096/pkg/systems/combat/hooks/combatAdv.src
===================================================================
--- trunk/096/pkg/systems/combat/hooks/combatAdv.src	2005-11-06 00:03:23 UTC (rev 918)
+++ trunk/096/pkg/systems/combat/hooks/combatAdv.src	2005-11-06 09:23:16 UTC (rev 919)
@@ -5,7 +5,7 @@
 use uo;
 
 program hook_startup()
-	print("INSTALLED: Combat Advancement hook... ok.");
+	print("INSTALLING: Combat Advancement hook... ");
 	return 1;
 endprogram
 

Modified: trunk/096/pkg/systems/combat/hooks/parryAdv.src
===================================================================
--- trunk/096/pkg/systems/combat/hooks/parryAdv.src	2005-11-06 00:03:23 UTC (rev 918)
+++ trunk/096/pkg/systems/combat/hooks/parryAdv.src	2005-11-06 09:23:16 UTC (rev 919)
@@ -5,7 +5,7 @@
 use os;
 
 program hook_startup()
-	print("INSTALLED: Parry hook... ok.");
+	print("INSTALLING: Parry hook...");
 	return 1;
 endprogram
 



From austin at berlios.de  Sun Nov  6 11:14:21 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 11:14:21 +0100
Subject: [Poldistro-svn] r920 - in trunk/096/pkg: items/food items/food/config items/food/include skills/magery skills/magery/spellScripts/circle1
Message-ID: <200511061014.jA6AEL69012241@sheep.berlios.de>

Author: austin
Date: 2005-11-06 11:14:09 +0100 (Sun, 06 Nov 2005)
New Revision: 920

Added:
   trunk/096/pkg/items/food/config/food.cfg
   trunk/096/pkg/items/food/include/
   trunk/096/pkg/items/food/include/food.inc
   trunk/096/pkg/skills/magery/spellScripts/circle1/createFood.src
Removed:
   trunk/096/pkg/items/food/food.cfg
Modified:
   trunk/096/pkg/skills/magery/spellStarter.src
   trunk/096/pkg/skills/magery/spells.cfg
Log:
Added food.inc to more easily use existing food.cfg
Moved food.cfg to the /config/ directory of its package.

Added createFood.src spell

Updated spells.cfg to have an entry to their spell scripts.

Added: trunk/096/pkg/items/food/config/food.cfg
===================================================================
--- trunk/096/pkg/items/food/config/food.cfg	2005-11-06 09:23:16 UTC (rev 919)
+++ trunk/096/pkg/items/food/config/food.cfg	2005-11-06 10:14:09 UTC (rev 920)
@@ -0,0 +1,116 @@
+Food veggie
+{
+	Food	0xF36
+	Food	0xD3A
+	Food	0xD39
+	Food	0xC82
+	Food	0xC81
+	Food	0xC80
+	Food	0xC7F
+	Food	0xC7C
+	Food	0xC7B
+	Food	0xC7A
+	Food	0xC79
+	Food	0xC78
+	Food	0xC77
+	Food	0xC75
+	Food	0xC74
+	Food	0xC73
+	Food	0xC72
+	Food	0xC71
+	Food	0xC70
+	Food	0xC6E
+	Food	0xC6D
+	Food	0xC6C
+	Food	0xC6B
+	Food	0xC6A
+	Food	0xC67
+	Food	0xC66
+	Food	0xC65
+	Food	0xC64
+	Food	0xC5D
+	Food	0xC5C
+	Food	0x9D2
+	Food	0x9D1
+	Food	0x9D0
+	Food	0x1EBF
+	Food	0x1EBE
+	Food	0x1EBD
+	Food	0x1A96
+	Food	0x1A95
+	Food	0x1A94
+	Food	0x1A93
+	Food	0x1A92
+	Food	0x172D
+	Food	0x172C
+	Food	0x172B
+	Food	0x172A
+	Food	0x1729
+	Food	0x1728
+	Food	0x1727
+	Food	0x1726
+	Food	0x1725
+	Food	0x1724
+	Food	0x1723
+	Food	0x1722
+	Food	0x1721
+	Food	0x1720
+	Food	0x171F
+	Food	0x171E
+	Food	0x171D
+	Food	0x100D
+	Food	0x100C
+
+}
+
+Food meat
+{
+	Food	9x9C9
+	Food	0xDD9
+	Food	0xDD8
+	Food	0xDD7
+	Food	0xDD6
+	Food	0x9F1
+	Food	0x9CF
+	Food	0x9CE
+	Food	0x9CD
+	Food	0x9CC
+	Food	0x9B9
+}
+
+Food grain
+{
+	Food	0xC5B
+	Food	0xC5A
+	Food	0xC58
+	Food	0xC57
+	Food	0xC56
+	Food	0x1EBD
+}
+
+Food metal
+{
+	Food	0x6308
+	Food	0x6307
+	Food	0x6306
+	Food	0x6305
+	Food	0x6304
+	Food	0x6303
+	Food	0x6302
+	Food	0x6301
+	Food	0x6300
+}
+
+Food fish
+{
+	Food	0xDD9
+	Food	0xDD8
+	Food	0xDD7
+	Food	0xDD6
+	Food	0x9CF
+	Food	0x9CE
+	Food	0x9CD
+	Food	0x9CC
+	Food	0x97B
+	Food	0x97A
+}

Deleted: trunk/096/pkg/items/food/food.cfg
===================================================================
--- trunk/096/pkg/items/food/food.cfg	2005-11-06 09:23:16 UTC (rev 919)
+++ trunk/096/pkg/items/food/food.cfg	2005-11-06 10:14:09 UTC (rev 920)
@@ -1,217 +0,0 @@
-food veggie
-{
-  food 0x09d0
-  food 0x09d1
-  food 0x09d2
-  food 0x0c5c
-  food 0x0c5d
-  food 0x0c64
-  food 0x0c65
-  food 0x0c66
-  food 0x0c67
-  food 0x0c6a
-  food 0x0c6b
-  food 0x0c6c
-  food 0x0c6d
-  food 0x0c6e
-  food 0x0c70
-  food 0x0c71
-  food 0x0c72
-  food 0x0c73
-  food 0x0c74
-  food 0x0c75
-  food 0x0c77
-  food 0x0c78
-  food 0x0c79
-  food 0x0c7a
-  food 0x0c7b
-  food 0x0c7c
-  food 0x0c7f
-  food 0x0c80
-  food 0x0c81
-  food 0x0c82
-  food 0x0d39
-  food 0x0d3a
-  food 0x0f36
-  food 0x100c
-  food 0x100d
-  food 0x171d
-  food 0x171e
-  food 0x171f
-  food 0x1720
-  food 0x1721
-  food 0x1722
-  food 0x1723
-  food 0x1724
-  food 0x1725
-  food 0x1726
-  food 0x1727
-  food 0x1728
-  food 0x1729
-  food 0x172a
-  food 0x172b
-  food 0x172c
-  food 0x172d
-  food 0x1a92
-  food 0x1a93
-  food 0x1a94
-  food 0x1a95
-  food 0x1a96
-  food 0x1ebd
-  food 0x1ebe
-  food 0x1ebf
-}
-
-food meat
-{
-  food 0x9f1
-  food 0x9b9
-  food 0x09cc
-  food 0x09cd
-  food 0x09ce
-  food 0x09cf
-  food 0x0dd6
-  food 0x0dd7
-  food 0x0dd8
-  food 0x0dd9
-  food 9x9c9
-}
-
-food grain
-{
-  food 0x1ebd
-  food 0xc56
-  food 0xc57
-  food 0xc58
-  food 0xc5a
-  food 0xc5b
-}
-
-food metal
-{
-  food 0x6300
-  food 0x6301
-  food 0x6302
-  food 0x6303
-  food 0x6304
-  food 0x6305
-  food 0x6306
-  food 0x6307
-  food 0x6308
-}
-
-food fish
-{
-  food 0x97a
-  food 0x97b
-  food 0x9cc
-  food 0x9cd
-  food 0x9ce
-  food 0x9cf
-  food 0xdd6
-  food 0xdd7
-  food 0xdd8
-  food 0xdd9
-}
-
-food all
-{
-  food 0x09d0
-  food 0x09d1
-  food 0x09d2
-  food 0x0c5c
-  food 0x0c5d
-  food 0x0c64
-  food 0x0c65
-  food 0x0c66
-  food 0x0c67
-  food 0x0c6a
-  food 0x0c6b
-  food 0x0c6c
-  food 0x0c6d
-  food 0x0c6e
-  food 0x0c70
-  food 0x0c71
-  food 0x0c72
-  food 0x0c73
-  food 0x0c74
-  food 0x0c75
-  food 0x0c77
-  food 0x0c78
-  food 0x0c79
-  food 0x0c7a
-  food 0x0c7b
-  food 0x0c7c
-  food 0x0c7f
-  food 0x0c80
-  food 0x0c81
-  food 0x0c82
-  food 0x0d39
-  food 0x0d3a
-  food 0x0f36
-  food 0x100c
-  food 0x100d
-  food 0x171d
-  food 0x171e
-  food 0x171f
-  food 0x1720
-  food 0x1721
-  food 0x1722
-  food 0x1723
-  food 0x1724
-  food 0x1725
-  food 0x1726
-  food 0x1727
-  food 0x1728
-  food 0x1729
-  food 0x172a
-  food 0x172b
-  food 0x172c
-  food 0x172d
-  food 0x1a92
-  food 0x1a93
-  food 0x1a94
-  food 0x1a95
-  food 0x1a96
-  food 0x1ebd
-  food 0x1ebe
-  food 0x1ebf
-  food 0x9f1
-  food 0x9b9
-  food 0x09cc
-  food 0x09cd
-  food 0x09ce
-  food 0x09cf
-  food 0x0dd6
-  food 0x0dd7
-  food 0x0dd8
-  food 0x0dd9
-  food 9x9c9
-  food 0x1ebd
-  food 0xc56
-  food 0xc57
-  food 0xc58
-  food 0xc5a
-  food 0xc5b
-  food 0x6300
-  food 0x6301
-  food 0x6302
-  food 0x6303
-  food 0x6304
-  food 0x6305
-  food 0x6306
-  food 0x6307
-  food 0x6308
-  food 0x97a
-  food 0x97b
-  food 0x9cc
-  food 0x9cd
-  food 0x9ce
-  food 0x9cf
-  food 0xdd6
-  food 0xdd7
-  food 0xdd8
-  food 0xdd9
-}
-
-

Added: trunk/096/pkg/items/food/include/food.inc
===================================================================
--- trunk/096/pkg/items/food/include/food.inc	2005-11-06 09:23:16 UTC (rev 919)
+++ trunk/096/pkg/items/food/include/food.inc	2005-11-06 10:14:09 UTC (rev 920)
@@ -0,0 +1,40 @@
+/*
+ * $Id$
+ *
+ */
+
+use os;
+use util;
+use cfgfile;
+
+/*
+ * RandomFoodObjType(category:="All")
+ *
+ * Purpose
+ * Selects an objtype from food.cfg
+ *
+ * Parameters
+ * category:	Elem to use in food.cfg
+ *
+ * Return value
+ * Returns a number.
+ *
+ */
+function RandomFoodObjType(category:=0)
+	var cfg_file := ReadConfigFile(":food:config/food");
+	
+	var food_list := array{};
+	if ( category )
+		var cfg_elem := cfg_file[category];
+		food_list := GetConfigStringArray(cfg_elem, "Food");
+	else
+		food_list := array{};
+		foreach elem_name in ( GetConfigStringKeys(cfg_file) )
+			var cfg_elem := cfg_file[elem_name];
+			food_list := food_list + GetConfigStringArray(cfg_elem, "Food");
+			sleepms(2);
+		endforeach
+	endif
+	
+	return food_list[RandomInt(food_list.size())+1];
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/spellScripts/circle1/createFood.src
===================================================================
--- trunk/096/pkg/skills/magery/spellScripts/circle1/createFood.src	2005-11-06 09:23:16 UTC (rev 919)
+++ trunk/096/pkg/skills/magery/spellScripts/circle1/createFood.src	2005-11-06 10:14:09 UTC (rev 920)
@@ -0,0 +1,27 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+
+include ":attributes:attributes";
+include ":magery:spells";
+include ":food&drink:food";
+
+program SpellScript(params)
+	var who := params[1];
+	//var info := params[2];
+	params := 0; // No longer needed
+	
+	var food_item := RandomFoodObjType();
+	
+	var food := CreateItemInBackPack(who, food_item, 1);
+	
+	if ( food.errortext )
+		SendSysMessage(who, "Error creating food ->"+food.errortext);
+	endif
+	
+	return 1;
+endprogram

Modified: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-06 09:23:16 UTC (rev 919)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-06 10:14:09 UTC (rev 920)
@@ -47,16 +47,16 @@
 		SendSysMessage(who, "Something prevents you from casting.");
 		FailSpell(who);
 		return 0;
-	elseif ( !ConsumeVital(who, MANA, spell_elem.ManaCost) )
+	elseif ( !EquipmentCheck(who) )
+		FailSpell(who);
+		return 0;
+	elseif ( !AP_ConsumeVital(who, MANA, spell_elem.ManaCost) )
 		SendSysMessage(who, "You are too tired to cast.");
 		FailSpell(who);
 		return 0;
 	elseif ( !CheckReagents(who, spell_elem, scroll) )
 		FailSpell(who);
 		return 0;
-	elseif ( !EquipmentCheck(who) )
-		FailSpell(who);
-		return 0;
 	elseif ( !CheckDelay(who, spell_elem) )
 		FailSpell(who);
 		SendSysMessage(who, "Your concentration has been broken.");

Modified: trunk/096/pkg/skills/magery/spells.cfg
===================================================================
--- trunk/096/pkg/skills/magery/spells.cfg	2005-11-06 09:23:16 UTC (rev 919)
+++ trunk/096/pkg/skills/magery/spells.cfg	2005-11-06 10:14:09 UTC (rev 920)
@@ -3,6 +3,7 @@
 	SpellId		1
 	Name		Clumsy
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle1/clumsy
 
 	ManaCost	0
 	Delay		0
@@ -19,6 +20,7 @@
 	SpellId		2
 	Name		Create Food
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle1/createFood
 
 	ManaCost	0
 	Delay		0
@@ -36,6 +38,7 @@
 	SpellId		3
 	Name		Feeblemind
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle1/feebleMind
 
 	ManaCost	0
 	Delay		0
@@ -52,6 +55,7 @@
 	SpellId		4
 	Name		Heal
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle1/heal
 
 	ManaCost	0
 	Delay		0
@@ -69,6 +73,7 @@
 	SpellId		5
 	Name		Magic Arrow
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle1/magicArrow
 
 	PowerWords	In Por Ylem
 	Circle		1
@@ -82,6 +87,7 @@
 	SpellId		6
 	Name		Night Sight
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle1/nightSight
 
 	PowerWords	In Lor
 	Circle		1
@@ -95,6 +101,7 @@
 	SpellId		7
 	Name		Reactive Armor
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle1/reactiveArmor
 	
 	PowerWords	Flam Sanct
 	Circle		1
@@ -109,6 +116,7 @@
 	SpellId		8
 	Name		Weaken
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle1/weaken
 	
 	PowerWords	Des Mani
 	Circle		1
@@ -122,6 +130,7 @@
 	SpellId		9
 	Name		Agility
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle2/agility
 	
 	PowerWords	Ex Uus
 	Circle		2
@@ -135,6 +144,7 @@
 	SpellId		10
 	Name		Cunning
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle2/cunning
 	
 	PowerWords	Uus Wis
 	Circle		2
@@ -148,6 +158,7 @@
 	SpellId		11
 	Name		Cure
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle2/cure
 	
 	PowerWords	An Nox
 	Circle		2
@@ -161,6 +172,7 @@
 	SpellId		12
 	Name		Harm
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle2/harm
 	
 	PowerWords	An Mani
 	Circle		2
@@ -174,6 +186,7 @@
 	SpellId		13
 	Name		Magic Trap
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle2/magicTrap
 	
 	PowerWords	In Jux
 	Circle		2
@@ -188,6 +201,7 @@
 	SpellId		14
 	Name		Magic Untrap
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle2/magicUntrap
 	
 	PowerWords	An Jux
 	Circle		2
@@ -202,6 +216,7 @@
 	SpellId		15
 	Name		Protection
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle2/protection
 	
 	PowerWords	Uus Sanct
 	Circle		2
@@ -216,6 +231,7 @@
 	SpellId		16
 	Name		Strength
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle2/strength
 	
 	PowerWords	Uus Mani
 	Circle		2
@@ -229,6 +245,7 @@
 	SpellId		17
 	Name		Bless
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle3/bless
 	
 	PowerWords	Rel Sanct
 	Circle		3
@@ -242,6 +259,7 @@
 	SpellId		18
 	Name		Fireball
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle23/fireBall
 	
 	PowerWords	Vas Flam
 	Circle		3
@@ -255,6 +273,7 @@
 	SpellId		19
 	Name		Magic Lock
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle3/magicLock
 	
 	PowerWords	An Por
 	Circle		3
@@ -269,6 +288,7 @@
 	SpellId		20
 	Name		Poison
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle3/magicUnlock
 	
 	PowerWords	In Nox
 	Circle		3
@@ -281,6 +301,7 @@
 	SpellId		21
 	Name		Telekinesis
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle3/telekinesis
 	
 	PowerWords	Ort Por Ylem
 	Circle		3
@@ -294,6 +315,7 @@
 	SpellId		22
 	Name		Teleport
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle3/teleport
 	
 	PowerWords	Rel Por
 	Circle		3
@@ -307,6 +329,7 @@
 	SpellId		23
 	Name		Unlock
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle3/unlock
 	
 	PowerWords	Ex Por
 	Circle		3
@@ -320,6 +343,7 @@
 	SpellId		24
 	Name		Wall of Stone
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle3/wallofStone
 	
 	PowerWords	In Sanct Ylem
 	Circle		3
@@ -333,6 +357,7 @@
 	SpellId		25
 	Name		Arch Cure
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle4/archCure
 	
 	PowerWords	Vas An Nox
 	Circle		4
@@ -347,6 +372,7 @@
 	SpellId		26
 	Name		Arch Protection
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle4/archProtection
 	
 	PowerWords	Vas Uus Sanct
 	Circle		4
@@ -362,6 +388,7 @@
 	SpellId		27
 	Name		Curse
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle4/curse
 	
 	PowerWords	Des Sanct
 	Circle		4
@@ -376,6 +403,7 @@
 	SpellId		28
 	Name		Fire Field
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle4/fireField
 	
 	PowerWords	In Flam Grav
 	Circle		4
@@ -390,6 +418,7 @@
 	SpellId		29
 	Name		Greater Heal
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle4/greaterHeal
 	
 	PowerWords	In Vas Mani
 	Circle		4
@@ -405,6 +434,7 @@
 	SpellId		30
 	Name		Lightning
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle4/lightning
 	
 	PowerWords	Por Ort Grav
 	Circle		4
@@ -419,6 +449,7 @@
 	SpellId		31
 	Name		Mana Drain
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle4/manaDrain
 	
 	PowerWords	Ort Rel
 	Circle		4
@@ -433,6 +464,7 @@
 	SpellId		32
 	Name		Recall
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle4/recall
 	
 	PowerWords	Kal Ort Por
 	Circle		4
@@ -447,6 +479,7 @@
 	SpellId		33
 	Name		Blade Spirit
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle5/bladeSpirit
 	
 	PowerWords	In Jux Hur Ylem
 	Circle		5
@@ -461,6 +494,7 @@
 	SpellId		34
 	Name		Dispel Field
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle5/dispelField
 	
 	PowerWords	An Grav
 	Circle		5
@@ -476,6 +510,7 @@
 	SpellId		35
 	Name		Incognito
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle5/incognito
 	
 	PowerWords	Kal In Ex
 	Circle		5
@@ -490,6 +525,7 @@
 	SpellId		36
 	Name		Spell Reflection
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle5/spellReflection
 	
 	PowerWords	In Jux Sanct
 	Circle		5
@@ -504,6 +540,7 @@
 	SpellId		37
 	Name		Mind Blast
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle5/mindBlast
 	
 	PowerWords	Por Corp Wis
 	Circle		5
@@ -519,6 +556,7 @@
 	SpellId		38
 	Name		Paralyze
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle5/paralyze
 	
 	PowerWords	An Ex Por
 	Circle		5
@@ -533,6 +571,7 @@
 	SpellId		39
 	Name		Poison Field
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle5/poisonField
 	
 	PowerWords	In Nox Grav
 	Circle		5
@@ -547,6 +586,7 @@
 	SpellId		40
 	Name		SummonCreature
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle5/summonCreature
 	
 	PowerWords	Kal Xen
 	Circle		5
@@ -561,6 +601,7 @@
 	SpellId		41
 	Name		Dispel
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle6/dispel
 	
 	PowerWords	An Ort
 	Circle		6
@@ -575,6 +616,7 @@
 	SpellId		42
 	Name		Energy Bolt
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle6/energyBolt
 	
 	PowerWords	Corp Por
 	Circle		6
@@ -588,6 +630,7 @@
 	SpellId		43
 	Name		Explosion
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle6/explosion
 	
 	PowerWords	Vas Ort Flam
 	Circle		6
@@ -602,6 +645,7 @@
 	SpellId		44
 	Name		Invisibility
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle6/invisibility
 	
 	PowerWords	An Lor Xen
 	Circle		6
@@ -615,6 +659,7 @@
 	SpellId		45
 	Name		Mark
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle6/mark
 	
 	PowerWords	Kal Por Ylem
 	Circle		6
@@ -629,6 +674,7 @@
 	SpellId		46
 	Name		Mass Curse
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle6/massCurse
 	
 	PowerWords	Vas Des Sanct
 	Circle		6
@@ -644,6 +690,7 @@
 	SpellId		47
 	Name		Paralyze Field
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle6/paralyzeField
 	
 	PowerWords	In Ex Grav
 	Circle		6
@@ -658,6 +705,7 @@
 	SpellId		48
 	Name		Reveal
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle6/reveal
 	
 	PowerWords	Wis  Quas
 	Circle		6
@@ -671,6 +719,7 @@
 	SpellId		49
 	Name		Chain Lightning
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle7/chainLightning
 	
 	PowerWords	Vas Ort Grav
 	Circle		7
@@ -686,6 +735,7 @@
 	SpellId		50
 	Name		Energy Field
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle7/energyField
 	
 	PowerWords	In Sanct Grav
 	Circle		7
@@ -701,6 +751,7 @@
 	SpellId		51
 	Name		FlameStrike
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle7/flameStrike
 	
 	PowerWords	Kal Vas Flam
 	Circle		7
@@ -714,6 +765,7 @@
 	SpellId		52
 	Name		Gate
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle7/gate
 	
 	PowerWords	Vas Rel Por
 	Circle		7
@@ -728,6 +780,7 @@
 	SpellId		53
 	Name		Mana Vampire
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle7/manaVampire
 	
 	PowerWords	Ort Sanct
 	Circle		7
@@ -743,6 +796,7 @@
 	SpellId		54
 	Name		Mass Dispel
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle7/massDispel
 	
 	PowerWords	Vas An Ort
 	Circle		7
@@ -758,6 +812,7 @@
 	SpellId		55
 	Name		Meteor Swarm
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle7/meteorSwarm
 	
 	PowerWords	Kal Des Flam Ylem
 	Circle		7
@@ -773,6 +828,7 @@
 	SpellId		56
 	Name		Polymorph
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle7/polymorph
 	
 	PowerWords	Vas Ylem Rel
 	Circle		7
@@ -787,6 +843,7 @@
 	SpellId		57
 	Name		Earthquake
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle8/earthquake
 	
 	PowerWords	In Vas Por
 	Circle		8
@@ -802,6 +859,7 @@
 	SpellId		58
 	Name		EnergyVortex
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle8/energyVortex
 	
 	PowerWords	Vas Corp Por
 	Animation	0x11
@@ -818,6 +876,7 @@
 	SpellId		59
 	Name		Resurrection
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle8/resurrection
 	
 	PowerWords	An Corp
 	Circle		8
@@ -832,6 +891,7 @@
 	SpellId		60
 	Name		Summon Air Elemental
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle8/summonAirElemental
 	
 	Animation	0x11
 	PowerWords	Kal Vas Xen Hur
@@ -847,6 +907,7 @@
 	SpellId		61
 	Name		Summon Daemon
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle8/summonDeamon
 	
 	Animation	0x11
 	PowerWords	Kal Vas Xen Corp
@@ -863,6 +924,7 @@
 	SpellId		62
 	Name		Summon Earth Elemental
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle8/summonEarthElemental
 	
 	Animation	0x11
 	PowerWords	Kal Vas Xen Ylem
@@ -878,6 +940,7 @@
 	SpellId		63
 	Name		Summon Fire Elemental
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle8/summonFireElemental
 	
 	Animation	0x11
 	PowerWords	Kal Vas Xen Flam
@@ -894,6 +957,7 @@
 	SpellId		64
 	Name		Summon Water Elemental
 	Script		spellBook/castSpell
+	SpellScript	spellScripts/circle8/summonWaterElemental
 	
 	Animation	0x11
 	PowerWords	Kal Vas Xen An Flam



From austin at berlios.de  Sun Nov  6 11:46:43 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 11:46:43 +0100
Subject: [Poldistro-svn] r921 - in trunk/096/pkg: items/food/config items/food/include skills/magery skills/magery/spellScripts/circle1
Message-ID: <200511061046.jA6Akh9G022779@sheep.berlios.de>

Author: austin
Date: 2005-11-06 11:46:41 +0100 (Sun, 06 Nov 2005)
New Revision: 921

Modified:
   trunk/096/pkg/items/food/config/food.cfg
   trunk/096/pkg/items/food/include/food.inc
   trunk/096/pkg/skills/magery/spellScripts/circle1/createFood.src
   trunk/096/pkg/skills/magery/spellStarter.src
   trunk/096/pkg/skills/magery/spells.cfg
Log:
Updates to food.cfg (removed ore...?!)

Updated food.inc to point to the right config path.

Updated spells.cfg so every entry has a ManaCost, Difficulty and Delay entry.


Modified: trunk/096/pkg/items/food/config/food.cfg
===================================================================
--- trunk/096/pkg/items/food/config/food.cfg	2005-11-06 10:14:09 UTC (rev 920)
+++ trunk/096/pkg/items/food/config/food.cfg	2005-11-06 10:46:41 UTC (rev 921)
@@ -60,7 +60,6 @@
 	Food	0x171D
 	Food	0x100D
 	Food	0x100C
-
 }
 
 Food meat
@@ -88,19 +87,6 @@
 	Food	0x1EBD
 }
 
-Food metal
-{
-	Food	0x6308
-	Food	0x6307
-	Food	0x6306
-	Food	0x6305
-	Food	0x6304
-	Food	0x6303
-	Food	0x6302
-	Food	0x6301
-	Food	0x6300
-}
-
 Food fish
 {
 	Food	0xDD9

Modified: trunk/096/pkg/items/food/include/food.inc
===================================================================
--- trunk/096/pkg/items/food/include/food.inc	2005-11-06 10:14:09 UTC (rev 920)
+++ trunk/096/pkg/items/food/include/food.inc	2005-11-06 10:46:41 UTC (rev 921)
@@ -21,20 +21,29 @@
  *
  */
 function RandomFoodObjType(category:=0)
-	var cfg_file := ReadConfigFile(":food:config/food");
+	var cfg_file := ReadConfigFile(":food&drink:config/food");
+	if ( cfg_file.errortext )
+		return error{"errortext":="Unable to read food.cfg ->"+cfg_file.errortext};
+	endif
 	
 	var food_list := array{};
 	if ( category )
 		var cfg_elem := cfg_file[category];
 		food_list := GetConfigStringArray(cfg_elem, "Food");
 	else
-		food_list := array{};
 		foreach elem_name in ( GetConfigStringKeys(cfg_file) )
 			var cfg_elem := cfg_file[elem_name];
-			food_list := food_list + GetConfigStringArray(cfg_elem, "Food");
+			var temp_list := GetConfigStringArray(cfg_elem, "Food");
+			if ( temp_list.Size() > 0 )
+				food_list := food_list + temp_list;
+			endif
 			sleepms(2);
 		endforeach
 	endif
 	
-	return food_list[RandomInt(food_list.size())+1];
+	if ( food_list.Size() > 0 )
+		return CInt(food_list[RandomInt(food_list.Size())+1]);
+	else
+		return error{"errortext":="No food items found in food.cfg"};
+	endif
 endfunction
\ No newline at end of file

Modified: trunk/096/pkg/skills/magery/spellScripts/circle1/createFood.src
===================================================================
--- trunk/096/pkg/skills/magery/spellScripts/circle1/createFood.src	2005-11-06 10:14:09 UTC (rev 920)
+++ trunk/096/pkg/skills/magery/spellScripts/circle1/createFood.src	2005-11-06 10:46:41 UTC (rev 921)
@@ -18,9 +18,10 @@
 	var food_item := RandomFoodObjType();
 	
 	var food := CreateItemInBackPack(who, food_item, 1);
+	food.movable := 1;
 	
 	if ( food.errortext )
-		SendSysMessage(who, "Error creating food ->"+food.errortext);
+		SendSysMessage(who, "Error creating food ("+food_item+") ->"+food.errortext);
 	endif
 	
 	return 1;

Modified: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-06 10:14:09 UTC (rev 920)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-06 10:46:41 UTC (rev 921)
@@ -20,7 +20,10 @@
 	var targ	:= params[4]; // NPC target
 	params := 0;	// No longer needed
 	
-	Attach(who);
+	if ( !Attach(who) )
+		SendSysMessage(who, "You are already doing something.");
+		return 0;
+	endif
 	
 	var spell_elem := MS_GetSpellsCfgElem(spell_id);
 
@@ -59,19 +62,18 @@
 		return 0;
 	elseif ( !CheckDelay(who, spell_elem) )
 		FailSpell(who);
-		SendSysMessage(who, "Your concentration has been broken.");
 		return 0;
 	else
-		var attribute		:= spell_elem.Attribute;
+		var attribute := spell_elem.Attribute;
 		if ( !attribute )
 			attribute := MAGERY;
 		endif
 		
-		var difficulty		:= spell_elem.Difficulty;
+		var difficulty := spell_elem.Difficulty;
 		if ( !difficulty )
 			difficulty := -1;
 		endif
-		var skill_check 	:= SkillCheck(who, attribute, difficulty);
+		var skill_check := SkillCheck(who, attribute, difficulty);
 		if ( skill_check > 0 )
 			var info := struct;
 			info.+script		:= spell_elem.script;
@@ -81,11 +83,11 @@
 			info.+pid		:= GetPid();
 			info.+spellId		:= spell_id;
 
-			var script := start_script(spell_elem.Script, {who, info});
+			var script := start_script(spell_elem.SpellScript, {who, info});
 			if ( script.errortext )
-				SendSysMessage(who, "Unable to start ["+spell_elem.script+"] -> "+script.errortext);
+				SendSysMessage(who, "Unable to start ["+spell_elem.SpellScript+"] -> "+script.errortext);
 			endif
-
+			
 			var ev;
 			while( script.pid && !ev )
 				ev := wait_for_event(1);
@@ -95,21 +97,29 @@
 		endif
 	endif
 
+	MS_SpellDebug(who, "Spell starter completed..");
 	EraseObjProperty(who, "#medding");
+	
+	return 1;
 endprogram
 
 function CheckDelay(who, spell_elem)
 	
 	SendSysMessage(who, "You begin building the concentration needed to cast.");
 	
-	var script := start_script("movementCheck", {who, GetPid()});
-	
+	//var script := start_script("movementCheck", {who, GetPid()});
+	//
 	var delay := spell_elem.Delay;
-	MS_SpellDebug(who, "Cast delay ->"+delay);
+	//MS_SpellDebug(who, "Cast delay ->"+delay);
 	sleepms(delay);
-	
-	script.kill();
-	return ( Events_Waiting() > 0 );
+	//
+	//script.kill();
+	if ( Events_Waiting() > 0 )
+		SendSysMessage(who, "Your concentration has been broken.");
+		return 0;
+	else
+		return 1;
+	endif
 endfunction
 
 function EquipmentCheck(who)
@@ -145,7 +155,7 @@
 		if ( !amount )
 			amount := 1;
 		endif
-		var objtype := GetObjTypeByName(CInt(_amount_iter));
+		var objtype := GetObjTypeByName(_amount_iter);
 		
 		if ( AmountInContainer(who.backpack, objtype) < amount )
 			SendSysMessage(who, "You do not have enough "+GetObjTypeDesc(objtype, (amount>1)));

Modified: trunk/096/pkg/skills/magery/spells.cfg
===================================================================
--- trunk/096/pkg/skills/magery/spells.cfg	2005-11-06 10:14:09 UTC (rev 920)
+++ trunk/096/pkg/skills/magery/spells.cfg	2005-11-06 10:46:41 UTC (rev 921)
@@ -5,6 +5,7 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle1/clumsy
 
+	Difficulty	1
 	ManaCost	0
 	Delay		0
 
@@ -22,6 +23,7 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle1/createFood
 
+	Difficulty	1
 	ManaCost	0
 	Delay		0
 
@@ -40,6 +42,7 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle1/feebleMind
 
+	Difficulty	1
 	ManaCost	0
 	Delay		0
 
@@ -57,6 +60,7 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle1/heal
 
+	Difficulty	1
 	ManaCost	0
 	Delay		0
 
@@ -74,6 +78,10 @@
 	Name		Magic Arrow
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle1/magicArrow
+	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
 
 	PowerWords	In Por Ylem
 	Circle		1
@@ -88,6 +96,10 @@
 	Name		Night Sight
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle1/nightSight
+	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
 
 	PowerWords	In Lor
 	Circle		1
@@ -103,6 +115,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle1/reactiveArmor
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Flam Sanct
 	Circle		1
 	
@@ -118,6 +134,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle1/weaken
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Des Mani
 	Circle		1
 	
@@ -132,6 +152,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/agility
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Ex Uus
 	Circle		2
 	
@@ -146,6 +170,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/cunning
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Uus Wis
 	Circle		2
 	
@@ -160,6 +188,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/cure
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	An Nox
 	Circle		2
 	
@@ -174,6 +206,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/harm
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	An Mani
 	Circle		2
 	
@@ -188,6 +224,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/magicTrap
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	In Jux
 	Circle		2
 	
@@ -203,6 +243,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/magicUntrap
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	An Jux
 	Circle		2
 	
@@ -218,6 +262,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/protection
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Uus Sanct
 	Circle		2
 	
@@ -233,6 +281,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/strength
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Uus Mani
 	Circle		2
 	
@@ -247,6 +299,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/bless
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Rel Sanct
 	Circle		3
 	
@@ -261,6 +317,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle23/fireBall
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Vas Flam
 	Circle		3
 	
@@ -275,6 +335,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/magicLock
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	An Por
 	Circle		3
 	
@@ -290,6 +354,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/magicUnlock
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	In Nox
 	Circle		3
 	
@@ -303,6 +371,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/telekinesis
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Ort Por Ylem
 	Circle		3
 	
@@ -317,6 +389,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/teleport
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Rel Por
 	Circle		3
 	
@@ -331,6 +407,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/unlock
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Ex Por
 	Circle		3
 	
@@ -345,6 +425,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/wallofStone
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	In Sanct Ylem
 	Circle		3
 	
@@ -359,6 +443,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/archCure
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Vas An Nox
 	Circle		4
 	
@@ -374,6 +462,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/archProtection
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Vas Uus Sanct
 	Circle		4
 	
@@ -390,6 +482,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/curse
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Des Sanct
 	Circle		4
 	
@@ -405,6 +501,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/fireField
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	In Flam Grav
 	Circle		4
 	
@@ -420,6 +520,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/greaterHeal
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	In Vas Mani
 	Circle		4
 	
@@ -436,6 +540,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/lightning
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Por Ort Grav
 	Circle		4
 		
@@ -451,6 +559,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/manaDrain
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Ort Rel
 	Circle		4
 	
@@ -466,6 +578,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/recall
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Kal Ort Por
 	Circle		4
 	
@@ -481,6 +597,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/bladeSpirit
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	In Jux Hur Ylem
 	Circle		5
 	
@@ -496,6 +616,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/dispelField
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	An Grav
 	Circle		5
 	
@@ -512,6 +636,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/incognito
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Kal In Ex
 	Circle		5
 	
@@ -527,6 +655,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/spellReflection
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	In Jux Sanct
 	Circle		5
 	
@@ -542,6 +674,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/mindBlast
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Por Corp Wis
 	Circle		5
 	
@@ -558,6 +694,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/paralyze
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	An Ex Por
 	Circle		5
 	
@@ -573,6 +713,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/poisonField
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	In Nox Grav
 	Circle		5
 	
@@ -588,6 +732,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/summonCreature
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Kal Xen
 	Circle		5
 	
@@ -603,6 +751,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/dispel
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	An Ort
 	Circle		6
 	
@@ -618,6 +770,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/energyBolt
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Corp Por
 	Circle		6
 	
@@ -632,6 +788,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/explosion
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Vas Ort Flam
 	Circle		6
 	
@@ -647,6 +807,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/invisibility
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	An Lor Xen
 	Circle		6
 	
@@ -661,6 +825,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/mark
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Kal Por Ylem
 	Circle		6
 	
@@ -676,6 +844,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/massCurse
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Vas Des Sanct
 	Circle		6
 	
@@ -692,6 +864,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/paralyzeField
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	In Ex Grav
 	Circle		6
 	
@@ -707,6 +883,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/reveal
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Wis  Quas
 	Circle		6
 	
@@ -721,6 +901,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/chainLightning
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Vas Ort Grav
 	Circle		7
 	
@@ -737,6 +921,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/energyField
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	In Sanct Grav
 	Circle		7
 	
@@ -753,6 +941,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/flameStrike
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Kal Vas Flam
 	Circle		7
 	
@@ -767,6 +959,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/gate
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Vas Rel Por
 	Circle		7
 	
@@ -782,6 +978,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/manaVampire
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Ort Sanct
 	Circle		7
 	
@@ -798,6 +998,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/massDispel
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Vas An Ort
 	Circle		7
 	
@@ -814,6 +1018,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/meteorSwarm
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Kal Des Flam Ylem
 	Circle		7
 	
@@ -830,6 +1038,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/polymorph
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Vas Ylem Rel
 	Circle		7
 	
@@ -845,6 +1057,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/earthquake
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	In Vas Por
 	Circle		8
 
@@ -861,6 +1077,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/energyVortex
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	Vas Corp Por
 	Animation	0x11
 	Circle		8
@@ -878,6 +1098,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/resurrection
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	PowerWords	An Corp
 	Circle		8
 	
@@ -893,6 +1117,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/summonAirElemental
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	Animation	0x11
 	PowerWords	Kal Vas Xen Hur
 	Circle		8
@@ -909,6 +1137,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/summonDeamon
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	Animation	0x11
 	PowerWords	Kal Vas Xen Corp
 	Circle		8
@@ -926,6 +1158,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/summonEarthElemental
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	Animation	0x11
 	PowerWords	Kal Vas Xen Ylem
 	Circle		8
@@ -942,6 +1178,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/summonFireElemental
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	Animation	0x11
 	PowerWords	Kal Vas Xen Flam
 	Circle		8
@@ -959,6 +1199,10 @@
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/summonWaterElemental
 	
+	Difficulty	1
+	ManaCost	0
+	Delay		0
+	
 	Animation	0x11
 	PowerWords	Kal Vas Xen An Flam
 	Circle		8



From panosl at berlios.de  Sun Nov  6 13:05:41 2005
From: panosl at berlios.de (Panos Laganakos at BerliOS)
Date: Sun, 6 Nov 2005 13:05:41 +0100
Subject: [Poldistro-svn] r922 - trunk/096/docs
Message-ID: <200511061205.jA6C5foR020715@sheep.berlios.de>

Author: panosl
Date: 2005-11-06 13:05:38 +0100 (Sun, 06 Nov 2005)
New Revision: 922

Added:
   trunk/096/docs/naming_conventions.txt
Log:


Added: trunk/096/docs/naming_conventions.txt
===================================================================
--- trunk/096/docs/naming_conventions.txt	2005-11-06 10:46:41 UTC (rev 921)
+++ trunk/096/docs/naming_conventions.txt	2005-11-06 12:05:38 UTC (rev 922)
@@ -0,0 +1,59 @@
+Naming Conventions:
+-------------------
+
+FileNames:
+The letter of the first word is lowercase, while the first letter of each additional
+word is capitalized. This naming convention is known as camelCase. All file extensions
+are lowercase.
+	Examples:
+		npcBackpack.inc
+		myIncludeFle.inc
+		showAll.src
+
+	Exceptions:
+		Config files and commands are all lowercase.
+
+
+Variables:
+The variable naming is more loose, so we allow 'cameCasing', 'K&R', etc.
+	Examples:
+		var myInteger;
+		var mystring;
+		var layer_array;
+                       
+	Exceptions:
+		Constant variables are all capitalized and words are separated
+		using the underscore character '_'.
+                       
+		const MY_CONSTANT := 10.0;
+		const NUMBER_OF_GUARDS := 100;
+
+
+Functions:
+All functions use the PascalCase convention, which as you can see has the first
+letter of each word capitalized.
+	Examples:
+		function ListOnlineDrow(who)
+		function GetLastName(who, numOfLetters)
+                      
+	Exceptions:
+		If the function/s is part of a special package it can include a small
+		prefix to define its origin i.e. AI_GetNerves(mobile).
+
+
+Programs:
+All programs are named after the file in which they are contained. Unlike their filenames
+though, the can either follow the 'cameCasing' or 'PascalCasing'.
+	Examples:
+		(FileName is "bardInstruments.src"), thus the program is named:
+		program bardInstruments(item)
+
+		(FileName is "enumerateTowns.src), thus the program is named:
+		program EnumerateTowns(who, uX, uY, lX, lY, realm)
+
+	Exceptions:
+		There are certain exceptions with special kind of programs, such as commands
+		i.e. command_MyCommand(who, params)
+		or a spell program
+		i.e. spell_GreaterHeal(who)
+



From austin at berlios.de  Sun Nov  6 16:00:50 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 16:00:50 +0100
Subject: [Poldistro-svn] r923 - in trunk/096: pkg/mobiles/brainAI pkg/mobiles/brainAI/complete pkg/mobiles/brainAI/complete/blackEye pkg/mobiles/brainAI/scripts/combat scripts/include
Message-ID: <200511061500.jA6F0o29007100@sheep.berlios.de>

Author: austin
Date: 2005-11-06 16:00:49 +0100 (Sun, 06 Nov 2005)
New Revision: 923

Added:
   trunk/096/pkg/mobiles/brainAI/complete/blackEye/
   trunk/096/pkg/mobiles/brainAI/complete/blackEye/combat.src
   trunk/096/pkg/mobiles/brainAI/complete/blackEye/virtual.src
Modified:
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
   trunk/096/pkg/mobiles/brainAI/scripts/combat/rigger.src
   trunk/096/scripts/include/facings.inc
Log:
Added black eye npc.
Fixed line in Rigger ... had "EonScript" instead of "EndScript" damn I must have been tired when I did that one!

Fixed issues in facings.inc (again - must have been tired!)



Added: trunk/096/pkg/mobiles/brainAI/complete/blackEye/combat.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/complete/blackEye/combat.src	2005-11-06 12:05:38 UTC (rev 922)
+++ trunk/096/pkg/mobiles/brainAI/complete/blackEye/combat.src	2005-11-06 15:00:49 UTC (rev 923)
@@ -0,0 +1,81 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+
+include ":attributes:attributes";
+include ":brainAI:npcCommands";
+include ":brainAI:npcNerves";
+
+program MeleeCombatNerve(params)
+	var npc		:= params[1];
+	var nerve_name	:= params[2];
+	var event	:= params[3];
+	var settings	:= params[4];
+	var scripts	:= params[5];
+	params := 0; // Not needed anymore.
+
+	//Store it here so it does not have to do the math over and over.
+	var flee_level := AP_GetVitalMaximumValue(npc, "Hits") * (CDbl(settings["FleeLevel"])/100.0);
+	
+	var opponent := event.source;
+	var flee_mode := 0;
+
+	AI_SetOpponent(npc, opponent);
+	
+	while( npc )
+		var dist := Distance(npc, opponent);
+		if ( !GetNerveProcess(npc, "Virtual") )
+			// Start up the virtual nerve to do the special attack.
+			SendEvent(npc, "virtual");
+		elseif ( ShouldFlee(npc, flee_level, flee_mode) )
+			flee_mode := 1;
+			AI_WarMode(npc, 0);
+			AI_Move(npc, opponent, NEMOVE_AWAY, NEMOVE_RUN, WAKEUP, 100);
+		elseif ( DoneFighting(npc, opponent, dist) )
+			if ( scripts.Exists("EndFight") )
+				params := array{opponent, settings, scripts};
+				AI_StartNerve(npc, "EndFight", scripts["EndFight"].script, params);
+			else
+				AI_WarMode(npc, 0);
+			endif
+			AI_EndNerve(npc, nerve_name);
+		elseif( dist > 3 )
+			AI_Move(npc, opponent, NEMOVE_TOWARD, NEMOVE_RUN, WAKEUP, dist-2);
+		endif
+				
+		sleepms(600);
+		AI_ClearThoughts(npc, CLR_NERVE);
+	endwhile
+endprogram
+
+function DoneFighting(npc, opponent, byref dist)
+	if ( opponent.dead )
+		return 1;
+	elseif ( !opponent )
+		return 1;
+	elseif ( opponent.hidden )
+		return 1;
+	elseif ( opponent.concealed > npc.cmdlevel )
+		return 1;
+	elseif ( dist > 20 )
+		return 1;
+	elseif ( dist > 10 && !CheckLineOfSight(npc, opponent) )
+		return 1;
+	endif
+
+	return 0;
+endfunction
+
+function ShouldFlee(npc, byref flee_level, byref flee_mode)
+	if ( flee_mode )
+		return 1;
+	elseif ( AP_GetVital(npc, "Hits") < flee_level )
+		return 1;
+	endif
+
+	return 0;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/mobiles/brainAI/complete/blackEye/virtual.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/complete/blackEye/virtual.src	2005-11-06 12:05:38 UTC (rev 922)
+++ trunk/096/pkg/mobiles/brainAI/complete/blackEye/virtual.src	2005-11-06 15:00:49 UTC (rev 923)
@@ -0,0 +1,70 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+use cfgfile;
+use util;
+
+include ":attributes:attributes";
+include ":brainAI:npcCommands";
+include ":blood:blood";
+include "include/facings";
+include "include/client";
+
+
+program VirtualNerve(params)
+	var npc		:= params[1];
+	//var nerve_name	:= params[2];
+	//var event	:= params[3];
+	var settings	:= params[4];
+	//var scripts	:= params[5];
+	params := 0; // Not needed anymore.
+
+	while ( npc )
+		var hp := AP_GetVital(npc, HITS);
+		var max_hp := AP_GetVitalMaximumValue(npc, HITS);
+
+		if ( hp < max_hp )
+			var range := settings["AttackRange"];
+			if ( !range )
+				range := 5;
+			endif
+			
+			var attack_list := array{};
+			foreach mobile in ListMobilesNearLocationEX(npc.x, npc.y, npc.z, range, LISTEX_FLAG_NORMAL+LISTEX_FLAG_HIDDEN)
+				if ( (mobile.ip) && (!mobile.concealed) )
+					attack_list.append(mobile);
+				endif
+				sleepms(5);
+			endforeach
+			
+			var num_opponents := attack_list.size();
+			
+			if ( num_opponents > 0 )
+				var dmg := max_hp-hp;
+				//Divvy up the damage
+				dmg := CInt(dmg/num_opponents);
+				if ( dmg < 1 )
+					dmg := 1;
+				endif
+				
+				foreach opponent in attack_list
+					var temp := RandomInt(dmg)+1;
+					ApplyRawDamage(opponent, temp);
+					MakeBleed(opponent);
+					TurnObjectToward(npc, opponent.x, opponent.y);
+					PerformAction(npc, ANIM_FIDGET_2);
+					PlaySoundEffect(npc, 0x17C);
+					HealDamage(npc, temp);
+					sleepms(100);
+				endforeach
+			endif
+		endif
+		
+		AI_ClearThoughts(npc, CLR_NERVE);
+		sleep(5);
+	endwhile
+endprogram

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-06 12:05:38 UTC (rev 922)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-06 15:00:49 UTC (rev 923)
@@ -1,6 +1,11 @@
 # $Id$
 #
 #
+
+##########################################
+# Example NPC
+##########################################
+
 NPCTemplate ExampleNPC
 {
 	// Primary NPC information
@@ -23,10 +28,10 @@
 	HITS		100
 	MANA		1
 	STAM		100
-	
+
 	// Intrinsic Weapon
 	AttackHitScript	:combat:mainHitScript
-	
+
 	// Brain AI Settings
 	AISetting	AreaSize	i5
 	AISetting	CycleWait	i10
@@ -37,7 +42,7 @@
 	AISetting	IdleTicks	i5
 	AISetting	ListenRange	i10
 	AISetting	SleepWait	i1000
-	
+
 	// Brain AI Nerves
 	AIScript	Combat		:brainAI:complete/exampleNPC/combat
 	AIScript	Cycle		:brainAI:complete/exampleNPC/cycle
@@ -56,14 +61,18 @@
 	AIScript	ShouldWatch	:brainAI:complete/exampleNPC/shouldWatch
 	AIScript	Virtual		:brainAI:complete/exampleNPC/virtual
 	AIScript	EndFight	:brainAI:complete/exampleNPC/endFight
-	
+
 	// Skinning Info
-	
+
 	// Settings other scripts use...
-	
+
 	// CProps (eww!)
 }
 
+##########################################
+# Austin - Custom NPCs
+##########################################
+
 NPCTemplate Rigger
 {
 	// Primary NPC settings
@@ -105,7 +114,7 @@
 	AISetting	FleeLevel	i50 // 50%
 	AISetting	IdleTicks	i5
 	AISetting	SleepWait	i1000
-	
+
 	// Brain AI Nerves
 	AIScript	Combat		:brainAI:scripts/combat/rigger
 	AIScript	EnterArea	:brainAI:scripts/enterArea/generic
@@ -113,14 +122,78 @@
 	AIScript	LookAround	:brainAI:scripts/lookAround/findAttackables
 	AIScript	Sleep		:brainAI:scripts/sleep/generic
 	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/targetPlayers
-	
+
 	// Skinning Info
-	
+
 	// Settings other scripts use...
-	
+
 	// CProps (eww!)
 }
 
+NPCTemplate BlackEye
+{
+	Name		a black eye
+	Script		:brainAI:brain
+	ObjType		0x16
+	TrueColor	1109
+	Color		1109
+	Gender		0
+	AR		2
+	RunSpeed	25
+	Category	Austin
+
+	// Attributes
+	Strength	100
+	Intelligence	10
+	Dexterity	40
+	ResistingSpells	10
+	Tactics		20
+	Wrestling	50
+
+	// Vitals
+	HITS		200
+	MANA		0
+	STAM		100
+
+	// Intrinsic Weapon
+	AttackSpeed	10
+	AttackDamage	1d3
+	AttackAttribute	Wrestling
+	AttackHitSound	0x17C
+	AttackMissSound	0x239
+	DeathSound	0x17E
+	DamagedSound	0x17D
+	AttackHitScript	:combat:mainHitScript
+
+	// Sounds
+	AttackHitSounds		a1:i380
+	AttackMissSounds	a1:i569
+	DeathSounds		a1:i382
+	DamagedSounds		a1:i381
+	IdleSounds		a2:i378i379
+
+	// Brain AI Settings
+	AISetting	AreaSize		i13
+	AISetting	CycleWait		i10
+	AISetting	FleeLevel		i0
+	AISetting	IdleTicks		i30
+	AISetting	SleepWait		i1000
+
+	AIScript	Combat			:BrainAI:complete/blackEye/combat
+	AIScript	EnterArea		:BrainAI:scripts/enterArea/generic
+	AIScript	LeftArea		:brainAI:scripts/LeftArea/generic
+	AIScript	LookAround		:brainAI:scripts/lookAround/findAttackables
+	AIScript	Sleep			:brainAI:scripts/sleep/generic
+	AIScript	ShouldWatch		:brainAI:scripts/shouldWatch/targetPlayers
+	AIScript	Virtual			:brainAI:complete/blackEye/virtual
+
+	// Skinning Info
+
+	// Settings other scripts use...
+
+	// CProps (eww!)
+}
+
 ##########################################
 # Animals
 ##########################################
@@ -155,8 +228,8 @@
 	AttackSpeed		30
 	AttackDamage		1d4
 	AttackHitScript		:combat:mainHitScript
-	
-	// Sounds 
+
+	// Sounds
 	AttackHitSounds		a1:i123
 	AttackMissSounds	a1:i569
 	DeathSounds		a1:i125
@@ -180,11 +253,11 @@
 	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/watchFeared
 	AIScript	Sleep		:brainAI:scripts/sleep/generic
 	AIScript	EndFight	:brainAI:scripts/endFight/endFightAnimal
-	
+
 	// Skinning Info
-	
+
 	// Settings other scripts use...
-	
+
 	// CProps (eww!)
 }
 
@@ -207,18 +280,18 @@
 	ResistingSpells		5.0
 	Tactics			6.0
 	Wrestling		5.0
-	
+
 	// Vitals
 	HITS			12
 	MANA			0
 	STAM			25
-	
+
 	// Intrinsic Weapon
 	AttackSpeed		30
 	AttackDamage		1d2
 	AttackAttribute		Wrestling
 	AttackHitScript		:combat:mainHitScript
-	
+
 	// Sounds
 	AttackHitSounds		a1:i217
 	AttackMissSounds	a1:i569
@@ -233,7 +306,7 @@
 	AISetting	IdleTicks	i2
 	AISetting	ListenRange	i7
 	AISetting	SleepWait	i1000
-	
+
 	// Brain AI Nerves
 	AIScript	Combat		:brainAI:scripts/combat/genericAnimal
 	AIScript	EnterArea	:brainAI:scripts/enterArea/generic
@@ -255,7 +328,7 @@
 	GuardIgnore		1
 	DStart			10
 	NoLoot			1
-	
+
 	// CProps (eww!)
 	CProp  Karma		i0
 	CProp  Fame		i1

Modified: trunk/096/pkg/mobiles/brainAI/scripts/combat/rigger.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/combat/rigger.src	2005-11-06 12:05:38 UTC (rev 922)
+++ trunk/096/pkg/mobiles/brainAI/scripts/combat/rigger.src	2005-11-06 15:00:49 UTC (rev 923)
@@ -1,4 +1,4 @@
-// $Id: combat.src 475 2005-10-09 10:53:16Z austin $
+// $Id$
 
 use uo;
 use os;
@@ -31,7 +31,7 @@
 			AI_WarMode(npc, 0);
 			AI_Move(npc, opponent, NEMOVE_AWAY, NEMOVE_RUN, WAKEUP, 100);
 		elseif ( DoneFighting(npc, opponent, dist) )
-			if ( scripts.Exists("EonFight") )
+			if ( scripts.Exists("EndFight") )
 				params := array{opponent, settings, scripts};
 				AI_StartNerve(npc, "EndFight", scripts["EndFight"].script, params);
 			else

Modified: trunk/096/scripts/include/facings.inc
===================================================================
--- trunk/096/scripts/include/facings.inc	2005-11-06 12:05:38 UTC (rev 922)
+++ trunk/096/scripts/include/facings.inc	2005-11-06 15:00:49 UTC (rev 923)
@@ -22,9 +22,9 @@
  *
  */
 function TurnObjectToward(object, x_pos, y_pos)
-	var orig := mobile.facing;
+	var orig := object.facing;
 
-	mobile.facing := GetFacing(mobile.x,mobile.y, x,y);
+	object.facing := GetFacing(object.x, object.y, x_pos, y_pos);
 
 	return orig;
 endfunction



From austin at berlios.de  Sun Nov  6 16:46:50 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 16:46:50 +0100
Subject: [Poldistro-svn] r924 - in trunk/096: pkg/mobiles/brainAI pkg/mobiles/brainAI/complete/blackEye pkg/mobiles/brainAI/scripts/combat scripts/include
Message-ID: <200511061546.jA6FkoqG011470@sheep.berlios.de>

Author: austin
Date: 2005-11-06 16:46:49 +0100 (Sun, 06 Nov 2005)
New Revision: 924

Added:
   trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
   trunk/096/scripts/include/shapes.inc
   trunk/096/scripts/include/sounds.inc
Modified:
   trunk/096/pkg/mobiles/brainAI/complete/blackEye/combat.src
   trunk/096/pkg/mobiles/brainAI/complete/blackEye/virtual.src
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
   trunk/096/scripts/include/client.inc
Log:
Added firebeetle npc (shoots napalm!)

Added shapes.inc - will be used for getting coordinates for various shapes.

Moved sound constants from client.inc to sounds.inc (per Melanius' request)



Modified: trunk/096/pkg/mobiles/brainAI/complete/blackEye/combat.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/complete/blackEye/combat.src	2005-11-06 15:00:49 UTC (rev 923)
+++ trunk/096/pkg/mobiles/brainAI/complete/blackEye/combat.src	2005-11-06 15:46:49 UTC (rev 924)
@@ -10,7 +10,7 @@
 include ":brainAI:npcCommands";
 include ":brainAI:npcNerves";
 
-program MeleeCombatNerve(params)
+program BrainNerve(params)
 	var npc		:= params[1];
 	var nerve_name	:= params[2];
 	var event	:= params[3];

Modified: trunk/096/pkg/mobiles/brainAI/complete/blackEye/virtual.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/complete/blackEye/virtual.src	2005-11-06 15:00:49 UTC (rev 923)
+++ trunk/096/pkg/mobiles/brainAI/complete/blackEye/virtual.src	2005-11-06 15:46:49 UTC (rev 924)
@@ -15,7 +15,7 @@
 include "include/client";
 
 
-program VirtualNerve(params)
+program BrainNerve(params)
 	var npc		:= params[1];
 	//var nerve_name	:= params[2];
 	//var event	:= params[3];

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-06 15:00:49 UTC (rev 923)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-06 15:46:49 UTC (rev 924)
@@ -9,25 +9,25 @@
 NPCTemplate ExampleNPC
 {
 	// Primary NPC information
-	Name		<Example NPC>
-	Script		:brainAI:brain
-	ObjType		0x190
-	Color		0
-	TrueColor	0
-	Gender		0
-	AR		25
-	RunSpeed	200
-	Category	Testing
+	Name			<Example NPC>
+	Script			:brainAI:brain
+	ObjType			0x190
+	Color			0
+	TrueColor		0
+	Gender			0
+	AR			25
+	RunSpeed		200
+	Category		Testing
 
 	// Attributes
-	Strength	100
-	Intelligence	1
-	Dexterity	10
+	Strength		100
+	Intelligence		1
+	Dexterity		10
 
 	// Vitals
-	HITS		100
-	MANA		1
-	STAM		100
+	HITS			100
+	MANA			1
+	STAM			100
 
 	// Intrinsic Weapon
 	AttackHitScript	:combat:mainHitScript
@@ -132,38 +132,34 @@
 
 NPCTemplate BlackEye
 {
-	Name		a black eye
-	Script		:brainAI:brain
-	ObjType		0x16
-	TrueColor	1109
-	Color		1109
-	Gender		0
-	AR		2
-	RunSpeed	25
-	Category	Austin
+	Name			a black eye
+	Script			:brainAI:brain
+	ObjType			0x16
+	TrueColor		1109
+	Color			1109
+	Gender			0
+	AR			2
+	RunSpeed		25
+	Category		Austin
 
 	// Attributes
-	Strength	100
-	Intelligence	10
-	Dexterity	40
-	ResistingSpells	10
-	Tactics		20
-	Wrestling	50
+	Strength		100
+	Intelligence		10
+	Dexterity		40
+	ResistingSpells		10
+	Tactics			20
+	Wrestling		50
 
 	// Vitals
-	HITS		200
-	MANA		0
-	STAM		100
+	HITS			200
+	MANA			0
+	STAM			100
 
 	// Intrinsic Weapon
-	AttackSpeed	10
-	AttackDamage	1d3
-	AttackAttribute	Wrestling
-	AttackHitSound	0x17C
-	AttackMissSound	0x239
-	DeathSound	0x17E
-	DamagedSound	0x17D
-	AttackHitScript	:combat:mainHitScript
+	AttackSpeed		10
+	AttackDamage		1d3
+	AttackAttribute		Wrestling
+	AttackHitScript		:combat:mainHitScript
 
 	// Sounds
 	AttackHitSounds		a1:i380
@@ -173,19 +169,20 @@
 	IdleSounds		a2:i378i379
 
 	// Brain AI Settings
-	AISetting	AreaSize		i13
-	AISetting	CycleWait		i10
-	AISetting	FleeLevel		i0
-	AISetting	IdleTicks		i30
-	AISetting	SleepWait		i1000
+	AISetting	AreaSize	i13
+	AISetting	AttackRange	i10
+	AISetting	CycleWait	i10
+	AISetting	FleeLevel	i0
+	AISetting	IdleTicks	i30
+	AISetting	SleepWait	i1000
 
-	AIScript	Combat			:BrainAI:complete/blackEye/combat
-	AIScript	EnterArea		:BrainAI:scripts/enterArea/generic
-	AIScript	LeftArea		:brainAI:scripts/LeftArea/generic
-	AIScript	LookAround		:brainAI:scripts/lookAround/findAttackables
-	AIScript	Sleep			:brainAI:scripts/sleep/generic
-	AIScript	ShouldWatch		:brainAI:scripts/shouldWatch/targetPlayers
-	AIScript	Virtual			:brainAI:complete/blackEye/virtual
+	AIScript	Combat		:brainAI:complete/blackEye/combat
+	AIScript	EnterArea	:brainAI:scripts/enterArea/generic
+	AIScript	LeftArea	:brainAI:scripts/LeftArea/generic
+	AIScript	LookAround	:brainAI:scripts/lookAround/findAttackables
+	AIScript	Sleep		:brainAI:scripts/sleep/generic
+	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/targetPlayers
+	AIScript	Virtual		:brainAI:complete/blackEye/virtual
 
 	// Skinning Info
 
@@ -194,6 +191,67 @@
 	// CProps (eww!)
 }
 
+NPCTemplate FireBeetle
+{
+	Name			a fire beetle
+	Script			:ai_brain:brain
+	ObjType			0x30
+	Color			2118
+	TrueColor		2118
+	Gender			0
+	AR			10
+	RunSpeed		150
+	Category		Austin
+	
+	// Attributes
+	Strength		80
+	Dexterity		20
+	Intelligence		30
+	Wrestling		30
+	Tactics			25
+	
+	// Vitals
+	HITS			80
+	MANA			0
+	STAM			100
+
+	// Intrinsic Weapon
+	AttackAttribute		WAR_Wrestling
+	AttackSpeed		10
+	AttackDamage		5d5
+	AttackHitScript		:combat:mainHitScript
+		
+	// Sounds
+	AttackHitSound		a1:i390
+	AttackMissSound		a1:i569
+	DeathSound		a1:i392
+	DamagedSound		a1:i391
+	IdleSounds		a1:i398
+
+	// Brain AI Settings
+	AISetting	AreaSize	i15
+	AISetting	AttackRange	i14
+	AISetting	CycleWait	i10
+	AISetting	FleeLevel	i20
+	AISetting	IdleTicks	i20
+	AISetting	SleepWait	i1000
+	
+	// Brain AI Nerves
+	// Brain AI Nerves
+	AIScript	Combat		:brainAI:scripts/combat/fireBeetle
+	AIScript	EnterArea	:brainAI:scripts/enterArea/generic
+	AIScript	LeftArea	:brainAI:scripts/leftArea/generic
+	AIScript	LookAround	:brainAI:scripts/lookAround/findAttackables
+	AIScript	Sleep		:brainAI:scripts/sleep/generic
+	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/targetPlayers
+
+	// Skinning Info
+
+	// Settings other scripts use...
+
+	// CProps (eww!)
+}
+
 ##########################################
 # Animals
 ##########################################

Added: trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-06 15:00:49 UTC (rev 923)
+++ trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-06 15:46:49 UTC (rev 924)
@@ -0,0 +1,145 @@
+/*
+ * $Id*
+ *
+ */
+
+use uo;
+use os;
+
+include ":brainAI:npcNerves";
+include ":brainAI:npcCommands";
+include ":attributes:attributes";
+include "include/shapes";
+include "include/client";
+include "include/sounds";
+
+program BrainNerve(params)
+	var npc		:= params[1];
+	var nerve_name	:= params[2];
+	var event	:= params[3];
+	var settings	:= params[4];
+	var scripts	:= params[5];
+	params := 0; // Not needed anymore.
+
+	//Store it here so it does not have to do the math over and over.
+	var flee_level := AP_GetVitalMaximumValue(npc, "Hits") * (CDbl(settings["FleeLevel"])/100.0);
+
+	var opponent := event.source;
+	var flee_mode := 0;
+
+	AI_SetOpponent(npc, opponent);
+
+	while( npc )
+		var dist := Distance(npc, opponent);
+		if ( ShouldFlee(npc, flee_level, flee_mode) )
+			flee_mode := 1;
+			AI_WarMode(npc, 0);
+			AI_Move(npc, opponent, NEMOVE_AWAY, NEMOVE_RUN, WAKEUP, 100);
+		elseif ( DoneFighting(npc, opponent, dist) )
+			if ( scripts.Exists("EndFight") )
+				params := array{opponent, settings, scripts};
+				AI_StartNerve(npc, "EndFight", scripts["EndFight"].script, params);
+			else
+				AI_WarMode(npc, 0);
+			endif
+			AI_EndNerve(npc, nerve_name);
+		elseif ( dist <= 5 )
+			AI_Move(npc, opponent, NEMOVE_AWAY, NEMOVE_RUN, WAKEUP, (12-dist));
+		elseif( dist > 5 )
+			AI_Move(npc, opponent, NEMOVE_TOWARD, NEMOVE_RUN, WAKEUP, dist+1);
+		endif
+
+		SpecialAttack(npc, opponent, dist);
+
+		sleepms(400);
+		AI_ClearThoughts(npc, CLR_NERVE);
+	endwhile
+endprogram
+
+function DoneFighting(npc, opponent, byref dist)
+	if ( opponent.dead )
+		return 1;
+	elseif ( !opponent )
+		return 1;
+	elseif ( opponent.hidden )
+		return 1;
+	elseif ( opponent.concealed > npc.cmdlevel )
+		return 1;
+	elseif ( dist > 20 )
+		return 1;
+	elseif ( dist > 10 && !CheckLineOfSight(npc, opponent) )
+		return 1;
+	endif
+
+	return 0;
+endfunction
+
+function ShouldFlee(npc, byref flee_level, byref flee_mode)
+	if ( flee_mode )
+		return 1;
+	elseif ( AP_GetVital(npc, "Hits") < flee_level )
+		return 1;
+	endif
+
+	return 0;
+endfunction
+
+function SpecialAttack(npc, opponent, byref dist)
+	if ( dist < 5 || dist > 14 )
+		return 0;
+	elseif ( !CheckLineOfSight(npc, opponent) )
+		return 0;
+	elseif ( RandomInt(3) != 1 )
+		return 0;
+	endif
+
+	var next_shoot := CInt(GetObjProperty(npc, "#NextShoot"));
+	if ( next_shoot > ReadGameClock() )
+		return 0;
+	endif
+
+	AI_Turn(npc, opponent, NETURN_TOWARD);
+	npc.frozen := 1;
+
+	PerformAction(npc, 0x6);
+	sleepms(80);
+	PrintTextAbove(npc, "*"+npc.name+" spits a ball of fire*");
+	PlayMovingEffect(npc, opponent, GFX_SMALL_FIREBALL, 10, 10, 1);
+
+	var coord_list := GetCoordsInLine(npc.x, npc.y, opponent.x, opponent.y);
+	foreach coord in coord_list
+		if ( _coord_iter > 1 )
+			var field := CreateItemAtLocation(coord.x, coord.y, npc.z, "FireFieldNS", 1);
+			field.SetDamageDice("1d2");
+			field.SetFieldDuration("3");
+			sleepms(105);
+		endif
+	endforeach
+
+	PlaySoundEffect(opponent, 0x208);
+	ApplyRawDamage(opponent, RandomDiceRoll("3d7"));
+
+	foreach coord in GetCoordsInSquare(opponent.x, opponent.y, 3)
+		if ( RandomInt(2) == 1 )
+			case(RandomInt(3))
+				default:
+					PlayStationaryEffect(coord.x, coord.y, npc.z, FX_EXPLODE_1, 10, 10, 0);
+					break;
+				1:
+					PlayStationaryEffect(coord.x, coord.y, npc.z, FX_EXPLODE_2, 10, 10, 0);
+					break;
+				2:
+					PlayStationaryEffect(coord.x, coord.y, npc.z, FX_EXPLODE_3, 10, 10, 0);
+					break;
+			endcase
+			var field := CreateItemAtLocation(coord.x, coord.y, opponent.z, "FireFieldNS", 1);
+			field.SetDuration("1d3");
+		endif
+		sleepms(5);
+	endforeach
+	
+	npc.frozen := 0;
+	SetObjProperty(npc, "#NextShoot", ReadGameClock()+15);
+	
+	return 1;
+endfunction
\ No newline at end of file

Modified: trunk/096/scripts/include/client.inc
===================================================================
--- trunk/096/scripts/include/client.inc	2005-11-06 15:00:49 UTC (rev 923)
+++ trunk/096/scripts/include/client.inc	2005-11-06 15:46:49 UTC (rev 924)
@@ -117,59 +117,10 @@
 	DIR_NW	:=  0x07    // Northwest.
 endenum
 
-// SOUNDS ABC order by insideUO
-// NOTE: Any number over 0xFF (255) will not work in older clients.
-enum SOUNDS
-	SFX_AGILITY		:= 0x1E8,
-	SFX_AGILITY2		:= 0x28F,
-	SFX_AIR_1		:= 0x291,
-	SFX_AIR_2		:= 0x292,
-	SFX_AIR_3		:= 0x293,
-	SFX_AIR_4		:= 0x294,
-	SFX_AIR_5		:= 0x295,
-	SFX_AIRELEMENTAL_1	:= 0x108,
-	SFX_AIRELEMENTAL_2	:= 0x109,
-	SFX_AIRELEMENTAL_3	:= 0x10A,
-	SFX_AIRELEMENTAL_4	:= 0x10B,
-	SFX_AIRELEMENTAL_5	:= 0x10C,
-	SFX_ALIGATOR_1		:= 0x5B,
-	SFX_ALIGATOR_2		:= 0x5C,
-	SFX_ALIGATOR_3		:= 0x5D,
-	SFX_ALIGATOR_4		:= 0x5E,
-	SFX_ALIGATOR_5		:= 0x5F,
-	SFX_ALIGATORB_1		:= 0x295,
-	SFX_ALIGATORB_2		:= 0x296,
-	SFX_ALIGATORB_3		:= 0x297,
-	SFX_ALIGATORB_4		:= 0x298,
-	SFX_ALIGATORB_5		:= 0x299,
-	SFX_ANVIL		:= 0x2B,
-	SFX_ARCH_PROTECT	:= 0x1F8,
-	SFX_AQUARIUM_DEADFISH	:= 0x5A3,
-	SFX_AQUARIUM_REWARDS	:= 0x5A4,
-	SFX_AQUARIUM_USE	:= 0x5A5,
-	SFX_ARCANE_CIRCLE	:= 0x5A6,
-	SFX_ARCANE_EMPOWERMENT	:= 0x5C2,
-	SFX_ARCANE_EMPOWER_END	:= 0x5C3,
-	SFX_ARCH_CURE		:= 0x1E9,
-	SFX_ARCH_CURE2		:= 0x29A,
-	SFX_ATTUNE_WEAPON	:= 0x5C4,
-	SFX_AXE_01		:= 0x233,
-	SFX_BEAR_1		:= 0x60,
-	SFX_BEAR_2		:= 0x61,
-	SFX_BEAR_3		:= 0x62,
-	SFX_BEAR_4		:= 0x63,
-	SFX_BEAR_5		:= 0x64,
-	SFX_BEAR_6		:= 0x29B,
-	SFX_BEAR_1B		:= 0x4C3,
-	SFX_BEAR_1C		:= 0x4C4,
-	SFX_BEAR_2C		:= 0x4C5,
-	SFX_BEAR_3C		:= 0x4C6,
-	SFX_BEAR_4C		:= 0x4C7,
-	SFX_BEAR_5C		:= 0x4C8,
-	
-	SFX_SPELL_FAIL		:= 0x5D
-endenum
-
 enum GRAPHIC_EFFECTS
-	GFX_SPELL_FAIL		:= 0x3735
+	GFX_SPELL_FAIL		:= 0x3735,
+	GFX_SMALL_FIREBALL	:= 0x36E4,
+	FX_EXPLODE_1		:= 0x36CB,
+	FX_EXPLODE_2		:= 0x36BD,
+	FX_EXPLODE_3		:= 0x36B0
 endenum
\ No newline at end of file

Added: trunk/096/scripts/include/shapes.inc
===================================================================
--- trunk/096/scripts/include/shapes.inc	2005-11-06 15:00:49 UTC (rev 923)
+++ trunk/096/scripts/include/shapes.inc	2005-11-06 15:46:49 UTC (rev 924)
@@ -0,0 +1,109 @@
+/*
+ * $Id*
+ *
+ */
+ 
+use uo;
+use os;
+
+/*
+ * GetCoordsInSquare(mid_x, mid_y, radius)
+ *
+ * Purpose
+ * Retrieves the coordinates in the area of a square.
+ *
+ * Parameters
+ * mid_x:	X coordinate of the middle of the square.
+ * mid_y:	Y coordinate of the middle of the square.
+ * radius:	Size of the square
+ *
+ * Return value
+ * Array of structs (.x, .y)
+ * 
+ */
+function GetCoordsInSquare(mid_x, mid_y, radius)
+	var x_row := mid_x-radius;
+	var y_col := mid_y-radius;
+	var stop_x := mid_x+radius;
+	var stop_y := mid_y+radius;
+
+	var point_list := array{};
+	var coord := struct;
+	coord.+x;
+	coord.+y;
+
+	for ( x_row:=(mid_x-radius); x_row<=stop_x; x_row:=x_row+1 )
+		sleepms(2);
+		for ( y_col:=(mid_y-radius); y_col<=stop_y; y_col:=y_col+1 )
+			coord.x := x_row;
+			coord.y := y_col;
+			point_list.Append(coord);
+			sleepms(2);
+		endfor
+	endfor
+	
+	return point_list;
+endfunction
+
+/*
+ * GetCoordsInRect(x1, y1, x2, y2)
+ *
+ * Purpose
+ * Retrieves the coordinates in the area of a rectangle.
+ *
+ * Parameters
+ * x1:	Upper left X coordinate
+ * y1:	Upper left Y coordinate
+ * x2:	Lower right X coordinate
+ * y2:	Lower right Y coordinate
+ *
+ * Return value
+ * Array of structs (.x, .y)
+ * 
+ */
+function GetCoordsInRect(x1, y1, x2, y2)
+	var point_list := array{};
+	var coord := struct;
+	coord.+x;
+	coord.+y;
+	
+	if ( x2 < x1 )
+		return error;
+	elseif ( y2 < y1 )
+		return error;
+	endif
+
+	for ( x1; x1<=x2; x1:=x1+1 )
+		for ( y1; y1<=y2; y1:=y1+1 )
+			coord.x := x1;
+			coord.y := y1;
+			point_list.Append(coord);
+			sleepms(2);
+		endfor
+		sleepms(2);
+	endfor
+
+	return point_list;
+endfunction
+
+/*
+ * GetCoordsInCircle(mid_x, mid_y, radius)
+ *
+ * Purpose
+ * Retrieves the coordinates in the area of a circle.
+ *
+ * Parameters
+ * mid_x:	X coordinate of the middle of the square.
+ * mid_y:	Y coordinate of the middle of the square.
+ * radius:	Size of the circle
+ *
+ * Return value
+ * Array of structs (.x, .y)
+ * 
+ */
+function GetCoordsInCircle(mid_x, mid_y, radius)
+	mid_x := mid_x;
+	mid_y := mid_y;
+	radius := radius;
+	return error{"errortext":="Hasn't been coded yet!"};
+endfunction

Added: trunk/096/scripts/include/sounds.inc
===================================================================
--- trunk/096/scripts/include/sounds.inc	2005-11-06 15:00:49 UTC (rev 923)
+++ trunk/096/scripts/include/sounds.inc	2005-11-06 15:46:49 UTC (rev 924)
@@ -0,0 +1,54 @@
+// SOUNDS ABC order by insideUO
+// NOTE: Any number over 0xFF (255) will not work in older clients.
+enum PRIMARY_SOUNDS
+	SFX_AGILITY		:= 0x1E8,
+	SFX_AGILITY2		:= 0x28F,
+	SFX_AIR_1		:= 0x291,
+	SFX_AIR_2		:= 0x292,
+	SFX_AIR_3		:= 0x293,
+	SFX_AIR_4		:= 0x294,
+	SFX_AIR_5		:= 0x295,
+	SFX_AIRELEMENTAL_1	:= 0x108,
+	SFX_AIRELEMENTAL_2	:= 0x109,
+	SFX_AIRELEMENTAL_3	:= 0x10A,
+	SFX_AIRELEMENTAL_4	:= 0x10B,
+	SFX_AIRELEMENTAL_5	:= 0x10C,
+	SFX_ALIGATOR_1		:= 0x5B,
+	SFX_ALIGATOR_2		:= 0x5C,
+	SFX_ALIGATOR_3		:= 0x5D,
+	SFX_ALIGATOR_4		:= 0x5E,
+	SFX_ALIGATOR_5		:= 0x5F,
+	SFX_ALIGATORB_1		:= 0x295,
+	SFX_ALIGATORB_2		:= 0x296,
+	SFX_ALIGATORB_3		:= 0x297,
+	SFX_ALIGATORB_4		:= 0x298,
+	SFX_ALIGATORB_5		:= 0x299,
+	SFX_ANVIL		:= 0x2B,
+	SFX_ARCH_PROTECT	:= 0x1F8,
+	SFX_AQUARIUM_DEADFISH	:= 0x5A3,
+	SFX_AQUARIUM_REWARDS	:= 0x5A4,
+	SFX_AQUARIUM_USE	:= 0x5A5,
+	SFX_ARCANE_CIRCLE	:= 0x5A6,
+	SFX_ARCANE_EMPOWERMENT	:= 0x5C2,
+	SFX_ARCANE_EMPOWER_END	:= 0x5C3,
+	SFX_ARCH_CURE		:= 0x1E9,
+	SFX_ARCH_CURE2		:= 0x29A,
+	SFX_ATTUNE_WEAPON	:= 0x5C4,
+	SFX_AXE_01		:= 0x233,
+	SFX_BEAR_1		:= 0x60,
+	SFX_BEAR_2		:= 0x61,
+	SFX_BEAR_3		:= 0x62,
+	SFX_BEAR_4		:= 0x63,
+	SFX_BEAR_5		:= 0x64,
+	SFX_BEAR_6		:= 0x29B,
+	SFX_BEAR_1B		:= 0x4C3,
+	SFX_BEAR_1C		:= 0x4C4,
+	SFX_BEAR_2C		:= 0x4C5,
+	SFX_BEAR_3C		:= 0x4C6,
+	SFX_BEAR_4C		:= 0x4C7,
+	SFX_BEAR_5C		:= 0x4C8
+endenum
+
+enum CUSTOM_SOUNDS
+	SFX_SPELL_FAIL		:= 0x5D // Really aligator 1
+endenum
\ No newline at end of file



From muaddiblsd at berlios.de  Sun Nov  6 16:52:37 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Sun, 6 Nov 2005 16:52:37 +0100
Subject: [Poldistro-svn] r925 - trunk/096/pkg/items/bountyboard
Message-ID: <200511061552.jA6FqbeJ012298@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-06 16:52:36 +0100 (Sun, 06 Nov 2005)
New Revision: 925

Added:
   trunk/096/pkg/items/bountyboard/autoload.cfg
Log:
Upgraded bounty package for autoload.cfg

Added: trunk/096/pkg/items/bountyboard/autoload.cfg
===================================================================
--- trunk/096/pkg/items/bountyboard/autoload.cfg	2005-11-06 15:46:49 UTC (rev 924)
+++ trunk/096/pkg/items/bountyboard/autoload.cfg	2005-11-06 15:52:36 UTC (rev 925)
@@ -0,0 +1,9 @@
+# $Id: autoload.cfg 236 2005-09-25 09:06:19Z panosl $
+
+Autoload bountyWatcher
+{
+	Script      bountyWatcher
+	Resistent   1
+	Name        bountyWatcher
+	Priority    0
+}



From muaddiblsd at berlios.de  Sun Nov  6 16:53:53 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Sun, 6 Nov 2005 16:53:53 +0100
Subject: [Poldistro-svn] r926 - trunk/096/pkg/items/guildstone
Message-ID: <200511061553.jA6FrrAT012435@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-06 16:53:53 +0100 (Sun, 06 Nov 2005)
New Revision: 926

Added:
   trunk/096/pkg/items/guildstone/autoload.cfg
Removed:
   trunk/096/pkg/items/guildstone/start.src
Log:
Upgraded to use autoload.cfg and the Schedule package

Added: trunk/096/pkg/items/guildstone/autoload.cfg
===================================================================
--- trunk/096/pkg/items/guildstone/autoload.cfg	2005-11-06 15:52:36 UTC (rev 925)
+++ trunk/096/pkg/items/guildstone/autoload.cfg	2005-11-06 15:53:53 UTC (rev 926)
@@ -0,0 +1,9 @@
+# $Id: autoload.cfg 236 2005-09-25 09:06:19Z panosl $
+
+Autoload guildManager
+{
+	Script      guildManager
+	Resistent   1
+	Name        guildManager
+	Priority    0
+}

Deleted: trunk/096/pkg/items/guildstone/start.src
===================================================================
--- trunk/096/pkg/items/guildstone/start.src	2005-11-06 15:52:36 UTC (rev 925)
+++ trunk/096/pkg/items/guildstone/start.src	2005-11-06 15:53:53 UTC (rev 926)
@@ -1,4 +0,0 @@
-use uo;
-use os;
-
-start_script("guildManager");
\ No newline at end of file



From muaddiblsd at berlios.de  Sun Nov  6 16:54:55 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Sun, 6 Nov 2005 16:54:55 +0100
Subject: [Poldistro-svn] r927 - trunk/096/pkg/items/repaircontract
Message-ID: <200511061554.jA6FstI1012558@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-06 16:54:53 +0100 (Sun, 06 Nov 2005)
New Revision: 927

Modified:
   trunk/096/pkg/items/repaircontract/repairDeed.src
Log:
Format and some other. Still need att system update. WIll do that this week i hope

Modified: trunk/096/pkg/items/repaircontract/repairDeed.src
===================================================================
--- trunk/096/pkg/items/repaircontract/repairDeed.src	2005-11-06 15:53:53 UTC (rev 926)
+++ trunk/096/pkg/items/repaircontract/repairDeed.src	2005-11-06 15:54:53 UTC (rev 927)
@@ -1,3 +1,6 @@
+/* $Id$
+ *
+ */
 use uo;
 use util;
 use cfgfile;
@@ -5,144 +8,131 @@
 include ":itemutils:canAccess";
 
 program usescript_repairDeed(who, deed)
+	if(!can_access(who, deed, "reserve"))
+		return 0;
+	endif
+	if( !(deed in EnumerateItemsInContainer(who.backpack)) )
+		SendSysMessage(who, "The contract must be in your backpack to use it.");
+		return 0;
+	endif
 
-  if(!can_access(who, deed, "reserve"))
-    return;
-  endif
-
-  if(deed.container.serial != who.backpack.serial)
-    SendSysMessage(who, "The contract must be in your backpack to use it.");
-    return;
-  endif
-
-  if(NearNPC(who, (GetObjProperty(deed, "type"))))
-    if(RepairFromDeed(who, deed))
-      DestroyItem(deed);
-    endif
-  else
-    SendSysMessage(who, "You must be near a "+(GetObjProperty(deed, "type"))+" shop to use this contract.");
-    return;
-  endif
-
+	if(NearNPC(who, (GetObjProperty(deed, "type"))))
+		if(RepairFromDeed(who, deed))
+			DestroyItem(deed);
+		endif
+	else
+		SendSysMessage(who, "You must be near a "+(GetObjProperty(deed, "type"))+" shop to use this contract.");
+		return 0;
+	endif
 endprogram
 
 function NearNPC(who, type)
-
-  var MOBS_Near := ListMobilesNearLocation(who.x, who.y, who.z, 10);
-  foreach mobile in MOBS_Near
-    if( lower(GetObjProperty(mobile, "MerchantType")) == type)
-      return 1;
-    endif
-  endforeach
-  return 0;
-
+	var MOBS_Near := ListMobilesNearLocation(who.x, who.y, who.z, 10);
+	foreach mobile in MOBS_Near
+		if( lower(GetObjProperty(mobile, "MerchantType")) == type)
+			return 1;
+		endif
+	endforeach
+	return 0;
 endfunction
 
 function RepairFromDeed(who, deed)
+	var skillid := GetObjProperty(deed, "skillid");
+	var what := SelectiveRepair(who, skillid);
+	if(!what)
+		return 0;
+	endif
+	var maxhp := what.maxhp;
+	maxhp := CInt(maxhp * what.quality);
+	var thehp := what.hp;
+	var damaged := maxhp - thehp;
+	var hisskill := GetObjProperty(deed, "ramt");
+	var damageamount := 0.0;
+	damageamount := (125 -  hisskill)/3000.0;
+	if(what.hp == what.maxhp)
+		SendSysMessage(who, "That is already in full repair.");
+		return 0;
+	endif
+	if((what.hp <= 0) || (what.quality <= 0.1) || (!what.quality))
+		SendSysMessage(who, "You destroyed the item.");
+		DestroyItem(what);
+		return 1;
+	endif
+	if(what.quality <= damageamount)
+		SendSysMessage(who, "That item has been repaired many times, and will break if repairs are attempted again.");
+		return 0;
+	endif
+	if((what.hp <= 0) || (what.quality <= 0.1) || (!what.quality))
+		SendSysMessage(who, "You destroyed the item.");
+		DestroyItem(what);
+		return 1;
+	endif
+	var repaired_amount := CInt(((randomint(hisskill) + 1))/2);
+	print("repair: " + repaired_amount + " / " + (maxhp / 3));
+	if(repaired_amount < (maxhp / 3))
+		SendSysMessage(who, "You fail to repair the item and the repair contract is destroyed.");
+		return 1;
+	endif
+	if(damaged == 1)
+		repaired_amount := 1;
+	endif
+	what.quality := what.quality - damageamount;
+	if (thehp + repaired_amount > what.maxhp)
+		what.hp := what.maxhp;
+		EraseObjProperty(what, "swings");
+		SendSysMessage(who, "You repair the item.");
+	else
+		what.hp := thehp + repaired_amount;
+		SendSysMessage(who, "You repair the item");
+	endif
 
-  var skillid := GetObjProperty(deed, "skillid");
-  var what := SelectiveRepair(who, skillid);
-  if(!what)
-    return 0;
-  endif
-  var maxhp := what.maxhp;
-  maxhp := CInt(maxhp * what.quality);
-  var thehp := what.hp;
-  var damaged := maxhp - thehp;
-  var hisskill := GetObjProperty(deed, "ramt");
-  var damageamount := 0.0;
-  damageamount := (125 -  hisskill)/3000.0;
-  if(what.hp == what.maxhp)
-    SendSysMessage(who, "That is already in full repair.");
-    return 0;
-  endif
-  if((what.hp <= 0) || (what.quality <= 0.1) || (!what.quality))
-    SendSysMessage(who, "You destroyed the item.");
-    DestroyItem(what);
-    return 1;
-  endif
-  if(what.quality <= damageamount)
-    SendSysMessage(who, "That item has been repaired many times, and will break if repairs are attempted again.");
-    return 0;
-  endif
-  if((what.hp <= 0) || (what.quality <= 0.1) || (!what.quality))
-    SendSysMessage(who, "You destroyed the item.");
-    DestroyItem(what);
-    return 1;
-  endif
-  var repaired_amount := CInt(((randomint(hisskill) + 1))/2);
-  print("repair: " + repaired_amount + " / " + (maxhp / 3));
-  if(repaired_amount < (maxhp / 3))
-    SendSysMessage(who, "You fail to repair the item and the repair contract is destroyed.");
-    return 1;
-  endif
-  if(damaged == 1)
-    repaired_amount := 1;
-  endif
-  what.quality := what.quality - damageamount;
-  if (thehp + repaired_amount > what.maxhp)
-    what.hp := what.maxhp;
-    EraseObjProperty(what, "swings");
-    SendSysMessage(who, "You repair the item.");
-  else
-    what.hp := thehp + repaired_amount;
-    SendSysMessage(who, "You repair the item");
-  endif
-
-  return 1;
-
+	return 1;
 endfunction
 
+
 function SelectiveRepair(who, skillid)
 
-  SendSysMessage(who, "Select item to repair.");
-  var use_on := Target(who);
-  if(!can_access(who, use_on, "reserve"))
-    return;
-  endif
-  if(use_on.movable == 0)
-    SendSysMessage(who, "You cannot repair that");
-    return;
-  endif
-  if((!Accessible(who, use_on)) or (Distance(who, use_on) > 2))
-    SendSysMessage(who, "You cannot reach that");
-    return;
-  endif
-  if(use_on.container.serial != who.backpack.serial)
-    SendSysMessage(who, "The item must be in your backpack to repair it.");
-    return;
-  endif
-  if(is_repairable(who, use_on.objtype, skillid))
-    return use_on;
-  else
-    return 0;
-  endif
-
+	SendSysMessage(who, "Select item to repair.");
+	var use_on := Target(who);
+	if(!can_access(who, use_on, "reserve"))
+		return 0;
+	endif
+	if((!Accessible(who, use_on)) || (distance(who, use_on) > 2))
+		SendSysMessage(who, "You cannot reach that");
+		return 0;
+	endif
+	if( !(use_on in EnumerateItemsInContainer(who.backpack)) )
+		SendSysMessage(who, "The item must be in your backpack to repair it.");
+		return 0;
+	endif
+	if(is_repairable(who, use_on.objtype, skillid))
+		return use_on;
+	else
+		return 0;
+	endif
 endfunction
 
 function is_repairable(who, what, skillid)
-
-  var skill_cfg;
-  case(CInt(skillid))
-     7: skill_cfg := ReadConfigFile(":blacksmithy:blacksmithy");
-     8: skill_cfg := ReadConfigFile(":bowcraft:bowcraft");
-    11: skill_cfg := ReadConfigFile(":carpentry:carpentry");
-    34: skill_cfg := ReadConfigFile(":tailoring:tailoring");
-  endcase
-  var itemcfg := ReadConfigFile(":*:itemdesc");
-  var elem := FindConfigElem(itemcfg, what);
-  var skillref := FindConfigElem(skill_cfg, what);
-  var repairable := GetConfigInt(elem,"repairable");
-  if(skillref)
-    if(repairable == 1)
-      return 1;
-    else
-      SendSysMessage(who, "The item cannot be repaired");
-      return 0;
-    endif
-  else
-    SendSysMessage(who, "You cannot repair that item with this type of repair contract.");
-    return 0;
-  endif
-
+	var skill_cfg;
+	case(CInt(skillid))
+		7: skill_cfg := ReadConfigFile(":blacksmithy:blacksmithy");
+		8: skill_cfg := ReadConfigFile(":bowcraft:bowcraft");
+		11: skill_cfg := ReadConfigFile(":carpentry:carpentry");
+		34: skill_cfg := ReadConfigFile(":tailoring:tailoring");
+	endcase
+	var itemcfg := ReadConfigFile(":*:itemdesc");
+	var elem := FindConfigElem(itemcfg, what);
+	var skillref := FindConfigElem(skill_cfg, what);
+	var repairable := GetConfigInt(elem,"repairable");
+	if(skillref)
+		if(repairable == 1)
+			return 1;
+		else
+			SendSysMessage(who, "The item cannot be repaired");
+			return 0;
+		endif
+	else
+		SendSysMessage(who, "You cannot repair that item with this type of repair contract.");
+		return 0;
+	endif
 endfunction



From austin at berlios.de  Sun Nov  6 18:45:49 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 18:45:49 +0100
Subject: [Poldistro-svn] r928 - in trunk/096/pkg/items/walkOn: . energyField fireField paraField poisonField spiderWeb
Message-ID: <200511061745.jA6HjnRe006327@sheep.berlios.de>

Author: austin
Date: 2005-11-06 18:45:47 +0100 (Sun, 06 Nov 2005)
New Revision: 928

Added:
   trunk/096/pkg/items/walkOn/energyField/control.src
   trunk/096/pkg/items/walkOn/energyField/methods.src
   trunk/096/pkg/items/walkOn/fireField/methods.src
   trunk/096/pkg/items/walkOn/paraField/methods.src
   trunk/096/pkg/items/walkOn/poisonField/methods.src
   trunk/096/pkg/items/walkOn/spiderWeb/methods.src
Modified:
   trunk/096/pkg/items/walkOn/energyField/walkOn.src
   trunk/096/pkg/items/walkOn/fireField/control.src
   trunk/096/pkg/items/walkOn/itemdesc.cfg
   trunk/096/pkg/items/walkOn/paraField/control.src
   trunk/096/pkg/items/walkOn/poisonField/control.src
   trunk/096/pkg/items/walkOn/spiderWeb/control.src
Log:
Added method scripts to tiles. 
IsExpired() method used in scripts to control when/if tiles are removed.


Added: trunk/096/pkg/items/walkOn/energyField/control.src
===================================================================
--- trunk/096/pkg/items/walkOn/energyField/control.src	2005-11-06 15:54:53 UTC (rev 927)
+++ trunk/096/pkg/items/walkOn/energyField/control.src	2005-11-06 17:45:47 UTC (rev 928)
@@ -0,0 +1,17 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+
+program control(field)
+	while ( field )
+		sleep(1);
+		if ( field.IsExpired() )
+			DestroyItem(field);
+			return 1;
+		endif
+	endwhile
+endprogram

Added: trunk/096/pkg/items/walkOn/energyField/methods.src
===================================================================
--- trunk/096/pkg/items/walkOn/energyField/methods.src	2005-11-06 15:54:53 UTC (rev 927)
+++ trunk/096/pkg/items/walkOn/energyField/methods.src	2005-11-06 17:45:47 UTC (rev 928)
@@ -0,0 +1,31 @@
+/* $Id$
+ * 
+ */
+ 
+use uo;
+
+
+program Install()
+	return 1;
+endprogram
+
+exported function SetDuration(field, seconds)
+	seconds := CInt(seconds);
+	
+	return SetObjProperty(field, "Duration", ReadGameClock()+seconds);
+endfunction
+
+exported function GetDuration(field)
+	var duration := CInt(GetObjProperty(field, "Duration"));
+	
+	return duration;
+endfunction
+
+exported function IsExpired(field)
+	var duration := GetDuration(field);
+	if ( !duration )
+		return 0;
+	endif
+	
+	return ( duration < ReadGameClock() );
+endfunction

Modified: trunk/096/pkg/items/walkOn/energyField/walkOn.src
===================================================================
--- trunk/096/pkg/items/walkOn/energyField/walkOn.src	2005-11-06 15:54:53 UTC (rev 927)
+++ trunk/096/pkg/items/walkOn/energyField/walkOn.src	2005-11-06 17:45:47 UTC (rev 928)
@@ -0,0 +1,15 @@
+/*
+ * $Id$
+ *
+ */
+ 
+use uo;
+
+
+program walkOn(mobile, tile, last_x, last_y, last_z)
+	tile := tile; // Compiler warning
+	MoveObjectToLocation(mobile, last_x, last_y, last_z, mobile.realm);
+	return 1;
+endprogram
+
+	
\ No newline at end of file

Modified: trunk/096/pkg/items/walkOn/fireField/control.src
===================================================================
--- trunk/096/pkg/items/walkOn/fireField/control.src	2005-11-06 15:54:53 UTC (rev 927)
+++ trunk/096/pkg/items/walkOn/fireField/control.src	2005-11-06 17:45:47 UTC (rev 928)
@@ -34,6 +34,11 @@
 			//Someone just walked onto the tile.
 			BurnMobile(event, dmg_dice);
 		endif
+		
+		if ( field.IsExpired() )
+			DestroyItem(field);
+			return 1;
+		endif
 	endwhile
 endprogram
 

Added: trunk/096/pkg/items/walkOn/fireField/methods.src
===================================================================
--- trunk/096/pkg/items/walkOn/fireField/methods.src	2005-11-06 15:54:53 UTC (rev 927)
+++ trunk/096/pkg/items/walkOn/fireField/methods.src	2005-11-06 17:45:47 UTC (rev 928)
@@ -0,0 +1,31 @@
+/* $Id$
+ * 
+ */
+ 
+use uo;
+
+
+program Install()
+	return 1;
+endprogram
+
+exported function SetDuration(field, seconds)
+	seconds := CInt(seconds);
+	
+	return SetObjProperty(field, "Duration", ReadGameClock()+seconds);
+endfunction
+
+exported function GetDuration(field)
+	var duration := CInt(GetObjProperty(field, "Duration"));
+	
+	return duration;
+endfunction
+
+exported function IsExpired(field)
+	var duration := GetDuration(field);
+	if ( !duration )
+		return 0;
+	endif
+	
+	return ( duration < ReadGameClock() );
+endfunction

Modified: trunk/096/pkg/items/walkOn/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/walkOn/itemdesc.cfg	2005-11-06 15:54:53 UTC (rev 927)
+++ trunk/096/pkg/items/walkOn/itemdesc.cfg	2005-11-06 17:45:47 UTC (rev 928)
@@ -9,8 +9,9 @@
 	Movable		0
 	SaveOnExit	0
 
-	ControlScript	spiderweb/control
-	WalkOnScript	spiderweb/walkOn
+	ControlScript	spiderWeb/control
+	MethodScript	spiderWeb/methods
+	WalkOnScript	spiderWeb/walkOn
 }
 
 Item 0x398C
@@ -23,6 +24,7 @@
 	SaveOnExit	0
 
 	ControlScript	fireField/control
+	MethodScript	fireField/methods
 	WalkOnScript	fireField/walkOn
 }
 Item 0x3996
@@ -35,6 +37,7 @@
 	SaveOnExit	0
 
 	ControlScript	fireField/control
+	MethodScript	fireField/methods
 	WalkOnScript	fireField/walkOn
 }
 
@@ -47,6 +50,7 @@
 	Movable		0
 
 	ControlScript	poisonField/control
+	MethodScript	poisonField/methods
 	WalkOnScript	poisonField/walkOn
 }
 Item 0x3920
@@ -58,6 +62,7 @@
 	Movable		0
 
 	ControlScript	poisonField/control
+	MethodScript	poisonField/methods
 	WalkOnScript	poisonField/walkOn
 }
 
@@ -69,6 +74,7 @@
 	Movable		0
 
 	ControlScript	paraField/control
+	MethodScript	paraField/methods
 	WalkOnScript	paraField/walkOn
 }
 
@@ -80,6 +86,7 @@
 	Movable		0
 
 	ControlScript	paraField/control
+	MethodScript	paraField/methods
 	WalkOnScript	paraField/walkOn
 }
 

Modified: trunk/096/pkg/items/walkOn/paraField/control.src
===================================================================
--- trunk/096/pkg/items/walkOn/paraField/control.src	2005-11-06 15:54:53 UTC (rev 927)
+++ trunk/096/pkg/items/walkOn/paraField/control.src	2005-11-06 17:45:47 UTC (rev 928)
@@ -36,6 +36,11 @@
 			//Someone just walked onto the tile.
 			ParalyzeMobile(event, duration);
 		endif
+		
+		if ( field.IsExpired() )
+			DestroyItem(field);
+			return 1;
+		endif
 	endwhile
 endprogram
 

Added: trunk/096/pkg/items/walkOn/paraField/methods.src
===================================================================
--- trunk/096/pkg/items/walkOn/paraField/methods.src	2005-11-06 15:54:53 UTC (rev 927)
+++ trunk/096/pkg/items/walkOn/paraField/methods.src	2005-11-06 17:45:47 UTC (rev 928)
@@ -0,0 +1,31 @@
+/* $Id$
+ * 
+ */
+ 
+use uo;
+
+
+program Install()
+	return 1;
+endprogram
+
+exported function SetDuration(field, seconds)
+	seconds := CInt(seconds);
+	
+	return SetObjProperty(field, "Duration", ReadGameClock()+seconds);
+endfunction
+
+exported function GetDuration(field)
+	var duration := CInt(GetObjProperty(field, "Duration"));
+	
+	return duration;
+endfunction
+
+exported function IsExpired(field)
+	var duration := GetDuration(field);
+	if ( !duration )
+		return 0;
+	endif
+	
+	return ( duration < ReadGameClock() );
+endfunction

Modified: trunk/096/pkg/items/walkOn/poisonField/control.src
===================================================================
--- trunk/096/pkg/items/walkOn/poisonField/control.src	2005-11-06 15:54:53 UTC (rev 927)
+++ trunk/096/pkg/items/walkOn/poisonField/control.src	2005-11-06 17:45:47 UTC (rev 928)
@@ -36,6 +36,11 @@
 			//Someone just walked onto the tile.
 			PoisonMobile(event, poison_level, creator);
 		endif
+		
+		if ( field.IsExpired() )
+			DestroyItem(field);
+			return 1;
+		endif
 	endwhile
 endprogram
 

Added: trunk/096/pkg/items/walkOn/poisonField/methods.src
===================================================================
--- trunk/096/pkg/items/walkOn/poisonField/methods.src	2005-11-06 15:54:53 UTC (rev 927)
+++ trunk/096/pkg/items/walkOn/poisonField/methods.src	2005-11-06 17:45:47 UTC (rev 928)
@@ -0,0 +1,31 @@
+/* $Id$
+ * 
+ */
+ 
+use uo;
+
+
+program Install()
+	return 1;
+endprogram
+
+exported function SetDuration(field, seconds)
+	seconds := CInt(seconds);
+	
+	return SetObjProperty(field, "Duration", ReadGameClock()+seconds);
+endfunction
+
+exported function GetDuration(field)
+	var duration := CInt(GetObjProperty(field, "Duration"));
+	
+	return duration;
+endfunction
+
+exported function IsExpired(field)
+	var duration := GetDuration(field);
+	if ( !duration )
+		return 0;
+	endif
+	
+	return ( duration < ReadGameClock() );
+endfunction

Modified: trunk/096/pkg/items/walkOn/spiderWeb/control.src
===================================================================
--- trunk/096/pkg/items/walkOn/spiderWeb/control.src	2005-11-06 15:54:53 UTC (rev 927)
+++ trunk/096/pkg/items/walkOn/spiderWeb/control.src	2005-11-06 17:45:47 UTC (rev 928)
@@ -7,6 +7,11 @@
 use os;
 
 program RemoveWeb(web)
-	sleep(60);
-	DestroyItem(web);
+	while ( web )
+		sleep(1);
+		if ( web.IsExpired() )
+			DestroyItem(web);
+			break;
+		endif
+	endwhile
 endprogram
\ No newline at end of file

Added: trunk/096/pkg/items/walkOn/spiderWeb/methods.src
===================================================================
--- trunk/096/pkg/items/walkOn/spiderWeb/methods.src	2005-11-06 15:54:53 UTC (rev 927)
+++ trunk/096/pkg/items/walkOn/spiderWeb/methods.src	2005-11-06 17:45:47 UTC (rev 928)
@@ -0,0 +1,31 @@
+/* $Id$
+ * 
+ */
+ 
+use uo;
+
+
+program Install()
+	return 1;
+endprogram
+
+exported function SetDuration(field, seconds)
+	seconds := CInt(seconds);
+	
+	return SetObjProperty(field, "Duration", ReadGameClock()+seconds);
+endfunction
+
+exported function GetDuration(field)
+	var duration := CInt(GetObjProperty(field, "Duration"));
+	
+	return duration;
+endfunction
+
+exported function IsExpired(field)
+	var duration := GetDuration(field);
+	if ( !duration )
+		return 0;
+	endif
+	
+	return ( duration < ReadGameClock() );
+endfunction



From austin at berlios.de  Sun Nov  6 18:47:40 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 18:47:40 +0100
Subject: [Poldistro-svn] r929 - trunk/096/pkg/mobiles/brainAI/scripts/combat
Message-ID: <200511061747.jA6Hle5w007011@sheep.berlios.de>

Author: austin
Date: 2005-11-06 18:47:39 +0100 (Sun, 06 Nov 2005)
New Revision: 929

Modified:
   trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
Log:
Supports fire field auto-decay.

Modified: trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-06 17:45:47 UTC (rev 928)
+++ trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-06 17:47:39 UTC (rev 929)
@@ -110,8 +110,7 @@
 	foreach coord in coord_list
 		if ( _coord_iter > 1 )
 			var field := CreateItemAtLocation(coord.x, coord.y, npc.z, "FireFieldNS", 1);
-			field.SetDamageDice("1d2");
-			field.SetFieldDuration("3");
+			field.SetDuration(3);
 			sleepms(105);
 		endif
 	endforeach



From austin at berlios.de  Sun Nov  6 18:56:52 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 18:56:52 +0100
Subject: [Poldistro-svn] r930 - in trunk/096/pkg/mobiles/brainAI: . scripts/combat
Message-ID: <200511061756.jA6Huqjx011765@sheep.berlios.de>

Author: austin
Date: 2005-11-06 18:56:50 +0100 (Sun, 06 Nov 2005)
New Revision: 930

Modified:
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
   trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
Log:
Fixed some firebeetle errors, because I suck.

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-06 17:47:39 UTC (rev 929)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-06 17:56:50 UTC (rev 930)
@@ -194,7 +194,7 @@
 NPCTemplate FireBeetle
 {
 	Name			a fire beetle
-	Script			:ai_brain:brain
+	Script			:brainAI:brain
 	ObjType			0x30
 	Color			2118
 	TrueColor		2118
@@ -216,16 +216,16 @@
 	STAM			100
 
 	// Intrinsic Weapon
-	AttackAttribute		WAR_Wrestling
+	AttackAttribute		Wrestling
 	AttackSpeed		10
 	AttackDamage		5d5
 	AttackHitScript		:combat:mainHitScript
 		
 	// Sounds
-	AttackHitSound		a1:i390
-	AttackMissSound		a1:i569
-	DeathSound		a1:i392
-	DamagedSound		a1:i391
+	AttackHitSounds		a1:i390
+	AttackMissSounds	a1:i569
+	DeathSounds		a1:i392
+	DamagedSounds		a1:i391
 	IdleSounds		a1:i398
 
 	// Brain AI Settings

Modified: trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-06 17:47:39 UTC (rev 929)
+++ trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-06 17:56:50 UTC (rev 930)
@@ -44,9 +44,9 @@
 			endif
 			AI_EndNerve(npc, nerve_name);
 		elseif ( dist <= 5 )
-			AI_Move(npc, opponent, NEMOVE_AWAY, NEMOVE_RUN, WAKEUP, (12-dist));
-		elseif( dist > 5 )
-			AI_Move(npc, opponent, NEMOVE_TOWARD, NEMOVE_RUN, WAKEUP, dist+1);
+			AI_Move(npc, opponent, NEMOVE_AWAY, NEMOVE_RUN, WAKEUP, (6-dist));
+		elseif( dist > 6 )
+			AI_Move(npc, opponent, NEMOVE_TOWARD, NEMOVE_RUN, WAKEUP, (dist-5));
 		endif
 
 		SpecialAttack(npc, opponent, dist);
@@ -109,7 +109,7 @@
 	var coord_list := GetCoordsInLine(npc.x, npc.y, opponent.x, opponent.y);
 	foreach coord in coord_list
 		if ( _coord_iter > 1 )
-			var field := CreateItemAtLocation(coord.x, coord.y, npc.z, "FireFieldNS", 1);
+			var field := CreateItemAtLocation(coord.x, coord.y, npc.z, "FireField_NS", 1);
 			field.SetDuration(3);
 			sleepms(105);
 		endif



From austin at berlios.de  Sun Nov  6 19:14:29 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 19:14:29 +0100
Subject: [Poldistro-svn] r931 - trunk/096/pkg/mobiles/brainAI/scripts/combat
Message-ID: <200511061814.jA6IETwt020394@sheep.berlios.de>

Author: austin
Date: 2005-11-06 19:14:28 +0100 (Sun, 06 Nov 2005)
New Revision: 931

Modified:
   trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
Log:
Properly runs away and returns now to make a shot.

Modified: trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-06 17:56:50 UTC (rev 930)
+++ trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-06 18:14:28 UTC (rev 931)
@@ -12,6 +12,7 @@
 include "include/shapes";
 include "include/client";
 include "include/sounds";
+include "include/facings";
 
 program BrainNerve(params)
 	var npc		:= params[1];
@@ -43,10 +44,12 @@
 				AI_WarMode(npc, 0);
 			endif
 			AI_EndNerve(npc, nerve_name);
-		elseif ( dist <= 5 )
-			AI_Move(npc, opponent, NEMOVE_AWAY, NEMOVE_RUN, WAKEUP, (6-dist));
-		elseif( dist > 6 )
-			AI_Move(npc, opponent, NEMOVE_TOWARD, NEMOVE_RUN, WAKEUP, (dist-5));
+		elseif ( dist <= 6 )
+			AI_Move(npc, opponent, NEMOVE_AWAY, NEMOVE_RUN, WAKEUP, (7-dist));
+		elseif( dist > 10 )
+			AI_Move(npc, opponent, NEMOVE_TOWARD, NEMOVE_RUN, WAKEUP, (dist-10));
+		else
+			npc.facing := GetFacing(npc.x, npc.y, opponent.x, opponent.y);
 		endif
 
 		SpecialAttack(npc, opponent, dist);
@@ -108,32 +111,35 @@
 
 	var coord_list := GetCoordsInLine(npc.x, npc.y, opponent.x, opponent.y);
 	foreach coord in coord_list
-		if ( _coord_iter > 1 )
-			var field := CreateItemAtLocation(coord.x, coord.y, npc.z, "FireField_NS", 1);
-			field.SetDuration(3);
-			sleepms(105);
+		if ( _coord_iter == 1 ) // Dont make one where its standing
+			continue;
 		endif
+		
+		var field := CreateItemAtLocation(coord.x, coord.y, npc.z, "FireField_NS", 1);
+		field.SetDuration(2);
+		sleepms(105);
 	endforeach
 
 	PlaySoundEffect(opponent, 0x208);
 	ApplyRawDamage(opponent, RandomDiceRoll("3d7"));
 
 	foreach coord in GetCoordsInSquare(opponent.x, opponent.y, 3)
-		if ( RandomInt(2) == 1 )
-			case(RandomInt(3))
-				default:
-					PlayStationaryEffect(coord.x, coord.y, npc.z, FX_EXPLODE_1, 10, 10, 0);
-					break;
-				1:
-					PlayStationaryEffect(coord.x, coord.y, npc.z, FX_EXPLODE_2, 10, 10, 0);
-					break;
-				2:
-					PlayStationaryEffect(coord.x, coord.y, npc.z, FX_EXPLODE_3, 10, 10, 0);
-					break;
-			endcase
-			var field := CreateItemAtLocation(coord.x, coord.y, opponent.z, "FireFieldNS", 1);
-			field.SetDuration("1d3");
+		if ( RandomInt(2) != 1 ) // Don't place a fire field
+			continue;
 		endif
+		case( RandomInt(3) )
+			default:
+				PlayStationaryEffect(coord.x, coord.y, npc.z, FX_EXPLODE_1, 10, 10, 0);
+				break;
+			1:
+				PlayStationaryEffect(coord.x, coord.y, npc.z, FX_EXPLODE_2, 10, 10, 0);
+				break;
+			2:
+				PlayStationaryEffect(coord.x, coord.y, npc.z, FX_EXPLODE_3, 10, 10, 0);
+				break;
+		endcase
+		var field := CreateItemAtLocation(coord.x, coord.y, opponent.z, "FireFieldNS", 1);
+		field.SetDuration(5);
 		sleepms(5);
 	endforeach
 	



From austin at berlios.de  Sun Nov  6 19:18:48 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 19:18:48 +0100
Subject: [Poldistro-svn] r932 - in trunk/096/pkg/mobiles/brainAI: . scripts/combat
Message-ID: <200511061818.jA6IImwm022704@sheep.berlios.de>

Author: austin
Date: 2005-11-06 19:18:46 +0100 (Sun, 06 Nov 2005)
New Revision: 932

Modified:
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
   trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
Log:
Added demonstration of MinRange, MaxRange settings.

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-06 18:14:28 UTC (rev 931)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-06 18:18:46 UTC (rev 932)
@@ -235,6 +235,8 @@
 	AISetting	FleeLevel	i20
 	AISetting	IdleTicks	i20
 	AISetting	SleepWait	i1000
+	AISetting	MinRange	i6
+	AISetting	MaxRange	i10
 	
 	// Brain AI Nerves
 	// Brain AI Nerves

Modified: trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-06 18:14:28 UTC (rev 931)
+++ trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-06 18:18:46 UTC (rev 932)
@@ -44,10 +44,10 @@
 				AI_WarMode(npc, 0);
 			endif
 			AI_EndNerve(npc, nerve_name);
-		elseif ( dist <= 6 )
-			AI_Move(npc, opponent, NEMOVE_AWAY, NEMOVE_RUN, WAKEUP, (7-dist));
-		elseif( dist > 10 )
-			AI_Move(npc, opponent, NEMOVE_TOWARD, NEMOVE_RUN, WAKEUP, (dist-10));
+		elseif ( dist <= settings["MinRange"] )
+			AI_Move(npc, opponent, NEMOVE_AWAY, NEMOVE_RUN, WAKEUP, (settings["MinRange"]-dist));
+		elseif( dist > settings["MaxRange"] )
+			AI_Move(npc, opponent, NEMOVE_TOWARD, NEMOVE_RUN, WAKEUP, (dist-settings["MaxRange"]));
 		else
 			npc.facing := GetFacing(npc.x, npc.y, opponent.x, opponent.y);
 		endif



From austin at berlios.de  Sun Nov  6 19:32:01 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 19:32:01 +0100
Subject: [Poldistro-svn] r933 - trunk/096/scripts/include
Message-ID: <200511061832.jA6IW15S028494@sheep.berlios.de>

Author: austin
Date: 2005-11-06 19:31:59 +0100 (Sun, 06 Nov 2005)
New Revision: 933

Added:
   trunk/096/scripts/include/damage.inc
Log:


Added: trunk/096/scripts/include/damage.inc
===================================================================
--- trunk/096/scripts/include/damage.inc	2005-11-06 18:18:46 UTC (rev 932)
+++ trunk/096/scripts/include/damage.inc	2005-11-06 18:31:59 UTC (rev 933)
@@ -0,0 +1,100 @@
+use uo;
+use os;
+use math;
+use cfgfile;
+
+enum DAMAGE_TYPES
+	DMG_DEFAULT	:= "Default",
+	DMG_COLD	:= "Cold",
+	DMG_FIRE	:= "Fire",
+	DMG_POISON	:= "Poison",
+	DMG_MAGERY	:= "Magery",
+endenum
+
+function ApplyDamageEX(mobile, amount, type:=DMG_DEFAULT, source:=0)
+	amount := CalcDamageAmount(mobile, amount, type, source);
+	
+	if ( amount == error )
+		return 0;
+	elseif ( amount < 0 )
+		HealDamage(mobile, Abs(amount));
+	else
+		if ( source )
+			SetLastDamageInfo(mobile, amount, type, source);
+			SetScriptController(source);
+		endif
+		ApplyDamage(mobile, amount);
+	endif
+	
+	return amount;
+endfunction
+
+function ApplyRawDamageEX(mobile, amount, type:=DMG_DEFAULT, source:=0)
+	amount := CalcDamageAmount(mobile, amount, type, source);
+	
+	if ( amount == error )
+		return 0;	
+	elseif ( amount < 0 )
+		HealDamage(mobile, Abs(amount));
+	else
+		if ( source )
+			SetLastDamageInfo(mobile, amount, type, source);
+			SetScriptController(source);
+		endif
+		ApplyRawDamage(mobile, amount);
+	endif
+	
+	return amount;
+endfunction
+
+function CalcDamageAmount(mobile, amount, type, source)
+	var resistance := error;
+	var res_prop := GetObjProperty(mobile, "Resistances");
+	if ( res_prop.Exists(type) )
+		resistance := CDbl(res_prop[type]);
+	elseif ( mobile.npctemplate )
+		var npc_cfg := ReadConfigFile("::npcdesc");
+		var npc_elem := npc_cfg[mobile.npctemplate];
+		if ( GetConfigReal(npc_elem, type+"-ResistMult") != error )
+			resistance := GetConfigReal(npc_elem, type+"-ResistMult");
+		endif
+	endif
+			
+	if ( resistance == error )
+		// Do nothing, there is no resistance.
+	elseif ( resistance == 0.0 )
+		// mobile is immune.
+		amount := 0;
+	elseif ( resistance )
+		// NPC has a resistance multiplier
+		amount := CInt(amount * resistance);
+	endif
+		
+	return CInt(amount);
+endfunction
+
+function SetLastDamageInfo(mobile, amount, type, source)
+	var last_damage := struct;
+	last_damage.+serial	:= source.serial;
+	last_damage.+time	:= polcore().systime;
+	last_damage.+amount	:= amount;
+	last_damage.+type	:= type;
+	
+	if ( last_damage.acctname )
+		last_damage.+acctname := source.acctname;
+	endif
+	if ( source.name )
+		last_damage.+name := source.name;
+	else
+		last_damage.+name := source.desc;
+	endif
+	
+	SetObjProperty(mobile, "LastDamage", last_damage);
+	
+	return last_damage;
+endfunction
+
+function GetLastDamageInfo(mobile)
+	return GetObjProperty(mobile, "LastDamage");
+endfunction
+



From austin at berlios.de  Sun Nov  6 19:43:43 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 6 Nov 2005 19:43:43 +0100
Subject: [Poldistro-svn] r934 - trunk/096/scripts/include
Message-ID: <200511061843.jA6IhhIs004339@sheep.berlios.de>

Author: austin
Date: 2005-11-06 19:43:41 +0100 (Sun, 06 Nov 2005)
New Revision: 934

Modified:
   trunk/096/scripts/include/damage.inc
Log:
First draft of the new damage system.

Allows us to control modifiers so some players/npcs take more/less damage to certain damage types.

Also has functions to track / retrieve last damage information.

Modified: trunk/096/scripts/include/damage.inc
===================================================================
--- trunk/096/scripts/include/damage.inc	2005-11-06 18:31:59 UTC (rev 933)
+++ trunk/096/scripts/include/damage.inc	2005-11-06 18:43:41 UTC (rev 934)
@@ -3,6 +3,8 @@
 use math;
 use cfgfile;
 
+include ":brainAI:npcUtil";
+
 enum DAMAGE_TYPES
 	DMG_DEFAULT	:= "Default",
 	DMG_COLD	:= "Cold",
@@ -11,8 +13,23 @@
 	DMG_MAGERY	:= "Magery",
 endenum
 
+/* 
+ * ApplyDamageEX(mobile, amount, type, source)
+ *
+ * Purpose
+ *
+ * Parameters
+ * mobile:	
+ * amount:	
+ * type:	
+ * source:	
+ *
+ * Return value
+ *
+ */
 function ApplyDamageEX(mobile, amount, type:=DMG_DEFAULT, source:=0)
-	amount := CalcDamageAmount(mobile, amount, type, source);
+	amount := CInt(amount);
+	amount := CalcDamageAmount(mobile, amount, type);
 	
 	if ( amount == error )
 		return 0;
@@ -29,8 +46,23 @@
 	return amount;
 endfunction
 
+/* 
+ * ApplyRawDamageEX(mobile, amount, type, source)
+ *
+ * Purpose
+ *
+ * Parameters
+ * mobile:	
+ * amount:	
+ * type:	
+ * source:	
+ *
+ * Return value
+ *
+ */
 function ApplyRawDamageEX(mobile, amount, type:=DMG_DEFAULT, source:=0)
-	amount := CalcDamageAmount(mobile, amount, type, source);
+	amount := CInt(amount);
+	amount := CalcDamageAmount(mobile, amount, type);
 	
 	if ( amount == error )
 		return 0;	
@@ -47,32 +79,66 @@
 	return amount;
 endfunction
 
-function CalcDamageAmount(mobile, amount, type, source)
-	var resistance := error;
+/* 
+ * CalcDamageAmount(mobile, amount, type)
+ *
+ * Purpose
+ *
+ * Parameters
+ * mobile:	
+ * amount:	
+ * type:		
+ *
+ * Return value
+ *
+ */
+function CalcDamageAmount(mobile, amount, type)
+	amount := CInt(amount);
+	
+	var resistance_mult := error;
 	var res_prop := GetObjProperty(mobile, "Resistances");
 	if ( res_prop.Exists(type) )
-		resistance := CDbl(res_prop[type]);
+		// Resistances CProp overrides the NPCDESC.CFG settings.
+		// Can also be used on players for their resistances.
+		resistance_mult := CDbl(res_prop[type]);
 	elseif ( mobile.npctemplate )
-		var npc_cfg := ReadConfigFile("::npcdesc");
-		var npc_elem := npc_cfg[mobile.npctemplate];
-		if ( GetConfigReal(npc_elem, type+"-ResistMult") != error )
-			resistance := GetConfigReal(npc_elem, type+"-ResistMult");
+		// Looks for type-ResistMult in the NPCDESC.CFG
+		// Example 'Default-ResistMult 0.0' means the NPC is immune to normal damage.
+		// 'Fire-ResistMult 2.0' means fire does double damage to the NPC.
+		var npc_elem := NPC_GetNPCConfig(mobile);
+		var temp := GetConfigReal(npc_elem, type+"-ResistMult");
+		if (  temp != error )
+			resistance_mult := temp;
 		endif
 	endif
 			
-	if ( resistance == error )
+	if ( resistance_mult == error )
 		// Do nothing, there is no resistance.
-	elseif ( resistance == 0.0 )
-		// mobile is immune.
+	elseif ( resistance_mult == 0.0 )
+		// Mobile is immune.
 		amount := 0;
-	elseif ( resistance )
-		// NPC has a resistance multiplier
-		amount := CInt(amount * resistance);
+	elseif ( resistance_mult )
+		// Mobile has a resistance multiplier
+		amount := CInt(amount * resistance_mult);
 	endif
 		
 	return CInt(amount);
 endfunction
 
+/* 
+ * SetLastDamageInfo(mobile, amount, type, source)
+ *
+ * Purpose
+ *
+ * Parameters
+ * mobile:	
+ * amount:	
+ * type:	
+ * source:	
+ *
+ * Return value
+ *
+ */
 function SetLastDamageInfo(mobile, amount, type, source)
 	var last_damage := struct;
 	last_damage.+serial	:= source.serial;
@@ -94,6 +160,17 @@
 	return last_damage;
 endfunction
 
+/* 
+ * GetLastDamageInfo(mobile)
+ *
+ * Purpose
+ *
+ * Parameters
+ * mobile:	
+ *
+ * Return value
+ *
+ */
 function GetLastDamageInfo(mobile)
 	return GetObjProperty(mobile, "LastDamage");
 endfunction



From austin at berlios.de  Mon Nov  7 01:34:59 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 7 Nov 2005 01:34:59 +0100
Subject: [Poldistro-svn] r935 - in trunk/096: pkg/items/walkOn pkg/items/walkOn/energyField pkg/items/walkOn/fireField pkg/items/walkOn/paraField pkg/items/walkOn/poisonField pkg/items/walkOn/spiderWeb pkg/mobiles/timedScripts/subScripts/poison scripts/include
Message-ID: <200511070034.jA70YxmY013085@sheep.berlios.de>

Author: austin
Date: 2005-11-07 01:34:53 +0100 (Mon, 07 Nov 2005)
New Revision: 935

Modified:
   trunk/096/pkg/items/walkOn/energyField/methods.src
   trunk/096/pkg/items/walkOn/fireField/control.src
   trunk/096/pkg/items/walkOn/fireField/methods.src
   trunk/096/pkg/items/walkOn/itemdesc.cfg
   trunk/096/pkg/items/walkOn/paraField/control.src
   trunk/096/pkg/items/walkOn/paraField/methods.src
   trunk/096/pkg/items/walkOn/poisonField/control.src
   trunk/096/pkg/items/walkOn/poisonField/methods.src
   trunk/096/pkg/items/walkOn/spiderWeb/methods.src
   trunk/096/pkg/mobiles/timedScripts/subScripts/poison/defaultPoison.src
   trunk/096/scripts/include/damage.inc
Log:
Updated fields and defaultPoison to use damage.inc
Updated methods to support field ownership.

Added additional name to some tiles where the _ is omitted 
example: FireField_NS and FireFieldNS



Modified: trunk/096/pkg/items/walkOn/energyField/methods.src
===================================================================
--- trunk/096/pkg/items/walkOn/energyField/methods.src	2005-11-06 18:43:41 UTC (rev 934)
+++ trunk/096/pkg/items/walkOn/energyField/methods.src	2005-11-07 00:34:53 UTC (rev 935)
@@ -9,6 +9,10 @@
 	return 1;
 endprogram
 
+exported function IsEnergyField(field)
+	return 1;
+endfunction
+
 exported function SetDuration(field, seconds)
 	seconds := CInt(seconds);
 	
@@ -29,3 +33,20 @@
 	
 	return ( duration < ReadGameClock() );
 endfunction
+
+exported function SetOwner(field, serial)
+	if ( serial.IsA(POLCLASS_UOBJECT) )
+		serial := serial.serial;
+	endif
+	
+	return SetObjProperty(field, "Owner", serial);
+endfunction
+
+exported function GetOwner(field)
+	var owner := CInt(GetObjProperty(field, "Owner"));
+	if ( owner )
+		owner := SystemFindObjectBySerial(owner);
+	endif
+	
+	return owner;
+endfunction

Modified: trunk/096/pkg/items/walkOn/fireField/control.src
===================================================================
--- trunk/096/pkg/items/walkOn/fireField/control.src	2005-11-06 18:43:41 UTC (rev 934)
+++ trunk/096/pkg/items/walkOn/fireField/control.src	2005-11-07 00:34:53 UTC (rev 935)
@@ -7,12 +7,13 @@
 use os;
 use util;
 
+include "include/damage";
+
 program controlScript(field)
 	SetObjProperty(field, "#PID", GetPid());
 
-	var creator := CInt(GetObjProperty(field, "Creator"));
-	if ( creator.IsA(POLCLASS_MOBILE) )
-		creator := SystemFindObjectBySerial(creator);
+	var creator := field.GetOwner();
+	if ( creator )
 		SetScriptController(creator);
 	endif
 
@@ -55,7 +56,7 @@
 
 function BurnMobile(mobile, dmg_dice)
 	var dmg := RandomDiceRoll(dmg_dice); // - resistance ?
-	ApplyRawDamage(mobile, dmg);
+	ApplyRawDamageEX(mobile, dmg, DMG_FIRE);
 
 	return 1;
 endfunction

Modified: trunk/096/pkg/items/walkOn/fireField/methods.src
===================================================================
--- trunk/096/pkg/items/walkOn/fireField/methods.src	2005-11-06 18:43:41 UTC (rev 934)
+++ trunk/096/pkg/items/walkOn/fireField/methods.src	2005-11-07 00:34:53 UTC (rev 935)
@@ -9,6 +9,10 @@
 	return 1;
 endprogram
 
+exported function IsFireField(field)
+	return 1;
+endfunction
+
 exported function SetDuration(field, seconds)
 	seconds := CInt(seconds);
 	
@@ -29,3 +33,20 @@
 	
 	return ( duration < ReadGameClock() );
 endfunction
+
+exported function SetOwner(field, serial)
+	if ( serial.IsA(POLCLASS_UOBJECT) )
+		serial := serial.serial;
+	endif
+	
+	return SetObjProperty(field, "Owner", serial);
+endfunction
+
+exported function GetOwner(field)
+	var owner := CInt(GetObjProperty(field, "Owner"));
+	if ( owner )
+		owner := SystemFindObjectBySerial(owner);
+	endif
+	
+	return owner;
+endfunction

Modified: trunk/096/pkg/items/walkOn/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/walkOn/itemdesc.cfg	2005-11-06 18:43:41 UTC (rev 934)
+++ trunk/096/pkg/items/walkOn/itemdesc.cfg	2005-11-07 00:34:53 UTC (rev 935)
@@ -16,7 +16,8 @@
 
 Item 0x398C
 {
-	Name		firefield_ew
+	Name		FireField_EW
+	Name		fireFieldEW
 
 	Facing		2
 
@@ -29,7 +30,8 @@
 }
 Item 0x3996
 {
-	Name		firefield_ns
+	Name		FireField_NS
+	Name		FireFieldNS
 
 	Facing		2
 
@@ -43,7 +45,8 @@
 
 Item 0x3915
 {
-	Name		poisonfield_ns
+	Name		PoisonField_NS
+	Name		PoisonFieldNS
 	Facing		2
 
 	SaveOnExit	0
@@ -55,7 +58,8 @@
 }
 Item 0x3920
 {
-	Name		poisonfield_ew
+	Name		PoisonField_EW
+	Name		PoisonFieldEW
 	Facing		2
 
 	SaveOnExit	0
@@ -68,7 +72,7 @@
 
 Item 0x3967
 {
-	Name		parafield_ew
+	Name		ParaField_EW
 	Facing		29
 
 	Movable		0
@@ -80,7 +84,7 @@
 
 Item 0x3979
 {
-	Name		parafield_ns
+	Name		ParaField_NS
 	Facing		29
 
 	Movable		0

Modified: trunk/096/pkg/items/walkOn/paraField/control.src
===================================================================
--- trunk/096/pkg/items/walkOn/paraField/control.src	2005-11-06 18:43:41 UTC (rev 934)
+++ trunk/096/pkg/items/walkOn/paraField/control.src	2005-11-07 00:34:53 UTC (rev 935)
@@ -12,9 +12,8 @@
 program controlScript(field)
 	SetObjProperty(field, "#PID", GetPid());
 
-	var creator := CInt(GetObjProperty(field, "Creator"));
+	var creator := field.GetOwner();
 	if ( creator.IsA(POLCLASS_MOBILE) )
-		creator := SystemFindObjectBySerial(creator);
 		SetScriptController(creator);
 	endif
 

Modified: trunk/096/pkg/items/walkOn/paraField/methods.src
===================================================================
--- trunk/096/pkg/items/walkOn/paraField/methods.src	2005-11-06 18:43:41 UTC (rev 934)
+++ trunk/096/pkg/items/walkOn/paraField/methods.src	2005-11-07 00:34:53 UTC (rev 935)
@@ -9,6 +9,10 @@
 	return 1;
 endprogram
 
+exported function IsParalyzeField(field)
+	return 1;
+endfunction
+
 exported function SetDuration(field, seconds)
 	seconds := CInt(seconds);
 	
@@ -29,3 +33,20 @@
 	
 	return ( duration < ReadGameClock() );
 endfunction
+
+exported function SetOwner(field, serial)
+	if ( serial.IsA(POLCLASS_UOBJECT) )
+		serial := serial.serial;
+	endif
+	
+	return SetObjProperty(field, "Owner", serial);
+endfunction
+
+exported function GetOwner(field)
+	var owner := CInt(GetObjProperty(field, "Owner"));
+	if ( owner )
+		owner := SystemFindObjectBySerial(owner);
+	endif
+	
+	return owner;
+endfunction

Modified: trunk/096/pkg/items/walkOn/poisonField/control.src
===================================================================
--- trunk/096/pkg/items/walkOn/poisonField/control.src	2005-11-06 18:43:41 UTC (rev 934)
+++ trunk/096/pkg/items/walkOn/poisonField/control.src	2005-11-07 00:34:53 UTC (rev 935)
@@ -12,9 +12,8 @@
 program controlScript(field)
 	SetObjProperty(field, "#PID", GetPid());
 
-	var creator := CInt(GetObjProperty(field, "Creator"));
+	var creator := field.GetOwner();
 	if ( creator.IsA(POLCLASS_MOBILE) )
-		creator := SystemFindObjectBySerial(creator);
 		SetScriptController(creator);
 	endif
 

Modified: trunk/096/pkg/items/walkOn/poisonField/methods.src
===================================================================
--- trunk/096/pkg/items/walkOn/poisonField/methods.src	2005-11-06 18:43:41 UTC (rev 934)
+++ trunk/096/pkg/items/walkOn/poisonField/methods.src	2005-11-07 00:34:53 UTC (rev 935)
@@ -9,6 +9,10 @@
 	return 1;
 endprogram
 
+exported function IsPoisonField(field)
+	return 1;
+endfunction
+
 exported function SetDuration(field, seconds)
 	seconds := CInt(seconds);
 	
@@ -29,3 +33,20 @@
 	
 	return ( duration < ReadGameClock() );
 endfunction
+
+exported function SetOwner(field, serial)
+	if ( serial.IsA(POLCLASS_UOBJECT) )
+		serial := serial.serial;
+	endif
+	
+	return SetObjProperty(field, "Owner", serial);
+endfunction
+
+exported function GetOwner(field)
+	var owner := CInt(GetObjProperty(field, "Owner"));
+	if ( owner )
+		owner := SystemFindObjectBySerial(owner);
+	endif
+	
+	return owner;
+endfunction

Modified: trunk/096/pkg/items/walkOn/spiderWeb/methods.src
===================================================================
--- trunk/096/pkg/items/walkOn/spiderWeb/methods.src	2005-11-06 18:43:41 UTC (rev 934)
+++ trunk/096/pkg/items/walkOn/spiderWeb/methods.src	2005-11-07 00:34:53 UTC (rev 935)
@@ -9,6 +9,10 @@
 	return 1;
 endprogram
 
+exported function IsSpiderWeb(field)
+	return 1;
+endfunction
+
 exported function SetDuration(field, seconds)
 	seconds := CInt(seconds);
 	
@@ -29,3 +33,21 @@
 	
 	return ( duration < ReadGameClock() );
 endfunction
+
+exported function SetOwner(field, serial)
+	if ( serial.IsA(POLCLASS_UOBJECT) )
+		serial := serial.serial;
+	endif
+	
+	return SetObjProperty(field, "Owner", serial);
+endfunction
+
+exported function GetOwner(field)
+	var owner := CInt(GetObjProperty(field, "Owner"));
+	if ( owner )
+		owner := SystemFindObjectBySerial(owner);
+	endif
+	
+	return owner;
+endfunction
+

Modified: trunk/096/pkg/mobiles/timedScripts/subScripts/poison/defaultPoison.src
===================================================================
--- trunk/096/pkg/mobiles/timedScripts/subScripts/poison/defaultPoison.src	2005-11-06 18:43:41 UTC (rev 934)
+++ trunk/096/pkg/mobiles/timedScripts/subScripts/poison/defaultPoison.src	2005-11-07 00:34:53 UTC (rev 935)
@@ -3,8 +3,8 @@
 
 include ":attributes:attributes";
 include ":timedscripts:timedScripts";
+include "include/damage";
 
-
 program default_poison(params)
 	var who := params[1];
 	var attacker := params[2];
@@ -73,7 +73,7 @@
 			sleepms(2);
 		endforeach		
 		
-		ApplyRawDamage(who, dmg);
+		ApplyRawDamageEX(who, dmg, DMG_POISON, attacker);
 
 		Set_Critical(1);
 		var curr := CInt(AP_GetVital(who, "Stamina"));

Modified: trunk/096/scripts/include/damage.inc
===================================================================
--- trunk/096/scripts/include/damage.inc	2005-11-06 18:43:41 UTC (rev 934)
+++ trunk/096/scripts/include/damage.inc	2005-11-07 00:34:53 UTC (rev 935)
@@ -6,11 +6,12 @@
 include ":brainAI:npcUtil";
 
 enum DAMAGE_TYPES
+	DMG_FORCED	:= -1, // Ignores resistance
 	DMG_DEFAULT	:= "Default",
 	DMG_COLD	:= "Cold",
 	DMG_FIRE	:= "Fire",
 	DMG_POISON	:= "Poison",
-	DMG_MAGERY	:= "Magery",
+	DMG_MAGERY	:= "Magery"
 endenum
 
 /* 
@@ -94,6 +95,9 @@
  */
 function CalcDamageAmount(mobile, amount, type)
 	amount := CInt(amount);
+	if ( type == DMG_FORCED )
+		return amount;
+	endif
 	
 	var resistance_mult := error;
 	var res_prop := GetObjProperty(mobile, "Resistances");



From austin at berlios.de  Mon Nov  7 01:43:35 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 7 Nov 2005 01:43:35 +0100
Subject: [Poldistro-svn] r936 - in trunk/096: pkg/mobiles/brainAI/scripts/combat pkg/mobiles/oldAI pkg/mobiles/oldAI/combat pkg/systems/combat pkg/systems/combat/config scripts/items
Message-ID: <200511070043.jA70hZvt017519@sheep.berlios.de>

Author: austin
Date: 2005-11-07 01:43:25 +0100 (Mon, 07 Nov 2005)
New Revision: 936

Modified:
   trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
   trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
   trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc
   trunk/096/pkg/systems/combat/config/settings.cfg
   trunk/096/pkg/systems/combat/mainHitScript.src
   trunk/096/scripts/items/fireTrap.src
Log:
Used damage.inc where it could be used.

Added facing support in the combat system (If enabled in settings.cfg forces attacker to face defender on attack)

Modified: trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-07 00:34:53 UTC (rev 935)
+++ trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-07 00:43:25 UTC (rev 936)
@@ -13,6 +13,7 @@
 include "include/client";
 include "include/sounds";
 include "include/facings";
+include "include/damage";
 
 program BrainNerve(params)
 	var npc		:= params[1];
@@ -121,7 +122,7 @@
 	endforeach
 
 	PlaySoundEffect(opponent, 0x208);
-	ApplyRawDamage(opponent, RandomDiceRoll("3d7"));
+	ApplyRawDamageEX(opponent, RandomDiceRoll("3d7"), DMG_FIRE, npc);
 
 	foreach coord in GetCoordsInSquare(opponent.x, opponent.y, 3)
 		if ( RandomInt(2) != 1 ) // Don't place a fire field

Modified: trunk/096/pkg/mobiles/oldAI/bladeSpirit.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-07 00:34:53 UTC (rev 935)
+++ trunk/096/pkg/mobiles/oldAI/bladeSpirit.src	2005-11-07 00:43:25 UTC (rev 936)
@@ -13,8 +13,8 @@
 include ":oldAI:main/setup";
 include ":oldAI:main/sleepMode";
 include ":npcutils:animal";
+include "include/damage";
 
-
 const HALT_THRESHOLD := 10;
 var npccfgfile := ReadConfigFile("::npcdesc");
 var idlesnd1 := CInt(npccfgfile[me.npctemplate].idlesound1);
@@ -135,7 +135,7 @@
     elseif(dmg < 2)
       dmg := 2;
     endif
-	ApplyRawDamage(opponent, RandomInt(dmg));
+	ApplyRawDamageEX(opponent, RandomInt(dmg), DMG_DEFAULT);
   endif
 endfunction
 

Modified: trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc
===================================================================
--- trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc	2005-11-07 00:34:53 UTC (rev 935)
+++ trunk/096/pkg/mobiles/oldAI/combat/fireCombatEvent.inc	2005-11-07 00:43:25 UTC (rev 936)
@@ -1,4 +1,6 @@
 include ":attributes:attributes";
+include "include/damage";
+
 function process_combat_event(opponent)
   if((AP_GetVital(me, "Hits") * 100/AP_GetVitalMaximumValue(me, "Hits")) < flee_point)
     EraseObjProperty(me,"#flees");
@@ -23,7 +25,7 @@
     var base := Cint(((FLAME_STRENGTH * AP_GetVital(me, "Hits")) / AP_GetVitalMaximumValue(me, "Hits")) / 2);
     var dmg :=  RandomInt(base) + base;
     PlayMovingEffect(me, opponent, 0x36d4, 10, 1, 1);
-    ApplyRawDamage(opponent, dmg);
+    ApplyRawDamageEX(opponent, dmg, DMG_FIRE);
   endif
 endfunction
 

Modified: trunk/096/pkg/systems/combat/config/settings.cfg
===================================================================
--- trunk/096/pkg/systems/combat/config/settings.cfg	2005-11-07 00:34:53 UTC (rev 935)
+++ trunk/096/pkg/systems/combat/config/settings.cfg	2005-11-07 00:43:25 UTC (rev 936)
@@ -2,6 +2,8 @@
 {
 	GainWait	25	// Seconds between gain checks.
 	PvPGains	1	// Players can gain from PvP. 0 - No. 1 - Yes.
+	
+	ForceFacing	1	// Forces opponents to face each other when attacking.
 }
 
 Elem	Weapons

Modified: trunk/096/pkg/systems/combat/mainHitScript.src
===================================================================
--- trunk/096/pkg/systems/combat/mainHitScript.src	2005-11-07 00:34:53 UTC (rev 935)
+++ trunk/096/pkg/systems/combat/mainHitScript.src	2005-11-07 00:43:25 UTC (rev 936)
@@ -12,6 +12,8 @@
 include ":combat:settings";
 include ":timedscripts:timedScripts";
 include "include/client";
+include "include/facings";
+include "include/damage";
 
 var item_cfg := ReadConfigFile(":*:itemdesc");
 
@@ -30,6 +32,7 @@
 		endif
 	endif
 	
+	FacingChecks(attacker, defender);	
 	PlayHitSounds(defender);
 	SkillChecks(attacker, defender, weapon, rawdamage);
 	ArrowRecovery(defender, weapon);
@@ -50,11 +53,24 @@
 	// Raw = post armor
 	//
 	if ( rawdamage > 0 )
-		ApplyRawDamage(defender, CInt(rawdamage));
+		ApplyRawDamageEX(defender, CInt(rawdamage), DMG_DEFAULT);
 		MakeBleed(defender);
 	endif
 endprogram
 
+function FacingChecks(attacker, defender)
+	if ( !CS_GetSettingsCfgElem("General").ForceFacing )
+		return 0;
+	endif
+	
+	var facing := GetFacing(attacker.x, attacker.y, defender.x, defender.y);
+	if ( attacker.facing != facing )
+		attacker.facing := facing;
+	endif
+	
+	return 1;
+endfunction
+
 function PlayHitSounds(defender)
 	if ( defender.IsA(POLCLASS_NPC) )
 		var damaged_sound := NPC_GetNPCConfig(defender).DamagedSound;

Modified: trunk/096/scripts/items/fireTrap.src
===================================================================
--- trunk/096/scripts/items/fireTrap.src	2005-11-07 00:34:53 UTC (rev 935)
+++ trunk/096/scripts/items/fireTrap.src	2005-11-07 00:43:25 UTC (rev 936)
@@ -2,6 +2,8 @@
 use os;
 use util;
 
+include "include/damage";
+
 program flamestriketrap(who, item)
   Detach();
   if (who.dead || who.cmdlevel >0)
@@ -10,5 +12,5 @@
   PlayStationaryEffect(item.x, item.y, item.z, 0x3709, 0x0a, 0x1e, 0, who.realm);
   PlaySoundEffect(item, 0x226);
   var dmg := RandomInt(20) + 30;
-  ApplyRawDamage(who, dmg);
+  ApplyRawDamageEX(who, dmg, DMG_FIRE, item);
 endprogram
\ No newline at end of file



From austin at berlios.de  Mon Nov  7 02:20:28 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 7 Nov 2005 02:20:28 +0100
Subject: [Poldistro-svn] r937 - in trunk/096: pkg/commands/seer pkg/items/bountyboard pkg/mobiles/death pkg/mobiles/oldAI pkg/skills/magery pkg/systems/boat pkg/systems/stafflist scripts scripts/include/OLD scripts/misc
Message-ID: <200511070120.jA71KSON025199@sheep.berlios.de>

Author: austin
Date: 2005-11-07 02:20:20 +0100 (Mon, 07 Nov 2005)
New Revision: 937

Modified:
   trunk/096/pkg/commands/seer/go.src
   trunk/096/pkg/items/bountyboard/bountyboard.src
   trunk/096/pkg/mobiles/death/plyrdeath.src
   trunk/096/pkg/mobiles/oldAI/poisonElemental.src
   trunk/096/pkg/mobiles/oldAI/tamed.src
   trunk/096/pkg/skills/magery/spellStarter.src
   trunk/096/pkg/systems/boat/boat.src
   trunk/096/pkg/systems/stafflist/staffList.src
   trunk/096/scripts/include/OLD/spellRestrictions.inc
   trunk/096/scripts/misc/help.src
   trunk/096/scripts/misc/logoff.src
   trunk/096/scripts/misc/logofftest.src
   trunk/096/scripts/misc/logon.src
   trunk/096/scripts/start.src
Log:
Updated include paths (mostly removed calls to math.inc)
Cleaned logon.src out big time! Most the stuff will be done in packages or has been removed and was still referenced in there.

Commented out most of help.src, set it to just do a start_script() to the help package (when its put in??)



Modified: trunk/096/pkg/commands/seer/go.src
===================================================================
--- trunk/096/pkg/commands/seer/go.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/pkg/commands/seer/go.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -35,7 +35,6 @@
 use datafile;
 
 include ":datafile:datafile";
-include "include/math";
 include ":gumps:include/gumps";
 include ":gumps:include/gumpprompt";
 include ":gumps:include/gumps_ex";

Modified: trunk/096/pkg/items/bountyboard/bountyboard.src
===================================================================
--- trunk/096/pkg/items/bountyboard/bountyboard.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/pkg/items/bountyboard/bountyboard.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -3,7 +3,7 @@
 use datafile;
 
 include ":datafile:datafile";
-include "include/sorting";
+include "include/OLD/sorting";
 include "include/client";
 include ":bountyboard:bounty";
 include ":gumps:include/old/old-gumps";

Modified: trunk/096/pkg/mobiles/death/plyrdeath.src
===================================================================
--- trunk/096/pkg/mobiles/death/plyrdeath.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/pkg/mobiles/death/plyrdeath.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -11,7 +11,6 @@
 use util;
 
 include "include/OLD/noto";
-include "include/reportMurder";
 include ":attributes:attributes";
 include ":timedscripts:timedScripts";
 include ":death:death";
@@ -31,7 +30,7 @@
 	CheckForAutoRes(ghost, corpse);
 	
 	if ( (ghost.reportables).Size() > 0)
-		SendReportGump(ghost);
+		//SendReportGump(ghost);
 	endif
 	
 	return 1;
@@ -51,7 +50,8 @@
 endfunction
 
 function CheckForAutoRes(who, corpse)
-	if( CInt(GetObjProperty(corpse, "AutoRes")) >= 1 )
+	var auto_res := CInt(GetObjProperty(who, "AutoRes"));
+	if ( auto_res )
 		Resurrect(who);
 		AP_RefreshVitals(who);	
 		
@@ -67,6 +67,10 @@
 			endif
 		endforeach
 		
+		if ( auto_res != -1 ) // -1 means infinite uses
+			auto_res := auto_res-1;
+			SetObjProperty(who, "AutoRes", auto_res);
+		endif
 		return 1;
 	endif
 	return 0;

Modified: trunk/096/pkg/mobiles/oldAI/poisonElemental.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/pkg/mobiles/oldAI/poisonElemental.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -12,7 +12,7 @@
 include ":itemutils:objtype";
 include ":npcutils:NPCCast";
 include ":npcutils:anchors";
-include "include/spellRestrictions";
+include "include/OLD/spellRestrictions";
 include ":oldAI:main/killPCsLoop";
 include ":oldAI:combat/fight";
 include ":oldAI:setup/spellSetup";

Modified: trunk/096/pkg/mobiles/oldAI/tamed.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/pkg/mobiles/oldAI/tamed.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -9,7 +9,7 @@
 include ":npcutils:NPCBackpacks";
 include ":npcutils:NPCCast";
 include ":npcutils:names";
-include "include/snooping";
+include "include/OLD/snooping";
 include "include/tileEffects";
 
 set_priority(5);

Modified: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -12,6 +12,7 @@
 include ":containers:containers";
 include ":itemutils:itemdesc";
 include "include/client";
+include "include/sounds";
 
 program SpellStarter(params)
 	var who		:= params[1]; // Caster.

Modified: trunk/096/pkg/systems/boat/boat.src
===================================================================
--- trunk/096/pkg/systems/boat/boat.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/pkg/systems/boat/boat.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -20,7 +20,6 @@
 include "include/client";
 include "include/OLD/sound";
 include ":gumps:yesno";
-include "include/math";
 include "util/key";
 include "plankUtil";
 

Modified: trunk/096/pkg/systems/stafflist/staffList.src
===================================================================
--- trunk/096/pkg/systems/stafflist/staffList.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/pkg/systems/stafflist/staffList.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -3,7 +3,7 @@
 use util;
 use math;
 
-include "include/math";
+include "include/OLD/math";
 include "include/OLD/eventID";
 var stff := {};
 var players := {};

Modified: trunk/096/scripts/include/OLD/spellRestrictions.inc
===================================================================
--- trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/scripts/include/OLD/spellRestrictions.inc	2005-11-07 01:20:20 UTC (rev 937)
@@ -9,8 +9,8 @@
 include "include/OLD/sound";
 include ":itemutils:objtype";
 include "include/OLD/statMod";
-include "include/firewall";
-include "include/spellAttack";
+include "include/OLD/firewall";
+include "include/OLD/spellAttack";
 
 var caster;
 var npccfg := ReadConfigFile("::npcdesc");

Modified: trunk/096/scripts/misc/help.src
===================================================================
--- trunk/096/scripts/misc/help.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/scripts/misc/help.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -1,6 +1,23 @@
+/*
+ * $Id$
+ *
+ */
+
 use uo;
 use os;
 
+program Help(who)
+	var script := Start_Script(":help:help", who);
+	if ( script.errortext )
+		SendSysMessage(who, "Error starting help system ->"+script.errortext);
+		return 0;
+	endif
+	
+	return 1;
+endprogram
+
+
+/*
 include "include/help";
 include "include/OLD/eventID";
 var layout := {
@@ -254,3 +271,4 @@
   endforeach
   return newarray;
 endfunction
+*/
\ No newline at end of file

Modified: trunk/096/scripts/misc/logoff.src
===================================================================
--- trunk/096/scripts/misc/logoff.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/scripts/misc/logoff.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -10,7 +10,6 @@
 use math;
 use os;
 
-include "include/math";
 include "include/OLD/eventID";
 include ":attributes:attributes";
 

Modified: trunk/096/scripts/misc/logofftest.src
===================================================================
--- trunk/096/scripts/misc/logofftest.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/scripts/misc/logofftest.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -8,7 +8,7 @@
 use uo;
 
 include "include/OLD/eventID";
-include "include/innCheck";
+include "include/OLD/innCheck";
 
 include ":timedscripts:timedScripts";
 

Modified: trunk/096/scripts/misc/logon.src
===================================================================
--- trunk/096/scripts/misc/logon.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/scripts/misc/logon.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -1,332 +1,13 @@
-/* $Id$
+/*
+ * $Id$
  *
- * Purpose
- * This script allows code to run when the player logs in. Can be used for welcome messages, etc.
- * This script runs critical, so be careful how much code you run!
- *
  */
+ 
 use uo;
-use os;
-use util;
-use math;
-use cfgfile;
+ 
+program Logon(who)
 
-include "include/OLD/eventID";
-include ":itemutils:myUtil";
-include ":attributes:attributes";
-include ":combat:equip";
-include "include/OLD/noto";
-
-
-program core_logon(who)
-	TrackIP(who);
-	RestoreMods(who);
-	SetObjProperty(who,"logontime",ReadGameClock());
-	EraseObjProperty(who, "IsMeditating");
-	SetObjProperty(who,"LoggedIn", 1);
-	start_script(":meditation:medCheck", who);
-	start_script(":hooks:attributeCore", who);
-	if (who.cmdlevel < 2)
-		RevokePrivilege(who, "hearghosts");
-	else
-		var oldpack := who.backpack;
-		if (oldpack.objtype != 0x966c)
-			MoveItemToLocation(oldpack, 1, 1, 0, MOVEITEM_FORCELOCATION);
-			var newpack := CreateItemAtLocation(1, 1, 0, 0x966c, 1, who.realm);
-			EquipItem(who, newpack);
-			foreach thing in ListRootItemsInContainer(oldpack)
-				MoveItemToContainer(thing, newpack);
-			endforeach
-		endif
-	endif
-	var mount := GetEquipmentByLayer(who, 25 );
-	if (mount)
-		var animal := SystemFindObjectBySerial(CInt(GetObjProperty(mount,"serial")));
-		if (animal)
-			EraseObjProperty(animal,"onhold");
-		else
-			DestroyItem(mount);
-		endif
-	endif
-	var rm := GetObjProperty(who, "ReportMenu");
-	if (rm)
-		var defender;
-		var rept := {};
-		foreach serial in rm
-			foreach chr in EnumerateOnlineCharacters()
-				if(chr.serial == serial)
-					defender := chr;
-					break;
-				endif
-			endforeach
-			if (!defender)
-				defender := SystemFindObjectBySerial(serial, SYSFIND_SEARCH_OFFLINE_MOBILES);
-			endif
-			rept.append(defender);
-			defender := 0;
-		endforeach
-		SendReportGump(who, rept);
-		EraseObjProperty(who, "LoginNotify");
-		EraseObjProperty(who, "ReportMenu");
-	endif
-	var lr := GetObjProperty(who, "LoginReport");
-	if (lr)
-		var reportdata := {};
-		var jerk;
-		foreach serial in lr
-			jerk := SystemFindObjectBySerial(serial, SYSFIND_SEARCH_OFFLINE_MOBILES);
-			if (jerk)
-				reportdata.append(jerk);
-			endif
-		endforeach
-		EraseObjProperty(who, "LoginReport");
-	endif
-	var nkarma := CStr(GetObjProperty(who, "ModKarma"));
-	var nfame := CStr(GetObjProperty(who, "ModFame"));
-	if (nfame)
-		var ofame := GetObjProperty(who, "Fame");
-		SendGainMessage(who, "Fame", CInt(nfame));
-		SetObjProperty(who, "Fame", CInt(ofame) + CInt(nfame));
-		EraseObjProperty(who, "ModFame");
-		var karma   := CInt(GetObjProperty(who, "Karma"));
-		var fame    := CInt(GetObjProperty(who, "Fame"));
-		SetNotoTitle(who, karma, fame);
-	endif
-	if (nkarma)
-		var okarma := GetObjProperty(who, "Karma");
-		SendGainMessage(who, "Karma", CInt(nkarma));
-		SetObjProperty(who, "Karma", CInt(okarma) + CInt(nkarma));
-		EraseObjProperty(who, "ModKarma");
-		var karma := CInt(GetObjProperty(who, "Karma"));
-		var fame := CInt(GetObjProperty(who, "Fame"));
-		SetNotoTitle(who, karma, fame);
-	endif
-	var whopack := who.backpack;
-	if (!GetObjProperty(whopack, "Owner"))
-		SetObjProperty(whopack, "Owner", who.serial);
-	endif
-	SetObjProperty(who, "LastLog", ReadGameClock() );
-	if (GetObjProperty(who,"poly"))
-		Detach();
-		sleep(15);
-		who.graphic := who.objtype;
-		who.color := who.truecolor;
-		EraseObjProperty(who, "poly");
-	endif
-	var mailkeeper := GetObjProperty(who,"mailkeeper");
-	if (!mailkeeper)
-		start_script(":gmtools:mailkeeper", who);
-		mailkeeper := 1;
-		SetObjProperty(who, "mailkeeper", 1);
-	endif
-	if (mailkeeper >= 60)
-		mailkeeper := 1;
-		SetObjProperty(who, "mailkeeper", mailkeeper);
-		Detach();
-		start_script(":gmtools:mailkeeper", who);
-	else
-		mailkeeper := mailkeeper + 1;
-		SetObjProperty(who,"mailkeeper", mailkeeper);
-	endif
-	foreach thing in ListEquippedItems(who)
-		if (Cint(GetObjProperty(thing, "#equipped")) != who.serial)
-			HandleMods(who, thing);
-		endif
-	endforeach
-	staffnotify(who);
-endprogram
-
-
-function TrackIP(who)
-	var acct := who.acct;
-	var ipstring := acct.getprop("LastIP");
-	if (!ipstring)
-		ipstring := {};
-	endif
-	var holder := {};
-	var amt := len(ipstring);
-	foreach thing in ipstring
-		if ((thing[1] != who.ip) && (amt < 20));
-			holder.append(thing);
-		else
-			amt := amt - 1;
-		endif
-	endforeach
-	ipstring := holder;
-	var newarray := {};
-	newarray.append(who.ip);
-	newarray.append(who.name);
-	ipstring.append(newarray);
-	acct.setprop("LastIP", ipstring);
-	acct.setprop("LastLogin", ReadGameClock());
-endfunction
-
-
-function staffnotify(who)
-	var pid := GetGlobalProperty("#stafflist");;
-	if (!pid)
-		syslog( "Stafflist not initialized!" );
-		return;
-	endif
-	var process := getprocess(pid);
-	if (!process)
-		syslog( "Can't find process for stafflist, pid=" + pid );
-		return;
-	endif
-	var k := struct;
-	if (who.cmdlevel < 2)
-		k.+player := who;
-		k.+type  := EVID_PLAYER_LOGIN;
-		process.sendevent(k);
-	else
-		k.+player := who;
-		k.+type   := EVID_STAFF_LOGIN;
-		process.sendevent(k);
-	endif
-endfunction
-
-
-const LONG_COUNT_DECAY_TIME := 144000; //40 hours
-const SHORT_COUNT_DECAY_TIME := 28800; //8 hours
-
-
-var layout := {
-"page 0",
-"nodispose",
-"noclose",
-"gumppic 0 0 206",
-"gumppic 43 0 201",
-"gumppic 460 0 207",
-"gumppic 0 43 202",
-"gumppic 43 43 200",
-"gumppic 170 43 200",
-"gumppic 295 43 200",
-"gumppic 335 43 200",
-"gumppic 43 170 200",
-"gumppic 170 170 200",
-"gumppic 295 170 200",
-"gumppic 335 170 200",
-"gumppic 43 220 200",
-"gumppic 170 220 200",
-"gumppic 295 220 200",
-"gumppic 335 220 200",
-"gumppic 460 43 203",
-"gumppic 0 340 204",
-"gumppic 43 340 233",
-"gumppic 460 340 205",
-"button 380 345 249 248 1 0 99",
-"text 50 20 40 0",
-"text 50 50 40 1",
-"text 50 70 40 2"
-};
-
-var data := {
-"Now is the time for retribution!",
-"Check zero or more players to report for your murder",
-"and press OKAY."
-};
-
-
-function SendReportGump(who, reportables)
-	FillInArrays(reportables);
-	var ret := SendDialogGump(who,layout,data);
-	if (!ret)
-		var reportdata := {};
-		foreach reportable in(reportables)
-			reportdata.append(reportable.serial);
-		endforeach
-		SetObjProperty(who, "LoginReport", reportdata);
-		return;
-	endif
-	foreach id in (ret.keys)
-		if (id >= 10)
-			id := id-9;
-			var mob := reportables[id];
-			if (!(mob in EnumerateOnlineCharacters()))
-				SetObjProperty(mob, "LoginNotify", who.serial);
-			else
-				AdjustNoto(mob, who);
-			endif
-			AdjustMurderCounts(mob);
-		endif
-	endforeach
-	foreach reportable in(who.reportables)
-		who.removeReportable(reportable.serial, reportable.gameclock);
-	endforeach
-endfunction
-
-
-function FillInArrays(reportables)
-	var prev_y := 80;
-	var prev_x := 40;
-	var buttonret := 10;
-	layout.append("page 1");
-	foreach reportable in reportables
-		if (!reportable.cmdlevel)
-			if (buttonret == 21)
-				prev_x := 300;
-				prev_y := 80;
-			endif
-			layout.append("checkbox " + CStr(prev_x) + " " + CStr(prev_y+20) + " 210 211 0 " + buttonret);
-			data.append(reportable.name);
-			layout.append("text " + CStr(prev_x+20) + " " + CStr(prev_y+20) + " 40 " + CStr(len(data)-1));
-			prev_y := prev_y+20;
-			buttonret := buttonret+1;
-		endif
-	endforeach
-endfunction
-
-
-function AdjustMurderCounts(killer)
-	var onlinetime := GetObjProperty(killer,"onlinetimer");
-	var longcount := GetObjProperty(killer,"longmurders");
-	if (!longcount)
-		longcount := 0;
-	endif
-	longcount := longcount + 1;
-	if (longcount > 4)
-		killer.setMurderer(1);
-		SendSysMessage(killer,"You are now known as a murderer!");
-	endif
-	var shortcount := GetObjProperty(killer, "shortmurders");
-	if (!shortcount)
-		shortcount := 0;
-	endif
-	shortcount := shortcount + 1;
-	SetObjProperty(killer, "longmurders", longcount);
-	SetObjProperty(killer, "shortmurders", shortcount);
-	SetObjProperty(killer, "decaylongcountat", onlinetime + LONG_COUNT_DECAY_TIME);
-	SetObjProperty(killer, "decayshortcountat", onlinetime + SHORT_COUNT_DECAY_TIME);
-endfunction
-
-
-function RestoreMods(who)
-	foreach thing in ListEquippedItems(who)
-		if (GetObjProperty(thing, "Pid"))
-			var holder := {};
-			var gain := GetObjProperty(thing, "gain");
-			if (!gain)
-				gain := 5;
-			endif
-			var type := GetObjProperty(thing, "type");
-			var tpe;
-			case (type)
-				"strength":     tpe := "str";
-				"invisibility": tpe := "inv";
-				"sight":        tpe := "vis";
-				"protection":   tpe := "pro";
-				"reflect":      tpe := "ref";
-				"bless":        tpe := "bls";
-			endcase
-			holder.append(thing.serial);
-			holder.append(tpe);
-			holder.append(gain);
-			SetObjProperty(thing, "equipped", who.serial);
-			var parms := {who, thing};
-			start_script(":combat:chargeUpkeep", parms);
-			print("upkeep started");
-		endif
-	endforeach
-
-	return;
-endfunction
+	SetObjProperty(who, "ConnectTime", polcore().systime);
+	
+	return 1;
+endprogram
\ No newline at end of file

Modified: trunk/096/scripts/start.src
===================================================================
--- trunk/096/scripts/start.src	2005-11-07 00:43:25 UTC (rev 936)
+++ trunk/096/scripts/start.src	2005-11-07 01:20:20 UTC (rev 937)
@@ -14,21 +14,12 @@
 
 include ":logger:exception";
 include ":logger:log";
-include ":itemutils:utility";;
-include "include/teleporters";
 
-
 program StartServer()
 	Log(LOG_MAIN, "Server started.");
-	if (!start_script(":scheduler:scheduler"))
+	if ( !start_script(":scheduler:scheduler") )
 		Exception("::start:StartServer(): Couldn't start the script scheduler");
 	endif
-	print("Initializing merchant storage");
-	find_or_create_storage("Merchant Storage");
-	print("Wiping merchant storage");
-	start_script("storageWipe");
-	print("Initializing teleporters");
-	CreateTeleporters();
-
-	return;
+	
+	return 1;
 endprogram



From muaddiblsd at berlios.de  Mon Nov  7 07:23:10 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Mon, 7 Nov 2005 07:23:10 +0100
Subject: [Poldistro-svn] r938 - in trunk/096/pkg: items/bountyboard items/food/config items/food/include items/guildstone items/moongates items/moongates/config items/walkOn/energyField items/walkOn/fireField items/walkOn/paraField items/walkOn/poisonField items/walkOn/spiderWeb mobiles/brainAI/complete/blackEye mobiles/brainAI/scripts/combat skills/magery/delay skills/magery/spellScripts/circle1 systems/loot/configs/OLD systems/spawnSystem/config/OLD
Message-ID: <200511070623.jA76NAQT020947@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-07 07:22:45 +0100 (Mon, 07 Nov 2005)
New Revision: 938

Added:
   trunk/096/pkg/items/moongates/autoload.cfg
   trunk/096/pkg/items/moongates/config/
   trunk/096/pkg/items/moongates/config/moongate.cfg
   trunk/096/pkg/items/moongates/moongateInit.src
Removed:
   trunk/096/pkg/items/moongates/moongate.cfg
   trunk/096/pkg/items/moongates/moongates.inc
   trunk/096/pkg/items/moongates/start.src
Modified:
   trunk/096/pkg/items/bountyboard/autoload.cfg
   trunk/096/pkg/items/food/config/food.cfg
   trunk/096/pkg/items/food/include/food.inc
   trunk/096/pkg/items/guildstone/autoload.cfg
   trunk/096/pkg/items/walkOn/energyField/control.src
   trunk/096/pkg/items/walkOn/energyField/methods.src
   trunk/096/pkg/items/walkOn/fireField/methods.src
   trunk/096/pkg/items/walkOn/paraField/methods.src
   trunk/096/pkg/items/walkOn/poisonField/methods.src
   trunk/096/pkg/items/walkOn/spiderWeb/methods.src
   trunk/096/pkg/mobiles/brainAI/complete/blackEye/combat.src
   trunk/096/pkg/mobiles/brainAI/complete/blackEye/virtual.src
   trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
   trunk/096/pkg/skills/magery/delay/delayCheck.src
   trunk/096/pkg/skills/magery/spellScripts/circle1/createFood.src
   trunk/096/pkg/systems/loot/configs/OLD/lootgroup.cfg
   trunk/096/pkg/systems/loot/configs/OLD/nlootgroup.cfg
   trunk/096/pkg/systems/spawnSystem/config/OLD/spawngroups.cfg
   trunk/096/pkg/systems/spawnSystem/config/OLD/spawnregions.cfg
Log:
Update for $Id$ property.

New moongates package. Upgraded it for autoload.cfg, and also rewrote the src. Now uses a formatted config for if a realm should be generated for moongates and added to the menu on the gump.

Still need to make the gump use this new system. Also, need to finish testing out the moongates pkg. Testing was limited for me, so recommend more.


Property changes on: trunk/096/pkg/items/bountyboard/autoload.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/food/config/food.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/food/include/food.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/guildstone/autoload.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/moongates/autoload.cfg
===================================================================
--- trunk/096/pkg/items/moongates/autoload.cfg	2005-11-07 01:20:20 UTC (rev 937)
+++ trunk/096/pkg/items/moongates/autoload.cfg	2005-11-07 06:22:45 UTC (rev 938)
@@ -0,0 +1,9 @@
+# $Id$
+
+Autoload moongateInit
+{
+	Script      moongateInit
+	Resistent   1
+	Name        Town Moongate Initializer
+	Priority    0
+}


Property changes on: trunk/096/pkg/items/moongates/autoload.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/moongates/config/moongate.cfg
===================================================================
--- trunk/096/pkg/items/moongates/config/moongate.cfg	2005-11-07 01:20:20 UTC (rev 937)
+++ trunk/096/pkg/items/moongates/config/moongate.cfg	2005-11-07 06:22:45 UTC (rev 938)
@@ -0,0 +1,50 @@
+# $Id$
+#
+#
+###############################
+# Moongates Setup File:
+#
+# Purpose:
+# Each entry in this file contains
+# three element types. Realm, Active,
+# and Town. The Realm element is the
+# string name for the realm it is for.
+# Active, is the setting that will
+# decide if you want town gates to
+# include this realm. Town elements
+# can be as many as you need. Although
+# Don't get too carried away. The
+# layout for them are as follows:
+# X Y Z TownName. The TownName part
+# of the string is the name as it
+# would appear in your gump for the
+# moongates.
+#
+###############################
+Setting britannia
+{
+	Realm		britannia
+	Active		1
+	Town		4467 1283 5 Moonglow
+	Town		1336 1997 5 Britain
+	Town		1499 3771 5 Jhelom
+	Town		771 753 5 Yew
+	Town		2701 693 5 Minoc
+	Town		1828 2948 -20 Trinsic
+	Town		643 2067 5 Skara
+	Town		3564 2140 34 Magincia
+}
+
+Setting britannia_alt
+{
+	Realm		britannia_alt
+	Active		1
+	Town		4467 1283 5 Moonglow
+	Town		1336 1997 5 Britain
+	Town		1499 3771 5 Jhelom
+	Town		771 753 5 Yew
+	Town		2701 693 5 Minoc
+	Town		1828 2948 -20 Trinsic
+	Town		643 2067 5 Skara
+	Town		3564 2140 34 Magincia
+}
\ No newline at end of file


Property changes on: trunk/096/pkg/items/moongates/config/moongate.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/096/pkg/items/moongates/moongate.cfg
===================================================================
--- trunk/096/pkg/items/moongates/moongate.cfg	2005-11-07 01:20:20 UTC (rev 937)
+++ trunk/096/pkg/items/moongates/moongate.cfg	2005-11-07 06:22:45 UTC (rev 938)
@@ -1,16 +0,0 @@
-# $Id$
-#
-#
-###############################
-# system settings:
-# currently with core 94 there is no handling for the new ishtar
-# world map, nor is there handling for facets. when core support
-# becomes available, admins will be able to change the "Value"
-# setting to "2" to enable moongates to allow players to travel
-# to the new lands and/or facets. At this time, only setting "1"
-# is supported.
-###############################
-Setting Facets
-{
-    Value   1
-}

Copied: trunk/096/pkg/items/moongates/moongateInit.src (from rev 902, trunk/096/pkg/items/moongates/moongates.inc)
===================================================================
--- trunk/096/pkg/items/moongates/moongates.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/pkg/items/moongates/moongateInit.src	2005-11-07 06:22:45 UTC (rev 938)
@@ -0,0 +1,47 @@
+use uo;
+use os;
+
+include ":logger:log";
+
+var mgate_config := ReadConfigFile(":moongates:config/moongate");
+
+program CreateMoongates()
+	var facet_list := GetConfigStringKeys(mgate_config);
+	if( facet_list.errortext )
+        	Log(LOG_ERROR, "Moongate Facet List Failed Config Read '" + GetLogInfo(facet_list) + "'");
+		return 0;
+	endif
+  	syslog( "Creating moongates." );
+	foreach key_name in facet_list
+		var key_elem := FindConfigElem(mgate_config, key_name);
+		if( GetConfigInt(key_elem, "Active") == 1 )
+			var gate_realm := GetConfigString(key_elem, "Realm");
+			var gate_towns := GetConfigStringArray(key_elem, "Town");
+			foreach town_entry in gate_towns
+				var gate := SplitWords(town_entry);
+				RemoveOldGates(gate, gate_realm);
+				CreateNewGates(gate, gate_realm);
+			endforeach
+		endif
+	endforeach
+endprogram
+
+
+function RemoveOldGates(gate, gate_realm)
+	foreach thing in ListItemsNearLocation(CInt(gate[1]), CInt(gate[2]), CInt(gate[3]), 0, gate_realm);
+		if(thing.objtype != 0x887b)
+			DestroyItem(thing);
+		endif
+	endforeach
+	return 1;
+endfunction
+
+
+function CreateNewGates(gate, gate_realm)
+	var moongate := CreateItemAtLocation(CInt(gate[1]), CInt(gate[2]), CInt(gate[3]), "systemmoongate", 1, gate_realm);
+	SetObjProperty(moongate, "City", gate[4]);
+	moongate.facing := 29;
+	moongate.decayAt := 0;
+	moongate.movable := 0;
+	return 1;
+endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/items/moongates/moongates.inc
===================================================================
--- trunk/096/pkg/items/moongates/moongates.inc	2005-11-07 01:20:20 UTC (rev 937)
+++ trunk/096/pkg/items/moongates/moongates.inc	2005-11-07 06:22:45 UTC (rev 938)
@@ -1,38 +0,0 @@
-use uo;
-use os;
-
-function CreateMoongates()
-  var moongates := {
-	{4467,	1283,	5, "Moonglow", "britannia"},		// moonglow
-    {1336,	1997,	5, "Britain", "britannia"},		// britain
-    {1499,	3771,	5, "Jhelom", "britannia"},		// jehlom
-	{771,	753,	5, "Yew", "britannia"},		    // yew
-    {2701,	693,	5, "Minoc", "britannia"},		// minoc
-    {1828,	2948, -20, "Trinsic", "britannia"},	    // trinsic
-    {643,	2067,	5, "Skara", "britannia"},		// skara
-    {3564,	2140,  34, "Magincia", "britannia"}, 	    // magincia
-    
-	{4467,	1283,	5, "Moonglow", "britannia_alt"},		// moonglow
-    {1336,	1997,	5, "Britain", "britannia_alt"},		// britain
-    {1499,	3771,	5, "Jhelom", "britannia_alt"},		// jehlom
-	{771,	753,	5, "Yew", "britannia_alt"},		    // yew
-    {2701,	693,	5, "Minoc", "britannia_alt"},		// minoc
-    {1828,	2948, -20, "Trinsic", "britannia_alt"},	    // trinsic
-    {643,	2067,	5, "Skara", "britannia_alt"},		// skara
-    {3564,	2140,  34, "Magincia", "britannia_alt"} 	    // magincia    
-  };
-  var moongate;
-  syslog( "Creating moongates." );
-  foreach gate in moongates
-    foreach thing in ListItemsNearLocation(gate[1], gate[2], gate[3], 0, gate[5]);
-      if(thing.objtype != 0x887b)
-        DestroyItem(thing);
-      endif
-    endforeach
-	moongate := CreateItemAtLocation( gate[1], gate[2], gate[3], "systemmoongate", 1, gate[5] );
-    SetObjProperty(moongate, "City", gate[4]);
-    moongate.facing := 29;
-    moongate.decayAt := 0;
-    moongate.movable := 0;
-  endforeach
-endfunction

Deleted: trunk/096/pkg/items/moongates/start.src
===================================================================
--- trunk/096/pkg/items/moongates/start.src	2005-11-07 01:20:20 UTC (rev 937)
+++ trunk/096/pkg/items/moongates/start.src	2005-11-07 06:22:45 UTC (rev 938)
@@ -1,6 +0,0 @@
-use uo;
-
-include "moongates";
-
-print("Initializing moongates");
-CreateMoongates();


Property changes on: trunk/096/pkg/items/walkOn/energyField/control.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/walkOn/energyField/methods.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/walkOn/fireField/methods.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/walkOn/paraField/methods.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/walkOn/poisonField/methods.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/walkOn/spiderWeb/methods.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/complete/blackEye/combat.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/complete/blackEye/virtual.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/delay/delayCheck.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/spellScripts/circle1/createFood.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/loot/configs/OLD/lootgroup.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/loot/configs/OLD/nlootgroup.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/spawnSystem/config/OLD/spawngroups.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/spawnSystem/config/OLD/spawnregions.cfg
___________________________________________________________________
Name: svn:keywords
   + Id



From muaddiblsd at berlios.de  Fri Nov 11 07:32:23 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Fri, 11 Nov 2005 07:32:23 +0100
Subject: [Poldistro-svn] r939 - trunk/096/pkg/packetHooks/BFCommand
Message-ID: <200511110632.jAB6WNHg011570@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-11 07:32:12 +0100 (Fri, 11 Nov 2005)
New Revision: 939

Modified:
   trunk/096/pkg/packetHooks/BFCommand/setUCLang.src
Log:


Modified: trunk/096/pkg/packetHooks/BFCommand/setUCLang.src
===================================================================
--- trunk/096/pkg/packetHooks/BFCommand/setUCLang.src	2005-11-07 06:22:45 UTC (rev 938)
+++ trunk/096/pkg/packetHooks/BFCommand/setUCLang.src	2005-11-11 06:32:12 UTC (rev 939)
@@ -22,7 +22,7 @@
 
 exported function HandleSetUCLang( who, byref packet )
 	// Get the Language the client is sending from the packet.
-	var lang := packet.GetString(5,4);
+	var lang := packet.GetString(5,3);
 	// Find the player's account reference.
 	var acct := FindAccount(who.acctname);
 	// Add a Cprop to the account for using later.



From austin at berlios.de  Sat Nov 12 07:06:27 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sat, 12 Nov 2005 07:06:27 +0100
Subject: [Poldistro-svn] r940 - trunk/096/pkg/mobiles/brainAI
Message-ID: <200511120606.jAC66RPM025337@sheep.berlios.de>

Author: austin
Date: 2005-11-12 07:06:14 +0100 (Sat, 12 Nov 2005)
New Revision: 940

Added:
   trunk/096/pkg/mobiles/brainAI/bundled/
Removed:
   trunk/096/pkg/mobiles/brainAI/complete/
Modified:
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
Log:
Renamed "assembled" to "bundled"
Added 'Alignment' line to all templates in the npcdesc.cfg so far.
Working on banker NPC.

Copied: trunk/096/pkg/mobiles/brainAI/bundled (from rev 939, trunk/096/pkg/mobiles/brainAI/complete)

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-11 06:32:12 UTC (rev 939)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-12 06:06:14 UTC (rev 940)
@@ -17,6 +17,7 @@
 	Gender			0
 	AR			25
 	RunSpeed		200
+	Alignment		neutral
 	Category		Testing
 
 	// Attributes
@@ -44,23 +45,23 @@
 	AISetting	SleepWait	i1000
 
 	// Brain AI Nerves
-	AIScript	Combat		:brainAI:complete/exampleNPC/combat
-	AIScript	Cycle		:brainAI:complete/exampleNPC/cycle
-	AIScript	DblClick	:brainAI:complete/exampleNPC/doubleClick
-	AIScript	Disengaged	:brainAI:complete/exampleNPC/disengaged
-	AIScript	EnterArea	:brainAI:complete/exampleNPC/enteredArea
-	AIScript	GoneCriminal	:brainAI:complete/exampleNPC/goneCriminal
-	AIScript	Init		:brainAI:complete/exampleNPC/init
-	AIScript	ItemGiven	:brainAI:complete/exampleNPC/itemGiven
-	AIScript	LeftArea	:brainAI:complete/exampleNPC/leftArea
-	AIScript	LookAround	:brainAI:complete/exampleNPC/lookAround
-	AIScript	Listen		:brainAI:complete/exampleNPC/listen
-	AISCript	Merchant	:brainAI:complete/exampleNPC/merchant
-	AIScript	Restart		:brainAI:complete/exampleNPC/restart
-	AIScript	Sleep		:brainAI:complete/exampleNPC/sleep
-	AIScript	ShouldWatch	:brainAI:complete/exampleNPC/shouldWatch
-	AIScript	Virtual		:brainAI:complete/exampleNPC/virtual
-	AIScript	EndFight	:brainAI:complete/exampleNPC/endFight
+	AIScript	Combat		:brainAI:bundled/exampleNPC/combat
+	AIScript	Cycle		:brainAI:bundled/exampleNPC/cycle
+	AIScript	DblClick	:brainAI:bundled/exampleNPC/doubleClick
+	AIScript	Disengaged	:brainAI:bundled/exampleNPC/disengaged
+	AIScript	EnterArea	:brainAI:bundled/exampleNPC/enteredArea
+	AIScript	GoneCriminal	:brainAI:bundled/exampleNPC/goneCriminal
+	AIScript	Init		:brainAI:bundled/exampleNPC/init
+	AIScript	ItemGiven	:brainAI:bundled/exampleNPC/itemGiven
+	AIScript	LeftArea	:brainAI:bundled/exampleNPC/leftArea
+	AIScript	LookAround	:brainAI:bundled/exampleNPC/lookAround
+	AIScript	Listen		:brainAI:bundled/exampleNPC/listen
+	AISCript	Merchant	:brainAI:bundled/exampleNPC/merchant
+	AIScript	Restart		:brainAI:bundled/exampleNPC/restart
+	AIScript	Sleep		:brainAI:bundled/exampleNPC/sleep
+	AIScript	ShouldWatch	:brainAI:bundled/exampleNPC/shouldWatch
+	AIScript	Virtual		:brainAI:bundled/exampleNPC/virtual
+	AIScript	EndFight	:brainAI:bundled/exampleNPC/endFight
 
 	// Skinning Info
 
@@ -84,6 +85,7 @@
 	Gender			0
 	AR			1
 	RunSpeed		25
+	Alignment		evil
 	Category		Austin
 
 	// Attributes
@@ -140,6 +142,7 @@
 	Gender			0
 	AR			2
 	RunSpeed		25
+	Alignent		neutral
 	Category		Austin
 
 	// Attributes
@@ -176,13 +179,13 @@
 	AISetting	IdleTicks	i30
 	AISetting	SleepWait	i1000
 
-	AIScript	Combat		:brainAI:complete/blackEye/combat
+	AIScript	Combat		:brainAI:bundled/blackEye/combat
 	AIScript	EnterArea	:brainAI:scripts/enterArea/generic
 	AIScript	LeftArea	:brainAI:scripts/LeftArea/generic
 	AIScript	LookAround	:brainAI:scripts/lookAround/findAttackables
 	AIScript	Sleep		:brainAI:scripts/sleep/generic
 	AIScript	ShouldWatch	:brainAI:scripts/shouldWatch/targetPlayers
-	AIScript	Virtual		:brainAI:complete/blackEye/virtual
+	AIScript	Virtual		:brainAI:bundled/blackEye/virtual
 
 	// Skinning Info
 
@@ -201,6 +204,7 @@
 	Gender			0
 	AR			10
 	RunSpeed		150
+	Alignment		evil
 	Category		Austin
 	
 	// Attributes
@@ -255,6 +259,56 @@
 }
 
 ##########################################
+# Merchants
+##########################################
+
+##########################################
+# Utility
+##########################################
+NPCTemplate banker
+{
+	// Primary NPC settings
+	Name			<random> the banker
+	Script			:brainAI:brain
+	ObjType			0x190
+	Color			0
+	TrueColor		0
+	Gender			0
+	RunSpeed		255
+	AR			100
+	Alignment		good
+	Category		Utility
+	
+	// Attributes
+	Strength		200
+	Intelligence		200
+	Dexterity		200
+	
+	// Vitals
+	HITS			200
+	MANA			200
+	STAM			200
+	
+	// Intrinsic Weapon
+	AttackAttribute		Wrestling
+	AttackSpeed		80
+	AttackDamage		200
+	AttackHitScript		:combat:mainHitScript
+
+	// Brain AI Settings
+	AISetting	CycleWait	i100
+	AISetting	SleepWait	i100
+	AISetting	IdleTicks	i100
+	AISetting	ListenRange	i5
+	AISetting	HearSpeech	i1
+	
+	// Brain AI Nerves
+	AIScript	Combat		:brainAI:bundled/banker/combat
+	AIScript	Listen		:brainAI:bundled/banker/listen
+}
+	
+
+##########################################
 # Animals
 ##########################################
 NPCTemplate cow
@@ -262,12 +316,13 @@
 	// Primary NPC settings
 	Name			a cow
 	Script			:brainAI:brain
-	ObjType			0xd8
+	ObjType			0xD8
 	Color			0
 	TrueColor		0
 	Gender			0
 	RunSpeed		15
 	AR			9
+	Alignment		neutral
 	Category		Animal
 
 	// Attributes
@@ -328,9 +383,10 @@
 	Script			:brainAI:brain
 	ObjType			0xCF
 	Color			0
-	TrueColor		33784
+	TrueColor		0
 	Gender			0
-	runspeed		17
+	RunSpeed		17
+	Alignment		neutral
 	AR			8
 
 	// Attributes
@@ -392,4 +448,5 @@
 	// CProps (eww!)
 	CProp  Karma		i0
 	CProp  Fame		i1
-}
\ No newline at end of file
+}
+



From austin at berlios.de  Sat Nov 12 18:04:22 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sat, 12 Nov 2005 18:04:22 +0100
Subject: [Poldistro-svn] r941 - in trunk/096: config pkg/mobiles pkg/mobiles/newCharacter pkg/mobiles/newCharacter/config pkg/mobiles/newCharacter/include scripts/misc
Message-ID: <200511121704.jACH4MUx012954@sheep.berlios.de>

Author: austin
Date: 2005-11-12 18:04:21 +0100 (Sat, 12 Nov 2005)
New Revision: 941

Added:
   trunk/096/pkg/mobiles/newCharacter/
   trunk/096/pkg/mobiles/newCharacter/config/
   trunk/096/pkg/mobiles/newCharacter/config/icp.cfg
   trunk/096/pkg/mobiles/newCharacter/config/startEquip.cfg
   trunk/096/pkg/mobiles/newCharacter/include/
   trunk/096/pkg/mobiles/newCharacter/include/newCharacter.inc
   trunk/096/pkg/mobiles/newCharacter/onCreate.src
   trunk/096/pkg/mobiles/newCharacter/onDelete.src
   trunk/096/pkg/mobiles/newCharacter/pkg.cfg
Removed:
   trunk/096/config/starteqp.cfg
Modified:
   trunk/096/scripts/misc/oncreate.src
Log:
Uploading what has been done so far on this project.
Moved character creation stuff to a package.
Will issue items based on the three selected skills.
Will store the 3 skills the player selected.

Deleted: trunk/096/config/starteqp.cfg
===================================================================
--- trunk/096/config/starteqp.cfg	2005-11-12 06:06:14 UTC (rev 940)
+++ trunk/096/config/starteqp.cfg	2005-11-12 17:04:21 UTC (rev 941)
@@ -1,298 +0,0 @@
-ForSkill Alchemy
-{
-	Item	1	Mortar
-	Stack	4	EmptyBottle
-	Random	4	Reagents
-	Unique	Robe	reds
-}
-
-ForSkill Anatomy
-{
-	Unique	Robe	yellows
-	Stack	3	bandages
-}
-
-ForSkill AnimalLore
-{
-	Unique	shepherdscrook
-	Unique	Robe	greens
-}
-
-ForSkill ItemId
-{
-	Item	1	gnarledstaff
-}
-
-ForSkill Parry
-{
-	Item	1	practiceshield
-}
-
-ForSkill Begging
-{
-	Item	1	gnarledstaff
-}
-
-ForSkill Blacksmithy
-{
-	Unique	smithhammer
-	Item	1	0x153b	browns
-}
-
-ForSkill Carpentry
-{
-	Random	1	carpentryitems
-	Item	1	0x153b	greens
-}
-
-ForSkill Bowcraft
-{
-	Stack	10	log
-	Stack	10	feather
-	Stack	10	arrowshaft
-}
-
-ForSkill Peacemaking
-{
-	Item	1	lute
-}
-
-ForSkill Camping
-{
-	Stack	5	kindling
-	Item	1	bedroll
-}
-
-ForSkill Cartography
-{
-	Item	1	sextant
-	Item	4	blankmap
-}
-
-ForSkill Cooking
-{
-	Stack	3	rawbird
-}
-
-ForSkill DetectingHidden
-{
-	Unique	0x1515	0x453
-}
-
-ForSkill Enticement
-{
-	Item	1	lute
-}
-
-ForSkill EvaluatingIntelligence
-{
-}
-
-ForSkill Healing
-{
-	Stack	5	bandages
-	Item	1	scissors
-}
-
-ForSkill Fishing
-{
-	Item	1	fishingpole
-	Item	1	floppyhat	brown
-}
-
-ForSkill Herding
-{
-	Item	1	shepherdscrook
-}
-
-ForSkill Hiding
-{
-	Unique	0x1515	0x453
-}
-
-ForSkill Provocation
-{
-	Item	1	drum
-}
-
-ForSkill Inscription
-{
-	Item	1	book
-	Stack	2	blankscroll
-}
-
-ForSkill Lockpicking
-{
-	Stack	5	lockpick
-}
-
-ForSkill Magery
-{
-	Unique	Spellbook
-	Unique	Robe	reds
-	Random	3	Circle1Scrolls
-	Random	3	Reagents
-}
-
-ForSkill MagicResistance
-{
-}
-
-ForSkill Tactics
-{
-}
-
-ForSkill Snooping
-{
-	Unique	0x1515	0x453
-}
-
-ForSkill Musicianship
-{
-	Item	1	harp
-}
-
-ForSkill Poisoning
-{
-	Item	2	lesserpoison
-}
-
-ForSkill Archery
-{
-	Item	1	practicebow
-	Stack	25	arrow
-}
-
-ForSkill SpiritSpeak
-{
-	Unique	0x1515	0x453
-}
-
-ForSkill Stealing
-{
-	Unique	0x1515	0x453
-}
-
-ForSkill Tailoring
-{
-	Item	1	sewingkit
-	Stack	1	bolt1
-}
-
-ForSkill AnimalTaming
-{
-	Unique	shepherdscrook
-}
-
-ForSkill TasteIdentification
-{
-	Stack	3	Potions
-}
-
-ForSkill Swordsmanship
-{
-	Item	1	practicelongsword
-}
-
-ForSkill Macefighting
-{
-	Item	1	practicemace
-}
-
-ForSkill Fencing
-{
-	Item	1	practicekryss
-}
-
-ForSkill Wrestling
-{
-	Item	1	leathergloves
-}
-
-ForSkill Mining
-{
-	Item	1	pickaxe
-	Item	1	shovel
-}
-
-ForSkill Lumberjacking
-{
-	Unique	hatchet
-}
-
-ForSkill Tinkering
-{
-	Unique	tinkertools
-	Item	1	0x153b	brown
-	Item	1	sextantparts
-}
-
-ForSkill Veterinary
-{
-	Stack	5	bandages
-	Item	1	scissors
-}
-
-ForSkill Tracking
-{
-	Item	1	skinningknife
-	Item	1	0x1711	brown
-}
-
-Group	Reagents
-{
-	Item	3	BloodMoss
-	Item	3	BlackPearl
-	Item	3	Garlic
-	Item	3	SpiderSilk
-	Item	3	MandrakeRoot
-	Item	3	SulfurousAsh
-	Item	3	BlackPearl
-	Item	3	Ginseng
-}
-
-ForSkill all
-{
-	Item	1	candle1
-	Item	1	book1
-}
-
-Group	Circle1Scrolls
-{
-	Item	1	reactivearmorscroll
-	Item	1	clumsyscroll
-	Item	1	createfoodscroll
-	Item	1	feeblemindscroll
-	Item	1	healscroll
-	Item	1	magicarrowscroll
-	Item	1	nightsightscroll
-	Item	1	weakenscroll
-}
-
-Group	Potions
-{
-	Item	1	LesserHeal
-	Item	1	LesserPoison
-	Item	1	LesserExplosion
-	Item	1	AgilityPotion
-	Item	1	RefreshPotion
-	Item	1	StrengthPotion
-	Item	1	Nightsight
-	Item	1	LesserCure
-}
-
-Group	carpentryitems
-{
-	Item	1	Scorp
-	Item	1	Jointingplane
-	Item	1	mouldingplane
-	Item	1	Smoothingplane
-	Item	1	Hammer
-	Item	1	Saw
-	Item	1	Saw2
-	Item	1	Dovetailsaw
-	Item	1	drawknife
-	Item	1	Froe
-	Item	1	inshave
-}
-

Added: trunk/096/pkg/mobiles/newCharacter/config/icp.cfg
===================================================================
--- trunk/096/pkg/mobiles/newCharacter/config/icp.cfg	2005-11-12 06:06:14 UTC (rev 940)
+++ trunk/096/pkg/mobiles/newCharacter/config/icp.cfg	2005-11-12 17:04:21 UTC (rev 941)
@@ -0,0 +1,19 @@
+# $Id$
+#
+#
+ICP Register
+{
+	Name		New Character
+	Version		1.0
+	Description	Sets up new characters. Gives them start equipment based on selected skills.
+
+	Creator		Austin
+	C_Email		AustinHeilman at gmail.com
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}

Added: trunk/096/pkg/mobiles/newCharacter/config/startEquip.cfg
===================================================================
--- trunk/096/pkg/mobiles/newCharacter/config/startEquip.cfg	2005-11-12 06:06:14 UTC (rev 940)
+++ trunk/096/pkg/mobiles/newCharacter/config/startEquip.cfg	2005-11-12 17:04:21 UTC (rev 941)
@@ -0,0 +1,298 @@
+ForSkill Alchemy
+{
+	Item	1	Mortar
+	Item	4	EmptyBottle
+	Random	4	Reagents
+	Unique	Robe	reds
+}
+
+ForSkill Anatomy
+{
+	Unique	Robe	yellows
+	Item	3	bandages
+}
+
+ForSkill AnimalLore
+{
+	Unique	shepherdscrook
+	Unique	Robe	greens
+}
+
+ForSkill ItemId
+{
+	Item	1	gnarledstaff
+}
+
+ForSkill Parry
+{
+	Item	1	practiceshield
+}
+
+ForSkill Begging
+{
+	Item	1	gnarledstaff
+}
+
+ForSkill Blacksmithy
+{
+	Unique	smithhammer
+	Item	1	0x153b	browns
+}
+
+ForSkill Carpentry
+{
+	Random	1	carpentryitems
+	Item	1	0x153b	greens
+}
+
+ForSkill Bowcraft
+{
+	Item	10	log
+	Item	10	feather
+	Item	10	arrowshaft
+}
+
+ForSkill Peacemaking
+{
+	Item	1	lute
+}
+
+ForSkill Camping
+{
+	Item	5	kindling
+	Item	1	bedroll
+}
+
+ForSkill Cartography
+{
+	Item	1	sextant
+	Item	4	blankmap
+}
+
+ForSkill Cooking
+{
+	Item	3	rawbird
+}
+
+ForSkill DetectingHidden
+{
+	Unique	0x1515	0x453
+}
+
+ForSkill Enticement
+{
+	Item	1	lute
+}
+
+ForSkill EvaluatingIntelligence
+{
+}
+
+ForSkill Healing
+{
+	Item	5	bandages
+	Item	1	scissors
+}
+
+ForSkill Fishing
+{
+	Item	1	fishingpole
+	Item	1	floppyhat	brown
+}
+
+ForSkill Herding
+{
+	Item	1	shepherdscrook
+}
+
+ForSkill Hiding
+{
+	Unique	0x1515	0x453
+}
+
+ForSkill Provocation
+{
+	Item	1	drum
+}
+
+ForSkill Inscription
+{
+	Item	1	book
+	Item	2	blankscroll
+}
+
+ForSkill Lockpicking
+{
+	Item	5	lockpick
+}
+
+ForSkill Magery
+{
+	Unique	Spellbook
+	Unique	Robe	reds
+	Random	3	Circle1Scrolls
+	Random	3	Reagents
+}
+
+ForSkill MagicResistance
+{
+}
+
+ForSkill Tactics
+{
+}
+
+ForSkill Snooping
+{
+	Unique	0x1515	0x453
+}
+
+ForSkill Musicianship
+{
+	Item	1	harp
+}
+
+ForSkill Poisoning
+{
+	Item	2	lesserpoison
+}
+
+ForSkill Archery
+{
+	Item	1	practicebow
+	Item	25	arrow
+}
+
+ForSkill SpiritSpeak
+{
+	Unique	0x1515	0x453
+}
+
+ForSkill Stealing
+{
+	Unique	0x1515	0x453
+}
+
+ForSkill Tailoring
+{
+	Item	1	sewingkit
+	Item	1	bolt1
+}
+
+ForSkill AnimalTaming
+{
+	Unique	shepherdscrook
+}
+
+ForSkill TasteIdentification
+{
+	Item	3	Potions
+}
+
+ForSkill Swordsmanship
+{
+	Item	1	practicelongsword
+}
+
+ForSkill Macefighting
+{
+	Item	1	practicemace
+}
+
+ForSkill Fencing
+{
+	Item	1	practicekryss
+}
+
+ForSkill Wrestling
+{
+	Item	1	leathergloves
+}
+
+ForSkill Mining
+{
+	Item	1	pickaxe
+	Item	1	shovel
+}
+
+ForSkill Lumberjacking
+{
+	Unique	hatchet
+}
+
+ForSkill Tinkering
+{
+	Unique	tinkertools
+	Item	1	0x153b	brown
+	Item	1	sextantparts
+}
+
+ForSkill Veterinary
+{
+	Item	5	bandages
+	Item	1	scissors
+}
+
+ForSkill Tracking
+{
+	Item	1	skinningknife
+	Item	1	0x1711	brown
+}
+
+Group	Reagents
+{
+	Item	3	BloodMoss
+	Item	3	BlackPearl
+	Item	3	Garlic
+	Item	3	SpiderSilk
+	Item	3	MandrakeRoot
+	Item	3	SulfurousAsh
+	Item	3	BlackPearl
+	Item	3	Ginseng
+}
+
+ForSkill All
+{
+	Item	1	candle1
+	Item	1	book1
+}
+
+Group	Circle1Scrolls
+{
+	Item	1	reactivearmorscroll
+	Item	1	clumsyscroll
+	Item	1	createfoodscroll
+	Item	1	feeblemindscroll
+	Item	1	healscroll
+	Item	1	magicarrowscroll
+	Item	1	nightsightscroll
+	Item	1	weakenscroll
+}
+
+Group	Potions
+{
+	Item	1	LesserHeal
+	Item	1	LesserPoison
+	Item	1	LesserExplosion
+	Item	1	AgilityPotion
+	Item	1	RefreshPotion
+	Item	1	StrengthPotion
+	Item	1	Nightsight
+	Item	1	LesserCure
+}
+
+Group	CarpentryItems
+{
+	Item	1	Scorp
+	Item	1	Jointingplane
+	Item	1	mouldingplane
+	Item	1	Smoothingplane
+	Item	1	Hammer
+	Item	1	Saw
+	Item	1	Saw2
+	Item	1	Dovetailsaw
+	Item	1	drawknife
+	Item	1	Froe
+	Item	1	inshave
+}
+

Added: trunk/096/pkg/mobiles/newCharacter/include/newCharacter.inc
===================================================================
--- trunk/096/pkg/mobiles/newCharacter/include/newCharacter.inc	2005-11-12 06:06:14 UTC (rev 940)
+++ trunk/096/pkg/mobiles/newCharacter/include/newCharacter.inc	2005-11-12 17:04:21 UTC (rev 941)
@@ -0,0 +1,74 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+use cfgfile;
+
+include ":datafile:datafile";
+
+/* NC_GetDataFile()
+ * 
+ * Purpose
+ * Retrives :newcharacter:createinfo
+ *
+ * Parameters
+ *
+ * Return Value
+ * Data file
+ * 
+ */
+function NC_GetDataFile()
+	return DFOpenDataFile(":newcharacter:createinfo", DF_CREATE);
+endfunction
+
+/*
+ * NC_GetStartupSkills(mobile)
+ *
+ * Purpose
+ * Retrieves the skills the player selected on creation.
+ *
+ * Parameters
+ * mobile:	Mobile to retrieve the skill list for.
+ *
+ * Return value
+ * Array of strings
+ *
+ */
+function NC_GetStartupSkills(mobile)
+	if ( !mobile.acctname )
+		return error{"errortext":="Object passed was not a player-character"};
+	endif
+	
+	var data_file := NC_GetDataFile();
+	var data_elem := DFFindElement(data_file, Hex(mobile.serial));
+	
+	return data_elem.GetProp("StartSkills");
+endfunction
+
+/*
+ * NC_SetStartupSkills(mobile, skill_names)
+ *
+ * Purpose
+ * Stores the skills the player selected on creation.
+ *
+ * Parameters
+ * mobile:	Mobile to retrieve the skill list for.
+ * skill_names:	Array containing attribute names chosen.
+ *
+ * Return value
+ * 1
+ *
+ */
+function NC_SetStartupSkills(mobile, skill_names)
+	if ( !mobile.acctname )
+		return error{"errortext":="Object passed was not a player-character"};
+	endif
+	
+	var data_file := NC_GetDataFile();
+	var data_elem := DFFindElement(data_file, Hex(mobile.serial), DF_CREATE);
+	
+	return data_elem.SetProp("StartSkills", skill_names);
+endfunction

Added: trunk/096/pkg/mobiles/newCharacter/onCreate.src
===================================================================
--- trunk/096/pkg/mobiles/newCharacter/onCreate.src	2005-11-12 06:06:14 UTC (rev 940)
+++ trunk/096/pkg/mobiles/newCharacter/onCreate.src	2005-11-12 17:04:21 UTC (rev 941)
@@ -0,0 +1,77 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+use file;
+use cfgfile;
+
+include ":attributes:attributes";
+include ":attributes:attributes_ex";
+include ":newcharacter:newCharacter";
+
+program OnCreate(params)
+	var who := params[1];
+	var selected_skills := params[2];
+	params := 0; // No longer needed.
+	
+	// Convert skill ID numbers to attribute names.
+	// Core currently sends them as skill IDs!
+	foreach skill in ( selected_skills )
+		skill := AP_SkillIdToAttributeName(skill);
+		sleepms(2);
+	endforeach
+	
+	// Save the chosen skills.
+	NC_SetStartupSkills(who, selected_skills);
+	
+	GenerateItemsForSkill(who, "All");
+	foreach skill in ( selected_skills )
+		GenerateItemsForSkill(who, skill);
+		sleepms(2);
+	endforeach
+
+	return 1;
+endprogram
+
+function GenerateItemsForSkill(who, attribute)
+	var cfg_file := ReadConfigFile(":newcharacter:config/startEquip");
+	var cfg_elem := cfg_file[attribute];
+	
+	foreach entry in ( GetConfigStringArray(cfg_elem, "Item") )
+		entry := SplitWords(entry);
+		CreateItemInBackPack(who, entry[2], CInt(entry[1]));
+		sleepms(2);
+	endforeach
+	
+	foreach entry in ( GetConfigStringArray(cfg_elem, "Random") )
+		entry := SplitWords(entry);
+		var amount := CInt(entry[1]);
+		var rand_elem := cfg_file[amount[2]];
+		var item_list := GetConfigStringArray(rand_elem, "Item");
+		for ( amount; amount>0; amount:=amount-1 )
+			var selected := item_list[RandomInt(item_list.Size())+1];
+			selected := SplitWords(2);
+			CreateItemInBackPack(who, selected[2], CInt(selected[1]));
+			sleepms(2);
+		endfor
+		sleepms(2);
+	endforeach
+	
+	return 1;
+endfunction
+
+function CreateItemFromElem(who, byref cfg_elem)
+	var item_list := GetConfigStringArray(cfg_elem, "Item");
+	var entry := item_list[RandomInt(item_list.Size())+1];
+	entry := SplitWords(entry);
+	
+	var item := CreateItemInBackPack(who, CInt(entry[1]), entry[2]);
+	if ( item.errortext )
+		SendSysMessage(who, "Error creating "+entry+" ->"+item.errortext);
+	endif
+	
+	return item;
+endfunction

Added: trunk/096/pkg/mobiles/newCharacter/onDelete.src
===================================================================
--- trunk/096/pkg/mobiles/newCharacter/onDelete.src	2005-11-12 06:06:14 UTC (rev 940)
+++ trunk/096/pkg/mobiles/newCharacter/onDelete.src	2005-11-12 17:04:21 UTC (rev 941)
@@ -0,0 +1,13 @@
+/*
+ * $Id$
+ *
+ */
+
+include ":newcharacter:newCharacter";
+
+program OnDelete(who)
+	var data_file := NC_GetDataFile();
+	data_file.DeleteElement(Hex(who.serial));
+	
+	return 1;
+endprogram

Added: trunk/096/pkg/mobiles/newCharacter/pkg.cfg
===================================================================
--- trunk/096/pkg/mobiles/newCharacter/pkg.cfg	2005-11-12 06:06:14 UTC (rev 940)
+++ trunk/096/pkg/mobiles/newCharacter/pkg.cfg	2005-11-12 17:04:21 UTC (rev 941)
@@ -0,0 +1,17 @@
+# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+Enabled		1
+Name		newcharacter
+
+Version		1.0
+
+CoreRequired	96
+
+Creator		Austin Heilman
+Email		AustinHeilman at gmail.com
+Maintainer	Distro Team
+Email		distro at polserver.com
+
+#Requires	none
+#Conflicts	none

Modified: trunk/096/scripts/misc/oncreate.src
===================================================================
--- trunk/096/scripts/misc/oncreate.src	2005-11-12 06:06:14 UTC (rev 940)
+++ trunk/096/scripts/misc/oncreate.src	2005-11-12 17:04:21 UTC (rev 941)
@@ -11,20 +11,12 @@
 
 
 program core_onCreate(who, skillids)
-	if ((13 in CAscZ(who.name)) || (10 in CAscZ(who.name)))
-		var account := who.acct;
-		account.ban();
-		for i:=1 to 5
-			account.DeleteCharacter( i );
-		endfor
-		syslog("ALERT! Account " + account.name + " was banned for cheating.");
+	var script := Start_Script(":newcharacter:onCreate", {who, skillids});
+	
+	if ( script.errortext )
+		SysLog("Error - Unable to start :newcharacter:onCreate ->"+script.errortext);
+		return 0;
 	endif
-	if (CInt(who.truecolor) <= 32768)
-		who.truecolor := who.truecolor + 32768;
-		who.color := who.truecolor;
-	endif
-	SetObjProperty(who, "OnCreate", ReadGameClock());
-	CreateStartingEquipment(who, skillids);
-
-	return;
+	
+	return 1;
 endprogram



From panosl at berlios.de  Sat Nov 12 23:36:57 2005
From: panosl at berlios.de (Panos Laganakos at BerliOS)
Date: Sat, 12 Nov 2005 23:36:57 +0100
Subject: [Poldistro-svn] r942 - trunk/096/pkg/commands/coun
Message-ID: <200511122236.jACMav92030022@sheep.berlios.de>

Author: panosl
Date: 2005-11-12 23:36:56 +0100 (Sat, 12 Nov 2005)
New Revision: 942

Added:
   trunk/096/pkg/commands/coun/reveal.txt
Modified:
   trunk/096/pkg/commands/coun/conceal.src
   trunk/096/pkg/commands/coun/reveal.src
   trunk/096/pkg/commands/coun/tele.src
Log:


Modified: trunk/096/pkg/commands/coun/conceal.src
===================================================================
--- trunk/096/pkg/commands/coun/conceal.src	2005-11-12 17:04:21 UTC (rev 941)
+++ trunk/096/pkg/commands/coun/conceal.src	2005-11-12 22:36:56 UTC (rev 942)
@@ -15,7 +15,8 @@
 
 	if (!params)
 		SendMessage(who, MSG_TARGET_MOB, array{}, MSG_COMMAND);
-		if ((mobile := Target(who, TGTOPT_NOCHECK_LOS)) == 0)
+		mobile := Target(who, TGTOPT_NOCHECK_LOS);
+		if (mobile == 0)
 			SendMessage(who, MSG_CANCELLED, array{}, MSG_COMMAND);
 		else
 			if (!mobile.isA(POLCLASS_MOBILE))

Modified: trunk/096/pkg/commands/coun/reveal.src
===================================================================
--- trunk/096/pkg/commands/coun/reveal.src	2005-11-12 17:04:21 UTC (rev 941)
+++ trunk/096/pkg/commands/coun/reveal.src	2005-11-12 22:36:56 UTC (rev 942)
@@ -12,7 +12,8 @@
 
 	if (!params)
 		SendMessage(who, MSG_TARGET_MOB, array{}, MSG_COMMAND);
-		if ((mobile := Target(who, TGTOPT_NOCHECK_LOS) == 0))
+		mobile := Target(who, TGTOPT_NOCHECK_LOS);
+		if (mobile == 0)
 			SendMessage(who, MSG_CANCELLED, array{}, MSG_COMMAND);
 		else
 			if (!mobile.isA(POLCLASS_MOBILE))

Added: trunk/096/pkg/commands/coun/reveal.txt
===================================================================
--- trunk/096/pkg/commands/coun/reveal.txt	2005-11-12 17:04:21 UTC (rev 941)
+++ trunk/096/pkg/commands/coun/reveal.txt	2005-11-12 22:36:56 UTC (rev 942)
@@ -0,0 +1,6 @@
+<b>Syntax:</b>
+.reveal [me]
+
+<b>Purpose:</b>
+Let's you reveal yourself or target another mobile
+

Modified: trunk/096/pkg/commands/coun/tele.src
===================================================================
--- trunk/096/pkg/commands/coun/tele.src	2005-11-12 17:04:21 UTC (rev 941)
+++ trunk/096/pkg/commands/coun/tele.src	2005-11-12 22:36:56 UTC (rev 942)
@@ -1,3 +1,8 @@
+/* $Id$
+ *
+ * Purpose
+ *
+ */
 use uo;
 
 include "include/messages";
@@ -21,3 +26,4 @@
 
 	return;
 endprogram
+



From austin at berlios.de  Sun Nov 13 06:13:19 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 06:13:19 +0100
Subject: [Poldistro-svn] r943 - trunk/096/pkg/mobiles/brainAI/include/braincore
Message-ID: <200511130513.jAD5DJFc012720@sheep.berlios.de>

Author: austin
Date: 2005-11-13 06:13:08 +0100 (Sun, 13 Nov 2005)
New Revision: 943

Modified:
   trunk/096/pkg/mobiles/brainAI/include/braincore/sleep.inc
Log:
Provides built-in nerve stopping if a sleep script is not provided.


Modified: trunk/096/pkg/mobiles/brainAI/include/braincore/sleep.inc
===================================================================
--- trunk/096/pkg/mobiles/brainAI/include/braincore/sleep.inc	2005-11-12 22:36:56 UTC (rev 942)
+++ trunk/096/pkg/mobiles/brainAI/include/braincore/sleep.inc	2005-11-13 05:13:08 UTC (rev 943)
@@ -27,8 +27,17 @@
 			if ( !process )
 				StartNerve(npc, "Sleep", g_scripts["Sleep"].script, array{g_settings, g_scripts}, g_scripts["Sleep"].flags);
 			endif
+		else
+			foreach nerve in (LoadNerves(npc))
+				if ( nerve.flags & NF_CONTINUE_ON_SLEEP )
+					continue;
+				else
+					StopNerve(npc, _nerve_iter);
+				endif
+				sleepms(2);
+			endforeach
 		endif
-					
+	
 		//The brain is now in sleep mode, isn't it cute?
 		sleep_mode := 1;
 	endif



From austin at berlios.de  Sun Nov 13 08:26:30 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 08:26:30 +0100
Subject: [Poldistro-svn] r944 - in trunk/096/pkg/systems/loot: configs includes
Message-ID: <200511130726.jAD7QUjr009805@sheep.berlios.de>

Author: austin
Date: 2005-11-13 08:26:17 +0100 (Sun, 13 Nov 2005)
New Revision: 944

Modified:
   trunk/096/pkg/systems/loot/configs/loot-groups.cfg
   trunk/096/pkg/systems/loot/configs/loot-index.cfg
   trunk/096/pkg/systems/loot/includes/lootParser.inc
Log:
Flipped some entries around in config files.
Names come before amounts now.

Modified: trunk/096/pkg/systems/loot/configs/loot-groups.cfg
===================================================================
--- trunk/096/pkg/systems/loot/configs/loot-groups.cfg	2005-11-13 05:13:08 UTC (rev 943)
+++ trunk/096/pkg/systems/loot/configs/loot-groups.cfg	2005-11-13 07:26:17 UTC (rev 944)
@@ -3,74 +3,76 @@
 # loot-groups.cfg
 #
 # These are groups where items can be randomly selected from.
+# Amount can be a solid number or a dice string.
+# ItemName can be an objtype number or an item name.
 #
 # LootGroup GroupName
 # {
-# 	Item	<Amount>	<ItemName>
+# 	Item	<itemName>	<Amount>
 # }
 #
 ######################################################
 
 Group BigWeapons
 {
-	Item	1	LongBow
-	Item	1	WarAxe
-	Item	1	BattleAxe
-	Item	1	LargeBattleAxe
-	Item	1	TwoHandedAxe
-	Item	1	WarHammer
-	Item	1	WarMace
-	Item	1	Bardiche
-	Item	1	Halberd
-	Item	1	BroadSword
-	Item	1	BlackStaff
+	Item	LongBow		1
+	Item	WarAxe		1
+	Item	BattleAxe	1
+	Item	LargeBattleAxe	1
+	Item	TwoHandedAxe	1
+	Item	WarHammer	1
+	Item	WarMace		1
+	Item	Bardiche	1
+	Item	Halberd		1
+	Item	BroadSword	1
+	Item	BlackStaff	1
 }
 
 Group Booze
 {
-	Item	1d2 BottleOfLiquor
-	Item	1d2 BottleOfAle
-	Item	1d2 BottleOfWine
-	Item	1d2 BottleOfRum
+	Item	BottleOfLiquor	1d2
+	Item	BottleOfAle	1d2
+	Item	BottleOfWine	1d2
+	Item	BottleOfRum	1d2
 }
 
 Group Reagents
 {
-	Item	1d6 Batwing
-	Item	1d6 Nightshade
-	Item	1d6 Garlic
-	Item	1d6 SpiderSilk
-	Item	1d6 MandrakeRoot
-	Item	1d6 SulphurousAsh
-	Item	1d6 Ginseng
-	Item	1d6 BloodMoss
-	Item	1d6 Bone
-	Item	1d6 VialOfBlood
-	Item	1d6 EyeOfNewt
-	Item	1d6 Pumice
-	Item	1d6 SerpentScale
-	Item	1d6 DeadWood
-	Item	1d6 FertileDirt
-	Item	1d6 ExecutionersCap
+	Item	Batwing		1d6
+	Item	Nightshade	1d6
+	Item	Garlic		1d6
+	Item	SpiderSilk	1d6
+	Item	MandrakeRoot	1d6
+	Item	SulphurousAsh	1d6
+	Item	Ginseng		1d6
+	Item	BloodMoss	1d6
+	Item	Bone		1d6
+	Item	VialOfBlood	1d6
+	Item	EyeOfNewt	1d6
+	Item	Pumice		1d6
+	Item	SerpentScale	1d6
+	Item	DeadWood	1d6
+	Item	FertileDirt	1d6
+	Item	ExecutionersCap	1d6
 }
 
 Group Writing
 {
-	Item	1	book1
-	Item	1	book2
-	Item	1	book3
-	Item	1	book4
-	Item	1	book5
-	Item	1	book6
-	Item	1	PenAndInk
-	Item	1d10	BlankScroll
+	Item	book1		1
+	Item	book2		1
+	Item	book3		1
+	Item	book4		1
+	Item	book5		1
+	Item	book6		1
+	Item	PenAndInk	1
+	Item	BlankScroll	1d10
 }
 
 Group Jewelry
 {
-	Item	1	Ring
-	Item	1	Bracelet
-	Item	1	Earrings
-	Item	1	SolidNecklace
-	Item	1	BeadedNecklace
+	Item	Ring		1
+	Item	Bracelet	1
+	Item	Earrings	1
+	Item	SolidNecklace	1
+	Item	BeadedNecklace	1
 }
\ No newline at end of file

Modified: trunk/096/pkg/systems/loot/configs/loot-index.cfg
===================================================================
--- trunk/096/pkg/systems/loot/configs/loot-index.cfg	2005-11-13 05:13:08 UTC (rev 943)
+++ trunk/096/pkg/systems/loot/configs/loot-index.cfg	2005-11-13 07:26:17 UTC (rev 944)
@@ -8,10 +8,9 @@
 # This is the index for the loot system.
 # Options per element are specified below.
 #
-# [Chance] - This reflects a 100% chance. By default, it is 100 unless you specify
-# otherwise. Setting chance to '20' gives it a 20% chance of being used in the loot
-# generation process. Chance can range from 0.1 [1] to 100 [1000].
-# (1000 <= (chance*10)) == 1 - Generates item
+# [Chance] - This reflects a 100% chance. Default is 100%
+# Chance can range from 0.1 to 100.0
+# Example: Setting chance to '20' gives it a 20% chance of being generated / used.
 #
 # Dice - This is a dice string. XdY(+-)Z.
 #          Examples: 1d3+2   5d9-2
@@ -20,9 +19,9 @@
 #
 # LootIndex GroupName
 # {
-# 	Item	<N Dice>	<ItemName>	[Chance]	# Includes 'N' of ItemName
-#	Stack	<N Dice>	<ItemName>	[Chance]	# Stacks 'N' of ItemName
-#	Random	<N Dice>	<Group>		[Chance]	# Pick 'N' items from 'Group' randomly
+# 	Item	<ItemName>	<N Dice>	[Chance]	# Includes 'N' of ItemName
+#	Stack	<ItemName>	<N Dice>	[Chance]	# Stacks 'N' of ItemName
+#	Random	<Group>		<N Dice>	[Chance]	# Pick 'N' items from 'Group' randomly
 #	Group	[GroupName]					# Append another index group to the current one
 #
 #	MagicTable	[Table]	[Amount]	[Bias]	# Not yet implemented.
@@ -34,47 +33,47 @@
 
 LootGroup Dog
 {
-	Item	1	Bone	3
+	Item	Bone		1	3
 }
 
 LootGroup ElementalFire
 {
-	Stack	1d6+4	SulfurousAsh	100
+	Stack	SulfurousAsh	1d6+4	100
 }
 
 LootGroup ElementalEarth
 {
-	Item	2d5+5	FertileDirt	100
+	Item	FertileDirt	2d5+5	100
 }
 
 LootGroup ElementalWater
 {
-	Stack	1d4	BlackPearl	100
+	Stack	BlackPearl	1d4	100
 }
 
 LootGroup ElementalAir
 {
-	Stack	1d6+3	SpiderSilk	100
+	Stack	SpiderSilk	1d6+3	100
 }
 
 LootGroup Liche
 {
-	Item	2d3+2	GoldCoin	100
-	Item	1d8	GoldCoin	30
-	Item	1d10	GoldCoin	30
-	Item	2d4 	VialOfBlood	50
-	Item	1	heartofevil	0.5
-	Item	1d10	Bone		50
-	Random	2d10	Reagents	100
-	Random	2d12+10	Reagents	60
-	Random	1d2	Writing		15
-	Random	1	Jewelry		40
+	Item	GoldCoin	2d3+2	100
+	Item	GoldCoin	1d8	30
+	Item	GoldCoin	1d10	30
+	Item	VialOfBlood	2d4 	50
+	Item	heartofevil	1	0.5
+	Item	Bone		1d10	50
+	Random	Reagents	2d10	100
+	Random	Reagents	2d12+10	60
+	Random	Writing		1d2	15
+	Random	Jewelry		1	40
 }
 
 LootIndex Rabbit
 {
-	Stack	1	Seeds	5
-	Stack	1d3	Carrot		5
-	Stack	1d3	Turnip		3
-	Stack	1d2	HeadOfLettuce	2
+	Stack	Seeds		1	5
+	Stack	Carrot		1d3	5
+	Stack	Turnip		1d3	3
+	Stack	HeadOfLettuce	1d2	2
 }

Modified: trunk/096/pkg/systems/loot/includes/lootParser.inc
===================================================================
--- trunk/096/pkg/systems/loot/includes/lootParser.inc	2005-11-13 05:13:08 UTC (rev 943)
+++ trunk/096/pkg/systems/loot/includes/lootParser.inc	2005-11-13 07:26:17 UTC (rev 944)
@@ -110,10 +110,11 @@
 
 function Loot_ParseString(line)
 	line := SplitWords(line);
-	var amount := CStr(line[1]);
+	
+	var name := CStr(line[1]);
+	
+	var amount := CStr(line[2]);
 	amount := RandomDiceRoll(amount);
-
-	var name := CStr(line[2]);
 	
 	var chance := CDbl(line[3]);
 	if ( !chance )
@@ -121,8 +122,8 @@
 	endif
 
 	var result := struct;
+	result.+name := name;
 	result.+amount := amount;
-	result.+name := name;
 	result.+chance := chance;
 
 	return result;



From austin at berlios.de  Sun Nov 13 08:43:17 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 08:43:17 +0100
Subject: [Poldistro-svn] r945 - trunk/096/pkg/mobiles/newCharacter/config
Message-ID: <200511130743.jAD7hHBd015980@sheep.berlios.de>

Author: austin
Date: 2005-11-13 08:42:42 +0100 (Sun, 13 Nov 2005)
New Revision: 945

Modified:
   trunk/096/pkg/mobiles/newCharacter/config/startEquip.cfg
Log:
Updated to list item name, then amount.
Removed unused data and fixed tabs.

Modified: trunk/096/pkg/mobiles/newCharacter/config/startEquip.cfg
===================================================================
--- trunk/096/pkg/mobiles/newCharacter/config/startEquip.cfg	2005-11-13 07:26:17 UTC (rev 944)
+++ trunk/096/pkg/mobiles/newCharacter/config/startEquip.cfg	2005-11-13 07:42:42 UTC (rev 945)
@@ -1,87 +1,108 @@
+#
+# $Id$
+#
+###########################################
+#
+# ForSkill AttributeName
+# {
+#	Item	<ItemName>	<Amount>
+#	Unique	<ItemName>	<Amount>
+#	Random	<GroupName>	<Amount>
+# }
+#
+############################################
+#
+# Group GroupName
+# {
+#	Item	<ItemName>	<Amount>
+# }
+#
+###########################################
+
 ForSkill Alchemy
 {
-	Item	1	Mortar
-	Item	4	EmptyBottle
-	Random	4	Reagents
-	Unique	Robe	reds
+	Item	Mortar		1
+	Item	EmptyBottle	4
+	Random	Reagents	4
+	Unique	Robe		1
 }
 
 ForSkill Anatomy
 {
-	Unique	Robe	yellows
-	Item	3	bandages
+	Unique	Robe		1
+	Item	bandages	3
 }
 
 ForSkill AnimalLore
 {
-	Unique	shepherdscrook
-	Unique	Robe	greens
+	Unique	shepherdscrook	1
+	Unique	Robe		1
 }
 
 ForSkill ItemId
 {
-	Item	1	gnarledstaff
+	Item	gnarledstaff	1
 }
 
 ForSkill Parry
 {
-	Item	1	practiceshield
+	Item	practiceshield	1
 }
 
 ForSkill Begging
 {
-	Item	1	gnarledstaff
+	Item	gnarledstaff	1
 }
 
 ForSkill Blacksmithy
 {
-	Unique	smithhammer
-	Item	1	0x153b	browns
+	Unique	smithhammer	1
+	Item	0x153b		1
 }
 
 ForSkill Carpentry
 {
-	Random	1	carpentryitems
-	Item	1	0x153b	greens
+	Random	carpentryitems	1
+	Item	0x153b		1
 }
 
 ForSkill Bowcraft
 {
-	Item	10	log
-	Item	10	feather
-	Item	10	arrowshaft
+	Item	log		10
+	Item	feather		10
+	Item	arrowshaft	10
 }
 
 ForSkill Peacemaking
 {
-	Item	1	lute
+	Item	lute		1
 }
 
 ForSkill Camping
 {
-	Item	5	kindling
-	Item	1	bedroll
+	Item	kindling	5
+	Item	bedroll		1
 }
 
 ForSkill Cartography
 {
-	Item	1	sextant
-	Item	4	blankmap
+	Item	sextant		1
+	Item	blankmap	4
 }
 
 ForSkill Cooking
 {
-	Item	3	rawbird
+	Item	rawbird		3
 }
 
 ForSkill DetectingHidden
 {
-	Unique	0x1515	0x453
+	Unique	0x1515		0x453
 }
 
 ForSkill Enticement
 {
-	Item	1	lute
+	Item	lute		1
 }
 
 ForSkill EvaluatingIntelligence
@@ -90,48 +111,48 @@
 
 ForSkill Healing
 {
-	Item	5	bandages
-	Item	1	scissors
+	Item	bandages	5
+	Item	scissors	1
 }
 
 ForSkill Fishing
 {
-	Item	1	fishingpole
-	Item	1	floppyhat	brown
+	Item	fishingpole	1
+	Item	floppyhat	1
 }
 
 ForSkill Herding
 {
-	Item	1	shepherdscrook
+	Item	shepherdscrook	1
 }
 
 ForSkill Hiding
 {
-	Unique	0x1515	0x453
+	Unique	0x1515		0x453
 }
 
 ForSkill Provocation
 {
-	Item	1	drum
+	Item	drum		1
 }
 
 ForSkill Inscription
 {
-	Item	1	book
-	Item	2	blankscroll
+	Item	book		1
+	Item	blankscroll	2
 }
 
 ForSkill Lockpicking
 {
-	Item	5	lockpick
+	Item	lockpick	5
 }
 
 ForSkill Magery
 {
-	Unique	Spellbook
-	Unique	Robe	reds
-	Random	3	Circle1Scrolls
-	Random	3	Reagents
+	Unique	Spellbook	1
+	Unique	Robe		reds
+	Random	Circle1Scrolls	3
+	Random	Reagents	3
 }
 
 ForSkill MagicResistance
@@ -144,155 +165,155 @@
 
 ForSkill Snooping
 {
-	Unique	0x1515	0x453
+	Unique	0x1515		0x453
 }
 
 ForSkill Musicianship
 {
-	Item	1	harp
+	Item	harp		1
 }
 
 ForSkill Poisoning
 {
-	Item	2	lesserpoison
+	Item	lesserpoison	2
 }
 
 ForSkill Archery
 {
-	Item	1	practicebow
-	Item	25	arrow
+	Item	practicebow	1
+	Item	arrow		25
 }
 
 ForSkill SpiritSpeak
 {
-	Unique	0x1515	0x453
+	Unique	0x1515		0x453
 }
 
 ForSkill Stealing
 {
-	Unique	0x1515	0x453
+	Unique	0x1515		0x453
 }
 
 ForSkill Tailoring
 {
-	Item	1	sewingkit
-	Item	1	bolt1
+	Item	sewingkit	1
+	Item	bolt1		1
 }
 
 ForSkill AnimalTaming
 {
-	Unique	shepherdscrook
+	Unique	shepherdscrook	1
 }
 
 ForSkill TasteIdentification
 {
-	Item	3	Potions
+	Item	Potions		3
 }
 
 ForSkill Swordsmanship
 {
-	Item	1	practicelongsword
+	Item	practicelongsword	1
 }
 
 ForSkill Macefighting
 {
-	Item	1	practicemace
+	Item	practicemace	1
 }
 
 ForSkill Fencing
 {
-	Item	1	practicekryss
+	Item	practicekryss	1
 }
 
 ForSkill Wrestling
 {
-	Item	1	leathergloves
+	Item	leathergloves	1
 }
 
 ForSkill Mining
 {
-	Item	1	pickaxe
-	Item	1	shovel
+	Item	pickaxe		1
+	Item	shovel		1
 }
 
 ForSkill Lumberjacking
 {
-	Unique	hatchet
+	Unique	hatchet		1
 }
 
 ForSkill Tinkering
 {
-	Unique	tinkertools
-	Item	1	0x153b	brown
-	Item	1	sextantparts
+	Unique	tinkertools	1
+	Item	0x153b		1
+	Item	sextantparts	1
 }
 
 ForSkill Veterinary
 {
-	Item	5	bandages
-	Item	1	scissors
+	Item	bandages	5
+	Item	scissors	1
 }
 
 ForSkill Tracking
 {
-	Item	1	skinningknife
-	Item	1	0x1711	brown
+	Item	skinningknife	1
+	Item	0x1711		1
 }
 
 Group	Reagents
 {
-	Item	3	BloodMoss
-	Item	3	BlackPearl
-	Item	3	Garlic
-	Item	3	SpiderSilk
-	Item	3	MandrakeRoot
-	Item	3	SulfurousAsh
-	Item	3	BlackPearl
-	Item	3	Ginseng
+	Item	BloodMoss	3
+	Item	BlackPearl	3
+	Item	Garlic		3
+	Item	SpiderSilk	3
+	Item	MandrakeRoot	3
+	Item	SulfurousAsh	3
+	Item	BlackPearl	3
+	Item	Ginseng		3
 }
 
 ForSkill All
 {
-	Item	1	candle1
-	Item	1	book1
+	Item	candle1		1
+	Item	book1		1
 }
 
 Group	Circle1Scrolls
 {
-	Item	1	reactivearmorscroll
-	Item	1	clumsyscroll
-	Item	1	createfoodscroll
-	Item	1	feeblemindscroll
-	Item	1	healscroll
-	Item	1	magicarrowscroll
-	Item	1	nightsightscroll
-	Item	1	weakenscroll
+	Item	reactivearmorscroll	1
+	Item	clumsyscroll		1
+	Item	createfoodscroll	1
+	Item	feeblemindscroll	1
+	Item	healscroll		1
+	Item	magicarrowscroll	1
+	Item	nightsightscroll	1
+	Item	weakenscroll		1
 }
 
 Group	Potions
 {
-	Item	1	LesserHeal
-	Item	1	LesserPoison
-	Item	1	LesserExplosion
-	Item	1	AgilityPotion
-	Item	1	RefreshPotion
-	Item	1	StrengthPotion
-	Item	1	Nightsight
-	Item	1	LesserCure
+	Item	LesserHeal	1
+	Item	LesserPoison	1
+	Item	LesserExplosion	1
+	Item	AgilityPotion	1
+	Item	RefreshPotion	1
+	Item	StrengthPotion	1
+	Item	Nightsight	1
+	Item	LesserCure	1
 }
 
 Group	CarpentryItems
 {
-	Item	1	Scorp
-	Item	1	Jointingplane
-	Item	1	mouldingplane
-	Item	1	Smoothingplane
-	Item	1	Hammer
-	Item	1	Saw
-	Item	1	Saw2
-	Item	1	Dovetailsaw
-	Item	1	drawknife
-	Item	1	Froe
-	Item	1	inshave
+	Item	Scorp		1
+	Item	Jointingplane	1
+	Item	mouldingplane	1
+	Item	Smoothingplane	1
+	Item	Hammer		1
+	Item	Saw		1
+	Item	Saw2		1
+	Item	Dovetailsaw	1
+	Item	drawknife	1
+	Item	Froe		1
+	Item	inshave		1
 }
 



From austin at berlios.de  Sun Nov 13 09:31:39 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 09:31:39 +0100
Subject: [Poldistro-svn] r946 - trunk/096/pkg/mobiles/newCharacter
Message-ID: <200511130831.jAD8VdOE000449@sheep.berlios.de>

Author: austin
Date: 2005-11-13 09:31:33 +0100 (Sun, 13 Nov 2005)
New Revision: 946

Modified:
   trunk/096/pkg/mobiles/newCharacter/onCreate.src
Log:
First test for giving creation items.

Modified: trunk/096/pkg/mobiles/newCharacter/onCreate.src
===================================================================
--- trunk/096/pkg/mobiles/newCharacter/onCreate.src	2005-11-13 07:42:42 UTC (rev 945)
+++ trunk/096/pkg/mobiles/newCharacter/onCreate.src	2005-11-13 08:31:33 UTC (rev 946)
@@ -27,42 +27,64 @@
 	// Save the chosen skills.
 	NC_SetStartupSkills(who, selected_skills);
 	
-	GenerateItemsForSkill(who, "All");
+	var uniques := array{};
+	GenerateItemsForSkill(who, "All", uniques);
 	foreach skill in ( selected_skills )
-		GenerateItemsForSkill(who, skill);
+		GenerateItemsForSkill(who, skill, uniques);
 		sleepms(2);
 	endforeach
 
 	return 1;
 endprogram
 
-function GenerateItemsForSkill(who, attribute)
+function GenerateItemsForSkill(who, attribute, byref uniques)
 	var cfg_file := ReadConfigFile(":newcharacter:config/startEquip");
 	var cfg_elem := cfg_file[attribute];
 	
-	foreach entry in ( GetConfigStringArray(cfg_elem, "Item") )
-		entry := SplitWords(entry);
-		CreateItemInBackPack(who, entry[2], CInt(entry[1]));
+	CreateItemsInElem(cfg_elem, who.backpack, "All");
+	
+	foreach entry in ( GetConfigStringArray(cfg_elem, "Unique") )
+		entry := ParseItemString(entry);
+		var objtype := GetObjTypeByName(entry.name);
+		if ( !(objtype in uniques) )
+			uniques.Append(objtype);
+			CreateItemInContainer(who.backpack, entry.name, entry.amount);
+		endif
 		sleepms(2);
 	endforeach
 	
 	foreach entry in ( GetConfigStringArray(cfg_elem, "Random") )
 		entry := SplitWords(entry);
-		var amount := CInt(entry[1]);
-		var rand_elem := cfg_file[amount[2]];
-		var item_list := GetConfigStringArray(rand_elem, "Item");
-		for ( amount; amount>0; amount:=amount-1 )
-			var selected := item_list[RandomInt(item_list.Size())+1];
-			selected := SplitWords(2);
-			CreateItemInBackPack(who, selected[2], CInt(selected[1]));
-			sleepms(2);
-		endfor
+		var tmp_elem := cfg_file[entry[1]];
+		var amount := CInt(entry[2]);
+		
+		CreateItemsInElem(tmp_elem, who.backpack, amount);
 		sleepms(2);
 	endforeach
 	
 	return 1;
 endfunction
 
+function CreateItemsInElem(cfg_elem, container, amount)
+	var items := GetConfigStringArray(cfg_elem, "Item");
+	if ( amount == "All" )
+		foreach entry in ( GetConfigStringArray(cfg_elem, "Item") )
+			entry := ParseItemString(entry);
+			CreateItemInContainer(container, entry.name, entry.amount);
+			sleepms(2);
+		endforeach
+	else
+		for ( amount; amount>0; amount:=amount-1 )
+			var entry := items[RandomInt(items.Size())+1];
+			entry := ParseItemString(entry);
+			CreateItemInContainer(container, entry.name, entry.amount);
+			sleepms(2);
+		endfor
+	endif
+	
+	return 1;
+endfunction	
+
 function CreateItemFromElem(who, byref cfg_elem)
 	var item_list := GetConfigStringArray(cfg_elem, "Item");
 	var entry := item_list[RandomInt(item_list.Size())+1];
@@ -75,3 +97,15 @@
 	
 	return item;
 endfunction
+
+function ParseItemString(line)
+	line := SplitWords(line);
+	var name := CStr(line[1]);
+	var amount := RandomDiceRoll(CStr(line[2]));
+	
+	var result := struct;
+	result.+name := name;
+	result.+amount := CInt(amount);
+	
+	return result;
+endfunction



From austin at berlios.de  Sun Nov 13 10:17:32 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 10:17:32 +0100
Subject: [Poldistro-svn] r947 - in trunk/096/scripts: include misc
Message-ID: <200511130917.jAD9HWYE020323@sheep.berlios.de>

Author: austin
Date: 2005-11-13 10:17:23 +0100 (Sun, 13 Nov 2005)
New Revision: 947

Modified:
   trunk/096/scripts/include/time.inc
   trunk/096/scripts/misc/ondelete.src
Log:
Added useful constants to time.inc 
Updated ondelete.src - uses SECONDS_IN_WEEK 

Modified: trunk/096/scripts/include/time.inc
===================================================================
--- trunk/096/scripts/include/time.inc	2005-11-13 08:31:33 UTC (rev 946)
+++ trunk/096/scripts/include/time.inc	2005-11-13 09:17:23 UTC (rev 947)
@@ -6,32 +6,41 @@
  */
 use uo;
 
-include "include/properties";
-include ":logger:exception";
-include ":config:include/config";
+include ":config:config";
 
 enum TIME_UNITS
-    // Base unit: Millisecond
-    MIL_SECOND  := 1000,
-    MIL_MINUTE  := MIL_SECOND * 60,
-    MIL_HOUR    := MIL_MINUTE * 60,
-    MIL_DAY     := MIL_HOUR * 24,
-    MIL_WEEK    := MIL_DAY * 7,
-    MIL_MONTH   := MIL_DAY * 30,
-    MIL_YEAR    := MIL_MONTH * 12,
+	// Base unit: Millisecond
+	MIL_SECOND	:= 1000,
+	MIL_MINUTE	:= MIL_SECOND * 60,
+	MIL_HOUR	:= MIL_MINUTE * 60,
+	MIL_DAY		:= MIL_HOUR * 24,
+	MIL_WEEK	:= MIL_DAY * 7,
+	MIL_MONTH	:= MIL_DAY * 30,
+	MIL_YEAR	:= MIL_MONTH * 12,
 
-    // Base unit: Second
-    SEC_MINUTE  := 60,
-    SEC_HOUR    := SEC_MINUTE * 60,
-    SEC_DAY     := SEC_HOUR * 24,
-    SEC_WEEK    := SEC_DAY * 7,
-    SEC_MONTH   := SEC_DAY * 30,
-    SEC_YEAR    := SEC_DAY * 365,
+	// Base unit: Second
+	SEC_MINUTE  	:= 60,
+	SEC_HOUR	:= SEC_MINUTE * 60,
+	SEC_DAY	 	:= SEC_HOUR * 24,
+	SEC_WEEK	:= SEC_DAY * 7,
+	SEC_MONTH	:= SEC_DAY * 30,
+	SEC_YEAR	:= SEC_DAY * 365,
 
-    // SleepMs value to prevent RunAway
-    NO_RUNAWAY  := 10
+	// SleepMs value to prevent RunAway
+	NO_RUNAWAY  := 10
 endenum
 
+enum TIME_HELPERS
+	SECONDS_IN_MINUTE	:= 60,		// (60)
+	SECONDS_IN_HOUR		:= 3600,	// (SECONDS_IN_MINUTE * 60)
+	SECONDS_IN_DAY		:= 86400,	// (SECONDS_IN_HOUR * 24)
+	SECONDS_IN_WEEK		:= 604800,	// (SECONDS_IN_DAY * 7)
+	MINUTES_IN_HOUR		:= 60,		// (60)
+	MINUTES_IN_DAY		:= 1440,	// (MINUTES_IN_HOUR * 24)
+	MINUTES_IN_WEEK		:= 10080,	// (MINUTES_IN_DAY * 7 )
+	HOURS_IN_DAY		:= 24,		// (24)
+	HOURS_IN_WEEK		:= 168		// (HOURS_IN_DAY * 7)
+endenum
 
 /*
  * GetMonthName(month)
@@ -47,12 +56,12 @@
  *
  */
 function GetMonthName(month)
-    var mon_nam := {"Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"};
+	var mon_nam := {"Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"};
 
-    if(month > 12 || month <= 0)
-        return(Exception("GetMonthName(): Month '" + CStr(month) + "' out of range."));
-    endif
-    return(mon_nam[month]);
+	if( month > 12 || month <= 0 )
+		return error{"errortext":="Month '" + CStr(month) + "' out of range."};
+	endif
+	return(mon_nam[month]);
 endfunction
 
 
@@ -64,22 +73,22 @@
  *
  * Parameters
  * month:   The month to get the length of
- * year:    The year, needed for February
+ * year:	The year, needed for February
  *
  * Return value
  * The length of the month, in days
  *
  */
 function GetMonthLength(month, year := 0)
-    var mon_lens := {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
+	var mon_lens := {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
 
-    if(month > 12 || month <= 0)
-        return(Exception("GetMonthLength(): Month '" + CStr(month) + "' out of range."));
-    endif
-    if(year && IsLeap(year))
-        mon_lens[2] := 29;
-    endif
-    return(mon_lens[month]);
+	if( month > 12 || month <= 0 )
+		return error{"errortext":="Month '" + CStr(month) + "' out of range."};
+	endif
+	if ( year && IsLeap(year) )
+		mon_lens[2] := 29;
+	endif
+	return(mon_lens[month]);
 endfunction
 
 
@@ -90,15 +99,15 @@
  * Returns whether a year is a leap year or not.
  *
  * Parameters
- * year:    The year to examine
+ * year:	The year to examine
  *
  * Return value
- * 0:       The year is not a leap year
- * 1:       The year is a leap year
+ * 0:	   The year is not a leap year
+ * 1:	   The year is a leap year
  *
  */
 function IsLeap(year)
-    return(year % 4 == 0 && (year % 100 != 0 || year % 400 == 0));
+	return(year % 4 == 0 && (year % 100 != 0 || year % 400 == 0));
 endfunction
 
 
@@ -116,7 +125,7 @@
  *
  */
 function GetTime()
-    return(polcore().systime);
+	return(polcore().systime);
 endfunction
 
 
@@ -127,82 +136,82 @@
  * Returns current time as struct.
  *
  * Parameters
- * time:    The UNIX timestamp to use as base for the resulting struct
+ * time:	The UNIX timestamp to use as base for the resulting struct
  *
  * Return value
  * The time as a struct
  *
  */
 function GetTimeStruct(time)
-    var ts, ts_off;
-    var monlen;
-    var timewarp := 0;
+	var ts, ts_off;
+	var monlen;
+	var timewarp := 0;
 
-    time := time + GetTimeZone() * SEC_HOUR;
+	time := time + GetTimeZone() * SEC_HOUR;
 
-    ts_off := GetGlobalProperty(PROP_TIMESTAMP);
+	ts_off := GetGlobalProperty(PROP_TIMESTAMP);
 
-    // UNIX time starts at 01/01/1970 00:00:00
-    ts := struct;
-    ts.+stamp   := time;
-    ts.+year    := 1970;
-    ts.+month   := 1;
-    ts.+day     := 1;
-    ts.+hour    := 0;
-    ts.+minute  := 0;
-    ts.+second  := 0;
+	// UNIX time starts at 01/01/1970 00:00:00
+	ts := struct;
+	ts.+stamp   := time;
+	ts.+year	:= 1970;
+	ts.+month   := 1;
+	ts.+day	 := 1;
+	ts.+hour	:= 0;
+	ts.+minute  := 0;
+	ts.+second  := 0;
 
-    // ts_off is the offset from 1/1/1970 to the last call; this avoids using like 35 iterations everytime this is called
-    if(!ts_off)
-        ts_off := struct;
-        ts_off.+year    := 1970;
-        ts_off.+month   := 1;
-        ts_off.+sum     := 0;
-    elseif(ts_off.sum < time) // Avoid "time warps"
-        ts.year := ts_off.year;
-        ts.month := ts_off.month;
-        time := time - ts_off.sum;
-    else
-        timewarp := 1;
-    endif
+	// ts_off is the offset from 1/1/1970 to the last call; this avoids using like 35 iterations everytime this is called
+	if(!ts_off)
+		ts_off := struct;
+		ts_off.+year	:= 1970;
+		ts_off.+month   := 1;
+		ts_off.+sum	 := 0;
+	elseif(ts_off.sum < time) // Avoid "time warps"
+		ts.year := ts_off.year;
+		ts.month := ts_off.month;
+		time := time - ts_off.sum;
+	else
+		timewarp := 1;
+	endif
 
-    while(time >= SEC_YEAR)
-        time := time - SEC_YEAR;
-        ts_off.sum := ts_off.sum + SEC_YEAR;
-        if(IsLeap(ts.year))
-            time := time - SEC_DAY;
-            ts_off.sum := ts_off.sum + SEC_DAY;
-        endif
-        ts.year := ts.year + 1;
-    endwhile
+	while(time >= SEC_YEAR)
+		time := time - SEC_YEAR;
+		ts_off.sum := ts_off.sum + SEC_YEAR;
+		if(IsLeap(ts.year))
+			time := time - SEC_DAY;
+			ts_off.sum := ts_off.sum + SEC_DAY;
+		endif
+		ts.year := ts.year + 1;
+	endwhile
 
-    monlen := GetMonthLength(ts.month, ts.year) * SEC_DAY;
-    while(time >= monlen)
-        time := time - monlen;
-        ts_off.sum := ts_off.sum + monlen;
-        ts.month := ts.month + 1;
-        monlen := GetMonthLength(ts.month, ts.year) * SEC_DAY;
-    endwhile
+	monlen := GetMonthLength(ts.month, ts.year) * SEC_DAY;
+	while(time >= monlen)
+		time := time - monlen;
+		ts_off.sum := ts_off.sum + monlen;
+		ts.month := ts.month + 1;
+		monlen := GetMonthLength(ts.month, ts.year) * SEC_DAY;
+	endwhile
 
-    ts.day := time / SEC_DAY + 1;
-    time := time % SEC_DAY;
+	ts.day := time / SEC_DAY + 1;
+	time := time % SEC_DAY;
 
-    ts.hour := time / SEC_HOUR;
-    time := time % SEC_HOUR;
+	ts.hour := time / SEC_HOUR;
+	time := time % SEC_HOUR;
 
-    ts.minute := time / SEC_MINUTE;
-    time := time % SEC_MINUTE;
+	ts.minute := time / SEC_MINUTE;
+	time := time % SEC_MINUTE;
 
-    ts.second := time;
+	ts.second := time;
 
-    // Set the new time offset if there was no timewarp so we don't need to iterate in the next call
-    if(!timewarp)
-        ts_off.year := ts.year;
-        ts_off.month := ts.month;
-        SetGlobalProperty(PROP_TIMESTAMP, ts_off);
-    endif
+	// Set the new time offset if there was no timewarp so we don't need to iterate in the next call
+	if(!timewarp)
+		ts_off.year := ts.year;
+		ts_off.month := ts.month;
+		SetGlobalProperty(PROP_TIMESTAMP, ts_off);
+	endif
 
-    return(ts);
+	return(ts);
 endfunction
 
 
@@ -213,34 +222,38 @@
  * Returns a formatted time string.
  *
  * Parameters
- * time:    The time struct to use as base
+ * time:	The time struct to use as base
  * format:  The format string. The following tags will be expanded:
- *          <YY>: Year, <MON>: Month name, <DAY>: Day number, <HH>: Hour, <MM>: Minute, <SS>: Second
+ *		  <YY>: Year, <MON>: Month name, <DAY>: Day number, <HH>: Hour, <MM>: Minute, <SS>: Second
  *
  * Return value
  * The expanded format string
  *
  */
 function FormatTime(byref ts, format)
-    format["<YY>"] := CStr(ts.year);
-    format["<MON>"] := GetMonthName(ts.month);
-    format["<DAY>"] := CStr(ts.day);
-    if(ts.hour > 9)
-        format["<HH>"] := CStr(ts.hour);
-    else
-        format["<HH>"] := "0" + CStr(ts.hour);
-    endif
-    if(ts.minute > 9)
-        format["<MM>"] := CStr(ts.minute);
-    else
-        format["<MM>"] := "0" + CStr(ts.minute);
-    endif
-    if(ts.second > 9)
-        format["<SS>"] := CStr(ts.second);
-    else
-        format["<SS>"] := "0" + CStr(ts.second);
-    endif
-    return format;
+	format["<YY>"] := CStr(ts.year);
+	format["<MON>"] := GetMonthName(ts.month);
+	format["<DAY>"] := CStr(ts.day);
+	
+	if(ts.hour > 9)
+		format["<HH>"] := CStr(ts.hour);
+	else
+		format["<HH>"] := "0" + CStr(ts.hour);
+	endif
+	
+	if(ts.minute > 9)
+		format["<MM>"] := CStr(ts.minute);
+	else
+		format["<MM>"] := "0" + CStr(ts.minute);
+	endif
+	
+	if(ts.second > 9)
+		format["<SS>"] := CStr(ts.second);
+	else
+		format["<SS>"] := "0" + CStr(ts.second);
+	endif
+	
+	return format;
 endfunction
 
 
@@ -251,14 +264,14 @@
  * Adds a timestamp to a string.
  *
  * Parameters
- * what:    The string to be timestamped
+ * what:	The string to be timestamped
  *
  * Return value
  * The string with an added timestamp at the beginning
  *
  */
 function AddTimeStamp(what)
-    var ts := GetTimeStruct(GetTime());
+	var ts := GetTimeStruct(GetTime());
 
-    return(FormatTime(ts, "[<MON> <DAY> <YY> <HH>:<MM>:<SS>]: ") + what);
+	return(FormatTime(ts, "[<MON> <DAY> <YY> <HH>:<MM>:<SS>]: ") + what);
 endfunction

Modified: trunk/096/scripts/misc/ondelete.src
===================================================================
--- trunk/096/scripts/misc/ondelete.src	2005-11-13 08:31:33 UTC (rev 946)
+++ trunk/096/scripts/misc/ondelete.src	2005-11-13 09:17:23 UTC (rev 947)
@@ -5,20 +5,19 @@
  *
  */
 use uo;
+use os;
 
-include "include/OLD/startEqp";
+include "include/time";
 
-
 program core_onDelete(who)
-	var created := GetObjProperty(who, "OnCreate");
-	if (!created)
-		created := 0;
-	endif
-	if ((ReadGameClock() - created) >= 604800)
-		print("deleting char");
+	var create_time := who.createdat;
+	var age := polcore().systime - create_time;
+	
+	if ( who.cmdlevel )
 		return 1;
+	elseif ( age >= SECONDS_IN_WEEK )
+		SysLog("Account ["+who.acctname+"] deleting character "+who.name+" ("+who.serial+")");
 	else
-		print("too young");
 		return 0;
 	endif
 endprogram



From austin at berlios.de  Sun Nov 13 10:34:07 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 10:34:07 +0100
Subject: [Poldistro-svn] r948 - trunk/096/scripts/misc
Message-ID: <200511130934.jAD9Y7ct024209@sheep.berlios.de>

Author: austin
Date: 2005-11-13 10:34:01 +0100 (Sun, 13 Nov 2005)
New Revision: 948

Removed:
   trunk/096/scripts/misc/demod.src
   trunk/096/scripts/misc/namechecker.src
Modified:
   trunk/096/scripts/misc/logoff.src
   trunk/096/scripts/misc/logofftest.src
   trunk/096/scripts/misc/ondelete.src
   trunk/096/scripts/misc/reconnect.src
Log:
Demod - no longer used, to be replaced by timedScripts package.
namechecker - Wasnt being used, deleted.

LogOff - Removed contents (most is now packaged or obsolete)
LogOffTest - Optimized, removed obsolete data. Left pseudo code for new packages.
OnDelete - Set it to return 1 if character is old enough (oops!)
Reconnect - Removed contents (most is now packaged or was obsolete)

Deleted: trunk/096/scripts/misc/demod.src
===================================================================
--- trunk/096/scripts/misc/demod.src	2005-11-13 09:17:23 UTC (rev 947)
+++ trunk/096/scripts/misc/demod.src	2005-11-13 09:34:01 UTC (rev 948)
@@ -1,30 +0,0 @@
-use uo;
-use os;
-include ":attributes:attributes";
-
-program demod(parms)
-  var mod := lower(parms[1]);
-  var who := parms[2];
-  var amt := parms[3];
-  var duration := parms[4];
-  var serial := parms[5];
-  var prp := parms[6];
-  sleep(duration);
-  undo_mod(who, mod, amt, serial);
-  EraseObjProperty(who, prp);
-endprogram
-
-function undo_mod(who, mod, amt, serial)
-  if((!who) && (who.acctname))
-    who := SystemFindObjectBySerial(serial, SYSFIND_SEARCH_OFFLINE_MOBILES);
-  endif
-  case(mod)
-    "str": 	AP_SetStatMod(who, STRENGTH, AP_GetStatMod(who, STRENGTH) - amt);
-    "dex": 	AP_SetStatMod(who, DEXTERITY, AP_GetStatMod(who, DEXTERITY) - amt);
-    "int": 	AP_SetStatMod(who, INTELLIGENCE, AP_GetStatMod(who, DEXTERITY) - amt);
-    "ar" : 	who.ar_mod           := who.ar_mod - amt;
-    "p"  : 	who.frozen           := 0;
-            who.paralyzed        := 0;
-  endcase
-  return 1;
-endfunction
\ No newline at end of file

Modified: trunk/096/scripts/misc/logoff.src
===================================================================
--- trunk/096/scripts/misc/logoff.src	2005-11-13 09:17:23 UTC (rev 947)
+++ trunk/096/scripts/misc/logoff.src	2005-11-13 09:34:01 UTC (rev 948)
@@ -5,78 +5,7 @@
  * Useful for stuff like cleaning up summoned NPCs, etc.
  *
  */
-use uo;
-use util;
-use math;
-use os;
 
-include "include/OLD/eventID";
-include ":attributes:attributes";
-
-const EVID_UNEQUIP   := 0x123456;
-const EVID_DISCHARGE := 0x123457;
-
-
-program core_logoff(who)
-	var acct := FindAccount(who.acctname);
-	acct.setprop("LastLogin", readGameclock());
-	var sessiontime := ReadGameClock() - GetObjProperty(who,"logontime");
-	var timer := GetObjProperty(who,"onlinetimer");
-	if (!timer)
-		timer := 0;
-	endif
-	SetObjProperty(who,"onlinetimer",timer+sessiontime);
-	EraseObjProperty(who,"LoggedIn");
-	RemoveMods(who);
-	var mount := GetEquipmentByLayer(who, 25 );
-	if (mount)
-		if (GetObjProperty(mount, "summoned"))
-			var ser := Cint(GetObjProperty(mount, "serial"));
-			var critter := SystemFindObjectBySerial(ser);
-			if (critter)
-				ApplyRawDamage(critter, 2000);
-			endif
-			DestroyItem(mount);
-		else
-			var animal := SystemFindObjectBySerial(CInt(GetObjProperty(mount,"serial")));
-			SetObjProperty(animal,"onhold", 1);
-		endif
-	endif
-	staffnotify(who);
-
-	return;
+program LogOff(who)
+	return 1;
 endprogram
-
-
-function staffnotify(who)
-	var pid := 0;
-	while (!pid)
-		sleepms(50);
-		pid := GetGlobalProperty("#stafflist");
-	endwhile
-	pid := getprocess(pid);
-	if (!pid)
-		return;
-	endif
-	var k := struct;
-	k.+player := who;
-	k.+type  := EVID_PLAYER_LOGOFF;
-	pid.sendevent(k);
-
-	return;
-endfunction
-
-
-function RemoveMods(who)
-	foreach item in ListEquippedItems(who)
-		var proc := GetProcess(Cint(GetObjProperty(item, "Pid")));
-		if (proc)
-			var ev := {};
-			ev.+type := EVID_UNEQUIP;
-			proc.sendevent(ev);
-		endif
-	endforeach
-	EraseObjProperty(who, "EquipTimers");
-
-	return;
-endfunction

Modified: trunk/096/scripts/misc/logofftest.src
===================================================================
--- trunk/096/scripts/misc/logofftest.src	2005-11-13 09:17:23 UTC (rev 947)
+++ trunk/096/scripts/misc/logofftest.src	2005-11-13 09:34:01 UTC (rev 948)
@@ -7,71 +7,30 @@
  */
 use uo;
 
-include "include/OLD/eventID";
-include "include/OLD/innCheck";
-
+include "include/time";
 include ":timedscripts:timedScripts";
 
 program core_logoffTest(who)
+	// Send event to the 'timed scripts' package to run log off scripts.
 	TS_LogOff(who);
-	
-	if ((who.cmdlevel > 1) || (GetObjProperty(who,"justbanned")))
+		
+	if ( (who.cmdlevel > 1) || (GetObjProperty(who,"Delete")) )
+		// Let staff or characters being deleted/banned logout immediately.
 		return 0;
 	endif
-	EraseObjProperty(who, "#Online");
-	var safelogoff := 0;
-	if (CInt(GetObjProperty(who, "#camped"))== 1)
-		EraseObjProperty(who, "#camped");
-		safelogoff := 1;
-	elseif (Inncheck(who))
-		safelogoff := 1;
-	endif
-
-	if (!safelogoff)
-		if (who.multi.serial)
-			var house := who.multi;
-			if (who.acctname == (GetObjProperty(house, "owneracct")))
-				safelogoff := 1;
-			else
-				foreach player in (GetObjProperty(house, "friendlist"))
-					if (who.serial == player)
-						safelogoff := 1;
-					endif
-				endforeach
-				foreach player in (GetObjProperty(house,"coownlist"))
-					if (who.serial == player)
-						safelogoff := 1;
-					endif
-				endforeach
-			endif
-		endif
-	endif
-
-	if (!safelogoff)
-		staffnotify(who);
-		return 300;  // wait 5 minutes
-	elseif (safelogoff == 1)
-		return 0;   // ok to log off
-	else
-		return safelogoff;
-	endif
+	
+	var logout_delay := SECONDS_IN_MINUTE * 5;
+	
+	// Check if player is camping
+	// if ( IsCamping(who) )
+	
+	// Check if player is in an inn
+	// elseif ( IsInInn(who) )
+		
+	// Check if player is in a house
+	// Then check if player is the owner or  friend of the owner.
+	// elseif ( IsInHouse(who) )
+	
+	
+	return logout_delay;
 endprogram
-
-
-function staffnotify(who)
-	var pid := 0;
-	while (!pid)
-		sleepms(50);
-		pid := GetGlobalProperty("#stafflist");
-	endwhile
-	pid := getprocess(pid);
-	if (!pid)
-		return;
-	endif
-	var k := struct;
-	k.+player := who;
-	k.+type  := EVID_PLAYER_DELAY;
-	pid.sendevent(k);
-
-	return;
-endfunction

Deleted: trunk/096/scripts/misc/namechecker.src
===================================================================
--- trunk/096/scripts/misc/namechecker.src	2005-11-13 09:17:23 UTC (rev 947)
+++ trunk/096/scripts/misc/namechecker.src	2005-11-13 09:34:01 UTC (rev 948)
@@ -1,21 +0,0 @@
-use uo;
-use cfgfile;
-
-program checkname(who)
-  var hisname := lower(who.name);
-  var cfg := ReadConfigFile("badnames");
-  var elem := FindConfigElem(cfg, hisname);
-  if(!elem)
-    return;
-  endif
-  who.name := "invalid name";
-  while (who.name == "invalid name")
-    var newname := SendTextEntryGump( who, "You have selected a name that is not valid on this shard.", TE_CANCEL_DISABLE, TE_STYLE_NORMAL, 20, "Please select a new name");
-    var elem := FindConfigElem(cfg, lower(newname));
-    if(!elem)
-      SendSysMessage(who, "Good choice, " + newname + "!");
-      who.name := newname;
-      return;
-    endif
-  endwhile
-endprogram
\ No newline at end of file

Modified: trunk/096/scripts/misc/ondelete.src
===================================================================
--- trunk/096/scripts/misc/ondelete.src	2005-11-13 09:17:23 UTC (rev 947)
+++ trunk/096/scripts/misc/ondelete.src	2005-11-13 09:34:01 UTC (rev 948)
@@ -17,6 +17,7 @@
 		return 1;
 	elseif ( age >= SECONDS_IN_WEEK )
 		SysLog("Account ["+who.acctname+"] deleting character "+who.name+" ("+who.serial+")");
+		return 1;
 	else
 		return 0;
 	endif

Modified: trunk/096/scripts/misc/reconnect.src
===================================================================
--- trunk/096/scripts/misc/reconnect.src	2005-11-13 09:17:23 UTC (rev 947)
+++ trunk/096/scripts/misc/reconnect.src	2005-11-13 09:34:01 UTC (rev 948)
@@ -11,22 +11,5 @@
 
 
 program core_reconnect(who)
-	var mount := GetEquipmentByLayer(who, LAYER_MOUNT);
-	if (mount)
-		var animal := SystemFindObjectBySerial(CInt(GetObjProperty(mount,"serial")));
-		EraseObjProperty(animal,"onhold");
-	endif
-	run_script_to_completion( ":motd:textcmd/player/motd", who );
-	var ppl := EnumerateOnlineCharacters();
-	if (GetObjProperty(who, "StealthLogin") )
-		return;
-	endif
-	foreach staff in ppl
-		if ((staff.cmdlevel > 0) && (CInt(GetObjProperty(staff, "LogNotify")) == 1))
-			SendSysMessage(staff, CStr(who.name) + " (Account name: "
-			+ CStr(who.acctname) + ") has reconnected.  IP: " + CStr(who.ip));
-		endif
-	endforeach
-
-	return;
+	return 1;
 endprogram



From austin at berlios.de  Sun Nov 13 10:37:04 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 10:37:04 +0100
Subject: [Poldistro-svn] r949 - trunk/096/scripts
Message-ID: <200511130937.jAD9b4F4025613@sheep.berlios.de>

Author: austin
Date: 2005-11-13 10:37:02 +0100 (Sun, 13 Nov 2005)
New Revision: 949

Removed:
   trunk/096/scripts/control/
Log:
Scripts in scripts/control are obsolete and no longer used.



From austin at berlios.de  Sun Nov 13 10:55:35 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 10:55:35 +0100
Subject: [Poldistro-svn] r950 - in trunk/096/pkg/items: . keys keys/config keys/key keys/keyring
Message-ID: <200511130955.jAD9tZOZ004797@sheep.berlios.de>

Author: austin
Date: 2005-11-13 10:55:23 +0100 (Sun, 13 Nov 2005)
New Revision: 950

Added:
   trunk/096/pkg/items/keys/
   trunk/096/pkg/items/keys/commands/
   trunk/096/pkg/items/keys/config/
   trunk/096/pkg/items/keys/config/icp.cfg
   trunk/096/pkg/items/keys/include/
   trunk/096/pkg/items/keys/itemdesc.cfg
   trunk/096/pkg/items/keys/key/
   trunk/096/pkg/items/keys/key/methods.src
   trunk/096/pkg/items/keys/key/use.src
   trunk/096/pkg/items/keys/keyring/
   trunk/096/pkg/items/keys/keyring/onInsert.src
   trunk/096/pkg/items/keys/keyring/onRemove.src
   trunk/096/pkg/items/keys/keyring/use.src
   trunk/096/pkg/items/keys/pkg.cfg
Log:


Added: trunk/096/pkg/items/keys/config/icp.cfg
===================================================================
--- trunk/096/pkg/items/keys/config/icp.cfg	2005-11-13 09:37:02 UTC (rev 949)
+++ trunk/096/pkg/items/keys/config/icp.cfg	2005-11-13 09:55:23 UTC (rev 950)
@@ -0,0 +1,19 @@
+# $Id$
+#
+#
+ICP Register
+{
+	Name		Keys
+	Version		1.0
+	Description	Use scripts for keys and keyring stuff.
+
+	Creator		Austin
+	C_Email		AustinHeilman at gmail.com
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}

Added: trunk/096/pkg/items/keys/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/keys/itemdesc.cfg	2005-11-13 09:37:02 UTC (rev 949)
+++ trunk/096/pkg/items/keys/itemdesc.cfg	2005-11-13 09:55:23 UTC (rev 950)
@@ -0,0 +1,40 @@
+Item 0x100E
+{
+	Name		Key1
+	Desc		key
+	
+	MethodScript	key/methods
+	Script		key/use
+}
+Item 0x100F
+{
+	Name		Key2
+	Desc		key
+	
+	MethodScript	key/methods
+	Script		key/use
+}
+Item 0x1010
+{
+	Name		Key3
+	Desc		key
+	
+	MethodScript	key/methods
+	Script		key/use
+}
+Item 0x1012
+{
+	Name		Key4
+	Desc		key
+	
+	MethodScript	key/methods
+	Script		key/use
+}
+Item 0x1013
+{
+	Name		Key5
+	Desc		key
+	
+	MethodScript	key/methods
+	Script		key/use
+}
\ No newline at end of file

Added: trunk/096/pkg/items/keys/key/methods.src
===================================================================
--- trunk/096/pkg/items/keys/key/methods.src	2005-11-13 09:37:02 UTC (rev 949)
+++ trunk/096/pkg/items/keys/key/methods.src	2005-11-13 09:55:23 UTC (rev 950)
@@ -0,0 +1,6 @@
+/*
+ * $Id$
+ *
+ */
+ 
+use uo;

Added: trunk/096/pkg/items/keys/key/use.src
===================================================================
--- trunk/096/pkg/items/keys/key/use.src	2005-11-13 09:37:02 UTC (rev 949)
+++ trunk/096/pkg/items/keys/key/use.src	2005-11-13 09:55:23 UTC (rev 950)
@@ -0,0 +1,6 @@
+/*
+ * $Id$
+ *
+ */
+ 
+use uo;

Added: trunk/096/pkg/items/keys/keyring/onInsert.src
===================================================================
--- trunk/096/pkg/items/keys/keyring/onInsert.src	2005-11-13 09:37:02 UTC (rev 949)
+++ trunk/096/pkg/items/keys/keyring/onInsert.src	2005-11-13 09:55:23 UTC (rev 950)
@@ -0,0 +1,6 @@
+/*
+ * $Id$
+ *
+ */
+ 
+use uo;

Added: trunk/096/pkg/items/keys/keyring/onRemove.src
===================================================================
--- trunk/096/pkg/items/keys/keyring/onRemove.src	2005-11-13 09:37:02 UTC (rev 949)
+++ trunk/096/pkg/items/keys/keyring/onRemove.src	2005-11-13 09:55:23 UTC (rev 950)
@@ -0,0 +1,6 @@
+/*
+ * $Id$
+ *
+ */
+ 
+use uo;

Added: trunk/096/pkg/items/keys/keyring/use.src
===================================================================
--- trunk/096/pkg/items/keys/keyring/use.src	2005-11-13 09:37:02 UTC (rev 949)
+++ trunk/096/pkg/items/keys/keyring/use.src	2005-11-13 09:55:23 UTC (rev 950)
@@ -0,0 +1,6 @@
+/*
+ * $Id$
+ *
+ */
+ 
+use uo;

Added: trunk/096/pkg/items/keys/pkg.cfg
===================================================================
--- trunk/096/pkg/items/keys/pkg.cfg	2005-11-13 09:37:02 UTC (rev 949)
+++ trunk/096/pkg/items/keys/pkg.cfg	2005-11-13 09:55:23 UTC (rev 950)
@@ -0,0 +1,17 @@
+# $Id$
+#
+#
+Enabled		1
+Name		keys
+
+Version		1.0
+
+CoreRequired	96
+
+Creator		Austin Heilman
+Email		AustinHeilman at gmail.com
+Maintainer	Distro Team
+Email		distro at polserver.com
+
+#Requires	NONE
+#Conflicts	NONE



From austin at berlios.de  Sun Nov 13 11:04:46 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 11:04:46 +0100
Subject: [Poldistro-svn] r951 - in trunk/096: config pkg/items/keys
Message-ID: <200511131004.jADA4kMD020933@sheep.berlios.de>

Author: austin
Date: 2005-11-13 11:04:43 +0100 (Sun, 13 Nov 2005)
New Revision: 951

Modified:
   trunk/096/config/itemdesc.cfg
   trunk/096/pkg/items/keys/itemdesc.cfg
Log:
Moved key and keyring entries to key package.

Modified: trunk/096/config/itemdesc.cfg
===================================================================
--- trunk/096/config/itemdesc.cfg	2005-11-13 09:55:23 UTC (rev 950)
+++ trunk/096/config/itemdesc.cfg	2005-11-13 10:04:43 UTC (rev 951)
@@ -452,58 +452,6 @@
 	Movable			0
 }
 
-Item 0x100e
-{
-	Name			copperkey
-	Desc			copper key
-	Script			key
-	VendorSellsFor		9
-	VendorBuysFor		4
-}
-
-Item 0x100f
-{
-	Name			goldkey
-	Desc			gold key
-	Script			key
-	VendorSellsFor		9
-	VendorBuysFor		4
-}
-
-Item 0x1010
-{
-	Name			ironkey
-	Desc			iron key
-	Script			key
-	VendorSellsFor		9
-	VendorBuysFor		4
-}
-
-Item 0x1012
-{
-	Name			magickey
-	Desc			magic key
-	Script			key
-}
-
-Item 0x1013
-{
-	Name			rustykey
-	Desc			rusty key
-	Script			key
-	VendorSellsFor		9
-	VendorBuysFor		4
-}
-
-Item 0x1011
-{
-	Name			keyring
-	Desc			key ring
-	Script			key
-	VendorSellsFor		12
-	VendorBuysFor		4
-}
-
 Item 0x14fb
 {
 	Name			lockpick

Modified: trunk/096/pkg/items/keys/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/keys/itemdesc.cfg	2005-11-13 09:55:23 UTC (rev 950)
+++ trunk/096/pkg/items/keys/itemdesc.cfg	2005-11-13 10:04:43 UTC (rev 951)
@@ -1,40 +1,76 @@
+Container 0x1011
+{
+	Name			KeyRing
+	Desc			key ring
+	
+	Gump			0x40
+	MinX			20
+	MaxX			60
+	MinY			20
+	MaxY			60
+	MaxItems		5
+	MaxWeight		0
+	Lockable		0
+	MaxItems		5
+	
+	VendorSellsFor		12
+	VendorBuysFor		4
+}
+
 Item 0x100E
 {
-	Name		Key1
-	Desc		key
+	Name			CopperKey
+	Name			Key1
+	Desc			copper key
 	
-	MethodScript	key/methods
-	Script		key/use
+	VendorSellsFor		9
+	VendorBuysFor		4
+	
+	MethodScript		key/methods
+	Script			key/use
 }
 Item 0x100F
 {
-	Name		Key2
-	Desc		key
+	Name			GoldKey
+	Name			Key2
+	Desc			gold key
 	
-	MethodScript	key/methods
-	Script		key/use
+	VendorSellsFor		9
+	VendorBuysFor		4
+	
+	MethodScript		key/methods
+	Script			key/use
 }
 Item 0x1010
 {
-	Name		Key3
-	Desc		key
+	Name			IronKey
+	Name			Key3
+	Desc			iron key
 	
-	MethodScript	key/methods
-	Script		key/use
+	VendorSellsFor		9
+	VendorBuysFor		4
+	
+	MethodScript		key/methods
+	Script			key/use
 }
 Item 0x1012
 {
-	Name		Key4
-	Desc		key
+	Name			MagicKey
+	Name			Key4
+	Desc			magic key
 	
-	MethodScript	key/methods
-	Script		key/use
+	MethodScript		key/methods
+	Script			key/use
 }
 Item 0x1013
 {
-	Name		Key5
-	Desc		key
+	Name			RustyKey
+	Name			Key5
+	Desc			rusty key
 	
-	MethodScript	key/methods
-	Script		key/use
+	VendorSellsFor		9
+	VendorBuysFor		4
+	
+	MethodScript		key/methods
+	Script			key/use
 }
\ No newline at end of file



From austin at berlios.de  Sun Nov 13 11:32:19 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 11:32:19 +0100
Subject: [Poldistro-svn] r952 - in trunk/096/pkg/items/keys: include key keyring
Message-ID: <200511131032.jADAWJQJ026648@sheep.berlios.de>

Author: austin
Date: 2005-11-13 11:32:16 +0100 (Sun, 13 Nov 2005)
New Revision: 952

Added:
   trunk/096/pkg/items/keys/include/key.inc
Modified:
   trunk/096/pkg/items/keys/key/methods.src
   trunk/096/pkg/items/keys/key/use.src
   trunk/096/pkg/items/keys/keyring/use.src
Log:
mmm updates

Added: trunk/096/pkg/items/keys/include/key.inc
===================================================================
--- trunk/096/pkg/items/keys/include/key.inc	2005-11-13 10:04:43 UTC (rev 951)
+++ trunk/096/pkg/items/keys/include/key.inc	2005-11-13 10:32:16 UTC (rev 952)
@@ -0,0 +1,56 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+
+include ":itemutils:itemdesc";
+
+/*
+ * KP_ToggleLock(object)
+ *
+ * Purpose
+ * Toggles the locked member of an object.
+ *
+ * Parameters
+ * object:	Container or door to toggle the locked status on.
+ * mobile:	Optional - Mobile to show the locked status to.
+ *
+ * Return value
+ * Returns 1
+ *
+ */
+function KP_ToggleLock(object, mobile:=0)
+	if ( object.locked )
+		PrintTextAbovePrivate(object, "*unlocked*", mobile);
+		object.locked := 0;
+	else
+		PrintTextAbovePrivate(object, "*locked*", mobile);
+		object.locked := 1;
+	endif
+	
+	return 1;
+endfunction
+
+/*
+ * KP_IsLockable(object)
+ * 
+ * Purpose
+ * Determines if an item is lockable or not.
+ *
+ * Parameters
+ * Object:	Object to check.
+ *
+ * Return value
+ * Returns 1 if the object is lockable
+ * Returns 0 if the object is not lockable.
+ *
+ */
+function KP_IsLockable(object)
+	if ( object.IsA(POLCLASS_ITEM) )
+		object := object.objtype;
+	endif
+	
+	return GetItemDescInfo(object).Lockable;
+endfunction
\ No newline at end of file

Modified: trunk/096/pkg/items/keys/key/methods.src
===================================================================
--- trunk/096/pkg/items/keys/key/methods.src	2005-11-13 10:04:43 UTC (rev 951)
+++ trunk/096/pkg/items/keys/key/methods.src	2005-11-13 10:32:16 UTC (rev 952)
@@ -4,3 +4,47 @@
  */
  
 use uo;
+
+program Install()
+	return 1;
+endprogram
+
+exported function IsKey(key)
+	key := key; // Avoid compiler warning
+	return 1;
+endfunction
+
+exported function GetLockId(key)
+	return GetObjProperty(key, "LockId");
+endfunction
+
+exported function SetLockId(key, lock_id)
+	SetObjProperty(key, "LockId", CStr(lock_id));
+endfunction
+
+exported function KeyMatchesLock(key, lock)
+	if ( lock == error )
+		return 0;
+	endif
+	
+	var lock_id := error;
+	if ( lock.GetLockId() )
+		lock_id := lock.GetLockId();
+	elseif ( TypeOf(lock) == "String" )
+		lock_id := lock;
+	else
+		lock_id := GetObjProperty(lock, "LockId");
+		if ( lock_id == error )
+			return 0;
+		endif
+	endif
+	
+	var key_id := GetLockId(key);
+	if ( key_id == error )
+		return 0;
+	elseif ( key_id != lock_id )
+		return 0;
+	else
+		return 1;
+	endif
+endfunction

Modified: trunk/096/pkg/items/keys/key/use.src
===================================================================
--- trunk/096/pkg/items/keys/key/use.src	2005-11-13 10:04:43 UTC (rev 951)
+++ trunk/096/pkg/items/keys/key/use.src	2005-11-13 10:32:16 UTC (rev 952)
@@ -4,3 +4,26 @@
  */
  
 use uo;
+
+include ":keys:key";
+
+program UseKey(who, key)
+	SendSysMessage(who, "What do you want to use this on?");
+	var targ := Target(who);
+	
+	if ( !targ.IsA(POLCLASS_ITEM) )
+		SendSysMessage(who, "Cancelled.");
+		return 0;
+	elseif ( !KP_IsLockable(targ) )
+		SendSysMessage(who, "That is not lockable.");
+		return 0;
+	endif
+	
+	if ( key.KeyMatchesLock(targ) )
+		KP_ToggleLock(targ, who);
+	else
+		SendSysMessage(who, "This key does not match that lock.");
+	endif
+	
+	return 1;
+endprogram

Modified: trunk/096/pkg/items/keys/keyring/use.src
===================================================================
--- trunk/096/pkg/items/keys/keyring/use.src	2005-11-13 10:04:43 UTC (rev 951)
+++ trunk/096/pkg/items/keys/keyring/use.src	2005-11-13 10:32:16 UTC (rev 952)
@@ -4,3 +4,36 @@
  */
  
 use uo;
+use os;
+
+include ":keys:key";
+
+program UseKeyRing(who, keyring)
+	SendSysMessage(who, "What do you want to use that on?");
+	
+	var targ := Target(who);
+	if ( !targ.IsA(POLCLASS_ITEM) )
+		SendSysMessage(who, "Cancelled.");
+		return 0;
+	elseif ( !KP_IsLockable(targ) )
+		SendSysMessage(who, "That is not lockable.");
+		return 0;
+	endif
+	
+	var matched := 0;
+	foreach key in ( EnumerateItemsInContainer(keyring) )
+		if ( key.KeyMatchesLock(targ) )
+			KP_ToggleLock(targ, who);
+			matched := 1;
+			break;
+		endif
+		sleepms(2);
+	endforeach
+	
+	if ( !matched )
+		SendSysMessage(who, "You do not have a key for that lock.");
+		return 0;
+	else
+		return 1;
+	endif
+endprogram
\ No newline at end of file



From austin at berlios.de  Sun Nov 13 11:43:23 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 11:43:23 +0100
Subject: [Poldistro-svn] r953 - in trunk/096/pkg/items/keys: . key keyring
Message-ID: <200511131043.jADAhNC2029787@sheep.berlios.de>

Author: austin
Date: 2005-11-13 11:43:22 +0100 (Sun, 13 Nov 2005)
New Revision: 953

Added:
   trunk/096/pkg/items/keys/keyring/canInsert.src
Removed:
   trunk/096/pkg/items/keys/keyring/onInsert.src
Modified:
   trunk/096/pkg/items/keys/itemdesc.cfg
   trunk/096/pkg/items/keys/key/use.src
   trunk/096/pkg/items/keys/keyring/onRemove.src
   trunk/096/pkg/items/keys/keyring/use.src
Log:
Added scripts for adding/removing keys on keyrings.
Set keys so if used on themselves they can be renamed.
If a keyring is used on its self it will put the keys in the player's pack.


Modified: trunk/096/pkg/items/keys/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/keys/itemdesc.cfg	2005-11-13 10:32:16 UTC (rev 952)
+++ trunk/096/pkg/items/keys/itemdesc.cfg	2005-11-13 10:43:22 UTC (rev 953)
@@ -15,6 +15,10 @@
 	
 	VendorSellsFor		12
 	VendorBuysFor		4
+	
+	CanInsertScript		keyring/canInsert
+	OnRemoveScript		keyring/onRemove
+	Script			keyring/use
 }
 
 Item 0x100E

Modified: trunk/096/pkg/items/keys/key/use.src
===================================================================
--- trunk/096/pkg/items/keys/key/use.src	2005-11-13 10:32:16 UTC (rev 952)
+++ trunk/096/pkg/items/keys/key/use.src	2005-11-13 10:43:22 UTC (rev 953)
@@ -6,6 +6,7 @@
 use uo;
 
 include ":keys:key";
+include ":gumps:requestgump";
 
 program UseKey(who, key)
 	SendSysMessage(who, "What do you want to use this on?");
@@ -14,6 +15,9 @@
 	if ( !targ.IsA(POLCLASS_ITEM) )
 		SendSysMessage(who, "Cancelled.");
 		return 0;
+	elseif ( targ == key )
+		RenameKey(who, key);
+		return 1;
 	elseif ( !KP_IsLockable(targ) )
 		SendSysMessage(who, "That is not lockable.");
 		return 0;
@@ -27,3 +31,14 @@
 	
 	return 1;
 endprogram
+
+function RenameKey(who, key)
+	var new_name := RequestGump(who, "Enter a name for this key", "", key.desc);
+	
+	if ( new_name )
+		SetName(key, new_name);
+	else
+		SendSysMessage(who, "Cancelled.");
+		return 0;
+	endif
+endfunction

Copied: trunk/096/pkg/items/keys/keyring/canInsert.src (from rev 950, trunk/096/pkg/items/keys/keyring/onInsert.src)
===================================================================
--- trunk/096/pkg/items/keys/keyring/onInsert.src	2005-11-13 09:55:23 UTC (rev 950)
+++ trunk/096/pkg/items/keys/keyring/canInsert.src	2005-11-13 10:43:22 UTC (rev 953)
@@ -0,0 +1,28 @@
+/*
+ * $Id$
+ *
+ */
+ 
+use uo;
+
+program OnInsert(who, keyring, movetype, INSERT_INCREASE_STACK, adding_item, existing_stack, amt_to_add)
+	if ( !adding_item.IsKey() )
+		SendSysMessage(who, "That is not a key.");
+		return 0;
+	endif
+	
+	SendSysMessage(who, "You put the key on the ring.");
+	
+	var numkeys := EnumerateItemsInContainer(keyring).Size();
+	if ( numkeys == 0 )
+		keyring.graphic := 4113;	
+	elseif ( numkeys == 1 )
+		keyring.graphic := 5993;
+	elseif ( numkeys >= 2 && numkeys <= 4 )
+		keyring.graphic := 5994;
+	elseif ( numkeys >= 5 )
+		keyring.graphic := 5995;
+	endif
+	
+	return 1;
+endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/items/keys/keyring/onInsert.src
===================================================================
--- trunk/096/pkg/items/keys/keyring/onInsert.src	2005-11-13 10:32:16 UTC (rev 952)
+++ trunk/096/pkg/items/keys/keyring/onInsert.src	2005-11-13 10:43:22 UTC (rev 953)
@@ -1,6 +0,0 @@
-/*
- * $Id$
- *
- */
- 
-use uo;

Modified: trunk/096/pkg/items/keys/keyring/onRemove.src
===================================================================
--- trunk/096/pkg/items/keys/keyring/onRemove.src	2005-11-13 10:32:16 UTC (rev 952)
+++ trunk/096/pkg/items/keys/keyring/onRemove.src	2005-11-13 10:43:22 UTC (rev 953)
@@ -4,3 +4,18 @@
  */
  
 use uo;
+
+program OnRemove(who, keyring, item)
+	var numkeys := EnumerateItemsInContainer(keyring).Size();
+	if ( numkeys == 0 )
+		keyring.graphic := 4113;	
+	elseif ( numkeys == 1 )
+		keyring.graphic := 5993;
+	elseif ( numkeys >= 2 && numkeys <= 4 )
+		keyring.graphic := 5994;
+	elseif ( numkeys >= 5 )
+		keyring.graphic := 5995;
+	endif
+	
+	return 1;
+endprogram
\ No newline at end of file

Modified: trunk/096/pkg/items/keys/keyring/use.src
===================================================================
--- trunk/096/pkg/items/keys/keyring/use.src	2005-11-13 10:32:16 UTC (rev 952)
+++ trunk/096/pkg/items/keys/keyring/use.src	2005-11-13 10:43:22 UTC (rev 953)
@@ -15,6 +15,9 @@
 	if ( !targ.IsA(POLCLASS_ITEM) )
 		SendSysMessage(who, "Cancelled.");
 		return 0;
+	elseif ( targ == keyring )
+		RemoveKeys(who, keyring);
+		return 1;
 	elseif ( !KP_IsLockable(targ) )
 		SendSysMessage(who, "That is not lockable.");
 		return 0;
@@ -36,4 +39,19 @@
 	else
 		return 1;
 	endif
-endprogram
\ No newline at end of file
+endprogram
+
+function RemoveKeys(who, keyring)
+	var contents := EnumerateItemsInContainer(who.backpack);
+	if ( !(keyring in contents) )
+		SendSysMessage(who, "That keyring must be in your backpack to remove its keys.");
+		return 0;
+	endif
+	
+	foreach item in ( contents )
+		MoveItemToContainer(item, who.backpack);
+		sleepms(2);
+	endforeach
+	
+	return 1;
+endfunction
\ No newline at end of file



From austin at berlios.de  Sun Nov 13 11:51:44 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 11:51:44 +0100
Subject: [Poldistro-svn] r954 - trunk/096/pkg/items/keys/keyring
Message-ID: <200511131051.jADApilj032497@sheep.berlios.de>

Author: austin
Date: 2005-11-13 11:51:41 +0100 (Sun, 13 Nov 2005)
New Revision: 954

Modified:
   trunk/096/pkg/items/keys/keyring/canInsert.src
Log:
Minor fixes to the CanInsert script.


Modified: trunk/096/pkg/items/keys/keyring/canInsert.src
===================================================================
--- trunk/096/pkg/items/keys/keyring/canInsert.src	2005-11-13 10:43:22 UTC (rev 953)
+++ trunk/096/pkg/items/keys/keyring/canInsert.src	2005-11-13 10:51:41 UTC (rev 954)
@@ -5,7 +5,7 @@
  
 use uo;
 
-program OnInsert(who, keyring, movetype, INSERT_INCREASE_STACK, adding_item, existing_stack, amt_to_add)
+program OnInsert(who, keyring, movetype, insert_type, adding_item, existing_stack, amt_to_add)
 	if ( !adding_item.IsKey() )
 		SendSysMessage(who, "That is not a key.");
 		return 0;
@@ -13,10 +13,8 @@
 	
 	SendSysMessage(who, "You put the key on the ring.");
 	
-	var numkeys := EnumerateItemsInContainer(keyring).Size();
-	if ( numkeys == 0 )
-		keyring.graphic := 4113;	
-	elseif ( numkeys == 1 )
+	var numkeys := (EnumerateItemsInContainer(keyring).Size())+1;
+	if ( numkeys == 1 )
 		keyring.graphic := 5993;
 	elseif ( numkeys >= 2 && numkeys <= 4 )
 		keyring.graphic := 5994;



From austin at berlios.de  Sun Nov 13 12:04:06 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 12:04:06 +0100
Subject: [Poldistro-svn] r955 - in trunk/096: config pkg/items/containers
Message-ID: <200511131104.jADB46DB002512@sheep.berlios.de>

Author: austin
Date: 2005-11-13 12:04:02 +0100 (Sun, 13 Nov 2005)
New Revision: 955

Modified:
   trunk/096/config/itemdesc.cfg
   trunk/096/pkg/items/containers/itemdesc.cfg
Log:
Moved bag container and staffpack to containers package.

Modified: trunk/096/config/itemdesc.cfg
===================================================================
--- trunk/096/config/itemdesc.cfg	2005-11-13 10:51:41 UTC (rev 954)
+++ trunk/096/config/itemdesc.cfg	2005-11-13 11:04:02 UTC (rev 955)
@@ -226,49 +226,7 @@
 	OnInsertNoise	sound_insertpack
 }
 
-Container 0x966c
-{
-	Name			staffpack
-	Graphic			0xE75
-	Desc			backpack
-	Gump			0x03C
-	MinX			44
-	MaxX			143
-	MinY			65
-	MaxY			140
-	RequiresAttention	0
-	Movable			1
-	MaxItems		1000
-	MaxWeight		10000
-	Weight			1
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}
 
-Container 0xE76
-{
-	Name			Bag
-	Desc			bag
-	Gump			0x03D
-	MinX			40
-	MaxX			60
-	MinY			20
-	MaxY			80
-	RequiresAttention	0
-	VendorSellsFor		10
-	VendorBuysFor		5
-	dyeable			1
-	MaxItems		125
-	MaxWeight		400
-	Weight			1
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-	OnInsertNoise	sound_insertpack
-}
 
 Item 0x1BDD
 {

Modified: trunk/096/pkg/items/containers/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/containers/itemdesc.cfg	2005-11-13 10:51:41 UTC (rev 954)
+++ trunk/096/pkg/items/containers/itemdesc.cfg	2005-11-13 11:04:02 UTC (rev 955)
@@ -1,7 +1,77 @@
 # $Id$
 #
 #
-#--=[ Small Boxes]=--------------
+
+#--=[ Backpacks ]=----------------
+Container 0x9B2
+{
+	Name			Backpack
+	Desc			back pack
+
+	Gump			0x3C
+	MinX			44
+	MaxX			143
+	MinY			65
+	MaxY			140
+	MaxItems		5000
+	MaxWeight		0
+
+	RequiresAttention	0
+	Movable			1
+	CanDye			1
+	Lockable		0
+
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+}
+
+Container 0xE75
+{
+	#Note: This is the backpack the core equips by default.
+	Name			Backpack2
+	Desc			back pack
+
+	Gump			0x3C
+	MinX			44
+	MaxX			143
+	MinY			65
+	MaxY			140
+	MaxItems		5000
+	MaxWeight		0
+
+	RequiresAttention	0
+	Movable			1
+	CanDye			1
+	Lockable		0
+
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+}
+
+Container 0x966c
+{
+	Name			staffpack
+	Graphic			0xE75
+	Desc			backpack
+	Gump			0x03C
+	MinX			44
+	MaxX			143
+	MinY			65
+	MaxY			140
+	RequiresAttention	0
+	Movable			1
+	MaxItems		1000
+	MaxWeight		10000
+	Weight			1
+	
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+}
+
+#--=[ Small Boxes ]=--------------
 Container 0x9A8
 {
 	Name			StrongBox
@@ -142,51 +212,32 @@
 	DestroyScript		container/canDestroy
 }
 
-Container 0x9B2
+Container 0xE76
 {
-	Name			Backpack
-	Desc			back pack
-
-	Gump			0x3C
-	MinX			44
-	MaxX			143
-	MinY			65
-	MaxY			140
-	MaxItems		5000
-	MaxWeight		0
-
+	Name			Bag
+	Desc			bag
+	
+	Weight			1
+	
+	Gump			0x03D
+	MinX			40
+	MaxX			60
+	MinY			20
+	MaxY			80
+		
+	MaxItems		125
+	MaxWeight		400
+	
 	RequiresAttention	0
-	Movable			1
-	CanDye			1
-	Lockable		0
-
+	VendorSellsFor		10
+	VendorBuysFor		5
+	
 	CanRemoveScript		container/canRemove
 	CanInsertScript		container/canInsert
 	DestroyScript		container/canDestroy
-}
-
-Container 0xE75
-{
-	#Note: This is the backpack the core equips by default.
-	Name			Backpack2
-	Desc			back pack
-
-	Gump			0x3C
-	MinX			44
-	MaxX			143
-	MinY			65
-	MaxY			140
-	MaxItems		5000
-	MaxWeight		0
-
-	RequiresAttention	0
-	Movable			1
+	
+	OnInsertNoise		sound_insertpack
 	CanDye			1
-	Lockable		0
-
-	CanRemoveScript		container/canRemove
-	CanInsertScript		container/canInsert
-	DestroyScript		container/canDestroy
 }
 
 #--=[ Chests ]=------------------



From austin at berlios.de  Sun Nov 13 12:40:48 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 12:40:48 +0100
Subject: [Poldistro-svn] r956 - trunk/096/pkg/items/containers
Message-ID: <200511131140.jADBemYS016747@sheep.berlios.de>

Author: austin
Date: 2005-11-13 12:40:37 +0100 (Sun, 13 Nov 2005)
New Revision: 956

Modified:
   trunk/096/pkg/items/containers/itemdesc.cfg
Log:


Modified: trunk/096/pkg/items/containers/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/containers/itemdesc.cfg	2005-11-13 11:04:02 UTC (rev 955)
+++ trunk/096/pkg/items/containers/itemdesc.cfg	2005-11-13 11:40:37 UTC (rev 956)
@@ -29,7 +29,8 @@
 Container 0xE75
 {
 	#Note: This is the backpack the core equips by default.
-	Name			Backpack2
+	Name			BackPackCore
+	Name			BackPack2
 	Desc			back pack
 
 	Gump			0x3C



From austin at berlios.de  Sun Nov 13 12:43:48 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 12:43:48 +0100
Subject: [Poldistro-svn] r957 - trunk/096/scripts
Message-ID: <200511131143.jADBhm6W018500@sheep.berlios.de>

Author: austin
Date: 2005-11-13 12:43:44 +0100 (Sun, 13 Nov 2005)
New Revision: 957

Removed:
   trunk/096/scripts/items/
Log:
No longer used and obsolete.



From austin at berlios.de  Sun Nov 13 13:35:14 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 13:35:14 +0100
Subject: [Poldistro-svn] r958 - trunk/096/pkg/items/keys/key
Message-ID: <200511131235.jADCZEV4005292@sheep.berlios.de>

Author: austin
Date: 2005-11-13 13:35:12 +0100 (Sun, 13 Nov 2005)
New Revision: 958

Modified:
   trunk/096/pkg/items/keys/key/use.src
Log:
Added support for key copying.

Modified: trunk/096/pkg/items/keys/key/use.src
===================================================================
--- trunk/096/pkg/items/keys/key/use.src	2005-11-13 11:43:44 UTC (rev 957)
+++ trunk/096/pkg/items/keys/key/use.src	2005-11-13 12:35:12 UTC (rev 958)
@@ -7,6 +7,7 @@
 
 include ":keys:key";
 include ":gumps:requestgump";
+include "include/string";
 
 program UseKey(who, key)
 	SendSysMessage(who, "What do you want to use this on?");
@@ -18,6 +19,9 @@
 	elseif ( targ == key )
 		RenameKey(who, key);
 		return 1;
+	elseif ( targ.IsKey() )
+		CopyKey(who, key, targ);
+		return 1;
 	elseif ( !KP_IsLockable(targ) )
 		SendSysMessage(who, "That is not lockable.");
 		return 0;
@@ -33,12 +37,38 @@
 endprogram
 
 function RenameKey(who, key)
-	var new_name := RequestGump(who, "Enter a name for this key", "", key.desc);
+	var new_name := RequestGump(who, "Enter a name for this key", "Maximum length is 20 characters.", key.desc);
+	var name_len := Len(new_name);
 	
-	if ( new_name )
+	if ( name_len > 20 )
+		SendSysMessage(who, "Name is too long.");
+		return 0;
+	elseif ( name_len < 1 )
+		SendSysMessage(who, "Name is too short.");
+		return 0;
+	elseif ( new_name )
 		SetName(key, new_name);
-	else
-		SendSysMessage(who, "Cancelled.");
+		return 1;
+	endif
+endfunction
+
+function CopyKey(who, key, targ)
+	if ( !(targ in EnumerateItemsInContainer(who.backpack)) )
+		SendSysMessage(who, "The destination key must be in your backpack.");
 		return 0;
 	endif
+	
+	var key_id := key.GetLockId();
+	if ( !key_id )
+		SendSysMessage(who, "You can not copy a blank key.");
+		return 0;
+	elseif ( targ.GetLockId() )
+		SendSysMessage(who, "The destination key is not blank.");
+		return 0;
+	endif
+	
+	targ.SetLockId(key_id);
+	SendSysMessage(who, "Done copying keys.");
+	
+	return 1;
 endfunction



From austin at berlios.de  Sun Nov 13 13:42:35 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 13:42:35 +0100
Subject: [Poldistro-svn] r959 - in trunk/096/pkg/mobiles/brainAI: . include include/braincore
Message-ID: <200511131242.jADCgZ2O006887@sheep.berlios.de>

Author: austin
Date: 2005-11-13 13:42:27 +0100 (Sun, 13 Nov 2005)
New Revision: 959

Modified:
   trunk/096/pkg/mobiles/brainAI/include/braincore/sleep.inc
   trunk/096/pkg/mobiles/brainAI/include/npcSettings.inc
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
Log:
Added support for AISetting NoSleep i1
If the line is in an npc template it will not be allowed to enter sleep mode.

Modified: trunk/096/pkg/mobiles/brainAI/include/braincore/sleep.inc
===================================================================
--- trunk/096/pkg/mobiles/brainAI/include/braincore/sleep.inc	2005-11-13 12:35:12 UTC (rev 958)
+++ trunk/096/pkg/mobiles/brainAI/include/braincore/sleep.inc	2005-11-13 12:42:27 UTC (rev 959)
@@ -93,6 +93,9 @@
 	elseif ( GetNerveProcess(npc, "LookAround") )
 		// Look around script is currently running.
 		return 0;
+	elseif ( g_settings["NoSleep"] )
+		// NPC is not allowed to enter sleep mode.
+		return 0;
 	elseif ( idle_ticks < g_settings["IdleTicks"] )
 		// Not enough idle ticks have gone by yet.
 		return 0;

Modified: trunk/096/pkg/mobiles/brainAI/include/npcSettings.inc
===================================================================
--- trunk/096/pkg/mobiles/brainAI/include/npcSettings.inc	2005-11-13 12:35:12 UTC (rev 958)
+++ trunk/096/pkg/mobiles/brainAI/include/npcSettings.inc	2005-11-13 12:42:27 UTC (rev 959)
@@ -38,12 +38,15 @@
 	if ( CInt(settings.exists("CycleWait")) <= 0 )
 		settings["CycleWait"] := 10;
 	endif
-	if ( CInt(settings.exists("SleepWait")) <= 0 )
-		settings["SleepWait"] := 1024;
+	
+	if ( !settings.Exists("NoSleep") )
+		if ( CInt(settings.exists("SleepWait")) <= 0 )
+			settings["SleepWait"] := 1024;
+		endif
+		if ( CInt(settings.exists("IdleTicks")) <= 0 )
+			settings["IdleTicks"] := 5;
+		endif
 	endif
-	if ( CInt(settings.exists("IdleTicks")) <= 0 )
-		settings["IdleTicks"] := 5;
-	endif
 
 	return settings;
 endfunction

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-13 12:35:12 UTC (rev 958)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-13 12:42:27 UTC (rev 959)
@@ -283,6 +283,7 @@
 	Strength		200
 	Intelligence		200
 	Dexterity		200
+	Wrestling		500
 	
 	// Vitals
 	HITS			200
@@ -297,10 +298,9 @@
 
 	// Brain AI Settings
 	AISetting	CycleWait	i100
-	AISetting	SleepWait	i100
-	AISetting	IdleTicks	i100
 	AISetting	ListenRange	i5
 	AISetting	HearSpeech	i1
+	AISetting	NoSleep		i1
 	
 	// Brain AI Nerves
 	AIScript	Combat		:brainAI:bundled/banker/combat



From austin at berlios.de  Sun Nov 13 13:54:44 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 13:54:44 +0100
Subject: [Poldistro-svn] r960 - in trunk/096/pkg/mobiles/brainAI: . bundled bundled/banker docs
Message-ID: <200511131254.jADCsinQ011925@sheep.berlios.de>

Author: austin
Date: 2005-11-13 13:54:36 +0100 (Sun, 13 Nov 2005)
New Revision: 960

Added:
   trunk/096/pkg/mobiles/brainAI/bundled/banker/
   trunk/096/pkg/mobiles/brainAI/bundled/banker/combat.src
   trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src
Modified:
   trunk/096/pkg/mobiles/brainAI/docs/configsettings.html
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
Log:
Updated documentation to note NoSleep setting.
Updated banker NPC settings.
Adding 'bundled' section for banker nerves.

Added: trunk/096/pkg/mobiles/brainAI/bundled/banker/combat.src
===================================================================

Added: trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src
===================================================================

Modified: trunk/096/pkg/mobiles/brainAI/docs/configsettings.html
===================================================================
--- trunk/096/pkg/mobiles/brainAI/docs/configsettings.html	2005-11-13 12:42:27 UTC (rev 959)
+++ trunk/096/pkg/mobiles/brainAI/docs/configsettings.html	2005-11-13 12:54:36 UTC (rev 960)
@@ -65,6 +65,12 @@
       </tr>
       <tr>
         <td width="2%" bgcolor="#C0C0C0" style="border-left-style:solid; border-left-width:1; border-right-style:none; border-right-width:medium; border-top-style:none; border-top-width:medium; border-bottom-style:none; border-bottom-width:medium">
+        <strong style="font-weight: 400"><font face="Tahoma" size="2">NoSleep</font></strong></td>
+        <td width="274%" bgcolor="#C0C0C0" style="border-left-style:none; border-left-width:medium; border-right-style:solid; border-right-width:1; border-top-style:none; border-top-width:medium; border-bottom-style:none; border-bottom-width:medium">
+        <strong style="font-weight: 400"><font face="Tahoma" size="2">If enabled, the NPC will not be allowed to enter sleep mode or run its sleep script.</font></strong></td>
+      </tr>
+      <tr>
+        <td width="2%" bgcolor="#C0C0C0" style="border-left-style:solid; border-left-width:1; border-right-style:none; border-right-width:medium; border-top-style:none; border-top-width:medium; border-bottom-style:none; border-bottom-width:medium">
         <strong style="font-weight: 400"><font face="Tahoma" size="2">AreaSize</font></strong></td>
         <td width="274%" bgcolor="#C0C0C0" style="border-left-style:none; border-left-width:medium; border-right-style:solid; border-right-width:1; border-top-style:none; border-top-width:medium; border-bottom-style:none; border-bottom-width:medium">
         <strong style="font-weight: 400"><font face="Tahoma" size="2">Sets the 

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-13 12:42:27 UTC (rev 959)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-13 12:54:36 UTC (rev 960)
@@ -271,12 +271,14 @@
 	Name			<random> the banker
 	Script			:brainAI:brain
 	ObjType			0x190
-	Color			0
-	TrueColor		0
+	Color			1024
+	TrueColor		1024
 	Gender			0
 	RunSpeed		255
 	AR			100
 	Alignment		good
+	Privs			invul
+	Settings		invul
 	Category		Utility
 	
 	// Attributes
@@ -305,6 +307,13 @@
 	// Brain AI Nerves
 	AIScript	Combat		:brainAI:bundled/banker/combat
 	AIScript	Listen		:brainAI:bundled/banker/listen
+	
+	// Skinning Info
+
+	// Settings other scripts use...
+
+	// CProps (eww!)
+	CProp	GuardKill	i1
 }
 	
 



From austin at berlios.de  Sun Nov 13 14:13:17 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 14:13:17 +0100
Subject: [Poldistro-svn] r961 - trunk/096/pkg/mobiles/brainAI/bundled/banker
Message-ID: <200511131313.jADDDHRm019401@sheep.berlios.de>

Author: austin
Date: 2005-11-13 14:13:15 +0100 (Sun, 13 Nov 2005)
New Revision: 961

Modified:
   trunk/096/pkg/mobiles/brainAI/bundled/banker/combat.src
   trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src
Log:


Modified: trunk/096/pkg/mobiles/brainAI/bundled/banker/combat.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/banker/combat.src	2005-11-13 12:54:36 UTC (rev 960)
+++ trunk/096/pkg/mobiles/brainAI/bundled/banker/combat.src	2005-11-13 13:13:15 UTC (rev 961)
@@ -0,0 +1,44 @@
+// $Id: combat.src 940 2005-11-12 06:06:14Z austin $
+
+use uo;
+use os;
+
+include ":brainAI:npcNerves";
+include ":brainAI:npcCommands";
+include ":attributes:attributes";
+
+program BrainNerve(params)
+	var npc		:= params[1];
+	//var nerve_name	:= params[2];
+	var event	:= params[3];
+	//var settings	:= params[4];
+	//var scripts	:= params[5];
+	params := 0; // Not needed anymore.
+
+	while ( npc )
+		CheckForEvent(npc, event);
+	endwhile
+endprogram
+
+function CheckForEvent(npc, byref event)
+	if ( event )
+		var source := event.source;
+		case ( event.type )
+			SYSEVENT_ENGAGED:
+				AI_Speak(npc, "HELP! GUARDS!!", SPEAK_TEXTTYPE_YELL, SPEAK_DOEVENT_ENABLE);
+				ApplyRawDamage(source, AP_GetVitalMaximumValue(source, HITS));
+				break;
+			SYSEVENT_DAMAGED:
+				// Ignore 'damaged'.
+				break;
+			default:
+				break;
+		endcase
+		event := 0;
+	endif
+	
+	event := wait_for_event(100000);
+	
+
+	return 1;
+endfunction
\ No newline at end of file

Modified: trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src	2005-11-13 12:54:36 UTC (rev 960)
+++ trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src	2005-11-13 13:13:15 UTC (rev 961)
@@ -0,0 +1,61 @@
+use uo;
+use os;
+
+include ":brainAI:eventid";
+include ":brainAI:npcNerves";
+include ":brainAI:npcCommands";
+include ":containers:storageAreas";
+
+program BrainNerve(params)
+	var npc		:= params[1];
+	//var nerve_name:= params[2];
+	var event	:= params[3];
+	//var settings	:= params[4];
+	//var scripts	:= params[5];
+	params := 0; // Not needed anymore.
+	
+	while ( npc )
+		if ( event )
+			case ( event.type )
+				SYSEVENT_SPEECH:
+					SpeechEvent(npc, event);
+					break;
+				default:
+					break;
+			endcase
+			
+			event := 0;
+		endif
+		
+		sleepms(5);
+		event := wait_for_event(100000);
+	endwhile
+endprogram
+
+function SpeechEvent(npc, byref event)
+	var text := event.text;
+	var source := event.source;
+	
+	if ( source.IsA(POLCLASS_NPC) )
+		// Remember - NPCs can send speech events now.
+		return 0;
+	elseif ( !CheckLineOfSight(npc, event.source) )
+		// No line of sight - ignore speech.
+		return 0;
+	endif
+	
+	var bank_region := GetObjProperty(npc, "StorageArea");
+	if ( !bank_region )
+		bank_region := CP_DEFAULT_AREA;
+	endif
+	
+	var bank_box := CP_GetStorageContainerForMobile(source, bank_region, CP_CREATE);
+	if ( text["bank"] || text["box"] )
+		SendOpenSpecialContainer(source, bank_box);
+	endif
+	// To-do:
+	// Gold withdrawl and deposit support?
+	//	
+	
+	return 1;
+endfunction



From austin at berlios.de  Sun Nov 13 14:17:42 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 14:17:42 +0100
Subject: [Poldistro-svn] r962 - trunk/096/pkg/items/containers
Message-ID: <200511131317.jADDHgeE020362@sheep.berlios.de>

Author: austin
Date: 2005-11-13 14:17:14 +0100 (Sun, 13 Nov 2005)
New Revision: 962

Added:
   trunk/096/pkg/items/containers/onDelete.src
Log:
Will remove bank boxes when a character is deleted.

Added: trunk/096/pkg/items/containers/onDelete.src
===================================================================
--- trunk/096/pkg/items/containers/onDelete.src	2005-11-13 13:13:15 UTC (rev 961)
+++ trunk/096/pkg/items/containers/onDelete.src	2005-11-13 13:17:14 UTC (rev 962)
@@ -0,0 +1,18 @@
+/*
+ * $Id$
+ *
+ * Purpose:
+ * When a player character is deleted this will remove all of its storage areas. 
+ *
+ */
+
+include ":containers:storageAreas";
+
+program OnDelete(who)
+	var box_id := CP_GetMobileContainerID(who);
+	foreach area_name in ( CP_GetStorageAreaNames() )
+		CP_RemoveStorageAreaContainer(box_id, area_name);
+	endforeach
+	
+	return 1;
+endprogram
\ No newline at end of file



From austin at berlios.de  Sun Nov 13 14:44:20 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 14:44:20 +0100
Subject: [Poldistro-svn] r963 - trunk/096/pkg/commands/gm
Message-ID: <200511131344.jADDiKSm030711@sheep.berlios.de>

Author: austin
Date: 2005-11-13 14:44:17 +0100 (Sun, 13 Nov 2005)
New Revision: 963

Modified:
   trunk/096/pkg/commands/gm/kill.src
Log:
Apparently the 'Disable()' method requires the privilege name to be lowercase.

Modified: trunk/096/pkg/commands/gm/kill.src
===================================================================
--- trunk/096/pkg/commands/gm/kill.src	2005-11-13 13:17:14 UTC (rev 962)
+++ trunk/096/pkg/commands/gm/kill.src	2005-11-13 13:44:17 UTC (rev 963)
@@ -15,7 +15,7 @@
 		return 0;
 	endif
 	
-	targ.Disable("Invul");
+	targ.Disable("invul");
 	SetObjProperty(targ, "GuardKill", 1);	
 	ApplyRawDamage(targ, CInt(AP_GetVitalMaximumValue(targ, "Hits")));
 	



From austin at berlios.de  Sun Nov 13 14:52:01 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 14:52:01 +0100
Subject: [Poldistro-svn] r964 - in trunk/096/pkg/mobiles/brainAI: . bundled/banker config include
Message-ID: <200511131352.jADDq1dp001663@sheep.berlios.de>

Author: austin
Date: 2005-11-13 14:51:51 +0100 (Sun, 13 Nov 2005)
New Revision: 964

Added:
   trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src
Modified:
   trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src
   trunk/096/pkg/mobiles/brainAI/config/equipGroups.cfg
   trunk/096/pkg/mobiles/brainAI/config/equipIndex.cfg
   trunk/096/pkg/mobiles/brainAI/include/npcInit.inc
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
Log:


Added: trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src	2005-11-13 13:44:17 UTC (rev 963)
+++ trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src	2005-11-13 13:51:51 UTC (rev 964)
@@ -0,0 +1,23 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+
+include ":brainAI:npcNerves";
+include ":brainAI:npcInit";
+include ":brainAI:npcCommands";
+
+program BrainCriticalScript(params)
+	var npc		:= params[1];
+	//var settings	:= params[2];
+	//var scripts	:= params[3];
+	params := 0; // Not needed anymore.
+	
+	NPC_SetupName(npc);
+	NPC_SetupRandomEquipment(npc);
+	
+	return 1;
+endprogram

Modified: trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src	2005-11-13 13:44:17 UTC (rev 963)
+++ trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src	2005-11-13 13:51:51 UTC (rev 964)
@@ -51,6 +51,7 @@
 	
 	var bank_box := CP_GetStorageContainerForMobile(source, bank_region, CP_CREATE);
 	if ( text["bank"] || text["box"] )
+		AI_Turn(npc, source, NETURN_TOWARD);		
 		SendOpenSpecialContainer(source, bank_box);
 	endif
 	// To-do:

Modified: trunk/096/pkg/mobiles/brainAI/config/equipGroups.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/config/equipGroups.cfg	2005-11-13 13:44:17 UTC (rev 963)
+++ trunk/096/pkg/mobiles/brainAI/config/equipGroups.cfg	2005-11-13 13:51:51 UTC (rev 964)
@@ -10,6 +10,20 @@
 #
 #
 
+Elem	Hair
+{
+	Item	ShortHair
+	Item	LongHair
+	Item	PonyTailHair
+	Item	MohawkHair
+	Item	PageboyHair
+	Item	BunsHair
+	Item	AfroHair
+	Item	ReceedingHair
+	Item	PigTailHair
+	Item	KrisnaHair
+}
+
 Elem	Feet
 {
 	Item	sandals

Modified: trunk/096/pkg/mobiles/brainAI/config/equipIndex.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/config/equipIndex.cfg	2005-11-13 13:44:17 UTC (rev 963)
+++ trunk/096/pkg/mobiles/brainAI/config/equipIndex.cfg	2005-11-13 13:51:51 UTC (rev 964)
@@ -9,6 +9,7 @@
 
 Elem	Villager_1
 {
+	Equip	Hair	85
 	Equip	Head	10
 	Equip	Shirt	100
 	Equip	Pants	100

Modified: trunk/096/pkg/mobiles/brainAI/include/npcInit.inc
===================================================================
--- trunk/096/pkg/mobiles/brainAI/include/npcInit.inc	2005-11-13 13:44:17 UTC (rev 963)
+++ trunk/096/pkg/mobiles/brainAI/include/npcInit.inc	2005-11-13 13:51:51 UTC (rev 964)
@@ -190,16 +190,20 @@
 				continue;
 			endif
 
-			var item_list := GetConfigStringArray(group_elem, "Item");
+			var item_list := array{};
+			if ( !flags )
+				item_list := item_list+GetConfigStringArray(group_elem, "Item");
+			endif
 			if ( flags & EQUIP_MALE )
-				item_list := GetConfigStringArray(group_elem, "Male");
+				item_list := item_list + GetConfigStringArray(group_elem, "Male");
 			endif
 			if ( flags & EQUIP_FEMALE )
-				item_list := GetConfigStringArray(group_elem, "Female");
+				item_list := item_list + GetConfigStringArray(group_elem, "Female");
 			endif
 
 			var item := item_list[RandomDiceRoll(item_list.Size())+1];
 			item := CreateItemAtLocation(mobile.x, mobile.y, mobile.z, item, 1);
+			item.movable := 1;
 			if ( item.errortext )
 				PrintTextAbove(mobile, "Unable to create ["+item+"] ->"+item.errortext);
 			elseif ( !EquipItem(mobile, item) )
@@ -267,5 +271,5 @@
 
 	SetName(mobile, my_name);
 
-	return 1;
+	return my_name;
 endfunction

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-13 13:44:17 UTC (rev 963)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-13 13:51:51 UTC (rev 964)
@@ -306,12 +306,15 @@
 	
 	// Brain AI Nerves
 	AIScript	Combat		:brainAI:bundled/banker/combat
+	AIScript	Init		:brainAI:bundled/banker/init
 	AIScript	Listen		:brainAI:bundled/banker/listen
 	
 	// Skinning Info
 
 	// Settings other scripts use...
-
+	NameTemplate		Human_Male
+	EquipTemplate		Villager_1
+	
 	// CProps (eww!)
 	CProp	GuardKill	i1
 }



From austin at berlios.de  Sun Nov 13 15:01:24 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 15:01:24 +0100
Subject: [Poldistro-svn] r965 - in trunk/096/pkg/items: . hair hair/config hair/cuthair
Message-ID: <200511131401.jADE1OLf005342@sheep.berlios.de>

Author: austin
Date: 2005-11-13 15:01:14 +0100 (Sun, 13 Nov 2005)
New Revision: 965

Added:
   trunk/096/pkg/items/hair/
   trunk/096/pkg/items/hair/commands/
   trunk/096/pkg/items/hair/config/
   trunk/096/pkg/items/hair/config/icp.cfg
   trunk/096/pkg/items/hair/cuthair/
   trunk/096/pkg/items/hair/cuthair/control.src
   trunk/096/pkg/items/hair/include/
   trunk/096/pkg/items/hair/itemdesc.cfg
   trunk/096/pkg/items/hair/pkg.cfg
Log:
Gotta have hair, man!

Added: trunk/096/pkg/items/hair/config/icp.cfg
===================================================================
--- trunk/096/pkg/items/hair/config/icp.cfg	2005-11-13 13:51:51 UTC (rev 964)
+++ trunk/096/pkg/items/hair/config/icp.cfg	2005-11-13 14:01:14 UTC (rev 965)
@@ -0,0 +1,13 @@
+ICP Register
+{
+	Name		Hair
+	Version		1.0
+
+	Description	Package that handles head hair and facial hair.
+
+	Creator		Austin
+	C_Email		AustinHeilman at gmail.com
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+}
\ No newline at end of file

Added: trunk/096/pkg/items/hair/cuthair/control.src
===================================================================
--- trunk/096/pkg/items/hair/cuthair/control.src	2005-11-13 13:51:51 UTC (rev 964)
+++ trunk/096/pkg/items/hair/cuthair/control.src	2005-11-13 14:01:14 UTC (rev 965)
@@ -0,0 +1,14 @@
+/* 
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+
+program ControlScript(cuthair)
+	Sleep(90);
+	DestroyItem(cuthair);
+	
+	return 1;
+endprogram

Added: trunk/096/pkg/items/hair/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/hair/itemdesc.cfg	2005-11-13 13:51:51 UTC (rev 964)
+++ trunk/096/pkg/items/hair/itemdesc.cfg	2005-11-13 14:01:14 UTC (rev 965)
@@ -0,0 +1,99 @@
+Item 0xDFE
+{
+	Name		cuthair
+	Desc		cut hair
+
+	Movable		0
+	
+	ControlScript	cuthair/control
+}
+
+
+//-=[ Hair ]=--------------------------
+Item 0x203B
+{
+	Name		ShortHair
+	Desc		short hair
+}
+Item 0x203C
+{
+	Name		LongHair
+	Desc		long hair
+}
+Item 0x203d
+{
+	Name		PonyTailHair
+	Desc		pony tail
+}
+Item 0x2044
+{
+	Name		MohawkHair
+	Desc		mohawk
+}
+Item 0x2045
+{
+	Name		PageBoyHair
+	Desc		pageboy
+}
+Item 0x2046
+{
+	Name		BunsHair
+	Desc		buns hair
+}
+Item 0x2047
+{
+	Name		AfroHair
+	Desc		afro
+}
+Item 0x2048
+{
+	Name		RecedingHair
+	Desc		receding hair
+}
+Item 0x2049
+{
+	Name		PigTailHair
+	Desc		two pig tails
+}
+Item 0x204A
+{
+	Name		KrisnaHair
+	Desc		krisna hair
+}
+
+//-=[ Facial Hair ]=-------------------
+Item 0x203E
+{
+	Name		LongBeardHair
+	Desc		long beard
+}
+Item 0x203F
+{
+	Name		ShortBeardHair
+	Desc		short beard
+}
+Item 0x2040
+{
+	Name		GoateeHair
+	Desc		goatee
+}
+Item 0x2041
+{
+	Name		MustacheHair
+	Desc		mustache
+}
+Item 0x204B
+{
+	Name		MedShortBeardHair
+	Desc		medium-short beard
+}
+Item 0x204C
+{
+	Name		medlongbeard
+	Desc		medium-long beard
+}
+Item 0x204D
+{
+	Name		VandykeHair
+	Desc		vandyke
+}
\ No newline at end of file

Added: trunk/096/pkg/items/hair/pkg.cfg
===================================================================
--- trunk/096/pkg/items/hair/pkg.cfg	2005-11-13 13:51:51 UTC (rev 964)
+++ trunk/096/pkg/items/hair/pkg.cfg	2005-11-13 14:01:14 UTC (rev 965)
@@ -0,0 +1,17 @@
+# $Id$
+#
+#
+Enabled		1
+Name		hair
+
+Version		1.0
+
+CoreRequired	96
+
+Creator		Austin Heilman
+Email		AustinHeilman at gmail.com
+Maintainer	Distro Team
+Email		distro at polserver.com
+
+#Requires	NONE
+#Conflicts	NONE



From austin at berlios.de  Sun Nov 13 15:05:40 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 15:05:40 +0100
Subject: [Poldistro-svn] r966 - trunk/096/pkg/mobiles
Message-ID: <200511131405.jADE5etR006471@sheep.berlios.de>

Author: austin
Date: 2005-11-13 15:05:18 +0100 (Sun, 13 Nov 2005)
New Revision: 966

Removed:
   trunk/096/pkg/mobiles/barber/
Log:
Moved to hair package.



From austin at berlios.de  Sun Nov 13 15:48:38 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 15:48:38 +0100
Subject: [Poldistro-svn] r967 - in trunk/096/pkg: items/containers items/hair/cuthair mobiles/brainAI/bundled/banker mobiles/brainAI/config mobiles/brainAI/include skills/tailoring
Message-ID: <200511131448.jADEmcDY000962@sheep.berlios.de>

Author: austin
Date: 2005-11-13 15:48:30 +0100 (Sun, 13 Nov 2005)
New Revision: 967

Modified:
   trunk/096/pkg/items/containers/onDelete.src
   trunk/096/pkg/items/hair/cuthair/control.src
   trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src
   trunk/096/pkg/mobiles/brainAI/config/equipGroups.cfg
   trunk/096/pkg/mobiles/brainAI/include/npcInit.inc
   trunk/096/pkg/skills/tailoring/itemdesc.cfg
Log:


Modified: trunk/096/pkg/items/containers/onDelete.src
===================================================================
--- trunk/096/pkg/items/containers/onDelete.src	2005-11-13 14:05:18 UTC (rev 966)
+++ trunk/096/pkg/items/containers/onDelete.src	2005-11-13 14:48:30 UTC (rev 967)
@@ -5,12 +5,15 @@
  * When a player character is deleted this will remove all of its storage areas. 
  *
  */
+use uo;
+use file;
 
 include ":containers:storageAreas";
 
 program OnDelete(who)
 	var box_id := CP_GetMobileContainerID(who);
 	foreach area_name in ( CP_GetStorageAreaNames() )
+		LogToFile("::log/onDelete.log", "Deleting bank box in storage area ["+area_name+"] for character "+who.name+" ("+Hex(who.serial)+")", LOG_DATETIME);
 		CP_RemoveStorageAreaContainer(box_id, area_name);
 	endforeach
 	

Modified: trunk/096/pkg/items/hair/cuthair/control.src
===================================================================
--- trunk/096/pkg/items/hair/cuthair/control.src	2005-11-13 14:05:18 UTC (rev 966)
+++ trunk/096/pkg/items/hair/cuthair/control.src	2005-11-13 14:48:30 UTC (rev 967)
@@ -7,8 +7,8 @@
 use os;
 
 program ControlScript(cuthair)
-	Sleep(90);
-	DestroyItem(cuthair);
+	//Sleep(90);
+	//DestroyItem(cuthair);
 	
 	return 1;
 endprogram

Modified: trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src	2005-11-13 14:05:18 UTC (rev 966)
+++ trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src	2005-11-13 14:48:30 UTC (rev 967)
@@ -20,4 +20,4 @@
 	NPC_SetupRandomEquipment(npc);
 	
 	return 1;
-endprogram
+endprogram 
\ No newline at end of file

Modified: trunk/096/pkg/mobiles/brainAI/config/equipGroups.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/config/equipGroups.cfg	2005-11-13 14:05:18 UTC (rev 966)
+++ trunk/096/pkg/mobiles/brainAI/config/equipGroups.cfg	2005-11-13 14:48:30 UTC (rev 967)
@@ -28,7 +28,7 @@
 {
 	Item	sandals
 	Item	shoes
-	Item	kneeboots
+	Item	leatherboots
 	Item	thighboots
 }
 
@@ -93,7 +93,6 @@
 {
 	Item	WarAxe
 	Item	Bow
-	Item	ShortBow
 	Item	Club
 	Item	LargeBattleAxe
 	Item	TwoHandedAxe

Modified: trunk/096/pkg/mobiles/brainAI/include/npcInit.inc
===================================================================
--- trunk/096/pkg/mobiles/brainAI/include/npcInit.inc	2005-11-13 14:05:18 UTC (rev 966)
+++ trunk/096/pkg/mobiles/brainAI/include/npcInit.inc	2005-11-13 14:48:30 UTC (rev 967)
@@ -170,29 +170,30 @@
 	var index_cfg := ReadConfigFile(":brainAI:config/equipIndex");
 	var group_cfg := ReadConfigFile(":brainAI:config/equipGroups");
 	if ( index_cfg.errortext )
-		return error{"errortext":="Error - Could not open equipIndex.cfg -> "+index_cfg.errortext};
+		return error{"errortext":="Could not open equipIndex.cfg -> "+index_cfg.errortext};
 	elseif ( group_cfg.errortext )
-		return error{"errortext":="Error - Could not open equipGroups.cfg -> "+group_cfg.errortext};
+		return error{"errortext":="Could not open equipGroups.cfg -> "+group_cfg.errortext};
 	elseif ( !elem_name )
 		var npc_elem := NPC_GetNPCConfig(mobile);
 		elem_name := npc_elem.EquipTemplate;
 	endif
+	
 	var index_elem := index_cfg[elem_Name];
 	if ( !index_elem )
-		return error{"errortext":="Error - equipIndex.cfg elem ["+index_elem+"] does not exist."};
+		return error{"errortext":="equipIndex.cfg elem ["+index_elem+"] does not exist."};
 	endif
 
 	foreach entry in ( GetConfigStringDictionary(index_elem, "Equip") )
-		if ( RandomInt(100)+1 <= entry )
-			var group_elem := index_cfg[_entry_iter];
+		if ( RandomInt(100)+1 <= CInt(entry) )
+			var group_elem := group_cfg[CStr(_entry_iter)];
 			if ( !group_elem )
-				PrintTextAbove(mobile, "Error - equipGroups.cfg elem ["+group_elem+"] does not exist.");
+				PrintTextAbove(mobile, "equipGroups.cfg elem ["+_entry_iter+"] does not exist.");
 				continue;
 			endif
 
 			var item_list := array{};
 			if ( !flags )
-				item_list := item_list+GetConfigStringArray(group_elem, "Item");
+				item_list := item_list + GetConfigStringArray(group_elem, "Item");
 			endif
 			if ( flags & EQUIP_MALE )
 				item_list := item_list + GetConfigStringArray(group_elem, "Male");
@@ -201,8 +202,8 @@
 				item_list := item_list + GetConfigStringArray(group_elem, "Female");
 			endif
 
-			var item := item_list[RandomDiceRoll(item_list.Size())+1];
-			item := CreateItemAtLocation(mobile.x, mobile.y, mobile.z, item, 1);
+			var item := item_list[RandomInt(item_list.Size())+1];
+			item := CreateItemAtLocation(mobile.x, mobile.y, mobile.z, item, 1, mobile.realm);
 			item.movable := 1;
 			if ( item.errortext )
 				PrintTextAbove(mobile, "Unable to create ["+item+"] ->"+item.errortext);

Modified: trunk/096/pkg/skills/tailoring/itemdesc.cfg
===================================================================
--- trunk/096/pkg/skills/tailoring/itemdesc.cfg	2005-11-13 14:05:18 UTC (rev 966)
+++ trunk/096/pkg/skills/tailoring/itemdesc.cfg	2005-11-13 14:48:30 UTC (rev 967)
@@ -67,7 +67,7 @@
 
 Armor 0x153A
 {
-	Name		LongPants1
+	Name		LongPants
 	VendorSellsFor	34
 	VendorBuysFor	17
 	CanDye		1
@@ -103,7 +103,8 @@
 
 Armor 0x1EFD
 {
-	Name		Fancy Shirt
+	Name		FancyShirt
+	Desc		fancy shirt
 	VendorSellsFor	55
 	VendorBuysFor	27
 	CanDye		1
@@ -411,7 +412,8 @@
 
 Armor 0x1716
 {
-	Name		strawhat
+	Name		TallStrawHat
+	Desc		straw hat
 	VendorSellsFor	31
 	VendorBuysFor	15
 	CanDye		1
@@ -421,6 +423,19 @@
 	DestroyScript		:combat:onDestroy
 }
 
+Armor 0x1717
+{
+	Name		StrawHat
+	Desc		straw hat
+	VendorSellsFor	31
+	VendorBuysFor	15
+	CanDye		1
+	AR		1
+	maxhp		20
+	Coverage	Head
+	DestroyScript		:combat:onDestroy
+}
+
 Item 0xe1f
 {
 	Name		yarn



From austin at berlios.de  Sun Nov 13 15:54:36 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 15:54:36 +0100
Subject: [Poldistro-svn] r968 - trunk/096/pkg/mobiles/brainAI/bundled/banker
Message-ID: <200511131454.jADEsabn008218@sheep.berlios.de>

Author: austin
Date: 2005-11-13 15:54:31 +0100 (Sun, 13 Nov 2005)
New Revision: 968

Modified:
   trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src
Log:
Banker init script completed
Assigns random equipment and colors.

Modified: trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src	2005-11-13 14:48:30 UTC (rev 967)
+++ trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src	2005-11-13 14:54:31 UTC (rev 968)
@@ -9,6 +9,7 @@
 include ":brainAI:npcNerves";
 include ":brainAI:npcInit";
 include ":brainAI:npcCommands";
+include ":dyes:dyes";
 
 program BrainCriticalScript(params)
 	var npc		:= params[1];
@@ -19,5 +20,10 @@
 	NPC_SetupName(npc);
 	NPC_SetupRandomEquipment(npc);
 	
+	foreach item in ( ListEquippedItems(npc) )
+		item.color := RandomDyeColor();
+		sleepms(2);
+	endforeach
+	
 	return 1;
 endprogram 
\ No newline at end of file



From austin at berlios.de  Sun Nov 13 16:18:18 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 16:18:18 +0100
Subject: [Poldistro-svn] r969 - in trunk/096/pkg/items/hair: . config hairdye
Message-ID: <200511131518.jADFIIfI023677@sheep.berlios.de>

Author: austin
Date: 2005-11-13 16:18:16 +0100 (Sun, 13 Nov 2005)
New Revision: 969

Added:
   trunk/096/pkg/items/hair/config/hairColors.cfg
   trunk/096/pkg/items/hair/hairdye/
   trunk/096/pkg/items/hair/hairdye/use.src
Modified:
   trunk/096/pkg/items/hair/itemdesc.cfg
Log:
Foundation for new hair dye script.

Added: trunk/096/pkg/items/hair/config/hairColors.cfg
===================================================================
--- trunk/096/pkg/items/hair/config/hairColors.cfg	2005-11-13 14:54:31 UTC (rev 968)
+++ trunk/096/pkg/items/hair/config/hairColors.cfg	2005-11-13 15:18:16 UTC (rev 969)
@@ -0,0 +1,358 @@
+# $Id$
+#
+####################
+#
+#HairColor <GroupName>
+#{
+#      TitleColor	<color>
+#      Color		#
+#      Color		#
+#}
+#
+# Group name is the text seen over and over for a hair Color sample.
+# TitleColor is the Color of the group name on the left part of the gump.
+# Color # is a list of all the numbers for colors that belong in that group.
+#
+####################
+
+Elem	Index
+{
+	Category	Auburn
+	Category	Blonde
+	Category	Blue
+	Category	LtBrown
+	Category	DkBrown
+	Category	Chestnut
+	Category	Golden
+	Category	Green
+	Category	Grey
+	Category	Purple
+	Category	Red
+}
+	
+
+HairColor Grey
+{
+	// 22 shades of grey
+	TitleColor	2305
+	Color	2301
+	Color	2102
+	Color	2302
+	Color	2403
+	Color	2409
+	Color	2103
+	Color	2404
+	Color	2410
+	Color	2411
+	Color	2105
+	Color	2406
+	Color	2306
+	Color	2106
+	Color	2412
+	Color	1107
+	Color	1907
+	Color	992
+	Color	1899
+	Color	1908
+	Color	1108
+	Color	1109
+}
+HairColor Chestnut
+{
+	// 16 shades of chestnut
+	TitleColor	1753
+	Color	1743
+	Color	1752
+	Color	1707
+	Color	1516
+	Color	1130
+	Color	1517
+	Color	1708
+	Color	1717
+	Color	1131
+	Color	1753
+	Color	1509
+	Color	1727
+	Color	1736
+	Color	1745
+	Color	1754
+	Color	1125
+	Color	1132
+}
+HairColor Golden
+{
+	// 24 shades
+	TitleColor	1514
+	Color	2009
+	Color	2215
+	Color	2010
+	Color	1513
+	Color	1713
+	Color	1722
+	Color	1740
+	Color	1504
+	Color	1514
+	Color	1705
+	Color	1714
+	Color	1723
+	Color	1741
+	Color	1750
+	Color	1121
+	Color	1128
+	Color	1506
+	Color	1515
+	Color	1724
+	Color	1733
+	Color	1742
+	Color	1751
+	Color	1122
+	Color	1129
+}
+HairColor Blonde
+{
+	// 17 shades of Blonde
+	TitleColor	1727
+	Color	2007
+	Color	2313
+	Color	2008
+	Color	2213
+	Color	1728
+	Color	2214
+	Color	1701
+	Color	1501
+	Color	1711
+	Color	1719
+	Color	1502
+	Color	2216
+	Color	1712
+	Color	1512
+	Color	1721
+	Color	1748
+	Color	1126
+	Color	1739
+	Color	1134
+}
+HairColor Auburn
+{
+	// 21 Shades of Auburn
+	TitleColor	1860
+	Color	1860
+	Color	1869
+	Color	1524
+	Color	1533
+	Color	1542
+	Color	1552
+	Color	1861
+	Color	1870
+	Color	1525
+	Color	1526
+	Color	1554
+	Color	1863
+	Color	1871
+	Color	1527
+	Color	1144
+	Color	1872
+	Color	1139
+	Color	1145
+	Color	1140
+	Color	1146
+	Color	1147
+}
+HairColor LtBrown
+{
+	// 26 shades of light brown
+	TitleColor	1113
+	Color	2107
+	Color	1819
+	Color	1846
+	Color	1052
+	Color	2308
+	Color	2108
+	Color	1820
+	Color	1829
+	Color	1838
+	Color	2109
+	Color	1811
+	Color	1111
+	Color	1847
+	Color	1812
+	Color	1821
+	Color	1839
+	Color	1112
+	Color	1054
+	Color	1831
+	Color	1113
+	Color	1841
+	Color	1814
+	Color	1832
+	Color	1805
+	Color	1850
+}
+HairColor DkBrown
+{
+	// 26 shades of dark brown
+	TitleColor	2111
+	Color	1056
+	Color	1114
+	Color	2017
+	Color	1815
+	Color	1851
+	Color	1842
+	Color	1833
+	Color	1115
+	Color	1057
+	Color	1043
+	Color	1050
+	Color	1834
+	Color	1816
+	Color	1843
+	Color	1852
+	Color	1853
+	Color	1807
+	Color	1116
+	Color	2112
+	Color	1844
+	Color	1818
+	Color	1044
+	Color	1836
+	Color	1854
+	Color	1845
+	Color	1051
+}
+HairColor Blue
+{
+	// 25 shades of blue
+	TitleColor	1315
+	Color	1319
+	Color	1401
+	Color	1302
+	Color	1312
+	Color	1321
+	Color	1403
+	Color	1304
+	Color	1313
+	Color	1322
+	Color	1404
+	Color	1305
+	Color	1314
+	Color	1323
+	Color	1405
+	Color	1307
+	Color	1316
+	Color	1325
+	Color	1407
+	Color	1308
+	Color	1317
+	Color	1326
+	Color	1327
+	Color	1408
+	Color	1318
+}
+HairColor Red
+{
+	// 32 shades of red
+	TitleColor	1207
+	Color	1219
+	Color	1619
+	Color	1647
+	Color	1611
+	Color	1220
+	Color	1203
+	Color	1212
+	Color	1221
+	Color	1603
+	Color	1630
+	Color	1648
+	Color	1204
+	Color	1213
+	Color	1222
+	Color	1622
+	Color	1650
+	Color	1214
+	Color	1207
+	Color	1216
+	Color	1223
+	Color	1605
+	Color	1623
+	Color	1207
+	Color	1625
+	Color	1216
+	Color	1225
+	Color	1616
+	Color	1643
+	Color	1208
+	Color	1226
+	Color	1626
+	Color	1608
+
+}
+HairColor Green
+{
+	// 32 shades of green
+	TitleColor	2129
+	Color	2001
+	Color	2002
+	Color	1419
+	Color	2126
+	Color	2003
+	Color	2127
+	Color	1438
+	Color	1429
+	Color	1420
+	Color	2004
+	Color	2128
+	Color	1421
+	Color	2005
+	Color	1422
+	Color	1440
+	Color	1431
+	Color	2211
+	Color	1441
+	Color	1432
+	Color	1423
+	Color	2129
+	Color	1433
+	Color	1424
+	Color	1442
+	Color	2212
+	Color	1425
+	Color	1434
+	Color	1443
+	Color	1426
+	Color	1435
+	Color	1427
+	Color	1436
+}
+HairColor Purple
+{
+	// 28 shades of purple
+	TitleColor	1243
+	Color	1230
+	Color	1239
+	Color	1248
+	Color	1875
+	Color	1231
+	Color	1240
+	Color	1249
+	Color	1876
+	Color	1232
+	Color	1241
+	Color	1250
+	Color	1877
+	Color	1233
+	Color	1242
+	Color	1251
+	Color	1878
+	Color	1234
+	Color	1243
+	Color	1252
+	Color	1879
+	Color	1235
+	Color	1244
+	Color	1253
+	Color	1880
+	Color	1236
+	Color	1245
+	Color	1254
+	Color	1881
+}

Added: trunk/096/pkg/items/hair/hairdye/use.src
===================================================================
--- trunk/096/pkg/items/hair/hairdye/use.src	2005-11-13 14:54:31 UTC (rev 968)
+++ trunk/096/pkg/items/hair/hairdye/use.src	2005-11-13 15:18:16 UTC (rev 969)
@@ -0,0 +1,15 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use os;
+use cfgfile;
+
+include ":gumps:gumps";
+include ":gumps:gumps_ex";
+
+program UseDyes(who, dyes)
+	return 1;
+endprogram

Modified: trunk/096/pkg/items/hair/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/hair/itemdesc.cfg	2005-11-13 14:54:31 UTC (rev 968)
+++ trunk/096/pkg/items/hair/itemdesc.cfg	2005-11-13 15:18:16 UTC (rev 969)
@@ -8,6 +8,14 @@
 	ControlScript	cuthair/control
 }
 
+Item 0x7105
+{
+	Name		HairDye
+	Desc		hair dye
+	Graphic		6215	
+	
+	Script		hairdye/use
+}
 
 //-=[ Hair ]=--------------------------
 Item 0x203B



From austin at berlios.de  Sun Nov 13 22:49:39 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 22:49:39 +0100
Subject: [Poldistro-svn] r970 - trunk/096/pkg/items/hair/hairdye
Message-ID: <200511132149.jADLndKk030443@sheep.berlios.de>

Author: austin
Date: 2005-11-13 22:49:34 +0100 (Sun, 13 Nov 2005)
New Revision: 970

Modified:
   trunk/096/pkg/items/hair/hairdye/use.src
Log:


Modified: trunk/096/pkg/items/hair/hairdye/use.src
===================================================================
--- trunk/096/pkg/items/hair/hairdye/use.src	2005-11-13 15:18:16 UTC (rev 969)
+++ trunk/096/pkg/items/hair/hairdye/use.src	2005-11-13 21:49:34 UTC (rev 970)
@@ -9,7 +9,43 @@
 
 include ":gumps:gumps";
 include ":gumps:gumps_ex";
+include "include/arrays";
 
 program UseDyes(who, dyes)
+	var gump := BuildHairDyeGump();
+	GFSendGump(who, gump);
+	
 	return 1;
 endprogram
+
+//GFResizePic(gump, 0, 0, GFCfgConst("Defaults", "BackGround"), 310, 420);
+//GFResizePic(gump, 10, 10, GFCfgConst("Defaults", "ForeGround"), 290, 400);
+
+function BuildHairDyeGump()
+	var gump := GFCreateGump();
+	
+	GFPage(0);
+	GFClosable(gump, 0);
+	GFResizePic(gump, 0, 0, GFCfgConst("Defaults", "BackGround"), 400, 450);
+	GFResizePic(gump, 15, 15, GFCfgConst("Defaults", "ForeGround"), 120, 420);
+	GFResizePic(gump, 140, 15, GFCfgConst("Defaults", "ForeGround"), 245, 380);
+	
+	var color_cfg := ReadConfigFile(":hair:config/hairColors");
+	var index_elem := color_cfg["Index"];
+	var color_list := array{};
+	var color_info := struct;
+	color_info.+
+	
+	
+	GetConfigStringArray(index_elem, "Category");
+	
+	var index_y := 25;
+	foreach category in ( color_list )
+		GFAddButton(gump, 20, index_y+3, 5224, 5224, GF_PAGE_BTN, _color_info_iter);
+		GFTextLine(gump, 50, index_y, color_info.cat_color, color_info.name);
+		index_y := index_y + 20;
+		sleepms(2);
+	endforeach
+	
+	return gump;
+endfunction



From austin at berlios.de  Sun Nov 13 22:58:26 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 22:58:26 +0100
Subject: [Poldistro-svn] r971 - trunk/096/config
Message-ID: <200511132158.jADLwQ1s032565@sheep.berlios.de>

Author: austin
Date: 2005-11-13 22:58:25 +0100 (Sun, 13 Nov 2005)
New Revision: 971

Modified:
   trunk/096/config/equip.cfg
Log:
Cleaned up - most templates removed.
Can now use the brainAI random equipment system for most things.
Most existing stuff in this was only a backpack.. with a different name.

Modified: trunk/096/config/equip.cfg
===================================================================
--- trunk/096/config/equip.cfg	2005-11-13 21:49:34 UTC (rev 970)
+++ trunk/096/config/equip.cfg	2005-11-13 21:58:25 UTC (rev 971)
@@ -1,319 +1,33 @@
 # $Id$
 #
-#
-#
 # EQUIP.CFG - default outfits, usually for NPCs.
 #
 # Used by core on behalf of any script that calls:
 #      uo::EquipFromTemplate()
 #
-# Properties can have one of three forms:
-#    Armor  [Armor Template]       # See armor.cfg
-#    Weapon [Weapon Template]      # See weapon.cfg
-#    Equip  [ObjType] [Color]      # Color defaults to 0
+# Equipment TemplateName
+# {
+# 	Equip	(item name or objtype)	[color]	// Optional comment
+# }
+# If no color is set it defaults to 0.
 #
-# NOTE: Armor and Weapon entries _cannot_ have comments on the same line
-#
 # All items will be equipped on appropriate layer.
 #
-# Possible extensions:
-#    use a color.cfg for picking random colors from prearranged lists
-#
-#
-#
-#
+###########################################
 
-
 Equipment FullPlate
 {
-    Armor  CloseHelm
-    Armor  PlatemailBreastplate
-    Armor  PlatemailArms
-    Armor  PlatemailLegs
-    Armor  Platemailgloves
-    Armor  Platemailgorget
-    Weapon Halberd
+	Equip	CloseHelm	0
+	Equip	PlatemailBreastPlate	0
+	Equip	PlatemailArms	0
+	Equip	PlatemailLegs	0
+	Equip	PlatemailGloves	0
+	Equip	PlatemailGorget	0
 }
 
-Equipment Clothes
+Equipment FullChain
 {
-    Equip  0x1efd        # fancy shirt, white
-    Equip  0x1539        # long pants, gray
-    Equip  0x1711        # thigh boots
+	Equip	ChainmailCoif	0
+	Equip	ChainmailTunic	0
+	Equip	ChainmailLeggings	0
 }
-
-Equipment Pirate
-{
-    Equip  0x1543     # skullcap, red
-    Equip  0x1517     # shirt, white
-    Equip  0x152e   # short pants, black
-    Equip  0x1541    # body sash, red
-    Equip  0x1440       # cutlass
-}
-
-equipment 1
-{
-    equip  0x1539 0x0455
-    equip  0x0455
-    equip  0x0763
-}
-
-equipment 2
-{
-    equip  0x0455
-    equip  0x1539 0x00
-    equip  0x0763
-}
-
-equipment 3
-{
-    equip  0x0455
-    equip  0x1539 0x0763
-    equip  0x0763
-}
-
-equipment 4
-{
-    equip  0x0455
-    equip  0x1539
-    equip  0x0763
-}
-
-equipment 5
-{
-    equip  0x1539 0x0455
-    equip  0x0763
-}
-
-
-Equipment 6
-{
-    Armor LeatherTunic
-    Armor LeatherSleeves
-    Armor LeatherLeggings
-    Armor ThighBoots
-    Equip 0x203c 54     # long hair
-}
-
-Equipment 7
-{
-    Equip 0x1efd        # fancy shirt
-    Equip 0x1537        # kilt
-    Armor ThighBoots
-    Equip 0x203B 0    # short hair
-    Equip 0x0f64        # torch
-}
-
-Equipment 8
-{
-    Equip 0x1efd        # fancy shirt
-    Equip 0x1537        # kilt
-    Armor ThighBoots
-    Equip 0x2047 56     # big hair
-    Equip 0x13e3        # hammer
-    Equip 0x204d        # vandyke
-}
-
-Equipment 9
-{
-    Armor LeatherTunic
-    Armor LeatherSleeves
-    Armor LeatherLeggings
-    Armor ThighBoots
-    Equip 0x203c 11     # long hair
-    Weapon Crossbow
-}
-
-Equipment 10
-{
-    Equip 0x1efd 12     # fancy shirt
-    Equip 0x1539        # long pants
-    Equip 0x170F        # shoes
-    Equip 0x203c 42     # long hair
-}
-
-Equipment 11
-{
-    Equip 0x1f03 43	# Robe
-    Equip 0x170d	# Sandles
-    Equip 0x203c 1109	# long hair
-    Equip 0x0efa	# spellbook
-}
-
-equipment 12
-{
-equip      0x00
-equip     0x1539 0x0455
-equip       0x0455
-equip       0x0763
-
-}
-
-equipment 13
-{
-equip      0x0455
-equip     0x1539 0x00
-equip       0x00
-equip       0x0763
-
-}
-
-equipment 14
-{
-equip      0x0455
-equip     0x1539 0x0763
-equip       0x00
-equip       0x0763
-
-}
-
-equipment 15
-{
-equip      0x0455
-equip     0x1539
-equip       0x00
-equip       0x0763
-
-}
-
-equipment 16
-{
-equip     0x1539 0x0455
-equip       0x00
-equip       0x0763
-
-}
-
-Equipment 17
-{
-	Equip	0x170B          # boots
-	Equip	0x1539 0x2      # long pants
-	Equip	0x1EFD          # a fancy shirt
-	Equip	0x203C 0x27D    # Long Hair
-	Equip	0x1FFD          # a surcoat
-	Equip	0x1515 0x2F1    # a cloak
-}
-
-Equipment 18
-{
-	Equip	0x170F          # shoes
-	Equip	0x1539 0x3BE    # long pants
-	Equip	0x1EFD 0xFD     # a fancy shirt
-	Equip	0x203D 0x2F6    # Ponytail
-	Equip	0x153D 0x28D    # a full apron
-}
-
-Equipment 19
-{
-	Equip	0x170B 0x20     # boots
-	Equip	0x1539          # long pants
-	Equip	0x1EFD 0x2AB    # a fancy shirt
-	Equip	0x171A 0x20     # a feathered hat
-	Equip	0x2049 0x2E1    #
-	Equip	0x1541 0x20     # a body sash
-	Equip	0x1537 0x2AB    # a kilt
-}
-
-Equipment 20
-{
-	Equip	0x170B 0x3      # boots
-	Equip	0x1539          # long pants
-	Equip	0x1EFD          # a fancy shirt
-	Equip	0x2048          #
-	Equip	0x1FA1 0x2E7    # tunic
-	Equip	0x1537 0x2E7    # a kilt
-}
-
-Equipment 21
-{
-	Equip	0x152E 0x2E7    # short pants
-	Equip	0x1517 0x2E7    # a shirt
-}
-
-Equipment 22
-{
-	Equip	0xF43           # a hatchet
-	Equip	0x170B 0x84     # boots
-	Equip	0x1539          # long pants
-	Equip	0x1EFD          # a fancy shirt
-	Equip	0x153F 0x85     # a bandana
-	Equip	0x153D 0x85     # a full apron
-}
-
-Equipment 23
-{
-	Equip	0x170B 0x30     # boots
-	Equip	0x1539 0x25B    # long pants
-	Equip	0x1719 0x30     # a bonnet
-	Equip	0x1FA1 0x25B    # tunic
-	Equip	0x1515 0x30     # a cloak
-}
-
-Equipment 24
-{
-	Equip	0x1440          # a cutlass
-	Equip	0x170B 0x192    # boots
-	Equip	0x1539 0x3E5    # long pants
-	Equip	0x1517 0x192    # a shirt
-	Equip	0x1543 0x215    # a skullcap
-	Equip	0x13C6          # leather gloves
-}
-equipment 25
-{
-equip      0x00
-equip     0x1539 0x0455
-equip       0x0455
-equip       0x0763
-}
-
-equipment 26
-{
-equip      0x0455
-equip     0x1539 0x00
-equip       0x00
-equip       0x0763
-}
-
-equipment 27
-{
-equip      0x0455
-equip     0x1539 0x0763
-equip       0x00
-equip       0x0763
-}
-
-equipment 28
-{
-equip      0x0455
-equip     0x1539
-equip       0x00
-equip       0x0763
-}
-
-equipment 29
-{
-equip     0x1539 0x0455
-equip       0x00
-equip       0x0763
-}
-
-equipment archer
-{
-    weapon 0x13B2
-    Equip  0xe75 # backpack to put arrows in
-}
-
-equipment backpack
-{
-	equip 0xe75
-{
-
-equipment creature_spellcaster
-{
-    equip 0xe75
-}
-
-equipment creature_spellcaster
-{
-    equip 0xe75
-}
\ No newline at end of file



From austin at berlios.de  Sun Nov 13 23:17:44 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Sun, 13 Nov 2005 23:17:44 +0100
Subject: [Poldistro-svn] r972 - trunk/096/config
Message-ID: <200511132217.jADMHidY004194@sheep.berlios.de>

Author: austin
Date: 2005-11-13 23:17:43 +0100 (Sun, 13 Nov 2005)
New Revision: 972

Removed:
   trunk/096/config/npcequip.cfg
   trunk/096/config/teleporters.cfg
Modified:
   trunk/096/config/movecost.cfg
Log:
Removed # style inline comments from movecost.cfg
Deleted other obsolete config files.

Modified: trunk/096/config/movecost.cfg
===================================================================
--- trunk/096/config/movecost.cfg	2005-11-13 21:58:25 UTC (rev 971)
+++ trunk/096/config/movecost.cfg	2005-11-13 22:17:43 UTC (rev 972)
@@ -23,7 +23,8 @@
 	50	0.50
 	75	0.75
 	100	1.00
-	Over	60.0	# if somehow carrying more than your carrying capacity
+	// If carrying more than your carrying capacity
+	Over	60.0
 }
 
 Running
@@ -33,5 +34,6 @@
 	50	0.75
 	75	1.00
 	100	10.0
-	Over	120.0	# if somehow carrying more than your carrying capacity
+	// If carrying more than your carrying capacity
+	Over	120.0
 }

Deleted: trunk/096/config/npcequip.cfg
===================================================================
--- trunk/096/config/npcequip.cfg	2005-11-13 21:58:25 UTC (rev 971)
+++ trunk/096/config/npcequip.cfg	2005-11-13 22:17:43 UTC (rev 972)
@@ -1,205 +0,0 @@
-NpcTemplate playervendor
-{
-	Equipt	PlayerVendor
-}
-
-NPCTemplate peasant2
-{
-	Equipt	peasant2
-}
-
-NPCTemplate peasant1
-{
-	Equipt	peasant1
-}
-
-NpcTemplate paladin
-{
-	Equipt	Paladin
-}
-
-NPCTemplate person
-{
-	Equipt	peasant1
-}
-
-
-NPCTemplate townperson
-{
-	Equipt	peasant2
-}
-
-NPCTemplate townguard
-{
-	Equipt	FullPlate
-}
-
-NpcTemplate healer
-{
-	Equipt	Healer
-}
-
-NpcTemplate wanderinghealer
-{
-	Equipt	Healer
-}
-
-NpcTemplate stablemaster
-{
-	Equipt	StableMaster
-}
-
-NpcTemplate shipwright
-{
-	Equipt	ShipWright
-}
-
-NpcTemplate fisherman
-{
-	Equipt	fisherman
-}
-
-NpcTemplate innkeeper
-{
-	Equipt	clothes
-}
-
-NpcTemplate Farmer
-{
-	Equipt	peasant1
-}
-
-NpcTemplate weaponsmith
-{
-	Equipt	Blacksmith
-}
-
-NpcTemplate armorer
-{
-	Equipt	Blacksmith
-}
-
-NpcTemplate barkeep
-{
-	Equipt	barkeep
-}
-
-NpcTemplate barmaid
-{
-	Equipt	barmaid
-}
-
-NpcTemplate baker
-{
-	Equipt	baker
-}
-
-NpcTemplate tinker
-{
-	Equipt	tinker
-}
-
-NpcTemplate bard
-{
-	Equipt	Peasant2
-}
-
-NpcTemplate butcher
-{
-	Equipt	butcher
-}
-
-NpcTemplate cobbler
-{
-	Equipt	clothes
-}
-
-NpcTemplate jewler
-{
-	Equipt	tinker
-}
-
-NpcTemplate mage
-{
-	Equipt	Mage
-}
-
-NpcTemplate alchemist
-{
-	Equipt	Mage
-}
-
-NpcTemplate tailor
-{
-	Equipt	Tailor
-}
-
-NpcTemplate weaver
-{
-	Equipt	Tailor
-}
-
-NpcTemplate leatherworker
-{
-	Equipt	Leatherworker
-}
-
-NpcTemplate provisioner
-{
-	Equipt	Provisioner
-}
-
-NpcTemplate carpenter
-{
-	Equipt	Carpenter
-}
-
-NpcTemplate bowyer
-{
-	Equipt	Bowyer
-}
-
-NpcTemplate architect
-{
-	Equipt	Architect
-}
-
-NpcTemplate scribe
-{
-	Equipt	Scribe
-}
-
-NpcTemplate crier
-{
-	Equipt	crier
-}
-
-NPCTemplate Pirate
-{
-	Equipt	Pirate
-}
-
-NPCTemplate Banker
-{
-	Equipt	banker
-}
-
-NpcTemplate magelord
-{
-	Equipt	MageLord
-}
-
-NpcTemplate evilmage
-{
-	Equipt	EvilMage
-}
-
-NpcTemplate eviladept
-{
-	Equipt	EvilMage
-}
-
-NpcTemplate brigand1
-{
-	Equipt	Brigand
-}
\ No newline at end of file

Deleted: trunk/096/config/teleporters.cfg
===================================================================
--- trunk/096/config/teleporters.cfg	2005-11-13 21:58:25 UTC (rev 971)
+++ trunk/096/config/teleporters.cfg	2005-11-13 22:17:43 UTC (rev 972)
@@ -1,5 +0,0 @@
-Teleporter 1
-{
-	spacefill
-}
-



From austin at berlios.de  Mon Nov 14 00:40:13 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 00:40:13 +0100
Subject: [Poldistro-svn] r973 - in trunk/096: config pkg/items/containers
Message-ID: <200511132340.jADNeDpc019284@sheep.berlios.de>

Author: austin
Date: 2005-11-14 00:39:52 +0100 (Mon, 14 Nov 2005)
New Revision: 973

Modified:
   trunk/096/config/itemdesc.cfg
   trunk/096/pkg/items/containers/itemdesc.cfg
Log:
Moved armoirs from config/itemdesc.cfg to containers/itemdesc.cfg

Modified: trunk/096/config/itemdesc.cfg
===================================================================
--- trunk/096/config/itemdesc.cfg	2005-11-13 22:17:43 UTC (rev 972)
+++ trunk/096/config/itemdesc.cfg	2005-11-13 23:39:52 UTC (rev 973)
@@ -165,69 +165,6 @@
 	CanRemoveScript		:containers:container/noRemove
 }
 
-Container 0xa9f
-{
-	Name			spawnshelf
-	Desc			bookcase
-	Graphic			0xa9c
-	Gump			0x04d
-	MinX			40
-	MaxX			120
-	MinY			10
-	MaxY			60
-	Weight			10
-	Movable			0
-	MaxItems		125
-	MaxWeight		400
-	CanInsertScript		::bookInsert
-	CanRemoveScript		::bookRemove
-}
-
-Container 0x966a
-{
-	Name			vendorbag
-	Graphic			0xE79
-	Desc			backpack
-	Gump			0x042
-	MinX			44
-	MaxX			143
-	MinY			65
-	MaxY			140
-	RequiresAttention	0
-	Movable			1
-	MaxItems		800
-	MaxWeight		32000
-	Weight			1
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}
-
-Container 0x966b
-{
-	Name			packbag
-	Graphic			0xE75
-	Desc			backpack
-	Gump			0x03C
-	MinX			44
-	MaxX			143
-	MinY			65
-	MaxY			140
-	RequiresAttention	0
-	Movable			1
-	MaxItems		125
-	MaxWeight		800
-	Weight			5
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-	OnInsertNoise	sound_insertpack
-}
-
-
-
 Item 0x1BDD
 {
 	Name			log
@@ -280,48 +217,6 @@
 	Movable			1
 }
 
-Container 0xa4e
-{
-	Name			BrownArmoire
-	Desc			armoire
-	Gump			0x04f
-	MinX			44
-	MaxX			143
-	MinY			65
-	MaxY			140
-	RequiresAttention	0
-	Furniture		1
-	Movable			1
-	MaxItems		125
-	MaxWeight		400
-	Weight			5
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}
-
-Container 0xa50
-{
-	Name			CherryArmoireOpened
-	Desc			cherry armoire
-	Gump			0x04e
-	MinX			44
-	MaxX			143
-	MinY			65
-	MaxY			140
-	RequiresAttention	0
-	Furniture		1
-	Movable			1
-	MaxItems		125
-	MaxWeight		400
-	Weight			5
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}
-
 Item 0x1dae
 {
 	Name			Head

Modified: trunk/096/pkg/items/containers/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/containers/itemdesc.cfg	2005-11-13 22:17:43 UTC (rev 972)
+++ trunk/096/pkg/items/containers/itemdesc.cfg	2005-11-13 23:39:52 UTC (rev 973)
@@ -3,6 +3,8 @@
 #
 
 #--=[ Backpacks ]=----------------
+
+
 Container 0x9B2
 {
 	Name			Backpack
@@ -734,6 +736,31 @@
 	DestroyScript		container/canDestroy
 }
 
+Container 0xA4C
+{
+	Name			OpenCherryArmoire
+	Desc			armoire
+
+	Gump			0x4E
+	MinX			44
+	MaxX			143
+	MinY			65
+	MaxY			140
+	MaxItems		25
+	MaxWeight		0
+
+	RequiresAttention	0
+	Movable			1
+	Lockable		0
+
+	Script			container/use
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+
+	OpenGraphic		2636
+	CloseGraphic		2637
+}
 Container 0xA4D
 {
 	Name			CherryArmoire
@@ -759,6 +786,27 @@
 	OpenGraphic		2636
 	CloseGraphic		2637
 }
+
+Container 0xA50
+{
+	Name			OpenCherryArmoire2
+	Desc			cherry armoire
+	Gump			0x04e
+	MinX			44
+	MaxX			143
+	MinY			65
+	MaxY			140
+	RequiresAttention	0
+	Furniture		1
+	Movable			1
+	MaxItems		125
+	MaxWeight		400
+	Weight			5
+	CanInsertScript		::canInsert
+	OnInsertScript		::onInsert
+	CanRemoveScript		::canRemove
+	OnRemoveScript		::onRemove
+}
 Container 0xA51
 {
 	Name			CherryArmoire2
@@ -785,9 +833,29 @@
 	CloseGraphic		2641
 }
 
+Container 0xA4E
+{
+	Name			BrownArmoire
+	Desc			armoire
+	Gump			0x04f
+	MinX			44
+	MaxX			143
+	MinY			65
+	MaxY			140
+	RequiresAttention	0
+	Furniture		1
+	Movable			1
+	MaxItems		125
+	MaxWeight		400
+	Weight			5
+	CanInsertScript		::canInsert
+	OnInsertScript		::onInsert
+	CanRemoveScript		::canRemove
+	OnRemoveScript		::onRemove
+}
 Container 0xA4F
 {
-	Name			Armoire3
+	Name			OpenBrownArmoire
 	Desc			armoire
 
 	Gump			0x4F
@@ -811,9 +879,34 @@
 	CloseGraphic		2639
 }
 
+Container 0xA52
+{
+	Name			BrownArmoire2
+	Desc			armoire
+
+	Gump			0x4F
+	MinX			44
+	MaxX			143
+	MinY			65
+	MaxY			140
+	MaxItems		25
+	MaxWeight		0
+
+	RequiresAttention	0
+	Movable			1
+	Lockable		0
+
+	Script			container/use
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+
+	OpenGraphic		2642
+	CloseGraphic		2643
+}
 Container 0xA53
 {
-	Name			Armoire4
+	Name			OpenBrownArmoire2
 	Desc			armoire
 
 	Gump			0x4F
@@ -977,7 +1070,7 @@
 	FilledGraphic		2716
 }
 
-#--=[ Misc. Containers ]=-----------
+#--=[ Special Containers ]=-----------
 
 Container 0xEFFD
 {
@@ -1003,6 +1096,28 @@
 	DestroyScript		container/canDestroy
 }
 
+Container 0x966A
+{
+	Name			VendorContainer
+	Graphic			0xE79
+	Desc			backpack
+	Weight			1
+	
+	Gump			0x042
+	MinX			44
+	MaxX			143
+	MinY			65
+	MaxY			140
+	MaxItems		800
+	MaxWeight		32000
+	
+	RequiresAttention	0
+	Movable			1
+	
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+}
+
 #--=[ System Containers ]=----------
 
 Container 0xF013



From austin at berlios.de  Mon Nov 14 01:19:56 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 01:19:56 +0100
Subject: [Poldistro-svn] r975 - trunk/096/data
Message-ID: <200511140019.jAE0JuH2003824@sheep.berlios.de>

Author: austin
Date: 2005-11-14 01:19:44 +0100 (Mon, 14 Nov 2005)
New Revision: 975

Modified:
   trunk/096/data/datastore.txt
   trunk/096/data/pol.txt
Log:
Purged - so that the latest .txt updates wont cause datafile issues.

Modified: trunk/096/data/datastore.txt
===================================================================
--- trunk/096/data/datastore.txt	2005-11-14 00:15:38 UTC (rev 974)
+++ trunk/096/data/datastore.txt	2005-11-14 00:19:44 UTC (rev 975)
@@ -1,134 +1,3 @@
 #
 #  DATASTORE.TXT: DataStore Data
 #
-
-DataFile
-{
-	Descriptor	:attributes:attributes
-	Name	attributes
-	Package	attributes
-	Flags	0
-	Version	1
-	OldVersion	0
-}
-
-DataFile
-{
-	Descriptor	:bountyboard:BountySystem
-	Name	BountySystem
-	Package	bountyboard
-	Flags	0
-	Version	16
-	OldVersion	16
-}
-
-DataFile
-{
-	Descriptor	:bulletinboard:MessageBoards
-	Name	MessageBoards
-	Package	bulletinboard
-	Flags	0
-	Version	2
-	OldVersion	2
-}
-
-DataFile
-{
-	Descriptor	:control:gumps
-	Name	gumps
-	Package	control
-	Flags	0
-	Version	21
-	OldVersion	20
-}
-
-DataFile
-{
-	Descriptor	:control:packages
-	Name	packages
-	Package	control
-	Flags	0
-	Version	33
-	OldVersion	32
-}
-
-DataFile
-{
-	Descriptor	:spawnregion:SpawnGroups
-	Name	SpawnGroups
-	Package	spawnregion
-	Flags	0
-	Version	1
-	OldVersion	1
-}
-
-DataFile
-{
-	Descriptor	:spawnregion:SpawnRegionData
-	Name	SpawnRegionData
-	Package	spawnregion
-	Flags	0
-	Version	2
-	OldVersion	2
-}
-
-DataFile
-{
-	Descriptor	:spawnregion:SpawnRegionFreq
-	Name	SpawnRegionFreq
-	Package	spawnregion
-	Flags	0
-	Version	2
-	OldVersion	2
-}
-
-DataFile
-{
-	Descriptor	:spawnregion:SpawnRegions
-	Name	SpawnRegions
-	Package	spawnregion
-	Flags	0
-	Version	1
-	OldVersion	1
-}
-
-DataFile
-{
-	Descriptor	:spawnsystem:Groups
-	Name	Groups
-	Package	spawnsystem
-	Flags	0
-	Version	2
-	OldVersion	1
-}
-
-DataFile
-{
-	Descriptor	:spawnsystem:Realms
-	Name	Realms
-	Package	spawnsystem
-	Flags	0
-	Version	2
-	OldVersion	1
-}
-
-DataFile
-{
-	Descriptor	:spawnsystem:Regions
-	Name	Regions
-	Package	spawnsystem
-	Flags	0
-	Version	2
-	OldVersion	1
-}
-
-DataFile
-{
-	Descriptor	:sysbook:staticbooks
-	Name	staticbooks
-	Package	sysbook
-	Flags	1
-	Version	4
-	OldVersion	4
-}
-

Modified: trunk/096/data/pol.txt
===================================================================
--- trunk/096/data/pol.txt	2005-11-14 00:15:38 UTC (rev 974)
+++ trunk/096/data/pol.txt	2005-11-14 00:19:44 UTC (rev 975)
@@ -16,17 +16,5 @@
 
 GlobalProperties
 {
-	CProp	SystemTeleportersCreated i1
-	CProp	TimeStamp t3:S5:monthi8S3:sumi1122854400S4:yeari2005
-	CProp	Weather a8:i0i0i2i0i18i17i0i0
-	CProp	day i2
-	CProp	gameclock s25190494
-	CProp	nextlockid i1256
-	CProp	orelist d0:
-	CProp	r117ghorses i-1
-	CProp	r25gdomestic i-2
-	CProp	r25gjungleanimals i-1
-	CProp	shelves a475:i1094819900i1094819901i1094819902i1094819903i1094819904i1094819905i1094819907i1094819908i1094819909i1094819910i1094819912i1094819913i1094819914i1094819915i1094819916i1094819917i1094819918i1094819919i1094819920i1094819929i1094819930i1094819931i1094819932i1094819933i1094819934i1094819935i1094819936i1094819937i1094819938i1094819939i1094819940i1094819942i1094819943i1094819944i1094819945i1094819946i1094819947i1094819948i1094819949i1094819950i1094819951i1094819952i1094819953i1094819954i1094819955i1094820313i1094820314i1094820315i1094820316i1094820319i1094820320i1094820323i1094820324i1094820325i1094820326i1094820327i1094820328i1094820336i1104881514i1104881517i1104881521i1104881766i1104881767i1104881779i1104881780i1104881781i1104881932i1104882041i1104882042i1104882043i1104882044i1104882045i1104882046i1104882047i1104882048i1104882049i1104882050i1104882051i1104882052i1104882053i1104882054i1104882120i1104882132i1104882152i1104882153i1104882154i1104882155i1104882156!
 i1104882157i1104882158i1104882159i1104882160i1104882161i1104882162i1114106046i1114106047i1114106048i1114106049i1114117328i1114121880i1114121881i1114121882i1114121883i1114130285i1114130598i1114130599i1114131250i1114131251i1114131252i1114131288i1114131289i1114131297i1114131298i1114131299i1114131300i1114131301i1114131302i1114131303i1114142968i1114142969i1114142970i1114142972i1114142995i1114142996i1114142997i1114142999i1114648339i1114648341i1114648342i1114651744i1114651745i1114651758i1114651759i1114651760i1114651761i1114651762i1114651764i1114651765i1114651766i1114651768i1114651769i1114660633i1114660634i1114660635i1114660662i1114662427i1114662428i1114662429i1119118320i1119118322i1119118323i1119118326i1119118343i1119118344i1119118345i1119118346i1119118347i1119118349i1119118350i1119118351i1119121508i1119121911i1119121915i1119231119i1119231120i1119231121i1119234198i1119234199i1119292762i1119292771i1119292782i1119292905i1119292906i1119292907i1126608513i1126608515i1126608538i11266085!
 61i1126608571i1620416732i1620416733i1620416734i1620416735i1620!
 416736i1
620416737i1620433669i1620434359i1621438368i1621438369i1621438371i1621438372i1621438375i1621438629i1621438637i1621438644i1621438647i1621438648i1621438890i1621441631i1621441633i1621448106i1621448108i1621448114i1621448120i1621450598i1621450600i1621450602i1621727391i1621727392i1621727393i1621727402i1621727403i1621727404i1621783728i1621783729i1621783730i1621783731i1621783732i1621783733i1621783734i1621783735i1621783736i1621793207i1621793208i1621793209i1621793210i1621887222i1621887223i1621897657i1621897658i1621899860i1621899861i1621901739i1621938321i1621943475i1621955168i1621955169i1621965697i1621965729i1621965732i1621966021i1621967978i1621967984i1621967985i1621978441i1621978442i1621978443i1621978444i1699348015i1699348016i1699348017i1699348018i1703140600i1703140601i1703211134i1703211135i1703211136i1703218914i1703219159i1703219161i1703381643i1703381644i1703381645i1703381646i1703396483i1703396484i1703396485i1703406892i1703406893i1703406894i1703462801i1703462802i1703462803i1703488037i!
 1703488038i1703660840i1703660841i1703660842i1703660843i1703660844i1703729350i1703729351i1703729352i1703729353i1703729354i1703729355i1703729356i1703729357i1703729358i1703729359i1703729360i1703729361i1703729362i1703729363i1703729364i1703729365i1703729366i1703729367i1703729376i1703729377i1703729378i1703729379i1703729380i1703729381i1703729382i1703729383i1703729384i1703729385i1703729386i1703729387i1703729388i1703729869i1703729870i1703733021i1703733316i1703733401i1703733444i1703733445i1703733446i1703733449i1703733468i1703733469i1703733470i1703739804i1703739805i1703739806i1703739807i1703739808i1703739809i1703739810i1703739811i1703739812i1703739813i1703739814i1703739815i1703739816i1703739817i1703742033i1703742034i1703742035i1703742036i1703742037i1703742038i1703742039i1703742040i1703742041i1703742042i1703742043i1703742060i1703742061i1703742062i1703742063i1703742064i1703742065i1703742066i1703742067i1703742068i1703742069i1703742070i1703742071i1703742072i1703742073i1703742074i170374207!
 5i1703742076i1703742077i1703742078i1703742079i1703742320i17037!
 42321i17
03746391i1703746613i1703746614i1703746617i1703747269i1703747270i1703747272i1703747274i1703747275i1703747278i1703747281i1703747762i1703747763i1703752338i1703752398i1703752435i1703752449i1703752485i1703752495i1703752496i1703752497i1703752498i1703752499i1703752500i1703752501i1703752502i1703752503i1703752504i1703752505i1703752506i1703752507i1703752508i1703752509i1703752510i1703752511i1703752512i1706676259i1706676260i1706676262i1706676263i1706836083i1706836084i1706836085i1706836086i1706836087i1706836088i1734115518i1734115519i1734115520i1734115761i1734115762i1734115763i1734487747i1734487749i1734487751i1734487755i1734487758i1734487759i1734675139i1734675150i1734675175i1734675176i1734936108i1734936470i1734936475i1734936478i1736985268i1736985269i1736985282i1736985286i1736985287i1792754761i1792754762i1792754763i1792754764i1792754765i1792754766i1792754767i1792754768i1792754769i1792754770i1792754771i1792754772i1792754773i1792754774i1792754775i1792754776i1792754777i1792754778i1792754779i1!
 792754780i1792754781i1792754782i1792754783i1792754784i1792754785i1792754786i1792754787i1792754788i1792754789i1792754790i1792754791i1792754792i1792754793i1792754794
-	CProp	storagestart i1713865
 }
 



From austin at berlios.de  Mon Nov 14 01:22:47 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 01:22:47 +0100
Subject: [Poldistro-svn] r976 - trunk/096/pkg/items/containers
Message-ID: <200511140022.jAE0Mlm0004441@sheep.berlios.de>

Author: austin
Date: 2005-11-14 01:22:42 +0100 (Mon, 14 Nov 2005)
New Revision: 976

Modified:
   trunk/096/pkg/items/containers/itemdesc.cfg
Log:


Modified: trunk/096/pkg/items/containers/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/containers/itemdesc.cfg	2005-11-14 00:19:44 UTC (rev 975)
+++ trunk/096/pkg/items/containers/itemdesc.cfg	2005-11-14 00:22:42 UTC (rev 976)
@@ -1045,7 +1045,7 @@
 {
 	Name			BookShelf2
 	Desc			book shelf
-
+	
 	Gump			0x4D
 	MinX			40
 	MaxX			125



From austin at berlios.de  Mon Nov 14 02:16:45 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 02:16:45 +0100
Subject: [Poldistro-svn] r977 - trunk/096/pkg/items/containers
Message-ID: <200511140116.jAE1GjD9026534@sheep.berlios.de>

Author: austin
Date: 2005-11-14 02:16:43 +0100 (Mon, 14 Nov 2005)
New Revision: 977

Modified:
   trunk/096/pkg/items/containers/itemdesc.cfg
Log:


Modified: trunk/096/pkg/items/containers/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/containers/itemdesc.cfg	2005-11-14 00:22:42 UTC (rev 976)
+++ trunk/096/pkg/items/containers/itemdesc.cfg	2005-11-14 01:16:43 UTC (rev 977)
@@ -3,8 +3,6 @@
 #
 
 #--=[ Backpacks ]=----------------
-
-
 Container 0x9B2
 {
 	Name			Backpack
@@ -644,11 +642,11 @@
 	DestroyScript		container/canDestroy
 }
 
-#--=[ Furniture ]=-----------------
+#--=[ Drawers ]=-----------------
 
 Container 0xA2C
 {
-	Name			ChestOfDrawers
+	Name			BrownChestOfDrawers
 	Desc			chest of drawers%%
 
 	Gump			0x51
@@ -670,7 +668,7 @@
 }
 Container 0xA34
 {
-	Name			ChestOfDrawers2
+	Name			BrownChestOfDrawers2
 	Desc			chest of drawers%%
 
 	Gump			0x51
@@ -693,7 +691,7 @@
 
 Container 0xA30
 {
-	Name			ChestOfDrawers3
+	Name			CherryChestOfDrawers
 	Desc			chest of drawers%%
 
 	Gump			0x48
@@ -715,7 +713,7 @@
 }
 Container 0xA38
 {
-	Name			ChestOfDrawers4
+	Name			CherryChestOfDrawers2
 	Desc			chest of drawers%%
 
 	Gump			0x48
@@ -736,6 +734,8 @@
 	DestroyScript		container/canDestroy
 }
 
+#--=[ Armoires ]=--------------
+
 Container 0xA4C
 {
 	Name			OpenCherryArmoire
@@ -930,9 +930,11 @@
 	CloseGraphic		2643
 }
 
+#--=[ Dressers ]=-------------- 
+
 Container 0xA3C
 {
-	Name			fancydresser1
+	Name			FancyDresserRight
 	desc			fancy dresser
 	Gump			0x0048
 	MinX			44
@@ -952,7 +954,7 @@
 
 Item 0xA3D
 {
-	Name			FancyDresser2
+	Name			FancyDresserLeft
 	Desc			fancy dresser
 	Gump			0x0048
 	MinX			44
@@ -970,10 +972,9 @@
 	DestroyScript		container/canDestroy
 }
 
-
 Item 0xA44
 {
-	Name			FancyDresser3
+	Name			FancyDresserLeft2
 	Desc			fancy dresser
 	Gump			0x0048
 	MinX			44
@@ -993,7 +994,7 @@
 
 Item 0xA45
 {
-	Name			FancyDresser4
+	Name			FancyDresserRight2
 	Desc			fancy dresser
 	Gump			0x0048
 	MinX			44
@@ -1070,6 +1071,198 @@
 	FilledGraphic		2716
 }
 
+#--=[ Bones ]=------------------------
+
+Container 0xED2
+{
+	Name			bones
+	Desc			bones
+	Weight			5
+	
+	Movable			0
+	DecayOnMultis		1
+	RequiresAttention	0
+		
+	Gump			0x009
+	MinX			20
+	MaxX			80
+	MinY			85
+	MaxY			165	
+	
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+}
+
+Container 0xED1
+{
+	Name			bones2
+	Desc			bones
+	Weight			5
+	
+	Movable			0
+	DecayOnMultis		1
+	RequiresAttention	0
+		
+	Gump			0x009
+	MinX			20
+	MaxX			80
+	MinY			85
+	MaxY			165	
+	
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+}
+
+Container 0xED0
+{
+	Name			bones3
+	Desc			bones
+	Weight			5
+	
+	Movable			0
+	DecayOnMultis		1
+	RequiresAttention	0
+		
+	Gump			0x009
+	MinX			20
+	MaxX			80
+	MinY			85
+	MaxY			165	
+	
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+}
+
+Container 0xECF
+{
+	Name			bones4
+	Desc			bones
+	Weight			5
+	
+	Movable			0
+	DecayOnMultis		1
+	RequiresAttention	0
+		
+	Gump			0x009
+	MinX			20
+	MaxX			80
+	MinY			85
+	MaxY			165	
+	
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+}
+
+Container 0xECE
+{
+	Name			bones5
+	Desc			bones
+	Weight			5
+	
+	Movable			0
+	DecayOnMultis		1
+	RequiresAttention	0
+		
+	Gump			0x009
+	MinX			20
+	MaxX			80
+	MinY			85
+	MaxY			165	
+	
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+}
+
+Container 0xECD
+{
+	Name			bones6
+	Desc			bones
+	Weight			5
+	
+	Movable			0
+	DecayOnMultis		1
+	RequiresAttention	0
+		
+	Gump			0x009
+	MinX			20
+	MaxX			80
+	MinY			85
+	MaxY			165	
+	
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+}
+
+Container 0xECC
+{
+	Name			bones7
+	Desc			bones
+	Weight			5
+	
+	Movable			0
+	DecayOnMultis		1
+	RequiresAttention	0
+		
+	Gump			0x009
+	MinX			20
+	MaxX			80
+	MinY			85
+	MaxY			165	
+	
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+}
+
+Container 0xECB
+{
+	Name			bones8
+	Desc			bones
+	Weight			5
+	
+	Movable			0
+	DecayOnMultis		1
+	RequiresAttention	0
+		
+	Gump			0x009
+	MinX			20
+	MaxX			80
+	MinY			85
+	MaxY			165	
+	
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+}
+
+Container 0xECA
+{
+	Name			bones9
+	Desc			bones
+	Weight			5
+	
+	Movable			0
+	DecayOnMultis		1
+	RequiresAttention	0
+		
+	Gump			0x009
+	MinX			20
+	MaxX			80
+	MinY			85
+	MaxY			165	
+	
+	CanRemoveScript		container/canRemove
+	CanInsertScript		container/canInsert
+	DestroyScript		container/canDestroy
+}
+
+
 #--=[ Special Containers ]=-----------
 
 Container 0xEFFD
@@ -1093,7 +1286,6 @@
 
 	CanRemoveScript		container/canRemove
 	CanInsertScript		container/canInsert
-	DestroyScript		container/canDestroy
 }
 
 Container 0x966A
@@ -1139,7 +1331,6 @@
 	Script			container/use
 	CanRemoveScript		container/canRemove
 	CanInsertScript		container/canInsert
-	DestroyScript		container/canDestroy
 }
 
 Container 0x2006



From austin at berlios.de  Mon Nov 14 02:18:43 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 02:18:43 +0100
Subject: [Poldistro-svn] r978 - trunk/096/pkg/items/walkOn
Message-ID: <200511140118.jAE1Ihox027700@sheep.berlios.de>

Author: austin
Date: 2005-11-14 02:18:40 +0100 (Mon, 14 Nov 2005)
New Revision: 978

Modified:
   trunk/096/pkg/items/walkOn/itemdesc.cfg
Log:
Removed SaveOnExit 0 lines because the control scripts and method scripts now handle destruction (and allows fields to be placed permanently)

Modified: trunk/096/pkg/items/walkOn/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/walkOn/itemdesc.cfg	2005-11-14 01:16:43 UTC (rev 977)
+++ trunk/096/pkg/items/walkOn/itemdesc.cfg	2005-11-14 01:18:40 UTC (rev 978)
@@ -7,8 +7,7 @@
 	Desc		spider web
 	
 	Movable		0
-	SaveOnExit	0
-
+	
 	ControlScript	spiderWeb/control
 	MethodScript	spiderWeb/methods
 	WalkOnScript	spiderWeb/walkOn
@@ -22,8 +21,7 @@
 	Facing		2
 
 	Movable		0
-	SaveOnExit	0
-
+	
 	ControlScript	fireField/control
 	MethodScript	fireField/methods
 	WalkOnScript	fireField/walkOn
@@ -36,8 +34,7 @@
 	Facing		2
 
 	Movable		0
-	SaveOnExit	0
-
+	
 	ControlScript	fireField/control
 	MethodScript	fireField/methods
 	WalkOnScript	fireField/walkOn
@@ -49,7 +46,6 @@
 	Name		PoisonFieldNS
 	Facing		2
 
-	SaveOnExit	0
 	Movable		0
 
 	ControlScript	poisonField/control
@@ -62,7 +58,6 @@
 	Name		PoisonFieldEW
 	Facing		2
 
-	SaveOnExit	0
 	Movable		0
 
 	ControlScript	poisonField/control



From austin at berlios.de  Mon Nov 14 02:36:53 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 02:36:53 +0100
Subject: [Poldistro-svn] r979 - in trunk/096/pkg/items/moongates: . config systemMoonGate
Message-ID: <200511140136.jAE1ar4f002826@sheep.berlios.de>

Author: austin
Date: 2005-11-14 02:36:40 +0100 (Mon, 14 Nov 2005)
New Revision: 979

Added:
   trunk/096/pkg/items/moongates/config/autoload.cfg
   trunk/096/pkg/items/moongates/systemMoonGate/
   trunk/096/pkg/items/moongates/systemMoonGate/moongateInit.src
   trunk/096/pkg/items/moongates/systemMoonGate/walkOn.src
Removed:
   trunk/096/pkg/items/moongates/autoload.cfg
   trunk/096/pkg/items/moongates/moongateInit.src
   trunk/096/pkg/items/moongates/systemMoongate.src
Modified:
   trunk/096/pkg/items/moongates/itemdesc.cfg
Log:
Sorted files in moongates package.
Moved config/itemdesc.cfg moongates entries to moongates package.

Deleted: trunk/096/pkg/items/moongates/autoload.cfg
===================================================================
--- trunk/096/pkg/items/moongates/autoload.cfg	2005-11-14 01:18:40 UTC (rev 978)
+++ trunk/096/pkg/items/moongates/autoload.cfg	2005-11-14 01:36:40 UTC (rev 979)
@@ -1,9 +0,0 @@
-# $Id$
-
-Autoload moongateInit
-{
-	Script      moongateInit
-	Resistent   1
-	Name        Town Moongate Initializer
-	Priority    0
-}

Added: trunk/096/pkg/items/moongates/config/autoload.cfg
===================================================================
--- trunk/096/pkg/items/moongates/config/autoload.cfg	2005-11-14 01:18:40 UTC (rev 978)
+++ trunk/096/pkg/items/moongates/config/autoload.cfg	2005-11-14 01:36:40 UTC (rev 979)
@@ -0,0 +1,9 @@
+# $Id: autoload.cfg 938 2005-11-07 06:22:45Z muaddiblsd $
+
+Autoload moongateInit
+{
+	Script      moongateInit
+	Resistent   1
+	Name        Town Moongate Initializer
+	Priority    0
+}

Modified: trunk/096/pkg/items/moongates/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/moongates/itemdesc.cfg	2005-11-14 01:18:40 UTC (rev 978)
+++ trunk/096/pkg/items/moongates/itemdesc.cfg	2005-11-14 01:36:40 UTC (rev 979)
@@ -1,11 +1,49 @@
 # System moongate
 Item 0x6201
 {
-    Name            systemmoongate
-    Desc            magical moongate
-    Script          systemMoongate
-    Graphic         0x0F6C
-    Facing          29
-    WalkOnScript    systemMoongate
-    SaveOnExit      0
+	Name           		SystemMoonGate
+	Desc			magical moongate
+       	Graphic			0x0F6C
+	Facing			29
+	
+	SaveOnExit		0
+
+	WalkOnScript		systemMoonGate/walkOn
 }
+
+Item 0xF6C
+{
+	Name			BlueMoonGate
+	Desc			blue moon gate
+	Facing			2
+	
+	Movable			0
+}
+
+Item 0xDDA
+{
+	Name			RedMoonGate
+	Desc			red moon gate
+	Facing			2
+	
+	Movable			0
+}
+
+Item 0x1FD4
+{
+	Name			BlackMoonGate
+	Desc			black moon gate
+	Facing			2
+	
+	Movable			0
+}
+
+Item 0x1fe7
+{
+	Name			WhiteMoonGate
+	Desc			white moon gate
+	
+	Facing			2
+	
+	Movable			0
+}
\ No newline at end of file

Deleted: trunk/096/pkg/items/moongates/moongateInit.src
===================================================================
--- trunk/096/pkg/items/moongates/moongateInit.src	2005-11-14 01:18:40 UTC (rev 978)
+++ trunk/096/pkg/items/moongates/moongateInit.src	2005-11-14 01:36:40 UTC (rev 979)
@@ -1,47 +0,0 @@
-use uo;
-use os;
-
-include ":logger:log";
-
-var mgate_config := ReadConfigFile(":moongates:config/moongate");
-
-program CreateMoongates()
-	var facet_list := GetConfigStringKeys(mgate_config);
-	if( facet_list.errortext )
-        	Log(LOG_ERROR, "Moongate Facet List Failed Config Read '" + GetLogInfo(facet_list) + "'");
-		return 0;
-	endif
-  	syslog( "Creating moongates." );
-	foreach key_name in facet_list
-		var key_elem := FindConfigElem(mgate_config, key_name);
-		if( GetConfigInt(key_elem, "Active") == 1 )
-			var gate_realm := GetConfigString(key_elem, "Realm");
-			var gate_towns := GetConfigStringArray(key_elem, "Town");
-			foreach town_entry in gate_towns
-				var gate := SplitWords(town_entry);
-				RemoveOldGates(gate, gate_realm);
-				CreateNewGates(gate, gate_realm);
-			endforeach
-		endif
-	endforeach
-endprogram
-
-
-function RemoveOldGates(gate, gate_realm)
-	foreach thing in ListItemsNearLocation(CInt(gate[1]), CInt(gate[2]), CInt(gate[3]), 0, gate_realm);
-		if(thing.objtype != 0x887b)
-			DestroyItem(thing);
-		endif
-	endforeach
-	return 1;
-endfunction
-
-
-function CreateNewGates(gate, gate_realm)
-	var moongate := CreateItemAtLocation(CInt(gate[1]), CInt(gate[2]), CInt(gate[3]), "systemmoongate", 1, gate_realm);
-	SetObjProperty(moongate, "City", gate[4]);
-	moongate.facing := 29;
-	moongate.decayAt := 0;
-	moongate.movable := 0;
-	return 1;
-endfunction
\ No newline at end of file

Added: trunk/096/pkg/items/moongates/systemMoonGate/moongateInit.src
===================================================================
--- trunk/096/pkg/items/moongates/systemMoonGate/moongateInit.src	2005-11-14 01:18:40 UTC (rev 978)
+++ trunk/096/pkg/items/moongates/systemMoonGate/moongateInit.src	2005-11-14 01:36:40 UTC (rev 979)
@@ -0,0 +1,47 @@
+use uo;
+use os;
+
+include ":logger:log";
+
+var mgate_config := ReadConfigFile(":moongates:config/moongate");
+
+program CreateMoongates()
+	var facet_list := GetConfigStringKeys(mgate_config);
+	if( facet_list.errortext )
+        	Log(LOG_ERROR, "Moongate Facet List Failed Config Read '" + GetLogInfo(facet_list) + "'");
+		return 0;
+	endif
+  	syslog( "Creating moongates." );
+	foreach key_name in facet_list
+		var key_elem := FindConfigElem(mgate_config, key_name);
+		if( GetConfigInt(key_elem, "Active") == 1 )
+			var gate_realm := GetConfigString(key_elem, "Realm");
+			var gate_towns := GetConfigStringArray(key_elem, "Town");
+			foreach town_entry in gate_towns
+				var gate := SplitWords(town_entry);
+				RemoveOldGates(gate, gate_realm);
+				CreateNewGates(gate, gate_realm);
+			endforeach
+		endif
+	endforeach
+endprogram
+
+
+function RemoveOldGates(gate, gate_realm)
+	foreach thing in ListItemsNearLocation(CInt(gate[1]), CInt(gate[2]), CInt(gate[3]), 0, gate_realm);
+		if(thing.objtype != 0x887b)
+			DestroyItem(thing);
+		endif
+	endforeach
+	return 1;
+endfunction
+
+
+function CreateNewGates(gate, gate_realm)
+	var moongate := CreateItemAtLocation(CInt(gate[1]), CInt(gate[2]), CInt(gate[3]), "systemmoongate", 1, gate_realm);
+	SetObjProperty(moongate, "City", gate[4]);
+	moongate.facing := 29;
+	moongate.decayAt := 0;
+	moongate.movable := 0;
+	return 1;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/items/moongates/systemMoonGate/walkOn.src
===================================================================
--- trunk/096/pkg/items/moongates/systemMoonGate/walkOn.src	2005-11-14 01:18:40 UTC (rev 978)
+++ trunk/096/pkg/items/moongates/systemMoonGate/walkOn.src	2005-11-14 01:36:40 UTC (rev 979)
@@ -0,0 +1,83 @@
+use uo;
+use os;
+use cfgfile;
+
+include ":gumps:include/old/old-gumps";
+
+GFref.x := 50;
+GFref.y := 50;
+
+var townarray := {};
+
+program gumptest(who, item)
+  var city := GetObjProperty(item, "City");
+  if(!city)
+    return;
+  endif
+  var cfg := ReadConfigFile(":moongates:moongate");
+  var lands := Cint(cfg["Facets"].value);
+  if(!lands)
+    return;
+  endif
+  case(city)
+    "Moonglow": townarray := array("Britain", "Jhelom", "Yew", "Minoc", "Trinsic", "Skara Brae", "Magincia");
+    "Britain":  townarray := array("Moonglow", "Jhelom", "Yew", "Minoc", "Trinsic", "Skara Brae", "Magincia");
+    "Jhelom":   townarray := array("Moonglow", "Britain", "Yew", "Minoc", "Trinsic", "Skara Brae", "Magincia");
+    "Yew":      townarray := array("Moonglow", "Britain", "Jhelom", "Minoc", "Trinsic", "Skara Brae", "Magincia");
+    "Minoc":    townarray := array("Moonglow", "Britain", "Jhelom", "Yew", "Trinsic", "Skara Brae", "Magincia");
+    "Trinsic":  townarray := array("Moonglow", "Britain", "Jhelom", "Yew", "Minoc", "Skara Brae", "Magincia");
+    "Skara":    townarray := array("Moonglow", "Britain", "Jhelom", "Yew", "Minoc", "Trinsic", "Magincia");
+    "Magincia": townarray := array("Moonglow", "Britain", "Jhelom", "Yew", "Minoc", "Trinsic", "Skara Brae");
+  endcase
+  OldGFInitGump(0, 0);
+  OldGFPage(0);
+  OldGFResizePic(100, 100, BKGND_STONESLAB, 350, 300);
+  OldGFTextLine(110, 110, 0, "Pick your destination:");
+  OldGFSetRadioGroup(1);
+  OldGFRadioButton(300, 140, 210, 211, 1);
+  OldGFRadioButton(300, 165, 210, 211, 0);
+  OldGFRadioButton(300, 190, 210, 211, 0);
+  OldGFRadioButton(300, 215, 210, 211, 0);
+  OldGFRadioButton(300, 240, 210, 211, 0);
+  OldGFRadioButton(300, 265, 210, 211, 0);
+  OldGFRadioButton(300, 290, 210, 211, 0);
+  OldGFTextLine(330, 140,   0, townarray[1]);
+  OldGFTextLine(330, 165,   0, townarray[2]);
+  OldGFTextLine(330, 190,   0, townarray[3]);
+  OldGFTextLine(330, 215,   0, townarray[4]);
+  OldGFTextLine(330, 240,   0, townarray[5]);
+  OldGFTextLine(330, 265,   0, townarray[6]);
+  OldGFTextLine(330, 290,   0, townarray[7]);
+  var ok := OldGFButtonID(110, 315, 4005, 4007, 1);
+  var cancel := OldGFButtonID(110, 340, 4005, 4007, 1);
+  OldGFTextLine(145, 315,   0, "OKAY");
+  OldGFTextLine(145, 340,   0, "CANCEL");
+  var res := OldGFSendGump(who);
+  if(res[cancel.keyid] || !res[ok.keyid])
+    SendSysMessage(who, "Cancelled.");
+    return;
+  else
+    var holder;
+    foreach thing in (res.keys)
+      if((thing != 0) and (thing != 1025))
+        holder := thing;
+        break;
+      endif
+    endforeach
+    if((who.x == item.x) and (who.y == item.y) and (who.z == item.z))
+      case(townarray[Cint(holder - 2048)])
+        "Moonglow":   MoveCharacterToLocation(who, 4467, 1284,   5, MOVECHAR_FORCELOCATION);
+        "Britain":    MoveCharacterToLocation(who, 1336, 1998,   5, MOVECHAR_FORCELOCATION);
+        "Jhelom":     MoveCharacterToLocation(who, 1499, 3772,   5, MOVECHAR_FORCELOCATION);
+        "Yew":        MoveCharacterToLocation(who,  771,  754,   5, MOVECHAR_FORCELOCATION);
+        "Minoc":      MoveCharacterToLocation(who, 2701,  694,   5, MOVECHAR_FORCELOCATION);
+        "Trinsic":    MoveCharacterToLocation(who, 1828, 2949, -20, MOVECHAR_FORCELOCATION);
+        "Skara Brae": MoveCharacterToLocation(who,  643, 2068,   5, MOVECHAR_FORCELOCATION);
+        "Magincia":   MoveCharacterToLocation(who, 3564, 2141,  33, MOVECHAR_FORCELOCATION);
+      endcase
+    else
+      SendSysMessage(who, "Cancelled.");
+      return;
+    endif
+  endif
+endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/items/moongates/systemMoongate.src
===================================================================
--- trunk/096/pkg/items/moongates/systemMoongate.src	2005-11-14 01:18:40 UTC (rev 978)
+++ trunk/096/pkg/items/moongates/systemMoongate.src	2005-11-14 01:36:40 UTC (rev 979)
@@ -1,83 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-
-include ":gumps:include/old/old-gumps";
-
-GFref.x := 50;
-GFref.y := 50;
-
-var townarray := {};
-
-program gumptest(who, item)
-  var city := GetObjProperty(item, "City");
-  if(!city)
-    return;
-  endif
-  var cfg := ReadConfigFile(":moongates:moongate");
-  var lands := Cint(cfg["Facets"].value);
-  if(!lands)
-    return;
-  endif
-  case(city)
-    "Moonglow": townarray := array("Britain", "Jhelom", "Yew", "Minoc", "Trinsic", "Skara Brae", "Magincia");
-    "Britain":  townarray := array("Moonglow", "Jhelom", "Yew", "Minoc", "Trinsic", "Skara Brae", "Magincia");
-    "Jhelom":   townarray := array("Moonglow", "Britain", "Yew", "Minoc", "Trinsic", "Skara Brae", "Magincia");
-    "Yew":      townarray := array("Moonglow", "Britain", "Jhelom", "Minoc", "Trinsic", "Skara Brae", "Magincia");
-    "Minoc":    townarray := array("Moonglow", "Britain", "Jhelom", "Yew", "Trinsic", "Skara Brae", "Magincia");
-    "Trinsic":  townarray := array("Moonglow", "Britain", "Jhelom", "Yew", "Minoc", "Skara Brae", "Magincia");
-    "Skara":    townarray := array("Moonglow", "Britain", "Jhelom", "Yew", "Minoc", "Trinsic", "Magincia");
-    "Magincia": townarray := array("Moonglow", "Britain", "Jhelom", "Yew", "Minoc", "Trinsic", "Skara Brae");
-  endcase
-  OldGFInitGump(0, 0);
-  OldGFPage(0);
-  OldGFResizePic(100, 100, BKGND_STONESLAB, 350, 300);
-  OldGFTextLine(110, 110, 0, "Pick your destination:");
-  OldGFSetRadioGroup(1);
-  OldGFRadioButton(300, 140, 210, 211, 1);
-  OldGFRadioButton(300, 165, 210, 211, 0);
-  OldGFRadioButton(300, 190, 210, 211, 0);
-  OldGFRadioButton(300, 215, 210, 211, 0);
-  OldGFRadioButton(300, 240, 210, 211, 0);
-  OldGFRadioButton(300, 265, 210, 211, 0);
-  OldGFRadioButton(300, 290, 210, 211, 0);
-  OldGFTextLine(330, 140,   0, townarray[1]);
-  OldGFTextLine(330, 165,   0, townarray[2]);
-  OldGFTextLine(330, 190,   0, townarray[3]);
-  OldGFTextLine(330, 215,   0, townarray[4]);
-  OldGFTextLine(330, 240,   0, townarray[5]);
-  OldGFTextLine(330, 265,   0, townarray[6]);
-  OldGFTextLine(330, 290,   0, townarray[7]);
-  var ok := OldGFButtonID(110, 315, 4005, 4007, 1);
-  var cancel := OldGFButtonID(110, 340, 4005, 4007, 1);
-  OldGFTextLine(145, 315,   0, "OKAY");
-  OldGFTextLine(145, 340,   0, "CANCEL");
-  var res := OldGFSendGump(who);
-  if(res[cancel.keyid] || !res[ok.keyid])
-    SendSysMessage(who, "Cancelled.");
-    return;
-  else
-    var holder;
-    foreach thing in (res.keys)
-      if((thing != 0) and (thing != 1025))
-        holder := thing;
-        break;
-      endif
-    endforeach
-    if((who.x == item.x) and (who.y == item.y) and (who.z == item.z))
-      case(townarray[Cint(holder - 2048)])
-        "Moonglow":   MoveCharacterToLocation(who, 4467, 1284,   5, MOVECHAR_FORCELOCATION);
-        "Britain":    MoveCharacterToLocation(who, 1336, 1998,   5, MOVECHAR_FORCELOCATION);
-        "Jhelom":     MoveCharacterToLocation(who, 1499, 3772,   5, MOVECHAR_FORCELOCATION);
-        "Yew":        MoveCharacterToLocation(who,  771,  754,   5, MOVECHAR_FORCELOCATION);
-        "Minoc":      MoveCharacterToLocation(who, 2701,  694,   5, MOVECHAR_FORCELOCATION);
-        "Trinsic":    MoveCharacterToLocation(who, 1828, 2949, -20, MOVECHAR_FORCELOCATION);
-        "Skara Brae": MoveCharacterToLocation(who,  643, 2068,   5, MOVECHAR_FORCELOCATION);
-        "Magincia":   MoveCharacterToLocation(who, 3564, 2141,  33, MOVECHAR_FORCELOCATION);
-      endcase
-    else
-      SendSysMessage(who, "Cancelled.");
-      return;
-    endif
-  endif
-endprogram
\ No newline at end of file



From austin at berlios.de  Mon Nov 14 02:55:15 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 02:55:15 +0100
Subject: [Poldistro-svn] r980 - trunk/096/config
Message-ID: <200511140155.jAE1tFVC009365@sheep.berlios.de>

Author: austin
Date: 2005-11-14 02:55:11 +0100 (Mon, 14 Nov 2005)
New Revision: 980

Modified:
   trunk/096/config/itemdesc.cfg
Log:


Modified: trunk/096/config/itemdesc.cfg
===================================================================
--- trunk/096/config/itemdesc.cfg	2005-11-14 01:36:40 UTC (rev 979)
+++ trunk/096/config/itemdesc.cfg	2005-11-14 01:55:11 UTC (rev 980)
@@ -269,42 +269,6 @@
 	VendorBuysFor		3
 }
 
-Item 0xF6C
-{
-	Name			bluemoongate
-	Facing			2
-	WalkOnScript		moongate
-	SaveOnExit		0
-	Movable			0
-}
-
-Item 0xdda
-{
-	Name			redmoongate
-	Facing			2
-	WalkOnScript		moongate
-	SaveOnExit		0
-	Movable			0
-}
-
-Item 0x1fd4
-{
-	Name			blackmoongate
-	Facing			2
-	WalkOnScript		moongate
-	SaveOnExit		0
-	Movable			0
-}
-
-Item 0x1fe7
-{
-	Name			whitemoongate
-	Facing			2
-	WalkOnScript		moongate
-	SaveOnExit		0
-	Movable			0
-}
-
 Item 0x14fb
 {
 	Name			lockpick
@@ -833,182 +797,3 @@
 	Furniture		1
 }
 
-Container 0xed2
-{
-	Name			bones
-	Desc			bones
-	Gump			0x009
-	MinX			20
-	MaxX			80
-	MinY			85
-	MaxY			165
-	RequiresAttention	0
-	DecayOnMultis		1
-	SaveOnExit		0
-	Movable			0
-	Weight			5
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}
-
-Container 0xed1
-{
-	Name			bones2
-	Desc			bones
-	Gump			0x009
-	MinX			20
-	MaxX			80
-	MinY			85
-	MaxY			165
-	RequiresAttention	0
-	DecayOnMultis		1
-	SaveOnExit		0
-	Movable			0
-	Weight			5
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}
-
-Container 0xed0
-{
-	Name			bones3
-	Desc			bones
-	Gump			0x009
-	MinX			20
-	MaxX			80
-	MinY			85
-	MaxY			165
-	RequiresAttention	0
-	DecayOnMultis		1
-	SaveOnExit		0
-	Movable			0
-	Weight			5
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}
-
-Container 0xecf
-{
-	Name			bones4
-	Desc			bones
-	Gump			0x009
-	MinX			20
-	MaxX			80
-	MinY			85
-	MaxY			165
-	RequiresAttention	0
-	DecayOnMultis		1
-	SaveOnExit		0
-	Movable			0
-	Weight			5
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}
-
-Container 0xece
-{
-	Name			bones5
-	Desc			bones
-	Gump			0x009
-	MinX			20
-	MaxX			80
-	MinY			85
-	MaxY			165
-	RequiresAttention	0
-	DecayOnMultis		1
-	SaveOnExit		0
-	Movable			0
-	Weight			5
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}
-
-Container 0xecd
-{
-	Name			bones6
-	Desc			bones
-	Gump			0x009
-	MinX			20
-	MaxX			80
-	MinY			85
-	MaxY			165
-	RequiresAttention	0
-	DecayOnMultis		1
-	SaveOnExit		0
-	Movable			0
-	Weight			5
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}
-
-Container 0xecc
-{
-	Name			bones7
-	Desc			bones
-	Gump			0x009
-	MinX			20
-	MaxX			80
-	MinY			85
-	MaxY			165
-	RequiresAttention	0
-	DecayOnMultis		1
-	SaveOnExit		0
-	Movable			0
-	Weight			5
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}
-
-Container 0xecb
-{
-	Name			bones8
-	Desc			bones
-	Gump			0x009
-	MinX			20
-	MaxX			80
-	MinY			85
-	MaxY			165
-	RequiresAttention	0
-	DecayOnMultis		1
-	SaveOnExit		0
-	Movable			0
-	Weight			5
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}
-
-Container 0xeca
-{
-	Name			bones9
-	Desc			bones
-	Gump			0x009
-	MinX			20
-	MaxX			80
-	MinY			85
-	MaxY			165
-	RequiresAttention	0
-	DecayOnMultis		1
-	SaveOnExit		0
-	Movable			0
-	Weight			5
-	CanInsertScript		::canInsert
-	OnInsertScript		::onInsert
-	CanRemoveScript		::canRemove
-	OnRemoveScript		::onRemove
-}



From austin at berlios.de  Mon Nov 14 02:58:20 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 02:58:20 +0100
Subject: [Poldistro-svn] r981 - in trunk/096: pkg/utils/scheduler pkg/utils/scheduler/config pkg/utils/scheduler/include scripts scripts/include
Message-ID: <200511140158.jAE1wKUV010427@sheep.berlios.de>

Author: austin
Date: 2005-11-14 02:58:17 +0100 (Mon, 14 Nov 2005)
New Revision: 981

Added:
   trunk/096/pkg/utils/scheduler/config/
   trunk/096/pkg/utils/scheduler/config/icp.cfg
   trunk/096/pkg/utils/scheduler/start.src
Modified:
   trunk/096/pkg/utils/scheduler/include/scheduler.inc
   trunk/096/pkg/utils/scheduler/scheduler.src
   trunk/096/scripts/include/time.inc
   trunk/096/scripts/start.src
Log:
Made scheduler look for pkg/config/autoLoad.cfg rather than pkg/autoload.cfg

Added icp.cfg to scheduler package.

Made scheduler package start its self up in its own start.src rather than scripts/start.src.



Added: trunk/096/pkg/utils/scheduler/config/icp.cfg
===================================================================
--- trunk/096/pkg/utils/scheduler/config/icp.cfg	2005-11-14 01:55:11 UTC (rev 980)
+++ trunk/096/pkg/utils/scheduler/config/icp.cfg	2005-11-14 01:58:17 UTC (rev 981)
@@ -0,0 +1,13 @@
+ICP Register
+{
+	Name		Scheduler
+	Version		1.0
+
+	Description	Handles startup scripts.
+
+	Creator		Hesinde-Team
+	Email		hesinde at elitecoder.net
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+}
\ No newline at end of file

Modified: trunk/096/pkg/utils/scheduler/include/scheduler.inc
===================================================================
--- trunk/096/pkg/utils/scheduler/include/scheduler.inc	2005-11-14 01:55:11 UTC (rev 980)
+++ trunk/096/pkg/utils/scheduler/include/scheduler.inc	2005-11-14 01:58:17 UTC (rev 981)
@@ -55,10 +55,10 @@
  *
  */
 function Wait(what, time := SCHED_TIMEOUT)
-	while(Wait_For_Event(time) != what)
+	while( Wait_For_Event(time) != what )
 	endwhile
 
-	return;
+	return 1;
 endfunction
 
 
@@ -82,5 +82,5 @@
 	endif
 	sched.sendevent(what);
 
-	return;
+	return 1;
 endfunction

Modified: trunk/096/pkg/utils/scheduler/scheduler.src
===================================================================
--- trunk/096/pkg/utils/scheduler/scheduler.src	2005-11-14 01:55:11 UTC (rev 980)
+++ trunk/096/pkg/utils/scheduler/scheduler.src	2005-11-14 01:58:17 UTC (rev 981)
@@ -16,14 +16,14 @@
 
 program StartScheduler()
 	var cfg;
-	var glob_desc := { };
+	var glob_desc := array{};
 
 	set_script_option(SCRIPTOPT_NO_RUNAWAY, 1);
 	SetGlobalProperty(TEMPPROP_SCHED_PID, GetPID());
 	print("Starting script scheduler...");
-	foreach pkg in Packages()
-		cfg := ReadConfigFile(":" + pkg.name + ":autoload");
-		if( TypeOf(cfg) == "ConfigFileRef" )
+	foreach pkg in ( Packages() )
+		cfg := ReadConfigFile(":" + pkg.name + ":config/autoLoad");
+		if ( cfg != error )
 			Process(pkg, cfg, glob_desc);
 		endif
 	endforeach
@@ -33,18 +33,18 @@
 	print("All automatically loaded scripts running.");
 	EraseGlobalProperty(TEMPPROP_SCHED_PID);
 
-	return;
+	return 1;
 endprogram
 
 function Process(byref pkg, byref cfg, byref glob_desc)
-	foreach entry in GetConfigStringKeys(cfg)
+	foreach entry in ( GetConfigStringKeys(cfg) )
 		var script;
 		var desc := struct;
 		var elem := FindConfigElem(cfg, entry);
 
 		print("Loading " + elem.Name + "...");
 		script := start_script(":" + pkg.name + ":" + elem.Script);
-		if (!script)
+		if ( !script )
 			Exception("Scheduler::Process(): Couldn't start auto script '" + pkg.Name + ":" + elem.Script + "'");
 		else
 			desc.+Name := elem.Name;
@@ -52,20 +52,20 @@
 			desc.+Resistent := elem.Resistent;
 			desc.+Priority := elem.Priority;
 			desc.+PID := script.pid;
-			glob_desc.append(desc);
+			glob_desc.Append(desc);
 		endif
 	endforeach
 
-	return;
+	return 1;
 endfunction
 
 
 function Sort(byref scripts)
 	var i, j;
 
-	for (i := 1; i <= scripts.size(); i := i + 1)
-		for (j := scripts.size(); j > i; j := j - 1)
-			if (scripts[j].Priority >= scripts[j - 1].Priority)
+	for ( i := 1; i <= scripts.Size(); i := i + 1 )
+		for ( j := scripts.Size(); j > i; j := j - 1 )
+			if ( scripts[j].Priority >= scripts[j - 1].Priority )
 				var temp := scripts[j];
 				scripts[j] := scripts[j - 1];
 				scripts[j - 1] := temp;
@@ -73,25 +73,25 @@
 		endfor
 	endfor
 
-	return;
+	return 1;
 endfunction
 
 
 function Schedule(byref scripts)
 	var start := 1;
-	while (scripts.size() >= start)
+	while ( scripts.Size() >= start )
 		var script := scripts[start];
 
 		print("Starting " + script.Name + "...");
 		GetProcess(script.PID).sendevent(SCHED_LOAD);
-		if (!script.Resistent)
+		if ( !script.Resistent )
 			Wait(SCHED_DONE);
-			scripts.erase(start);
+			scripts.Erase(start);
 		else
 			Wait(SCHED_LOOP);
 			start := start + 1;
 		endif
 	endwhile
 
-	return;
+	return 1;
 endfunction

Added: trunk/096/pkg/utils/scheduler/start.src
===================================================================
--- trunk/096/pkg/utils/scheduler/start.src	2005-11-14 01:55:11 UTC (rev 980)
+++ trunk/096/pkg/utils/scheduler/start.src	2005-11-14 01:58:17 UTC (rev 981)
@@ -0,0 +1,26 @@
+/* $Id: start.src 937 2005-11-07 01:20:20Z austin $
+ *
+ * Purpose
+ * This script is called when the server starts up.
+ * It will start the script scheduler which will in turn start other start scripts.
+ *
+ * Parameters: None
+ *
+ * Return value: Ignored
+ *
+ */
+use uo;
+use os;
+
+include ":logger:exception";
+include ":logger:log";
+include "include/time";
+
+program StartServer()
+	Log(LOG_MAIN, "Server started.");
+	if ( !start_script("scheduler") )
+		Exception("::start:StartServer(): Couldn't start the script scheduler.");
+	endif
+	
+	return 1;
+endprogram

Modified: trunk/096/scripts/include/time.inc
===================================================================
--- trunk/096/scripts/include/time.inc	2005-11-14 01:55:11 UTC (rev 980)
+++ trunk/096/scripts/include/time.inc	2005-11-14 01:58:17 UTC (rev 981)
@@ -7,6 +7,7 @@
 use uo;
 
 include ":config:config";
+include "include/properties";
 
 enum TIME_UNITS
 	// Base unit: Millisecond

Modified: trunk/096/scripts/start.src
===================================================================
--- trunk/096/scripts/start.src	2005-11-14 01:55:11 UTC (rev 980)
+++ trunk/096/scripts/start.src	2005-11-14 01:58:17 UTC (rev 981)
@@ -1,25 +1,8 @@
-/* $Id$
+/*
+ * $Id$
  *
- * Purpose
- * This script is called when the server starts up.
- * It will start the script scheduler which will in turn start other start scripts.
- *
- * Parameters: None
- *
- * Return value: Ignored
- *
  */
-use uo;
-use os;
 
-include ":logger:exception";
-include ":logger:log";
-
-program StartServer()
-	Log(LOG_MAIN, "Server started.");
-	if ( !start_script(":scheduler:scheduler") )
-		Exception("::start:StartServer(): Couldn't start the script scheduler");
-	endif
-	
+program GlobalStartup()
 	return 1;
 endprogram



From austin at berlios.de  Mon Nov 14 05:22:36 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 05:22:36 +0100
Subject: [Poldistro-svn] r982 - trunk/096/config
Message-ID: <200511140422.jAE4MacT031062@sheep.berlios.de>

Author: austin
Date: 2005-11-14 05:22:31 +0100 (Mon, 14 Nov 2005)
New Revision: 982

Modified:
   trunk/096/config/itemdesc.cfg
Log:
Removed recall runes

Modified: trunk/096/config/itemdesc.cfg
===================================================================
--- trunk/096/config/itemdesc.cfg	2005-11-14 01:58:17 UTC (rev 981)
+++ trunk/096/config/itemdesc.cfg	2005-11-14 04:22:31 UTC (rev 982)
@@ -109,26 +109,6 @@
 	Movable			0
 }
 
-Item 0x1f14
-{
-	Name			recallrune
-	Desc			recall rune
-	Script			rune
-	VendorSellsFor		10
-	VendorBuysFor		5
-	RequiresAttention	0
-}
-
-Item 0x1f15
-{
-	Name			recallrune2
-	Desc			recall rune
-	Script			rune
-	VendorSellsFor		10
-	VendorBuysFor		5
-	RequiresAttention	0
-}
-
 Spellbook 0x2252
 {
 	Name			PaladinSpellbook



From muaddiblsd at berlios.de  Mon Nov 14 07:49:26 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Mon, 14 Nov 2005 07:49:26 +0100
Subject: [Poldistro-svn] r983 - in trunk/096: config pkg/utils pkg/utils/inns pkg/utils/inns/config pkg/utils/inns/include scripts/include/OLD scripts/misc
Message-ID: <200511140649.jAE6nQnL010264@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-14 07:49:18 +0100 (Mon, 14 Nov 2005)
New Revision: 983

Added:
   trunk/096/pkg/utils/inns/
   trunk/096/pkg/utils/inns/config/
   trunk/096/pkg/utils/inns/config/icp.cfg
   trunk/096/pkg/utils/inns/config/inns-britannia.cfg
   trunk/096/pkg/utils/inns/config/inns-britannia_alt.cfg
   trunk/096/pkg/utils/inns/include/
   trunk/096/pkg/utils/inns/include/innFunctions.inc
   trunk/096/pkg/utils/inns/pkg.cfg
Removed:
   trunk/096/config/innlocation.cfg
   trunk/096/scripts/include/OLD/innCheck.inc
Modified:
   trunk/096/scripts/misc/logofftest.src
Log:
Packaged inn location checks to use in logofftest.src.
Updated logofftest.src for camping and inn checks.
Made default inn files for britannia and britannia_alt.


Deleted: trunk/096/config/innlocation.cfg
===================================================================
--- trunk/096/config/innlocation.cfg	2005-11-14 04:22:31 UTC (rev 982)
+++ trunk/096/config/innlocation.cfg	2005-11-14 06:49:18 UTC (rev 983)
@@ -1,365 +0,0 @@
-# $Id$
-#
-#
-# Britain
-
-region Northside Inn 1
-{
-rect 1455 1511 1473 1529
-}
-
-region Northside Inn 2
-{
-rect 1473 1511 1481 1521
-}
-
-region Wayfarers Inn
-{
-rect 1575 1583 1601 1601
-}
-
-region Sweet Dreams Inn 1
-{
-rect 1491 1601 1500 1626
-}
-
-region Sweet Dreams Inn 2
-{
-rect 1500 1609 1508 1626
-}
-
-region The Cats Lair 1
-{
-rect 1424 1712 1430 1734
-}
-
-region The Cats Lair 2
-{
-rect 1431 1712 1438 1722
-}
-
-region The Blue Boar 1
-{
-rect 1486 1684 1493 1690
-}
-
-region The Blue Boar 2
-{
-rect 1494 1676 1500 1698
-}
-
-region The Salty Dog 1
-{
-rect 1616 1576 1622 1583
-}
-
-region The Salty Dog 2
-{
-rect 1608 1584 1630 1590
-}
-
-region The Unicorn's Horn 1
-{
-rect 1544 1760 1566 1766
-}
-
-region The Unicorn's Horn 2
-{
-rect 1544 1767 1558 1774
-}
-
-# Moonglow
-
-region Student Hostel 1
-{
-rect 4475 1059 4493 1069
-}
-
-region Student Hostel 2
-{
-rect 4479 1069 4489 1073
-}
-
-region Student Hostel 3
-{
-rect 4479 1055 4489 1059
-}
-
-region The Scholar's Inn 1
-{
-rect 4383 1151 4393 1177
-}
-
-region The Scholar's Inn 2
-{
-rect 4393 1159 4399 1169
-}
-
-region The Scholar's Inn 3
-{
-rect 4399 1151 4409 1169
-}
-
-# Nujel'm
-
-region Restful Slumber
-{
-rect 3727 1287 3753 1344
-
-region The Silver Bow 1
-{
-rect 3728 1248 3742 1262
-}
-
-region The Silver Bow 2
-{
-rect 3728 1263 3750 1270
-}
-
-region The Silver Bow 3
-{
-rect 3744 1247 3750 1254
-}
-
-region Mystical Spirits 1
-{
-rect 3760 1216 3770 1238
-}
-
-region Mystical Spirits 2
-{
-rect 3771 1220 3774 1234
-}
-
-region Mystical Spirits 3
-{
-rect 3775 1223 3783 1230
-}
-
-# Skara Brae
-
-region The Falconer's Inn 1
-{
-rect 590 2238 626 2257
-}
-
-region The Falconer's Inn 2
-{
-rect 599 2230 617 2239
-}
-
-region The Shattered Skull 1
-{
-rect 552 2168 566 2190
-}
-
-region The Shattered Skull 2
-{
-rect 568 2168 574 2174
-}
-
-# Trinsic
-
-region The Traveller's Inn
-{
-rect 1833 2727 1857 2745
-}
-
-region The Rusty Anchor
-{
-rect 2023 2783 2040 2813
-}
-
-region The Keg and Anchor 1
-{
-rect 1923 2786 1933 2806
-}
-
-region The Keg and Anchor 2
-{
-rect 1933 2786 1940 2799
-}
-
-# Vesper
-# The Ironwood Inn
-
-region The Ironwood Inn 1
-{
-rect 2775 951 2793 985
-}
-
-region The Ironwood Inn 2
-{
-rect 2767 959 2775 977
-}
-
-region Vesper Youth Hostel 1
-{
-rect 2952 863 2969 897
-}
-
-region Vesper Youth Hostel 2
-{
-rect 2969 871 2977 889
-}
-
-region The Marsh Hall 1
-{
-rect 2892 901 2906 918
-}
-
-region
-{
-rect 2908 904 2914 910
-}
-
-# Wind
-
-region Seeker's Inn
-{
-rect 5303 28 5319 43
-}
-
-region Wind Inn
-{
-rect 5159 15 5184 40
-}
-
-region Bunkhouse
-{
-rect 5304 295317 41
-}
-
-# Papua
-
-region The Just Inn
-{
-rect 5756 3148 5787 3175
-}
-
-# Delucia
-
-region Abandoned Inn
-{
-rect 5184 4054 5203 4072
-}
-
-# Bucaneer's Den
-# The Peg Leg Inn
-
-region The Peg Leg Inn 1
-{
-rect 2711 2079 2729 2097
-}
-
-region The Peg Leg Inn 2
-{
-rect 2711 2097 2721 2105
-}
-
-region The Pirate's Plunder 1
-{
-rect 2664 2232 2686 2239
-}
-
-region The Pirate's Plunder 2
-{
-rect 2672 2240 2686 2246
-}
-
-# Magincia
-
-region The Stag & Lion Inn 1
-{
-rect 3679 2151 3704 2160
-}
-
-region The Stag & Lion Inn 2
-{
-rect 3687 2160 3704 2172
-}
-
-region The Stag & Lion Inn 3
-{
-rect 3695 2172 3704 2176
-}
-
-region The Great Horns Tavern
-{
-rect 3720 22163735 2230
-}
-
-# Serpent's Hold
-
-region Broken Arrow Inn
-{
-rect 2959 3399 2976 3416
-}
-
-region The Dog and Lion Pub
-{
-rect 2968 3416 2974 3430
-}
-
-# Jhelom
-
-region Morning Star Inn 1
-{
-rect 1351 3799 1369 3833
-}
-
-region Morning Star Inn 2
-{
-rect 1369 3807 1377 3825
-}
-
-region The Horse's Head 1
-{
-rect 1432 3768 1439 3774
-}
-
-region The Horse's Head 2
-{
-rect 1440 3768 1462 3782
-}
-
-# Delucia
-
-region The Barley Inn
-{
-rect 5194 4060 5204 4073
-}
-
-# Minoc
-
-region The Barnacle Tavern 1
-{
-RECT 2456 396 2498 406
-}
-
-region The Barnacle Tavern 2
-{
-RECT 2464 406 2474 414
-}
-
-region The Barnacle Tavern 3
-{
-RECT 2480 406 2490 414
-}
-
-# Ocllo
-
-region Bountiful Harvest Inn
-{
-RECT 3662 2608 3681 2625
-}
-
-region The Albatross 1
-{
-rect 3664 2640 3671 2654
-}
-
-region The Albatross 2
-{
-rect
-} 3671 2648 3678 2654
\ No newline at end of file

Added: trunk/096/pkg/utils/inns/config/icp.cfg
===================================================================
--- trunk/096/pkg/utils/inns/config/icp.cfg	2005-11-14 04:22:31 UTC (rev 982)
+++ trunk/096/pkg/utils/inns/config/icp.cfg	2005-11-14 06:49:18 UTC (rev 983)
@@ -0,0 +1,19 @@
+# $Id$
+#
+#
+ICP Register
+{
+	Name		Inns
+	Version		1.0
+	Description	Inn Location Package
+
+	Creator		MuadDib
+	C_Email		muaddib at lostsoulsshard.org
+	Maintainer	Distro
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+
+}


Property changes on: trunk/096/pkg/utils/inns/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/inns/config/inns-britannia.cfg
===================================================================
--- trunk/096/pkg/utils/inns/config/inns-britannia.cfg	2005-11-14 04:22:31 UTC (rev 982)
+++ trunk/096/pkg/utils/inns/config/inns-britannia.cfg	2005-11-14 06:49:18 UTC (rev 983)
@@ -0,0 +1,163 @@
+# $Id$
+#
+#
+
+Region Britain_Northside_Inn_1
+{
+	Rect	1455 1511 1471 1527
+}
+
+Region Britain_Northside_Inn_2
+{
+	Rect	1470 1511 1479 1519
+}
+
+Region Britain_Wayfarers_Inn
+{
+	Rect	1575 1583 1599 1599
+}
+
+Region Britain_Sweet_Dreams_Inn
+{
+	Rect	1491 1601 1507 1625
+}
+
+Region Moonglow_Student_Hostel_1
+{
+	Rect	4475 1059 4491 1067
+}
+
+Region Moonglow_Student_Hostel_2
+{
+	Rect	4479 1055 4487 1071
+}
+
+Region Moonglow_The_Scholars_Inn_1
+{
+	Rect	4383 1151 4391 1175
+}
+
+Region Moonglow_The_Scholars_Inn_2
+{
+	Rect	4391 1159 4407 1167
+}
+
+Region Moonglow_The_Scholars_Inn_3
+{
+	Rect	4399 1151 4407 1159
+}
+
+Region Nujelm_Restful_Slumber_1
+{
+	Rect	3727 1287 3743 1343
+}
+
+Region Nujelm_Restful_Slumber_2
+{
+	Rect	3743 1287 3751 1303
+}
+
+Region Nujelm_Restful_Slumber_3
+{
+	Rect	3743 1327 3751 1343
+}
+
+Region Skara_Brae_The_Falconers_Inn_1
+{
+	Rect	590 2238 623 2255
+}
+
+Region Skara_Brae_The_Falconers_Inn_2
+{
+	Rect	599 2231 615 2239
+}
+
+Region Trinsic_The_Travellers_Inn
+{
+	Rect	1833 2727 1855 2743
+}
+
+Region Trinsic_The_Rusty_Anchor
+{
+	Rect	2023 2783 2039 2812
+}
+
+Region Vesper_The_Ironwood_Inn_1
+{
+	Rect	2775 951 2791 983
+}
+
+Region Vesper_The Ironwood Inn 2
+{
+	Rect	2767 959 2775 977
+}
+
+Region Vesper_Youth_Hostel_1
+{
+	Rect	2952 863 2967 895
+}
+
+Region Vesper_Youth_Hostel_2
+{
+	Rect	2967 871 2975 887
+}
+
+Region Wind_Inn
+{
+	Rect	5159 15 5184 40
+}
+
+Region Wind_Bunkhouse
+{
+	Rect	5303 28 5318 40
+}
+
+Region Papua_The_Just_Inn
+{
+	Rect	5756 3149 5783 3168
+}
+
+Region Delucia_Abandoned_Inn
+{
+	Rect	5184 4054 5203 4072
+}
+
+Region Bucs_The_Peg_Leg_Inn_1
+{
+	Rect	2711 2079 2727 2095
+}
+
+Region Bucs_The_Peg_Leg_Inn_2
+{
+	Rect	2711 2095 2720 2104
+}
+
+Region Magincia_The_Stag_and_Lion_Inn_1
+{
+	Rect	3679 2151 3703 2175
+}
+
+Region Serpents_Hold_Broken_Arrow_Inn
+{
+	Rect	2959 3399 2975 3415
+}
+
+Region Jhelom_Morning_Star_Inn_1
+{
+	Rect	1351 3799 1367 3831
+}
+
+Region Jhelom_Morning_Star_Inn_2
+{
+	Rect	1367 3807 1375 3823
+}
+
+Region Minoc_The_Barnacle_Tavern
+{
+	Rect	2456 396 2496 413
+}
+
+Region Ocllo_Bountiful_Harvest_Inn
+{
+	Rect	3662 2608 3679 2623
+}
\ No newline at end of file


Property changes on: trunk/096/pkg/utils/inns/config/inns-britannia.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/inns/config/inns-britannia_alt.cfg
===================================================================
--- trunk/096/pkg/utils/inns/config/inns-britannia_alt.cfg	2005-11-14 04:22:31 UTC (rev 982)
+++ trunk/096/pkg/utils/inns/config/inns-britannia_alt.cfg	2005-11-14 06:49:18 UTC (rev 983)
@@ -0,0 +1,163 @@
+# $Id$
+#
+#
+
+Region Britain_Northside_Inn_1
+{
+	Rect	1455 1511 1471 1527
+}
+
+Region Britain_Northside_Inn_2
+{
+	Rect	1470 1511 1479 1519
+}
+
+Region Britain_Wayfarers_Inn
+{
+	Rect	1575 1583 1599 1599
+}
+
+Region Britain_Sweet_Dreams_Inn
+{
+	Rect	1491 1601 1507 1625
+}
+
+Region Moonglow_Student_Hostel_1
+{
+	Rect	4475 1059 4491 1067
+}
+
+Region Moonglow_Student_Hostel_2
+{
+	Rect	4479 1055 4487 1071
+}
+
+Region Moonglow_The_Scholars_Inn_1
+{
+	Rect	4383 1151 4391 1175
+}
+
+Region Moonglow_The_Scholars_Inn_2
+{
+	Rect	4391 1159 4407 1167
+}
+
+Region Moonglow_The_Scholars_Inn_3
+{
+	Rect	4399 1151 4407 1159
+}
+
+Region Nujelm_Restful_Slumber_1
+{
+	Rect	3727 1287 3743 1343
+}
+
+Region Nujelm_Restful_Slumber_2
+{
+	Rect	3743 1287 3751 1303
+}
+
+Region Nujelm_Restful_Slumber_3
+{
+	Rect	3743 1327 3751 1343
+}
+
+Region Skara_Brae_The_Falconers_Inn_1
+{
+	Rect	590 2238 623 2255
+}
+
+Region Skara_Brae_The_Falconers_Inn_2
+{
+	Rect	599 2231 615 2239
+}
+
+Region Trinsic_The_Travellers_Inn
+{
+	Rect	1833 2727 1855 2743
+}
+
+Region Trinsic_The_Rusty_Anchor
+{
+	Rect	2023 2783 2039 2812
+}
+
+Region Vesper_The_Ironwood_Inn_1
+{
+	Rect	2775 951 2791 983
+}
+
+Region Vesper_The Ironwood Inn 2
+{
+	Rect	2767 959 2775 977
+}
+
+Region Vesper_Youth_Hostel_1
+{
+	Rect	2952 863 2967 895
+}
+
+Region Vesper_Youth_Hostel_2
+{
+	Rect	2967 871 2975 887
+}
+
+Region Wind_Inn
+{
+	Rect	5159 15 5184 40
+}
+
+Region Wind_Bunkhouse
+{
+	Rect	5303 28 5318 40
+}
+
+Region Papua_The_Just_Inn
+{
+	Rect	5756 3149 5783 3168
+}
+
+Region Delucia_Abandoned_Inn
+{
+	Rect	5184 4054 5203 4072
+}
+
+Region Bucs_The_Peg_Leg_Inn_1
+{
+	Rect	2711 2079 2727 2095
+}
+
+Region Bucs_The_Peg_Leg_Inn_2
+{
+	Rect	2711 2095 2720 2104
+}
+
+Region Magincia_The_Stag_and_Lion_Inn_1
+{
+	Rect	3679 2151 3703 2175
+}
+
+Region Serpents_Hold_Broken_Arrow_Inn
+{
+	Rect	2959 3399 2975 3415
+}
+
+Region Jhelom_Morning_Star_Inn_1
+{
+	Rect	1351 3799 1367 3831
+}
+
+Region Jhelom_Morning_Star_Inn_2
+{
+	Rect	1367 3807 1375 3823
+}
+
+Region Minoc_The_Barnacle_Tavern
+{
+	Rect	2456 396 2496 413
+}
+
+Region Ocllo_Bountiful_Harvest_Inn
+{
+	Rect	3662 2608 3679 2623
+}
\ No newline at end of file


Property changes on: trunk/096/pkg/utils/inns/config/inns-britannia_alt.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/inns/include/innFunctions.inc
===================================================================
--- trunk/096/pkg/utils/inns/include/innFunctions.inc	2005-11-14 04:22:31 UTC (rev 982)
+++ trunk/096/pkg/utils/inns/include/innFunctions.inc	2005-11-14 06:49:18 UTC (rev 983)
@@ -0,0 +1,18 @@
+use uo;
+use cfgfile;
+
+function isInInn(who)
+	var inn_config := ReadConfigFile(":inns:inns-"+who.realm);
+	var inn_locations := GetConfigStringKeys(inn_config);
+	foreach inn in inn_locations
+		var element :=  inn_config[inn];
+		var rect := element.rect;
+		rect := SplitWords(rect);
+		if( (who.x >= CInt(rect[1])) && (who.x <= CInt(rect[3])) && (who.y >= CInt(rect[2])) && (who.y <= CInt(rect[4])) )
+			return 1;
+			break;
+		endif
+	endforeach
+
+	return 0;
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/utils/inns/include/innFunctions.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/inns/pkg.cfg
===================================================================
--- trunk/096/pkg/utils/inns/pkg.cfg	2005-11-14 04:22:31 UTC (rev 982)
+++ trunk/096/pkg/utils/inns/pkg.cfg	2005-11-14 06:49:18 UTC (rev 983)
@@ -0,0 +1,17 @@
+# $Id$
+#
+#
+Enabled		1
+Name		inns
+Version		1.0
+
+CoreRequired	92
+
+Creator		MuadDib
+Email		muaddib at lostsoulsshard.org
+
+Maintainer	Distro Team
+Email		distro at polserver.com
+
+#Requires none
+#conflicts	none


Property changes on: trunk/096/pkg/utils/inns/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/096/scripts/include/OLD/innCheck.inc
===================================================================
--- trunk/096/scripts/include/OLD/innCheck.inc	2005-11-14 04:22:31 UTC (rev 982)
+++ trunk/096/scripts/include/OLD/innCheck.inc	2005-11-14 06:49:18 UTC (rev 983)
@@ -1,22 +0,0 @@
-use uo;
-use os;
-use cfgfile;
-use util;
-
-function Inncheck(character)
-
-  var element, rect;
-  var cfgfile := ReadConfigFile("::innlocation");
-  var entries := GetConfigStringKeys(cfgfile);
-  foreach listing in entries
-    element :=  cfgfile[listing];
-    rect := element.rect;
-    rect := SplitWords(rect);
-    if((character.x >= CInt(rect[1])) && (character.x <= CInt(rect[3])) && (character.y >= CInt(rect[2])) && (character.y <= CInt(rect[4])))
-      return 1;
-      break;
-    endif
-  endforeach
-  return 0;
-
-endfunction 
\ No newline at end of file

Modified: trunk/096/scripts/misc/logofftest.src
===================================================================
--- trunk/096/scripts/misc/logofftest.src	2005-11-14 04:22:31 UTC (rev 982)
+++ trunk/096/scripts/misc/logofftest.src	2005-11-14 06:49:18 UTC (rev 983)
@@ -8,29 +8,31 @@
 use uo;
 
 include "include/time";
+include ":inns:innFunctions";
 include ":timedscripts:timedScripts";
 
 program core_logoffTest(who)
 	// Send event to the 'timed scripts' package to run log off scripts.
 	TS_LogOff(who);
-		
+
 	if ( (who.cmdlevel > 1) || (GetObjProperty(who,"Delete")) )
 		// Let staff or characters being deleted/banned logout immediately.
 		return 0;
 	endif
-	
+
 	var logout_delay := SECONDS_IN_MINUTE * 5;
-	
+
 	// Check if player is camping
-	// if ( IsCamping(who) )
-	
+	if( CInt(GetObjProperty(who, "#camped")) == 1 )
+		EraseObjProperty(who, "#camped");
+		logout_delay := 0;
 	// Check if player is in an inn
-	// elseif ( IsInInn(who) )
-		
+	elseif( isInInn(who) )
+		logout_delay := 0;
 	// Check if player is in a house
 	// Then check if player is the owner or  friend of the owner.
 	// elseif ( IsInHouse(who) )
-	
-	
+	endif
+
 	return logout_delay;
 endprogram



From muaddiblsd at berlios.de  Mon Nov 14 10:02:37 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Mon, 14 Nov 2005 10:02:37 +0100
Subject: [Poldistro-svn] r984 - in trunk/096: pkg/items pkg/items/acid pkg/items/acid/acid pkg/items/acid/config pkg/items/acid/include scripts/include
Message-ID: <200511140902.jAE92b0E019026@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-14 10:02:34 +0100 (Mon, 14 Nov 2005)
New Revision: 984

Added:
   trunk/096/pkg/items/acid/
   trunk/096/pkg/items/acid/acid/
   trunk/096/pkg/items/acid/acid/control.src
   trunk/096/pkg/items/acid/acid/onCreate.src
   trunk/096/pkg/items/acid/config/
   trunk/096/pkg/items/acid/config/icp.cfg
   trunk/096/pkg/items/acid/config/settings.cfg
   trunk/096/pkg/items/acid/include/
   trunk/096/pkg/items/acid/include/acid.inc
   trunk/096/pkg/items/acid/itemdesc.cfg
   trunk/096/pkg/items/acid/pkg.cfg
Modified:
   trunk/096/scripts/include/packets.inc
Log:


Added: trunk/096/pkg/items/acid/acid/control.src
===================================================================
--- trunk/096/pkg/items/acid/acid/control.src	2005-11-14 06:49:18 UTC (rev 983)
+++ trunk/096/pkg/items/acid/acid/control.src	2005-11-14 09:02:34 UTC (rev 984)
@@ -0,0 +1,10 @@
+/* $Id$
+ *
+ */
+use uo;
+use os;
+
+program ControlScript(acid)
+	sleep(5);
+	DestroyItem(acid);
+endprogram


Property changes on: trunk/096/pkg/items/acid/acid/control.src
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/acid/acid/onCreate.src
===================================================================
--- trunk/096/pkg/items/acid/acid/onCreate.src	2005-11-14 06:49:18 UTC (rev 983)
+++ trunk/096/pkg/items/acid/acid/onCreate.src	2005-11-14 09:02:34 UTC (rev 984)
@@ -0,0 +1,18 @@
+/* $Id$
+ *
+ */
+use uo;
+use util;
+use cfgfile;
+
+program OnCreate(acid)
+	var acid_cfg := ReadConfigFile(":acid:config/settings");
+	var graphic_elem := acid_cfg["Graphics"];
+	var graphics := GetConfigStringArray(graphic_elem, "Graphic");
+
+	if ( graphics.size() > 0 )
+		acid.graphic := CInt(graphics[RandomInt(graphics.size())+1]);
+	endif
+
+	return 1;
+endprogram


Property changes on: trunk/096/pkg/items/acid/acid/onCreate.src
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/acid/config/icp.cfg
===================================================================
--- trunk/096/pkg/items/acid/config/icp.cfg	2005-11-14 06:49:18 UTC (rev 983)
+++ trunk/096/pkg/items/acid/config/icp.cfg	2005-11-14 09:02:34 UTC (rev 984)
@@ -0,0 +1,17 @@
+ICP Register
+{
+	Name		Acid
+	Version		1.0
+
+	Description	Manages creation and removal of acid pools in the game.
+
+	Creator		MuadDib
+	C_Email		muaddib at lostsoulsshard.org
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	//Script	cmdlevel path
+
+	//TextCmd	cmdlevel path
+}


Property changes on: trunk/096/pkg/items/acid/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/acid/config/settings.cfg
===================================================================
--- trunk/096/pkg/items/acid/config/settings.cfg	2005-11-14 06:49:18 UTC (rev 983)
+++ trunk/096/pkg/items/acid/config/settings.cfg	2005-11-14 09:02:34 UTC (rev 984)
@@ -0,0 +1,11 @@
+#
+# $Id$
+#
+Acid Graphics
+{
+	Graphic	4650
+	Graphic	4651
+	Graphic	4652
+	Graphic	4653
+	Graphic	4654
+}


Property changes on: trunk/096/pkg/items/acid/config/settings.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/acid/include/acid.inc
===================================================================
--- trunk/096/pkg/items/acid/include/acid.inc	2005-11-14 06:49:18 UTC (rev 983)
+++ trunk/096/pkg/items/acid/include/acid.inc	2005-11-14 09:02:34 UTC (rev 984)
@@ -0,0 +1,42 @@
+/* $Id$
+ *
+ */
+use uo;
+use cfgfile;
+use util;
+
+include ":brainAI:npcUtil";
+include "include/packets";
+
+/*
+ * MakeBleed(object, blood_color)
+ *
+ * Purpose
+ * Creates a blood tile where the object is and sets the blood to the appropriate color.
+ *
+ * Parameters
+ * object:	The object to create the blood for.
+ * blood_color:	Optional parameter. Will force the blood to be this color.
+ *
+ * Return value
+ * Returns an item reference to the tile created.
+ *
+ */
+function SpitAcid(spitter, spit_on)
+	if( !CheckLineOfSight(spitter, spit_on) )
+		return 0;
+	endif
+	var npc_info := NPC_GetNPCConfig(spitter.npctemplate);
+	var acid_damage := 0;
+	if( !npc_info.AcidDamage )
+		// NPC doesn't Spit Acid
+		return 0;
+	else
+		acid_damage := RandomDiceRoll(npc_info.AcidDamage);
+	endif
+
+	PlayMovingEffectXYZHued(spitter, spit_on, 0x36d4, 5, 1, 1, 0x47, 0);
+	var acid_pool := CreateItemAtLocation(spit_on.x, spit_on.y, GetMapInfo(spit_on.x, spit_on.y).z, "acid",  1, spit_on.realm);
+	ApplyRawDamage(spit_on, acid_damage);
+	return acid_pool;
+endfunction


Property changes on: trunk/096/pkg/items/acid/include/acid.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/acid/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/acid/itemdesc.cfg	2005-11-14 06:49:18 UTC (rev 983)
+++ trunk/096/pkg/items/acid/itemdesc.cfg	2005-11-14 09:02:34 UTC (rev 984)
@@ -0,0 +1,13 @@
+Item 0xA370
+{
+	Name		acid
+	Desc		acid%%
+	Graphic		0x122A
+	Color		72
+
+	Movable		0
+	SaveOnExit	0
+
+	ControlScript	acid/control
+	CreateScript	acid/onCreate
+}
\ No newline at end of file


Property changes on: trunk/096/pkg/items/acid/itemdesc.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/acid/pkg.cfg
===================================================================
--- trunk/096/pkg/items/acid/pkg.cfg	2005-11-14 06:49:18 UTC (rev 983)
+++ trunk/096/pkg/items/acid/pkg.cfg	2005-11-14 09:02:34 UTC (rev 984)
@@ -0,0 +1,18 @@
+# $Id$
+#
+#
+
+Enabled		1
+Name		acid
+
+Version		1.0
+
+CoreRequired	96
+
+Creator		MuadDib
+Email		muaddib at lostsoulsshard.org
+Maintainer	Distro Team
+Email		distro at polserver.com
+
+#Requires none
+#conflicts	none


Property changes on: trunk/096/pkg/items/acid/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/096/scripts/include/packets.inc
===================================================================
--- trunk/096/scripts/include/packets.inc	2005-11-14 06:49:18 UTC (rev 983)
+++ trunk/096/scripts/include/packets.inc	2005-11-14 09:02:34 UTC (rev 984)
@@ -30,17 +30,40 @@
  *
  * Return value
  * No return value
- * 
+ *
  * TODO:
  * Make sure the feature bits are right
  *
  */
 function SendFeatures(who, features)
 	var packet;
-    
+
 	packet := CreatePacket(PACKET_FEATURES, 0x03);
 	packet.SetInt16(1, features);
 	packet.SendPacket(who);
 
 	return 1;
 endfunction
+
+
+function PlayMovingEffectXYZHued(source, dest, effect, speed, loop:=0, explode:=0, color:=0, translucent:=0)
+	var packet := CreatePacket(0xC0, 36);
+	packet.SetInt8(1, 0x00);
+	packet.SetInt32(2, source.serial);
+	packet.SetInt32(6, dest.serial);
+	packet.SetInt16(10, effect);
+	packet.SetInt16(12, source.x);
+	packet.SetInt16(14, source.y);
+	packet.SetInt8(16, source.z);
+	packet.SetInt16(17, dest.x);
+	packet.SetInt16(19, dest.y);
+	packet.SetInt8(21, dest.z);
+	packet.SetInt8(22, speed);
+	packet.SetInt8(23, loop);
+	packet.SetInt16(24, 0);
+	packet.SetInt8(26, 0);
+	packet.SetInt8(27, explode);
+	packet.SetInt32(28, color);
+	packet.SetInt32(32, translucent);
+	packet.SendAreaPacket(source.x, source.y, 16, source.realm);
+endfunction
\ No newline at end of file



From austin at berlios.de  Mon Nov 14 10:05:25 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 10:05:25 +0100
Subject: [Poldistro-svn] r985 - trunk/096/pkg/items/walkOn/teleport
Message-ID: <200511140905.jAE95PSr019747@sheep.berlios.de>

Author: austin
Date: 2005-11-14 10:05:16 +0100 (Mon, 14 Nov 2005)
New Revision: 985

Modified:
   trunk/096/pkg/items/walkOn/teleport/walkOn.src
Log:
Updated to use MoveObjectToLocation()

Modified: trunk/096/pkg/items/walkOn/teleport/walkOn.src
===================================================================
--- trunk/096/pkg/items/walkOn/teleport/walkOn.src	2005-11-14 09:02:34 UTC (rev 984)
+++ trunk/096/pkg/items/walkOn/teleport/walkOn.src	2005-11-14 09:05:16 UTC (rev 985)
@@ -25,7 +25,7 @@
 function JustTeleported(mobile)
 	var tele_time := CInt(GetObjProperty(mobile, "#Teleported"));
 	if ( tele_time > ReadMillisecondClock()-500 )
-		// Mobile just teleported Too soon to teleport again.
+		// Mobile just teleported. Too soon to teleport again.
 		return 1;
 	else
 		// Safe to teleport the mobile
@@ -36,12 +36,7 @@
 function TeleportMobile(mobile, byref dest)
 	SetObjProperty(mobile, "#Teleported", ReadMillisecondClock());
 	
-	var moved;
-	if ( mobile.realm != dest.realm )
-		moved := MoveObjectToRealm(mobile, dest.realm, dest.x, dest.y, dest.z, MOVECHAR_FORCELOCATION);
-	else
-		moved := MoveCharacterToLocation(mobile, dest.x, dest.y, dest.z, MOVECHAR_FORCELOCATION);
-	endif
+	var moved := MoveObjectToLocation(mobile, dest.x, dest.y, dest.z, dest.realm, MOVECHAR_FORCELOCATION);
 	
 	if ( moved.errortext )
 		SendSysMessage(mobile, "Teleport Error: "+moved.errortext);



From austin at berlios.de  Mon Nov 14 10:22:42 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 10:22:42 +0100
Subject: [Poldistro-svn] r986 - in trunk/096/pkg/skills/magery: . config recallRune
Message-ID: <200511140922.jAE9MgAd020896@sheep.berlios.de>

Author: austin
Date: 2005-11-14 10:22:35 +0100 (Mon, 14 Nov 2005)
New Revision: 986

Added:
   trunk/096/pkg/skills/magery/config/runeColor.cfg
   trunk/096/pkg/skills/magery/recallRune/
   trunk/096/pkg/skills/magery/recallRune/methods.src
   trunk/096/pkg/skills/magery/recallRune/use.src
Modified:
   trunk/096/pkg/skills/magery/itemdesc.cfg
Log:
Added recall rune support.

Added: trunk/096/pkg/skills/magery/config/runeColor.cfg
===================================================================
--- trunk/096/pkg/skills/magery/config/runeColor.cfg	2005-11-14 09:05:16 UTC (rev 985)
+++ trunk/096/pkg/skills/magery/config/runeColor.cfg	2005-11-14 09:22:35 UTC (rev 986)
@@ -0,0 +1,5 @@
+
+Realm Britannia
+{
+	RuneColor	24
+}

Modified: trunk/096/pkg/skills/magery/itemdesc.cfg
===================================================================
--- trunk/096/pkg/skills/magery/itemdesc.cfg	2005-11-14 09:05:16 UTC (rev 985)
+++ trunk/096/pkg/skills/magery/itemdesc.cfg	2005-11-14 09:22:35 UTC (rev 986)
@@ -924,4 +924,34 @@
 	VendorSellsFor		82
 
 	Script			spellScroll/use
+}
+
+//--=[ Recall Runes ]=----------------------
+
+Item 0x1F14
+{
+	Name			RecallRune
+	Desc			recall rune
+	
+	RequiresAttention	0
+		
+	VendorSellsFor		10
+	VendorBuysFor		5
+	
+	MethodScript		recallRune/methods
+	Script			recallRune/use
+}
+
+Item 0x1F15
+{
+	Name			RecallRune2
+	Desc			recall rune
+	
+	RequiresAttention	0
+		
+	VendorSellsFor		10
+	VendorBuysFor		5
+	
+	MethodScript		recallRune/methods
+	Script			recallRune/use
 }
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/recallRune/methods.src
===================================================================
--- trunk/096/pkg/skills/magery/recallRune/methods.src	2005-11-14 09:05:16 UTC (rev 985)
+++ trunk/096/pkg/skills/magery/recallRune/methods.src	2005-11-14 09:22:35 UTC (rev 986)
@@ -0,0 +1,39 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+use cfgfile;
+
+program Install()
+	return 1;
+endprogram
+
+exported function SetDestination(rune, x, y, z, realm)
+	var coords := struct;
+	struct.+x := CInt(x);
+	struct.+y := CInt(y);
+	struct.+z := CInt(z);
+	struct.+realm := CStr(realm);
+	
+	var color_cfg := ReadConfigFile(":magery:config/runeColor");
+	var realm_elem := color_cfg[realm];
+	rune.color := CInt(realm_elem.RuneColor);
+		
+	return SetObjProperty(rune, "Destination", coords);
+endfunction
+
+exported function GetDestination(rune)
+	return GetObjProperty(rune, "Destination");
+endfunction
+
+exported function SendToDestination(rune, object)
+	var dest := GetDestination(rune);
+	if ( !dest )
+		return error{"errortext":="Rune has no destination set."};
+	endif
+	
+	return MoveObjectToLocation(object, dest.x, dest.y, dest.z, dest.realm, MOVEOBJECT_FORCELOCATION);
+endfunction
+	
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/recallRune/use.src
===================================================================
--- trunk/096/pkg/skills/magery/recallRune/use.src	2005-11-14 09:05:16 UTC (rev 985)
+++ trunk/096/pkg/skills/magery/recallRune/use.src	2005-11-14 09:22:35 UTC (rev 986)
@@ -0,0 +1,26 @@
+/*
+ * $Id$
+ *
+ */
+ 
+use uo;
+
+include ":gumps:requestgump";
+
+program UseRune(who, rune)
+	if ( !rune.GetDestination() )
+		SendSysMessage(who, "This rune is not marked.");
+		return 0;
+	endif
+	
+	var desc := RequestGump(who, "Enter a new name for this rune.", "", rune.desc, CANCEL_BTN_ON);
+	if ( !desc )
+		SendSysMessage(who, "Cancelled.");
+		return 0;
+	endif
+	
+	SetName(rune, desc);
+	SendSysMessage(who, "Rune has been renamed.");
+	
+	return 1;
+endprogram



From austin at berlios.de  Mon Nov 14 10:27:44 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 10:27:44 +0100
Subject: [Poldistro-svn] r987 - in trunk/096/pkg: items/keys/key skills/magery skills/magery/recallRune
Message-ID: <200511140927.jAE9RiNG021892@sheep.berlios.de>

Author: austin
Date: 2005-11-14 10:27:34 +0100 (Mon, 14 Nov 2005)
New Revision: 987

Modified:
   trunk/096/pkg/items/keys/key/use.src
   trunk/096/pkg/skills/magery/pkg.cfg
   trunk/096/pkg/skills/magery/recallRune/methods.src
Log:
Misc. fixes.

Modified: trunk/096/pkg/items/keys/key/use.src
===================================================================
--- trunk/096/pkg/items/keys/key/use.src	2005-11-14 09:22:35 UTC (rev 986)
+++ trunk/096/pkg/items/keys/key/use.src	2005-11-14 09:27:34 UTC (rev 987)
@@ -37,10 +37,13 @@
 endprogram
 
 function RenameKey(who, key)
-	var new_name := RequestGump(who, "Enter a name for this key", "Maximum length is 20 characters.", key.desc);
+	var new_name := RequestGump(who, "Enter a name for this key", "Maximum length is 20 characters.", key.desc, CANCEL_BTN_ON);
 	var name_len := Len(new_name);
 	
-	if ( name_len > 20 )
+	if ( !new_name )
+		SendSysMessage(who, "Cancelled.");
+		return 0;
+	elseif ( name_len > 20 )
 		SendSysMessage(who, "Name is too long.");
 		return 0;
 	elseif ( name_len < 1 )

Modified: trunk/096/pkg/skills/magery/pkg.cfg
===================================================================
--- trunk/096/pkg/skills/magery/pkg.cfg	2005-11-14 09:22:35 UTC (rev 986)
+++ trunk/096/pkg/skills/magery/pkg.cfg	2005-11-14 09:27:34 UTC (rev 987)
@@ -1,4 +1,4 @@
-# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+# $Id$
 #
 #
 Enabled		1
@@ -13,5 +13,5 @@
 Maintainer	Distro Team
 Email		distro at polserver.com
 
-#Requires none
-#conflicts	none
+#Requires	NONE
+#conflicts	NONE

Modified: trunk/096/pkg/skills/magery/recallRune/methods.src
===================================================================
--- trunk/096/pkg/skills/magery/recallRune/methods.src	2005-11-14 09:22:35 UTC (rev 986)
+++ trunk/096/pkg/skills/magery/recallRune/methods.src	2005-11-14 09:27:34 UTC (rev 987)
@@ -10,6 +10,11 @@
 	return 1;
 endprogram
 
+exported function IsRecallRune(rune)
+	rune := rune;
+	return 1;
+endfunction
+
 exported function SetDestination(rune, x, y, z, realm)
 	var coords := struct;
 	struct.+x := CInt(x);



From austin at berlios.de  Mon Nov 14 10:42:49 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 10:42:49 +0100
Subject: [Poldistro-svn] r988 - in trunk/096: config pkg/skills/lumberjacking pkg/skills/lumberjacking/config pkg/skills/lumberjacking/include
Message-ID: <200511140942.jAE9gniE024320@sheep.berlios.de>

Author: austin
Date: 2005-11-14 10:42:48 +0100 (Mon, 14 Nov 2005)
New Revision: 988

Added:
   trunk/096/pkg/skills/lumberjacking/config/wood-britannia.cfg
   trunk/096/pkg/skills/lumberjacking/itemdesc.cfg
Removed:
   trunk/096/pkg/skills/lumberjacking/config/woodRegions.cfg
Modified:
   trunk/096/config/itemdesc.cfg
   trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc
Log:
Updated so each realm has its own config file for wood regions.
Moved log item from config/itemdesc.cfg to lumberjacking.

Modified: trunk/096/config/itemdesc.cfg
===================================================================
--- trunk/096/config/itemdesc.cfg	2005-11-14 09:27:34 UTC (rev 987)
+++ trunk/096/config/itemdesc.cfg	2005-11-14 09:42:48 UTC (rev 988)
@@ -145,15 +145,6 @@
 	CanRemoveScript		:containers:container/noRemove
 }
 
-Item 0x1BDD
-{
-	Name			log
-	Name			logs
-	Desc			log%s%
-	VendorSellsFor		5
-	VendorBuysFor		1
-}
-
 Item 0x1BD7
 {
 	Name			board

Copied: trunk/096/pkg/skills/lumberjacking/config/wood-britannia.cfg (from rev 987, trunk/096/pkg/skills/lumberjacking/config/woodRegions.cfg)
===================================================================
--- trunk/096/pkg/skills/lumberjacking/config/woodRegions.cfg	2005-11-14 09:27:34 UTC (rev 987)
+++ trunk/096/pkg/skills/lumberjacking/config/wood-britannia.cfg	2005-11-14 09:42:48 UTC (rev 988)
@@ -0,0 +1,6 @@
+
+Region Global
+{
+	Rect		0 0 6138 4090
+	WoodType	Log
+}

Deleted: trunk/096/pkg/skills/lumberjacking/config/woodRegions.cfg
===================================================================
--- trunk/096/pkg/skills/lumberjacking/config/woodRegions.cfg	2005-11-14 09:27:34 UTC (rev 987)
+++ trunk/096/pkg/skills/lumberjacking/config/woodRegions.cfg	2005-11-14 09:42:48 UTC (rev 988)
@@ -1,10 +0,0 @@
-Realm	Britannia
-{
-	Region	Britannia-Global
-}
-
-Region Britannia-Global
-{
-	Rect		0 0 6138 4090
-	WoodType	Log
-}

Modified: trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc
===================================================================
--- trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc	2005-11-14 09:27:34 UTC (rev 987)
+++ trunk/096/pkg/skills/lumberjacking/include/lumberJack.inc	2005-11-14 09:42:48 UTC (rev 988)
@@ -234,18 +234,13 @@
  *
  */
 function LJ_PickWoodType(realm, x_pos, y_pos)
-	var wood_cfg := ReadConfigFile(":lumberjacking:config/woodRegions");
+	var wood_cfg := ReadConfigFile(":lumberjacking:config/wood-"+realm);
 	if ( !wood_cfg )
 		return GetObjTypeByName("Log");
 	endif
 
-	var realm_elem := wood_cfg[realm];
-	if ( !realm_elem )
-		return GetObjTypeByName("Log");
-	endif
-
 	var wood_found := array{"Log"};
-	foreach region_name in ( GetConfigStringArray(realm_elem, "Region") )
+	foreach region_name in ( GetConfigStringKeys(wood_cfg) )
 		var region_elem := wood_cfg[region_name];
 		if ( !LJ_InRect(x_pos, y_pos, region_elem.Rect) )
 			continue;
@@ -259,6 +254,10 @@
 	endforeach
 
 	var selected_wood := wood_found[RandomInt(wood_found.Size())+1];
-	return GetObjTypeByName(selected_wood);
+	selected_wood := GetObjTypeByName(selected_wood);
+	if ( !selected_wood )
+		return GetObjTypeByName("Log");
+	endif
+	
 endfunction
 

Added: trunk/096/pkg/skills/lumberjacking/itemdesc.cfg
===================================================================
--- trunk/096/pkg/skills/lumberjacking/itemdesc.cfg	2005-11-14 09:27:34 UTC (rev 987)
+++ trunk/096/pkg/skills/lumberjacking/itemdesc.cfg	2005-11-14 09:42:48 UTC (rev 988)
@@ -0,0 +1,11 @@
+Item 0x1BDD
+{
+	Name			log
+	Name			logs
+	Desc			log%s%
+	
+	Weight			1
+	
+	VendorSellsFor		5
+	VendorBuysFor		1
+}
\ No newline at end of file



From austin at berlios.de  Mon Nov 14 10:53:28 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 10:53:28 +0100
Subject: [Poldistro-svn] r989 - trunk/096/pkg/items/moongates/config
Message-ID: <200511140953.jAE9rSmg025945@sheep.berlios.de>

Author: austin
Date: 2005-11-14 10:53:25 +0100 (Mon, 14 Nov 2005)
New Revision: 989

Modified:
   trunk/096/pkg/items/moongates/config/autoload.cfg
Log:


Modified: trunk/096/pkg/items/moongates/config/autoload.cfg
===================================================================
--- trunk/096/pkg/items/moongates/config/autoload.cfg	2005-11-14 09:42:48 UTC (rev 988)
+++ trunk/096/pkg/items/moongates/config/autoload.cfg	2005-11-14 09:53:25 UTC (rev 989)
@@ -2,7 +2,7 @@
 
 Autoload moongateInit
 {
-	Script      moongateInit
+	Script      systemMoonGate/moongateInit
 	Resistent   1
 	Name        Town Moongate Initializer
 	Priority    0



From austin at berlios.de  Mon Nov 14 11:00:57 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 11:00:57 +0100
Subject: [Poldistro-svn] r990 - in trunk/096/pkg/utils/saver: . config
Message-ID: <200511141000.jAEA0vHw027050@sheep.berlios.de>

Author: austin
Date: 2005-11-14 11:00:47 +0100 (Mon, 14 Nov 2005)
New Revision: 990

Added:
   trunk/096/pkg/utils/saver/config/
   trunk/096/pkg/utils/saver/config/autoLoad.cfg
   trunk/096/pkg/utils/saver/config/icp.cfg
Removed:
   trunk/096/pkg/utils/saver/autoload.cfg
Log:
Moved autload.cfg to package's config folder
Added ICP support.

Deleted: trunk/096/pkg/utils/saver/autoload.cfg
===================================================================
--- trunk/096/pkg/utils/saver/autoload.cfg	2005-11-14 09:53:25 UTC (rev 989)
+++ trunk/096/pkg/utils/saver/autoload.cfg	2005-11-14 10:00:47 UTC (rev 990)
@@ -1,9 +0,0 @@
-# $Id: autoload.cfg,v 1.1 2004/03/16 14:05:46 folko Exp $
-
-Autoload Saver
-{
-	Script      saver
-	Resistent   1
-	Name        Saver
-	Priority    0
-}

Added: trunk/096/pkg/utils/saver/config/autoLoad.cfg
===================================================================
--- trunk/096/pkg/utils/saver/config/autoLoad.cfg	2005-11-14 09:53:25 UTC (rev 989)
+++ trunk/096/pkg/utils/saver/config/autoLoad.cfg	2005-11-14 10:00:47 UTC (rev 990)
@@ -0,0 +1,9 @@
+# $Id: autoload.cfg 236 2005-09-25 09:06:19Z panosl $
+
+Autoload Saver
+{
+	Script      saver
+	Resistent   1
+	Name        Saver
+	Priority    0
+}

Added: trunk/096/pkg/utils/saver/config/icp.cfg
===================================================================
--- trunk/096/pkg/utils/saver/config/icp.cfg	2005-11-14 09:53:25 UTC (rev 989)
+++ trunk/096/pkg/utils/saver/config/icp.cfg	2005-11-14 10:00:47 UTC (rev 990)
@@ -0,0 +1,20 @@
+# $Id$
+#
+#
+ICP Register
+{
+	Name		Saver
+	Version		1.0
+	Description	System that saves the game state.
+
+	Creator		Distro Team
+	C_Email		distro at polserver.com
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+	TextCmd		1 :saver:commands/count/savenow
+}



From austin at berlios.de  Mon Nov 14 11:03:12 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 11:03:12 +0100
Subject: [Poldistro-svn] r991 - in trunk/096/pkg/items/bountyboard: . config
Message-ID: <200511141003.jAEA3C34027295@sheep.berlios.de>

Author: austin
Date: 2005-11-14 11:03:08 +0100 (Mon, 14 Nov 2005)
New Revision: 991

Added:
   trunk/096/pkg/items/bountyboard/config/autoLoad.cfg
   trunk/096/pkg/items/bountyboard/itemdesc.cfg
Removed:
   trunk/096/pkg/items/bountyboard/config/itemdesc.cfg
Log:
Placed autoLoad.cfg in package's config folder.
Itemdesc.cfg was in package's config folder.. thats naughty!
(wont support that until 097)



Added: trunk/096/pkg/items/bountyboard/config/autoLoad.cfg
===================================================================
--- trunk/096/pkg/items/bountyboard/config/autoLoad.cfg	2005-11-14 10:00:47 UTC (rev 990)
+++ trunk/096/pkg/items/bountyboard/config/autoLoad.cfg	2005-11-14 10:03:08 UTC (rev 991)
@@ -0,0 +1,9 @@
+# $Id: autoload.cfg 938 2005-11-07 06:22:45Z muaddiblsd $
+
+Autoload bountyWatcher
+{
+	Script      bountyWatcher
+	Resistent   1
+	Name        bountyWatcher
+	Priority    0
+}

Deleted: trunk/096/pkg/items/bountyboard/config/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/bountyboard/config/itemdesc.cfg	2005-11-14 10:00:47 UTC (rev 990)
+++ trunk/096/pkg/items/bountyboard/config/itemdesc.cfg	2005-11-14 10:03:08 UTC (rev 991)
@@ -1,16 +0,0 @@
-Item 0x7930
-{
-	Name		BountyBoard
-	Graphic     0x1E5E
-    Desc        bounty board
-	Script		bountyboard
-}
-
-Item 0x7931
-{
-	Name		BountyBoard2
-	Graphic     0x1E5f
-    Desc        bounty board
-	Script		bountyboard
-}
-	
\ No newline at end of file

Added: trunk/096/pkg/items/bountyboard/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/bountyboard/itemdesc.cfg	2005-11-14 10:00:47 UTC (rev 990)
+++ trunk/096/pkg/items/bountyboard/itemdesc.cfg	2005-11-14 10:03:08 UTC (rev 991)
@@ -0,0 +1,16 @@
+Item 0x7930
+{
+	Name		BountyBoard
+	Graphic     0x1E5E
+    Desc        bounty board
+	Script		bountyboard
+}
+
+Item 0x7931
+{
+	Name		BountyBoard2
+	Graphic     0x1E5f
+    Desc        bounty board
+	Script		bountyboard
+}
+	
\ No newline at end of file



From austin at berlios.de  Mon Nov 14 11:04:20 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 11:04:20 +0100
Subject: [Poldistro-svn] r992 - in trunk/096/pkg/items/guildstone: . config
Message-ID: <200511141004.jAEA4K7l027376@sheep.berlios.de>

Author: austin
Date: 2005-11-14 11:04:12 +0100 (Mon, 14 Nov 2005)
New Revision: 992

Added:
   trunk/096/pkg/items/guildstone/config/
   trunk/096/pkg/items/guildstone/config/autoLoad.cfg
Removed:
   trunk/096/pkg/items/guildstone/autoload.cfg
Log:
Moved package's autoLoad.cfg to the config directory of it.

Deleted: trunk/096/pkg/items/guildstone/autoload.cfg
===================================================================
--- trunk/096/pkg/items/guildstone/autoload.cfg	2005-11-14 10:03:08 UTC (rev 991)
+++ trunk/096/pkg/items/guildstone/autoload.cfg	2005-11-14 10:04:12 UTC (rev 992)
@@ -1,9 +0,0 @@
-# $Id: autoload.cfg 236 2005-09-25 09:06:19Z panosl $
-
-Autoload guildManager
-{
-	Script      guildManager
-	Resistent   1
-	Name        guildManager
-	Priority    0
-}

Added: trunk/096/pkg/items/guildstone/config/autoLoad.cfg
===================================================================
--- trunk/096/pkg/items/guildstone/config/autoLoad.cfg	2005-11-14 10:03:08 UTC (rev 991)
+++ trunk/096/pkg/items/guildstone/config/autoLoad.cfg	2005-11-14 10:04:12 UTC (rev 992)
@@ -0,0 +1,9 @@
+# $Id: autoload.cfg 938 2005-11-07 06:22:45Z muaddiblsd $
+
+Autoload guildManager
+{
+	Script      guildManager
+	Resistent   1
+	Name        guildManager
+	Priority    0
+}



From austin at berlios.de  Mon Nov 14 11:13:43 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 11:13:43 +0100
Subject: [Poldistro-svn] r993 - in trunk/096/pkg/systems/loot: . config/OLD includes
Message-ID: <200511141013.jAEADhQp028555@sheep.berlios.de>

Author: austin
Date: 2005-11-14 11:13:38 +0100 (Mon, 14 Nov 2005)
New Revision: 993

Added:
   trunk/096/pkg/systems/loot/config/
Removed:
   trunk/096/pkg/systems/loot/configs/
Modified:
   trunk/096/pkg/systems/loot/config/OLD/nlootgroup.cfg
   trunk/096/pkg/systems/loot/includes/lootParser.inc
Log:
'Configs' changed to 'config'

Copied: trunk/096/pkg/systems/loot/config (from rev 987, trunk/096/pkg/systems/loot/configs)

Modified: trunk/096/pkg/systems/loot/config/OLD/nlootgroup.cfg
===================================================================
--- trunk/096/pkg/systems/loot/configs/OLD/nlootgroup.cfg	2005-11-14 09:27:34 UTC (rev 987)
+++ trunk/096/pkg/systems/loot/config/OLD/nlootgroup.cfg	2005-11-14 10:13:38 UTC (rev 993)
@@ -1,4 +1,4 @@
-# $Id: nlootgroup.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+# $Id$
 #
 #
 ###############################################

Modified: trunk/096/pkg/systems/loot/includes/lootParser.inc
===================================================================
--- trunk/096/pkg/systems/loot/includes/lootParser.inc	2005-11-14 10:04:12 UTC (rev 992)
+++ trunk/096/pkg/systems/loot/includes/lootParser.inc	2005-11-14 10:13:38 UTC (rev 993)
@@ -8,7 +8,7 @@
 		return error{"errortext" := "Object passed was not a container."};
 	endif
 
-	var index_cfg := ReadConfigFile(":loot:configs/loot-index");
+	var index_cfg := ReadConfigFile(":loot:config/loot-index");
 	if ( index_cfg.errortext )
 		return error{"errortext" := "Error - Could not open loot-index.cfg -> "+index_cfg.errortext};
 	endif
@@ -77,7 +77,7 @@
 
 function Loot_CreateRandom(container, line)
 	var parsed := Loot_ParseString(line);
-	var groups_cfg := ReadConfigFile(":loot:configs/loot-groups");
+	var groups_cfg := ReadConfigFile(":loot:config/loot-groups");
 	if ( groups_cfg.errortext )
 		return error{"errortext" := "Error - Could not open loot-groups.cfg -> "+groups_cfg.errortext};
 	endif



From austin at berlios.de  Mon Nov 14 11:15:01 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 11:15:01 +0100
Subject: [Poldistro-svn] r994 - in trunk/096/pkg: items/mounts items/mounts/config systems/combat/config
Message-ID: <200511141015.jAEAF1Cb028808@sheep.berlios.de>

Author: austin
Date: 2005-11-14 11:14:58 +0100 (Mon, 14 Nov 2005)
New Revision: 994

Added:
   trunk/096/pkg/items/mounts/config/icp.cfg
   trunk/096/pkg/systems/combat/config/icp.cfg
Modified:
   trunk/096/pkg/items/mounts/pkg.cfg
Log:
Added ICP support to mounts and combat.

Added: trunk/096/pkg/items/mounts/config/icp.cfg
===================================================================
--- trunk/096/pkg/items/mounts/config/icp.cfg	2005-11-14 10:13:38 UTC (rev 993)
+++ trunk/096/pkg/items/mounts/config/icp.cfg	2005-11-14 10:14:58 UTC (rev 994)
@@ -0,0 +1,18 @@
+ICP Register
+{
+	Name		Mounts
+	Version		1.0
+
+	Description	Handles mount piece equipping, removing, etc.
+
+	Creator		Austin
+	C_Email		AustinHeilman at gmail.com
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+	
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+	TextCmd		2 :mounts:commands/seer/mount
+}
\ No newline at end of file

Modified: trunk/096/pkg/items/mounts/pkg.cfg
===================================================================
--- trunk/096/pkg/items/mounts/pkg.cfg	2005-11-14 10:13:38 UTC (rev 993)
+++ trunk/096/pkg/items/mounts/pkg.cfg	2005-11-14 10:14:58 UTC (rev 994)
@@ -13,5 +13,5 @@
 Maintainer	Distro Team
 Email		distro at polserver.com
 
-#Requires none
-#conflicts	none
+#Requires	NONE
+#Conflicts	NONE

Added: trunk/096/pkg/systems/combat/config/icp.cfg
===================================================================
--- trunk/096/pkg/systems/combat/config/icp.cfg	2005-11-14 10:13:38 UTC (rev 993)
+++ trunk/096/pkg/systems/combat/config/icp.cfg	2005-11-14 10:14:58 UTC (rev 994)
@@ -0,0 +1,17 @@
+ICP Register
+{
+	Name		Combat
+	Version		1.0
+
+	Description	Weapons, armor, hit scripts, combat related hooks.
+
+	Creator		Austin
+	C_Email		AustinHeilman at gmail.com
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+	
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}
\ No newline at end of file



From austin at berlios.de  Mon Nov 14 11:19:35 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 11:19:35 +0100
Subject: [Poldistro-svn] r995 - trunk/096/pkg/mobiles/brainAI/config
Message-ID: <200511141019.jAEAJZo9029325@sheep.berlios.de>

Author: austin
Date: 2005-11-14 11:19:29 +0100 (Mon, 14 Nov 2005)
New Revision: 995

Modified:
   trunk/096/pkg/mobiles/brainAI/config/icp.cfg
Log:
When package was renamed.. the ICP command paths were not adjusted. Booo me!

Modified: trunk/096/pkg/mobiles/brainAI/config/icp.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/config/icp.cfg	2005-11-14 10:14:58 UTC (rev 994)
+++ trunk/096/pkg/mobiles/brainAI/config/icp.cfg	2005-11-14 10:19:29 UTC (rev 995)
@@ -17,16 +17,16 @@
 	#Script	cmdlevel path
 
 	#TextCmd	cmdlevel path
-	TextCmd		3 :a_brain:commands/gm/attack
-	TextCmd		3 :ai_brain:commands/gm/cmassacre
-	TextCmd		3 :ai_brain:commands/gm/createnpc
-	TextCmd		3 :ai_brain:commands/gm/makeswarm
-	TextCmd		3 :ai_brain:commands/gm/massacre
-	TextCmd		3 :ai_brain:commands/gm/npcsleep
-	TextCmd		3 :ai_brain:commands/gm/npcwipe
-	TextCmd		3 :ai_brain:commands/gm/puttosleep
-	TextCmd		3 :ai_brain:commands/gm/removenpc
-	TextCmd		3 :ai_brain:commands/gm/resetnpcs
-	TextCmd		3 :ai_brain:commands/gm/restartnpc
-	TextCmd		3 :ai_brain:commands/gm/sendevent
+	TextCmd		3 :brainai:commands/gm/attack
+	TextCmd		3 :brainai:commands/gm/cmassacre
+	TextCmd		3 :brainai:commands/gm/createnpc
+	TextCmd		3 :brainai:commands/gm/makeswarm
+	TextCmd		3 :brainai:commands/gm/massacre
+	TextCmd		3 :brainai:commands/gm/npcsleep
+	TextCmd		3 :brainai:commands/gm/npcwipe
+	TextCmd		3 :brainai:commands/gm/puttosleep
+	TextCmd		3 :brainai:commands/gm/removenpc
+	TextCmd		3 :brainai:commands/gm/resetnpcs
+	TextCmd		3 :brainai:commands/gm/restartnpc
+	TextCmd		3 :brainai:commands/gm/sendevent
 }



From panosl at berlios.de  Mon Nov 14 19:41:04 2005
From: panosl at berlios.de (Panos Laganakos at BerliOS)
Date: Mon, 14 Nov 2005 19:41:04 +0100
Subject: [Poldistro-svn] r996 - trunk/096/pkg/mobiles/brainAI/docs
Message-ID: <200511141841.jAEIf41E021148@sheep.berlios.de>

Author: panosl
Date: 2005-11-14 19:41:02 +0100 (Mon, 14 Nov 2005)
New Revision: 996

Modified:
   trunk/096/pkg/mobiles/brainAI/docs/npcInit.html
Log:


Modified: trunk/096/pkg/mobiles/brainAI/docs/npcInit.html
===================================================================
--- trunk/096/pkg/mobiles/brainAI/docs/npcInit.html	2005-11-14 10:19:29 UTC (rev 995)
+++ trunk/096/pkg/mobiles/brainAI/docs/npcInit.html	2005-11-14 18:41:02 UTC (rev 996)
@@ -1,57 +1,19 @@
-<html>
-
 <head>
-<meta http-equiv="Content-Language" content="en-us">
-<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
-<meta name="ProgId" content="FrontPage.Editor.Document">
-<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
-<title>BRAIN AI DOCUMENTATION</title>
+	<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
+	<meta http-equiv="Content-Language" content="en-us">
+	<title>brainAI Documentation</title>
+	<link rel="stylesheet" type="text/css" href="docs.css" />
 </head>
-
 <body>
+<div id="container">
+	<div id="header">
+		<h1>brainAI DOCUMENTATION</h1>
+		<p>Version 5, codename <b>"Krang"</b>, by <a href="mailto:AustinHeilman at Gmail.com">Austin Heilman</a>.</p>
+		<hr>
+		<h2>npcInit.inc</h2>
+	</div>
 
-<table border="0" cellspacing="1" width="100%" height="918" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">
-  <tr>
-    <td align="left" valign="top" width="159" height="19">&nbsp; </td>
-    <td width="15" height="19"></td>
-    <td valign="bottom" width="928" height="19">&nbsp;</td>
-  </tr>
-  <tr>
-    <td valign="top" width="159" align="left" height="883"><font face="Tahoma"><strong>
-    <font size="2">Brain 5.0</font></strong><font size="2"><br>
-    <a href="index.htm">Introduction</a><br>
-    <a href="conversion.htm">Conversion</a><br>
-    <a href="changeLog.htm">Change Log</a><br>
-    <a href="configSettings.htm">Config Settings</a></font></font><p>
-    <font face="Tahoma"><strong><font size="2">Script Types</font></strong><font size="2"><br>
-    <a href="scriptTypes.htm#Combat">Combat</a><br>
-    <a href="scriptTypes.htm#Cycle">Cycle</a><br>
-    <a href="scriptTypes.htm#DblClick">DblClick</a><br>
-    <a href="scriptTypes.htm#Disengaged">Disengaged</a><br>
-    <a href="scriptTypes.htm#EnterArea">EnterArea</a><br>
-    <a href="scriptTypes.htm#GoneCriminal">GoneCriminal</a><br>
-    <a href="scriptTypes.htm#Init">Init</a><br>
-    <a href="scriptTypes.htm#ItemGiven">ItemGiven</a><br>
-    <a href="scriptTypes.htm#LeftArea">LeftArea</a><br>
-    <a href="scriptTypes.htm#LookAround">LookAround</a><br>
-    <a href="scriptTypes.htm#Listen">Listen</a><br>
-    <a href="scriptTypes.htm#Merchant">Merchant</a><br>
-    <a href="scriptTypes.htm#Restart">Restart</a><br>
-    <a href="scriptTypes.htm#ShouldWatch">ShouldWatch</a><br>
-    <a href="scriptTypes.htm#Sleep">Sleep</a><br>
-    <a href="scriptTypes.htm#Vitual">Virtual</a></font></font></p>
-    <p><font face="Tahoma"><strong><font size="2">Include Files</font></strong><font size="2"><br>
-    <a href="eventId.htm">eventId.inc</a><br>
-    <a href="npcCommands.htm">npcCommands.inc</a><br>
-    <a href="npcError.htm">npcError.inc</a><br>
-    <a href="npcInit.htm">npcInit.inc</a><br>
-    <a href="npcNerves.htm">npcNerves.inc</a><br>
-    <a href="npcSettings.htm">npcSettings.inc</a><br>
-    <a href="npcUtil.htm">npcUtil.inc</a><br>
-    <a href="npcWatchList.htm">npcWatchList.inc</a></font></font><br>
-&nbsp;</td>
-    <td width="15" height="883"></td>
-    <td valign="top" width="928" height="883">
+	<div id="content">
     <table border="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber1" cellpadding="2">
       <tr>
           <td width="1%" bgcolor="#C0C0C0" bordercolorlight="#000000" bordercolordark="#000000" style="border-style:solid; border-width:1; " align="center" colspan="2">
@@ -353,7 +315,10 @@
     </td>
   </tr>
 </table>
+	</div>
 
+	<div id="footer">
+		<p>Last Update: $Id$</p>
+	</div>
+</div>
 </body>
-
-</html>
\ No newline at end of file



From muaddiblsd at berlios.de  Mon Nov 14 20:23:08 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Mon, 14 Nov 2005 20:23:08 +0100
Subject: [Poldistro-svn] r997 - trunk/096/pkg/items/acid/include
Message-ID: <200511141923.jAEJN8N7032353@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-14 20:23:04 +0100 (Mon, 14 Nov 2005)
New Revision: 997

Modified:
   trunk/096/pkg/items/acid/include/acid.inc
Log:
Updated acid.inc for new DealAcidDamage function. Is used by the SpitAcid function, but can now be used seperately by hitscripts, traps, etc.

DealAcidDamage deals damage based on the AcidDamage still, and has random chance to deal hp damage to randomly selected armor/weapon.

Modified: trunk/096/pkg/items/acid/include/acid.inc
===================================================================
--- trunk/096/pkg/items/acid/include/acid.inc	2005-11-14 18:41:02 UTC (rev 996)
+++ trunk/096/pkg/items/acid/include/acid.inc	2005-11-14 19:23:04 UTC (rev 997)
@@ -9,14 +9,15 @@
 include "include/packets";
 
 /*
- * MakeBleed(object, blood_color)
+ * SpitAced(spitter, spit_on)
  *
  * Purpose
- * Creates a blood tile where the object is and sets the blood to the appropriate color.
+ * Creates an acid tile where the spit_on is and handles dealing initial
+ * damage to the spit_on and affects armor if applicable.
  *
  * Parameters
- * object:	The object to create the blood for.
- * blood_color:	Optional parameter. Will force the blood to be this color.
+ * spitter:	The npc spitting the acid
+ * spit_on:	The mobile the npc is spitting on.
  *
  * Return value
  * Returns an item reference to the tile created.
@@ -26,7 +27,30 @@
 	if( !CheckLineOfSight(spitter, spit_on) )
 		return 0;
 	endif
-	var npc_info := NPC_GetNPCConfig(spitter.npctemplate);
+	PlayMovingEffectXYZHued(spitter, spit_on, 0x36d4, 5, 1, 1, 0x47, 0);
+	var acid_pool := CreateItemAtLocation(spit_on.x, spit_on.y, GetMapInfo(spit_on.x, spit_on.y).z, "acid",  1, spit_on.realm);
+	DealAcidDamage(spitter, spit_on);
+	return acid_pool;
+endfunction
+
+
+/*
+ * DealAcidDamage(npc, mobile)
+ *
+ * Purpose
+ * Deals damage to a mob based on an npc's AcidDamage entry in it's npctemplate.
+ * Also deals damage randomly to the mobile's armor or weapon.
+ *
+ * Parameters
+ * npc:		The npc spitting the acid
+ * mobile:	The mobile the npc is spitting on.
+ *
+ * Return value
+ * Returns 1 if armor damaged, 0 elsewise.
+ *
+ */
+function DealAcidDamage(npc, mobile)
+	var npc_info := NPC_GetNPCConfig(npc.npctemplate);
 	var acid_damage := 0;
 	if( !npc_info.AcidDamage )
 		// NPC doesn't Spit Acid
@@ -34,9 +58,20 @@
 	else
 		acid_damage := RandomDiceRoll(npc_info.AcidDamage);
 	endif
-
-	PlayMovingEffectXYZHued(spitter, spit_on, 0x36d4, 5, 1, 1, 0x47, 0);
-	var acid_pool := CreateItemAtLocation(spit_on.x, spit_on.y, GetMapInfo(spit_on.x, spit_on.y).z, "acid",  1, spit_on.realm);
-	ApplyRawDamage(spit_on, acid_damage);
-	return acid_pool;
-endfunction
+	ApplyRawDamage(mobile, acid_damage);
+	var equipped_items := ListEquippedItems(mobile);
+	if( RandomInt(10) > 5 )
+		var acid_burned := equipped_items[RandomInt(equipped_items.size())+1];
+		if( acid_burned.isA(POLCLASS_WEAPON) || acid_burned.isA(POLCLASS_ARMOR) )
+			var armor_damage := RandomInt(4) + 1;
+			if( acid_burned.hp > armor_damage )
+				acid_burned.hp := acid_burned.hp - armor_damage;
+				PrintTextAbovePrivate( mobile, "*Acid damages your equipment*", mobile, _DEFAULT_TEXT_FONT, 72);
+			else
+				DestroyItem(acid_burned);
+			endif
+			return 1;
+		endif
+	endif
+	return 0;
+endfunction
\ No newline at end of file



From muaddiblsd at berlios.de  Mon Nov 14 21:12:51 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Mon, 14 Nov 2005 21:12:51 +0100
Subject: [Poldistro-svn] r998 - in trunk/096/pkg/items/acid: . include
Message-ID: <200511142012.jAEKCpIF017350@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-14 21:12:45 +0100 (Mon, 14 Nov 2005)
New Revision: 998

Modified:
   trunk/096/pkg/items/acid/include/acid.inc
   trunk/096/pkg/items/acid/itemdesc.cfg
Log:
Upgraded DealAcidDamage and made a header for it.

Added WalkOn Script for acid pools.

Modified: trunk/096/pkg/items/acid/include/acid.inc
===================================================================
--- trunk/096/pkg/items/acid/include/acid.inc	2005-11-14 19:23:04 UTC (rev 997)
+++ trunk/096/pkg/items/acid/include/acid.inc	2005-11-14 20:12:45 UTC (rev 998)
@@ -29,7 +29,7 @@
 	endif
 	PlayMovingEffectXYZHued(spitter, spit_on, 0x36d4, 5, 1, 1, 0x47, 0);
 	var acid_pool := CreateItemAtLocation(spit_on.x, spit_on.y, GetMapInfo(spit_on.x, spit_on.y).z, "acid",  1, spit_on.realm);
-	DealAcidDamage(spitter, spit_on);
+	DealAcidDamage(spitter, spit_on, acid_pool);
 	return acid_pool;
 endfunction
 
@@ -38,25 +38,39 @@
  * DealAcidDamage(npc, mobile)
  *
  * Purpose
- * Deals damage to a mob based on an npc's AcidDamage entry in it's npctemplate.
- * Also deals damage randomly to the mobile's armor or weapon.
+ * Deals damage to a mob based on an npc's AcidDamage entry in it's npctemplate
+ * if 0 is sent for acid_damage. Otherwise uses the Dice Roll sent. Also checks
+ * for a cprop on the acid itself. CProp is set here in this function. The CProp
+ * is used by walkOn/Timer scripts. Also deals damage randomly to the mobile's
+ * armor or weapon.
  *
  * Parameters
  * npc:		The npc spitting the acid
  * mobile:	The mobile the npc is spitting on.
+ * acid_damage:	Optional. If 0/Not sent, then it defaults to
+ *		to the npc's AcidDamage setting in template.
  *
  * Return value
  * Returns 1 if armor damaged, 0 elsewise.
  *
+ * Note:	If NPC is sent as the acid_pool, it will store the AcidDamage string
+ * 		on the NPC itself, and make it useable for future occurances instead
+ *		of reading the template.
  */
-function DealAcidDamage(npc, mobile)
+function DealAcidDamage(npc, mobile, acid_pool, acid_damage:=0)
 	var npc_info := NPC_GetNPCConfig(npc.npctemplate);
-	var acid_damage := 0;
-	if( !npc_info.AcidDamage )
-		// NPC doesn't Spit Acid
-		return 0;
+	if( acid_damage )
+		acid_damage := RandomDiceRoll(acid_damage);
+	elseif( !npc_info.AcidDamage )
+		if( TypeOf(GetObjProperty(acid_pool, "%AcidDice%")) == "String" )
+			acid_damage := RandomDiceRoll(GetObjProperty(acid_pool, "%AcidDice%"));
+		else
+			// Can't Deal Acid Damage
+			return 0;
+		endif
 	else
 		acid_damage := RandomDiceRoll(npc_info.AcidDamage);
+		SetObjProperty(acid_pool, "%AcidDice%", npc_info.AcidDamage);
 	endif
 	ApplyRawDamage(mobile, acid_damage);
 	var equipped_items := ListEquippedItems(mobile);

Modified: trunk/096/pkg/items/acid/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/acid/itemdesc.cfg	2005-11-14 19:23:04 UTC (rev 997)
+++ trunk/096/pkg/items/acid/itemdesc.cfg	2005-11-14 20:12:45 UTC (rev 998)
@@ -10,4 +10,5 @@
 
 	ControlScript	acid/control
 	CreateScript	acid/onCreate
+	WalkOnScript	acid/walkOn
 }
\ No newline at end of file



From muaddiblsd at berlios.de  Mon Nov 14 21:13:49 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Mon, 14 Nov 2005 21:13:49 +0100
Subject: [Poldistro-svn] r999 - trunk/096/pkg/items/acid/acid
Message-ID: <200511142013.jAEKDnas017715@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-14 21:13:45 +0100 (Mon, 14 Nov 2005)
New Revision: 999

Added:
   trunk/096/pkg/items/acid/acid/walkOn.src
Log:


Added: trunk/096/pkg/items/acid/acid/walkOn.src
===================================================================
--- trunk/096/pkg/items/acid/acid/walkOn.src	2005-11-14 20:12:45 UTC (rev 998)
+++ trunk/096/pkg/items/acid/acid/walkOn.src	2005-11-14 20:13:45 UTC (rev 999)
@@ -0,0 +1,24 @@
+/* $Id$
+ *
+ */
+use uo;
+
+include ":acid:acid";
+
+program acid_WalkOn(mobile, acid)
+	if( TypeOf(mobile) == "Array" )
+		acid := mobile[2];
+		mobile := mobile[1];
+	endif
+	if ( mobile.cmdlevel )
+		return 0;
+	elseif ( mobile.dead )
+		return 0;
+	endif
+
+	SendSysMessage(mobile, "*You step into a pool of acid*");
+	if( !DealAcidDamage(acid, mobile, acid) )
+		DealAcidDamage(acid, mobile, acid, "5d2");
+	endif
+	return 1;
+endprogram


Property changes on: trunk/096/pkg/items/acid/acid/walkOn.src
___________________________________________________________________
Name: svn:keywords
   + Id



From austin at berlios.de  Mon Nov 14 21:44:16 2005
From: austin at berlios.de (Austin Heilman at BerliOS)
Date: Mon, 14 Nov 2005 21:44:16 +0100
Subject: [Poldistro-svn] r1000 - trunk/096/scripts/include
Message-ID: <200511142044.jAEKiGcE002527@sheep.berlios.de>

Author: austin
Date: 2005-11-14 21:44:01 +0100 (Mon, 14 Nov 2005)
New Revision: 1000

Modified:
   trunk/096/scripts/include/shapes.inc
Log:


Modified: trunk/096/scripts/include/shapes.inc
===================================================================
--- trunk/096/scripts/include/shapes.inc	2005-11-14 20:13:45 UTC (rev 999)
+++ trunk/096/scripts/include/shapes.inc	2005-11-14 20:44:01 UTC (rev 1000)
@@ -107,3 +107,31 @@
 	radius := radius;
 	return error{"errortext":="Hasn't been coded yet!"};
 endfunction
+
+/* 
+ * GetCoordsInPolygon(coord_list)
+ *
+ * Purpose
+ * Takes in an array of structs containing .x, .y coordinates.
+ * Each point is a segment that builds the shape.
+ * Finds the coordinates inside of that shape.
+ *
+ *
+ * Parameters
+ * coord_list:	Array of structs. Each struct contains an x and y member.
+ *
+ * Return value
+ * Returns an array of structs containing a .x and .y member.
+ *
+ */
+function GetCoordsInPolygon(coord_list)
+	var num_coords := coord_list.Size();
+	if ( num_coords < 3 )
+		return error{"errortext":="Needs atleast three coordinates to form a polygon."};
+	endif
+	
+	//var start_coord := coord_list[1];
+	//var end_coord := coord_list[num_coords];
+	
+	return error{"errortext":="Hasn't been coded yet!"};
+endfunction



From muaddiblsd at berlios.de  Mon Nov 14 22:06:14 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Mon, 14 Nov 2005 22:06:14 +0100
Subject: [Poldistro-svn] r1001 - trunk/096/pkg/items/acid/include
Message-ID: <200511142106.jAEL6EXD015618@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-14 22:06:03 +0100 (Mon, 14 Nov 2005)
New Revision: 1001

Modified:
   trunk/096/pkg/items/acid/include/acid.inc
Log:


Modified: trunk/096/pkg/items/acid/include/acid.inc
===================================================================
--- trunk/096/pkg/items/acid/include/acid.inc	2005-11-14 20:44:01 UTC (rev 1000)
+++ trunk/096/pkg/items/acid/include/acid.inc	2005-11-14 21:06:03 UTC (rev 1001)
@@ -29,7 +29,10 @@
 	endif
 	PlayMovingEffectXYZHued(spitter, spit_on, 0x36d4, 5, 1, 1, 0x47, 0);
 	var acid_pool := CreateItemAtLocation(spit_on.x, spit_on.y, GetMapInfo(spit_on.x, spit_on.y).z, "acid",  1, spit_on.realm);
-	DealAcidDamage(spitter, spit_on, acid_pool);
+	var dice_dealt := DealAcidDamage(spitter, spit_on, acid_pool);
+	if( TypeOf(dice_dealt) == "String" && !GetObjProperty(acid_pool, "%AcidDice%") )
+		SetObjProperty(acid_pool, "%AcidDice%", dice_dealt);
+	endif
 	return acid_pool;
 endfunction
 
@@ -40,9 +43,8 @@
  * Purpose
  * Deals damage to a mob based on an npc's AcidDamage entry in it's npctemplate
  * if 0 is sent for acid_damage. Otherwise uses the Dice Roll sent. Also checks
- * for a cprop on the acid itself. CProp is set here in this function. The CProp
- * is used by walkOn/Timer scripts. Also deals damage randomly to the mobile's
- * armor or weapon.
+ * for a cprop on the acid itself. The CProp is used by walkOn/Timer scripts.
+ * Also deals damage randomly to the mobile's armor or weapon.
  *
  * Parameters
  * npc:		The npc spitting the acid
@@ -51,26 +53,20 @@
  *		to the npc's AcidDamage setting in template.
  *
  * Return value
- * Returns 1 if armor damaged, 0 elsewise.
+ * Returns dice roll string.
  *
- * Note:	If NPC is sent as the acid_pool, it will store the AcidDamage string
- * 		on the NPC itself, and make it useable for future occurances instead
- *		of reading the template.
  */
 function DealAcidDamage(npc, mobile, acid_pool, acid_damage:=0)
-	var npc_info := NPC_GetNPCConfig(npc.npctemplate);
+	var acid_dice := GetAcidDiceFromTemplate(npc);
+	if( TypeOf(acid_dice) != "String" )
+		acid_dice := GetAcidDiceFromItem(acid_pool);
+	endif
 	if( acid_damage )
 		acid_damage := RandomDiceRoll(acid_damage);
-	elseif( !npc_info.AcidDamage )
-		if( TypeOf(GetObjProperty(acid_pool, "%AcidDice%")) == "String" )
-			acid_damage := RandomDiceRoll(GetObjProperty(acid_pool, "%AcidDice%"));
-		else
-			// Can't Deal Acid Damage
-			return 0;
-		endif
+	elseif( TypeOf(acid_dice) == "String" )
+		acid_damage := RandomDiceRoll(acid_dice);
 	else
-		acid_damage := RandomDiceRoll(npc_info.AcidDamage);
-		SetObjProperty(acid_pool, "%AcidDice%", npc_info.AcidDamage);
+		return 0;
 	endif
 	ApplyRawDamage(mobile, acid_damage);
 	var equipped_items := ListEquippedItems(mobile);
@@ -84,8 +80,37 @@
 			else
 				DestroyItem(acid_burned);
 			endif
-			return 1;
 		endif
 	endif
-	return 0;
+	return acid_dice;
+endfunction
+
+
+function GetAcidDiceFromTemplate(npc)
+	if( npc.isA(POLCLASS_NPC) )
+		var npc_info := NPC_GetNPCConfig(npc.npctemplate);
+		if( !npc_info.AcidDamage )
+			// Can't Deal Acid Damage
+			return 0;
+		else
+			return npc_info.AcidDamage;
+		endif
+	else
+		return 0;
+	endif
+endfunction
+
+
+function GetAcidDiceFromItem(acid_pool)
+	if( acid_pool.isA(POLCLASS_ITEM) )
+		if( TypeOf(GetObjProperty(acid_pool, "%AcidDice%")) == "String" )
+			return GetObjProperty(acid_pool, "%AcidDice%");
+
+		else
+			// Can't Deal Acid Damage
+			return 0;
+		endif
+	else
+		return 0;
+	endif
 endfunction
\ No newline at end of file



From muaddiblsd at berlios.de  Tue Nov 15 07:18:55 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Tue, 15 Nov 2005 07:18:55 +0100
Subject: [Poldistro-svn] r1002 - in trunk/096: pkg/items/runebook pkg/mobiles/oldAI pkg/skills/fishing pkg/skills/magery/OLD pkg/systems/housing pkg/utils pkg/utils/coords pkg/utils/coords/config pkg/utils/coords/include scripts/include/OLD
Message-ID: <200511150618.jAF6ItQM008708@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-15 07:18:44 +0100 (Tue, 15 Nov 2005)
New Revision: 1002

Added:
   trunk/096/pkg/utils/coords/
   trunk/096/pkg/utils/coords/config/
   trunk/096/pkg/utils/coords/config/icp.cfg
   trunk/096/pkg/utils/coords/include/
   trunk/096/pkg/utils/coords/include/coords.inc
   trunk/096/pkg/utils/coords/include/findCity.inc
   trunk/096/pkg/utils/coords/include/isValidLoc.inc
   trunk/096/pkg/utils/coords/pkg.cfg
Removed:
   trunk/096/scripts/include/OLD/coords.inc
   trunk/096/scripts/include/OLD/findCity.inc
   trunk/096/scripts/include/OLD/isValidLoc.inc
Modified:
   trunk/096/pkg/items/runebook/runebook.src
   trunk/096/pkg/mobiles/oldAI/barber.src
   trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src
   trunk/096/pkg/mobiles/oldAI/merchant.src
   trunk/096/pkg/mobiles/oldAI/townHealer.src
   trunk/096/pkg/skills/fishing/SOSMessage.src
   trunk/096/pkg/skills/magery/OLD/gate.src.temp
   trunk/096/pkg/skills/magery/OLD/magicLock.src.temp
   trunk/096/pkg/skills/magery/OLD/magicTrap.src.temp
   trunk/096/pkg/skills/magery/OLD/recall.src.temp
   trunk/096/pkg/skills/magery/OLD/teleport.src.temp
   trunk/096/pkg/systems/housing/houseDeed.src
Log:
Installed a "coords" package in utils area. Moved coords.inc, findCity.inc, and isValidLoc.inc to this package.

Upgraded all files with these includes to the new pkgname:path for them.

Modified: trunk/096/pkg/items/runebook/runebook.src
===================================================================
--- trunk/096/pkg/items/runebook/runebook.src	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/items/runebook/runebook.src	2005-11-15 06:18:44 UTC (rev 1002)
@@ -5,7 +5,7 @@
 include "customSpells";
 include "include/math";
 include "include/client";
-include "include/OLD/coords";
+include ":coords:coords";
 include ":itemutils:canAccess";
 
 const OBJTYPE_RUNE := 0x1f14;

Modified: trunk/096/pkg/mobiles/oldAI/barber.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/barber.src	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/mobiles/oldAI/barber.src	2005-11-15 06:18:44 UTC (rev 1002)
@@ -11,7 +11,7 @@
 include ":npcutils:NPCBackpacks";
 include "include/client";
 include ":npcutils:anchors";
-include "include/OLD/findCity";
+include ":coords:findCity";
 include ":begging:begging";
 include ":attributes:attributes";
 include ":npcutils:trainSkill";

Modified: trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/mobiles/oldAI/bucsTownHealer.src	2005-11-15 06:18:44 UTC (rev 1002)
@@ -12,7 +12,7 @@
 include ":npcutils:NPCBackpacks";
 include "include/client";
 include ":npcutils:anchors";
-include "include/OLD/findCity";
+include ":coords:findCity";
 include ":begging:begging";
 include ":npcutils:trainSkill";
 

Modified: trunk/096/pkg/mobiles/oldAI/merchant.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/merchant.src	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/mobiles/oldAI/merchant.src	2005-11-15 06:18:44 UTC (rev 1002)
@@ -11,7 +11,7 @@
 include ":npcutils:NPCBackpacks";
 include "include/client";
 include ":npcutils:anchors";
-include "include/OLD/findCity";
+include ":coords:findCity";
 include ":begging:begging";
 include ":attributes:attributes";
 include ":npcutils:trainSkill";

Modified: trunk/096/pkg/mobiles/oldAI/townHealer.src
===================================================================
--- trunk/096/pkg/mobiles/oldAI/townHealer.src	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/mobiles/oldAI/townHealer.src	2005-11-15 06:18:44 UTC (rev 1002)
@@ -14,7 +14,7 @@
 include "include/client";
 include ":npcutils:anchors";
 include "include/OLD/resurrection";
-include "include/OLD/findCity";
+include ":coords:findCity";
 include ":begging:begging";
 include ":npcutils:trainSkill";
 

Modified: trunk/096/pkg/skills/fishing/SOSMessage.src
===================================================================
--- trunk/096/pkg/skills/fishing/SOSMessage.src	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/skills/fishing/SOSMessage.src	2005-11-15 06:18:44 UTC (rev 1002)
@@ -5,7 +5,7 @@
 use uo;
 use os;
 
-include "include/OLD/coords";
+include ":coords:coords";
 include ":itemutils:canAccess";
 include ":gumps:include/gumps";
 

Modified: trunk/096/pkg/skills/magery/OLD/gate.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/gate.src.temp	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/skills/magery/OLD/gate.src.temp	2005-11-15 06:18:44 UTC (rev 1002)
@@ -1,7 +1,7 @@
 use os;
 use uo;
 
-include "include/isValidLoc";
+include ":coords:isValidLoc";
 include ":itemutils:objtype";
 include "include/client";
 include "include/sound";

Modified: trunk/096/pkg/skills/magery/OLD/magicLock.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magicLock.src.temp	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/skills/magery/OLD/magicLock.src.temp	2005-11-15 06:18:44 UTC (rev 1002)
@@ -5,7 +5,7 @@
 include "include/client";
 include "include/sound";
 include ":attributes:attributes";
-include "include/findCity";
+include ":coords:findCity";
 include "util/key";
 
 

Modified: trunk/096/pkg/skills/magery/OLD/magicTrap.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/magicTrap.src.temp	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/skills/magery/OLD/magicTrap.src.temp	2005-11-15 06:18:44 UTC (rev 1002)
@@ -5,7 +5,7 @@
 include "include/client";
 include ":attributes:attributes";
 include "include/sound";
-include "include/findCity";
+include ":coords:findCity";
 
 
 program spell_magicTrap(parms)

Modified: trunk/096/pkg/skills/magery/OLD/recall.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/recall.src.temp	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/skills/magery/OLD/recall.src.temp	2005-11-15 06:18:44 UTC (rev 1002)
@@ -4,7 +4,7 @@
 
 include "include/client";
 include ":itemutils:objtype";
-include "include/isValidLoc";
+include ":coords:isValidLoc";
 
 
 program spell_recall(parms)

Modified: trunk/096/pkg/skills/magery/OLD/teleport.src.temp
===================================================================
--- trunk/096/pkg/skills/magery/OLD/teleport.src.temp	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/skills/magery/OLD/teleport.src.temp	2005-11-15 06:18:44 UTC (rev 1002)
@@ -4,7 +4,7 @@
 include "include/client";
 include "include/sound";
 include "include/tileEffects";
-include "include/isValidLoc";
+include ":coords:isValidLoc";
 
 
 program spell_teleport( parms )

Modified: trunk/096/pkg/systems/housing/houseDeed.src
===================================================================
--- trunk/096/pkg/systems/housing/houseDeed.src	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/systems/housing/houseDeed.src	2005-11-15 06:18:44 UTC (rev 1002)
@@ -5,9 +5,9 @@
 include "util/key";
 include ":containers:storageAreas";
 include ":itemutils:objtype";
-include "include/OLD/findCity";
+include ":coords:findCity";
 include ":itemutils:canAccess";
-include "include/OLD/isValidLoc";
+include ":coords:isValidLoc";
 
 const UOBJECT_DOORS_START:=0x675;
 const UOBJECT_DOORS_END:=0x6f4;

Added: trunk/096/pkg/utils/coords/config/icp.cfg
===================================================================
--- trunk/096/pkg/utils/coords/config/icp.cfg	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/utils/coords/config/icp.cfg	2005-11-15 06:18:44 UTC (rev 1002)
@@ -0,0 +1,19 @@
+# $Id$
+#
+#
+ICP Register
+{
+	Name		Coordinates and Locations
+	Version		1.0
+	Description	Utilities for calculating coordinates and locations
+
+	Creator		MuadDib
+	C_Email		muaddib at lostsoulsshard.org
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}


Property changes on: trunk/096/pkg/utils/coords/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/coords/include/coords.inc
===================================================================
--- trunk/096/pkg/utils/coords/include/coords.inc	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/utils/coords/include/coords.inc	2005-11-15 06:18:44 UTC (rev 1002)
@@ -0,0 +1,28 @@
+/* $Id$
+ *
+ */
+use basic;
+use math;
+
+function ToSextant(x, y)
+	var latitude_direction, longitude_direction;
+	var latitude_degrees, longitude_degrees;
+	var latitude_minutes, longitude_minutes;
+	latitude_degrees := (y-1624)*0.087890625;
+	longitude_degrees := (x-1323)*0.0703125;
+	if(latitude_degrees < 0)
+		latitude_direction := "N";
+	else
+		latitude_direction := "S";
+	endif
+	if(longitude_degrees < 0)
+		longitude_direction := "W";
+	else
+		longitude_direction := "E";
+	endif
+	latitude_degrees := Abs(latitude_degrees);
+	longitude_degrees := Abs(longitude_degrees);
+	latitude_minutes := CInt((CInt((latitude_degrees-Floor(latitude_degrees))*100)*60)/100);
+	longitude_minutes := CInt((CInt((longitude_degrees-Floor(longitude_degrees))*100)*60)/100);
+	return(Floor(latitude_degrees) + "o " + latitude_minutes + "'" + latitude_direction + ", " + Floor(longitude_degrees) + "o " + longitude_minutes + "'" + longitude_direction);
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/utils/coords/include/coords.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/coords/include/findCity.inc
===================================================================
--- trunk/096/pkg/utils/coords/include/findCity.inc	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/utils/coords/include/findCity.inc	2005-11-15 06:18:44 UTC (rev 1002)
@@ -0,0 +1,54 @@
+/* $Id$
+ *
+ */
+/*
+ * ToDo:	Needs upgraded for realm support.
+ *		Needs upgraded to use config files for city coords.
+ */
+use os;
+use uo;
+
+function FindCity(me)
+	if(me.x>=1244 && me.y>=1530 && me.x<=1704 && me.y<=1758)
+		return "Britain";
+	elseif(me.x>=4379 && me.y>=1045 && me.x<=4487 && me.y<=1178)
+		return "Moonglow";
+	elseif(me.x>=5137 && me.y>=3948 && me.x<=5196 && me.y<=4082)
+		return "Delucia";
+	elseif(me.x>=5196 && me.y>=3923 && me.x<=5322 && me.y<=4085)
+		return "Delucia";
+	elseif(me.x>=5638 && me.y>=3083 && me.x<=5799 && me.y<=3328)
+		return "Papua";
+	elseif(me.x>=5799 && me.y>=3121 && me.x<=5822 && me.y<=3327)
+		return "Papua";
+	elseif(me.x>=1294 && me.y>=3664 && me.x<=1506 && me.y<=3886)
+		return "Jhelom";
+	elseif(me.x>=494 && me.y>=926 && me.x<=600 && me.y<=1034)
+		return "Yew";
+	elseif(me.x>=590 && me.y>=796 && me.x<=670 && me.y<=886)
+		return "Empath Abbey";
+	elseif(me.x>=2394 && me.y>=370 && me.x<=2624 && me.y<=632)
+		return "Minoc";
+	elseif(me.x>=1794 && me.y>=2638 && me.x<=2136 && me.y<=2902)
+		return "Trinsic";
+	elseif(me.x>=538 && me.y>=2106 && me.x<=686 && me.y<=2274)
+		return "Skara Brae";
+	elseif(me.x>=3646 && me.y>=2040 && me.x<=3814 && me.y<=2280)
+		return "Magincia";
+	elseif(me.x>=3588 && me.y>=2446 && me.x<=3762 && me.y<=2690)
+		return "Occlo";
+	elseif(me.x>=2612 && me.y>=2082 && me.x<=2772 && me.y<=2256)
+		return "Buccaneers Den";
+	elseif(me.x>=3496 && me.y>=1062 && me.x<=3808 && me.y<=1400)
+		return "Nujelm";
+	elseif(me.x>=2794 && me.y>=634 && me.x<=3026 && me.y<=1000)
+		return "Vesper";
+	elseif(me.x>=2206 && me.y>=1116 && me.x<=2290 && me.y<=1236)
+		return "Cove";
+	elseif(me.x>=5120 && me.y>=0 && me.x<=5374 && me.y<=254)
+		return "Wind";
+	elseif(me.x>=1382 && me.y>=3955 && me.x<=1528 && me.y<=4044)
+		return "Jhelom";
+	endif
+	return "no city";
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/utils/coords/include/findCity.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/coords/include/isValidLoc.inc
===================================================================
--- trunk/096/pkg/utils/coords/include/isValidLoc.inc	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/utils/coords/include/isValidLoc.inc	2005-11-15 06:18:44 UTC (rev 1002)
@@ -0,0 +1,59 @@
+/* $Id$
+ *
+ */
+use uo;
+use polsys;
+
+function isValidLoc(x, y, realm := "britannia" )
+   if(realm == "britannia" || realm == "britannia_alt")
+
+	  if((x >= 5112) && (x <= 5213))
+	    if((y >= 1093) && (y <= 1213))
+	      return 0;
+	    endif
+	  endif
+
+	  if((x >= 5120) && (x <= 5374))
+	    if((y >= 265) && (y <= 512))
+	      return 0;
+	    endif
+	  endif
+
+	  if((x >= 5890) && (x <= 6142))
+	    if((y >= 514) && (y <= 1278))
+	      return 0;
+	    endif
+	  endif
+
+	  if((x >= 5376) && (x <= 5910))
+	    if((y >= 1030) && (y <= 1276))
+	      return 0;
+	    endif
+	  endif
+
+	  if((x >= 5422) && (x <= 6142))
+	    if((y >= 1536) && (y <= 1796))
+	      return 0;
+	    endif
+	  endif
+
+	  if((x >= 5632) && (x <= 6142))
+	    if((y >= 1784) && (y <= 2303))
+	      return 0;
+	    endif
+	  endif
+
+	  if((x >= 5120) && (x <= 5680))
+	    if((y >= 2048) && (y <= 2303))
+	      return 0;
+	    endif
+	  endif
+
+  else
+  	var realm := Realms()[realm];
+  	if( x >= realm.width || y >= realm.height )
+  		return 0;
+  	endif
+  endif
+  return 1;
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/utils/coords/include/isValidLoc.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/utils/coords/pkg.cfg
===================================================================
--- trunk/096/pkg/utils/coords/pkg.cfg	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/pkg/utils/coords/pkg.cfg	2005-11-15 06:18:44 UTC (rev 1002)
@@ -0,0 +1,13 @@
+# $Id$
+#
+#
+Enabled		1
+Name		coords
+Version		1.0
+
+Creator		MuadDib
+CEmail		muaddib at lostsoulsshard.org
+Maintainer	Distro Team
+Email		distro at polserver.com
+
+CoreRequired	96


Property changes on: trunk/096/pkg/utils/coords/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/096/scripts/include/OLD/coords.inc
===================================================================
--- trunk/096/scripts/include/OLD/coords.inc	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/scripts/include/OLD/coords.inc	2005-11-15 06:18:44 UTC (rev 1002)
@@ -1,25 +0,0 @@
-use basic;
-use math;
-
-function ToSextant(x, y)
-  var latitude_direction, longitude_direction;
-  var latitude_degrees, longitude_degrees;
-  var latitude_minutes, longitude_minutes;
-  latitude_degrees := (y-1624)*0.087890625;
-  longitude_degrees := (x-1323)*0.0703125;
-  if(latitude_degrees < 0)
-	latitude_direction := "N";
-  else
-	latitude_direction := "S";
-  endif
-  if(longitude_degrees < 0)
-	longitude_direction := "W";
-  else
-	longitude_direction := "E";
-  endif
-  latitude_degrees := Abs(latitude_degrees);
-  longitude_degrees := Abs(longitude_degrees);
-  latitude_minutes := CInt((CInt((latitude_degrees-Floor(latitude_degrees))*100)*60)/100);
-  longitude_minutes := CInt((CInt((longitude_degrees-Floor(longitude_degrees))*100)*60)/100);
-  return(Floor(latitude_degrees) + "o " + latitude_minutes + "'" + latitude_direction + ", " + Floor(longitude_degrees) + "o " + longitude_minutes + "'" + longitude_direction);
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/OLD/findCity.inc
===================================================================
--- trunk/096/scripts/include/OLD/findCity.inc	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/scripts/include/OLD/findCity.inc	2005-11-15 06:18:44 UTC (rev 1002)
@@ -1,47 +0,0 @@
-use os;
-use uo;
-
-function FindCity(me)
-  if(me.x>=1244 && me.y>=1530 && me.x<=1704 && me.y<=1758)
-    return "Britain";
-  elseif(me.x>=4379 && me.y>=1045 && me.x<=4487 && me.y<=1178)
-    return "Moonglow";
-  elseif(me.x>=5137 && me.y>=3948 && me.x<=5196 && me.y<=4082)
-    return "Delucia";
-  elseif(me.x>=5196 && me.y>=3923 && me.x<=5322 && me.y<=4085)
-    return "Delucia";
-  elseif(me.x>=5638 && me.y>=3083 && me.x<=5799 && me.y<=3328)
-    return "Papua";
-  elseif(me.x>=5799 && me.y>=3121 && me.x<=5822 && me.y<=3327)
-    return "Papua";
-  elseif(me.x>=1294 && me.y>=3664 && me.x<=1506 && me.y<=3886)
-    return "Jhelom";
-  elseif(me.x>=494 && me.y>=926 && me.x<=600 && me.y<=1034)
-    return "Yew";
-  elseif(me.x>=590 && me.y>=796 && me.x<=670 && me.y<=886)
-    return "Empath Abbey";
-  elseif(me.x>=2394 && me.y>=370 && me.x<=2624 && me.y<=632)
-    return "Minoc";
-  elseif(me.x>=1794 && me.y>=2638 && me.x<=2136 && me.y<=2902)
-    return "Trinsic";
-  elseif(me.x>=538 && me.y>=2106 && me.x<=686 && me.y<=2274)
-    return "Skara Brae";
-  elseif(me.x>=3646 && me.y>=2040 && me.x<=3814 && me.y<=2280)
-    return "Magincia";
-  elseif(me.x>=3588 && me.y>=2446 && me.x<=3762 && me.y<=2690)
-    return "Occlo";
-  elseif(me.x>=2612 && me.y>=2082 && me.x<=2772 && me.y<=2256)
-    return "Buccaneers Den";
-  elseif(me.x>=3496 && me.y>=1062 && me.x<=3808 && me.y<=1400)
-    return "Nujelm";
-  elseif(me.x>=2794 && me.y>=634 && me.x<=3026 && me.y<=1000)
-    return "Vesper";
-  elseif(me.x>=2206 && me.y>=1116 && me.x<=2290 && me.y<=1236)
-    return "Cove";
-  elseif(me.x>=5120 && me.y>=0 && me.x<=5374 && me.y<=254)
-    return "Wind";
-  elseif(me.x>=1382 && me.y>=3955 && me.x<=1528 && me.y<=4044)
-    return "Jhelom";
-  endif
-  return "no city";
-endfunction
\ No newline at end of file

Deleted: trunk/096/scripts/include/OLD/isValidLoc.inc
===================================================================
--- trunk/096/scripts/include/OLD/isValidLoc.inc	2005-11-14 21:06:03 UTC (rev 1001)
+++ trunk/096/scripts/include/OLD/isValidLoc.inc	2005-11-15 06:18:44 UTC (rev 1002)
@@ -1,57 +0,0 @@
-use uo;
-use polsys;
-
-function isValidLoc(x, y, realm := "britannia" )
- 
-  if(realm == "britannia" || realm == "britannia_alt")
-  
-	  if((x >= 5112) && (x <= 5213))
-	    if((y >= 1093) && (y <= 1213))
-	      return 0;
-	    endif
-	  endif
-	
-	  if((x >= 5120) && (x <= 5374))
-	    if((y >= 265) && (y <= 512))
-	      return 0;
-	    endif
-	  endif
-	
-	  if((x >= 5890) && (x <= 6142))
-	    if((y >= 514) && (y <= 1278))
-	      return 0;
-	    endif
-	  endif
-	
-	  if((x >= 5376) && (x <= 5910))
-	    if((y >= 1030) && (y <= 1276))
-	      return 0;
-	    endif
-	  endif
-	
-	  if((x >= 5422) && (x <= 6142))
-	    if((y >= 1536) && (y <= 1796))
-	      return 0;
-	    endif
-	  endif
-	
-	  if((x >= 5632) && (x <= 6142))
-	    if((y >= 1784) && (y <= 2303))
-	      return 0;
-	    endif
-	  endif
-	
-	  if((x >= 5120) && (x <= 5680))
-	    if((y >= 2048) && (y <= 2303))
-	      return 0;
-	    endif
-	  endif
-  
-  else
-  	var realm := Realms()[realm];
-  	if( x >= realm.width || y >= realm.height )
-  		return 0;
-  	endif
-  endif
-  return 1;
-endfunction
\ No newline at end of file



From muaddiblsd at berlios.de  Tue Nov 15 09:47:22 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Tue, 15 Nov 2005 09:47:22 +0100
Subject: [Poldistro-svn] r1003 - trunk/096/pkg/skills/magery
Message-ID: <200511150847.jAF8lM1w022522@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-15 09:46:57 +0100 (Tue, 15 Nov 2005)
New Revision: 1003

Modified:
   trunk/096/pkg/skills/magery/spellStarter.src
   trunk/096/pkg/skills/magery/spells.cfg
Log:
Updated for Recall. Added unhiding to spell starter. Added power words to spell starter.

Modified: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-15 06:18:44 UTC (rev 1002)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-15 08:46:57 UTC (rev 1003)
@@ -20,17 +20,17 @@
 	var scroll	:= params[3]; // Scroll object being used.
 	var targ	:= params[4]; // NPC target
 	params := 0;	// No longer needed
-	
+
 	if ( !Attach(who) )
 		SendSysMessage(who, "You are already doing something.");
 		return 0;
 	endif
-	
+
 	var spell_elem := MS_GetSpellsCfgElem(spell_id);
 
 	// If spell is set to 'TestOnly 1', then it requires cmdlevel or #SpellTester CProp before it can be used.
 	if ( spell_elem.TestOnly && (!who.cmdlevel) )
-		// They need #TestSpell to cast it
+		// They need #SpellTester to cast it
 		if ( !GetObjProperty(who, "#SpellTester") )
 			FailSpell(who);
 			return 0;
@@ -47,6 +47,10 @@
 		SetObjProperty(who, "#medding", 1);
 	endif
 
+	if ( !who.squelched )
+		who.hidden := 0;
+		SpeakPowerWords(who, spell_id);
+	endif
 	if ( who.squelched && !who.npctemplate )
 		SendSysMessage(who, "Something prevents you from casting.");
 		FailSpell(who);
@@ -69,7 +73,7 @@
 		if ( !attribute )
 			attribute := MAGERY;
 		endif
-		
+
 		var difficulty := spell_elem.Difficulty;
 		if ( !difficulty )
 			difficulty := -1;
@@ -88,7 +92,7 @@
 			if ( script.errortext )
 				SendSysMessage(who, "Unable to start ["+spell_elem.SpellScript+"] -> "+script.errortext);
 			endif
-			
+
 			var ev;
 			while( script.pid && !ev )
 				ev := wait_for_event(1);
@@ -100,14 +104,14 @@
 
 	MS_SpellDebug(who, "Spell starter completed..");
 	EraseObjProperty(who, "#medding");
-	
+
 	return 1;
 endprogram
 
 function CheckDelay(who, spell_elem)
-	
+
 	SendSysMessage(who, "You begin building the concentration needed to cast.");
-	
+
 	//var script := start_script("movementCheck", {who, GetPid()});
 	//
 	var delay := spell_elem.Delay;
@@ -136,7 +140,7 @@
 			return 0;
 		endif
 	endif
-	
+
 	return 1;
 endfunction
 
@@ -147,9 +151,9 @@
 	elseif ( scroll )
 		return SubtractAmount(scroll, 1);
 	endif
-	
+
 	var reagent_costs := GetConfigStringDictionary(spell_elem, "RegCost");
-	
+
 	// Before consuming, verify that there is enough of everything.
 	foreach amount in ( reagent_costs )
 		amount := CInt(amount);
@@ -157,7 +161,7 @@
 			amount := 1;
 		endif
 		var objtype := GetObjTypeByName(_amount_iter);
-		
+
 		if ( AmountInContainer(who.backpack, objtype) < amount )
 			SendSysMessage(who, "You do not have enough "+GetObjTypeDesc(objtype, (amount>1)));
 			return 0;
@@ -180,6 +184,6 @@
 	EraseObjProperty(who, "#medding");
 	PlayObjectCenteredEffect(who, GFX_SPELL_FAIL, 5, 50);
 	PlaySoundEffect(who, SFX_SPELL_FAIL);
-	
+
 	return 1;
 endfunction

Modified: trunk/096/pkg/skills/magery/spells.cfg
===================================================================
--- trunk/096/pkg/skills/magery/spells.cfg	2005-11-15 06:18:44 UTC (rev 1002)
+++ trunk/096/pkg/skills/magery/spells.cfg	2005-11-15 08:46:57 UTC (rev 1003)
@@ -24,8 +24,8 @@
 	SpellScript	spellScripts/circle1/createFood
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	4
+	Delay		1
 
 	Circle		1
 	PowerWords	In Mani Ylem
@@ -78,7 +78,7 @@
 	Name		Magic Arrow
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle1/magicArrow
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
@@ -96,7 +96,7 @@
 	Name		Night Sight
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle1/nightSight
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
@@ -114,14 +114,14 @@
 	Name		Reactive Armor
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle1/reactiveArmor
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Flam Sanct
 	Circle		1
-	
+
 	RegCost		Garlic		1
 	RegCost		SpiderSilk	1
 	RegCost		SulphurousAsh	1
@@ -133,14 +133,14 @@
 	Name		Weaken
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle1/weaken
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Des Mani
 	Circle		1
-	
+
 	RegCost		Garlic		1
 	RegCost		NightShade	1
 }
@@ -151,14 +151,14 @@
 	Name		Agility
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/agility
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Ex Uus
 	Circle		2
-	
+
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
 }
@@ -169,14 +169,14 @@
 	Name		Cunning
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/cunning
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Uus Wis
 	Circle		2
-	
+
 	RegCost		NightShade	1
 	RegCost		MandrakeRoot	1
 }
@@ -187,14 +187,14 @@
 	Name		Cure
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/cure
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	An Nox
 	Circle		2
-	
+
 	RegCost		Garlic		1
 	RegCost		Ginseng		1
 }
@@ -205,14 +205,14 @@
 	Name		Harm
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/harm
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	An Mani
 	Circle		2
-	
+
 	RegCost		NightShade	1
 	RegCost		SpiderSilk	1
 }
@@ -223,14 +223,14 @@
 	Name		Magic Trap
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/magicTrap
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	In Jux
 	Circle		2
-	
+
 	RegCost		Garlic		1
 	RegCost		SpiderSilk	1
 	RegCost		SulphurousAsh	1
@@ -242,14 +242,14 @@
 	Name		Magic Untrap
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/magicUntrap
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	An Jux
 	Circle		2
-	
+
 	RegCost		Garlic		1
 	RegCost		Ginseng		1
 	RegCost		SulphurousAsh	1
@@ -261,14 +261,14 @@
 	Name		Protection
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/protection
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Uus Sanct
 	Circle		2
-	
+
 	RegCost		Garlic		1
 	RegCost		Ginseng		1
 	RegCost		SulphurousAsh	1
@@ -280,14 +280,14 @@
 	Name		Strength
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle2/strength
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Uus Mani
 	Circle		2
-	
+
 	RegCost		MandrakeRoot	1
 	RegCost		NightShade	1
 }
@@ -298,14 +298,14 @@
 	Name		Bless
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/bless
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Rel Sanct
 	Circle		3
-	
+
 	RegCost		Garlic		1
 	RegCost		MandrakeRoot	1
 }
@@ -316,14 +316,14 @@
 	Name		Fireball
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle23/fireBall
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Vas Flam
 	Circle		3
-	
+
 	RegCost		BlackPearl	1
 	RegCost		SulphurousAsh	1
 }
@@ -334,14 +334,14 @@
 	Name		Magic Lock
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/magicLock
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	An Por
 	Circle		3
-	
+
 	RegCost		BloodMoss	1
 	RegCost		Garlic		1
 	RegCost		SulphurousAsh	1
@@ -353,14 +353,14 @@
 	Name		Poison
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/magicUnlock
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	In Nox
 	Circle		3
-	
+
 	RegCost		NightShade	1
 }
 
@@ -370,14 +370,14 @@
 	Name		Telekinesis
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/telekinesis
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Ort Por Ylem
 	Circle		3
-	
+
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
 }
@@ -388,14 +388,14 @@
 	Name		Teleport
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/teleport
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Rel Por
 	Circle		3
-	
+
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
 }
@@ -406,14 +406,14 @@
 	Name		Unlock
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/unlock
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Ex Por
 	Circle		3
-	
+
 	RegCost		BloodMoss	1
 	RegCost		Garlic		1
 }
@@ -424,14 +424,14 @@
 	Name		Wall of Stone
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle3/wallofStone
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	In Sanct Ylem
 	Circle		3
-	
+
 	RegCost		BloodMoss	1
 	RegCost		Garlic		1
 }
@@ -442,14 +442,14 @@
 	Name		Arch Cure
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/archCure
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Vas An Nox
 	Circle		4
-	
+
 	RegCost		Garlic		1
 	RegCost		Ginseng		1
 	RegCost		MandrakeRoot	1
@@ -461,14 +461,14 @@
 	Name		Arch Protection
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/archProtection
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Vas Uus Sanct
 	Circle		4
-	
+
 	RegCost		Garlic		1
 	RegCost		Ginseng		1
 	RegCost		MandrakeRoot	1
@@ -481,18 +481,18 @@
 	Name		Curse
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/curse
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Des Sanct
 	Circle		4
-	
+
 	RegCost		Garlic		1
 	RegCost		NightShade	1
 	RegCost		SulphurousAsh	1
-}	
+}
 
 Spell 28
 {
@@ -500,14 +500,14 @@
 	Name		Fire Field
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/fireField
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	In Flam Grav
 	Circle		4
-	
+
 	RegCost		SpiderSilk	1
 	RegCost		SulphurousAsh	1
 	RegCost		BlackPearl	1
@@ -519,14 +519,14 @@
 	Name		Greater Heal
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/greaterHeal
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	In Vas Mani
 	Circle		4
-	
+
 	RegCost		Garlic		1
 	RegCost		Ginseng		1
 	RegCost		MandrakeRoot	1
@@ -539,14 +539,14 @@
 	Name		Lightning
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/lightning
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Por Ort Grav
 	Circle		4
-		
+
 	RegCost		BlackPearl	1
 	RegCost		SulphurousAsh	1
 	RegCost 	MandrakeRoot	1
@@ -558,17 +558,17 @@
 	Name		Mana Drain
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/manaDrain
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Ort Rel
 	Circle		4
-	
+
 	RegCost		BlackPearl	1
 	RegCost		MandrakeRoot	1
-	RegCost		SpiderSilk	1	
+	RegCost		SpiderSilk	1
 }
 
 Spell 32
@@ -577,17 +577,17 @@
 	Name		Recall
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle4/recall
-	
+
 	Difficulty	1
-	ManaCost	0
-	Delay		0
-	
+	ManaCost	11
+	Delay		4
+
 	PowerWords	Kal Ort Por
 	Circle		4
-	
+
 	RegCost		BlackPearl	1
 	RegCost		BloodMoss	1
-	RegCost		MandrakeRoot	1	
+	RegCost		MandrakeRoot	1
 }
 
 Spell 33
@@ -596,14 +596,14 @@
 	Name		Blade Spirit
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/bladeSpirit
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	In Jux Hur Ylem
 	Circle		5
-	
+
 	RegCost		BlackPearl	1
 	RegCost		MandrakeRoot	1
 	RegCost		NightShade	1
@@ -615,14 +615,14 @@
 	Name		Dispel Field
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/dispelField
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	An Grav
 	Circle		5
-	
+
 	RegCost		BlackPearl	1
 	RegCost		Garlic		1
 	RegCost		SpiderSilk	1
@@ -635,14 +635,14 @@
 	Name		Incognito
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/incognito
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Kal In Ex
 	Circle		5
-	
+
 	RegCost		BloodMoss	1
 	RegCost		Garlic		1
 	RegCost		NightShade	1
@@ -654,14 +654,14 @@
 	Name		Spell Reflection
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/spellReflection
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	In Jux Sanct
 	Circle		5
-	
+
 	RegCost		Garlic		1
 	RegCost		MandrakeRoot	1
 	RegCost		SpiderSilk	1
@@ -673,14 +673,14 @@
 	Name		Mind Blast
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/mindBlast
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Por Corp Wis
 	Circle		5
-	
+
 	RegCost		BlackPearl	1
 	RegCost		MandrakeRoot	1
 	RegCost		NightShade	1
@@ -693,14 +693,14 @@
 	Name		Paralyze
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/paralyze
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	An Ex Por
 	Circle		5
-	
+
 	RegCost		Garlic		1
 	RegCost		MandrakeRoot	1
 	RegCost		SpiderSilk	1
@@ -712,14 +712,14 @@
 	Name		Poison Field
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/poisonField
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	In Nox Grav
 	Circle		5
-	
+
 	RegCost		BlackPearl	1
 	RegCost		NightShade	1
 	RegCost		SpiderSilk	1
@@ -731,14 +731,14 @@
 	Name		SummonCreature
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle5/summonCreature
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Kal Xen
 	Circle		5
-	
+
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
 	RegCost		SpiderSilk	1
@@ -750,14 +750,14 @@
 	Name		Dispel
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/dispel
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	An Ort
 	Circle		6
-	
+
 	RegCost		Garlic		1
 	RegCost		MandrakeRoot	1
 	RegCost		SulphurousAsh	1
@@ -769,14 +769,14 @@
 	Name		Energy Bolt
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/energyBolt
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Corp Por
 	Circle		6
-	
+
 	RegCost		BlackPearl	1
 	RegCost		NightShade	1
 }
@@ -787,14 +787,14 @@
 	Name		Explosion
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/explosion
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Vas Ort Flam
 	Circle		6
-	
+
 	RegCost		BlackPearl	1
 	RegCost		MandrakeRoot	1
 	RegCost		SulphurousAsh	1
@@ -806,14 +806,14 @@
 	Name		Invisibility
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/invisibility
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	An Lor Xen
 	Circle		6
-	
+
 	RegCost		BloodMoss	1
 	RegCost		NightShade	1
 }
@@ -824,14 +824,14 @@
 	Name		Mark
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/mark
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Kal Por Ylem
 	Circle		6
-	
+
 	RegCost		BlackPearl	1
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
@@ -843,14 +843,14 @@
 	Name		Mass Curse
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/massCurse
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Vas Des Sanct
 	Circle		6
-	
+
 	RegCost		Garlic		1
 	RegCost		MandrakeRoot	1
 	RegCost		NightShade	1
@@ -863,14 +863,14 @@
 	Name		Paralyze Field
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/paralyzeField
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	In Ex Grav
 	Circle		6
-	
+
 	RegCost		BlackPearl	1
 	RegCost		Ginseng		1
 	RegCost		SpiderSilk	1
@@ -882,14 +882,14 @@
 	Name		Reveal
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle6/reveal
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Wis  Quas
 	Circle		6
-	
+
 	RegCost		BloodMoss	1
 	RegCost		SulphurousAsh	1
 }
@@ -900,14 +900,14 @@
 	Name		Chain Lightning
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/chainLightning
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Vas Ort Grav
 	Circle		7
-	
+
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
 	RegCost		BlackPearl	1
@@ -920,14 +920,14 @@
 	Name		Energy Field
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/energyField
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	In Sanct Grav
 	Circle		7
-	
+
 	RegCost		BlackPearl	1
 	RegCost		MandrakeRoot	1
 	RegCost		SpiderSilk	1
@@ -940,14 +940,14 @@
 	Name		FlameStrike
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/flameStrike
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Kal Vas Flam
 	Circle		7
-	
+
 	RegCost		SpiderSilk	1
 	RegCost		SulphurousAsh	1
 }
@@ -958,14 +958,14 @@
 	Name		Gate
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/gate
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Vas Rel Por
 	Circle		7
-	
+
 	RegCost		BlackPearl	1
 	RegCost		MandrakeRoot	1
 	RegCost		SulphurousAsh	1
@@ -977,14 +977,14 @@
 	Name		Mana Vampire
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/manaVampire
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Ort Sanct
 	Circle		7
-	
+
 	RegCost		BlackPearl	1
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
@@ -997,14 +997,14 @@
 	Name		Mass Dispel
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/massDispel
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Vas An Ort
 	Circle		7
-	
+
 	RegCost		BlackPearl	1
 	RegCost		Garlic		1
 	RegCost		MandrakeRoot	1
@@ -1017,14 +1017,14 @@
 	Name		Meteor Swarm
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/meteorSwarm
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Kal Des Flam Ylem
 	Circle		7
-	
+
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
 	RegCost		SpiderSilk	1
@@ -1037,14 +1037,14 @@
 	Name		Polymorph
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle7/polymorph
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Vas Ylem Rel
 	Circle		7
-	
+
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
 	RegCost		SpiderSilk	1
@@ -1056,11 +1056,11 @@
 	Name		Earthquake
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/earthquake
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	In Vas Por
 	Circle		8
 
@@ -1076,15 +1076,15 @@
 	Name		EnergyVortex
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/energyVortex
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	Vas Corp Por
 	Animation	0x11
 	Circle		8
-	
+
 	RegCost		BlackPearl	1
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
@@ -1097,14 +1097,14 @@
 	Name		Resurrection
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/resurrection
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	PowerWords	An Corp
 	Circle		8
-	
+
 	RegCost		BloodMoss	1
 	RegCost		Garlic		1
 	RegCost		Ginseng		1
@@ -1116,15 +1116,15 @@
 	Name		Summon Air Elemental
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/summonAirElemental
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	Animation	0x11
 	PowerWords	Kal Vas Xen Hur
 	Circle		8
-	
+
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
 	RegCost		SpiderSilk	1
@@ -1136,15 +1136,15 @@
 	Name		Summon Daemon
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/summonDeamon
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	Animation	0x11
 	PowerWords	Kal Vas Xen Corp
 	Circle		8
-	
+
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
 	RegCost		SpiderSilk	1
@@ -1157,15 +1157,15 @@
 	Name		Summon Earth Elemental
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/summonEarthElemental
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	Animation	0x11
 	PowerWords	Kal Vas Xen Ylem
 	Circle		8
-		
+
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
 	RegCost		SpiderSilk	1
@@ -1177,15 +1177,15 @@
 	Name		Summon Fire Elemental
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/summonFireElemental
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	Animation	0x11
 	PowerWords	Kal Vas Xen Flam
 	Circle		8
-		
+
 	RegCost		BloodMoss	1
 	RegCost		MandrakeRoot	1
 	RegCost		SpiderSilk	1
@@ -1198,15 +1198,15 @@
 	Name		Summon Water Elemental
 	Script		spellBook/castSpell
 	SpellScript	spellScripts/circle8/summonWaterElemental
-	
+
 	Difficulty	1
 	ManaCost	0
 	Delay		0
-	
+
 	Animation	0x11
 	PowerWords	Kal Vas Xen An Flam
 	Circle		8
-	
+
 	RegCost		MandrakeRoot	1
 	RegCost		SpiderSilk	1
 }



From muaddiblsd at berlios.de  Tue Nov 15 10:06:42 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Tue, 15 Nov 2005 10:06:42 +0100
Subject: [Poldistro-svn] r1004 - in trunk/096/pkg: items/moongates skills/magery
Message-ID: <200511150906.jAF96gIh004723@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-15 10:06:39 +0100 (Tue, 15 Nov 2005)
New Revision: 1004

Modified:
   trunk/096/pkg/items/moongates/itemdesc.cfg
   trunk/096/pkg/skills/magery/spells.cfg
Log:


Modified: trunk/096/pkg/items/moongates/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/moongates/itemdesc.cfg	2005-11-15 08:46:57 UTC (rev 1003)
+++ trunk/096/pkg/items/moongates/itemdesc.cfg	2005-11-15 09:06:39 UTC (rev 1004)
@@ -5,7 +5,7 @@
 	Desc			magical moongate
        	Graphic			0x0F6C
 	Facing			29
-	
+
 	SaveOnExit		0
 
 	WalkOnScript		systemMoonGate/walkOn
@@ -16,8 +16,10 @@
 	Name			BlueMoonGate
 	Desc			blue moon gate
 	Facing			2
-	
+
 	Movable			0
+
+	WalkOnScript		:walkon:teleport/walkOn
 }
 
 Item 0xDDA
@@ -25,7 +27,7 @@
 	Name			RedMoonGate
 	Desc			red moon gate
 	Facing			2
-	
+
 	Movable			0
 }
 
@@ -34,7 +36,7 @@
 	Name			BlackMoonGate
 	Desc			black moon gate
 	Facing			2
-	
+
 	Movable			0
 }
 
@@ -42,8 +44,8 @@
 {
 	Name			WhiteMoonGate
 	Desc			white moon gate
-	
+
 	Facing			2
-	
+
 	Movable			0
 }
\ No newline at end of file

Modified: trunk/096/pkg/skills/magery/spells.cfg
===================================================================
--- trunk/096/pkg/skills/magery/spells.cfg	2005-11-15 08:46:57 UTC (rev 1003)
+++ trunk/096/pkg/skills/magery/spells.cfg	2005-11-15 09:06:39 UTC (rev 1004)
@@ -960,8 +960,8 @@
 	SpellScript	spellScripts/circle7/gate
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	40
+	Delay		7
 
 	PowerWords	Vas Rel Por
 	Circle		7



From muaddiblsd at berlios.de  Tue Nov 15 10:20:21 2005
From: muaddiblsd at berlios.de (Scott E. Royalty at BerliOS)
Date: Tue, 15 Nov 2005 10:20:21 +0100
Subject: [Poldistro-svn] r1005 - in trunk/096/pkg: commands/coun items/bountyboard items/bountyboard/config items/containers items/guildstone/config items/hair items/hair/config items/hair/cuthair items/hair/hairdye items/keys items/keys/config items/keys/include items/keys/key items/keys/keyring items/moongates/config items/moongates/systemMoonGate items/mounts/config mobiles/brainAI/bundled/banker mobiles/newCharacter mobiles/newCharacter/config mobiles/newCharacter/include skills/lumberjacking skills/magery/config skills/magery/recallRune skills/magery/spellScripts/circle4 skills/magery/spellScripts/circle7 systems/combat/config utils/saver/config utils/scheduler utils/scheduler/config
Message-ID: <200511150920.jAF9KLIc009504@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-15 10:20:06 +0100 (Tue, 15 Nov 2005)
New Revision: 1005

Added:
   trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src
   trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src
Modified:
   trunk/096/pkg/commands/coun/reveal.txt
   trunk/096/pkg/items/bountyboard/config/autoLoad.cfg
   trunk/096/pkg/items/bountyboard/itemdesc.cfg
   trunk/096/pkg/items/containers/onDelete.src
   trunk/096/pkg/items/guildstone/config/autoLoad.cfg
   trunk/096/pkg/items/hair/config/hairColors.cfg
   trunk/096/pkg/items/hair/config/icp.cfg
   trunk/096/pkg/items/hair/cuthair/control.src
   trunk/096/pkg/items/hair/hairdye/use.src
   trunk/096/pkg/items/hair/itemdesc.cfg
   trunk/096/pkg/items/hair/pkg.cfg
   trunk/096/pkg/items/keys/config/icp.cfg
   trunk/096/pkg/items/keys/include/key.inc
   trunk/096/pkg/items/keys/itemdesc.cfg
   trunk/096/pkg/items/keys/key/methods.src
   trunk/096/pkg/items/keys/key/use.src
   trunk/096/pkg/items/keys/keyring/canInsert.src
   trunk/096/pkg/items/keys/keyring/onRemove.src
   trunk/096/pkg/items/keys/keyring/use.src
   trunk/096/pkg/items/keys/pkg.cfg
   trunk/096/pkg/items/moongates/config/autoload.cfg
   trunk/096/pkg/items/moongates/systemMoonGate/moongateInit.src
   trunk/096/pkg/items/moongates/systemMoonGate/walkOn.src
   trunk/096/pkg/items/mounts/config/icp.cfg
   trunk/096/pkg/mobiles/brainAI/bundled/banker/combat.src
   trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src
   trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src
   trunk/096/pkg/mobiles/newCharacter/config/icp.cfg
   trunk/096/pkg/mobiles/newCharacter/config/startEquip.cfg
   trunk/096/pkg/mobiles/newCharacter/include/newCharacter.inc
   trunk/096/pkg/mobiles/newCharacter/onCreate.src
   trunk/096/pkg/mobiles/newCharacter/onDelete.src
   trunk/096/pkg/mobiles/newCharacter/pkg.cfg
   trunk/096/pkg/skills/lumberjacking/itemdesc.cfg
   trunk/096/pkg/skills/magery/config/runeColor.cfg
   trunk/096/pkg/skills/magery/recallRune/methods.src
   trunk/096/pkg/skills/magery/recallRune/use.src
   trunk/096/pkg/systems/combat/config/icp.cfg
   trunk/096/pkg/utils/saver/config/autoLoad.cfg
   trunk/096/pkg/utils/saver/config/icp.cfg
   trunk/096/pkg/utils/scheduler/config/icp.cfg
   trunk/096/pkg/utils/scheduler/start.src
Log:



Property changes on: trunk/096/pkg/commands/coun/reveal.txt
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/bountyboard/config/autoLoad.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/bountyboard/itemdesc.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/containers/onDelete.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/guildstone/config/autoLoad.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/hair/config/hairColors.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/hair/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/hair/cuthair/control.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/hair/hairdye/use.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/hair/itemdesc.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/hair/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/keys/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/keys/include/key.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/keys/itemdesc.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/keys/key/methods.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/keys/key/use.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/keys/keyring/canInsert.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/keys/keyring/onRemove.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/keys/keyring/use.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/keys/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/moongates/config/autoload.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/moongates/systemMoonGate/moongateInit.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/moongates/systemMoonGate/walkOn.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/mounts/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/bundled/banker/combat.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/bundled/banker/init.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/newCharacter/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/newCharacter/config/startEquip.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/newCharacter/include/newCharacter.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/newCharacter/onCreate.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/newCharacter/onDelete.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/newCharacter/pkg.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/lumberjacking/itemdesc.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/config/runeColor.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/recallRune/methods.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/recallRune/use.src
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src
===================================================================
--- trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src	2005-11-15 09:06:39 UTC (rev 1004)
+++ trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src	2005-11-15 09:20:06 UTC (rev 1005)
@@ -0,0 +1,220 @@
+/* $Id$
+ *
+ */
+use uo;
+use os;
+
+include ":attributes:attributes";
+include ":magery:spells";
+include ":itemutils:objtype";
+include ":coords:isValidLoc";
+include ":runebook:runebookFunctions";
+
+program SpellScript(params)
+	var who := params[1];
+	var runebook_info := params[4];
+	//var info := params[2];
+	params := 0; // No longer needed
+
+	if( TypeOf(runebook_info) == "Array" )
+		RunebookRecall(who, runebook_info);
+		return 1;
+	endif
+
+	var prompt := "Select an object to recall from.";
+	var recall_rune := MS_Target(who, 0, prompt, TGTOPT_CHECK_LOS+TGTOPT_NEUTRAL);
+	if( (recall_rune.objtype != UOBJ_RUNE) && (recall_rune.objtype != 0x6100))
+		SendSysMessage(who, "You can only cast that on a recall rune or runebook.");
+		return 0;
+	endif
+	if( !ReserveItem(recall_rune) )
+		return 0;
+	endif
+
+	if( GetObjProperty(recall_rune, "Vendored") )
+		SendSysMessage(who, "You cannot recall off of runes on a vendor.");
+		return 0;
+	endif
+	var tox := CInt(GetObjProperty( recall_rune, "x" ));
+	var toy := CInt(GetObjProperty( recall_rune, "y" ));
+	var toz := CInt(GetObjProperty( recall_rune, "z" ));
+	var torealm :=  GetObjProperty( recall_rune, "realm" );
+	if(!tox)
+		SendSysMessage(who, "That item is not marked.");
+		return 0;
+	endif
+	if(!torealm)
+		torealm := "britannia";
+	endif
+
+	if( !isValidLoc(tox,toy,torealm) )
+		SendSysMessage(who, "Invalid recall location.");
+		if( recall_rune.objtype == 0x6100 )
+			RemoveRunebookDefault(recall_rune);
+			return 0;
+		else
+			DestroyItem(recall_rune);
+			return 0;
+		endif
+	endif
+
+	PlaySoundEffect(who, 0x210);
+
+	if( (who.x >= 5120) && (who.x <= 5375) && (who.y >= 0) && (who.y <= 255) )
+		SendSysMessage(who, "Your spell fails and consumes the rune!");
+		if(recall_rune.objtype == UOBJ_RUNE)
+			DestroyItem(recall_rune);
+		elseif(recall_rune.objtype == 0x6100)
+			RemoveRunebookDefault(recall_rune);
+		endif
+		return 0;
+	endif
+
+	var signs := ListItemsNearLocationOfType( tox, toy, toz, 30, 0x7060, torealm);
+	foreach sign in signs
+		var infoarr := GetObjProperty(sign, "homeinfo");
+		if( infoarr )
+			if( (tox >= infoarr[2]) && (tox <= infoarr[4]) && (toy >= infoarr[3]) && (toy <= infoarr[5]) )
+				SendSysMessage(who, "Something is blocking the location.");
+				return 0;
+				break;
+			endif
+		endif
+	endforeach
+
+	var multicheck := CreateItemAtLocation(1, 1, 0, 0xeed, 1, torealm);
+	multicheck.invisible := 1;
+	if( !MoveItemToLocation(multicheck, tox, toy, toz, MOVEITEM_NORMAL) )
+		SendSysMessage(who, "Something is blocking the location.");
+		if(recall_rune.objtype == UOBJ_RUNE)
+			DestroyItem(recall_rune);
+		elseif(recall_rune.objtype == 0x6100)
+			RemoveRunebookDefault(recall_rune);
+		endif
+		return 0;
+	endif
+	if(multicheck.multi)
+		SendSysMessage(who,"Something is blocking the location.");
+		if(recall_rune.objtype == UOBJ_RUNE)
+			DestroyItem(recall_rune);
+		elseif(recall_rune.objtype == 0x6100)
+			RemoveRunebookDefault(recall_rune);
+		endif
+		return 0;
+	endif
+	DestroyItem(multicheck);
+	MoveObjectToLocation( who, tox, toy, toz, torealm );
+	PlaySoundEffect(who, 0x1fd);
+	return 1;
+endprogram
+
+function RemoveRunebookDefault(runebook)
+	var tox := CInt(GetObjProperty( runebook, "x" ));
+	var toy := CInt(GetObjProperty( runebook, "y" ));
+	var toz := CInt(GetObjProperty( runebook, "z" ));
+	var torealm := GetObjProperty( runebook, "realm" );
+	var rune_list := GetRuneList(runebook);
+
+	foreach rune_entry in rune_list
+		if( (Cint(rune_list.X) == tox) && (Cint(rune_list.Y) == toy) && (Cint(rune_list.Z) == toz) && (Cint(rune_list.Realm) == torealm) )
+			rune_list.Erase(rune_entry);
+		endif
+	endforeach
+
+	SetObjProperty(runebook, "%RuneList%", rune_list);
+	EraseObjProperty(runebook, "x");
+	EraseObjProperty(runebook, "y");
+	EraseObjProperty(runebook, "z");
+	EraseObjProperty(runebook, "realm");
+	return 1;
+endfunction
+
+
+function RemoveRunebookEntry(runebook, rune_info)
+	var tox := CInt(rune_info.X);
+	var toy := CInt(rune_info.Y);
+	var toz := CInt(rune_info.Z);
+	var torealm :=  rune_info.Realm;
+	var rune_list := GetRuneList(runebook);
+
+	foreach rune_entry in rune_list
+		if( (Cint(rune_list.X) == tox) && (Cint(rune_list.Y) == toy) && (Cint(rune_list.Z) == toz) && (Cint(rune_list.Realm) == torealm) )
+			rune_list.Erase(rune_entry);
+		endif
+	endforeach
+
+	SetObjProperty(runebook, "%RuneList%", rune_list);
+	EraseObjProperty(runebook, "x");
+	EraseObjProperty(runebook, "y");
+	EraseObjProperty(runebook, "z");
+	EraseObjProperty(runebook, "realm");
+	return 1;
+endfunction
+
+
+function RunebookRecall(who, runebook_info)
+	var runebook := runebook_info[1];
+	var rune_info := runebook_info[2];
+
+	if( !ReserveItem(runebook) )
+		return 0;
+	endif
+
+	if( GetObjProperty(runebook, "Vendored") )
+		SendSysMessage(who, "You cannot recall off of runebooks on a vendor.");
+		return 0;
+	endif
+	var tox := CInt(rune_info.X);
+	var toy := CInt(rune_info.Y);
+	var toz := CInt(rune_info.Z);
+	var torealm :=  rune_info.Realm;
+	if(!tox)
+		SendSysMessage(who, "That is an invalid location.");
+		return 0;
+	endif
+	if(!torealm)
+		torealm := "britannia";
+	endif
+
+	if( !isValidLoc(tox,toy,torealm) )
+		SendSysMessage(who, "Invalid recall location.");
+		RemoveRunebookEntry(runebook, rune_info);
+		return 0;
+	endif
+
+	PlaySoundEffect(who, 0x210);
+
+	if( (who.x >= 5120) && (who.x <= 5375) && (who.y >= 0) && (who.y <= 255) )
+		SendSysMessage(who, "Your spell fails and consumes the rune!");
+		RemoveRunebookEntry(runebook, rune_info);
+		return 0;
+	endif
+
+	var signs := ListItemsNearLocationOfType( tox, toy, toz, 30, 0x7060, torealm);
+	foreach sign in signs
+		var infoarr := GetObjProperty(sign, "homeinfo");
+		if( infoarr )
+			if( (tox >= infoarr[2]) && (tox <= infoarr[4]) && (toy >= infoarr[3]) && (toy <= infoarr[5]) )
+				SendSysMessage(who, "Something is blocking the location.");
+				return 0;
+				break;
+			endif
+		endif
+	endforeach
+
+	var multicheck := CreateItemAtLocation(1, 1, 0, 0xeed, 1, torealm);
+	multicheck.invisible := 1;
+	if( !MoveItemToLocation(multicheck, tox, toy, toz, MOVEITEM_NORMAL) )
+		SendSysMessage(who, "Something is blocking the location.");
+		return 0;
+	endif
+	if(multicheck.multi)
+		SendSysMessage(who,"A house is blocking the location.");
+		RemoveRunebookEntry(runebook, rune_info);
+		return 0;
+	endif
+	DestroyItem(multicheck);
+	MoveObjectToLocation( who, tox, toy, toz, torealm );
+	PlaySoundEffect(who, 0x1fd);
+	return 1;
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src
===================================================================
--- trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src	2005-11-15 09:06:39 UTC (rev 1004)
+++ trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src	2005-11-15 09:20:06 UTC (rev 1005)
@@ -0,0 +1,282 @@
+/* $Id$
+ *
+ */
+use uo;
+use os;
+
+include ":attributes:attributes";
+include ":magery:spells";
+include ":itemutils:objtype";
+include ":coords:isValidLoc";
+include ":runebook:runebookFunctions";
+
+program SpellScript(params)
+	var who := params[1];
+	var runebook_info := params[2].targ;
+	//var info := params[2];
+	params := 0; // No longer needed
+
+	if( TypeOf(runebook_info) == "Array" )
+		RunebookGate(who, runebook_info);
+		return 1;
+	endif
+
+	var prompt := "Select an object to gate from.";
+	var recall_rune := MS_Target(who, 0, prompt, TGTOPT_CHECK_LOS+TGTOPT_NEUTRAL);
+	if( (recall_rune.objtype != UOBJ_RUNE) && (recall_rune.objtype != 0x6100))
+		SendSysMessage(who, "You can only cast that on a recall rune or runebook.");
+		return 0;
+	endif
+	if( !ReserveItem(recall_rune) )
+		return 0;
+	endif
+
+	if( GetObjProperty(recall_rune, "Vendored") )
+		SendSysMessage(who, "You cannot recall off of runes on a vendor.");
+		return 0;
+	endif
+	var tox := CInt(GetObjProperty( recall_rune, "x" ));
+	var toy := CInt(GetObjProperty( recall_rune, "y" ));
+	var toz := CInt(GetObjProperty( recall_rune, "z" ));
+	var torealm :=  GetObjProperty( recall_rune, "realm" );
+	if(!tox)
+		SendSysMessage(who, "That item is not marked.");
+		return 0;
+	endif
+	if(!torealm)
+		torealm := "britannia";
+	endif
+
+	if( !isValidLoc(tox,toy,torealm) )
+		SendSysMessage(who, "Invalid recall location.");
+		if( recall_rune.objtype == 0x6100 )
+			RemoveRunebookDefault(recall_rune);
+			return 0;
+		else
+			DestroyItem(recall_rune);
+			return 0;
+		endif
+	endif
+
+	PlaySoundEffect(who, 0x210);
+
+	if( (who.x >= 5120) && (who.x <= 5375) && (who.y >= 0) && (who.y <= 255) )
+		SendSysMessage(who, "Your spell fails and consumes the rune!");
+		if(recall_rune.objtype == UOBJ_RUNE)
+			DestroyItem(recall_rune);
+		elseif(recall_rune.objtype == 0x6100)
+			RemoveRunebookDefault(recall_rune);
+		endif
+		return 0;
+	endif
+
+	var signs := ListItemsNearLocationOfType( tox, toy, toz, 30, 0x7060, torealm);
+	foreach sign in signs
+		var infoarr := GetObjProperty(sign, "homeinfo");
+		if( infoarr )
+			if( (tox >= infoarr[2]) && (tox <= infoarr[4]) && (toy >= infoarr[3]) && (toy <= infoarr[5]) )
+				SendSysMessage(who, "Something is blocking the location.");
+				return 0;
+				break;
+			endif
+		endif
+	endforeach
+
+	var multicheck := CreateItemAtLocation(1, 1, 0, 0xeed, 1, torealm);
+	multicheck.invisible := 1;
+	if( !MoveItemToLocation(multicheck, tox, toy, toz, MOVEITEM_NORMAL) )
+		SendSysMessage(who, "Something is blocking the location.");
+		if(recall_rune.objtype == UOBJ_RUNE)
+			DestroyItem(recall_rune);
+		elseif(recall_rune.objtype == 0x6100)
+			RemoveRunebookDefault(recall_rune);
+		endif
+		return 0;
+	endif
+	if(multicheck.multi)
+		SendSysMessage(who,"Something is blocking the location.");
+		if(recall_rune.objtype == UOBJ_RUNE)
+			DestroyItem(recall_rune);
+		elseif(recall_rune.objtype == 0x6100)
+			RemoveRunebookDefault(recall_rune);
+		endif
+		return 0;
+	endif
+	DestroyItem(multicheck);
+
+	var wx := who.x;
+	var wy := who.y;
+	var wz := who.z;
+	PlayStationaryEffect( wx, wy, wz, 6899, 1, 30, 0, who.realm );
+	PlayStationaryEffect( tox, toy, toz, 6899, 1, 30, 0, torealm );
+	sleepms(2800);
+	set_critical( 1 );
+	var gate1 := CreateItemAtLocation( wx, wy, wz, UOBJ_BLUE_MOONGATE, 1, who.realm );
+	gate1.movable := 0;
+	var gate2 := CreateItemAtLocation( tox, toy, toz, UOBJ_BLUE_MOONGATE, 1, torealm );
+	gate2.movable := 0;
+	if( !gate1 )
+		DestroyItem(gate2);
+		SendSysMessage(who, "Something is interfering with the spell.");
+		return 0;
+	endif
+	if( !gate2 )
+		DestroyItem(gate1);
+		SendSysMessage(who, "Something is interfering with the spell.");
+		return 0;
+	endif
+	set_critical(0);
+	var dest := dictionary{ "x" -> gate2.x, "y" -> gate2.y, "z" -> gate2.z, "realm" -> gate2.realm};
+	SetObjProperty( gate1, "Destination", dest );
+	dest := dictionary{ "x" -> gate1.x, "y" -> gate1.y, "z" -> gate1.z, "realm" -> gate1.realm};
+	SetObjProperty( gate2, "Destination", dest );
+	Detach();
+	sleep(30);
+	set_critical(1);
+	DestroyItem( gate1 );
+	DestroyItem( gate2 );
+	set_critical(0);
+	return 1;
+endprogram
+
+function RemoveRunebookDefault(runebook)
+	var tox := CInt(GetObjProperty( runebook, "x" ));
+	var toy := CInt(GetObjProperty( runebook, "y" ));
+	var toz := CInt(GetObjProperty( runebook, "z" ));
+	var torealm := GetObjProperty( runebook, "realm" );
+	var rune_list := GetRuneList(runebook);
+
+	foreach rune_entry in rune_list
+		if( (Cint(rune_list.X) == tox) && (Cint(rune_list.Y) == toy) && (Cint(rune_list.Z) == toz) && (Cint(rune_list.Realm) == torealm) )
+			rune_list.Erase(rune_entry);
+		endif
+	endforeach
+
+	SetObjProperty(runebook, "%RuneList%", rune_list);
+	EraseObjProperty(runebook, "x");
+	EraseObjProperty(runebook, "y");
+	EraseObjProperty(runebook, "z");
+	EraseObjProperty(runebook, "realm");
+	return 1;
+endfunction
+
+
+function RemoveRunebookEntry(runebook, rune_info)
+	var tox := CInt(rune_info.X);
+	var toy := CInt(rune_info.Y);
+	var toz := CInt(rune_info.Z);
+	var torealm :=  rune_info.Realm;
+	var rune_list := GetRuneList(runebook);
+
+	foreach rune_entry in rune_list
+		if( (Cint(rune_list.X) == tox) && (Cint(rune_list.Y) == toy) && (Cint(rune_list.Z) == toz) && (Cint(rune_list.Realm) == torealm) )
+			rune_list.Erase(rune_entry);
+		endif
+	endforeach
+
+	SetObjProperty(runebook, "%RuneList%", rune_list);
+	EraseObjProperty(runebook, "x");
+	EraseObjProperty(runebook, "y");
+	EraseObjProperty(runebook, "z");
+	EraseObjProperty(runebook, "realm");
+	return 1;
+endfunction
+
+
+function RunebookGate(who, runebook_info)
+	var runebook := runebook_info[1];
+	var rune_info := runebook_info[2];
+
+	if( !ReserveItem(runebook) )
+		return 0;
+	endif
+
+	if( GetObjProperty(runebook, "Vendored") )
+		SendSysMessage(who, "You cannot recall off of runebooks on a vendor.");
+		return 0;
+	endif
+	var tox := CInt(rune_info.X);
+	var toy := CInt(rune_info.Y);
+	var toz := CInt(rune_info.Z);
+	var torealm :=  rune_info.Realm;
+	if(!tox)
+		SendSysMessage(who, "That is an invalid location.");
+		return 0;
+	endif
+	if(!torealm)
+		torealm := "britannia";
+	endif
+
+	if( !isValidLoc(tox,toy,torealm) )
+		SendSysMessage(who, "Invalid recall location.");
+		RemoveRunebookEntry(runebook, rune_info);
+		return 0;
+	endif
+
+	PlaySoundEffect(who, 0x210);
+
+	if( (who.x >= 5120) && (who.x <= 5375) && (who.y >= 0) && (who.y <= 255) )
+		SendSysMessage(who, "Your spell fails and consumes the rune!");
+		RemoveRunebookEntry(runebook, rune_info);
+		return 0;
+	endif
+
+	var signs := ListItemsNearLocationOfType( tox, toy, toz, 30, 0x7060, torealm);
+	foreach sign in signs
+		var infoarr := GetObjProperty(sign, "homeinfo");
+		if( infoarr )
+			if( (tox >= infoarr[2]) && (tox <= infoarr[4]) && (toy >= infoarr[3]) && (toy <= infoarr[5]) )
+				SendSysMessage(who, "Something is blocking the location.");
+				return 0;
+				break;
+			endif
+		endif
+	endforeach
+
+	var multicheck := CreateItemAtLocation(1, 1, 0, 0xeed, 1, torealm);
+	multicheck.invisible := 1;
+	if( !MoveItemToLocation(multicheck, tox, toy, toz, MOVEITEM_NORMAL) )
+		SendSysMessage(who, "Something is blocking the location.");
+		return 0;
+	endif
+	if(multicheck.multi)
+		SendSysMessage(who,"A house is blocking the location.");
+		RemoveRunebookEntry(runebook, rune_info);
+		return 0;
+	endif
+	DestroyItem(multicheck);
+
+	var wx := who.x;
+	var wy := who.y;
+	var wz := who.z;
+	PlayStationaryEffect( wx, wy, wz, 6899, 1, 30, 0, who.realm );
+	PlayStationaryEffect( tox, toy, toz, 6899, 1, 30, 0, torealm );
+	sleepms(2800);
+	set_critical( 1 );
+	var gate1 := CreateItemAtLocation( wx, wy, wz, UOBJ_BLUE_MOONGATE, 1, who.realm );
+	gate1.movable := 0;
+	var gate2 := CreateItemAtLocation( tox, toy, toz, UOBJ_BLUE_MOONGATE, 1, torealm );
+	gate2.movable := 0;
+	if( !gate1 )
+		DestroyItem(gate2);
+		SendSysMessage(who, "Something is interfering with the spell.");
+		return 0;
+	endif
+	if( !gate2 )
+		DestroyItem(gate1);
+		SendSysMessage(who, "Something is interfering with the spell.");
+		return 0;
+	endif
+	set_critical(0);
+	var dest := dictionary{ "x" -> gate2.x, "y" -> gate2.y, "z" -> gate2.z, "realm" -> gate2.realm};
+	SetObjProperty( gate1, "Destination", dest );
+	dest := dictionary{ "x" -> gate1.x, "y" -> gate1.y, "z" -> gate1.z, "realm" -> gate1.realm};
+	SetObjProperty( gate2, "Destination", dest );
+	Detach();
+	sleep(30);
+	set_critical(1);
+	DestroyItem( gate1 );
+	DestroyItem( gate2 );
+	set_critical(0);
+	return 1;
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/combat/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/utils/saver/config/autoLoad.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/utils/saver/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/utils/scheduler/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/utils/scheduler/start.src
___________________________________________________________________
Name: svn:keywords
   + Id



From muaddiblsd at berlios.de  Tue Nov 15 12:58:13 2005
From: muaddiblsd at berlios.de (muaddiblsd at BerliOS)
Date: Tue, 15 Nov 2005 12:58:13 +0100
Subject: [Poldistro-svn] r1006 - in trunk/096/pkg: items/runebook skills/magery skills/magery/config skills/magery/include skills/magery/spellScripts/circle4 skills/magery/spellScripts/circle6 skills/magery/spellScripts/circle7
Message-ID: <200511151158.jAFBwDxu004862@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-15 12:58:06 +0100 (Tue, 15 Nov 2005)
New Revision: 1006

Added:
   trunk/096/pkg/items/runebook/runebookFunctions.inc
   trunk/096/pkg/skills/magery/include/spellSounds.inc
   trunk/096/pkg/skills/magery/spellScripts/circle6/mark.src
Modified:
   trunk/096/pkg/items/runebook/customSpells.inc
   trunk/096/pkg/items/runebook/itemdesc.cfg
   trunk/096/pkg/items/runebook/runeInsert.src
   trunk/096/pkg/items/runebook/runebook.src
   trunk/096/pkg/skills/magery/config/settings.cfg
   trunk/096/pkg/skills/magery/include/spells.inc
   trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src
   trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src
   trunk/096/pkg/skills/magery/spellStarter.src
   trunk/096/pkg/skills/magery/spells.cfg
Log:
Runebook and spell stuff.

Spellstarter modified to freeze during cast/delay. Target won't check if they move. If scroll is passed as INT 1, it overrides reg and scroll and casts without scroll consumption or requiring reagents. Added for runebooks, wands, and so on.

Gate/Mark/Recall added with compatibility to new runebook system.

Still need to make up all the rune colors for the config.

Added ability to check if austin wears little girl's undies.

Added a timebomb for every time Austin mentions polygons and UO in the same sentece.

Modified: trunk/096/pkg/items/runebook/customSpells.inc
===================================================================
--- trunk/096/pkg/items/runebook/customSpells.inc	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/items/runebook/customSpells.inc	2005-11-15 11:58:06 UTC (rev 1006)
@@ -1,145 +1,29 @@
 use uo;
 use os;
 
-include "include/client";
-include "include/OLD/sound";
-include ":itemutils:objtype";
-include "include/spellRestrictions";
-include ":attributes:attributes";
+function runebookRecall(who, parms, book, charges, use_charge:=0)
+	var runebook_info := array{ book, parms };
+	var script := Start_Script(":magery:spellStarter", {who, 32, 1, runebook_info});
+	if ( script.errortext )
+		SendSysMessage(who, "Error - Could not start spell starter ->"+script.errortext);
+		return 0;
+	endif
+	if( use_charge )
+		charges := charges - 1;
+		SetCharges(book, who, charges);
+	endif
 
-function custom_recall(caster, parms, book)
-  book := book; // stops ecompile "not used" warning
-  caster.hidden := 0;
-  if(AP_GetVital(caster, "Mana") < 11)
-    caster.frozen :=1;
-	PerformAction(caster,ANIM_CAST_DIR);
-    sleepms(1200);
-    caster.frozen :=0;
-    SendSysMessage(caster,"You do not have enough mana to cast that.");
-    PlaySoundEffect(caster,0x005d);
-    PlayObjectCenteredEffect(caster, 0x3735,0x0a, 0x1e);
-    return 0;
-  endif
-  var failure := 0;
-  var circle := 4;
-  var tox := parms[2];
-  var toy := parms[3];
-  var toz := parms[4];
-  SpeakPowerWords( caster, 32 );
-  var delivery := "notarget";
-  var noto := "neutral";
-  var result := maincast(caster, delivery, circle, noto, 32);
-  if(result[1] == 0)
-    return;
-  endif
-  var multicheck := CreateItemAtLocation(tox, toy, toz, 0xeed, 1, caster.realm);
-  multicheck.hidden := 1;
-  if(multicheck.multi.serial)
-    SendSysMessage(caster, "Something is interfering with this spell.");
-    DestroyItem(multicheck);
-    return;
-  endif
-  DestroyItem(multicheck);
-  var signs := ListItemsNearLocationOfType( tox, toy, toz, 30, 0x7060, caster.realm);
-  foreach item in signs
-      var infoarr := GetObjProperty( item, "homeinfo" );
-    if (infoarr)
-      if ((tox >= infoarr[2]) && (tox <= infoarr[4]) && (toy >= infoarr[3]) && (toy <= infoarr[5]))
-        failure := 1;
-      endif
-    endif
-  endforeach
-  if (failure == 0);
-    MoveCharacterToLocation(caster, tox, toy, toz);
-  else
-    SendSysMessage(caster, "Something is interfering with this spell.");
-    return 0;
-  endif
-  PlaySoundEffect(caster, 0x1fd);
-  return 1;
+	return 1;
 endfunction
 
-function custom_gate(caster, parms, book)
-  book := book; // stops ecompile "not used" warning
-  caster.hidden := 0;
-  if(AP_GetVital(caster, "Mana") < 40)
-    caster.frozen :=1;
-	PerformAction(caster,ANIM_CAST_DIR);
-    sleepms(1200);
-    caster.frozen :=0;
-    SendSysMessage(caster,"You do not have enough mana to cast that.");
-    PlaySoundEffect(caster,0x005d);
-    PlayObjectCenteredEffect(caster, 0x3735,0x0a, 0x1e);
-    return 0;
-  endif
-  var circle := 7;
-  var tox := parms[2];
-  var toy := parms[3];
-  var toz := parms[4];
-  SpeakPowerWords( caster, 52 );
-  var delivery := "notarget";
-  var noto := "neutral";
-  var result := maincast(caster, delivery, circle, noto, 52);
-  if(result == 0)
-    return;
-  endif
-  var multicheck := CreateItemAtLocation(tox, toy, toz, 0xeed, 1, caster.realm);
-  multicheck.hidden := 1;
-  if(multicheck.multi.serial)
-    DestroyItem(multicheck);
-    return;
-  endif
-  DestroyItem(multicheck);
-  var signs := ListItemsNearLocationOfType( tox, toy, toz, 30, 0x7060, caster.realm);
-  var chk := 0;
-  foreach item in signs
-    var infoarr := GetObjProperty(item, "homeinfo");
-    if(infoarr)
-      if((tox >= infoarr[2]) && (tox <= infoarr[4]) && (toy >= infoarr[3]) && (toy <= infoarr[5]))
-        chk := 1;
-        break;
-      endif
-    endif
-  endforeach
-  if(chk == 1)
-    return;
-  endif
-  set_critical( 1 );
-  var wx := caster.x;
-  var wy := caster.y;
-  var wz := caster.z;
-  PlayStationaryEffect( wx, wy, wz, 6899, 1, 30, 0, caster.realm );
-  PlayStationaryEffect( tox, toy, toz, 6899, 1, 30, 0, caster.realm );
-  sleepms(2800);
-  set_critical( 1 );
-  var gate1 := CreateItemAtLocation( wx, wy, wz, UOBJ_BLUE_MOONGATE, 1, caster.realm );
-  gate1.movable := 0;
-  var gate2 := CreateItemAtLocation( tox, toy, toz, UOBJ_BLUE_MOONGATE, 1, caster.realm );
-  gate2.movable := 0;
-  if(!gate1)
-    DestroyItem(gate2);
-    SendSysMessage(caster, "Something is interfering with the spell.");
-    return;
-  endif
-  if (!gate2)
-    DestroyItem(gate1);
-    SendSysMessage(caster, "Something is interfering with the spell.");
-    return;
-  endif
-  SetObjProperty( gate1, "GateDestX", gate2.x );
-  SetObjProperty( gate1, "GateDestY", gate2.y );
-  SetObjProperty( gate1, "GateDestZ", gate2.z );
-  SetObjProperty( gate2, "GateDestX", gate1.x );
-  SetObjProperty( gate2, "GateDestY", gate1.y );
-  SetObjProperty( gate2, "GateDestZ", gate1.z );
-  Detach();
-  set_critical( 0 );
-  PlaySoundEffect( caster, SFX_SPELL_GATE_TRAVEL );
-  detach();
-  sleep(30);
-  set_critical(1);
-  DestroyItem( gate1 );
-  DestroyItem( gate2 );
-  set_critical(0);
-  return(1);
+
+function runebookGate(who, parms, book)
+	var runebook_info := array{ book, parms };
+	var script := Start_Script(":magery:spellStarter", {who, 52, 1, runebook_info});
+	if ( script.errortext )
+		SendSysMessage(who, "Error - Could not start spell starter ->"+script.errortext);
+		return 0;
+	endif
+
+	return 1;
 endfunction
\ No newline at end of file

Modified: trunk/096/pkg/items/runebook/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/runebook/itemdesc.cfg	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/items/runebook/itemdesc.cfg	2005-11-15 11:58:06 UTC (rev 1006)
@@ -1,18 +1,18 @@
 Container 0x6100
 {
-    Name             runebook
-    Desc             runebook
-    script           runebook
-    OnInsertScript   runeInsert
-    Graphic          0x0EFA
-    color            542
-    newbie           0
-    movable          1
-    weight           1
-    Gump             0x003E
-    MinX             40
-    MaxX             60
-    MinY             20
-    MaxY             80
-    RequiresAttention 1
+	Name			runebook
+	Desc			runebook
+	Script			runebook
+	OnInsertScript		runeInsert
+	Graphic          	0x0EFA
+	Color			542
+	newbie			0
+	movable			1
+	weight			1
+	Gump			0x003E
+	MinX			40
+	MaxX			60
+	MinY			20
+	MaxY			80
+	RequiresAttention	1
 }
\ No newline at end of file

Modified: trunk/096/pkg/items/runebook/runeInsert.src
===================================================================
--- trunk/096/pkg/items/runebook/runeInsert.src	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/items/runebook/runeInsert.src	2005-11-15 11:58:06 UTC (rev 1006)
@@ -1,124 +1,124 @@
-// //$Id$
-
+/* $Id$
+ *
+ */
 use uo;
 use os;
 
 include ":itemutils:canAccess";
+include ":runebook:runebookFunctions";
 
 program on_insert(who, book, movetype, inserttype, item, existing_stack, amt);
 
 	// Next 4 lines used to fix the "unused variable" report
-	amt := amt;
+	amt            := amt;
 	existing_stack := existing_stack;
-	movetype := movetype;
-	inserttype := inserttype;
+	movetype       := movetype;
+	inserttype     := inserttype;
 
 	var vendorserial := GetObjProperty(book,"Vendor");
-	if(vendorserial)
+	if( vendorserial )
 		SendSysMessage(who, "You cannot insert runes while that is on a vendor.");
 		MoveItemToContainer(item, who.backpack);
 		return;
 	endif
-	if(book.movable == 0)
+	if( book.movable == 0 )
 		SendSysMessage(who, "You cannot do that while the book is locked down.");
 		MoveItemToContainer(item, who.backpack);
 		return 0;
-	elseif (!can_access(who, book) || !can_access(who, item))
+	elseif( !can_access(who, book) || !can_access(who, item) )
 		MoveItemToContainer(item, who.backpack);
 		SendSysMessage(who, "You can't add that when the book is in use.");
-		return;
+		return 0;
 	else
-		if(item.objtype == 0x1f14)
-			AddRune(who, book, item);
-		elseif(item.objtype == 0x1f4c);
-			rechargebook(who, book, item);
+		if( item.objtype == 0x1f14 )
+			return addRune(who, book, item);
+		elseif( item.objtype == 0x1f4c );
+			return recharge_book(who, book, item);
 		else
 			SendSysMessage(who, "You can't put that in a runebook.");
 			MoveItemToContainer(item, who.backpack);
+			return 0;
 		endif
 	endif
 
+	return 1;
 endprogram
 
 
-function rechargebook(who, book, scrolls)
-
-	var charges    := CInt(GetObjProperty(book, "charges"));
-	var maxcharges := CInt(GetObjProperty(book, "maxcharges"));
-	var maxamount  := CInt(maxcharges - charges);
-	var amount     := CInt(scrolls.amount);
-	if(maxamount <= 0)
-		SendSysMessage(who, "This runebook is full.");
+function recharge_book(who, book, scrolls)
+	var charge_prop := GetObjProperty(book, "%Charges%");
+	var charges := charge_prop["charges"];
+	if( !charges )
+		charges := 0;
+	endif
+	var max_charges := charge_prop["max_charges"];
+	if( !max_charges )
+		max_charges := 5;
+	endif
+	var max_amount  := CInt(max_charges - charges);
+	var amount      := CInt(scrolls.amount);
+	if( max_amount <= 0 )
+		SendSysMessage(who, "This runebook is fully charged.");
 		MoveItemToContainer(scrolls, who.backpack);
-		return;
-	elseif(amount >= maxamount)
-		var to_substract := maxamount;
-		if(SubtractAmount(scrolls, to_substract))
-			charges := maxcharges;
+		return 0;
+	elseif( amount >= max_amount )
+		var to_substract := max_amount;
+		if( SubtractAmount(scrolls, to_substract) )
+			charges := max_charges;
 		endif
-	elseif(DestroyItem(scrolls))
+	elseif( DestroyItem(scrolls) )
 		charges := charges + amount;
 	endif
 	if(scrolls && scrolls.amount)
 		MoveItemToContainer(scrolls, who.backpack);
 	endif
-	PlaySoundEffect(who, 0x1f1);
-	PlayObjectCenteredEffect(who, 0x375a, 7, 0x10);
-	SetObjProperty(book, "charges", charges);
+	PlaySoundEffect(who, 0x1F1);
+	PlayObjectCenteredEffect(who, 0x375A, 7, 0x10);
+	SetCharges(book, who, charges);
 	SendSysMessage(who, "There's now " + charges + " charges in this runebook.");
-	UpdateName(book, charges);
+	SetBookName(book, who, 1);
 
+	return 1;
 endfunction
 
 
-function AddRune(who, book, rune)
-
-	var runedefs := GetObjProperty(book, "runedefs");
-	if(len(runedefs) >= 16)
+function addRune(who, book, rune)
+	var rune_list := GetRuneList(book);
+	if( rune_list.size() > 15 )
 		SendSysMessage(who,"This book cannot hold any more runes.");
 		MoveItemToContainer(rune, who.backpack);
-		return;
+		return 0;
 	endif
-	if(!ReserveItem(rune))
+	if( !ReserveItem(rune) )
 		SendSysMessage(who,"cancelled");
 		MoveItemToContainer(rune, who.backpack);
 		return;
 	endif
-	if(!GetObjProperty(rune, "x"))
+	if( !GetObjProperty(rune, "x") )
 		SendSysMessage(who,"You can only add marked runes.");
 		MoveItemToContainer(rune, who.backpack);
 		return;
 	endif
 	set_critical(1);
-	var x := GetObjProperty(rune, "x");
-	var y := GetObjProperty(rune, "y");
-	var z := GetObjProperty(rune, "z");
-	var rname := rune.desc - "A recall rune for";
-	var new_rune_struct := { rname, x, y, z };
-	if(!runedefs)
-		var new_runedefs := {new_rune_struct};
-		SetObjProperty(book, "runedefs", new_runedefs);
-	elseif(runedefs.size() == 32)
-		SendSysMessage(who, "That rune book is full.");
-		MoveItemToContainer(rune, who.backpack);
-		return;
+
+	var temp := dictionary;
+	temp["Name"]  := rune.desc - "A recall rune for";
+	temp["Realm"] := GetObjProperty(rune, "realm");
+	temp["X"] := GetObjProperty(rune, "x");
+	temp["Y"] := GetObjProperty(rune, "y");
+	temp["Z"] := GetObjProperty(rune, "z");
+	if( !rune.color )
+		temp["Color"] := 10;
 	else
-		runedefs.append(new_rune_struct);
-		SetObjProperty(book, "runedefs", runedefs);
+		temp["Color"] := rune.color;
 	endif
+	rune_list.append(temp);
+
+	SetObjProperty(book, "%RuneList%", rune_list);
+
 	SendSysMessage(who, "You add the rune to the runebook.");
 	DestroyItem(rune);
 	set_critical(0);
 
-endfunction
-
-
-function UpdateName(runebook, charges)
-
-	var name := GetObjProperty(runebook, "name");
-	if(!name)
-		name := "Runebook";
-	endif
-	runebook.name := name + " [charges: " + charges + "]";
-
+	return 1;
 endfunction
\ No newline at end of file

Modified: trunk/096/pkg/items/runebook/runebook.src
===================================================================
--- trunk/096/pkg/items/runebook/runebook.src	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/items/runebook/runebook.src	2005-11-15 11:58:06 UTC (rev 1006)
@@ -2,395 +2,100 @@
 use os;
 use math;
 
-include "customSpells";
-include "include/math";
+include ":gumps:gumps";
+include ":gumps:gumps_ex";
+//include "include/math";
 include "include/client";
-include ":coords:coords";
-include ":itemutils:canAccess";
+include ":itemUtils:canAccess";
+include ":runebook:runebookFunctions";
+include ":runebook:customSpells";
 
-const OBJTYPE_RUNE := 0x1f14;
-const X1 := 28;
-const X2 := 210;
-const Y1 := 40;
-const Y2 := 115;
-const TILE_OFFSET_X := 42;
-const TEXT_OFFSET_X := 25;
-const TEXT1_OFFSET_Y := 40;
-const TEXT2_OFFSET_Y := 20;
-const BUTTON_OFFSET_X := 100;
-const GATE_OFFSET_Y := 43;
-var critical_runes := { 3,5,7,9,11,13,15};
-var runecount := 0;
-var pagecount := 1;
-var layout := {
-"page 0",
-"gumppic 0   0 2220               ",
+program use_Runebook(who, book)
 
-"page 1",
-"button   55  10 2472 2473 1 0 900",
-"text     85  12    0    0        ",
-"text    260  12    0    6        ",
-"text     85  38    0    1        ",
-"text    150  38    0    3        ",
-"text    230  38    0    2        ",
-"text    333  38    0    4        ",
-"gumppic  50  50   57             ",
-"gumppic  70  50   58             ",
-"gumppic  85  50   58             ",
-"gumppic 100  50   58             ",
-"gumppic 115  50   58             ",
-"gumppic 130  50   58             ",
-"gumppic 145  50   58             ",
-"gumppic 160  50   59             ",
-"gumppic 218  50   57             ",
-"gumppic 233  50   58             ",
-"gumppic 248  50   58             ",
-"gumppic 263  50   58             ",
-"gumppic 278  50   58             ",
-"gumppic 293  50   58             ",
-"gumppic 308  50   58             ",
-"gumppic 323  50   59             "
-};
+	EraseObjProperty(who, "IsMeditating");
+	EraseObjProperty(who, "HealTimer");
 
-var data := {
-"Rename Book",
-"Charges:",
-"Max Charges:",
-"",
-"",
-"Set Default",
-""
-};
+	if( !can_access(who, book, "unmovable") )
+		return 0;
+	endif
+	if( !ReserveItem(book) )
+		return 0;
+	endif
 
-program runebook(who, book)
-  EraseObjProperty(who, "IsMeditating");
-  EraseObjProperty(who, "HealTimer");
-  if(!can_access(who, book))
-    return;
-  endif
-  if(!ReserveItem(book))
-    return;
-  endif
-  var charges := GetObjProperty(book, "charges");
-  if(!charges)
-    charges := 0;
-    SetObjProperty(book,"charges", charges);
-  endif
-  var maxcharges := GetObjProperty(book, "maxcharges");
-  if(!maxcharges)
-    maxcharges := 5;
-    SetObjProperty(book,"maxcharges", maxcharges);
-  endif
-  data[4] := charges;
-  data[5] := maxcharges;
-  var selected_rune_struct;
-  var ret;
-  FillInArrays(book);
-  var result := SendDialogGump( who, layout, data );
-  if( result[0] == 0 )
-    return;
-  elseif(result[0] == 900)
-    if(book.movable == 0)
-      SendSysMessage(who, "You cannot do that while the book is locked down.");
-      return;
-    else
-      renamebook(who, book);
-      return;
-    endif
-  endif
-  if(result[0] >= 600)
-    if(charges < 1)
-      SendSysMessage(who,"Your book is out of charges.");
-      return;
-    endif
-    var d := (result[0] - 600);
-    var defs := GetObjProperty( book, "runedefs" );
-    var runeinfo := defs[d];
-    ret := custom_recall(who, runeinfo, book);
-    charges := GetObjProperty(book,"charges") - 1;
-    SetObjProperty(book,"charges", charges);
-    bookname(book);
-    if( ret == 0 )
-      SendSysMessage( who, "Recall failed." );
-    endif
-    return;
-  elseif(result[0] >= 500)
-    if(book.movable == 0)
-      SendSysMessage(who, "You cannot do that while the book is locked down.");
-      return;
-    else
-      var d := (result[0] - 500);
-      var defs := GetObjProperty( book, "runedefs" );
-      var runeinfo := defs[d];
-      SetObjProperty(book,"x", runeinfo[2]);
-      SetObjProperty(book,"y", runeinfo[3]);
-      SetObjProperty(book,"z", runeinfo[4]);
-      return;
-    endif
-  elseif (result[0] >= 81)
-    if(book.movable == 0)
-      SendSysMessage(who, "You cannot do that while the book is locked down.");
-      return;
-    else
-      var d := (result[0] - 80);
-      var defs := GetObjProperty( book, "runedefs" );
-      var runeinfo := defs[d];
-      if(!runeinfo)
-        SendSysMessage(who, "That rune no longer exists.");
-        return;
-      endif
-      var rune := CreateItemInBackpack(who, 0x1f14);
-      SetName(rune, runeinfo[1]);
-      SetObjProperty(rune,"x", runeinfo[2]);
-      SetObjProperty(rune,"y", runeinfo[3]);
-      SetObjProperty(rune,"z", runeinfo[4]);
-      defs.erase(d);
-      SetObjProperty(book,"runedefs", defs);
-      return;
-    endif
-  endif
-  var funct := NormalizeReturnValue( result[0] );
-  var newval := result[0];
-  if(newval != 1 )
-    selected_rune_struct := FindThatRune( book, newval);
-  endif
-  case (funct)
-    0: return;
-    2: if(!ConsumeReagents(who, 32 ))
-         SendSysMessage(who,"You do not have enough reagents.");
-	     PerformAction(who,ANIM_CAST_DIR);
-         PlaySoundEffect(who,0x005d);
-         PlayObjectCenteredEffect(who, 0x3735,0x0a, 0x1e);
-         return;
-       endif
-       ret := custom_recall(who, selected_rune_struct, book);
-       if( ret == 0 )
-         SendSysMessage(who, "Recall failed.");
-       endif
-    3: if(!ConsumeReagents(who, 52 ))
-         SendSysMessage(who,"You do not have enough reagents.");
-	     PerformAction(who,ANIM_CAST_DIR);
-         PlaySoundEffect(who,0x005d);
-         PlayObjectCenteredEffect(who, 0x3735,0x0a, 0x1e);
-         return;
-       endif
-       ret := custom_gate(who, selected_rune_struct, book);
-       if( ret == 0 )
-         SendSysMessage(who, "Gate failed.");
-       endif
-    default:
-  endcase
-endprogram
+	var charge_prop := GetObjProperty(book, "%Charges%");
+	if( TypeOf(charge_prop) != "Dictionary" )
+		charge_prop := dictionary { "charges" -> 0, "max_charges" -> 5 };
+		SetObjProperty(book, "%Charges%", charge_prop);
+	endif
+	var charges := charge_prop["charges"];
+	if( !charges )
+		charges := 0;
+	endif
 
-function bookname(book)
-  var name := GetObjProperty(book,"name");
-  if(!name)
-    name := "a runebook";
-  endif
-  var charges := GetObjProperty(book,"charges");
-  var newname := (name + " [charges: " + charges + "]");
-  book.name := newname;
-endfunction
+	var max_charges := charge_prop["max_charges"];
+	if( !max_charges )
+		max_charges := 5;
+	endif
 
-function renamebook(who, book)
-  var charges := GetObjProperty(book, "charges");
-  if(!charges)
-    charges := 0;
-  endif
-  var name := SendTextEntryGump( who, "Enter the new name of the runebook. ", TE_CANCEL_ENABLE, TE_STYLE_NORMAL);
-  if((!name) || (name == ""))
-    name := "a runebook";
-  endif
-  SetObjProperty(book, "name", name);
-  bookname(book);
-endfunction
+	var book_gump := CreateRunebookGump(book);
 
-function FillInArrays(book)
-  var r := 1;
-  var desc;
-  var i := 5;
-  var datalen;
-  var layoutlen;
-  var line1;
-  var line2;
-  var page_rune_num;
-  var buttonret := 2;
-  var val := 10;
-  var runedefs;
-  if( runedefs != "error" )
-    layout.append( "page " + CStr(pagecount));
-    pagecount := pagecount + 1;
-    layout.append( "button 320   8 2236 2236 0 " + CStr(pagecount));
-    runedefs := GetObjProperty( book, "runedefs" );
-    foreach runed in runedefs
-      var txt := runed[1];
-      if( len(txt) <= 12 )
-        desc := txt;
-      else
-        desc := txt[1,12];
-      endif
-      if (!desc)
-        desc := "";
-      endif
-      datalen := data.size();
-      data.append(desc);
-      case(r)
-         1: layout.append("text    76  60    0 " + datalen);
-            layout.append("button  56  62 2118 2117 1 0 " + (r+600));
-         2: layout.append("text    76  75    0 " + datalen);
-            layout.append("button  56  77 2118 2117 1 0 " + (r+600));
-         3: layout.append("text    76  90    0 " + datalen);
-            layout.append("button  56  92 2118 2117 1 0 " + (r+600));
-         4: layout.append("text    76 105    0 " + datalen);
-            layout.append("button  56 107 2118 2117 1 0 " + (r+600));
-         5: layout.append("text    76 120    0 " + datalen);
-            layout.append("button  56 122 2118 2117 1 0 " + (r+600));
-         6: layout.append("text    76 135    0 " + datalen);
-            layout.append("button  56 137 2118 2117 1 0 " + (r+600));
-         7: layout.append("text    76 150    0 " + datalen);
-            layout.append("button  56 152 2118 2117 1 0 " + (r+600));
-         8: layout.append("text    76 165    0 " + datalen);
-            layout.append("button  56 167 2118 2117 1 0 " + (r+600));
-         9: layout.append("text   226  60    0 " + datalen);
-            layout.append("button 206  62 2118 2117 1 0 " + (r+600));
-        10: layout.append("text   226  75    0 " + datalen);
-            layout.append("button 206  77 2118 2117 1 0 " + (r+600));
-        11: layout.append("text   226  90    0 " + datalen);
-            layout.append("button 206  92 2118 2117 1 0 " + (r+600));
-        12: layout.append("text   226 105    0 " + datalen);
-            layout.append("button 206 107 2118 2117 1 0 " + (r+600));
-        13: layout.append("text   226 120    0 " + datalen);
-            layout.append("button 206 122 2118 2117 1 0 " + (r+600));
-        14: layout.append("text   226 135    0 " + datalen);
-            layout.append("button 206 137 2118 2117 1 0 " + (r+600));
-        15: layout.append("text   226 150    0 " + datalen);
-            layout.append("button 206 152 2118 2117 1 0 " + (r+600));
-        16: layout.append("text   226 165    0 " + datalen);
-            layout.append("button 206 167 2118 2117 1 0 " + (r+600));
-      endcase
-      r := r + 1;
-    endforeach
-    layout.append( "page " + CStr(pagecount) );
-    runedefs := GetObjProperty( book, "runedefs" );
-    layout.append( "button 50 8 2235 2235 0 " + CStr(pagecount - 1) );
-    r := 1;
-    var counters := 0;
-    foreach runedef in runedefs
-      var txt := runedef[1];
-      runecount := runecount + 1;
-      datalen := data.size();
-      layoutlen := layout.size();
-      var runename := txt;
-      if (!runename)
-        runename := "";
-      endif
-      var split := SplitWords( runename );
-      var j;
-      for( j := 1; j <= 10; j := j + 1 )
-        if( !split[j] )
-          split[j] := "";
-        endif
-      endfor
-      if( len(runename) <= 16 )
-        line1 := runename;
-        line2 := "";
-      elseif( (len(split[1]) + len(split[2]) + len(split[3]) + 2) <= 16 )
-        line1 := split[1] + " " + split[2] + " " + split[3];
-        line2 := split[4] + " " + split[5];
-      elseif( len(split[1]) + len(split[2]) + 1 <= 12 )
-        line1 := split[1] + " " + split[2];
-        line2 := split[3] + " " + split[4] + " " + split[5];
-      elseif( len(split[1]) <= 12 )
-        line1 := split[1];
-        line2 := split[2] + " " + split[3] + " " + split[4] + " " + split[5];
-      endif
-      data.append(line1);
-      data.append(line2);
-      data.append(ToSextant(runedef[2], runedef[3]));
-      data.append("Drop Rune");
-      if(runecount in critical_runes)
-        pagecount := pagecount + 1;
-        layout.append("page " + (pagecount));
-        layout.append("button 50 8 2235 2235 0 " + CStr(pagecount - 1));
-      endif
-      page_rune_num := CurrentPageRuneNum( pagecount + 1, i );
-      case(page_rune_num)
-        1: layout.append("gumppic  50  40   57             ");
-           layout.append("gumppic  70  40   58             ");
-           layout.append("gumppic  85  40   58             ");
-           layout.append("gumppic 100  40   58             ");
-           layout.append("gumppic 115  40   58             ");
-           layout.append("gumppic 130  40   58             ");
-           layout.append("gumppic 145  40   58             ");
-           layout.append("gumppic 160  40   59             ");
-           layout.append("gumppic 218  40   57             ");
-           layout.append("gumppic 233  40   58             ");
-           layout.append("gumppic 248  40   58             ");
-           layout.append("gumppic 263  40   58             ");
-           layout.append("gumppic 278  40   58             ");
-           layout.append("gumppic 293  40   58             ");
-           layout.append("gumppic 308  40   58             ");
-           layout.append("gumppic 323  40   59             ");
-           layout.append("text     85  28    0    1        ");
-           layout.append("text    228  28    0    2        ");
-           layout.append("text    150  30    0    3        ");
-           layout.append("text    333  28    0    4        ");
-           layout.append("button   85  15 2361 2362 1 0    " + (r+ 500)       );
-           layout.append("button   50  54 2118 2118 1 0    " + (r+ 600)       );
-           layout.append("button   62 129 2438 2437 1 0    " + (val + 71)     );
-           layout.append("button   65 150 2271 2271 1 0    " + buttonret      );
-           layout.append("button  125 150 2291 2291 1 0    " + (buttonret + 1)  );
-           layout.append("text    100  12    0    5        "                  );
-           layout.append("text     66  52    0             " + datalen        );
-           layout.append("text     66  72    0             " + CStr(datalen+1));
-           layout.append("text     60 100    0             " + CStr(datalen+2));
-           layout.append("text     82 125    0             " + CStr(datalen+3));
-           buttonret := buttonret + 1;
-           val := val + 1;
-           r := r + 1;
-        2: layout.append("button  220  15 2361 2362 1 0    " + (r+ 500)       );
-           layout.append("button  209  54 2118 2118 1 0    " + (r+ 600)       );
-           layout.append("button  227 129 2438 2437 1 0    " + (val + 71)     );
-           layout.append("button  230 150 2271 2271 1 0    " + buttonret      );
-           layout.append("button  290 150 2291 2291 1 0    " + (buttonret + 1)  );
-           layout.append("text    226  52    0             " + datalen        );
-           layout.append("text    226  72    0             " + CStr(datalen+1));
-           layout.append("text    212 100    0             " + CStr(datalen+2));
-           layout.append("text    247 125    0             " + CStr(datalen+3));
-           layout.append("text    235  12    0    5        ");
-           if((counters + 1) < len(runedefs))
-             layout.append("button  320 8 2236 2236 0 "  + CStr(pagecount + 1));
-           endif
-           layout.append("text    333  28    0    4        ");
-           buttonret := buttonret + 1;
-           val := val + 1;
-           r := r + 1;
-      endcase
-      buttonret := buttonret + 1;
-      counters := counters + 1;
-      i := i + 1;
-    endforeach
-  endif
-endfunction
+	var result := GFSendGump(who, book_gump);
 
-function CurrentPageRuneNum( pagecount, rune_number )
-  return( rune_number - ( (pagecount-1) * 2));
-endfunction
+	if( result[0] == 0 )
+		return 0;
+	elseif( result[0] == 50 )
+		if(book.movable == 0)
+			SendSysMessage(who, "You cannot do that while the book is locked down.");
+			return 0;
+		else
+			SetBookName(book, who, 0);
+			return 1;
+		endif
+	endif
 
-function NormalizeReturnValue( button_num )
-  if( button_num == 1 )
-    return 1;
-  elseif( button_num == 2 )
-    return 2;
-  endif
-  var mod_ret := Mod( button_num, 2);
-  return (mod_ret + 2);
-endfunction
-
-function FindThatRune(book, button_num )
-  var runedefs := GetObjProperty( book, "runedefs" );
-  var rune_num := CInt( button_num / 2);
-  runedefs[rune_num].append(rune_num);
-  return( runedefs[rune_num]);
-endfunction
-
+	if( result[0] >= 101 && result[0] <= 120)
+		if(charges < 1)
+			SendSysMessage(who,"Your book is out of charges.");
+			return 0;
+		endif
+		var rune_info := GetRuneDetails(book, (result[0]-100));
+		if( !rune_info )
+			return 0;
+		endif
+		runebookRecall(who, rune_info, book, charges, 1);
+		return 1;
+	elseif( result[0] >= 201 && result[0] <= 220)
+		var rune_info := GetRuneDetails(book, (result[0]-200));
+		runebookRecall(who, rune_info, book, charges);
+		return 1;
+	elseif( result[0] >= 301 && result[0] <= 320 )
+		var rune_info := GetRuneDetails(book, (result[0]-300));
+		runebookGate(who, rune_info, book);
+		return 1;
+	elseif( result[0] >= 401 && result[0] <= 420 )
+		if( book.movable == 0 )
+			SendSysMessage(who, "You cannot do that while the book is locked down.");
+			return 0;
+		else
+			var rune_info := GetRuneDetails(book, (result[0]-400));
+			var rune := CreateItemInBackpack(who, 0x1F14);
+			SetName(rune, rune_info.Name);
+			SetObjProperty(rune, "x", rune_info.X);
+			SetObjProperty(rune, "y", rune_info.Y);
+			SetObjProperty(rune, "z", rune_info.Z);
+			SetObjProperty(rune, "realm", rune_info.Realm);
+			rune.color := rune_info.Color;
+			DeleteRune(book, (result[0]-400));
+			return 1;
+		endif
+	elseif( result[0] >= 501 && result[0] <= 520 )
+		if( book.movable == 0 )
+			SendSysMessage(who, "You cannot do that while the book is locked down.");
+			return 0;
+		else
+			SetDefault(book, who, (result[0]-500));
+			return 1;
+		endif
+	endif
+	return 1;
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/items/runebook/runebookFunctions.inc
===================================================================
--- trunk/096/pkg/items/runebook/runebookFunctions.inc	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/items/runebook/runebookFunctions.inc	2005-11-15 11:58:06 UTC (rev 1006)
@@ -0,0 +1,344 @@
+function CreateRunebookGump(book)
+	var rune_list := GetRuneList(book);
+	if( TypeOf(rune_list) != "Array" )
+		rune_list := array{};
+		SetObjProperty(book, "%RuneList%", rune_list);
+	endif
+
+	var charge_prop := GetObjProperty(book, "%Charges%");
+	var charges := charge_prop["charges"];
+	if( !charges )
+		charges := 0;
+	endif
+	var max_charges := charge_prop["max_charges"];
+	if( !max_charges )
+		max_charges := 5;
+	endif
+
+	var book_gump := GFCreateGump();
+// Begin Page 0 Setup
+	GFGumpPic(book_gump, 100, 10, 2200);
+	GFGumpPic(book_gump, 125, 50, 57);
+	GFGumpPic(book_gump, 145, 50, 58);
+	GFGumpPic(book_gump, 160, 50, 58);
+	GFGumpPic(book_gump, 175, 50, 58);
+	GFGumpPic(book_gump, 190, 50, 58);
+	GFGumpPic(book_gump, 205, 50, 58);
+	GFGumpPic(book_gump, 220, 50, 58);
+	GFGumpPic(book_gump, 230, 50, 59);
+	GFGumpPic(book_gump, 290, 50, 57);
+	GFGumpPic(book_gump, 310, 50, 58);
+	GFGumpPic(book_gump, 325, 50, 58);
+	GFGumpPic(book_gump, 340, 50, 58);
+	GFGumpPic(book_gump, 355, 50, 58);
+	GFGumpPic(book_gump, 370, 50, 58);
+	GFGumpPic(book_gump, 385, 50, 58);
+	GFGumpPic(book_gump, 395, 50, 59);
+
+	GFAddButton(book_gump, 130, 187, 2225, 2225, GF_PAGE_BTN, 2);
+	GFAddButton(book_gump, 165, 187, 2226, 2226, GF_PAGE_BTN, 3);
+	GFAddButton(book_gump, 200, 187, 2227, 2227, GF_PAGE_BTN, 4);
+	GFAddButton(book_gump, 235, 187, 2228, 2228, GF_PAGE_BTN, 5);
+	GFAddButton(book_gump, 300, 187, 2229, 2229, GF_PAGE_BTN, 6);
+	GFAddButton(book_gump, 335, 187, 2230, 2230, GF_PAGE_BTN, 7);
+	GFAddButton(book_gump, 370, 187, 2231, 2231, GF_PAGE_BTN, 8);
+	GFAddButton(book_gump, 405, 187, 2232, 2232, GF_PAGE_BTN, 9);
+	GFHTMLArea(book_gump,  140, 40, 80, 18, "Charges:");
+	GFHTMLArea(book_gump,  300, 40, 100, 18, "Max Charges:");
+	GFHTMLArea(book_gump,  220, 40, 80, 18, charges);
+	GFHTMLArea(book_gump,  400, 40, 100, 18, max_charges);
+// End Page 0 Setup
+
+// Begin Page 1 Setup
+	GFPage(book_gump, 1);
+	GFAddButton(book_gump, 125, 15, 2472, 2473, GF_CLOSE_BTN, 50);
+	GFHTMLArea(book_gump, 158, 22, 100, 18, "Rename Book");
+	GFAddButton(book_gump, 393, 14, 2206, 2206, GF_PAGE_BTN, 2);
+
+	GFAddButton(book_gump, 130, 65,  2103, 2104, GF_CLOSE_BTN, 101);
+	GFAddButton(book_gump, 130, 80,  2103, 2104, GF_CLOSE_BTN, 102);
+	GFAddButton(book_gump, 130, 95,  2103, 2104, GF_CLOSE_BTN, 103);
+	GFAddButton(book_gump, 130, 110, 2103, 2104, GF_CLOSE_BTN, 104);
+	GFAddButton(book_gump, 130, 125, 2103, 2104, GF_CLOSE_BTN, 105);
+	GFAddButton(book_gump, 130, 140, 2103, 2104, GF_CLOSE_BTN, 106);
+	GFAddButton(book_gump, 130, 155, 2103, 2104, GF_CLOSE_BTN, 107);
+	GFAddButton(book_gump, 130, 170, 2103, 2104, GF_CLOSE_BTN, 108);
+
+	GFAddButton(book_gump, 290, 65,  2103, 2104, GF_CLOSE_BTN, 119);
+	GFAddButton(book_gump, 290, 80,  2103, 2104, GF_CLOSE_BTN, 120);
+	GFAddButton(book_gump, 290, 95,  2103, 2104, GF_CLOSE_BTN, 121);
+	GFAddButton(book_gump, 290, 110, 2103, 2104, GF_CLOSE_BTN, 122);
+	GFAddButton(book_gump, 290, 125, 2103, 2104, GF_CLOSE_BTN, 123);
+	GFAddButton(book_gump, 290, 140, 2103, 2104, GF_CLOSE_BTN, 124);
+	GFAddButton(book_gump, 290, 155, 2103, 2104, GF_CLOSE_BTN, 125);
+	GFAddButton(book_gump, 290, 170, 2103, 2104, GF_CLOSE_BTN, 126);
+// End Page 1 Setup
+
+// Below you will notice in the loop, there are entries put BACK into page
+// 1. Do not worry, we run an Optimize function on the gump to put all
+// of those BACK into the initial Page 1 section we just made to keep our
+// gump's arrays looking nice and clean.
+
+	var pOX := 145;
+	var pOY := 60;
+	var charge_button    := 101;
+	var recall_button    := 201;
+	var gate_button      := 301;
+	var drop_rune_button := 401;
+	var set_default_rune := 501;
+	var rune_pos         := 1;
+
+	for i := 2 to 9
+		GFPage(book_gump, i);
+		GFAddButton(book_gump, 125, 14, 2205, 2205, GF_PAGE_BTN, (i-1));
+		if(i != 9)
+			GFAddButton(book_gump, 393, 14, 2206, 2206, GF_PAGE_BTN, (i+1));
+		endif
+
+		var rune_entry := rune_list[rune_pos];
+		if( TypeOf(rune_entry) == "Dictionary" )
+			if( rune_entry.Name )
+				// Fixes any error with the text color.
+				if( TypeOf(rune_entry.Color) != "Integer" || rune_entry.Color < 0 )
+					rune_entry.Color := 10;
+				endif
+				// This puts the rune in page 1's list.
+				GFPage(book_gump, 1);
+				GFTextCrop(book_gump, pOX,  pOY, 115, 17, rune_entry.Color, rune_entry.Name);
+				GFPage(book_gump, i);
+
+				GFAddButton(book_gump, 130, 65, 2103, 2104, GF_CLOSE_BTN, charge_button);
+				GFTextCrop(book_gump, 145, 60, 115, 17, rune_entry.Color, rune_entry.Name);
+				GFTextLine(book_gump, 135, 80, 0, ConvertLatLong(rune_entry.X, rune_entry.Y, 1));
+				GFTextLine(book_gump, 135, 95, 0, ConvertLatLong(rune_entry.X, rune_entry.Y, 2));
+
+				GFAddButton(book_gump, 135, 115, 2437, 2438, GF_CLOSE_BTN, drop_rune_button);
+				GFHTMLArea(book_gump, 150, 115, 100, 18, "Drop Rune");
+				GFAddButton(book_gump, 160, 20, 2361, 2361, GF_CLOSE_BTN, set_default_rune);
+				GFHTMLArea(book_gump, 175, 15, 100, 18, "Set Default");
+
+				GFAddButton(book_gump, 135, 140, 2271, 2271, GF_CLOSE_BTN, recall_button);
+				GFAddButton(book_gump, 205, 140, 2291, 2291, GF_CLOSE_BTN, gate_button);
+
+				charge_button := charge_button + 1;
+				drop_rune_button := drop_rune_button + 1;
+				set_default_rune := set_default_rune + 1;
+				recall_button := recall_button + 1;
+				gate_button := gate_button + 1;
+			endif
+		else
+			GenerateEmptySide(book_gump, 1, pOX, pOY, i);
+		endif
+                rune_pos := rune_pos + 1;
+		pOY := pOY + 15;
+		if( pOY > 165 )
+			pOY := 60;
+			pOX := 305;
+		endif
+
+		rune_entry := rune_list[rune_pos];
+		if( TypeOf(rune_entry) == "Dictionary" )
+			if( rune_entry.Name )
+				// Fixes any error with the text color.
+				if( TypeOf(rune_entry.Color) != "Integer" || rune_entry.Color < 0 )
+					rune_entry.Color := 10;
+				endif
+				// This puts the rune in page 1's list.
+				GFPage(book_gump, 1);
+				GFTextCrop(book_gump, pOX,  pOY, 115, 17, rune_entry.Color, rune_entry.Name);
+				GFPage(book_gump, i);
+
+				GFAddButton(book_gump, 290, 65, 2103, 2104, GF_CLOSE_BTN, charge_button);
+				GFTextCrop(book_gump, 305, 60, 115, 17, rune_entry.Color, rune_entry.Name);
+				GFTextLine(book_gump, 295, 80, 0, ConvertLatLong(rune_entry.X, rune_entry.Y, 1));
+				GFTextLine(book_gump, 295, 95, 0, ConvertLatLong(rune_entry.X, rune_entry.Y, 2));
+
+				GFAddButton(book_gump, 295, 115, 2437, 2438, GF_CLOSE_BTN, drop_rune_button);
+				GFHTMLArea(book_gump, 310, 115, 100, 18, "Drop Rune");
+				GFAddButton(book_gump, 300, 20, 2361, 2361, GF_CLOSE_BTN, set_default_rune);
+				GFHTMLArea(book_gump, 315, 15, 100, 18, "Set Default");
+
+				GFAddButton(book_gump, 295, 140, 2271, 2271, GF_CLOSE_BTN, recall_button);
+				GFAddButton(book_gump, 365, 140, 2291, 2291, GF_CLOSE_BTN, gate_button);
+
+				charge_button := charge_button + 1;
+				drop_rune_button := drop_rune_button + 1;
+				set_default_rune := set_default_rune + 1;
+				recall_button := recall_button + 1;
+				gate_button := gate_button + 1;
+			endif
+		else
+			GenerateEmptySide(book_gump, 2, pOX, pOY, i);
+		endif
+
+                rune_pos := rune_pos + 1;
+		pOY := pOY + 15;
+		if( pOY > 165 )
+			pOY := 60;
+			pOX := 305;
+		endif
+
+		sleepms(2);
+	endfor
+
+//	GFOptimizeGump(book_gump);
+
+	return book_gump;
+endfunction
+
+
+function GenerateEmptySide(byref book_gump, side, pOX, pOY, page_num)
+
+	if( side == 1)
+		// This puts the rune in page 1's list.
+		GFPage(book_gump, 1);
+		GFTextCrop(book_gump, pOX,  pOY, 115, 17, 10, "Empty");
+		GFPage(book_gump, page_num);
+		GFTextCrop(book_gump, 145, 60, 115, 17, 10, "Empty");
+	else
+		// This puts the rune in page 1's list.
+		GFPage(book_gump, 1);
+		GFTextCrop(book_gump, pOX,  pOY, 115, 17, 10, "Empty");
+		GFPage(book_gump, page_num);
+		GFTextCrop(book_gump, 305, 60, 115, 17, 10, "Empty");
+	endif
+
+endfunction
+
+
+function SetBookName(book, who, auto:=0)
+	var charge_prop := GetObjProperty(book, "%Charges%");
+	var charges := charge_prop["charges"];
+	if( !charges )
+		charges := 0;
+	endif
+
+	var name := GetObjProperty(book, "%Name%");
+	if( !auto )
+		name := SendTextEntryGump( who, "Enter the new name of the runebook. ", TE_CANCEL_ENABLE, TE_STYLE_NORMAL);
+		if( (!name) || (name == "") )
+			name := GetObjProperty(book, "%Name%");
+			if( !name )
+				name := "a runebook";
+			endif
+		endif
+	endif
+
+	SetObjProperty(book, "%Name%", name);
+	name := (name + " [charges: " + charges + "]");
+	SetName(book, name);
+
+	return 1;
+endfunction
+
+
+function SetCharges(book, who, charges)
+	var charge_prop := GetObjProperty(book, "%Charges%");
+	charge_prop["charges"] := charges;
+	SetObjProperty(book, "%Charges%", charge_prop);
+	SetBookName(book, who, 1);
+	return 1;
+endfunction
+
+
+function GetRuneList(book)
+	var rune_list := GetObjProperty(book, "%RuneList%");
+	if( TypeOf(rune_list) != "Array" )
+		rune_list := array{};
+		SetObjProperty(book, "%RuneList%", rune_list);
+	endif
+
+	return rune_list;
+endfunction
+
+
+function GetRuneDetails(book, rune_pos)
+	var rune_list := GetRuneList(book);
+	if( TypeOf(rune_list) != "Array" )
+		rune_list := array{};
+		SetObjProperty(book, "%RuneList%", rune_list);
+	endif
+
+	return rune_list[rune_pos];
+endfunction
+
+function ConvertLatLong(x, y, pos)
+	var workit := ToSextant(x, y);
+	var j, newtemp := "";
+	for(j:=1; j<=len(workit); j:=j+1)
+		if(workit[j] == " ")
+			workit[j] := "_";
+		elseif(workit[j] == ",")
+			workit[j] := " ";
+			workit[j+1] := "";
+		endif
+	endfor
+
+	newtemp := SplitWords(workit);
+	if(pos == 1)
+		newtemp := newtemp[1];
+		for(j:=1; j<=len(newtemp); j:=j+1)
+			if(newtemp[j] == "_")
+				newtemp[j] := " ";
+			endif
+		endfor
+		return newtemp;
+	else
+		newtemp := newtemp[2];
+		for(j:=1; j<=len(newtemp); j:=j+1)
+			if(newtemp[j] == "_")
+				newtemp[j] := " ";
+			endif
+		endfor
+		return newtemp;
+	endif
+endfunction
+
+
+function DeleteRune(book, rune_pos)
+	var rune_list := GetRuneList(book);
+	if( TypeOf(rune_list) != "Array" )
+		rune_list := array{};
+		SetObjProperty(book, "%RuneList%", rune_list);
+	endif
+	if( rune_list[rune_pos] )
+		rune_list.Erase(rune_pos);
+		SetObjProperty(book, "%RuneList%", rune_list);
+	endif
+	return 1;
+endfunction
+
+
+function SetDefault(book, who, rune_pos)
+	var rune_info := GetRuneDetails(book, rune_pos);
+	SetObjProperty(book, "x", rune_info.X);
+	SetObjProperty(book, "y", rune_info.Y);
+	SetObjProperty(book, "z", rune_info.Z);
+	SetObjProperty(book, "realm", rune_info.Realm);
+	SendSysMessage(who, "Default rune set to: " + rune_info.Name);
+	return 1;
+endfunction
+
+
+function ToSextant(x, y)
+	var latitude_direction, longitude_direction;
+	var latitude_degrees, longitude_degrees;
+	var latitude_minutes, longitude_minutes;
+	latitude_degrees := (y-1624)*0.087890625;
+	longitude_degrees := (x-1323)*0.0703125;
+	if(latitude_degrees < 0)
+		latitude_direction := "N";
+	else
+		latitude_direction := "S";
+	endif
+	if(longitude_degrees < 0)
+		longitude_direction := "W";
+	else
+		longitude_direction := "E";
+	endif
+	latitude_degrees := Abs(latitude_degrees);
+	longitude_degrees := Abs(longitude_degrees);
+	latitude_minutes := CInt((CInt((latitude_degrees-Floor(latitude_degrees))*100)*60)/100);
+	longitude_minutes := CInt((CInt((longitude_degrees-Floor(longitude_degrees))*100)*60)/100);
+	return(Floor(latitude_degrees) + "o " + latitude_minutes + "'" + latitude_direction + ", " + Floor(longitude_degrees) + "o " + longitude_minutes + "'" + longitude_direction);
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/items/runebook/runebookFunctions.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/096/pkg/skills/magery/config/settings.cfg
===================================================================
--- trunk/096/pkg/skills/magery/config/settings.cfg	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/skills/magery/config/settings.cfg	2005-11-15 11:58:06 UTC (rev 1006)
@@ -2,7 +2,9 @@
 {
 	// Maximum distance a spell can be cast
 	MaxRange	16
-	
+
 	// Does MuadDib wear little girl undies?
-	MuadDibUndies	1
+	MuadDibUndies	0
+	// Does Austin?
+	AustinUndies	1
 }
\ No newline at end of file

Added: trunk/096/pkg/skills/magery/include/spellSounds.inc
===================================================================
--- trunk/096/pkg/skills/magery/include/spellSounds.inc	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/skills/magery/include/spellSounds.inc	2005-11-15 11:58:06 UTC (rev 1006)
@@ -0,0 +1,61 @@
+CONST SFX_SPELL_CLUMSY              :=  0x1E0;
+CONST SFX_SPELL_CREATE_FOOD         :=  0x1E3;
+CONST SFX_SPELL_FEEBLEMIND          :=  0x1E5;
+CONST SFX_SPELL_HEAL                :=  0x1F3;
+CONST SFX_SPELL_MAGIC_ARROW         :=  0x1E6;
+CONST SFX_SPELL_NIGHT_SIGHT         :=  0x1E4;
+CONST SFX_SPELL_REACTIVE_ARMOR      :=  0x1F3;
+CONST SFX_SPELL_WEAKEN              :=  0x1E7;
+CONST SFX_SPELL_AGILITY             :=  0x1E8;
+CONST SFX_SPELL_CUNNING             :=  0x1EC;
+CONST SFX_SPELL_CURE                :=  0x1E1;
+CONST SFX_SPELL_HARM                :=  0x1F2;
+CONST SFX_SPELL_MAGIC_TRAP          :=  0x1F0;
+CONST SFX_SPELL_MAGIC_UNTRAP        :=  0x1F1;
+CONST SFX_SPELL_PROTECTION          :=  0x1EE;
+CONST SFX_SPELL_STRENGTH            :=  0x1EF;
+CONST SFX_SPELL_BLESS               :=  0x1EB;
+CONST SFX_SPELL_FIREBALL            :=  0x160;
+CONST SFX_SPELL_MAGIC_LOCK          :=  0x1F5;
+CONST SFX_SPELL_TELEKINESIS         :=  0x1F6;
+CONST SFX_SPELL_TELEPORT            :=  0x1FF;
+CONST SFX_SPELL_POISON              :=  0x247;
+CONST SFX_SPELL_UNLOCK              :=  0x200;
+CONST SFX_SPELL_WALL_OF_STONE       :=  0x1F7;
+CONST SFX_SPELL_ARCH_CURE           :=  0x1E9;
+CONST SFX_SPELL_ARCH_PROTECTION     :=  0x1F8;
+CONST SFX_SPELL_CURSE               :=  0x1E2;
+CONST SFX_SPELL_FIRE_FIELD          :=  0x226;
+CONST SFX_SPELL_GREATER_HEAL        :=  0x203;
+CONST SFX_SPELL_LIGHTNING           :=  0x2A;
+CONST SFX_SPELL_MANA_DRAIN          :=  0x1F9;
+CONST SFX_SPELL_RECALL              :=  0x1FD;
+CONST SFX_SPELL_BLADE_SPIRITS       :=  0x213;
+CONST SFX_SPELL_ENERGY_FIELD        :=  0x211; // used to say dispel field?
+CONST SFX_SPELL_INCOGNITO           :=  0x1ED;
+CONST SFX_SPELL_MAGIC_REFLECTION    :=  0x1E8;
+CONST SFX_SPELL_MIND_BLAST          :=  0x214;
+CONST SFX_SPELL_PARALYZE            :=  0x205;
+CONST SFX_SPELL_POISON_FIELD        :=  0x20D; // was 227 (??)
+CONST SFX_SPELL_SUMMON_CREATURE     :=  0x216;
+CONST SFX_SPELL_DISPEL              :=  0x202;
+CONST SFX_SPELL_ENERGY_BOLT         :=  0x20B;
+CONST SFX_SPELL_EXPLOSION           :=  0x208;
+CONST SFX_SPELL_INVISIBILITY        :=  0x204;
+CONST SFX_SPELL_MARK                :=  0x1FB;
+CONST SFX_SPELL_MASS_CURSE          :=  0x1FC;
+CONST SFX_SPELL_PARALYZE_FIELD      :=  0x212;
+CONST SFX_SPELL_REVEAL              :=  0x1FE;
+CONST SFX_SPELL_CHAIN_LIGHTNING     :=  0x30;
+CONST SFX_SPELL_PARA_FIELD          :=  0x20C;
+CONST SFX_SPELL_FLAME_STRIKE        :=  0x209;
+CONST SFX_SPELL_GATE_TRAVEL         :=  0x20F;
+CONST SFX_SPELL_MANA_VAMPIRE        :=  0x1FA;
+CONST SFX_SPELL_MASS_DISPEL         :=  0x20A;
+CONST SFX_SPELL_METEOR_SWARM        :=  0x161;
+CONST SFX_SPELL_POLYMORPH           :=  0x20A;
+CONST SFX_SPELL_EARTHQUAKE          :=  0x20E;
+CONST SFX_SPELL_ENERGY_VORTEX       :=  0x213;
+CONST SFX_SPELL_RESSURECTION        :=  0x215;
+CONST SFX_SPELL_SUMMON_ELEMENTAL    :=  0x218;
+CONST SFX_SPELL_SUMMON_DAEMON       :=  0x217;
\ No newline at end of file


Property changes on: trunk/096/pkg/skills/magery/include/spellSounds.inc
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/096/pkg/skills/magery/include/spells.inc
===================================================================
--- trunk/096/pkg/skills/magery/include/spells.inc	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/skills/magery/include/spells.inc	2005-11-15 11:58:06 UTC (rev 1006)
@@ -114,8 +114,8 @@
 		return 0;
 	endif
 
-	var orig_x := who.x;
-	var orig_y := who.y;
+//	var orig_x := who.x;
+//	var orig_y := who.y;
 
 	SendSysMessage(who, prompt);
 
@@ -123,9 +123,9 @@
 	if ( Distance(who, targ) > MAX_RANGE )
 		SendSysMessage(who, "That is too far away.");
 		return 0;
-	elseif ( who.x != orig_x || who.y != orig_y )
-		SendSysMessage(who, "You break your concentration.");
-		return 0;
+//	elseif ( who.x != orig_x || who.y != orig_y )
+//		SendSysMessage(who, "You break your concentration.");
+//		return 0;
 	else
 		return targ;
 	endif

Modified: trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src
===================================================================
--- trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src	2005-11-15 11:58:06 UTC (rev 1006)
@@ -9,10 +9,13 @@
 include ":itemutils:objtype";
 include ":coords:isValidLoc";
 include ":runebook:runebookFunctions";
+include ":containers:containers";
+include ":itemutils:itemdesc";
+include "include/sounds";
 
 program SpellScript(params)
 	var who := params[1];
-	var runebook_info := params[4];
+	var runebook_info := params[2].targ;
 	//var info := params[2];
 	params := 0; // No longer needed
 
@@ -156,6 +159,12 @@
 	var runebook := runebook_info[1];
 	var rune_info := runebook_info[2];
 
+	var spell_elem := MS_GetSpellsCfgElem(32);
+	if ( !CheckReagents(who, spell_elem, 0) )
+		FailSpell(who);
+		return 0;
+	endif
+
 	if( !ReserveItem(runebook) )
 		return 0;
 	endif
@@ -217,4 +226,54 @@
 	MoveObjectToLocation( who, tox, toy, toz, torealm );
 	PlaySoundEffect(who, 0x1fd);
 	return 1;
-endfunction
\ No newline at end of file
+endfunction
+
+function CheckReagents(who, byref spell_elem, scroll)
+	if ( who.npctemplate )
+		// NPCs don't need reagents to cast.
+		return 1;
+	elseif ( scroll.isA(POLCLASS_ITEM) )
+		return SubtractAmount(scroll, 1);
+	elseif ( scroll == 1 )
+		// Added scroll/1 check for passing 1 to override reg
+		// and scroll check. IE: runebooks, wands, etc.
+		return 1;
+	endif
+
+	var reagent_costs := GetConfigStringDictionary(spell_elem, "RegCost");
+
+	// Before consuming, verify that there is enough of everything.
+	foreach amount in ( reagent_costs )
+		amount := CInt(amount);
+		if ( !amount )
+			amount := 1;
+		endif
+		var objtype := GetObjTypeByName(_amount_iter);
+
+		if ( AmountInContainer(who.backpack, objtype) < amount )
+			SendSysMessage(who, "You do not have enough "+GetObjTypeDesc(objtype, (amount>1)));
+			return 0;
+		endif
+		sleepms(2);
+	endforeach
+	// Consume reagents - CInt() and < 1 checks already done in previous loop.
+	// Foreach is a pointer!
+	foreach amount in ( reagent_costs )
+		ConsumeSubstance(who.backpack, GetObjTypeByName(_amount_iter), amount);
+		sleepms(2);
+	endforeach
+
+	return 1;
+endfunction
+
+
+function FailSpell(who)
+	// Simple function for handling effects when a caster
+	// fails the casting.
+	who.frozen := 0;
+	EraseObjProperty(who, "#medding");
+	PlayObjectCenteredEffect(who, GFX_SPELL_FAIL, 5, 50);
+	PlaySoundEffect(who, SFX_SPELL_FAIL);
+
+	return 1;
+endfunction

Added: trunk/096/pkg/skills/magery/spellScripts/circle6/mark.src
===================================================================
--- trunk/096/pkg/skills/magery/spellScripts/circle6/mark.src	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/skills/magery/spellScripts/circle6/mark.src	2005-11-15 11:58:06 UTC (rev 1006)
@@ -0,0 +1,188 @@
+/* $Id$
+ *
+ */
+use uo;
+use os;
+
+include ":magery:spells";
+include ":magery:spellSounds";
+include ":itemutils:objtype";
+include ":coords:isValidLoc";
+include ":runebook:runebookFunctions";
+include "include/tileEffects";
+
+program SpellScript(params)
+	var who := params[1];
+	//var info := params[2];
+	params := 0; // No longer needed
+
+	var prompt := "Select a recall rune to mark.";
+	var recall_rune := MS_Target(who, 0, prompt, TGTOPT_CHECK_LOS+TGTOPT_NEUTRAL);
+
+	if( recall_rune.objtype != UOBJ_RUNE )
+		SendSysMessage(who, "You can only cast that on a recall rune!");
+		return 0;
+	endif
+	if( !Accessible(who, recall_rune) )
+		SendSysMessage(who, "You can't reach that!");
+		return 0;
+	endif
+	if( !ReserveItem(recall_rune) )
+		SendSysMessage(who, "Your spell fizzles.");
+		return 0;
+	endif
+	if( GetObjProperty(recall_rune, "Vendored") )
+		SendSysMessage(who, "You cannot mark runes on a vendor.");
+		return 0;
+	endif
+
+	if( who.multi )
+		SendSysMessage(who, "You cannot mark runes here.");
+		PlaySoundEffect(who, 0x005d);
+		PlayObjectCenteredEffect(who, 0x3735, 0x0a, 0x1e);
+		return 0;
+	endif
+
+	if( ((who.x >= 5120) && (who.x <= 5375) && (who.y >= 0) && (who.y <= 255)) || (who.multi) )
+		SendSysMessage(who, "You cannot mark runes here.");
+		return 0;
+	endif
+
+	var signs := ListItemsNearLocationOfType( who.x, who.y, who.z, 30, 0x7060, who.realm);
+	foreach sign in signs
+		var infoarr := GetObjProperty(sign, "homeinfo");
+		if( infoarr )
+			if( (who.x >= infoarr[2]) && (who.x <= infoarr[4]) && (who.y >= infoarr[3]) && (who.y <= infoarr[5]) )
+				SendSysMessage(who, "You cannot mark runes here.");
+				return 0;
+				break;
+			endif
+		endif
+	endforeach
+
+	PlayObjectCenteredEffect(who, FX_MARK_EFFECT, 10, 10);
+	PlaySoundEffect(who, SFX_SPELL_MARK);
+	SetObjProperty(recall_rune, "x", who.x);
+	SetObjProperty(recall_rune, "y", who.y);
+	SetObjProperty(recall_rune, "z", who.z);
+	SetObjProperty(recall_rune, "realm", who.realm);
+
+	var color_cfg := ReadConfigFile(":magery:config/runeColor");
+	var realm_elem := color_cfg[who.realm];
+	recall_rune.color := CInt(realm_elem.RuneColor);
+
+	SetName(recall_rune, "a marked recall rune");
+
+	return 1;
+endprogram
+
+function RemoveRunebookDefault(runebook)
+	var tox := CInt(GetObjProperty( runebook, "x" ));
+	var toy := CInt(GetObjProperty( runebook, "y" ));
+	var toz := CInt(GetObjProperty( runebook, "z" ));
+	var torealm := GetObjProperty( runebook, "realm" );
+	var rune_list := GetRuneList(runebook);
+
+	foreach rune_entry in rune_list
+		if( (Cint(rune_list.X) == tox) && (Cint(rune_list.Y) == toy) && (Cint(rune_list.Z) == toz) && (Cint(rune_list.Realm) == torealm) )
+			rune_list.Erase(rune_entry);
+		endif
+	endforeach
+
+	SetObjProperty(runebook, "%RuneList%", rune_list);
+	EraseObjProperty(runebook, "x");
+	EraseObjProperty(runebook, "y");
+	EraseObjProperty(runebook, "z");
+	EraseObjProperty(runebook, "realm");
+	return 1;
+endfunction
+
+
+function RemoveRunebookEntry(runebook, rune_info)
+	var tox := CInt(rune_info.X);
+	var toy := CInt(rune_info.Y);
+	var toz := CInt(rune_info.Z);
+	var torealm :=  rune_info.Realm;
+	var rune_list := GetRuneList(runebook);
+
+	foreach rune_entry in rune_list
+		if( (Cint(rune_list.X) == tox) && (Cint(rune_list.Y) == toy) && (Cint(rune_list.Z) == toz) && (Cint(rune_list.Realm) == torealm) )
+			rune_list.Erase(rune_entry);
+		endif
+	endforeach
+
+	SetObjProperty(runebook, "%RuneList%", rune_list);
+	EraseObjProperty(runebook, "x");
+	EraseObjProperty(runebook, "y");
+	EraseObjProperty(runebook, "z");
+	EraseObjProperty(runebook, "realm");
+	return 1;
+endfunction
+
+
+function RunebookRecall(who, runebook_info)
+	var runebook := runebook_info[1];
+	var rune_info := runebook_info[2];
+
+	if( !ReserveItem(runebook) )
+		return 0;
+	endif
+
+	if( GetObjProperty(runebook, "Vendored") )
+		SendSysMessage(who, "You cannot recall off of runebooks on a vendor.");
+		return 0;
+	endif
+	var tox := CInt(rune_info.X);
+	var toy := CInt(rune_info.Y);
+	var toz := CInt(rune_info.Z);
+	var torealm :=  rune_info.Realm;
+	if(!tox)
+		SendSysMessage(who, "That is an invalid location.");
+		return 0;
+	endif
+	if(!torealm)
+		torealm := "britannia";
+	endif
+
+	if( !isValidLoc(tox,toy,torealm) )
+		SendSysMessage(who, "Invalid recall location.");
+		RemoveRunebookEntry(runebook, rune_info);
+		return 0;
+	endif
+
+	PlaySoundEffect(who, 0x210);
+
+	if( (who.x >= 5120) && (who.x <= 5375) && (who.y >= 0) && (who.y <= 255) )
+		SendSysMessage(who, "Your spell fails and consumes the rune!");
+		RemoveRunebookEntry(runebook, rune_info);
+		return 0;
+	endif
+
+	var signs := ListItemsNearLocationOfType( tox, toy, toz, 30, 0x7060, torealm);
+	foreach sign in signs
+		var infoarr := GetObjProperty(sign, "homeinfo");
+		if( infoarr )
+			if( (tox >= infoarr[2]) && (tox <= infoarr[4]) && (toy >= infoarr[3]) && (toy <= infoarr[5]) )
+				SendSysMessage(who, "Something is blocking the location.");
+				return 0;
+				break;
+			endif
+		endif
+	endforeach
+
+	var multicheck := CreateItemAtLocation(1, 1, 0, 0xeed, 1, torealm);
+	multicheck.invisible := 1;
+	if( !MoveItemToLocation(multicheck, tox, toy, toz, MOVEITEM_NORMAL) )
+		SendSysMessage(who, "Something is blocking the location.");
+		return 0;
+	endif
+	if(multicheck.multi)
+		SendSysMessage(who,"A house is blocking the location.");
+		RemoveRunebookEntry(runebook, rune_info);
+		return 0;
+	endif
+	DestroyItem(multicheck);
+	MoveObjectToLocation( who, tox, toy, toz, torealm );
+	PlaySoundEffect(who, 0x1fd);
+	return 1;
+endfunction
\ No newline at end of file


Property changes on: trunk/096/pkg/skills/magery/spellScripts/circle6/mark.src
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src
===================================================================
--- trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src	2005-11-15 11:58:06 UTC (rev 1006)
@@ -9,6 +9,9 @@
 include ":itemutils:objtype";
 include ":coords:isValidLoc";
 include ":runebook:runebookFunctions";
+include ":containers:containers";
+include ":itemutils:itemdesc";
+include "include/sounds";
 
 program SpellScript(params)
 	var who := params[1];
@@ -191,6 +194,12 @@
 		return 0;
 	endif
 
+	var spell_elem := MS_GetSpellsCfgElem(52);
+	if ( !CheckReagents(who, spell_elem, 0) )
+		FailSpell(who);
+		return 0;
+	endif
+
 	if( GetObjProperty(runebook, "Vendored") )
 		SendSysMessage(who, "You cannot recall off of runebooks on a vendor.");
 		return 0;
@@ -279,4 +288,55 @@
 	DestroyItem( gate2 );
 	set_critical(0);
 	return 1;
-endfunction
\ No newline at end of file
+endfunction
+
+
+function CheckReagents(who, byref spell_elem, scroll)
+	if ( who.npctemplate )
+		// NPCs don't need reagents to cast.
+		return 1;
+	elseif ( scroll.isA(POLCLASS_ITEM) )
+		return SubtractAmount(scroll, 1);
+	elseif ( scroll == 1 )
+		// Added scroll/1 check for passing 1 to override reg
+		// and scroll check. IE: runebooks, wands, etc.
+		return 1;
+	endif
+
+	var reagent_costs := GetConfigStringDictionary(spell_elem, "RegCost");
+
+	// Before consuming, verify that there is enough of everything.
+	foreach amount in ( reagent_costs )
+		amount := CInt(amount);
+		if ( !amount )
+			amount := 1;
+		endif
+		var objtype := GetObjTypeByName(_amount_iter);
+
+		if ( AmountInContainer(who.backpack, objtype) < amount )
+			SendSysMessage(who, "You do not have enough "+GetObjTypeDesc(objtype, (amount>1)));
+			return 0;
+		endif
+		sleepms(2);
+	endforeach
+	// Consume reagents - CInt() and < 1 checks already done in previous loop.
+	// Foreach is a pointer!
+	foreach amount in ( reagent_costs )
+		ConsumeSubstance(who.backpack, GetObjTypeByName(_amount_iter), amount);
+		sleepms(2);
+	endforeach
+
+	return 1;
+endfunction
+
+
+function FailSpell(who)
+	// Simple function for handling effects when a caster
+	// fails the casting.
+	who.frozen := 0;
+	EraseObjProperty(who, "#medding");
+	PlayObjectCenteredEffect(who, GFX_SPELL_FAIL, 5, 50);
+	PlaySoundEffect(who, SFX_SPELL_FAIL);
+
+	return 1;
+endfunction

Modified: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-15 11:58:06 UTC (rev 1006)
@@ -45,6 +45,7 @@
 		return 0;
 	else
 		SetObjProperty(who, "#medding", 1);
+		who.frozen := 1;
 	endif
 
 	if ( !who.squelched )
@@ -79,6 +80,7 @@
 			difficulty := -1;
 		endif
 		var skill_check := SkillCheck(who, attribute, difficulty);
+		who.frozen := 0;
 		if ( skill_check > 0 )
 			var info := struct;
 			info.+script		:= spell_elem.script;
@@ -144,12 +146,17 @@
 	return 1;
 endfunction
 
+
 function CheckReagents(who, byref spell_elem, scroll)
 	if ( who.npctemplate )
 		// NPCs don't need reagents to cast.
 		return 1;
-	elseif ( scroll )
+	elseif ( scroll.isA(POLCLASS_ITEM) )
 		return SubtractAmount(scroll, 1);
+	elseif ( scroll == 1 )
+		// Added scroll/1 check for passing 1 to override reg
+		// and scroll check. IE: runebooks, wands, etc.
+		return 1;
 	endif
 
 	var reagent_costs := GetConfigStringDictionary(spell_elem, "RegCost");
@@ -181,6 +188,7 @@
 function FailSpell(who)
 	// Simple function for handling effects when a caster
 	// fails the casting.
+	who.frozen := 0;
 	EraseObjProperty(who, "#medding");
 	PlayObjectCenteredEffect(who, GFX_SPELL_FAIL, 5, 50);
 	PlaySoundEffect(who, SFX_SPELL_FAIL);

Modified: trunk/096/pkg/skills/magery/spells.cfg
===================================================================
--- trunk/096/pkg/skills/magery/spells.cfg	2005-11-15 09:20:06 UTC (rev 1005)
+++ trunk/096/pkg/skills/magery/spells.cfg	2005-11-15 11:58:06 UTC (rev 1006)
@@ -6,8 +6,8 @@
 	SpellScript	spellScripts/circle1/clumsy
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	4
+	Delay		1000
 
 	PowerWords	Uus Jux
 	Circle		1
@@ -25,7 +25,7 @@
 
 	Difficulty	1
 	ManaCost	4
-	Delay		1
+	Delay		1000
 
 	Circle		1
 	PowerWords	In Mani Ylem
@@ -43,8 +43,8 @@
 	SpellScript	spellScripts/circle1/feebleMind
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	4
+	Delay		1000
 
 	PowerWords	Rel Wis
 	Circle		1
@@ -61,8 +61,8 @@
 	SpellScript	spellScripts/circle1/heal
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	4
+	Delay		1000
 
 	PowerWords	In Mani
 	Circle		1
@@ -80,8 +80,8 @@
 	SpellScript	spellScripts/circle1/magicArrow
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	4
+	Delay		1000
 
 	PowerWords	In Por Ylem
 	Circle		1
@@ -98,8 +98,8 @@
 	SpellScript	spellScripts/circle1/nightSight
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	4
+	Delay		1000
 
 	PowerWords	In Lor
 	Circle		1
@@ -116,8 +116,8 @@
 	SpellScript	spellScripts/circle1/reactiveArmor
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	4
+	Delay		1000
 
 	PowerWords	Flam Sanct
 	Circle		1
@@ -135,8 +135,8 @@
 	SpellScript	spellScripts/circle1/weaken
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	4
+	Delay		1000
 
 	PowerWords	Des Mani
 	Circle		1
@@ -153,8 +153,8 @@
 	SpellScript	spellScripts/circle2/agility
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	6
+	Delay		2000
 
 	PowerWords	Ex Uus
 	Circle		2
@@ -171,8 +171,8 @@
 	SpellScript	spellScripts/circle2/cunning
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	6
+	Delay		2000
 
 	PowerWords	Uus Wis
 	Circle		2
@@ -189,8 +189,8 @@
 	SpellScript	spellScripts/circle2/cure
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	6
+	Delay		2000
 
 	PowerWords	An Nox
 	Circle		2
@@ -207,8 +207,8 @@
 	SpellScript	spellScripts/circle2/harm
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	6
+	Delay		2000
 
 	PowerWords	An Mani
 	Circle		2
@@ -225,8 +225,8 @@
 	SpellScript	spellScripts/circle2/magicTrap
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	6
+	Delay		2000
 
 	PowerWords	In Jux
 	Circle		2
@@ -244,8 +244,8 @@
 	SpellScript	spellScripts/circle2/magicUntrap
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	6
+	Delay		2000
 
 	PowerWords	An Jux
 	Circle		2
@@ -263,8 +263,8 @@
 	SpellScript	spellScripts/circle2/protection
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	6
+	Delay		2000
 
 	PowerWords	Uus Sanct
 	Circle		2
@@ -282,8 +282,8 @@
 	SpellScript	spellScripts/circle2/strength
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	6
+	Delay		2000
 
 	PowerWords	Uus Mani
 	Circle		2
@@ -300,8 +300,8 @@
 	SpellScript	spellScripts/circle3/bless
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	9
+	Delay		3000
 
 	PowerWords	Rel Sanct
 	Circle		3
@@ -318,8 +318,8 @@
 	SpellScript	spellScripts/circle23/fireBall
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	9
+	Delay		3000
 
 	PowerWords	Vas Flam
 	Circle		3
@@ -336,8 +336,8 @@
 	SpellScript	spellScripts/circle3/magicLock
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	9
+	Delay		3000
 
 	PowerWords	An Por
 	Circle		3
@@ -355,8 +355,8 @@
 	SpellScript	spellScripts/circle3/magicUnlock
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	9
+	Delay		3000
 
 	PowerWords	In Nox
 	Circle		3
@@ -372,8 +372,8 @@
 	SpellScript	spellScripts/circle3/telekinesis
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	9
+	Delay		3000
 
 	PowerWords	Ort Por Ylem
 	Circle		3
@@ -390,8 +390,8 @@
 	SpellScript	spellScripts/circle3/teleport
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	9
+	Delay		3000
 
 	PowerWords	Rel Por
 	Circle		3
@@ -408,8 +408,8 @@
 	SpellScript	spellScripts/circle3/unlock
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	9
+	Delay		3000
 
 	PowerWords	Ex Por
 	Circle		3
@@ -426,8 +426,8 @@
 	SpellScript	spellScripts/circle3/wallofStone
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	9
+	Delay		3000
 
 	PowerWords	In Sanct Ylem
 	Circle		3
@@ -444,8 +444,8 @@
 	SpellScript	spellScripts/circle4/archCure
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	11
+	Delay		4000
 
 	PowerWords	Vas An Nox
 	Circle		4
@@ -463,8 +463,8 @@
 	SpellScript	spellScripts/circle4/archProtection
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	11
+	Delay		4000
 
 	PowerWords	Vas Uus Sanct
 	Circle		4
@@ -483,8 +483,8 @@
 	SpellScript	spellScripts/circle4/curse
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	11
+	Delay		4000
 
 	PowerWords	Des Sanct
 	Circle		4
@@ -502,8 +502,8 @@
 	SpellScript	spellScripts/circle4/fireField
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	11
+	Delay		4000
 
 	PowerWords	In Flam Grav
 	Circle		4
@@ -521,8 +521,8 @@
 	SpellScript	spellScripts/circle4/greaterHeal
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	11
+	Delay		4000
 
 	PowerWords	In Vas Mani
 	Circle		4
@@ -541,8 +541,8 @@
 	SpellScript	spellScripts/circle4/lightning
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	11
+	Delay		4000
 
 	PowerWords	Por Ort Grav
 	Circle		4
@@ -560,8 +560,8 @@
 	SpellScript	spellScripts/circle4/manaDrain
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	11
+	Delay		4000
 
 	PowerWords	Ort Rel
 	Circle		4
@@ -580,7 +580,7 @@
 
 	Difficulty	1
 	ManaCost	11
-	Delay		4
+	Delay		4000
 
 	PowerWords	Kal Ort Por
 	Circle		4
@@ -598,8 +598,8 @@
 	SpellScript	spellScripts/circle5/bladeSpirit
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	14
+	Delay		5000
 
 	PowerWords	In Jux Hur Ylem
 	Circle		5
@@ -617,8 +617,8 @@
 	SpellScript	spellScripts/circle5/dispelField
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	14
+	Delay		5000
 
 	PowerWords	An Grav
 	Circle		5
@@ -637,8 +637,8 @@
 	SpellScript	spellScripts/circle5/incognito
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	14
+	Delay		5000
 
 	PowerWords	Kal In Ex
 	Circle		5
@@ -656,8 +656,8 @@
 	SpellScript	spellScripts/circle5/spellReflection
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	14
+	Delay		5000
 
 	PowerWords	In Jux Sanct
 	Circle		5
@@ -675,8 +675,8 @@
 	SpellScript	spellScripts/circle5/mindBlast
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	14
+	Delay		5000
 
 	PowerWords	Por Corp Wis
 	Circle		5
@@ -695,8 +695,8 @@
 	SpellScript	spellScripts/circle5/paralyze
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	14
+	Delay		5000
 
 	PowerWords	An Ex Por
 	Circle		5
@@ -714,8 +714,8 @@
 	SpellScript	spellScripts/circle5/poisonField
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	14
+	Delay		5000
 
 	PowerWords	In Nox Grav
 	Circle		5
@@ -733,8 +733,8 @@
 	SpellScript	spellScripts/circle5/summonCreature
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	14
+	Delay		5000
 
 	PowerWords	Kal Xen
 	Circle		5
@@ -752,8 +752,8 @@
 	SpellScript	spellScripts/circle6/dispel
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	20
+	Delay		6000
 
 	PowerWords	An Ort
 	Circle		6
@@ -771,8 +771,8 @@
 	SpellScript	spellScripts/circle6/energyBolt
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	20
+	Delay		6000
 
 	PowerWords	Corp Por
 	Circle		6
@@ -789,8 +789,8 @@
 	SpellScript	spellScripts/circle6/explosion
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	20
+	Delay		6000
 
 	PowerWords	Vas Ort Flam
 	Circle		6
@@ -808,8 +808,8 @@
 	SpellScript	spellScripts/circle6/invisibility
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	20
+	Delay		6000
 
 	PowerWords	An Lor Xen
 	Circle		6
@@ -826,8 +826,8 @@
 	SpellScript	spellScripts/circle6/mark
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	20
+	Delay		6000
 
 	PowerWords	Kal Por Ylem
 	Circle		6
@@ -845,8 +845,8 @@
 	SpellScript	spellScripts/circle6/massCurse
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	20
+	Delay		6000
 
 	PowerWords	Vas Des Sanct
 	Circle		6
@@ -865,8 +865,8 @@
 	SpellScript	spellScripts/circle6/paralyzeField
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	20
+	Delay		6000
 
 	PowerWords	In Ex Grav
 	Circle		6
@@ -884,8 +884,8 @@
 	SpellScript	spellScripts/circle6/reveal
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	20
+	Delay		6000
 
 	PowerWords	Wis  Quas
 	Circle		6
@@ -902,8 +902,8 @@
 	SpellScript	spellScripts/circle7/chainLightning
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	40
+	Delay		7000
 
 	PowerWords	Vas Ort Grav
 	Circle		7
@@ -922,8 +922,8 @@
 	SpellScript	spellScripts/circle7/energyField
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	40
+	Delay		7000
 
 	PowerWords	In Sanct Grav
 	Circle		7
@@ -942,8 +942,8 @@
 	SpellScript	spellScripts/circle7/flameStrike
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	40
+	Delay		7000
 
 	PowerWords	Kal Vas Flam
 	Circle		7
@@ -961,7 +961,7 @@
 
 	Difficulty	1
 	ManaCost	40
-	Delay		7
+	Delay		7000
 
 	PowerWords	Vas Rel Por
 	Circle		7
@@ -979,8 +979,8 @@
 	SpellScript	spellScripts/circle7/manaVampire
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	40
+	Delay		7000
 
 	PowerWords	Ort Sanct
 	Circle		7
@@ -999,8 +999,8 @@
 	SpellScript	spellScripts/circle7/massDispel
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	40
+	Delay		7000
 
 	PowerWords	Vas An Ort
 	Circle		7
@@ -1019,8 +1019,8 @@
 	SpellScript	spellScripts/circle7/meteorSwarm
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	40
+	Delay		7000
 
 	PowerWords	Kal Des Flam Ylem
 	Circle		7
@@ -1039,8 +1039,8 @@
 	SpellScript	spellScripts/circle7/polymorph
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	40
+	Delay		7000
 
 	PowerWords	Vas Ylem Rel
 	Circle		7
@@ -1058,8 +1058,8 @@
 	SpellScript	spellScripts/circle8/earthquake
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	50
+	Delay		8000
 
 	PowerWords	In Vas Por
 	Circle		8
@@ -1078,8 +1078,8 @@
 	SpellScript	spellScripts/circle8/energyVortex
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	50
+	Delay		8000
 
 	PowerWords	Vas Corp Por
 	Animation	0x11
@@ -1099,8 +1099,8 @@
 	SpellScript	spellScripts/circle8/resurrection
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	50
+	Delay		8000
 
 	PowerWords	An Corp
 	Circle		8
@@ -1118,8 +1118,8 @@
 	SpellScript	spellScripts/circle8/summonAirElemental
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	50
+	Delay		8000
 
 	Animation	0x11
 	PowerWords	Kal Vas Xen Hur
@@ -1138,8 +1138,8 @@
 	SpellScript	spellScripts/circle8/summonDeamon
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	50
+	Delay		8000
 
 	Animation	0x11
 	PowerWords	Kal Vas Xen Corp
@@ -1159,8 +1159,8 @@
 	SpellScript	spellScripts/circle8/summonEarthElemental
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	50
+	Delay		8000
 
 	Animation	0x11
 	PowerWords	Kal Vas Xen Ylem
@@ -1179,8 +1179,8 @@
 	SpellScript	spellScripts/circle8/summonFireElemental
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	50
+	Delay		8000
 
 	Animation	0x11
 	PowerWords	Kal Vas Xen Flam
@@ -1200,8 +1200,8 @@
 	SpellScript	spellScripts/circle8/summonWaterElemental
 
 	Difficulty	1
-	ManaCost	0
-	Delay		0
+	ManaCost	50
+	Delay		8000
 
 	Animation	0x11
 	PowerWords	Kal Vas Xen An Flam



From austin at berlios.de  Wed Nov 16 03:18:39 2005
From: austin at berlios.de (austin at BerliOS)
Date: Wed, 16 Nov 2005 03:18:39 +0100
Subject: [Poldistro-svn] r1007 - trunk/096
Message-ID: <200511160218.jAG2Idmq001859@sheep.berlios.de>

Author: austin
Date: 2005-11-16 03:18:30 +0100 (Wed, 16 Nov 2005)
New Revision: 1007

Modified:
   trunk/096/CoreChanges-096.txt
Log:


Modified: trunk/096/CoreChanges-096.txt
===================================================================
--- trunk/096/CoreChanges-096.txt	2005-11-15 11:58:06 UTC (rev 1006)
+++ trunk/096/CoreChanges-096.txt	2005-11-16 02:18:30 UTC (rev 1007)
@@ -1,4 +1,41 @@
 -- POL096 --
+11-15 Austin
+    Added : regions.cfg / justice.cfg support for EnterScript and LeaveScript.
+            Scripts will be run when a player enters or leaves the region.
+            Parameters passed to it are the mobile that entered/left and the region name.
+            Please note these scripts run critical.
+            Regions.cfg Example:
+            Region Britain
+            {
+                 Range      1416 1500 1740 1790
+                 Guarded    1
+                 EnterText  You have entered britain
+                 LeaveText  You have left britain
+                 Midi       9
+	
+                 EnterScript   :coords:enterScript
+                 LeaveScript   :coords:leaveScript
+            }
+            Example of enterScript.ecl
+            ------
+            use uo;
+            program EnterRegionZone(mobile, region_name)
+                   ApplyRawDamage(mobile, 10000);
+                   SendSysMessage(mobile, "You just died because you entered an area that makes you dead!");
+                   return 1;
+            endprogram
+            ------
+
+11-14 Austin
+    Fixed : uo::*InBox(x1, y1, z1, x2, y2, z2) functions will check the boundaries of the coordinates.
+            If they are too low or too high, they will be adjusted to fit within the realm.
+    Fixed : Using the .realm property on an intrinsic weapon caused a core crash.
+    Added : weapon.intrinsic
+
+11-10 Austin
+    Fixed : Items moved to invalid locations will not go to the player's feet on the 
+            correct realm and not just to britannia.
+    
 11-03 Austin
     Added : uo::CoordinateDistance(x1, y1, x2, y2) - Returns the distance between two coordinates.
     



From austin at berlios.de  Wed Nov 16 06:22:49 2005
From: austin at berlios.de (austin at BerliOS)
Date: Wed, 16 Nov 2005 06:22:49 +0100
Subject: [Poldistro-svn] r1008 - trunk/096
Message-ID: <200511160522.jAG5MnpA023616@sheep.berlios.de>

Author: austin
Date: 2005-11-16 06:22:45 +0100 (Wed, 16 Nov 2005)
New Revision: 1008

Removed:
   trunk/096/misc/
Log:
Read through old POL docs - world.dor.dat isnt needed.. not since like POL 30s :-P



From muaddiblsd at berlios.de  Wed Nov 16 08:05:47 2005
From: muaddiblsd at berlios.de (muaddiblsd at BerliOS)
Date: Wed, 16 Nov 2005 08:05:47 +0100
Subject: [Poldistro-svn] r1009 - in trunk/096/pkg: items/runebook skills/magery/config skills/magery/recallRune skills/magery/spellScripts/circle4 skills/magery/spellScripts/circle6 skills/magery/spellScripts/circle7 utils/coords/include
Message-ID: <200511160705.jAG75l7r002322@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-16 08:05:43 +0100 (Wed, 16 Nov 2005)
New Revision: 1009

Modified:
   trunk/096/pkg/items/runebook/customSpells.inc
   trunk/096/pkg/items/runebook/runeInsert.src
   trunk/096/pkg/items/runebook/runebook.src
   trunk/096/pkg/items/runebook/runebookFunctions.inc
   trunk/096/pkg/skills/magery/config/runeColor.cfg
   trunk/096/pkg/skills/magery/recallRune/methods.src
   trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src
   trunk/096/pkg/skills/magery/spellScripts/circle6/mark.src
   trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src
   trunk/096/pkg/utils/coords/include/isValidLoc.inc
Log:


Modified: trunk/096/pkg/items/runebook/customSpells.inc
===================================================================
--- trunk/096/pkg/items/runebook/customSpells.inc	2005-11-16 05:22:45 UTC (rev 1008)
+++ trunk/096/pkg/items/runebook/customSpells.inc	2005-11-16 07:05:43 UTC (rev 1009)
@@ -2,7 +2,7 @@
 use os;
 
 function runebookRecall(who, parms, book, charges, use_charge:=0)
-	var runebook_info := array{ book, parms };
+	var runebook_info := array{ book, parms, use_charge };
 	var script := Start_Script(":magery:spellStarter", {who, 32, 1, runebook_info});
 	if ( script.errortext )
 		SendSysMessage(who, "Error - Could not start spell starter ->"+script.errortext);

Modified: trunk/096/pkg/items/runebook/runeInsert.src
===================================================================
--- trunk/096/pkg/items/runebook/runeInsert.src	2005-11-16 05:22:45 UTC (rev 1008)
+++ trunk/096/pkg/items/runebook/runeInsert.src	2005-11-16 07:05:43 UTC (rev 1009)
@@ -94,23 +94,19 @@
 		MoveItemToContainer(rune, who.backpack);
 		return;
 	endif
-	if( !GetObjProperty(rune, "x") )
+	if( !GetObjProperty(rune, "Destination") )
 		SendSysMessage(who,"You can only add marked runes.");
 		MoveItemToContainer(rune, who.backpack);
-		return;
+		return 0;
 	endif
 	set_critical(1);
 
-	var temp := dictionary;
-	temp["Name"]  := rune.desc - "A recall rune for";
-	temp["Realm"] := GetObjProperty(rune, "realm");
-	temp["X"] := GetObjProperty(rune, "x");
-	temp["Y"] := GetObjProperty(rune, "y");
-	temp["Z"] := GetObjProperty(rune, "z");
+	var temp := GetObjProperty(rune, "Destination");
+	temp.+name := rune.name;
 	if( !rune.color )
-		temp["Color"] := 10;
+		temp.+color := 24;
 	else
-		temp["Color"] := rune.color;
+		temp.+color := CInt(rune.color);
 	endif
 	rune_list.append(temp);
 

Modified: trunk/096/pkg/items/runebook/runebook.src
===================================================================
--- trunk/096/pkg/items/runebook/runebook.src	2005-11-16 05:22:45 UTC (rev 1008)
+++ trunk/096/pkg/items/runebook/runebook.src	2005-11-16 07:05:43 UTC (rev 1009)
@@ -4,8 +4,6 @@
 
 include ":gumps:gumps";
 include ":gumps:gumps_ex";
-//include "include/math";
-include "include/client";
 include ":itemUtils:canAccess";
 include ":runebook:runebookFunctions";
 include ":runebook:customSpells";
@@ -79,12 +77,9 @@
 		else
 			var rune_info := GetRuneDetails(book, (result[0]-400));
 			var rune := CreateItemInBackpack(who, 0x1F14);
-			SetName(rune, rune_info.Name);
-			SetObjProperty(rune, "x", rune_info.X);
-			SetObjProperty(rune, "y", rune_info.Y);
-			SetObjProperty(rune, "z", rune_info.Z);
-			SetObjProperty(rune, "realm", rune_info.Realm);
-			rune.color := rune_info.Color;
+			SetName(rune, rune_info.name);
+			SetObjProperty(rune, "Destination", rune_info);
+			rune.color := rune_info.color;
 			DeleteRune(book, (result[0]-400));
 			return 1;
 		endif

Modified: trunk/096/pkg/items/runebook/runebookFunctions.inc
===================================================================
--- trunk/096/pkg/items/runebook/runebookFunctions.inc	2005-11-16 05:22:45 UTC (rev 1008)
+++ trunk/096/pkg/items/runebook/runebookFunctions.inc	2005-11-16 07:05:43 UTC (rev 1009)
@@ -96,21 +96,21 @@
 		endif
 
 		var rune_entry := rune_list[rune_pos];
-		if( TypeOf(rune_entry) == "Dictionary" )
-			if( rune_entry.Name )
+		if( TypeOf(rune_entry) == "Struct" )
+			if( rune_entry.name )
 				// Fixes any error with the text color.
-				if( TypeOf(rune_entry.Color) != "Integer" || rune_entry.Color < 0 )
-					rune_entry.Color := 10;
+				if( TypeOf(rune_entry.Color) != "Integer" || rune_entry.color < 0 )
+					rune_entry.color := 24;
 				endif
 				// This puts the rune in page 1's list.
 				GFPage(book_gump, 1);
-				GFTextCrop(book_gump, pOX,  pOY, 115, 17, rune_entry.Color, rune_entry.Name);
+				GFTextCrop(book_gump, pOX,  pOY, 115, 17, rune_entry.color, rune_entry.name);
 				GFPage(book_gump, i);
 
 				GFAddButton(book_gump, 130, 65, 2103, 2104, GF_CLOSE_BTN, charge_button);
-				GFTextCrop(book_gump, 145, 60, 115, 17, rune_entry.Color, rune_entry.Name);
-				GFTextLine(book_gump, 135, 80, 0, ConvertLatLong(rune_entry.X, rune_entry.Y, 1));
-				GFTextLine(book_gump, 135, 95, 0, ConvertLatLong(rune_entry.X, rune_entry.Y, 2));
+				GFTextCrop(book_gump, 145, 60, 115, 17, rune_entry.color, rune_entry.name);
+				GFTextLine(book_gump, 135, 80, 0, ConvertLatLong(rune_entry.x, rune_entry.y, 1));
+				GFTextLine(book_gump, 135, 95, 0, ConvertLatLong(rune_entry.x, rune_entry.y, 2));
 
 				GFAddButton(book_gump, 135, 115, 2437, 2438, GF_CLOSE_BTN, drop_rune_button);
 				GFHTMLArea(book_gump, 150, 115, 100, 18, "Drop Rune");
@@ -137,21 +137,21 @@
 		endif
 
 		rune_entry := rune_list[rune_pos];
-		if( TypeOf(rune_entry) == "Dictionary" )
-			if( rune_entry.Name )
+		if( TypeOf(rune_entry) == "Struct" )
+			if( rune_entry.name )
 				// Fixes any error with the text color.
-				if( TypeOf(rune_entry.Color) != "Integer" || rune_entry.Color < 0 )
-					rune_entry.Color := 10;
+				if( TypeOf(rune_entry.color) != "Integer" || rune_entry.color < 0 )
+					rune_entry.color := 10;
 				endif
 				// This puts the rune in page 1's list.
 				GFPage(book_gump, 1);
-				GFTextCrop(book_gump, pOX,  pOY, 115, 17, rune_entry.Color, rune_entry.Name);
+				GFTextCrop(book_gump, pOX,  pOY, 115, 17, rune_entry.color, rune_entry.name);
 				GFPage(book_gump, i);
 
 				GFAddButton(book_gump, 290, 65, 2103, 2104, GF_CLOSE_BTN, charge_button);
-				GFTextCrop(book_gump, 305, 60, 115, 17, rune_entry.Color, rune_entry.Name);
-				GFTextLine(book_gump, 295, 80, 0, ConvertLatLong(rune_entry.X, rune_entry.Y, 1));
-				GFTextLine(book_gump, 295, 95, 0, ConvertLatLong(rune_entry.X, rune_entry.Y, 2));
+				GFTextCrop(book_gump, 305, 60, 115, 17, rune_entry.color, rune_entry.name);
+				GFTextLine(book_gump, 295, 80, 0, ConvertLatLong(rune_entry.x, rune_entry.y, 1));
+				GFTextLine(book_gump, 295, 95, 0, ConvertLatLong(rune_entry.x, rune_entry.y, 2));
 
 				GFAddButton(book_gump, 295, 115, 2437, 2438, GF_CLOSE_BTN, drop_rune_button);
 				GFHTMLArea(book_gump, 310, 115, 100, 18, "Drop Rune");
@@ -311,11 +311,8 @@
 
 function SetDefault(book, who, rune_pos)
 	var rune_info := GetRuneDetails(book, rune_pos);
-	SetObjProperty(book, "x", rune_info.X);
-	SetObjProperty(book, "y", rune_info.Y);
-	SetObjProperty(book, "z", rune_info.Z);
-	SetObjProperty(book, "realm", rune_info.Realm);
-	SendSysMessage(who, "Default rune set to: " + rune_info.Name);
+	SetObjProperty(book, "Destination", rune_info);
+	SendSysMessage(who, "Default rune set to: " + rune_info.name);
 	return 1;
 endfunction
 

Modified: trunk/096/pkg/skills/magery/config/runeColor.cfg
===================================================================
--- trunk/096/pkg/skills/magery/config/runeColor.cfg	2005-11-16 05:22:45 UTC (rev 1008)
+++ trunk/096/pkg/skills/magery/config/runeColor.cfg	2005-11-16 07:05:43 UTC (rev 1009)
@@ -1,5 +1,25 @@
 
-Realm Britannia
+Realm britannia
 {
-	RuneColor	24
+	RuneColor	57
 }
+
+Realm britannia_alt
+{
+	RuneColor	34
+}
+
+Realm ilshenar
+{
+	RuneColor	54
+}
+
+Realm Malas
+{
+	RuneColor	17
+}
+
+Realm Tokuno
+{
+	RuneColor	88
+}
\ No newline at end of file

Modified: trunk/096/pkg/skills/magery/recallRune/methods.src
===================================================================
--- trunk/096/pkg/skills/magery/recallRune/methods.src	2005-11-16 05:22:45 UTC (rev 1008)
+++ trunk/096/pkg/skills/magery/recallRune/methods.src	2005-11-16 07:05:43 UTC (rev 1009)
@@ -17,15 +17,15 @@
 
 exported function SetDestination(rune, x, y, z, realm)
 	var coords := struct;
-	struct.+x := CInt(x);
-	struct.+y := CInt(y);
-	struct.+z := CInt(z);
-	struct.+realm := CStr(realm);
-	
+	coords.+x := CInt(x);
+	coords.+y := CInt(y);
+	coords.+z := CInt(z);
+	coords.+realm := CStr(realm);
+
 	var color_cfg := ReadConfigFile(":magery:config/runeColor");
 	var realm_elem := color_cfg[realm];
 	rune.color := CInt(realm_elem.RuneColor);
-		
+
 	return SetObjProperty(rune, "Destination", coords);
 endfunction
 
@@ -38,7 +38,6 @@
 	if ( !dest )
 		return error{"errortext":="Rune has no destination set."};
 	endif
-	
+
 	return MoveObjectToLocation(object, dest.x, dest.y, dest.z, dest.realm, MOVEOBJECT_FORCELOCATION);
 endfunction
-	
\ No newline at end of file

Modified: trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src
===================================================================
--- trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src	2005-11-16 05:22:45 UTC (rev 1008)
+++ trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src	2005-11-16 07:05:43 UTC (rev 1009)
@@ -38,14 +38,20 @@
 		SendSysMessage(who, "You cannot recall off of runes on a vendor.");
 		return 0;
 	endif
-	var tox := CInt(GetObjProperty( recall_rune, "x" ));
-	var toy := CInt(GetObjProperty( recall_rune, "y" ));
-	var toz := CInt(GetObjProperty( recall_rune, "z" ));
-	var torealm :=  GetObjProperty( recall_rune, "realm" );
-	if(!tox)
+	var rune_settings;
+	case(recall_rune.objtype)
+		UOBJ_RUNE: rune_settings := recall_rune.GetDestination();
+		0x6100: rune_settings := GetObjProperty(recall_rune, "Destination");
+	endcase
+	if( TypeOf(rune_settings) != "Struct" )
 		SendSysMessage(who, "That item is not marked.");
 		return 0;
 	endif
+
+	var tox := CInt(rune_settings.x);
+	var toy := CInt(rune_settings.y);
+	var toz := CInt(rune_settings.z);
+	var torealm :=  rune_settings.realm;
 	if(!torealm)
 		torealm := "britannia";
 	endif
@@ -106,7 +112,10 @@
 		return 0;
 	endif
 	DestroyItem(multicheck);
-	MoveObjectToLocation( who, tox, toy, toz, torealm );
+	case(recall_rune.objtype)
+		UOBJ_RUNE: recall_rune.SendToDestination(who);
+		0x6100: MoveObjectToLocation(who, tox, toy, toz, torealm, MOVEOBJECT_FORCELOCATION);
+	endcase
 	PlaySoundEffect(who, 0x1fd);
 	return 1;
 endprogram
@@ -158,9 +167,11 @@
 function RunebookRecall(who, runebook_info)
 	var runebook := runebook_info[1];
 	var rune_info := runebook_info[2];
+	var use_charge := runebook_info[3];
 
 	var spell_elem := MS_GetSpellsCfgElem(32);
-	if ( !CheckReagents(who, spell_elem, 0) )
+
+	if ( !CheckReagents(who, spell_elem, use_charge) )
 		FailSpell(who);
 		return 0;
 	endif
@@ -173,14 +184,16 @@
 		SendSysMessage(who, "You cannot recall off of runebooks on a vendor.");
 		return 0;
 	endif
-	var tox := CInt(rune_info.X);
-	var toy := CInt(rune_info.Y);
-	var toz := CInt(rune_info.Z);
-	var torealm :=  rune_info.Realm;
-	if(!tox)
-		SendSysMessage(who, "That is an invalid location.");
+
+	if( TypeOf(rune_info) != "Struct" )
+		SendSysMessage(who, "That item is not marked.");
 		return 0;
 	endif
+
+	var tox := CInt(rune_info.x);
+	var toy := CInt(rune_info.y);
+	var toz := CInt(rune_info.z);
+	var torealm :=  rune_info.realm;
 	if(!torealm)
 		torealm := "britannia";
 	endif

Modified: trunk/096/pkg/skills/magery/spellScripts/circle6/mark.src
===================================================================
--- trunk/096/pkg/skills/magery/spellScripts/circle6/mark.src	2005-11-16 05:22:45 UTC (rev 1008)
+++ trunk/096/pkg/skills/magery/spellScripts/circle6/mark.src	2005-11-16 07:05:43 UTC (rev 1009)
@@ -62,127 +62,9 @@
 
 	PlayObjectCenteredEffect(who, FX_MARK_EFFECT, 10, 10);
 	PlaySoundEffect(who, SFX_SPELL_MARK);
-	SetObjProperty(recall_rune, "x", who.x);
-	SetObjProperty(recall_rune, "y", who.y);
-	SetObjProperty(recall_rune, "z", who.z);
-	SetObjProperty(recall_rune, "realm", who.realm);
+	recall_rune.SetDestination(who.x, who.y, who.z, who.realm);
 
-	var color_cfg := ReadConfigFile(":magery:config/runeColor");
-	var realm_elem := color_cfg[who.realm];
-	recall_rune.color := CInt(realm_elem.RuneColor);
-
 	SetName(recall_rune, "a marked recall rune");
 
 	return 1;
-endprogram
-
-function RemoveRunebookDefault(runebook)
-	var tox := CInt(GetObjProperty( runebook, "x" ));
-	var toy := CInt(GetObjProperty( runebook, "y" ));
-	var toz := CInt(GetObjProperty( runebook, "z" ));
-	var torealm := GetObjProperty( runebook, "realm" );
-	var rune_list := GetRuneList(runebook);
-
-	foreach rune_entry in rune_list
-		if( (Cint(rune_list.X) == tox) && (Cint(rune_list.Y) == toy) && (Cint(rune_list.Z) == toz) && (Cint(rune_list.Realm) == torealm) )
-			rune_list.Erase(rune_entry);
-		endif
-	endforeach
-
-	SetObjProperty(runebook, "%RuneList%", rune_list);
-	EraseObjProperty(runebook, "x");
-	EraseObjProperty(runebook, "y");
-	EraseObjProperty(runebook, "z");
-	EraseObjProperty(runebook, "realm");
-	return 1;
-endfunction
-
-
-function RemoveRunebookEntry(runebook, rune_info)
-	var tox := CInt(rune_info.X);
-	var toy := CInt(rune_info.Y);
-	var toz := CInt(rune_info.Z);
-	var torealm :=  rune_info.Realm;
-	var rune_list := GetRuneList(runebook);
-
-	foreach rune_entry in rune_list
-		if( (Cint(rune_list.X) == tox) && (Cint(rune_list.Y) == toy) && (Cint(rune_list.Z) == toz) && (Cint(rune_list.Realm) == torealm) )
-			rune_list.Erase(rune_entry);
-		endif
-	endforeach
-
-	SetObjProperty(runebook, "%RuneList%", rune_list);
-	EraseObjProperty(runebook, "x");
-	EraseObjProperty(runebook, "y");
-	EraseObjProperty(runebook, "z");
-	EraseObjProperty(runebook, "realm");
-	return 1;
-endfunction
-
-
-function RunebookRecall(who, runebook_info)
-	var runebook := runebook_info[1];
-	var rune_info := runebook_info[2];
-
-	if( !ReserveItem(runebook) )
-		return 0;
-	endif
-
-	if( GetObjProperty(runebook, "Vendored") )
-		SendSysMessage(who, "You cannot recall off of runebooks on a vendor.");
-		return 0;
-	endif
-	var tox := CInt(rune_info.X);
-	var toy := CInt(rune_info.Y);
-	var toz := CInt(rune_info.Z);
-	var torealm :=  rune_info.Realm;
-	if(!tox)
-		SendSysMessage(who, "That is an invalid location.");
-		return 0;
-	endif
-	if(!torealm)
-		torealm := "britannia";
-	endif
-
-	if( !isValidLoc(tox,toy,torealm) )
-		SendSysMessage(who, "Invalid recall location.");
-		RemoveRunebookEntry(runebook, rune_info);
-		return 0;
-	endif
-
-	PlaySoundEffect(who, 0x210);
-
-	if( (who.x >= 5120) && (who.x <= 5375) && (who.y >= 0) && (who.y <= 255) )
-		SendSysMessage(who, "Your spell fails and consumes the rune!");
-		RemoveRunebookEntry(runebook, rune_info);
-		return 0;
-	endif
-
-	var signs := ListItemsNearLocationOfType( tox, toy, toz, 30, 0x7060, torealm);
-	foreach sign in signs
-		var infoarr := GetObjProperty(sign, "homeinfo");
-		if( infoarr )
-			if( (tox >= infoarr[2]) && (tox <= infoarr[4]) && (toy >= infoarr[3]) && (toy <= infoarr[5]) )
-				SendSysMessage(who, "Something is blocking the location.");
-				return 0;
-				break;
-			endif
-		endif
-	endforeach
-
-	var multicheck := CreateItemAtLocation(1, 1, 0, 0xeed, 1, torealm);
-	multicheck.invisible := 1;
-	if( !MoveItemToLocation(multicheck, tox, toy, toz, MOVEITEM_NORMAL) )
-		SendSysMessage(who, "Something is blocking the location.");
-		return 0;
-	endif
-	if(multicheck.multi)
-		SendSysMessage(who,"A house is blocking the location.");
-		RemoveRunebookEntry(runebook, rune_info);
-		return 0;
-	endif
-	DestroyItem(multicheck);
-	MoveObjectToLocation( who, tox, toy, toz, torealm );
-	PlaySoundEffect(who, 0x1fd);
-	return 1;
-endfunction
\ No newline at end of file
+endprogram
\ No newline at end of file

Modified: trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src
===================================================================
--- trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src	2005-11-16 05:22:45 UTC (rev 1008)
+++ trunk/096/pkg/skills/magery/spellScripts/circle7/gate.src	2005-11-16 07:05:43 UTC (rev 1009)
@@ -38,14 +38,21 @@
 		SendSysMessage(who, "You cannot recall off of runes on a vendor.");
 		return 0;
 	endif
-	var tox := CInt(GetObjProperty( recall_rune, "x" ));
-	var toy := CInt(GetObjProperty( recall_rune, "y" ));
-	var toz := CInt(GetObjProperty( recall_rune, "z" ));
-	var torealm :=  GetObjProperty( recall_rune, "realm" );
-	if(!tox)
+
+	var rune_settings;
+	case(recall_rune.objtype)
+		UOBJ_RUNE: rune_settings := recall_rune.GetDestination();
+		0x6100: rune_settings := GetObjProperty(recall_rune, "Destination");
+	endcase
+	if( TypeOf(rune_settings) != "Struct" )
 		SendSysMessage(who, "That item is not marked.");
 		return 0;
 	endif
+
+	var tox := CInt(rune_settings.x);
+	var toy := CInt(rune_settings.y);
+	var toz := CInt(rune_settings.z);
+	var torealm :=  rune_settings.realm;
 	if(!torealm)
 		torealm := "britannia";
 	endif
@@ -204,14 +211,16 @@
 		SendSysMessage(who, "You cannot recall off of runebooks on a vendor.");
 		return 0;
 	endif
-	var tox := CInt(rune_info.X);
-	var toy := CInt(rune_info.Y);
-	var toz := CInt(rune_info.Z);
-	var torealm :=  rune_info.Realm;
-	if(!tox)
-		SendSysMessage(who, "That is an invalid location.");
+
+	if( TypeOf(rune_info) != "Struct" )
+		SendSysMessage(who, "That item is not marked.");
 		return 0;
 	endif
+
+	var tox := CInt(rune_info.x);
+	var toy := CInt(rune_info.y);
+	var toz := CInt(rune_info.z);
+	var torealm :=  rune_info.realm;
 	if(!torealm)
 		torealm := "britannia";
 	endif

Modified: trunk/096/pkg/utils/coords/include/isValidLoc.inc
===================================================================
--- trunk/096/pkg/utils/coords/include/isValidLoc.inc	2005-11-16 05:22:45 UTC (rev 1008)
+++ trunk/096/pkg/utils/coords/include/isValidLoc.inc	2005-11-16 07:05:43 UTC (rev 1009)
@@ -50,8 +50,9 @@
 	  endif
 
   else
-  	var realm := Realms()[realm];
-  	if( x >= realm.width || y >= realm.height )
+  	var t_realm := Realms()[realm];
+
+  	if( x >= t_realm.width || y >= t_realm.height )
   		return 0;
   	endif
   endif



From muaddiblsd at berlios.de  Wed Nov 16 08:06:50 2005
From: muaddiblsd at berlios.de (muaddiblsd at BerliOS)
Date: Wed, 16 Nov 2005 08:06:50 +0100
Subject: [Poldistro-svn] r1010 - in trunk/096/pkg/items/runebook: . config
Message-ID: <200511160706.jAG76oTx003072@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-16 08:06:48 +0100 (Wed, 16 Nov 2005)
New Revision: 1010

Added:
   trunk/096/pkg/items/runebook/config/
   trunk/096/pkg/items/runebook/config/icp.cfg
Log:


Added: trunk/096/pkg/items/runebook/config/icp.cfg
===================================================================
--- trunk/096/pkg/items/runebook/config/icp.cfg	2005-11-16 07:05:43 UTC (rev 1009)
+++ trunk/096/pkg/items/runebook/config/icp.cfg	2005-11-16 07:06:48 UTC (rev 1010)
@@ -0,0 +1,19 @@
+# $Id$
+#
+#
+ICP Register
+{
+	Name		Runebooks
+	Version		1.0
+	Description	Runebook Package
+
+	Creator		MuadDib
+	C_Email		muaddib at lostsoulsshard.org
+
+	Maintainer	Distro Team
+	M_Email		distro at polserver.com
+
+	#Script	cmdlevel path
+
+	#TextCmd	cmdlevel path
+}


Property changes on: trunk/096/pkg/items/runebook/config/icp.cfg
___________________________________________________________________
Name: svn:keywords
   + Id



From muaddiblsd at berlios.de  Wed Nov 16 08:20:38 2005
From: muaddiblsd at berlios.de (muaddiblsd at BerliOS)
Date: Wed, 16 Nov 2005 08:20:38 +0100
Subject: [Poldistro-svn] r1011 - trunk/096/pkg/commands/include
Message-ID: <200511160720.jAG7KcGd008349@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-16 08:20:21 +0100 (Wed, 16 Nov 2005)
New Revision: 1011

Modified:
   trunk/096/pkg/commands/include/goText.inc
Log:


Modified: trunk/096/pkg/commands/include/goText.inc
===================================================================
--- trunk/096/pkg/commands/include/goText.inc	2005-11-16 07:06:48 UTC (rev 1010)
+++ trunk/096/pkg/commands/include/goText.inc	2005-11-16 07:20:21 UTC (rev 1011)
@@ -35,12 +35,12 @@
 	if (Realms().Exists(lower(params[5])))
 		var move_check := 0;
 		if (who.realm == lower(params[5]))
-			move_check := MoveCharacterToLocation(who, CInt(params[2]), CInt(params[3]), CInt(params[4]), MOVECHAR_FORCELOCATION);
+			move_check := MoveCharacterToLocation(who, CInt(params[2]), CInt(params[3]), CInt(params[4]));
 		else
-			move_check := MoveObjectToRealm(who, lower(params[5]), CInt(params[2]), CInt(params[3]), CInt(params[4]), MOVECHAR_FORCELOCATION);
+			move_check := MoveObjectToRealm(who, lower(params[5]), CInt(params[2]), CInt(params[3]), CInt(params[4]));
                 endif
 		if( move_check == error )
-			GumpPrompt(who, "Invalid Realm name in xyz!");
+			GumpPrompt(who, move_check);
 			return 1;
 		endif
 	else



From muaddiblsd at berlios.de  Wed Nov 16 08:26:38 2005
From: muaddiblsd at berlios.de (muaddiblsd at BerliOS)
Date: Wed, 16 Nov 2005 08:26:38 +0100
Subject: [Poldistro-svn] r1012 - in trunk/096: pkg/utils pkg/utils/coords/config pkg/utils/coords/include scripts/misc
Message-ID: <200511160726.jAG7QcCN009317@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-16 08:26:09 +0100 (Wed, 16 Nov 2005)
New Revision: 1012

Added:
   trunk/096/pkg/utils/coords/config/inns-britannia.cfg
   trunk/096/pkg/utils/coords/config/inns-britannia_alt.cfg
   trunk/096/pkg/utils/coords/include/innFunctions.inc
Removed:
   trunk/096/pkg/utils/inns/
Modified:
   trunk/096/scripts/misc/logofftest.src
Log:
Moved inns pkg into the coords pkg.

Added: trunk/096/pkg/utils/coords/config/inns-britannia.cfg
===================================================================
--- trunk/096/pkg/utils/coords/config/inns-britannia.cfg	2005-11-16 07:20:21 UTC (rev 1011)
+++ trunk/096/pkg/utils/coords/config/inns-britannia.cfg	2005-11-16 07:26:09 UTC (rev 1012)
@@ -0,0 +1,163 @@
+# $Id: inns-britannia.cfg 983 2005-11-14 06:49:18Z muaddiblsd $
+#
+#
+
+Region Britain_Northside_Inn_1
+{
+	Rect	1455 1511 1471 1527
+}
+
+Region Britain_Northside_Inn_2
+{
+	Rect	1470 1511 1479 1519
+}
+
+Region Britain_Wayfarers_Inn
+{
+	Rect	1575 1583 1599 1599
+}
+
+Region Britain_Sweet_Dreams_Inn
+{
+	Rect	1491 1601 1507 1625
+}
+
+Region Moonglow_Student_Hostel_1
+{
+	Rect	4475 1059 4491 1067
+}
+
+Region Moonglow_Student_Hostel_2
+{
+	Rect	4479 1055 4487 1071
+}
+
+Region Moonglow_The_Scholars_Inn_1
+{
+	Rect	4383 1151 4391 1175
+}
+
+Region Moonglow_The_Scholars_Inn_2
+{
+	Rect	4391 1159 4407 1167
+}
+
+Region Moonglow_The_Scholars_Inn_3
+{
+	Rect	4399 1151 4407 1159
+}
+
+Region Nujelm_Restful_Slumber_1
+{
+	Rect	3727 1287 3743 1343
+}
+
+Region Nujelm_Restful_Slumber_2
+{
+	Rect	3743 1287 3751 1303
+}
+
+Region Nujelm_Restful_Slumber_3
+{
+	Rect	3743 1327 3751 1343
+}
+
+Region Skara_Brae_The_Falconers_Inn_1
+{
+	Rect	590 2238 623 2255
+}
+
+Region Skara_Brae_The_Falconers_Inn_2
+{
+	Rect	599 2231 615 2239
+}
+
+Region Trinsic_The_Travellers_Inn
+{
+	Rect	1833 2727 1855 2743
+}
+
+Region Trinsic_The_Rusty_Anchor
+{
+	Rect	2023 2783 2039 2812
+}
+
+Region Vesper_The_Ironwood_Inn_1
+{
+	Rect	2775 951 2791 983
+}
+
+Region Vesper_The Ironwood Inn 2
+{
+	Rect	2767 959 2775 977
+}
+
+Region Vesper_Youth_Hostel_1
+{
+	Rect	2952 863 2967 895
+}
+
+Region Vesper_Youth_Hostel_2
+{
+	Rect	2967 871 2975 887
+}
+
+Region Wind_Inn
+{
+	Rect	5159 15 5184 40
+}
+
+Region Wind_Bunkhouse
+{
+	Rect	5303 28 5318 40
+}
+
+Region Papua_The_Just_Inn
+{
+	Rect	5756 3149 5783 3168
+}
+
+Region Delucia_Abandoned_Inn
+{
+	Rect	5184 4054 5203 4072
+}
+
+Region Bucs_The_Peg_Leg_Inn_1
+{
+	Rect	2711 2079 2727 2095
+}
+
+Region Bucs_The_Peg_Leg_Inn_2
+{
+	Rect	2711 2095 2720 2104
+}
+
+Region Magincia_The_Stag_and_Lion_Inn_1
+{
+	Rect	3679 2151 3703 2175
+}
+
+Region Serpents_Hold_Broken_Arrow_Inn
+{
+	Rect	2959 3399 2975 3415
+}
+
+Region Jhelom_Morning_Star_Inn_1
+{
+	Rect	1351 3799 1367 3831
+}
+
+Region Jhelom_Morning_Star_Inn_2
+{
+	Rect	1367 3807 1375 3823
+}
+
+Region Minoc_The_Barnacle_Tavern
+{
+	Rect	2456 396 2496 413
+}
+
+Region Ocllo_Bountiful_Harvest_Inn
+{
+	Rect	3662 2608 3679 2623
+}
\ No newline at end of file

Added: trunk/096/pkg/utils/coords/config/inns-britannia_alt.cfg
===================================================================
--- trunk/096/pkg/utils/coords/config/inns-britannia_alt.cfg	2005-11-16 07:20:21 UTC (rev 1011)
+++ trunk/096/pkg/utils/coords/config/inns-britannia_alt.cfg	2005-11-16 07:26:09 UTC (rev 1012)
@@ -0,0 +1,163 @@
+# $Id: inns-britannia_alt.cfg 983 2005-11-14 06:49:18Z muaddiblsd $
+#
+#
+
+Region Britain_Northside_Inn_1
+{
+	Rect	1455 1511 1471 1527
+}
+
+Region Britain_Northside_Inn_2
+{
+	Rect	1470 1511 1479 1519
+}
+
+Region Britain_Wayfarers_Inn
+{
+	Rect	1575 1583 1599 1599
+}
+
+Region Britain_Sweet_Dreams_Inn
+{
+	Rect	1491 1601 1507 1625
+}
+
+Region Moonglow_Student_Hostel_1
+{
+	Rect	4475 1059 4491 1067
+}
+
+Region Moonglow_Student_Hostel_2
+{
+	Rect	4479 1055 4487 1071
+}
+
+Region Moonglow_The_Scholars_Inn_1
+{
+	Rect	4383 1151 4391 1175
+}
+
+Region Moonglow_The_Scholars_Inn_2
+{
+	Rect	4391 1159 4407 1167
+}
+
+Region Moonglow_The_Scholars_Inn_3
+{
+	Rect	4399 1151 4407 1159
+}
+
+Region Nujelm_Restful_Slumber_1
+{
+	Rect	3727 1287 3743 1343
+}
+
+Region Nujelm_Restful_Slumber_2
+{
+	Rect	3743 1287 3751 1303
+}
+
+Region Nujelm_Restful_Slumber_3
+{
+	Rect	3743 1327 3751 1343
+}
+
+Region Skara_Brae_The_Falconers_Inn_1
+{
+	Rect	590 2238 623 2255
+}
+
+Region Skara_Brae_The_Falconers_Inn_2
+{
+	Rect	599 2231 615 2239
+}
+
+Region Trinsic_The_Travellers_Inn
+{
+	Rect	1833 2727 1855 2743
+}
+
+Region Trinsic_The_Rusty_Anchor
+{
+	Rect	2023 2783 2039 2812
+}
+
+Region Vesper_The_Ironwood_Inn_1
+{
+	Rect	2775 951 2791 983
+}
+
+Region Vesper_The Ironwood Inn 2
+{
+	Rect	2767 959 2775 977
+}
+
+Region Vesper_Youth_Hostel_1
+{
+	Rect	2952 863 2967 895
+}
+
+Region Vesper_Youth_Hostel_2
+{
+	Rect	2967 871 2975 887
+}
+
+Region Wind_Inn
+{
+	Rect	5159 15 5184 40
+}
+
+Region Wind_Bunkhouse
+{
+	Rect	5303 28 5318 40
+}
+
+Region Papua_The_Just_Inn
+{
+	Rect	5756 3149 5783 3168
+}
+
+Region Delucia_Abandoned_Inn
+{
+	Rect	5184 4054 5203 4072
+}
+
+Region Bucs_The_Peg_Leg_Inn_1
+{
+	Rect	2711 2079 2727 2095
+}
+
+Region Bucs_The_Peg_Leg_Inn_2
+{
+	Rect	2711 2095 2720 2104
+}
+
+Region Magincia_The_Stag_and_Lion_Inn_1
+{
+	Rect	3679 2151 3703 2175
+}
+
+Region Serpents_Hold_Broken_Arrow_Inn
+{
+	Rect	2959 3399 2975 3415
+}
+
+Region Jhelom_Morning_Star_Inn_1
+{
+	Rect	1351 3799 1367 3831
+}
+
+Region Jhelom_Morning_Star_Inn_2
+{
+	Rect	1367 3807 1375 3823
+}
+
+Region Minoc_The_Barnacle_Tavern
+{
+	Rect	2456 396 2496 413
+}
+
+Region Ocllo_Bountiful_Harvest_Inn
+{
+	Rect	3662 2608 3679 2623
+}
\ No newline at end of file

Added: trunk/096/pkg/utils/coords/include/innFunctions.inc
===================================================================
--- trunk/096/pkg/utils/coords/include/innFunctions.inc	2005-11-16 07:20:21 UTC (rev 1011)
+++ trunk/096/pkg/utils/coords/include/innFunctions.inc	2005-11-16 07:26:09 UTC (rev 1012)
@@ -0,0 +1,18 @@
+use uo;
+use cfgfile;
+
+function isInInn(who)
+	var inn_config := ReadConfigFile(":coords:inns-"+who.realm);
+	var inn_locations := GetConfigStringKeys(inn_config);
+	foreach inn in inn_locations
+		var element :=  inn_config[inn];
+		var rect := element.rect;
+		rect := SplitWords(rect);
+		if( (who.x >= CInt(rect[1])) && (who.x <= CInt(rect[3])) && (who.y >= CInt(rect[2])) && (who.y <= CInt(rect[4])) )
+			return 1;
+			break;
+		endif
+	endforeach
+
+	return 0;
+endfunction
\ No newline at end of file

Modified: trunk/096/scripts/misc/logofftest.src
===================================================================
--- trunk/096/scripts/misc/logofftest.src	2005-11-16 07:20:21 UTC (rev 1011)
+++ trunk/096/scripts/misc/logofftest.src	2005-11-16 07:26:09 UTC (rev 1012)
@@ -8,7 +8,7 @@
 use uo;
 
 include "include/time";
-include ":inns:innFunctions";
+include ":coords:innFunctions";
 include ":timedscripts:timedScripts";
 
 program core_logoffTest(who)



From austin at berlios.de  Wed Nov 16 08:45:28 2005
From: austin at berlios.de (austin at BerliOS)
Date: Wed, 16 Nov 2005 08:45:28 +0100
Subject: [Poldistro-svn] r1013 - trunk/096
Message-ID: <200511160745.jAG7jSL0014748@sheep.berlios.de>

Author: austin
Date: 2005-11-16 08:45:16 +0100 (Wed, 16 Nov 2005)
New Revision: 1013

Modified:
   trunk/096/CoreChanges-096.txt
Log:


Modified: trunk/096/CoreChanges-096.txt
===================================================================
--- trunk/096/CoreChanges-096.txt	2005-11-16 07:26:09 UTC (rev 1012)
+++ trunk/096/CoreChanges-096.txt	2005-11-16 07:45:16 UTC (rev 1013)
@@ -1,52 +1,53 @@
--- POL096 --
 11-15 Austin
-    Added : regions.cfg / justice.cfg support for EnterScript and LeaveScript.
-            Scripts will be run when a player enters or leaves the region.
-            Parameters passed to it are the mobile that entered/left and the region name.
-            Please note these scripts run critical.
-            Regions.cfg Example:
-            Region Britain
-            {
-                 Range      1416 1500 1740 1790
-                 Guarded    1
-                 EnterText  You have entered britain
-                 LeaveText  You have left britain
-                 Midi       9
+        Added : using "::regions/" in a config path will allow a config file from pol/regions/ to be read.
+                Example ReadConfigFile("::regions/justice");
+        Added : regions.cfg / justice.cfg support for EnterScript and LeaveScript.
+                Scripts will be run when a player enters or leaves the region.
+                Parameters passed to it are the mobile that entered/left and the region name.
+                Please note these scripts run critical.
+                Regions.cfg Example:
+                Region Britain
+                {
+                    Range      1416 1500 1740 1790
+                    Guarded    1
+                    EnterText  You have entered britain
+                    LeaveText  You have left britain
+                    Midi       9
 	
-                 EnterScript   :coords:enterScript
-                 LeaveScript   :coords:leaveScript
-            }
-            Example of enterScript.ecl
-            ------
-            use uo;
-            program EnterRegionZone(mobile, region_name)
-                   ApplyRawDamage(mobile, 10000);
-                   SendSysMessage(mobile, "You just died because you entered an area that makes you dead!");
-                   return 1;
-            endprogram
-            ------
+                    EnterScript   :coords:enterScript
+                    LeaveScript   :coords:leaveScript
+                }
+                Example of enterScript.ecl
+                ------
+                use uo;
+                program EnterRegionZone(mobile, region_name)
+                     ApplyRawDamage(mobile, 10000);
+                     SendSysMessage(mobile, "You just died because you entered an area that makes you dead!");
+                     return 1;
+                endprogram
+                ------
 
 11-14 Austin
-    Fixed : uo::*InBox(x1, y1, z1, x2, y2, z2) functions will check the boundaries of the coordinates.
-            If they are too low or too high, they will be adjusted to fit within the realm.
-    Fixed : Using the .realm property on an intrinsic weapon caused a core crash.
-    Added : weapon.intrinsic
-
+        Fixed : uo::*InBox(x1, y1, z1, x2, y2, z2) functions will check the boundaries of the coordinates.
+                If they are too low or too high, they will be adjusted to fit within the realm.
+        Fixed : Using the .realm property on an intrinsic weapon caused a core crash.
+        Added : weapon.intrinsic
+    
 11-10 Austin
-    Fixed : Items moved to invalid locations will not go to the player's feet on the 
-            correct realm and not just to britannia.
-    
+        Fixed : Items moved to invalid locations will not go to the player's feet on the 
+                correct realm and not just to britannia.
+            
 11-03 Austin
-    Added : uo::CoordinateDistance(x1, y1, x2, y2) - Returns the distance between two coordinates.
+        Added : uo::CoordinateDistance(x1, y1, x2, y2) - Returns the distance between two coordinates.
     
-    The following two functions were originally scripted by Myrathi:
-    Added : uo::GetCoordsInLine(x1, y1, x2, y2) - Returns an array of structs {.x, .y} for every coordinate
-            between the two points.
-    Added : uo::GetFacing(from_x, from_y, to_x, to_y) - Returns the facing number an object must have in order to 
-            face to_x and to_y from from_x and from_y.
-
+        The following two functions were originally scripted by Myrathi:
+        Added : uo::GetCoordsInLine(x1, y1, x2, y2) - Returns an array of structs {.x, .y} for every coordinate
+                between the two points.
+        Added : uo::GetFacing(from_x, from_y, to_x, to_y) - Returns the facing number an object must have in order to 
+                face to_x and to_y from from_x and from_y.
+    
 10-31 Austin
-	Fixed : Core crash with MoveCharacterToLocation() when a character was moved to the same realm.
+        Fixed : Core crash with MoveCharacterToLocation() when a character was moved to the same realm.
 
 10-30 Austin
         Changed : NPC.connected will now always return 1. Before it was 0.
@@ -81,10 +82,10 @@
         Added : servspecopt.cfg - 'DoubleClickWait'. (Default is 0)
                 Time in seconds that must pass before a player can double click something again.
         Added : mobile.GetCorpse() - Returns an item reference to the most recent corpse made.
-
+        
 10-03 Austin
         Added : corpse.ownerserial - Returns the serial of the npc / player that died.
-
+        
 10-02 Shinigami
         Added : Prop script_process.attached_to and script_process.controller.
                 (script_process comes from NPC.process or uo::GetProcess(pid))
@@ -1105,4 +1106,3 @@
 06-20 Syzygy
     account.GetCharacter(index) will notice if you pass 0, which is bad.
         account.DeleteCharacter(index) - same
-



From austin at berlios.de  Sat Nov 19 12:41:44 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 12:41:44 +0100
Subject: [Poldistro-svn] r1014 - trunk/096/pkg/mobiles/brainAI/bundled/banker
Message-ID: <200511191141.jAJBfiNZ031114@sheep.berlios.de>

Author: austin
Date: 2005-11-19 12:41:33 +0100 (Sat, 19 Nov 2005)
New Revision: 1014

Modified:
   trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src
Log:
Supports withdrawl and check commands now.

Modified: trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src	2005-11-16 07:45:16 UTC (rev 1013)
+++ trunk/096/pkg/mobiles/brainAI/bundled/banker/listen.src	2005-11-19 11:41:33 UTC (rev 1014)
@@ -5,6 +5,7 @@
 include ":brainAI:npcNerves";
 include ":brainAI:npcCommands";
 include ":containers:storageAreas";
+include ":containers:containers";
 
 program BrainNerve(params)
 	var npc		:= params[1];
@@ -13,7 +14,7 @@
 	//var settings	:= params[4];
 	//var scripts	:= params[5];
 	params := 0; // Not needed anymore.
-	
+
 	while ( npc )
 		if ( event )
 			case ( event.type )
@@ -23,19 +24,19 @@
 				default:
 					break;
 			endcase
-			
+
 			event := 0;
 		endif
-		
+
 		sleepms(5);
 		event := wait_for_event(100000);
 	endwhile
 endprogram
 
 function SpeechEvent(npc, byref event)
-	var text := event.text;
+	var text := Lower(event.text);
 	var source := event.source;
-	
+
 	if ( source.IsA(POLCLASS_NPC) )
 		// Remember - NPCs can send speech events now.
 		return 0;
@@ -43,20 +44,58 @@
 		// No line of sight - ignore speech.
 		return 0;
 	endif
-	
+
+	// Support for regional banking.
+	// Example: Seperate bank boxes for Britain, Trinsic, Moonglow, etc.
 	var bank_region := GetObjProperty(npc, "StorageArea");
 	if ( !bank_region )
 		bank_region := CP_DEFAULT_AREA;
 	endif
-	
+
 	var bank_box := CP_GetStorageContainerForMobile(source, bank_region, CP_CREATE);
 	if ( text["bank"] || text["box"] )
-		AI_Turn(npc, source, NETURN_TOWARD);		
+		AI_Turn(npc, source, NETURN_TOWARD);
 		SendOpenSpecialContainer(source, bank_box);
+	elseif ( text["withdrawl "] )
+		WithdrawlGold(npc, source, bank_box, text);
+	elseif ( text["check "] )
+		var amount := FindAmountInSpeech("check", text);
+		CheckGoldAmount(npc, bank_box, amount);
 	endif
-	// To-do:
-	// Gold withdrawl and deposit support?
-	//	
-	
+
 	return 1;
 endfunction
+
+function WithdrawlGold(npc, who, bank_box, byref text)
+	var amount := FindAmountInSpeech("withdrawl", text);
+	if ( !CheckGoldAmount(npc, bank_box, amount) )
+		return 0;
+	endif
+
+	ConsumeSubstance(bank_box, GetObjTypeByName("GoldCoin"), amount);
+	CreateItemInBackPack(who, "GoldCoin", amount);
+
+	return 1;
+endfunction
+
+function CheckGoldAmount(npc, bank_box, amount)
+	var total_gold := AmountInContainer(bank_box, GetObjTypeByName("GoldCoin"));
+	if ( amount == 0 )
+		AI_Speak(npc, "Everyone has atleast zero gold!");
+		return 0;
+	elseif ( amount > total_gold )
+		AI_Speak(npc, "You do not have that much gold in your box.");
+		return 0;
+	else
+		AI_Speak(npc, "You have enough gold.");
+		return 1;
+	endif
+endfunction
+
+function FindAmountInSpeech(key, text)
+	var key_pos := Find(text, key, 1);
+	text[1, (key_pos+Len(key))] := "";
+
+	text := SplitWords(text);
+	return CInt(text[1]);
+endfunction



From austin at berlios.de  Sat Nov 19 13:51:17 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 13:51:17 +0100
Subject: [Poldistro-svn] r1015 - in trunk/096/pkg/items/hair: . config hairdye
Message-ID: <200511191251.jAJCpHXr021318@sheep.berlios.de>

Author: austin
Date: 2005-11-19 13:51:14 +0100 (Sat, 19 Nov 2005)
New Revision: 1015

Modified:
   trunk/096/pkg/items/hair/config/hairColors.cfg
   trunk/096/pkg/items/hair/hairdye/use.src
   trunk/096/pkg/items/hair/itemdesc.cfg
Log:
Hair dye works... hooray? 

Modified: trunk/096/pkg/items/hair/config/hairColors.cfg
===================================================================
--- trunk/096/pkg/items/hair/config/hairColors.cfg	2005-11-19 11:41:33 UTC (rev 1014)
+++ trunk/096/pkg/items/hair/config/hairColors.cfg	2005-11-19 12:51:14 UTC (rev 1015)
@@ -16,7 +16,7 @@
 ####################
 
 Elem	Index
-{
+{	// Controls order categories appear in.
 	Category	Auburn
 	Category	Blonde
 	Category	Blue
@@ -29,59 +29,58 @@
 	Category	Purple
 	Category	Red
 }
-	
 
+
 HairColor Grey
 {
-	// 22 shades of grey
 	TitleColor	2305
-	Color	2301
-	Color	2102
-	Color	2302
-	Color	2403
-	Color	2409
-	Color	2103
-	Color	2404
-	Color	2410
+	Color	992
+	Color	2412
 	Color	2411
-	Color	2105
+	Color	2410
+	Color	2409
 	Color	2406
+	Color	2404
+	Color	2403
 	Color	2306
+	Color	2302
+	Color	2301
 	Color	2106
-	Color	2412
-	Color	1107
+	Color	2105
+	Color	2103
+	Color	2102
+	Color	1908
 	Color	1907
-	Color	992
 	Color	1899
-	Color	1908
-	Color	1108
 	Color	1109
+	Color	1108
+	Color	1107
 }
+
 HairColor Chestnut
 {
-	// 16 shades of chestnut
 	TitleColor	1753
-	Color	1743
+	Color	1754
+	Color	1753
 	Color	1752
+	Color	1745
+	Color	1743
+	Color	1736
+	Color	1727
+	Color	1717
+	Color	1708
 	Color	1707
-	Color	1516
-	Color	1130
 	Color	1517
-	Color	1708
-	Color	1717
-	Color	1131
-	Color	1753
+	Color	1516
 	Color	1509
-	Color	1727
-	Color	1736
-	Color	1745
-	Color	1754
-	Color	1125
 	Color	1132
+	Color	1131
+	Color	1130
+	Color	1125
 }
+
 HairColor Golden
 {
-	// 24 shades
 	TitleColor	1514
 	Color	2009
 	Color	2215
@@ -110,7 +109,6 @@
 }
 HairColor Blonde
 {
-	// 17 shades of Blonde
 	TitleColor	1727
 	Color	2007
 	Color	2313
@@ -134,7 +132,6 @@
 }
 HairColor Auburn
 {
-	// 21 Shades of Auburn
 	TitleColor	1860
 	Color	1860
 	Color	1869
@@ -160,7 +157,6 @@
 }
 HairColor LtBrown
 {
-	// 26 shades of light brown
 	TitleColor	1113
 	Color	2107
 	Color	1819
@@ -190,7 +186,6 @@
 }
 HairColor DkBrown
 {
-	// 26 shades of dark brown
 	TitleColor	2111
 	Color	1056
 	Color	1114
@@ -221,7 +216,6 @@
 }
 HairColor Blue
 {
-	// 25 shades of blue
 	TitleColor	1315
 	Color	1319
 	Color	1401
@@ -250,7 +244,6 @@
 }
 HairColor Red
 {
-	// 32 shades of red
 	TitleColor	1207
 	Color	1219
 	Color	1619
@@ -288,7 +281,6 @@
 }
 HairColor Green
 {
-	// 32 shades of green
 	TitleColor	2129
 	Color	2001
 	Color	2002
@@ -325,7 +317,6 @@
 }
 HairColor Purple
 {
-	// 28 shades of purple
 	TitleColor	1243
 	Color	1230
 	Color	1239

Modified: trunk/096/pkg/items/hair/hairdye/use.src
===================================================================
--- trunk/096/pkg/items/hair/hairdye/use.src	2005-11-19 11:41:33 UTC (rev 1014)
+++ trunk/096/pkg/items/hair/hairdye/use.src	2005-11-19 12:51:14 UTC (rev 1015)
@@ -7,45 +7,128 @@
 use os;
 use cfgfile;
 
+include "include/client";
 include ":gumps:gumps";
 include ":gumps:gumps_ex";
-include "include/arrays";
 
+unload_scripts("hairdye");
+
+CONST CANCEL_BTN	:= 0xA00001;
+CONST OKAY_BTN		:= 0xA00002;
+
 program UseDyes(who, dyes)
-	var gump := BuildHairDyeGump();
-	GFSendGump(who, gump);
-	
+	if ( !ReserveItem(dyes) )
+		SendSysMessage(who, "Someone else is already using that.");
+		return 0;
+	elseif ( !(dyes in EnumerateItemsInContainer(who.backpack)) )
+		SendSysMessage(who, "That must be in your backpack to be used.");
+		return 0;
+	endif
+
+	var hair := GetEquipmentByLayer(who, LAYER_HAIR);
+	var beard := GetEquipmentByLayer(who, LAYER_BEARD);
+	var color := CInt(hair.color);
+	if ( !color )
+		color := CInt(beard.color);
+	endif
+
+	var gump := BuildHairDyeGump(color);
+	var input := GFSendGump(who, gump);
+
+	if ( input[0] == 0 || input[CANCEL_BTN] )
+		SendSysMessage(who, "Cancelled.");
+		return 0;
+	endif
+
+	foreach key in ( input.keys )
+		if ( key > 2 )
+			color := key;
+			break;
+		endif
+		sleepms(2);
+	endforeach
+
+	if ( !IsValidHairColor(color) )
+		// Occurs when custom values are inserted into the gump with client cheats.
+		// Remember Raph Koster's rule - "The client is in the hands of the enemy. Never trust it."
+		SendSysMessage(who, "Error - Color found ["+color+"] is invalid.");
+		return 0;
+	endif
+
+	hair.color := color;
+	beard.color := color;
+	SubtractAmount(dyes, 1);
+
 	return 1;
 endprogram
 
-//GFResizePic(gump, 0, 0, GFCfgConst("Defaults", "BackGround"), 310, 420);
-//GFResizePic(gump, 10, 10, GFCfgConst("Defaults", "ForeGround"), 290, 400);
+function BuildHairDyeGump(cur_color := 0)
+	var gump := GFCreateGump();
 
-function BuildHairDyeGump()
-	var gump := GFCreateGump();
-	
-	GFPage(0);
-	GFClosable(gump, 0);
+	GFPage(gump, 0);
+	//GFClosable(gump, 0);
 	GFResizePic(gump, 0, 0, GFCfgConst("Defaults", "BackGround"), 400, 450);
 	GFResizePic(gump, 15, 15, GFCfgConst("Defaults", "ForeGround"), 120, 420);
 	GFResizePic(gump, 140, 15, GFCfgConst("Defaults", "ForeGround"), 245, 380);
-	
+
+	GFAddButton(gump, 190, 405, 2128, 2129, GF_CLOSE_BTN, 1);
+	GFAddButton(gump, 265, 405, 2119, 2120, GF_CLOSE_BTN, 2);
+
 	var color_cfg := ReadConfigFile(":hair:config/hairColors");
-	var index_elem := color_cfg["Index"];
-	var color_list := array{};
-	var color_info := struct;
-	color_info.+
-	
-	
-	GetConfigStringArray(index_elem, "Category");
-	
+	var index_elem := color_cfg["Index"]; // Controls order colors appear.
+	var categories := GetConfigStringArray(index_elem, "Category");
+
+	// Build category buttons on the left first
 	var index_y := 25;
-	foreach category in ( color_list )
-		GFAddButton(gump, 20, index_y+3, 5224, 5224, GF_PAGE_BTN, _color_info_iter);
-		GFTextLine(gump, 50, index_y, color_info.cat_color, color_info.name);
+	foreach category in ( categories )
+		GFAddButton(gump, 20, index_y+3, 5224, 5224, GF_PAGE_BTN, _category_iter);
+		var color_elem := color_cfg[category];
+		GFTextLine(gump, 50, index_y, color_elem.TitleColor, category);
+
 		index_y := index_y + 20;
 		sleepms(2);
 	endforeach
-	
+
+	// Build colors inside each category
+	foreach category in ( categories )
+		GFPage(gump, _category_iter);
+		var color_elem := color_cfg[category];
+
+		var color_x := 150;
+		var color_y := 20;
+		var side := 1;
+		foreach color in ( GetConfigStringArray(color_elem, "Color") )
+			color := CInt(color);
+			GFRadioButton(gump, color_x, color_y, 210, 211, (color == cur_color), color);
+			GFTextLine(gump, color_x+20, color_y, color-1, category);
+			if ( side == 1 )
+				color_x := 290;
+				side := 0;
+			else
+				color_x := 150;
+				color_y := color_y+20;
+				side := 1;
+			endif
+
+			sleepms(2);
+		endforeach
+		sleepms(2);
+	endforeach
+
 	return gump;
 endfunction
+
+function IsValidHairColor(color_num)
+	var color_cfg := ReadConfigFile(":hair:config/hairColors");
+	color_num := CStr(color_num);
+
+	foreach elem_name in ( GetConfigStringKeys(color_cfg) )
+		var cfg_elem := color_cfg[elem_name];
+		if ( color_num in GetConfigStringArray(cfg_elem, "Color") )
+			return 1;
+		endif
+		sleepms(2);
+	endforeach
+
+	return 0;
+endfunction

Modified: trunk/096/pkg/items/hair/itemdesc.cfg
===================================================================
--- trunk/096/pkg/items/hair/itemdesc.cfg	2005-11-19 11:41:33 UTC (rev 1014)
+++ trunk/096/pkg/items/hair/itemdesc.cfg	2005-11-19 12:51:14 UTC (rev 1015)
@@ -4,7 +4,7 @@
 	Desc		cut hair
 
 	Movable		0
-	
+
 	ControlScript	cuthair/control
 }
 
@@ -12,8 +12,8 @@
 {
 	Name		HairDye
 	Desc		hair dye
-	Graphic		6215	
-	
+	Graphic		3623
+
 	Script		hairdye/use
 }
 



From austin at berlios.de  Sat Nov 19 13:53:57 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 13:53:57 +0100
Subject: [Poldistro-svn] r1016 - trunk/096/pkg/items/hair/hairdye
Message-ID: <200511191253.jAJCrvwW022569@sheep.berlios.de>

Author: austin
Date: 2005-11-19 13:53:54 +0100 (Sat, 19 Nov 2005)
New Revision: 1016

Modified:
   trunk/096/pkg/items/hair/hairdye/use.src
Log:
removed unload_scripts() line

Modified: trunk/096/pkg/items/hair/hairdye/use.src
===================================================================
--- trunk/096/pkg/items/hair/hairdye/use.src	2005-11-19 12:51:14 UTC (rev 1015)
+++ trunk/096/pkg/items/hair/hairdye/use.src	2005-11-19 12:53:54 UTC (rev 1016)
@@ -11,8 +11,6 @@
 include ":gumps:gumps";
 include ":gumps:gumps_ex";
 
-unload_scripts("hairdye");
-
 CONST CANCEL_BTN	:= 0xA00001;
 CONST OKAY_BTN		:= 0xA00002;
 



From austin at berlios.de  Sat Nov 19 13:58:24 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 13:58:24 +0100
Subject: [Poldistro-svn] r1017 - in trunk/096/pkg: . multis multis/boat multis/housing multis/housing/commands multis/housing/commands/gm systems
Message-ID: <200511191258.jAJCwOKV025558@sheep.berlios.de>

Author: austin
Date: 2005-11-19 13:58:15 +0100 (Sat, 19 Nov 2005)
New Revision: 1017

Added:
   trunk/096/pkg/multis/
   trunk/096/pkg/multis/boat/
   trunk/096/pkg/multis/boat/boat.src
   trunk/096/pkg/multis/boat/itemdesc.cfg
   trunk/096/pkg/multis/boat/pkg.cfg
   trunk/096/pkg/multis/boat/plank.src
   trunk/096/pkg/multis/boat/plankControl.src
   trunk/096/pkg/multis/boat/plankUtil.inc
   trunk/096/pkg/multis/boat/plankWalk.src
   trunk/096/pkg/multis/boat/shipDeed.src
   trunk/096/pkg/multis/boat/tillerman.src
   trunk/096/pkg/multis/housing/
   trunk/096/pkg/multis/housing/changeOwner.src
   trunk/096/pkg/multis/housing/commands/
   trunk/096/pkg/multis/housing/commands/gm/
   trunk/096/pkg/multis/housing/commands/gm/destroyMulti.src
   trunk/096/pkg/multis/housing/commands/gm/makeMulti.src
   trunk/096/pkg/multis/housing/houseBanning.src
   trunk/096/pkg/multis/housing/houseDeed.src
   trunk/096/pkg/multis/housing/itemdesc.cfg
   trunk/096/pkg/multis/housing/pkg.cfg
   trunk/096/pkg/multis/housing/secureCont.src
   trunk/096/pkg/multis/housing/sign.src
   trunk/096/pkg/multis/housing/signControl.src
Removed:
   trunk/096/pkg/systems/boat/
   trunk/096/pkg/systems/housing/
Log:
Took housing and boats out of 'systems' and added a 'multis' category

Added: trunk/096/pkg/multis/boat/boat.src
===================================================================
--- trunk/096/pkg/multis/boat/boat.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/boat/boat.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,790 @@
+////////////////
+//	boat.src 
+//
+//	control script for boats
+//
+//	Header replaced by Racalac 9/15/02
+//
+//	Todo/Fix: Course nav needs the "goto #" command implimented.
+//			  Tillerman string recognition causes boat to pause
+////////////////
+
+use os;
+use uo;
+use util;
+use boat;
+
+include "include/OLD/eventID";
+include "include/sysEvent";
+include ":itemutils:myUtil";
+include "include/client";
+include "include/OLD/sound";
+include ":gumps:yesno";
+include "util/key";
+include "plankUtil";
+
+const STATE_STATIONARY := 0;
+const STATE_MOVING := 1;
+const STATE_DRIFTING := 2;
+const STATE_FOLLOWING_COURSE := 3; //NOTE NEW STATE
+const DELAY_DRIFTING := 15000;
+
+/*NOTE NEW CONSTANTS*/
+const NEGONE := -1;
+const ZERO := 0;
+const POSONE := 1;
+
+var state := STATE_STATIONARY;
+var relative_direction;
+var ms_delay_between_moves := 200;
+var boat;
+var tillerman;
+var owner := GetObjProperty(boat.hold,"owner");
+var decay := GetObjProperty(boat.tillerman, "decay");
+
+/*NOTE NEW GLOBAL*/
+var first_move_toward_waypoint := 1;
+
+program autostart_boat(param)
+  boat := param;
+  if(!boat)
+    syslog( "[ERROR] [boat.src] Boat script running, but boat not found!" );
+    return;
+  endif
+  tillerman := boat.tillerman;
+  if(!tillerman)
+    syslog( "[ERROR] [boat.src] No tillerman for boat at: " +(boat.x-1) +","+ boat.y +","+ boat.z + "; destroying the boat..." );
+    DestroyMulti(boat);
+    return;
+  endif
+  EnableEvents(SYSEVENT_SPEECH, 15);
+  RegisterForSpeechEvents(tillerman, 15);
+  var nextencounter := ReadGameClock()+(RandomInt(120) + 120);
+  var nextsound := ReadGameClock()+5;
+  var driftcounter := 1;
+  //set_critical(1);
+  var x,y;
+  while(boat)
+    if(GetObjProperty(boat.hold, "#speed"))
+      state := STATE_MOVING;
+      ms_delay_between_moves := GetObjProperty(boat.hold, "#speed"); 
+      relative_direction := GetObjProperty(boat.hold, "#relativedir");
+      eraseobjproperty(boat.hold, "#speed");
+      eraseobjproperty(boat.hold, "#relativedir");    
+    endif     
+    decay := getobjproperty(boat.tillerman,"decay");
+    if((decay) and(!getobjproperty(tillerman,"nodecay")))
+      if(ReadGameClock() > decay)
+        PrintTextAbove(tillerman, "Arrrrrgh!  She's going down, Captain!  Abandon ship!");
+        sleep(4);
+        foreach item in EnumerateItemsInContainer( boat.hold )
+          DestroyItem(item);
+        endforeach
+        foreach mob in(boat.items)
+          DestroyItem(mob);
+        endforeach        
+        foreach mob in(boat.mobiles)
+          MoveCharacterToLocation(mob, 1, 1, 0,  MOVECHAR_FORCELOCATION );
+          SendSysMessage(mob, "Your ship, badly in need of maintenance, sinks beneath the waves!");
+          SendSysMessage(mob, "You awake on a distant shore...");
+        endforeach
+        if(boat.has_offline_mobiles)
+          foreach mob in(boat.offline_mobiles)
+            MoveCharacterToLocation(mob, 1, 1, 0,  MOVECHAR_FORCELOCATION );
+          endforeach
+        endif
+        DestroyMulti(boat);
+      endif
+    endif    
+    case(state)
+      STATE_MOVING:   if(ReadGameClock() > nextsound)
+                        PlayBoatSounds();
+                        nextsound := ReadGameClock()+5;
+                      endif
+                      x := boat.x;
+                      y := boat.y;
+                      MoveBoatRelative(boat, relative_direction);
+                      if(boat.x == 6 or boat.x == 5097 or boat.y == 6 or boat.y == 4089)   
+                        WorldWrap();
+                      endif
+                      if((x == boat.x) &&(y == boat.y))
+                        ms_delay_between_moves := 1000;
+                        state := STATE_DRIFTING;
+                        PrintTextAbove(tillerman, "Aaargh!  We've run ashore!");
+                        //SmackEveryone();
+                      endif
+                      sleepms(ms_delay_between_moves);
+                      if(ReadGameClock() > nextencounter)
+                        DoEncounter();
+                        nextencounter := ReadGameClock()+120;
+                      endif
+                      while(events_waiting())
+                        process_event(wait_for_event(0));
+                      endwhile
+      STATE_DRIFTING:   if(ReadGameClock() > nextsound)
+                          PlayBoatSounds();
+                          nextsound := ReadGameClock()+5;
+                        endif
+                        if(driftcounter > 15)
+                          MoveBoatRelative(boat, RandomInt(8));
+                          driftcounter := 1;
+                        else
+                          driftcounter := driftcounter + 1;
+                        endif
+                        sleepms(1000);
+                        while(events_waiting())
+                          process_event(wait_for_event(0));
+                        endwhile
+      STATE_STATIONARY: var ev := wait_for_event(120);
+                        if(ev)
+                          process_event(ev);
+                        endif
+/*NOTE NEW BOAT STATE*/
+      STATE_FOLLOWING_COURSE:
+        		x := boat.x;
+        		y := boat.y;
+        		BoatFollowCourse(boat);
+        				
+        		sleepms(ms_delay_between_moves);
+                        while(events_waiting())
+                          process_event(wait_for_event(0));
+                        endwhile
+/*END NEW BOAT STATE*/
+    endcase
+    if(ReadGameClock() > nextencounter)
+      checkres();
+      nextencounter := ReadGameClock()+120;
+    endif
+  endwhile
+endprogram
+
+function handle_speech(event)
+  var text := lower(event.text);
+  if(text["drift"] || text["raise anchor"])
+    ms_delay_between_moves := 1000;
+    state := STATE_DRIFTING;
+    PrintTextAbove(tillerman, "Aye Aye, Captain!");
+  elseif(text["forward"])
+    if(state == STATE_STATIONARY)
+      PrintTextAbove(tillerman, "The anchor is down, Captain!");
+    else
+      PrintTextAbove(tillerman, "Aye Aye, Captain!");
+      state := STATE_MOVING;
+      if(text["left"])
+        relative_direction := 7;
+      elseif(text["right"])
+        relative_direction := 1;
+      else
+        relative_direction := 0;
+      endif
+    endif
+  elseif(text["back"])
+    if(state == STATE_STATIONARY)
+      PrintTextAbove(tillerman, "The anchor is down, Captain!");
+    else
+      PrintTextAbove(tillerman, "Aye Aye, Captain!");
+      state := STATE_MOVING;
+      if(text["left"])
+        relative_direction := 5;
+      elseif(text["right"])
+        relative_direction := 3;
+      else
+        relative_direction := 4;
+      endif
+    endif
+  elseif(text["stop"] || text["furl sail"] || text["furl"])
+    PrintTextAbove(tillerman, "Aye Aye, Captain!");
+    ms_delay_between_moves := 1000;
+    state := STATE_DRIFTING;
+  elseif(text["drop anchor"])
+    PrintTextAbove(tillerman, "Aye Aye, Captain! Anchor dropped.");
+    ms_delay_between_moves := 1000;
+    state := STATE_STATIONARY;
+  elseif(text["turn right"] || text["starboard"])
+    if(state == STATE_STATIONARY)
+      PrintTextAbove(tillerman, "The anchor is down, Captain!");
+    else
+      PrintTextAbove(tillerman, "Aye Aye, Captain!");
+      TurnBoat(boat, 1);
+    endif
+  elseif(text["right"])
+    if(state == STATE_STATIONARY)
+      PrintTextAbove(tillerman, "The anchor is down, Captain!");
+    else
+      PrintTextAbove(tillerman, "Aye Aye, Captain!");
+      state := STATE_MOVING;
+      relative_direction := 2;
+    endif
+  elseif(text["turn left"] || text["port"])
+    if(state == STATE_STATIONARY)
+      PrintTextAbove(tillerman, "The anchor is down, Captain!");
+    else
+      PrintTextAbove(tillerman, "Aye Aye, Captain!");
+      TurnBoat(boat, 3);
+    endif
+  elseif(text["left"])
+    if(state == STATE_STATIONARY)
+      PrintTextAbove(tillerman, "The anchor is down, Captain!");
+    else
+      PrintTextAbove(tillerman, "Aye Aye, Captain!");
+      state := STATE_MOVING;
+      relative_direction := 6;
+    endif
+  elseif(text["come about"] || text["turn around"])
+    if(state == STATE_STATIONARY)
+      PrintTextAbove(tillerman, "The anchor is down, Captain!");
+    else
+      PrintTextAbove(tillerman, "Aye Aye, Captain! Coming about!");
+      TurnBoat(boat, 2);
+      sleep(1);
+    endif
+/*NEW MAP COURSE COMMANDS*/
+    elseif(text["set course"])
+      	PrintTextAbove(tillerman, "Select a map for me to follow.");   	
+      	var map := Target(event.source);
+      	if(!map.isa(POLCLASS_MAP))
+      		PrintTextAbove(tillerman, "Are ye dense? I need a map!"); 
+      	else
+      		SetObjProperty(tillerman, "course", map.GetPins());
+      		SetObjProperty(tillerman, "nextwaypoint", 1);
+      		PrintTextAbove(tillerman, "Arr, course plotted."); 
+      	endif
+    elseif(text["clear course"])
+    	PrintTextAbove(tillerman, "Arr, course cleared Cap'n.");
+    	EraseObjProperty(tillerman, "course");
+    	EraseObjProperty(tillerman, "nextwaypoint");
+    elseif(text["nav"])
+    	if(state != STATE_FOLLOWING_COURSE)
+    		PrintTextAbove(tillerman, "We are not currently following a course.");
+    	else
+    		PrintTextAbove(tillerman, "We are following our course.");
+    		PrintTextAbove(tillerman, "The next waypoint is #" + GetObjProperty(tillerman,"nextwaypoint"));
+    	endif
+    elseif(text["start"])
+    	if( (GetObjProperty(tillerman,"course")==error) || (GetObjProperty(tillerman,"nextwaypoint")==error))
+    		PrintTextAbove(tillerman,"Arr, set course first Cap'n.");
+    	else    		
+     		state := STATE_FOLLOWING_COURSE;
+     		SetObjProperty(tillerman, "nextwaypoint", 1);
+    		PrintTextAbove(tillerman,"Aye, sailing to first waypoint.");
+    	endif
+    elseif(text["continue"])
+    	if( (GetObjProperty(tillerman,"course")==error) || (GetObjProperty(tillerman,"nextwaypoint")==error))
+    		PrintTextAbove(tillerman,"Arr, set course first Cap'n.");
+    	else
+    	    state := STATE_FOLLOWING_COURSE;
+    		PrintTextAbove(tillerman,"Aye, moving on.");
+    	endif
+  	endif
+/*END NEW MAP COURSE COMMANDS*/
+  if(text["full"])
+    if(state != STATE_STATIONARY)
+      PrintTextAbove(tillerman, "Aye Aye, Captain! Full speed ahead!");
+      ms_delay_between_moves := 100;
+    endif
+  elseif(text["slow"])
+    if(state != STATE_STATIONARY)
+      PrintTextAbove(tillerman, "Aye Aye, Captain! ");
+      ms_delay_between_moves := 1000;
+    endif
+  endif
+  sleep(1);
+  if(text["one"])
+    if(state != STATE_STATIONARY)
+      MoveBoatRelative(boat, relative_direction);
+      state := STATE_STATIONARY;
+    endif
+  endif
+endfunction
+
+function process_event(event)
+  if(event.type == SYSEVENT_SPEECH)
+    if(CanCommandMe(event.source))
+      var text := lower(event.text);
+      if(text["drydock"])
+        PrintTextAbove(tillerman, "Aye Aye, Captain! Docking.");
+        drydock(event);
+        sleep(1);
+      elseif(text["status"])
+        decay := GetObjProperty(boat.tillerman, "decay");
+        if((decay - ReadGameClock() ) > 861000 )
+          PrintTextAbove( tillerman, "Arrh, the ship's in excellent shape! She's a fine vessel indeed, Captain!" );
+        elseif((decay - ReadGameClock() ) > 604800 )
+          PrintTextAbove( tillerman, "She's slightly worn, Captain.");
+        elseif((decay - ReadGameClock() ) > 259200 )
+          PrintTextAbove(tillerman, "She's fairly worn, Captain.");
+        elseif((decay - ReadGameClock() ) > 86400 )
+          PrintTextAbove(tillerman, "Arrr, she's greatly worn and in dire need of repair, Captain!");
+        else 
+          PrintTextAbove(tillerman, "Arrr, she's going to sink within the day if she don't get repairs soon, Captain!");
+        endif
+      else
+        foreach person in (boat.mobiles)
+          if (event.source == person)
+             handle_speech(event);
+          endif  
+        endforeach
+      endif
+    endif
+  endif
+  
+endfunction
+
+function CanCommandMe(who)
+  owner := GetObjProperty(boat.tillerman, "owner");
+  if(who.serial == owner)
+    return 1;
+  else
+    var packkey;
+    var lokid := GetObjProperty(boat.tillerman, "lockid");
+    foreach thing in EnumerateItemsInContainer(who.backpack)
+      if(GetObjProperty(thing, "lockid") == lokid)
+        packkey := 1;
+        break;
+      endif
+    endforeach
+    if(packkey == 1)
+      return 1;
+    else
+      return 0;
+    endif
+  endif
+endfunction
+
+function DoEncounter()
+  foreach who in  ListMobilesNearLocationEx(boat.x, boat.y, GetMapInfo(boat.x, boat.y, boat.realm).z, 4, LISTEX_FLAG_GHOST, boat.realm)
+    if(YesNo(who,"Resurrect?"))
+      if (who in boat.mobiles)
+        PlaySoundEffect(who, SFX_SPELL_RESSURECTION);
+        PlaySoundEffect(who, SFX_SPELL_RESSURECTION);
+        Resurrect(who);
+      endif
+    endif
+  endforeach
+  var who :=(boat.mobiles);
+  who := who[1];
+  if(!who)
+    return;
+  endif
+  var x;
+  var y;
+  var z;
+  x := RandomInt(15)-5;
+  y := RandomInt(15)-5;
+  x := x + boat.x;
+  y := y + boat.y;
+  if(x > boat.x)
+    x := x + 5;
+  else
+    x := x - 5;
+  endif
+  if(y > boat.y)
+    y := y + 5;
+  else
+    y := y - 5;
+  endif
+  z := GetMapInfo(x, y, boat.realm).z;
+  if(z >= who.z)
+    return;
+  endif
+  var it := CreateNpcFromTemplate(getcritter(), x, y, z, 0, boat.realm);
+  if(it)
+    SetObjProperty(it,"killme",1);
+  endif
+  var ev := {};
+  ev.+type := EVID_ENTEREDAREA;
+  ev.+source := who;
+  SendEvent(it, ev);
+endfunction
+
+function checkres()
+  foreach who in  ListMobilesNearLocationEx(boat.x, boat.y, GetMapInfo(boat.x, boat.y, boat.realm).z, 4, LISTEX_FLAG_GHOST, boat.realm)
+    if(who in boat.mobiles)
+      if(YesNo(who,"Resurrect?"))
+        PlaySoundEffect(who, SFX_SPELL_RESSURECTION);
+        PlaySoundEffect(who, SFX_SPELL_RESSURECTION);
+        Resurrect(who);
+      endif
+    endif
+  endforeach
+endfunction
+
+function getcritter()
+  case(RandomInt(9))
+    0: return "walrus";
+    1: return "walrus";
+    2: return "walrus";
+    3: return "walrus";
+    4: return "alligator";
+    5: return "alligator";
+    6: return "waterelemental";
+    7: return "seaserpent";
+    8: return "airelemental";
+  endcase
+endfunction
+
+function drydock(event)
+  if(GetObjProperty(event.source, "#DryDocking"))
+    SendSysMessage(event.source, "You are already doing something else.");
+    return;
+  endif
+  SetObjProperty(event.source, "#DryDocking", 1);
+  EraseObjProperty(event.source, "#DryDocking");
+  var text := lower(event.text);
+  if(!text["drydock"])
+    EraseObjProperty(event.source, "#DryDocking");
+    return;
+  endif
+  var me := event.source;
+  var items := boat.items;
+  var mobsondeck := boat.mobiles;
+
+  if(len(items) > 0)
+    PrintTextAbovePrivate(boat.tillerman, "Arrh, Captain!  You can't drydock the boat while items are on deck!", me);
+    EraseObjProperty(me, "#DryDocking");
+    return;
+  endif
+  items := EnumerateItemsInContainer(boat.hold);
+  if(len(items) > 0)
+    PrintTextAbovePrivate(boat.tillerman, "Arrh, we'd best clear out the items in the hold first, Captain!", me);
+    EraseObjProperty(me, "#DryDocking");
+    return;
+  endif
+  if(len(mobsondeck) > 0)
+    PrintTextAbovePrivate(boat.tillerman, "Arrh, Captain!  You can't drydock the boat while people are on the deck!", me);
+    EraseObjProperty(me, "#DryDocking");
+    return;
+  endif  
+  if(CanDockMe(boat, me))
+    if(!YesNo(me,"Drydock the ship?"))
+      EraseObjProperty(me, "#DryDocking");
+      return;
+    endif
+    var shiptype;
+    case(boat.objtype)
+      0x6040: shiptype := 0x6027;
+      0x6041: shiptype := 0x6028;
+      0x6042: shiptype := 0x6029;
+      0x6043: shiptype := 0x602a;
+      0x6044: shiptype := 0x602b;
+      0x6045: shiptype := 0x602c;
+    endcase
+    if(!shiptype)
+      SendSysMessage(me, "Your boat seems to be malfunctioning. Please page a GM.");
+      return;
+    endif
+    var newboat := CreateItemInContainer(me.backpack, shiptype, 1);
+    var key := FindKey(me, boat.tillerman);
+    if(!newboat)
+      SendSysMessage(me,"Could not create boat deed in your backpack!");
+      EraseObjProperty(me, "#DryDocking");
+      return;
+    endif
+    if(ReserveItem(newboat))
+      newboat.graphic := 0x14f3;
+      if(!boat.tillerman.name)
+        newboat.name := "a toy boat";
+      else
+        newboat.name := boat.tillerman.name;
+      endif
+      if(!DestroyBoat(boat))
+        DestroyItem(newboat);
+        EraseObjProperty(me, "#DryDocking");
+        return;
+      endif
+    else
+      DestroyItem(newboat);
+      EraseObjProperty(me, "#DryDocking");
+      return;
+    endif
+    if(key)
+      DestroyItem(key);
+    endif
+  endif
+  EraseObjProperty(me, "#DryDocking");
+endfunction
+
+function DestroyBoat(who)
+  var res := DestroyMulti(boat);
+  if(!res)
+    return 0;
+  endif
+  return 1;
+endfunction
+
+function SmackEveryone()
+  foreach mob in(boat.mobiles)
+    ApplyDamage(mob,RandomInt(10));
+    PerformAction(mob,0x14);
+    PlaySoundEffect(mob,0x110);
+  endforeach
+endfunction
+
+function PlayBoatSounds()
+  var who := RandomInt(len(boat.mobiles)+1);
+  var mobs :=(boat.mobiles);
+  if(RandomInt(2) == 1)
+    PlaySoundEffect(mobs[who],0x13);
+  else
+    PlaySoundEffect(mobs[who],0x14);
+  endif
+endfunction
+
+function WorldWrap()
+  var newx := boat.x;
+  var newy := boat.y;
+  if(boat.y <= 6)
+    newy := 4088;
+  elseif(boat.y >= 4089)
+    newy := 6;
+  endif
+  if(boat.x <= 6)
+    newx := 5096;
+  elseif(boat.x >= 5097)
+    newx := 6;
+  endif
+  var lockid := GetObjProperty(boat.hold, "lockid");
+  var owner := GetObjProperty(boat.hold, "owner");
+  var shiptype := boat.objtype;
+  var shipfacing, created;
+  case(tillerman.graphic)
+    0x3e4e: shipfacing := CRMULTI_FACING_NORTH;
+    0x3e55: shipfacing := CRMULTI_FACING_EAST;
+    0x3e4b: shipfacing := CRMULTI_FACING_SOUTH;
+    0x3e50: shipfacing := CRMULTI_FACING_WEST;
+    default: shipfacing := "Error!";
+  endcase
+  if(shipfacing == "Error!")
+    syslog( "[ERROR] [boat.src] Couldn't tell which way the ship was facing for the worldwrap!");
+  endif    
+  created := CreateMultiAtLocation( newx, newy, -5, shiptype, shipfacing, boat.realm);
+  if(!created)
+    syslog( "[ERROR] [boat.src] New ship couldn't be created for worldwrap!");
+    return;
+  endif
+  var oldshiphold := boat.hold;
+  var newshiphold := created.hold;
+  foreach item in EnumerateItemsInContainer( oldshiphold )
+    if(item.container == oldshiphold)
+      MoveItemToContainer(item, newshiphold);
+    endif
+  endforeach
+  foreach item in EnumerateItemsInContainer( oldshiphold )
+    MoveItemToContainer(item, newshiphold);
+  endforeach
+  foreach mob in(boat.mobiles)
+    MoveCharacterToLocation(mob,(mob.x-boat.x)+created.x,(mob.y-boat.y)+created.y, -2,  MOVECHAR_FORCELOCATION );
+  endforeach
+  if(boat.has_offline_mobiles)
+    foreach mob in(boat.offline_mobiles)
+      MoveCharacterToLocation(mob,(mob.x-boat.x)+created.x,(mob.y-boat.y)+created.y, -2,  MOVECHAR_FORCELOCATION );
+    endforeach
+  endif
+  foreach mob in(boat.items)
+    MoveitemToLocation(mob,(mob.x-boat.x)+created.x,(mob.y-boat.y)+created.y, -2,0  );
+  endforeach
+  var newtillerman := created.tillerman;
+  newtillerman.name := tillerman.name;
+  SetObjProperty( created.starboardplank, "lockid", lockid);
+  SetObjProperty( created.portplank, "lockid", lockid);
+  SetObjProperty( created.ship.starboardplank, "owner", owner );
+  SetObjProperty( created.ship.portplank, "owner", owner );
+  SetObjProperty( created.ship.starboardplank, "tillermanid", newtillerman.serial );
+  SetObjProperty( created.ship.portplank, "tillermanid", newtillerman.serial );
+  SetObjProperty( created.hold, "lockid", lockid);
+  SetObjProperty( created.hold, "owner", owner);
+  SetObjProperty( created.tillerman, "owner", owner);
+  SetObjProperty( created.tillerman, "shipserial", created.serial);
+  SetObjProperty( created.tillerman, "lockid", lockid);
+  SetObjProperty( created.tillerman, "decay", decay);
+  if(boat.starboardplank.locked == 1)
+    created.starboardplank.locked := 1;
+  endif
+  if(boat.portplank.locked == 1)  
+    created.portplank.locked := 1;
+  endif
+  if(boat.hold.locked == 1)
+    created.hold.locked := 1;
+  endif
+  SetObjProperty( created.hold, "#relativedir", relative_direction);
+  SetObjProperty( created.hold, "#speed", ms_delay_between_moves);
+  created.tillerman.usescript := ":boat:tillerman";
+  if(!DestroyMulti(boat))
+    DestroyItem(boat.tillerman);
+    syslog( "[ERROR] [boat.src] Old ship at " +(boat.x-1) +","+ boat.y +","+ boat.z + " couldn't be destroyed during worldwrap!");
+  endif
+endfunction
+
+function CanDockMe(boat, who)
+  if(GetObjProperty(boat.hold,"owner") == who.serial)
+    return 1;
+  else
+    var packkey;
+    var lokid := GetObjProperty(boat.tillerman, "lockid");
+    foreach thing in EnumerateItemsInContainer(who.backpack)
+      if(GetObjProperty(thing, "lockid") == lokid)
+        packkey := 1;
+        break;
+      endif
+    endforeach
+    if(packkey == 1)
+      return 1;
+    else
+      return 0;
+    endif
+  endif
+endfunction
+
+/*NEW MAP COURSE FUNCTIONS*/
+//follows the current course
+function BoatFollowCourse(boat)
+	var startx, starty, destx, desty;
+	var course, nextwaypoint;
+	var newpoint, newfacing, prevfacing;
+	
+	course := GetObjProperty(boat.tillerman,"course");
+	nextwaypoint := GetObjProperty(boat.tillerman,"nextwaypoint");
+	startx := boat.x;
+	starty := boat.y;
+	prevfacing := boat.facing;
+	
+	if( (course==error) || (nextwaypoint==error))
+		return;
+	endif
+	
+	destx := course[nextwaypoint].x;
+	desty := course[nextwaypoint].y;
+	
+	newpoint := lineBresenham(startx,starty,destx,desty);
+	newfacing := GetNewFacing(startx,starty,newpoint[1],newpoint[2]);
+
+	if(newfacing == error) //reached waypoint/end
+		nextwaypoint := nextwaypoint + 1;
+		first_move_toward_waypoint := 1; //so we turn toward next waypoint (includes next course follow if we're done with this one)
+		if(nextwaypoint > course.size()) //done
+			state := STATE_DRIFTING;
+			PrintTextAbove(boat.tillerman,"Arr, we've reached our destination.");
+			return;
+		else
+			SetObjProperty(boat.tillerman,"nextwaypoint",nextwaypoint);
+		endif
+		
+	else
+
+		if(first_move_toward_waypoint == 1)
+			if( prevfacing != newfacing )
+				TurnBoat(boat,Cint(DetermineTurnCode(boat,newfacing)) );
+			endif
+			first_move_toward_waypoint := 0;
+		endif
+		MoveBoat(boat,newfacing);
+		
+		if((startx == boat.x) &&(starty == boat.y)) //we didn't move. must be blocked
+    		state := STATE_DRIFTING;
+    		PrintTextAbove(tillerman, "Aaargh!  We've stopped!");
+  		endif
+  	endif
+	
+endfunction
+
+//convert facing 0-7 to turn code 0-3
+function DetermineTurnCode( boat, desired )
+
+    var current := CInt(boat.facing / 2);
+    desired := CInt(desired / 2);
+
+	
+    if ( desired < current ) 
+    	desired := desired + 4; 
+    endif
+    return (desired - current);
+endfunction
+	
+//returns the direction (x1,y1) lies from (x0,y0) in the range 0-7.
+// returns error if the 2 points are equal.
+function GetNewFacing(x0,y0,x1,y1)
+	var dx, dy;
+	var facing;
+	dx := x1 - x0;
+	dy := y1 - y0;
+	
+	case(dx)
+		NEGONE: 
+			case(dy)
+				 NEGONE: facing := 7;
+				 ZERO: facing := 6;
+				 POSONE: facing := 5;
+				 default: facing := error;
+			endcase
+		 ZERO:
+		 	case(dy)
+		 		 NEGONE: facing := 0;
+		 		 ZERO: facing := error;
+		 		 POSONE: facing := 4;
+		 		 default: facing := error;
+		    endcase
+		 POSONE:
+		 	case(dy)
+		 		 NEGONE: facing := 1;
+		 		 ZERO: facing := 2;
+		 		 POSONE: facing := 3;
+		 		 default: facing := error;
+		 	endcase
+		 default: facing := error;
+	endcase
+	
+	return facing;
+endfunction
+
+//Bresenham's line drawing algorithm. determines a line between two waypoints.
+function lineBresenham(x0, y0, x1, y1)
+    var dy;
+    dy := y1 - y0;
+    var dx;
+    dx := x1 - x0;
+    var stepx, stepy;
+
+    if (dy < 0)
+      	dy := -dy;  
+       	stepy := -1;
+    else
+      	stepy := 1;
+    endif
+        
+    if (dx < 0) 
+       	dx := -dx;
+       	stepx := -1;
+    else 
+      	stepx := 1;
+    endif
+        
+    dy := 2*dy;   
+    dx := 2*dx;    
+
+    if (dx > dy)
+        var fraction;
+        fraction := 2*dy - dx;
+        while (x0 != x1)
+        	if (fraction >= 0)
+            	y0 := y0 + stepy;
+                fraction := fraction - dx;
+           	endif
+            x0 := x0 + stepx;
+            fraction := fraction + dy;
+            return {x0, y0};
+        endwhile
+    else
+        var fraction;
+        fraction := 2*dx - dy;
+        while (y0 != y1)
+            if (fraction >= 0)
+                x0 := x0 + stepx;
+                fraction := fraction - dy;
+            endif
+            y0 := y0 + stepy;
+            fraction := fraction + dx;
+            return {x0, y0};
+        endwhile
+    endif
+endfunction
+/*END NEW MAP COURSE FUNCTIONS*/

Added: trunk/096/pkg/multis/boat/itemdesc.cfg
===================================================================
--- trunk/096/pkg/multis/boat/itemdesc.cfg	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/boat/itemdesc.cfg	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,168 @@
+Item 0x6027
+{
+    Name                smallboatdeed
+    Desc                deed to a small boat
+    Graphic             0x14F2
+    Script              shipDeed
+    ShipObjType         smallboat
+    VendorSellsFor      12500
+    VendorBuysFor       12500
+	newbie              1
+}
+Item 0x6028
+{
+    Name                smalldragonboatdeed
+    Desc                deed to a small dragon boat
+    Graphic             0x14F2
+    Script              shipDeed
+    ShipObjType         smalldragonboat
+    VendorSellsFor      12500
+    VendorBuysFor       12500
+	newbie              1
+}
+
+
+Item 0x6029
+{
+    Name                mediumboatdeed
+    Desc                deed to a medium boat
+    Graphic             0x14F2
+    Script              shipDeed
+    ShipObjType         mediumboat
+    VendorSellsFor      14200
+    VendorBuysFor       14200
+	newbie              1
+}
+Item 0x602A
+{
+    Name                mediumdragonboatdeed
+    Desc                deed to a medium dragon boat
+    Graphic             0x14F2
+    Script              shipDeed
+    ShipObjType         mediumdragonboat
+    VendorSellsFor      14200
+    VendorBuysFor       14200
+	newbie              1
+}
+
+
+Item 0x602B
+{
+    Name                largeboatdeed
+    Desc                deed to a large boat
+    Graphic             0x14F2
+    Script              shipDeed
+    ShipObjType         largeboat
+    VendorSellsFor      15900
+    VendorBuysFor       15900
+	newbie              1
+}
+
+Item 0x602C
+{
+    Name                largedragonboatdeed
+	Desc                deed to a large dragon boat
+    Graphic             0x14F2
+    Script              shipDeed
+    ShipObjType         largedragonboat
+    VendorSellsFor      15900
+    VendorBuysFor       15900
+	newbie              1
+}
+
+Boat 0x6040
+{
+    Name                smallboat
+    Graphic             0x4000
+    MultiID             0x0000
+    OldObjtype          0x4000
+    OldObjtype          0x4001
+    OldObjtype          0x4002
+    OldObjtype          0x4003
+}
+
+Boat 0x6041
+{
+    Name                smalldragonboat
+    Graphic             0x4004
+    MultiID             0x0004
+    OldObjtype          0x4004
+    OldObjtype          0x4005
+    OldObjtype          0x4006
+    OldObjtype          0x4007
+}
+
+Boat 0x6042
+{
+    Name                mediumboat
+    Graphic             0x4008
+    MultiID             0x0008
+    OldObjtype          0x4008
+    OldObjtype          0x4009
+    OldObjtype          0x400A
+    OldObjtype          0x400B
+}
+
+Boat 0x6043
+{
+    Name                mediumdragonboat
+    Graphic             0x400C
+    MultiID             0x000C
+    OldObjtype          0x400C
+    OldObjtype          0x400D
+    OldObjtype          0x400E
+    OldObjtype          0x400F
+}
+
+Boat 0x6044
+{
+    Name                largeboat
+    Graphic             0x4010
+    MultiID             0x0010
+    OldObjtype          0x4010
+    OldObjtype          0x4011
+    OldObjtype          0x4012
+    OldObjtype          0x4013
+}
+
+Boat 0x6045
+{
+    Name                largedragonboat
+    Graphic             0x4014
+    MultiID             0x0014
+    OldObjtype          0x4014
+    OldObjtype          0x4015
+    OldObjtype          0x4016
+    OldObjtype          0x4017
+}
+
+Item 0xF010
+{
+    Name                Tillerman
+    graphic             1
+	script              tillerman
+}
+
+Item 0xF011
+{
+    Name                gangplank
+    Graphic             1
+    Lockable            1
+    RequiresAttention   0
+    DoubleclickRange    20
+    Script              plank
+    WalkOnScript        plankWalk
+    ControlScript       plankControl
+}
+
+Item 0xF012
+{
+    Name                gangplank2
+    Graphic             1
+    Lockable            1
+    RequiresAttention   0
+    DoubleclickRange    20
+    Script              plank
+    WalkOnScript        plankWalk
+    ControlScript       plankControl
+}

Added: trunk/096/pkg/multis/boat/pkg.cfg
===================================================================
--- trunk/096/pkg/multis/boat/pkg.cfg	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/boat/pkg.cfg	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,9 @@
+# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+Enabled		1
+Name		boat
+Maintainer	Distro Team
+Email		distro at polserver.com
+Version		1.0
+

Added: trunk/096/pkg/multis/boat/plank.src
===================================================================
--- trunk/096/pkg/multis/boat/plank.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/boat/plank.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,92 @@
+use os;
+use uo;
+
+include "util/key";
+include ":itemutils:objtype";
+include "plankUtil";
+
+program useplank(mob, plank)
+  set_critical(1);
+
+// Refresh the boat if he's the owner.
+var owner := GetObjProperty(plank, "owner");
+if (mob.serial == owner)
+  var tillermanid := GetObjProperty(plank, "tillermanid");
+  var tillerman := SystemFindObjectBySerial( tillermanid );
+  if (tillerman)
+    var decay := GetObjProperty(tillerman, "decay");
+    // Only give him the refresh message if the ship was less than 'in excellent shape'
+    // so he doesn't get the message every time he gets on and off the ship.
+    if ( (decay - ReadGameClock() ) < 860000 )
+          SendSysMessage(mob, "Your ship has been refreshed.");
+    endif
+    SetObjProperty( tillerman, 	  "decay",      (ReadGameClock()+ 864000));
+  endif
+endif
+  if(mob.multi.serial == plank.multi.serial)
+	TimedOpenClose(plank);
+  elseif((FK(mob, plank) == 1) ||(!plank.locked))
+	if(!IsExtended(plank))
+	  TimedOpenClose(plank);
+	else
+	  YankOntoBoat(mob,plank);
+	endif
+  else
+	PrintTextAbovePrivate(plank, "That is locked.", mob);
+  endif
+endprogram
+
+function TimedOpenClose(plank)
+  if(IsExtended(plank))
+    if(!IsPlankOccupied(plank))
+      Retract(plank);
+      EraseObjProperty(plank, "#WhenOpened");
+    endif
+  else
+    var whenopened := ReadGameClock();
+    SetObjProperty(plank, "#WhenOpened", whenopened);
+    Extend(plank);
+    repeat
+    sleep(6);
+    until(!(plank && IsPlankOccupied(plank)));
+    if(GetObjProperty(plank, "#WhenOpened") == whenopened)
+      Retract(plank);
+      EraseObjProperty(plank, "#WhenOpened");
+    endif
+  endif
+endfunction
+
+function YankOntoBoat(mob, plank)
+  var sh := GetStandingHeight(plank.x, plank.y, plank.z, plank.realm);
+  if(sh)
+    var nx :=(plank.x + plank.multi.x) / 2;
+    var ny :=(plank.y + plank.multi.y) / 2;
+    MoveCharacterToLocation(mob, nx, ny, plank.z);
+    return;
+  endif
+endfunction
+
+function CanWalkOntoPlank(plank)
+  var dx;
+  var dy;
+  case(plank.graphic)
+    GID_PLANK_EXTENDED_FACING_WEST:
+    GID_PLANK_RETRACTED_FACING_WEST:    dx := -1;
+                                        dy := 0;
+    GID_PLANK_EXTENDED_FACING_EAST:
+    GID_PLANK_RETRACTED_FACING_EAST:    dx := 1;
+                                        dy := 0;
+
+    GID_PLANK_EXTENDED_FACING_NORTH:
+    GID_PLANK_RETRACTED_FACING_NORTH:   dx := 0;
+                                        dy := -1;
+    GID_PLANK_EXTENDED_FACING_SOUTH:
+    GID_PLANK_RETRACTED_FACING_SOUTH:   dx := 0;
+                                        dy := 1;
+  endcase
+  if(GetStandingHeight(plank.x + dx, plank.y + dy, plank.z, plank.realm))
+    return 1;
+  else
+     return 0;
+  endif
+endfunction

Added: trunk/096/pkg/multis/boat/plankControl.src
===================================================================
--- trunk/096/pkg/multis/boat/plankControl.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/boat/plankControl.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,20 @@
+/*
+ * plankcontrol - plank control script
+ *
+ * sole job is to close an open locked plank on startup.
+ *
+ */
+
+use os;
+use uo;
+
+include ":itemutils:objtype";
+include "plankUtil";
+
+set_debug(1);
+
+program plankcontrol( plank )
+    if (plank.locked && IsExtended(plank))
+        Retract( plank );
+    endif
+endprogram

Added: trunk/096/pkg/multis/boat/plankUtil.inc
===================================================================
--- trunk/096/pkg/multis/boat/plankUtil.inc	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/boat/plankUtil.inc	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,89 @@
+include ":itemutils:objtype";
+
+const KEYSTART := 0x100e;
+const KEYEND := 0x1013;
+const KEYRING := 0x1011;
+
+function IsExtended( plank )
+  return plank.graphic in { GID_PLANK_EXTENDED_FACING_EAST, GID_PLANK_EXTENDED_FACING_WEST, GID_PLANK_EXTENDED_FACING_NORTH, GID_PLANK_EXTENDED_FACING_SOUTH };
+endfunction
+
+function IsPlankOccupied( plank )
+  return ListMobilesNearLocation( plank.x, plank.y, plank.z, 0, plank.realm ).size();
+endfunction
+
+function Extend( plank )
+  if (!IsExtended(plank))
+    TogglePlank(plank);
+  endif
+endfunction
+
+function Retract( plank )
+  if (IsExtended(plank))
+    TogglePlank(plank);
+  endif
+endfunction
+
+function TogglePlank( plank )
+  var partnertype := PlankPartner( plank.graphic );
+  if (partnertype)
+    plank.graphic := partnertype;
+  endif
+endfunction
+
+function PlankPartner( planktype )
+  case (planktype)
+    GID_PLANK_EXTENDED_FACING_EAST:  return GID_PLANK_RETRACTED_FACING_EAST;   // 0x3ed5: return 0x3eb1;
+    GID_PLANK_RETRACTED_FACING_EAST: return GID_PLANK_EXTENDED_FACING_EAST;    // 0x3eb1: return 0x3ed5;
+    GID_PLANK_EXTENDED_FACING_WEST:  return GID_PLANK_RETRACTED_FACING_WEST;   // 0x3ed4: return 0x3eb2;
+    GID_PLANK_RETRACTED_FACING_WEST: return GID_PLANK_EXTENDED_FACING_WEST;    // 0x3eb2: return 0x3ed4;
+    GID_PLANK_EXTENDED_FACING_NORTH:  return GID_PLANK_RETRACTED_FACING_NORTH; // 0x3e84: return 0x3e85;
+    GID_PLANK_RETRACTED_FACING_NORTH: return GID_PLANK_EXTENDED_FACING_NORTH;  // 0x3e85: return 0x3e84;
+    GID_PLANK_EXTENDED_FACING_SOUTH:  return GID_PLANK_RETRACTED_FACING_SOUTH; // 0x3e89: return 0x3e8a;
+    GID_PLANK_RETRACTED_FACING_SOUTH: return GID_PLANK_EXTENDED_FACING_SOUTH;  // 0x3e8a: return 0x3e89;
+    default: syslog( "Unknown plank type 0x" + Hex( planktype ) );
+             return error;
+  endcase
+endfunction
+
+function fk(me, plank)
+  var doorlockid := GetObjProperty( plank, "lockid" );
+  var keylockid;
+  var insidering;
+  var mykeys := EnumerateItemsInContainer(me.backpack);
+  foreach key in mykeys
+	if ( (key.objtype >= KEYSTART ) && (key.objtype <= KEYEND) && (key.objtype != KEYRING ) )
+	  keylockid := GetObjProperty( key, "lockid" );
+	  if ( (keylockid) && (keylockid == doorlockid) )
+		return 1;
+	  endif
+	elseif (key.objtype == KEYRING)
+	  insidering := FindMyPack(key.serial);
+	  foreach otherkey in EnumerateItemsInContainer(insidering)
+		keylockid := GetObjProperty( otherkey, "lockid" );
+		if (keylockid == doorlockid)
+		  return 1;
+		endif
+	  endforeach
+	endif
+  endforeach
+  return 0;
+endfunction
+
+function OpenTamedStorageAreas()
+  var bank := FindStorageArea( "Tamed Storage" );
+  if (!bank)
+    bank := CreateStorageArea( "Tamed Storage" );
+  endif
+  return bank;
+endfunction
+
+function FindMyPack(myserial)
+  var mybank := OpenTamedStorageAreas();
+  var bank_obj_name := "Bankbox  " + Hex(myserial);
+  var bankbox := FindRootItemInStorageArea( mybank, bank_obj_name );
+  if (!bankbox)
+    bankbox := CreateRootItemInStorageArea(mybank, bank_obj_name, UOBJ_BANKBOX  );
+  endif
+  return bankbox;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/multis/boat/plankWalk.src
===================================================================
--- trunk/096/pkg/multis/boat/plankWalk.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/boat/plankWalk.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,158 @@
+use os;
+use uo;
+
+include "include/client";
+include ":itemutils:objtype";
+include "util/key";
+include "plankUtil";
+
+/*
+ * the searchoffset matrix is for an east-facing plank.
+ * these will have to be rotated for the other positions
+ *   P is the plank, N is where you can't step (otherwise
+ *    this teleportation stuff wouldn't be necessary)
+ *
+ *        13 12 11
+ *        14  5  4
+ *        15  6  2
+ *        16  7  1 N P
+ *        17  8  3
+ *        18  9 10
+ *        19 20 21
+ *
+ */
+
+var searchoffset := {
+   { -2,  0 },          //  1
+   { -2, -1 },
+   { -2, +1 },
+   { -2, -2 },
+   { -3, -2 },          //  5
+   { -3, -1 },
+   { -3,  0 },
+   { -3, +1 },
+   { -3, +2 },
+   { -2, +2 },          // 10
+   { -2, -3 },
+   { -3, -3 },
+   { -4, -3 },
+   { -4, -2 },
+   { -4, -1 },          // 15
+   { -4,  0 },
+   { -4, +1 },
+   { -4, +2 },
+   { -4, +3 },
+   { -3, +3 },          // 20
+   { -2, +3 },
+   { -5,  0 },
+   { -5, +2 },
+   { -5, +3 },
+   { -5, +4 },
+   { -4, +4 },          // 20
+   { -3, +4 },
+   { -6,  0 },
+   { -6, +3 },
+   { -6, +4 },
+   { -6, +5 },
+   { -5, +5 },          // 20
+   { -4, +5 }
+};
+
+program plankwalk( who, plank, lastx, lasty, lastz )
+    if (!FindKey( who, plank ))
+        if (plank.locked)
+            var sh := GetStandingHeight( lastx, lasty, lastz, who.realm );
+            if (!sh || !sh.multi || sh.multi.serial != plank.multi.serial)
+                MoveCharacterToLocation( who, lastx, lasty, lastz, MOVECHAR_FORCELOCATION );
+                return;
+            endif
+        endif
+    endif
+
+    if (ListMobilesNearLocation( plank.x, plank.y, plank.z, 0, plank.realm ).size() > 1)
+        MoveCharacterToLocation( who, lastx, lasty, lastz, MOVECHAR_FORCELOCATION );
+        return;
+    endif
+
+    var xidx, yidx, xmul, ymul;
+
+    case (plank.graphic)
+        GID_PLANK_EXTENDED_FACING_WEST:
+            if (! (who.facing in { DIR_W, DIR_NW, DIR_SW }))
+                return;
+            endif
+            xidx := 1;
+            yidx := 2;
+            xmul := 1;
+            ymul := 1;
+
+        GID_PLANK_EXTENDED_FACING_EAST:
+            if (! (who.facing in { DIR_E, DIR_NE, DIR_SE }))
+                return;
+            endif
+            xidx := 1;
+            yidx := 2;
+            xmul := -1; // flip across x-axis
+            ymul := 1;
+
+        GID_PLANK_EXTENDED_FACING_NORTH:
+            if (! (who.facing in { DIR_N, DIR_NE, DIR_NW }))
+                return;
+            endif
+            xidx := 2;
+            yidx := 1;
+            xmul := 1;
+            ymul := +1;
+
+        GID_PLANK_EXTENDED_FACING_SOUTH:
+            if (! (who.facing in { DIR_S, DIR_SE, DIR_SW }))
+                return;
+            endif
+            xidx := 2;
+            yidx := 1;
+            xmul := 1;
+            ymul := -1; // flip across y-axis
+
+        default:
+            return;
+    endcase
+    if (CanMove( who,
+                 searchoffset[1][xidx] * xmul / 2,
+                 searchoffset[1][yidx] * ymul / 2 ))
+        return;                     // doesn't need our help!
+    endif
+
+
+    foreach offset in searchoffset
+        if (TryMove( who, offset[xidx] * xmul, offset[yidx] * ymul ))
+            return;
+        endif
+    endforeach
+endprogram
+
+function TryMove( who, dx, dy )
+    var res := 0;
+    set_critical( 1 );
+
+    var tryx := who.x + dx;
+    var tryy := who.y + dy;
+    var h := GetStandingHeight( tryx, tryy, who.z, who.realm );
+    if (h && (not h.multi)) // CHECKME should check line of sight?
+        MoveCharacterToLocation( who, tryx, tryy, h.z );
+        res := 1;
+    endif
+
+    set_critical(0);
+    return res;
+endfunction
+
+function CanMove( who, dx, dy )
+    var tryx := who.x + dx;
+    var tryy := who.y + dy;
+    var h := GetStandingHeight( tryx, tryy, who.z, who.realm );
+    if (h)
+        return 1;
+    else
+        return 0;
+    endif
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/multis/boat/shipDeed.src
===================================================================
--- trunk/096/pkg/multis/boat/shipDeed.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/boat/shipDeed.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,128 @@
+// $Id: shipDeed.src 905 2005-11-05 08:20:50Z muaddiblsd $
+
+use cfgfile;
+use uo;
+use os;
+
+include "util/key";
+include ":itemutils:objtype";
+include ":itemutils:canAccess";
+
+program useshipdeed(who, deed)
+  if(DeedAlreadyBuiltFrom(deed))
+    PrintTextAbovePrivate(deed, "That ship has already been built.", who);
+  elseif(can_access(who, deed))
+    BuildShip(who, deed);
+  endif
+endprogram
+
+function BuildShip(who, deed)
+  var shiptype := GetShipObjtype(deed.objtype);
+  if(!shiptype)
+    PrintTextAbovePrivate(deed, "That ship deed appears to be broken.", who);
+    return;
+  endif
+  var flags := ShipFacingFlags(who.facing);
+  var where := TargetMultiPlacement(who, shiptype, flags);
+  if(!where)
+    if(deed.graphic == 5363)
+      deed.graphic := 5364;
+    elseif(deed.graphic == 5364)
+      deed.graphic := 5363;
+    endif
+    return;
+  elseif((where.x == deed.x) && (where.y == deed.y))
+    if(deed.graphic == 5363)
+      deed.graphic := 5364;
+    elseif(deed.graphic == 5364)
+      deed.graphic := 5363;
+    endif
+    return;
+  endif
+  set_critical(1);
+  if((where.x < who.x - 10) || (where.y < who.y - 10) || (where.x > who.x + 10) || (where.y > who.y + 10))
+    SendSysMessage(who, "You cannot place a boat that far away.");
+    return;
+  endif
+  var created := CreateShipKeysAndBuiltDeed(who, shiptype, where.x, where.y, where.z, flags);
+  if(created)
+    var ship := created.ship;
+    var deedtype := deed.objtype;
+    if((deed.name != "a toy boat") && (!deed.name["deed"]))
+      ship.tillerman.name := deed.name;
+    endif
+    if(DestroyItem(deed))
+      ship.starboardplank.locked    := 1;
+      ship.portplank.locked         := 1;
+      ship.hold.locked              := 1;
+      var lockid := AllocLockId();
+      SetObjProperty(ship.starboardplank, "lockid",      lockid);
+      SetObjProperty(ship.starboardplank, "owner",       who.serial);
+      SetObjProperty(ship.starboardplank, "tillermanid", ship.tillerman.serial);
+      SetObjProperty(ship.portplank,      "lockid",      lockid);
+      SetObjProperty(ship.portplank,      "owner",       who.serial);
+      SetObjProperty(ship.portplank,      "tillermanid", ship.tillerman.serial);
+      SetObjProperty(ship.hold,           "lockid",      lockid);
+      SetObjProperty(ship.tillerman,      "owner",       who.serial);
+      SetObjProperty(ship.tillerman,      "shipserial",  ship.serial);
+      SetObjProperty(ship.tillerman,      "lockid",      lockid);
+      SetObjProperty(ship.tillerman,      "shiptype",    deedtype);
+      SetObjProperty(created.packkey,     "lockid",      lockid);
+      SetObjProperty(created.packkey,     "shipserial",  ship.serial);
+      SetObjProperty(ship.tillerman,      "decay",       (ReadGameClock()+ 864000));
+      ship.tillerman.usescript := ":boat:tillerman";
+    else
+      DestroyItem(created.packkey);
+      DestroyMulti(ship);
+      SendSysMessage(who, "There was an error creating the boat.");
+    endif
+  endif
+endfunction
+
+function ShipFacingFlags(facing)
+  var flags := 0;
+  case (facing)
+    DIR_N:  flags := CRMULTI_FACING_NORTH;
+    DIR_NE: flags := CRMULTI_FACING_NORTH;
+    DIR_E:  flags := CRMULTI_FACING_EAST;
+    DIR_SE: flags := CRMULTI_FACING_SOUTH;
+    DIR_S:  flags := CRMULTI_FACING_SOUTH;
+    DIR_SW: flags := CRMULTI_FACING_SOUTH;
+    DIR_W:  flags := CRMULTI_FACING_WEST;
+    DIR_NW: flags := CRMULTI_FACING_NORTH;
+  endcase
+  return flags;
+endfunction
+
+function CreateShipKeysAndBuiltDeed(who, shiptype, x, y, z, flags)
+  var packkey := CreateItemInBackpack(who, UOBJ_COPPER_KEY);
+  if(!packkey)
+    PrintTextAbovePrivate(who, "My backpack is too full!", who);
+    return 0;
+  endif
+  var ship := CreateMultiAtLocation(x, y, z, shiptype, flags, who.realm);
+  if(!ship)
+    PrintTextAbovePrivate(who, "I can't place the ship there.", who);
+    DestroyItem(packkey);
+    return 0;
+  else
+    var result := struct;
+    result.+packkey := packkey;
+    result.+ship    := ship;
+    return result;
+  endif
+endfunction
+
+function DeedAlreadyBuiltFrom(deed)
+  if(GetObjProperty(deed, "builtserial"))
+    return 1;
+  else
+    return 0;
+  endif
+endfunction
+
+function GetShipObjtype(objtype)
+    var cfg := ReadConfigFile(":boat:itemdesc");
+    var ot := GetObjtypeByName(cfg[objtype].ShipObjType);
+    return Cint(ot);
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/multis/boat/tillerman.src
===================================================================
--- trunk/096/pkg/multis/boat/tillerman.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/boat/tillerman.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,22 @@
+use os;
+use uo;
+
+include "util/key";
+include ":itemutils:objtype";
+include "plankUtil";
+
+program renameboat(you, tillerman)
+  if((GetObjProperty(tillerman,"owner") != you.serial) &&(you.cmdlevel < 2))
+	PrintTextAbove(tillerman,"Stop that, or I'll throw ye overboard!");
+	return;
+  endif
+    var boatname := RequestInput(you, tillerman, "Enter a new name for this boat.(max 40 characters)");
+  if(boatname)
+	if(len(boatname) <= 40)
+	  tillerman.name := boatname;
+	  SendSysMessage(you, "Boat is renamed.");
+	else
+	  SendSysMessage(you, "Too many characters in name.");
+	endif
+  endif
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/multis/housing/changeOwner.src
===================================================================
--- trunk/096/pkg/multis/housing/changeOwner.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/housing/changeOwner.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,371 @@
+// $Id: changeOwner.src 905 2005-11-05 08:20:50Z muaddiblsd $
+
+use uo;
+use os;
+use cfgfile;
+
+include ":containers:storageAreas";
+include "util/key";
+include ":itemutils:canAccess";
+
+const UOBJECT_DOORS_START := 0x0675;
+const UOBJECT_DOORS_END   := 0x06f4;
+const UOBJECT_BRASS_SIGN := 0x0bd2;
+const UOBJECT_WOOD_SIGN := 0x0bd0;
+
+program ChangeHouseOwner(who, title)
+  if(!ReserveItem(title))
+    return;
+  endif
+  if(!can_access(who, title))
+    return;
+  endif
+  var houseserial := GetObjProperty(title, "builtserial");
+  if(houseserial == error)
+    SendSysMessage(who, "That deed is invalid.");
+    return;
+  endif
+  var house :=  SystemFindObjectBySerial(houseserial);
+  if(house == error)
+    SendSysMessage(who, "Error finding the built house!");
+    syslog(house.errortext);
+    return;
+  endif
+  var oldownerserial := GetObjProperty(house, "ownerserial");
+  if((oldownerserial == who.serial) && (GetObjProperty(house, "footage")))
+    SendSysMessage(who, "You are already the owner of that house.");
+    return;
+  else
+    SetObjProperty(house, "ownerserial", who.serial);
+    SetObjProperty(house, "owneracct",   who.acctname);
+    if((oldownerserial != who.serial))
+      EraseObjProperty(house, "friendlist");
+      EraseObjProperty(house, "coownlist");
+      EraseObjProperty(house, "banlist");
+    endif
+    var bankbox := CP_GetStorageContainerForMobile(who, CP_DEFAULT_AREA, 1);
+    var packkey := CreateItemInBackpack( who, UOBJ_GOLD_KEY );
+    if(!packkey)
+      SendSysMessage( who, "My backpack is too full!");
+      return;
+    endif
+    var bankkey := CreateItemInContainer( bankbox, UOBJ_GOLD_KEY );
+    if(!bankkey)
+      SendSysMessage( who, "My bankbox is too full!");
+      DestroyItem( packkey );
+      return;
+    endif
+    var housetype := house.objtype;
+    var footage := FindBoxArray(housetype, house);
+    SetObjProperty(house, "footage", footage);
+    var lockid := AllocLockId();
+    SetObjProperty( packkey, "lockid", lockid );
+    SetObjProperty( bankkey, "lockid", lockid );
+    var lists := GetObjProperty(house, "footage");
+    var itemlist := {};
+    var holder;
+    foreach thing in lists
+      holder := ListObjectsInBox(thing[1], thing[2], thing[3], thing[4], thing[5],thing[6],who.realm);
+      foreach thing in holder
+        itemlist.append(thing);
+      endforeach
+    endforeach
+    foreach itemt in itemlist
+      if((itemt.objtype == UOBJECT_BRASS_SIGN) || (itemt.objtype == UOBJECT_WOOD_SIGN))
+        SetObjProperty(itemt, "lockid",       lockid);
+        SetObjProperty(itemt, "ownerserial",  who.serial);
+        SetObjProperty(itemt, "owneracct",    who.acctname);
+      elseif(((itemt.objtype >= UOBJECT_DOORS_START) && (itemt.objtype <= UOBJECT_DOORS_END)))
+        itemt.locked := 1;
+        SetObjProperty(itemt, "lockid", lockid);
+      else
+        EraseObjProperty(itemt, "houseserial");
+        if((GetObjProperty(itemt, "secure") == 1) && (itemt.movable == 0))
+          EraseObjProperty(itemt, "secure");
+          EraseObjProperty(itemt, "houseserial");
+          var oldscript := GetObjProperty(itemt, "oldscript");
+          if (oldscript == error)
+            oldscript := "";
+          endif
+          itemt.usescript := oldscript;
+          itemt.movable := 1;
+          EraseObjProperty(itemt, "houseserial" );
+          EraseObjProperty(itemt, "oldscript" );
+        elseif((GetObjProperty(itemt, "lockeddown" ) == 1) && (itemt.movable == 0))
+          itemt.movable := 1;
+          EraseObjProperty(itemt, "lockeddown");
+        endif
+      endif
+    endforeach
+    SetObjProperty(house, "numlockdowns", GetObjProperty(title, "numlockdowns"));
+    SetObjProperty(house, "numsecure",    GetObjProperty(title, "numsecure"));
+    MoveItemToContainer(title, bankbox, x := -1, y := -1 );
+    SendSysMessage(who, "You have taken ownership of the house." );
+  endif
+endprogram
+
+function FindBoxArray(housetype, house)
+  var footage;
+  case(housetype)
+    0x6060: footage := smallhousearray(house, house.x, house.y, house.z); //smallstoneandplasterhouse
+    0x6061: footage := smallhousearray(house, house.x, house.y, house.z); //smallstonehouse
+    0x6062: footage := smallhousearray(house, house.x, house.y, house.z); //smallstonehousetwo
+    0x6063: footage := smallhousearray(house, house.x, house.y, house.z); //smallwoodenhouse
+    0x6064: footage := smallhousearray(house, house.x, house.y, house.z); //smallplasterhouse
+    0x6073: footage := smallhousearray(house, house.x, house.y, house.z); //smallwoodandstrawhouse
+    0x6065: footage := largehousearray(house, house.x, house.y, house.z); //largebrickhouse
+    0x6072: footage := largehousearray(house, house.x, house.y, house.z); //largepatiohouse
+    0x6066: footage := twostoryarray(house, house.x, house.y, house.z); //twostorywoodandplasterhouse
+    0x6068: footage := twostoryarray(house, house.x, house.y, house.z); //twostorystoneandplasterhouse
+    0x6069: footage := bigtowerarray(house, house.x, house.y, house.z); //tower
+    0x6070: footage := keeparray(house, house.x, house.y, house.z); //keep
+    0x6071: footage := castlearray(house, house.x, house.y, house.z); //castle
+  endcase
+  return footage;
+endfunction
+
+function smallhousearray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 2);
+  box1.append(y - 2);
+  box1.append(z + 7);
+  box1.append(x + 2);
+  box1.append(y + 2);
+  box1.append(z + 27);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-1, y+4, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-0, y+4, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+4, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function largehousearray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 6);
+  box1.append(y - 6);
+  box1.append(z + 7);
+  box1.append(x + 6);
+  box1.append(y + 5);
+  box1.append(z + 27);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  if(house.objtype == 0x608c)
+    bantile := CreateItemAtLocation(x-5, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+    bantile := CreateItemAtLocation(x-4, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+    bantile := CreateItemAtLocation(x-3, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+    bantile := CreateItemAtLocation(x-2, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+  else
+    bantile := CreateItemAtLocation(x-2, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+    bantile := CreateItemAtLocation(x-1, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+    bantile := CreateItemAtLocation(x, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+    bantile := CreateItemAtLocation(x+1, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+  endif
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function twostoryarray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 6);
+  box1.append(y - 6);
+  box1.append(z + 7);
+  box1.append(x    );
+  box1.append(y + 5);
+  box1.append(z + 47);
+  boxarray[1] := box1;
+  box1 := {};
+  box1.append(x    );
+  box1.append(y    );
+  box1.append(z + 7);
+  box1.append(x + 5);
+  box1.append(y + 5);
+  box1.append(z + 47);
+  boxarray[2] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-4, y+7, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-3, y+7, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-2, y+7, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1, y+7, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function bigtowerarray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 6);
+  box1.append(y - 6);
+  box1.append(z + 6);
+  box1.append(x + 7);
+  box1.append(y + 5);
+  box1.append(z + 65);
+  boxarray[1] := box1;
+  box1 := {};
+  box1.append(x - 10);
+  box1.append(y - 6);
+  box1.append(z + 66);
+  box1.append(x + 11);
+  box1.append(y + 5);
+  box1.append(z + 86);
+  boxarray[2] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-1, y+8, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y+8, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+8, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2, y+8, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1, y+7, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y+7, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+7, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2, y+7, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function castlearray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 14);
+  box1.append(y - 14);
+  box1.append(z     );
+  box1.append(x + 14);
+  box1.append(y + 14);
+  box1.append(z + 47);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-1, y+16, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y+16, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+16, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2, y+16, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1, y+10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y+10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2, y+10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1,  y+6, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x,  y+6, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1,  y+6, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2,  y+6, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-2, y-10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1, y-10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y-10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y-10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function keeparray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 10);
+  box1.append(y - 10);
+  box1.append(z     );
+  box1.append(x + 11);
+  box1.append(y + 11);
+  box1.append(z + 47);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-1, y+11, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y+11, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+11, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2, y+11, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+

Added: trunk/096/pkg/multis/housing/commands/gm/destroyMulti.src
===================================================================
--- trunk/096/pkg/multis/housing/commands/gm/destroyMulti.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/housing/commands/gm/destroyMulti.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,34 @@
+/*
+ * $Id: destroyMulti.src 664 2005-10-27 03:36:13Z muaddiblsd $
+ *
+ */
+
+use uo;
+
+
+program textcmd_DestroyMulti(who, serial)
+	serial := CInt(serial);
+	var multi;
+	
+	if ( !serial )
+		SendSysMessage(who, "Target an item in the multi.");
+		var targ := target(who);
+	
+		if ( targ.multi )
+			multi := targ.multi;
+		else
+			PrintTextAbovePrivate(targ, "I dont have a multi property.", who);
+			return 0;
+		endif
+	else
+		multi := SystemFindObjectBySerial(serial);
+	endif
+	
+	var destroyed := DestroyMulti(multi);
+	
+	if ( destroyed.errortext )
+		SendSysMessage(who, "Error: "+destroyed.errortext);
+	endif
+	
+	return destroyed;
+endprogram

Added: trunk/096/pkg/multis/housing/commands/gm/makeMulti.src
===================================================================
--- trunk/096/pkg/multis/housing/commands/gm/makeMulti.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/housing/commands/gm/makeMulti.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,27 @@
+/*
+ * $Id: makeMulti.src 664 2005-10-27 03:36:13Z muaddiblsd $
+ *
+ */
+
+use uo;
+
+
+program textcmd_MakeMulti(who, text)
+	if ( !CInt(text) )
+		text := GetObjTypeByName(text);
+	endif
+	
+	var targ := TargetMultiPlacement(who, text);
+	
+	if ( targ == error )
+		SendSysMessage(who, "["+text+"] ->"+targ.errortext);
+		return 0;
+	endif
+	
+	var multi := CreateMultiAtLocation(targ.x, targ.y, targ.z, text, CRMULTI_IGNORE_ALL, who.realm);
+	if ( multi.errortext )
+		SendSysMessage(who, "Error:"+multi.errortext);
+	endif
+	
+	return multi;
+endprogram

Added: trunk/096/pkg/multis/housing/houseBanning.src
===================================================================
--- trunk/096/pkg/multis/housing/houseBanning.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/housing/houseBanning.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,26 @@
+use os;
+use uo;
+
+program walk_on_moongate(who, tile)
+  var hserial := GetObjProperty(tile, "house_serial");
+  var house := SystemFindObjectBySerial( CInt(hserial) );
+  var sign := SystemFindObjectBySerial(GetObjProperty(house,"signserial"));
+  if(!sign)
+    var signarray := {0x0bd1, 0x0bd2, 0x0bcf, 0x0bd0};
+    foreach thing in (house.components)
+      if(thing.objtype in signarray)
+        sign := thing;
+        SetObjProperty(house, "signserial", sign.serial);
+        break;
+      endif
+    endforeach
+  endif
+  var banlist := GetObjProperty(house, "banlist");
+  if(!banlist)
+    return;
+  endif
+  if(who.serial in banlist)
+    MoveCharacterToLocation( who, sign.x, sign.y, sign.z, MOVECHAR_FORCELOCATION );
+    SendSysMessage(who, "You are banned from that house and cannot enter it!");
+  endif
+endprogram

Added: trunk/096/pkg/multis/housing/houseDeed.src
===================================================================
--- trunk/096/pkg/multis/housing/houseDeed.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/housing/houseDeed.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,724 @@
+use cfgfile;
+use uo;
+use os;
+
+include "util/key";
+include ":containers:storageAreas";
+include ":itemutils:objtype";
+include ":coords:findCity";
+include ":itemutils:canAccess";
+include ":coords:isValidLoc";
+
+const UOBJECT_DOORS_START:=0x675;
+const UOBJECT_DOORS_END:=0x6f4;
+const UOBJECT_BRASS_SIGN:=0xbd2;
+const UOBJECT_WOOD_SIGN:=0xbd0;
+const UOBJECT_WOOD_SIGNTWO:=0xbd1;
+const UOBJECT_TENT_CHEST:=0xe43;
+
+program usehousedeed(character, deed)
+  if(!ReserveItem(deed))
+    return;
+  endif
+  if(!can_access(character, deed))
+    return;
+  endif
+  EraseObjProperty(character, "IsMeditating");
+  if(deed.movable == 0)
+    SendSysMessage(character, "You cannot use that.");
+    return;
+  endif
+  if(DeedAlreadyBuiltFrom(deed))
+    PrintTextAbovePrivate(deed, "That house has already been built.", character);
+    DestroyItem(deed);
+  else
+    Buildhouse(character, deed);
+  endif
+endprogram
+
+function Buildhouse(character, deed)
+  if(!IsInContainer(character.backpack, deed))
+    SendSysMessage(character, "The deed has to be in your backpack.");
+    return;
+  endif
+  if(!ReserveItem(deed))
+    return;
+  endif
+  var housetype := GetHouseObjtype(deed);
+  if(housetype == error)
+    PrintTextAbovePrivate(deed, "That house deed appears to be broken.", character);
+    syslog("Deed " + deed.serial + " had no housetype property!");
+    return;
+  endif
+  var where := TargetMultiPlacement(character, housetype);
+  if(!where)
+    return;
+  endif
+  if((FindCity(character) != "no city") || (FindCity(where) != "no city"))
+    PrintTextAbovePrivate(deed, "You can't build in cities.", character);
+    return;
+  endif
+  if (Distance(character,where) > 50)
+    PrintTextAbovePrivate(deed, "You are too far from where you are trying to build.", character);
+    return;
+  endif
+  if(!isValidLoc(where.x, where.y) && (character.cmdlevel < 2))
+    PrintTextAbovePrivate(deed, "You may not build in Green Acres.", character);
+    return;
+  endif
+  set_critical(1);
+  var created:=CreatehouseKeysAndBuiltDeed(character, housetype, where, deed);
+  if(!created)
+    return;
+  endif
+  var lock := GetObjProperty(deed, "numlockdowns");
+  var sec  := GetObjProperty(deed, "numsecure");
+  if(DestroyItem(deed))
+    var lockid := AllocLockId();
+    SetObjProperty(created.builtdeed, "builtserial",  created.house.serial);
+    SetObjProperty(created.builtdeed, "new",          1);
+    SetObjProperty(created.builtdeed, "numlockdowns", lock);
+    SetObjProperty(created.builtdeed, "numsecure",    sec);
+    SetObjProperty(created.packkey,   "lockid",       lockid);
+    SetObjProperty(created.bankkey,   "lockid",       lockid);
+    SetObjProperty(created.house,     "numlockdowns", lock);
+    SetObjProperty(created.house,     "numsecure",    sec);
+    SetObjProperty(created.house,     "footage",      created.footage);
+    foreach item in (created.house.components)
+      if(((item.objtype >= UOBJECT_DOORS_START) &&(item.objtype <= UOBJECT_DOORS_END)) || item.objtype == UOBJECT_TENT_CHEST || item.objtype == 0x6ad)
+        item.locked := 1;
+        SetObjProperty(item, "lockid", lockid);
+        SetObjProperty(item, "houseserial", created.house.serial);
+      elseif((item.objtype == UOBJECT_BRASS_SIGN) || (item.objtype == UOBJECT_WOOD_SIGN) || (item.objtype == UOBJECT_WOOD_SIGNTWO))
+        SetObjProperty(item,"lockid",lockid);
+        SetObjProperty(item, "house_serial", created.house.serial);
+        SetObjProperty(created.house, "signserial", item.serial);
+      endif
+    endforeach
+  else
+    DestroyItem(created.builtdeed);
+    DestroyItem(created.packkey);
+    DestroyItem(created.bankkey);
+    foreach item in (created.house.components)
+      DestroyItem(item);
+    endforeach
+    DestroyMulti(created.house);
+  endif
+endfunction
+
+function CreatehouseKeysAndBuiltDeed(character, housetype, where, deed)
+  var bankbox := CP_GetStorageContainerForMobile(character, CP_DEFAULT_AREA, 1);
+  var x := where.x, y := where.y, z := where.z;
+  var packkey := CreateItemInBackpack(character, UOBJ_GOLD_KEY);
+  if(!packkey)
+    PrintTextAbovePrivate(character, "My backpack is too full!", character);
+    return 0;
+  endif
+  var bankkey := CreateItemInContainer(bankbox, UOBJ_GOLD_KEY);
+  if(!bankkey)
+    PrintTextAbovePrivate(character, "My bankbox is too full!", character);
+    DestroyItem(packkey);
+    return 0;
+  endif
+  var builtdeed := CreateItemInContainer(bankbox, 0x14ef);
+
+
+  SetName(builtdeed, deed.desc + " at " + x + ", " + y + ", " + z + "(built)");
+  if(!builtdeed)
+    PrintTextAbovePrivate(character, "My bankbox is too full!", character);
+    DestroyItem(packkey);
+    DestroyItem(bankkey);
+    return 0;
+  endif
+  var house := CreateMultiAtLocation(x, y, z, housetype, 0, character.realm);
+    if(!house)
+    PrintTextAbovePrivate(character, "I can't place the house there.", character);
+    print(house.errortext);
+    DestroyItem(packkey);
+    DestroyItem(bankkey);
+    DestroyItem(builtdeed);
+    return;
+  endif
+
+  var footage := FindBoxArray(housetype, house);
+
+  var test := CStr(footage);
+  SendSysMessage(character, test);
+
+  SetObjProperty(house,"numlockdowns",GetObjProperty(deed,"numlockdowns"));
+  SetObjProperty(house,"numsecure",GetObjProperty(deed,"numsecure"));
+  SetObjProperty(house,"ownerserial",character.serial);
+  SetObjProperty(house,"owneracct",character.acctname);
+  SetObjProperty(house,"builtdeed",builtdeed.serial);
+  SetObjProperty(house,"decay", (ReadGameClock()+ 2592000));
+  if(housetype==0x6bb8 || housetype==0x6070 || housetype==0x6072)
+  house.movable:=0;
+  house.visible:=1;
+  endif
+
+
+
+  var result := struct;
+  result.+packkey := packkey;
+  result.+bankkey := bankkey;
+  result.+builtdeed := builtdeed;
+  result.+house := house;
+  result.+footage := footage;
+  return result;
+endfunction
+
+function DeedAlreadyBuiltFrom(deed)
+  if(GetObjProperty(deed, "builtserial"))
+    return 1;
+  else
+    return 0;
+  endif
+endfunction
+
+function GetHouseObjtype(deed)
+  var id := ReadConfigFile("itemdesc");
+  var elem := id[ deed.objtype ];
+  var ot := GetObjtypeByName(elem.HouseObjType);
+  return ot;
+endfunction
+
+function IsInContainer(container, item)
+  foreach thing in EnumerateItemsInContainer(container)
+    if(thing.serial == item.serial)
+      return 1;
+    endif
+  endforeach
+  return 0;
+endfunction
+
+function FindBoxArray(housetype, house)
+  var footage;
+  case(housetype)
+    0x6060: footage := smallhousearray(house, house.x, house.y, house.z); //smallstoneandplasterhouse
+    0x6061: footage := smallhousearray(house, house.x, house.y, house.z); //smallstonehouse
+    0x6062: footage := smallhousearray(house, house.x, house.y, house.z); //smallstonehousetwo
+    0x6063: footage := smallhousearray(house, house.x, house.y, house.z); //smallwoodenhouse
+    0x6064: footage := smallhousearray(house, house.x, house.y, house.z); //smallplasterhouse
+    0x6073: footage := smallhousearray(house, house.x, house.y, house.z); //smallwoodandstrawhouse
+    0x6065: footage := largehousearray(house, house.x, house.y, house.z); //largebrickhouse
+    0x6072: footage := largehousearray(house, house.x, house.y, house.z); //largepatiohouse
+    0x6066: footage := twostoryarray(house, house.x, house.y, house.z); //twostorywoodandplasterhouse
+    0x6068: footage := twostoryarray(house, house.x, house.y, house.z); //twostorystoneandplasterhouse
+    0x6069: footage := bigtowerarray(house, house.x, house.y, house.z); //tower
+    0x6070: footage := keeparray(house, house.x, house.y, house.z); //keep
+    0x6071: footage := castlearray(house, house.x, house.y, house.z); //castle
+    0x6074: footage := smalltowerarray(house, house.x, house.y, house.z); //smalltower
+    0x6075: footage := smallmarbleshoparray(house, house.x, house.y, house.z); //smallmarbleshop
+    0x6076: footage := smallstoneshoparray(house, house.x, house.y, house.z); //smallstoneshop
+    0x6077: footage := largemarblehousearray(house, house.x, house.y, house.z); //largemarblehouse
+    0x6078: footage := logcabinarray(house, house.x, house.y, house.z); //logcabin
+    0x6079: footage := sandstonepatiohousearray(house, house.x, house.y, house.z); //sandstonepatiohouse
+    0x607A: footage := twostoryvillaarray(house, house.x, house.y, house.z); //twostoryvilla
+  endcase
+  return footage;
+endfunction
+
+// Added rope ladders to fix an issue with core and ladder climbing on multi's.
+// Also done was adjustment to house floor for items that for some reason end
+// up below the actual z of the floor (up to -3 z from floor)
+function logcabinarray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 2);
+  box1.append(y - 5);
+  box1.append(z + 5);
+  box1.append(x + 3);
+  box1.append(y + 5);
+  box1.append(z + 65);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x+1, y+5, Z+5, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+6, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  // Added for Rope Ladders
+  bantile := CreateItemAtLocation(x+3, y-4, Z+7, 0x8A5, 1, house.realm);
+  bantile.movable := 0;
+  bantile.invisible := 1;
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+3, y-5, Z+11, 0x8A5, 1, house.realm);
+  bantile.movable := 0;
+  bantile.invisible := 1;
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+// Ladders added here for same reason. Z Adjusted for box also on here, and
+// on all remaining houses.
+function sandstonepatiohousearray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 4);
+  box1.append(y - 3);
+  box1.append(z + 0);
+  box1.append(x + 5);
+  box1.append(y + 2);
+  box1.append(z + 46);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x, y+4, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1, y+4, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-2, y+4, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  // Ladders
+  bantile := CreateItemAtLocation(x-4, y-2, Z+7, 0x8a3, 1, house.realm);
+  bantile.movable := 0;
+  bantile.invisible := 1;
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-4, y-3, Z+15, 0x8a3, 1, house.realm);
+  bantile.movable := 0;
+  bantile.invisible := 1;
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function twostoryvillaarray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 4);
+  box1.append(y - 4);
+  box1.append(z + 0);
+  box1.append(x + 4);
+  box1.append(y + 4);
+  box1.append(z + 47);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x+2, y+6, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+3, y+6, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+4, y+6, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+5, y+6, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+
+function largemarblehousearray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 6);
+  box1.append(y - 6);
+  box1.append(z + 0);
+  box1.append(x + 6);
+  box1.append(y + 5);
+  box1.append(z + 65);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-6, y+7, Z+1, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-5, y+7, Z+1, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-4, y+7, Z+1, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-3, y+7, Z+1, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-2, y+7, Z+1, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1, y+7, Z+1, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  // Added for ladder to rooftop
+  bantile := CreateItemAtLocation(x-5, y+4, Z+35, 0x8a3, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile.movable := 0;
+  bantile.invisible := 1;
+  bantile := CreateItemAtLocation(x-5, y+5, Z+24, 0x8a4, 1, house.realm);
+  bantile.movable := 0;
+  bantile.invisible := 1;
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function smalltowerarray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 2);
+  box1.append(y - 2);
+  box1.append(z + 0);
+  box1.append(x + 3);
+  box1.append(y + 2);
+  box1.append(z + 65);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x+1, y+4, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2, y+4, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+3, y+4, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+4, y+4, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  // Threw in for adding Ladders. Easiest here so no additions needed for decays
+  bantile := CreateItemAtLocation(x+3, y-2, z+17, 0x8a3, 1, house.realm);
+  bantile.movable := 0;
+  bantile.invisible := 1;
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-2, y-2, z+37, 0x8a0, 1, house.realm);
+  bantile.movable := 0;
+  bantile.invisible := 1;
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function smallmarbleshoparray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 2);
+  box1.append(y - 2);
+  box1.append(z + 0);
+  box1.append(x + 2);
+  box1.append(y + 2);
+  box1.append(z + 65);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-1, y+4, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y+4, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+4, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  bantile := CreateItemAtLocation(x+2, y+4, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  // Ladders
+  bantile := CreateItemAtLocation(x-2, y, Z+18, 0x8a3, 1, house.realm);
+  bantile.movable := 0;
+  bantile.invisible := 1;
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-2, y+1, Z+7, 0x8a4, 1, house.realm);
+  bantile.movable := 0;
+  bantile.invisible := 1;
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function smallstoneshoparray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 2);
+  box1.append(y - 2);
+  box1.append(z + 0);
+  box1.append(x + 2);
+  box1.append(y + 2);
+  box1.append(z + 65);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-2, y+4, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1, y+4, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y+4, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  // Ladders
+  bantile := CreateItemAtLocation(x-2, y, Z+18, 0x8a3, 1, house.realm);
+  bantile.movable := 0;
+  bantile.invisible := 1;
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-2, y+1, Z+7, 0x8a4, 1, house.realm);
+  bantile.movable := 0;
+  bantile.invisible := 1;
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function smallhousearray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 2);
+  box1.append(y - 2);
+  box1.append(z + 0);
+  box1.append(x + 2);
+  box1.append(y + 2);
+  box1.append(z + 27);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-1, y+4, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-0, y+4, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+4, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function largehousearray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 6);
+  box1.append(y - 6);
+  box1.append(z + 0);
+  box1.append(x + 6);
+  box1.append(y + 5);
+  box1.append(z + 27);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  if(house.objtype == 0x6072)
+    bantile := CreateItemAtLocation(x-5, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+    bantile := CreateItemAtLocation(x-4, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+    bantile := CreateItemAtLocation(x-3, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+    bantile := CreateItemAtLocation(x-2, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+  else
+    bantile := CreateItemAtLocation(x-2, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+    bantile := CreateItemAtLocation(x-1, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+    bantile := CreateItemAtLocation(x, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+    bantile := CreateItemAtLocation(x+1, y+7, Z+4, 0x9999, 1, house.realm);
+    banarray.append(bantile.serial);
+    SetObjProperty(bantile, "house_serial", house.serial);
+  endif
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function twostoryarray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 6);
+  box1.append(y - 6);
+  box1.append(z + 0);
+  box1.append(x    );
+  box1.append(y + 5);
+  box1.append(z + 47);
+  boxarray[1] := box1;
+  box1 := {};
+  box1.append(x    );
+  box1.append(y    );
+  box1.append(z + 7);
+  box1.append(x + 5);
+  box1.append(y + 5);
+  box1.append(z + 47);
+  boxarray[2] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-4, y+7, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-3, y+7, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-2, y+7, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1, y+7, Z+4, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function bigtowerarray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 6);
+  box1.append(y - 6);
+  box1.append(z + 0);
+  box1.append(x + 7);
+  box1.append(y + 5);
+  box1.append(z + 65);
+  boxarray[1] := box1;
+  box1 := {};
+  box1.append(x - 10);
+  box1.append(y - 6);
+  box1.append(z + 66);
+  box1.append(x + 11);
+  box1.append(y + 5);
+  box1.append(z + 86);
+  boxarray[2] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-1, y+8, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y+8, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+8, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2, y+8, Z+2, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1, y+7, Z+5, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y+7, Z+5, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+7, Z+5, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2, y+7, Z+5, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function castlearray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 14);
+  box1.append(y - 14);
+  box1.append(z + 0);
+  box1.append(x + 14);
+  box1.append(y + 14);
+  box1.append(z + 47);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-1, y+16, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y+16, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+16, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2, y+16, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1, y+10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y+10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2, y+10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1,  y+6, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x,  y+6, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1,  y+6, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2,  y+6, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-2, y-10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x-1, y-10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y-10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y-10, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
+
+function keeparray(house, x, y, z)
+  var boxarray := {};
+  var box1 := {};
+  box1.append(x - 10);
+  box1.append(y - 10);
+  box1.append(z + 0);
+  box1.append(x + 11);
+  box1.append(y + 11);
+  box1.append(z + 47);
+  boxarray[1] := box1;
+  var banarray := {};
+  var bantile;
+  bantile := CreateItemAtLocation(x-1, y+11, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x, y+11, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+1, y+11, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  bantile := CreateItemAtLocation(x+2, y+11, Z+3, 0x9999, 1, house.realm);
+  banarray.append(bantile.serial);
+  SetObjProperty(bantile, "house_serial", house.serial);
+  SetObjProperty(house, "bantiles", banarray);
+  return boxarray;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/multis/housing/itemdesc.cfg
===================================================================
--- trunk/096/pkg/multis/housing/itemdesc.cfg	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/housing/itemdesc.cfg	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,491 @@
+# $Id: itemdesc.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+Item 0xbd1
+{
+    Name             brasssign1
+    Script           sign
+    ControlScript    signControl
+    Doubleclickrange 6
+    movable          0
+    UseRequiresLOS   0
+}
+
+Item 0xbd2
+{
+    Name             brasssign
+    Script           sign
+    ControlScript    signControl
+    Doubleclickrange 6
+    movable          0
+    UseRequiresLOS   0
+}
+
+Item 0xbcf
+{
+    Name             woodensign1
+    Script           sign
+    ControlScript    signControl
+    Doubleclickrange 6
+    movable          0
+    UseRequiresLOS   0
+}
+
+Item 0xbd0
+{
+    Name             woodensign
+    Script           sign
+    ControlScript    signControl
+    Doubleclickrange 6
+    movable 0
+    UseRequiresLOS   0
+}
+
+Item 0x6019
+{
+    Name             smallstoneandplasterhousedeed
+    Desc             deed to a small stone and plaster house
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   44000
+    VendorBuysFor    22000
+    HouseObjType     smallstoneandplasterhouse
+    cprop numlockdowns i25
+    cprop numsecure  i1
+}
+
+Item 0x601A
+{
+    Name             smallstonehousedeed
+    Desc             deed to a small stone house
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   44000
+    VendorBuysFor    22000
+    HouseObjType     smallstonehouse
+    cprop numlockdowns i25
+    cprop numsecure  i1
+}
+Item 0x601B
+{
+    Name             smallwoodenhousedeed
+    Desc             deed to a small wooden house
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   44000
+    VendorBuysFor    22000
+    HouseObjType     smallwoodenhouse
+    cprop numlockdowns i25
+    cprop numsecure  i1
+}
+Item 0x601C
+{
+    Name             smallplasterhousedeed
+    Desc             deed to a small plaster house
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   44000
+    VendorBuysFor    22000
+    HouseObjType     smallplasterhouse
+    cprop numlockdowns i25
+    cprop numsecure  i1
+}
+Item 0x601D
+{
+    Name             smallwoodandstrawhousedeed
+    Desc             deed to a small wood and straw house
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   44000
+    VendorBuysFor    22000
+    HouseObjType     smallwoodandstrawhouse
+    cprop numlockdowns i25
+    cprop numsecure  i1
+}
+Item 0x601e
+{
+    Name              smallbrickhousedeed
+    Desc              deed to a small wood and straw house
+    Graphic           0x14F0
+    Script            houseDeed
+    newbie            1
+    HouseObjType      smallbrickhouse
+    VendorSellsFor    43800
+    VendorBuysFor     21900
+    cprop numlockdowns i25
+    cprop numsecure  i1
+}
+Item 0x6020
+{
+    Name             largebrickhousedeed
+    Desc             deed to a large brick house
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   145000
+    VendorBuysFor    72500
+    HouseObjType     largebrickhouse
+    cprop numlockdowns i86
+    cprop numsecure  i3
+}
+Item 0x6021
+{
+    Name             twostorywoodandplasterhousedeed
+    Desc             deed to a two story wood and plaster house
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   192000
+    VendorBuysFor    96000
+    HouseObjType     twostorywoodandplasterhouse
+    cprop numlockdowns i108
+    cprop numsecure  i5
+}
+Item 0x6022
+{
+    Name             twostorystoneandplasterhousedeed
+    Desc             deed to a two story stone and plaster house
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   192000
+    VendorBuysFor    96000
+    HouseObjType     twostorystoneandplasterhouse
+    cprop numlockdowns i108
+    cprop numsecure  i5
+}
+Item 0x6023
+{
+    Name             towerdeed
+    Desc             deed to a tower
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   430000
+    VendorBuysFor    215000
+    HouseObjType     tower
+    cprop numlockdowns i244
+    cprop numsecure  i12
+}
+Item 0x6024
+{
+    Name             keepdeed
+    Desc             deed to a keep
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   665000
+    VendorBuysFor    332500
+    HouseObjType     keep
+    cprop numlockdowns i375
+    cprop numsecure  i19
+}
+Item 0x6025
+{
+    Name             castledeed
+    Desc             deed to a grand castle
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   1023000
+    VendorBuysFor    511500
+    HouseObjType     castle
+    cprop numlockdowns i577
+    cprop numsecure  i29
+}
+Item 0x6026
+{
+    Name             largepatiohousedeed
+    Desc             deed to a large patio house
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   153000
+    VendorBuysFor    76500
+    HouseObjType     largepatiohouse
+    cprop numlockdowns i86
+    cprop numsecure  i4
+}
+Item 0x602D
+{
+    Name             smalltowerdeed
+    Desc             deed to a small tower
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   80000
+    VendorBuysFor    35000
+    HouseObjType     smalltowerhouse
+    cprop numlockdowns i35
+    cprop numsecure  i2
+}
+Item 0x602E
+{
+    Name             smallmarbleshopdeed
+    Desc             deed to a small marble shop
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   80000
+    VendorBuysFor    35000
+    HouseObjType     smallmarbleshophouse
+    cprop numlockdowns i25
+    cprop numsecure  i1
+}
+Item 0x602F
+{
+    Name             smallstoneshopdeed
+    Desc             deed to a small stone shop
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   80000
+    VendorBuysFor    35000
+    HouseObjType     smallstoneshophouse
+    cprop numlockdowns i25
+    cprop numsecure  i1
+}
+Item 0x6030
+{
+    Name             largemarblehousedeed
+    Desc             deed to a large marble house
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   153000
+    VendorBuysFor    76500
+    HouseObjType     largemarblehouse
+    cprop numlockdowns i86
+    cprop numsecure  i4
+}
+Item 0x6031
+{
+    Name             logcabindeed
+    Desc             deed to a log cabin
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   145000
+    VendorBuysFor    72000
+    HouseObjType     logcabin
+    cprop numlockdowns i86
+    cprop numsecure  i3
+}
+Item 0x6032
+{
+    Name             sandstonepatiohousedeed
+    Desc             deed to a sandstone patio house
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   125000
+    VendorBuysFor    52000
+    HouseObjType     sandstonepatiohouse
+    cprop numlockdowns i66
+    cprop numsecure  i2
+}
+Item 0x6033
+{
+    Name             twostoryvilladeed
+    Desc             deed to a two story villa
+    Graphic          0x14F0
+    Script           houseDeed
+    newbie           1
+    VendorSellsFor   145000
+    VendorBuysFor    72000
+    HouseObjType     twostoryvilla
+    cprop numlockdowns i86
+    cprop numsecure  i3
+}
+
+Item 0x14ef
+{
+    Name             builtdeed
+    Script           changeOwner
+    Newbie           1
+}
+House 0x6060
+{
+    Name             smallstoneandplasterhouse
+    Graphic          0x4064
+    MultiID          0x64
+    OldObjtype       0x4064
+}
+House 0x6061
+{
+    Name             smallstonehouse
+    WalkOnScript     houseBanning
+    Graphic          0x4066
+    MultiID          0x66
+    OldObjtype       0x4066
+}
+
+House 0x6062
+{
+    Name             smallwoodenhouse
+    WalkOnScript     houseBanning
+    Graphic          0x406a
+    MultiID          0x6a
+    OldObjtype       0x406a
+}
+
+House 0x6063
+{
+    Name             smallplasterhouse
+    WalkOnScript     houseBanning
+    Graphic          0x406c
+    MultiID          0x6c
+    OldObjtype       0x406c
+}
+
+House 0x6064
+{
+    Name             smallwoodandstrawhouse
+    WalkOnScript     houseBanning
+    Graphic          0x406e
+    MultiID          0x6e
+    OldObjtype       0x406e
+}
+
+House 0x6065
+{
+    Name             largebrickhouse
+    WalkOnScript     houseBanning
+    Graphic          0x4074
+    MultiID          0x74
+    OldObjtype       0x4074
+}
+
+House 0x6066
+{
+    Name             twostorywoodandplasterhouse
+    WalkOnScript     houseBanning
+    Graphic          0x4076
+    MultiID          0x76
+    OldObjtype       0x4076
+}
+
+House 0x6068
+{
+    Name             twostorystoneandplasterhouse
+    WalkOnScript     houseBanning
+    Graphic          0x4078
+    MultiID          0x78
+    OldObjtype       0x4078
+}
+
+House 0x6069
+{
+    Name             tower
+    WalkOnScript     houseBanning
+    Graphic          0x407a
+    MultiID          0x7a
+    OldObjtype       0x407a
+}
+
+House 0x6070
+{
+    Name             keep
+    WalkOnScript     houseBanning
+    Graphic          0x407c
+    MultiID          0x7c
+    OldObjtype       0x407c
+}
+
+House 0x6071
+{
+    Name             castle
+    WalkOnScript     houseBanning
+    Graphic          0x407e
+    MultiID          0x7e
+    OldObjtype       0x407e
+}
+
+House 0x6072
+{
+    Name             largepatiohouse
+    WalkOnScript     houseBanning
+    Graphic          0x408c
+    MultiID          0x8c
+    OldObjtype       0x408c
+}
+
+House 0x6073
+{
+    Name             smallbrickhouse
+    WalkOnScript     houseBanning
+    Graphic          0x4068
+    MultiID          0x68
+    OldObjtype       0x4068
+}
+
+House 0x6074
+{
+    Name             smalltowerhouse
+    WalkOnScript     houseBanning
+    Graphic          0x4098
+    MultiID          0x98
+    OldObjtype       0x4098
+}
+House 0x6075
+{
+    Name             smallmarbleshophouse
+    WalkOnScript     houseBanning
+    Graphic          0x40A2
+    MultiID          0xA2
+    OldObjtype       0x40A2
+}
+House 0x6076
+{
+    Name             smallstoneshophouse
+    WalkOnScript     houseBanning
+    Graphic          0x40A0
+    MultiID          0xA0
+    OldObjtype       0x40A0
+}
+House 0x6077
+{
+    Name             largemarblehouse
+    WalkOnScript     houseBanning
+    Graphic          0x4096
+    MultiID          0x96
+    OldObjtype       0x4096
+}
+House 0x6078
+{
+    Name             logcabin
+    WalkOnScript     houseBanning
+    Graphic          0x409A
+    MultiID          0x9A
+    OldObjtype       0x409A
+}
+House 0x6079
+{
+    Name             sandstonepatiohouse
+    WalkOnScript     houseBanning
+    Graphic          0x409C
+    MultiID          0x9C
+    OldObjtype       0x409C
+}
+House 0x607A
+{
+    Name             twostoryvilla
+    WalkOnScript     houseBanning
+    Graphic          0x409E
+    MultiID          0x9E
+    OldObjtype       0x409E
+}
+
+Item 0x9999
+{
+    Name             bantile
+    Graphic          0x1
+    Invisible        1
+    WalkOnScript     houseBanning
+    movable          0
+}

Added: trunk/096/pkg/multis/housing/pkg.cfg
===================================================================
--- trunk/096/pkg/multis/housing/pkg.cfg	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/housing/pkg.cfg	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,9 @@
+# $Id: pkg.cfg 684 2005-10-27 18:48:28Z muaddiblsd $
+#
+#
+Enabled		1
+Name		housing
+CoreRequired	92
+Maintainer	Distro Team
+Email		distro at polserver.com
+Version		1.1

Added: trunk/096/pkg/multis/housing/secureCont.src
===================================================================
--- trunk/096/pkg/multis/housing/secureCont.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/housing/secureCont.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,30 @@
+use os;
+use uo;
+
+program use_securecont(who, item)
+  var house := SystemFindObjectBySerial( GetObjProperty( item, "houseserial" ));
+  var secure := 0;
+  if ((GetObjProperty( house, "ownerserial" ) == who.serial) || (GetObjProperty( house, "owneracct" ) == who.acctname))
+     secure := 1;
+  else
+    var coownerinfo := GetObjProperty(house,"coownlist");
+    if(who.serial in coownerinfo)
+      secure := 1;
+    else
+      var friendinfo := GetObjProperty(house,"friendlist");
+      if(who.serial in friendinfo)
+        secure := 1;
+      endif
+    endif
+  endif
+  if(who.cmdlevel >= 3)
+    secure := 1;
+  endif
+  if(!secure)
+    SendSysMessage( who, "You can't use this." );
+    return;
+  else
+    SendViewContainer( who, item );
+    SendSysMessage( who, "You open the secure container." );
+  endif
+endprogram
\ No newline at end of file

Added: trunk/096/pkg/multis/housing/sign.src
===================================================================
--- trunk/096/pkg/multis/housing/sign.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/housing/sign.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,1483 @@
+use uo;
+use os;
+
+include "util/key";
+include ":gumps:yesno";
+include ":containers:storageAreas";
+
+Const UOBJECT_DOORS_START := 0x0675;
+Const UOBJECT_DOORS_END   := 0x06f4;
+Const KEYSTART := 0x100e;
+Const KEYEND := 0x1013;
+Const KEYRING := 0x1011;
+
+var nonlayout := {
+ "page 0",
+ "gumppic 240 0 100",
+ "text 270 200 48 0",
+ "text 270 50 48 31"
+ };
+
+var nondata := {
+""
+};
+
+var layout := array(
+"page 0",
+"resizepic 100 45 2600 412 300",
+"gumppic 240 0 100",
+"text 290 30 48 0",
+"text 290 50 48 31",
+"resizepic 115 100 5100 382 25",
+"text 125 102 0 1",
+"button 178 104 5209 5003 0 1 0",
+"text 245 102 0 2",
+"button 330 104 5209 5003 0 2 0",
+"text 375 102 0 3",
+"button 460 104 5209 5003 0 3 0",
+"button 150 308 247 248 1 0 0",
+"page 1",
+"text 140 140 2302 4",
+"text 220 140 0 5",
+"text 135 180 2302 6",
+"text 350 180 0 7",
+"text 135 200 2302 8",
+"text 350 200 0 9",
+"text 250 308 2302 14",
+"button 430 308 2714 2715 1 0 1",
+"page 2",
+"text 155 130 2302 15",
+"button 125 130 2714 2715 1 0 2",
+"text 155 152 2302 16",
+"button 125 152 2714 2715 1 0 3",
+"text 155 174 2302 17",
+"button 125 174 2714 2715 1 0 4",
+"text 350 130 2302 18",
+"button 125 194 2714 2715 1 0 17",
+"text 155 194 2302 19",
+"button 320 130 2714 2715 1 0 5",
+"text 350 152 2302 20",
+"button 320 152 2714 2715 1 0 6",
+"text 350 174 2302 21",
+"button 320 174 2714 2715 1 0 7",
+"text 350 196 2302 22",
+"button 320 196 2714 2715 1 0 8",
+"text 245 218 2302 23",
+"button 215 218 2714 2715 1 0 11",
+"text 245 240 2302 24",
+"button 215 240 2714 2715 1 0 9",
+"text 245 262 2302 25",
+"button 215 262 2714 2715 1 0 12",
+"text 245 284 2302 26",
+"button 215 284 2714 2715 1 0 10",
+"page 3",
+"text 190 130 2302 27",
+"button 160 130 2714 2715 1 0 13",//transfer ownership
+"text 190 160 2302 28",
+"button 160 160 2714 2715 1 0 14",//demolish
+"text 190 190 2302 29",
+//"button 60 190 2714 2715 1 0 16",//change - key/sign
+"text 190 220 2302 30",
+"button 160 220 2714 2715 1 0 19",//declare priv/pub
+
+"page 4",                                 // Page 4
+"button 140 153 210 211 1 4 2980",          // Sign Button
+"tilepic 149 145 2980",                   // Sign Picture
+"button 140 188 210 211 1 4 2982",          // Sign Button
+"tilepic 149 180 2982",                   // Sign Picture
+"button 140 223 210 211 1 4 2984",          // Sign Button
+"tilepic 149 215 2984",                   // Sign Picture
+"button 140 258 210 211 1 4 2986",          // Sign Button
+"tilepic 149 250 2986",                   // Sign Picture
+"button 195 153 210 211 1 4 2988",          // Sign Button
+"tilepic 204 145 2988",                   // Sign Picture
+"button 195 188 210 211 1 4 2990",          // Sign Button
+"tilepic 204 180 2990",                   // Sign Picture
+"button 195 223 210 211 1 4 2992",          // Sign Button
+"tilepic 204 215 2992",                   // Sign Picture
+"button 195 258 210 211 1 4 2994",          // Sign Button
+"tilepic 204 250 2994",                   // Sign Picture
+"button 250 153 210 211 1 4 2996",          // Sign Button
+"tilepic 259 145 2996",                   // Sign Picture
+"button 250 188 210 211 1 4 2998",          // Sign Button
+"tilepic 259 180 2998",                   // Sign Picture
+"button 250 223 210 211 1 4 3000",          // Sign Button
+"tilepic 259 215 3000",                   // Sign Picture
+"button 250 258 210 211 1 4 3002",          // Sign Button
+"tilepic 259 250 3002",                   // Sign Picture
+"button 305 153 210 211 1 4 3004",          // Sign Button
+"tilepic 314 145 3004",                   // Sign Picture
+"button 305 188 210 211 1 4 3006",          // Sign Button
+"tilepic 314 180 3006",                   // Sign Picture
+"button 305 223 210 211 1 4 3008",          // Sign Button
+"tilepic 314 215 3008",                   // Sign Picture
+"button 305 258 210 211 1 4 3010",          // Sign Button
+"tilepic 314 250 3010",                   // Sign Picture
+"button 360 153 210 211 1 4 3012",          // Sign Button
+"tilepic 369 145 3012",                   // Sign Picture
+"button 360 188 210 211 1 4 3014",          // Sign Button
+"tilepic 369 180 3014",                   // Sign Picture
+"button 360 223 210 211 1 4 3016",          // Sign Button
+"tilepic 369 215 3016",                   // Sign Picture
+"button 360 258 210 211 1 4 3018",          // Sign Button
+"tilepic 369 250 3018",                   // Sign Picture
+"button 415 153 210 211 1 4 3020",          // Sign Button
+"tilepic 424 145 3020",                   // Sign Picture
+"button 415 188 210 211 1 4 3022",          // Sign Button
+"tilepic 424 180 3022",                   // Sign Picture
+"button 415 223 210 211 1 4 3024",          // Sign Button
+"tilepic 424 215 3024",                   // Sign Picture
+"button 415 258 210 211 1 4 3026",          // Sign Button
+"tilepic 424 250 3026",                   // Sign Picture
+"text 275 303 995 32",                    // Guild Text
+"button 425 290 252 253 0 5 45",          // Guild Section
+"page 5",                                 // Page 5
+"button 140 153 210 211 1 5 3028",          // Sign Button
+"tilepic 149 145 3028",                   // Sign Picture
+"button 140 188 210 211 1 5 3030",          // Sign Button
+"tilepic 149 180 3030",                   // Sign Picture
+"button 140 223 210 211 1 5 3032",          // Sign Button
+"tilepic 149 215 3032",                   // Sign Picture
+"button 140 258 210 211 1 5 3034",          // Sign Button
+"tilepic 149 250 3034",                   // Sign Picture
+"button 140 283 210 211 1 5 3036",          // Sign Button
+"tilepic 149 285 3036",                   // Sign Picture
+"button 195 153 210 211 1 5 3038",          // Sign Button
+"tilepic 204 145 3038",                   // Sign Picture
+"button 195 283 210 211 1 5 3040",          // Sign Button
+"tilepic 204 285 3040",                   // Sign Picture
+"button 195 223 210 211 1 5 3042",          // Sign Button
+"tilepic 204 215 3042",                   // Sign Picture
+"button 195 258 210 211 1 5 3044",          // Sign Button
+"tilepic 204 250 3044",                   // Sign Picture
+"button 195 183 210 211 1 5 3046",          // Sign Button
+"tilepic 204 185 3046",                   // Sign Picture
+"button 250 153 210 211 1 5 3048",          // Sign Button
+"tilepic 259 145 3048",                   // Sign Picture
+"button 250 283 210 211 1 5 3050",          // Sign Button
+"tilepic 259 285 3050",                   // Sign Picture
+"button 250 223 210 211 1 5 3052",          // Sign Button
+"tilepic 259 215 3052",                   // Sign Picture
+"button 250 258 210 211 1 5 3054",          // Sign Button
+"tilepic 259 250 3054",                   // Sign Picture
+"button 250 183 210 211 1 5 3056",          // Sign Button
+"tilepic 259 185 3056",                   // Sign Picture
+"button 305 153 210 211 1 5 3058",          // Sign Button
+"tilepic 314 145 3058",                   // Sign Picture
+"button 305 188 210 211 1 5 3060",          // Sign Button
+"tilepic 314 180 3060",                   // Sign Picture
+"button 305 223 210 211 1 5 3062",          // Sign Button
+"tilepic 314 215 3062",                   // Sign Picture
+"button 305 258 210 211 1 5 3064",          // Sign Button
+"tilepic 314 250 3064",                   // Sign Picture
+"button 305 283 210 211 1 5 3066",          // Sign Button
+"tilepic 314 285 3066",                   // Sign Picture
+"button 360 153 210 211 1 5 3068",          // Sign Button
+"tilepic 369 145 3068",                   // Sign Picture
+"button 360 188 210 211 1 5 3070",          // Sign Button
+"tilepic 369 180 3070",                   // Sign Picture
+"button 360 223 210 211 1 5 3072",          // Sign Button
+"tilepic 369 215 3072",                   // Sign Picture
+"button 360 258 210 211 1 5 3074",          // Sign Button
+"tilepic 369 250 3074",                   // Sign Picture
+"button 360 283 210 211 1 5 3076",          // Sign Button
+"tilepic 369 285 3076",                   // Sign Picture
+"button 415 153 210 211 1 5 3078",          // Sign Button
+"tilepic 424 145 3078",                   // Sign Picture
+"button 415 188 210 211 1 5 3080",          // Sign Button
+"tilepic 424 180 3080",                   // Sign Picture
+"button 415 223 210 211 1 5 3082",          // Sign Button
+"tilepic 424 215 3082",                   // Sign Picture
+"button 415 258 210 211 1 5 3084",          // Sign Button
+"tilepic 424 250 3084",                   // Sign Picture
+"text 275 313 995 33",                    // Shop Test
+"button 425 310 250 251 0 4",             // Shop Section
+
+
+"nodispose"
+);
+
+var data := array(
+"",
+"INFO",
+"FRIENDS",
+"OPTIONS",
+"Owned by:",
+"<NAME>",
+"Number of locked down items:",
+"",
+"Number of secure containers:",
+"",
+"Number of visits this building has had:",
+"This house is improperly placed.",
+"",
+"This house is of #### design.",
+"Change the house name!",
+"List of co-owners",
+"Add a co-owner",
+"Remove a co-owner",
+"List of friends",
+"Clear Co-owner List",
+"Add a friend",
+"Remove a friend",
+"Clear friend list",
+"List of banned people",
+"Ban someone from the house",
+"Remove a ban",
+"Eject someone from the house",
+"Transfer ownership of the house",
+"Demolish the house & get a deed back",
+"Change the master key",
+"Change the sign type",
+"",
+"Shop Sign Choices",
+"Guild Sign Choices",
+""
+);
+
+
+
+var layoutbanlift := {
+"page 0",                                // Page 0
+"resizepic 100 100 2600 400 300",        // Grey background
+"resizepic 147 359 5100 310 25",         // Square Grey box
+"text 185 118 995 0",                    // Title
+"button 270 360 247 248 1 0 1",          // Okay, button 1
+"button 150 340 2714 2714 1 0 2",        // Remove Button
+"text 170 340 995 24",                    // Remove Text
+"page 1",                                // Page 1
+"button 425 363 5224 5224 0 2 16",       // Next Page
+"text 180 140 0 1",                      // Banned Name
+"button 150 140 210 211 1 0 3",          // Banned Button
+"text 180 160 0 2",                      // Banned Name
+"button 150 160 210 211 1 0 4",          // Banned Button
+"text 180 180 0 3",                      // Banned Name
+"button 150 180 210 211 1 0 5",          // Banned Button
+"text 180 200 0 4",                      // Banned Name
+"button 150 200 210 211 1 0 6",          // Banned Button
+"text 180 220 0 5",                      // Banned Name
+"button 150 220 210 211 1 0 7",          // Banned Button
+"text 180 240 0 6",                      // Banned Name
+"button 150 240 210 211 1 0 8",          // Banned Button
+"text 180 260 0 7",                      // Banned Name
+"button 150 260 210 211 1 0 9",          // Banned Button
+"text 180 280 0 8",                      // Banned Name
+"button 150 280 210 211 1 0 10",         // Banned Button
+"text 180 300 0 9",                      // Banned Name
+"button 150 300 210 211 1 0 11",         // Banned Button
+"text 180 320 0 10",                     // Banned Name
+"button 150 320 210 211 1 0 12",         // Banned Button
+"page 2",                     // Page 2
+"text 180 140 0 11",                     // Banned Name
+"button 150 140 210 211 1 0 13",         // Banned Button
+"text 180 160 0 12",                     // Banned Name
+"button 150 160 210 211 1 0 14",         // Banned Button
+"text 180 180 0 13",                     // Banned Name
+"button 150 180 210 211 1 0 15",         // Banned Button
+"text 180 200 0 14",                     // Banned Name
+"button 150 200 210 211 1 0 16",         // Banned Button
+"text 180 220 0 15",                     // Banned Name
+"button 150 220 210 211 1 0 17",         // Banned Button
+"text 180 240 0 16",                     // Banned Name
+"button 150 240 210 211 1 0 18",         // Banned Button
+"text 180 260 0 17",                     // Banned Name
+"button 150 260 210 211 1 0 19",         // Banned Button
+"text 180 280 0 18",                     // Banned Name
+"button 150 280 210 211 1 0 20",         // Banned Button
+"text 180 300 0 19",                     // Banned Name
+"button 150 300 210 211 1 0 21",         // Banned Button
+"text 180 320 0 20",                     // Banned Name
+"button 150 320 210 211 1 0 22",         // Banned Button
+"button 160 363 5223 5223 0 1 30"        // Previous Page
+
+
+};
+
+var databanlift := {
+"Lift a Ban",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"Remove Now!",
+""
+};
+
+
+
+
+var layoutfriendremove := {
+"page 0",                                // Page 0
+"resizepic 100 100 2600 400 300",        // Grey background
+"resizepic 147 359 5100 310 25",         // Square Grey box
+"text 185 118 995 0",                    // Title
+"button 270 360 247 248 1 0 1",          // Okay, button 1
+"button 145 335 2714 2714 1 0 2",        // Remove Button
+"text 165 335 995 24",                    // Remove Text
+"page 1",                                // Page 1
+"button 425 363 5224 5224 0 2 16",       // Next Page
+"text 180 140 0 1",                      // Banned Name
+"button 150 140 210 211 1 0 3",          // Banned Button
+"text 180 160 0 2",                      // Banned Name
+"button 150 160 210 211 1 0 4",          // Banned Button
+"text 180 180 0 3",                      // Banned Name
+"button 150 180 210 211 1 0 5",          // Banned Button
+"text 180 200 0 4",                      // Banned Name
+"button 150 200 210 211 1 0 6",          // Banned Button
+"text 180 220 0 5",                      // Banned Name
+"button 150 220 210 211 1 0 7",          // Banned Button
+"text 180 240 0 6",                      // Banned Name
+"button 150 240 210 211 1 0 8",          // Banned Button
+"text 180 260 0 7",                      // Banned Name
+"button 150 260 210 211 1 0 9",          // Banned Button
+"text 180 280 0 8",                      // Banned Name
+"button 150 280 210 211 1 0 10",         // Banned Button
+"text 180 300 0 9",                      // Banned Name
+"button 150 300 210 211 1 0 11",         // Banned Button
+"text 180 320 0 10",                     // Banned Name
+"button 150 320 210 211 1 0 12",         // Banned Button
+"page 2",                     // Page 2
+"text 180 140 0 11",                     // Banned Name
+"button 150 140 210 211 1 0 13",         // Banned Button
+"text 180 160 0 12",                     // Banned Name
+"button 150 160 210 211 1 0 14",         // Banned Button
+"text 180 180 0 13",                     // Banned Name
+"button 150 180 210 211 1 0 15",         // Banned Button
+"text 180 200 0 14",                     // Banned Name
+"button 150 200 210 211 1 0 16",         // Banned Button
+"text 180 220 0 15",                     // Banned Name
+"button 150 220 210 211 1 0 17",         // Banned Button
+"text 180 240 0 16",                     // Banned Name
+"button 150 240 210 211 1 0 18",         // Banned Button
+"text 180 260 0 17",                     // Banned Name
+"button 150 260 210 211 1 0 19",         // Banned Button
+"text 180 280 0 18",                     // Banned Name
+"button 150 280 210 211 1 0 20",         // Banned Button
+"text 180 300 0 19",                     // Banned Name
+"button 150 300 210 211 1 0 21",         // Banned Button
+"text 180 320 0 20",                     // Banned Name
+"button 150 320 210 211 1 0 22",         // Banned Button
+"button 160 363 5223 5223 0 1 30"        // Previous Page
+
+
+};
+
+var datafriendremove := {
+"Remove a friend",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"Remove Now!",
+""
+};
+
+
+var layoutfriendlist := {
+"page 0",                                // Page 0
+"resizepic 100 100 2600 400 300",        // Grey background
+"resizepic 147 359 5100 310 25",         // Square Grey box
+"text 185 118 995 0",                    // Title
+"button 270 360 247 248 1 0 1",          // Okay, button 1
+//"button 145 335 2714 2714 1 0 2",        // Remove Button
+"text 165 335 995 24",                    // Remove Text
+"page 1",                                // Page 1
+"button 425 363 5224 5224 0 2 16",       // Next Page
+"text 180 140 0 1",                      // Banned Name
+"text 180 160 0 2",                      // Banned Name
+"text 180 180 0 3",                      // Banned Name
+"text 180 200 0 4",                      // Banned Name
+"text 180 220 0 5",                      // Banned Name
+"text 180 240 0 6",                      // Banned Name
+"text 180 260 0 7",                      // Banned Name
+"text 180 280 0 8",                      // Banned Name
+"text 180 300 0 9",                      // Banned Name
+"text 180 320 0 10",                     // Banned Name
+"page 2",                     // Page 2
+"text 180 140 0 11",                     // Banned Name
+"text 180 160 0 12",                     // Banned Name
+"text 180 180 0 13",                     // Banned Name
+"text 180 200 0 14",                     // Banned Name
+"text 180 220 0 15",                     // Banned Name
+"text 180 240 0 16",                     // Banned Name
+"text 180 260 0 17",                     // Banned Name
+"text 180 280 0 18",                     // Banned Name
+"text 180 300 0 19",                     // Banned Name
+"text 180 320 0 20",                     // Banned Name
+"button 160 363 5223 5223 0 1 30"        // Previous Page
+
+
+};
+
+var datafriendlist := {
+"Friends of the house",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+""
+};
+
+
+var layoutbanlist := {
+"page 0",                                // Page 0
+"resizepic 100 100 2600 400 300",        // Grey background
+"resizepic 147 359 5100 310 25",         // Square Grey box
+"text 185 118 995 0",                    // Title
+"button 270 360 247 248 1 0 1",          // Okay, button 1
+//"button 145 335 2714 2714 1 0 2",        // Remove Button
+"text 165 335 995 24",                    // Remove Text
+"page 1",                                // Page 1
+"button 425 363 5224 5224 0 2 16",       // Next Page
+"text 180 140 0 1",                      // Banned Name
+"text 180 160 0 2",                      // Banned Name
+"text 180 180 0 3",                      // Banned Name
+"text 180 200 0 4",                      // Banned Name
+"text 180 220 0 5",                      // Banned Name
+"text 180 240 0 6",                      // Banned Name
+"text 180 260 0 7",                      // Banned Name
+"text 180 280 0 8",                      // Banned Name
+"text 180 300 0 9",                      // Banned Name
+"text 180 320 0 10",                     // Banned Name
+"page 2",                     // Page 2
+"text 180 140 0 11",                     // Banned Name
+"text 180 160 0 12",                     // Banned Name
+"text 180 180 0 13",                     // Banned Name
+"text 180 200 0 14",                     // Banned Name
+"text 180 220 0 15",                     // Banned Name
+"text 180 240 0 16",                     // Banned Name
+"text 180 260 0 17",                     // Banned Name
+"text 180 280 0 18",                     // Banned Name
+"text 180 300 0 19",                     // Banned Name
+"text 180 320 0 20",                     // Banned Name
+"button 160 363 5223 5223 0 1 30"        // Previous Page
+
+
+};
+
+var databanlist := {
+"Enemies of the house",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+""
+};
+
+
+
+
+var layoutcownremove := {
+"page 0",                                // Page 0
+"resizepic 100 100 2600 400 300",        // Grey background
+"resizepic 147 359 5100 310 25",         // Square Grey box
+"text 185 118 995 0",                    // Title
+"button 270 360 247 248 1 0 1",          // Okay, button 1
+"button 145 335 2714 2714 1 0 2",        // Remove Button
+"text 165 335 995 24",                    // Remove Text
+"page 1",                                // Page 1
+"button 425 363 5224 5224 0 2 16",       // Next Page
+"text 180 140 0 1",                      // Banned Name
+"button 150 140 210 211 1 0 3",          // Banned Button
+"text 180 160 0 2",                      // Banned Name
+"button 150 160 210 211 1 0 4",          // Banned Button
+"text 180 180 0 3",                      // Banned Name
+"button 150 180 210 211 1 0 5",          // Banned Button
+"text 180 200 0 4",                      // Banned Name
+"button 150 200 210 211 1 0 6",          // Banned Button
+"text 180 220 0 5",                      // Banned Name
+"button 150 220 210 211 1 0 7",          // Banned Button
+"text 180 240 0 6",                      // Banned Name
+"button 150 240 210 211 1 0 8",          // Banned Button
+"text 180 260 0 7",                      // Banned Name
+"button 150 260 210 211 1 0 9",          // Banned Button
+"text 180 280 0 8",                      // Banned Name
+"button 150 280 210 211 1 0 10",         // Banned Button
+"text 180 300 0 9",                      // Banned Name
+"button 150 300 210 211 1 0 11",         // Banned Button
+"text 180 320 0 10",                     // Banned Name
+"button 150 320 210 211 1 0 12",         // Banned Button
+"page 2",                     // Page 2
+"text 180 140 0 11",                     // Banned Name
+"button 150 140 210 211 1 0 13",         // Banned Button
+"text 180 160 0 12",                     // Banned Name
+"button 150 160 210 211 1 0 14",         // Banned Button
+"text 180 180 0 13",                     // Banned Name
+"button 150 180 210 211 1 0 15",         // Banned Button
+"text 180 200 0 14",                     // Banned Name
+"button 150 200 210 211 1 0 16",         // Banned Button
+"text 180 220 0 15",                     // Banned Name
+"button 150 220 210 211 1 0 17",         // Banned Button
+"text 180 240 0 16",                     // Banned Name
+"button 150 240 210 211 1 0 18",         // Banned Button
+"text 180 260 0 17",                     // Banned Name
+"button 150 260 210 211 1 0 19",         // Banned Button
+"text 180 280 0 18",                     // Banned Name
+"button 150 280 210 211 1 0 20",         // Banned Button
+"text 180 300 0 19",                     // Banned Name
+"button 150 300 210 211 1 0 21",         // Banned Button
+"text 180 320 0 20",                     // Banned Name
+"button 150 320 210 211 1 0 22",         // Banned Button
+"button 160 363 5223 5223 0 1 30"        // Previous Page
+};
+
+var datacownremove := {
+"Remove a Co-owner",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"Remove Now!",
+""
+};
+
+
+var layoutcownlist := {
+"page 0",                                // Page 0
+"resizepic 100 100 2600 400 300",        // Grey background
+"resizepic 147 359 5100 310 25",         // Square Grey box
+"text 185 118 995 0",                    // Title
+"button 270 360 247 248 1 0 1",          // Okay, button 1
+//"button 145 335 2714 2714 1 0 2",        // Remove Button
+"text 165 335 995 24",                    // Remove Text
+"page 1",                                // Page 1
+"button 425 363 5224 5224 0 2 16",       // Next Page
+"text 180 140 0 1",                      // Banned Name
+"text 180 160 0 2",                      // Banned Name
+"text 180 180 0 3",                      // Banned Name
+"text 180 200 0 4",                      // Banned Name
+"text 180 220 0 5",                      // Banned Name
+"text 180 240 0 6",                      // Banned Name
+"text 180 260 0 7",                      // Banned Name
+"text 180 280 0 8",                      // Banned Name
+"text 180 300 0 9",                      // Banned Name
+"text 180 320 0 10",                     // Banned Name
+"page 2",                     // Page 2
+"text 180 140 0 11",                     // Banned Name
+"text 180 160 0 12",                     // Banned Name
+"text 180 180 0 13",                     // Banned Name
+"text 180 200 0 14",                     // Banned Name
+"text 180 220 0 15",                     // Banned Name
+"text 180 240 0 16",                     // Banned Name
+"text 180 260 0 17",                     // Banned Name
+"text 180 280 0 18",                     // Banned Name
+"text 180 300 0 19",                     // Banned Name
+"text 180 320 0 20",                     // Banned Name
+"button 160 363 5223 5223 0 1 30"        // Previous Page
+
+
+
+};
+
+var datacownlist := {
+"Co-owners of the house",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+"",
+""
+};
+
+var checklayout := array(
+
+"page 0",
+"gumppic   0  50 0206            ",
+"gumppic  40  50 0201            ",
+"gumppic 460  50 0207            ",
+"gumppic   0  94 0202            ",
+"gumppic  40  94 2604            ",
+"gumppic 460  94 2605            ",
+"gumppic   0 410 2606            ",
+"gumppic  40 410 2607            ",
+"gumppic 460 410 2608            ",
+"gumppic  16 100 5100            ",
+"gumppic  28 100 5101            ",
+"gumppic 118 100 5101            ",
+"gumppic 208 100 5101            ",
+"gumppic 298 100 5101            ",
+"gumppic 388 100 5101            ",
+"gumppic 478 100 5102            ",
+"gumppic  16 108 5103            ",
+"gumppic  28 108 5104            ",
+"gumppic 118 108 5104            ",
+"gumppic 208 108 5104            ",
+"gumppic 298 108 5104            ",
+"gumppic 388 108 5104            ",
+"gumppic 478 108 5105            ",
+"gumppic  16 116 5058            ",
+"gumppic 118 116 5058            ",
+"gumppic 232 116 5058            ",
+"gumppic 360 116 5058            ",
+"gumppic  16 116 5106            ",
+"gumppic  28 116 5107            ",
+"gumppic 118 116 5107            ",
+"gumppic 208 116 5107            ",
+"gumppic 298 116 5107            ",
+"gumppic 388 116 5107            ",
+"gumppic 478 116 5108            ",
+"text     55 183  910   0        ",
+"text     55 203  910   1        ",
+"text     55 223  910   2        ",
+"button  125 250  249  248 1 0  1",
+"button  205 250  243  241 1 0  0"
+);
+
+var checkdata := array(
+"Declaring this house public will unlock",
+"the front doors and make them not lockable.",
+"Are you sure you want to do this?"
+);
+
+program textcmd_sign(who, sign)
+  var hserial := GetObjProperty(sign, "house_serial");
+  if(!hserial)
+    return;
+  endif
+  var house := SystemFindObjectBySerial(CInt(hserial));
+  var oserial := GetObjProperty(house, "ownerserial");
+  SetPlaqueName(sign, house);
+  if(GetObjProperty(house, "Public"))
+    data[31] := "Declare this house Private";
+    data[30] := "Change the sign type";
+    layout.append("page 3");
+    layout.append("button 160 190 2714 2715 0 4 26");
+  else
+    data[31] := "Declare this house Public";
+    data[30] := "Change the master key";
+    layout.append("page 3");
+    layout.append("button 160 190 2714 2715 1 4 16");
+  endif
+  if(who.serial == oserial)
+    data[6] := who.name;
+    SetObjProperty(sign, "lastownername", who.name);
+  else
+    data[6] := GetObjProperty(sign, "lastownername");
+  endif
+  data[8]  := GetObjProperty(house, "numlockdowns");
+  data[10] := GetObjProperty(house, "numsecure");
+  var friend_ := 0, cown := 0;
+  var friendlist := GetObjProperty(house, "friendlist");
+  var coown := GetObjProperty(house, "coownlist");
+  if(who.serial in friendlist)
+    friend_ := 1;
+  elseif(who.serial in coown)
+    cown := 1;
+  endif
+  var result;
+  var acct := GetObjProperty(house, "owneracct");
+  if((cown == 1) || (friend_ == 1) || (who.acctname == acct) || (who.cmdlevel > 2))
+    result := SendDialogGump(who, layout, data);
+  else
+    SendDialogGump(who, nonlayout, data);
+  endif
+  if((oserial == who.serial) ||(cown))
+    SetObjProperty(house,"decay",(ReadGameClock()+ 2592000));
+  endif
+  if((acct == who.acctname) || (cown) || (who.cmdlevel > 2))
+    if(result[0] > 2979 && result[0] < 3085)
+      ChangeSign(who, house, sign, result[0]);
+    endif
+    case(result[0])
+      1: var newname := RequestInput(who, sign, "Enter a name for this house.(esc to exit)");
+         if(!newname)
+           SendSysMessage(who, "Canceled!");
+         elseif((len(newname) > 20))
+           SendSysMessage(who, "House sign names may not be longer than 20 characters.");
+         elseif(len(SplitWords(newname)) > 5)
+           SendSysMessage(who, "House sign names are limited to 5 words or less.");
+         else
+           SetName(sign, newname);
+           SetObjProperty(house, "signname", newname);
+         endif
+      2: ListCoowner(house, who);                                   //list co-owners
+      3: AddCoowner(house, who);                                    //add co-owner
+      4: DeleteCoowner(house, who);                                 //delete co-owner
+      5: ListFriend(house, who);                                    //list friends
+      6: AddFriend(house, who);                                     //add friend
+      7: DeleteFriend(house, who);                                  //delete friend
+      8: if(YesNo(who,"Clear List?"))                               //clear friend list
+           EraseObjProperty(house, "friendlist");
+           SendSysMessage(who,"Friend list has been cleared.");
+         else
+           SendSysMessage(who,"Canceled!");
+         endif
+      9: AddBan(house, who,sign);                                   //add a ban
+     10: Eject(house,who,sign);                                     //eject someone
+     11: ListBan(house, who);                                       //list bans
+     12: DeleteBan(house, who);                                     //remove a ban
+     13: if((oserial == who.serial) or (who.cmdlevel > 2))          //transfer ownership
+           var targetow := Target(who);
+           SendSysMessage(who, "Transfer the house to who?");
+           if(ChangeHouseOwner(who, targetow,house) == 1)
+             SendSysMessage(who, "House transfer was successful.");
+           else
+             SendSysMessage(who, "House transfer was NOT successful.");
+           endif
+         endif
+     14: if(oserial == who.serial)                                   //demolish house
+           if(YesNo(who, "are you sure?"))
+             demolish(house, sign, who);
+           else
+             SendSysMessage(who, "Cancelled");
+           endif
+           return;
+         endif
+     16: if(oserial == who.serial)                                   //change locks
+           ChangeLocks(who, house);
+         endif
+     17: if(YesNo(who,"Clear List?"))                               //clear co-owner list
+           EraseObjProperty(house, "coownlist");
+           SendSysMessage(who,"Co-owner list has been cleared.");
+         else
+           SendSysMessage(who,"Canceled!");
+         endif
+     19: if(oserial == who.serial)                                   //make private
+           DeclarePrivPub(who, house, sign);
+         endif
+    endcase
+  endif
+endprogram
+
+//////////////////////////////////
+//       friending
+//////////////////////////////////
+
+function AddFriend(house, who)
+  var banlist := GetObjProperty(house, "friendlist");
+  if(!banlist)
+    banlist := {};
+  endif
+  if(len(banlist) >= 20)
+    SendSysMessage(who, "The friend list is full.");
+    return;
+  endif
+  SendSysMessage(who,"Select character.");
+  var targetchr := Target(who);
+  if(!targetchr)
+    SendSysMessage(who,"Cancelled.");
+    return;
+  endif
+  if(!targetchr.isA(POLCLASS_MOBILE))
+    SendSysMessage(who,"That cannot be added to the list.");
+    return;
+  endif
+  if(targetchr.serial in banlist)
+    SendSysMessage(who, "That person is already a friend.");
+    return;
+  endif
+  if(targetchr.acctname == GetObjProperty(house,"owneracct"))
+    SendSysMessage(who, "Canceled.");
+    return;
+  endif
+  checklists(house, targetchr, "banlist", "coownlist");
+  banlist.append(targetchr.serial);
+  SetObjProperty(house, "friendlist", banlist);
+  SendSysMessage(who, targetchr.name + " was friended to your house.");
+endfunction
+
+function DeleteFriend(house,who)
+  var z := 0;
+  var fillname;
+  var retval1 := 0;
+  var banlist := GetObjProperty(house, "friendlist");
+  if(!banlist)
+    banlist := {};
+  endif
+  var newlist := {};
+  foreach thing in banlist
+    fillname := SystemFindObjectBySerial(thing);
+    if(!fillname)
+      fillname := SystemFindObjectBySerial(thing, SYSFIND_SEARCH_OFFLINE_MOBILES);
+    endif
+    if(fillname)
+      newlist.append(thing);
+      datafriendremove[z+2] := fillname.name;
+      z := z + 1;
+    endif
+  endforeach
+  SetObjProperty(house, "friendlist", newlist);
+  retval1 := SendDialogGump(who, layoutfriendremove, datafriendremove);
+  var bancheck, returncheck;
+  if(retval1[0] > 2 && retval1[0] <= 22)
+    returncheck := retval1[0] - 2;
+    bancheck := banlist[returncheck];
+    if(!bancheck)
+      SendSysMessage(who, "There is no friend in that slot.");
+      return;
+    else
+      var newlist := {};
+      foreach thing in banlist
+        if(thing != bancheck)
+          newlist.append(thing);
+        endif
+      endforeach
+      SetObjProperty(house, "friendlist", newlist);
+    endif
+  endif
+endfunction
+
+function ListFriend(house, who)
+  var z := 0;
+  var fillname;
+  var banlist := GetObjProperty(house, "friendlist");
+  if(!banlist)
+    banlist := {};
+  endif
+  var newlist := {};
+  foreach thing in banlist
+    fillname := SystemFindObjectBySerial(thing);
+    if(!fillname)
+      fillname := SystemFindObjectBySerial(thing, SYSFIND_SEARCH_OFFLINE_MOBILES);
+    endif
+    if(fillname)
+      newlist.append(thing);
+      datafriendlist[z+2] := fillname.name;
+      z := z + 1;
+    endif
+  endforeach
+  SetObjProperty(house, "friendlist", newlist);
+  SendDialogGump(who, layoutfriendlist, datafriendlist);
+endfunction
+
+////////////////////////////
+//   banning
+////////////////////////////
+
+function AddBan(house, who, sign)
+  var banlist := GetObjProperty(house, "banlist");
+  if(!banlist)
+    banlist := {};
+  endif
+  if(len(banlist) >= 20)
+    SendSysMessage(who, "The ban list is full.");
+    return;
+  endif
+  SendSysMessage(who,"Select character.");
+  var targetchr := Target(who);
+  if(!targetchr)
+    SendSysMessage(who,"Cancelled.");
+    return;
+  endif
+  if(!targetchr.isA(POLCLASS_MOBILE))
+    SendSysMessage(who,"That cannot be added to the list.");
+    return;
+  endif
+  if(targetchr.serial in banlist)
+    SendSysMessage(who, "That person is already banned.");
+    return;
+  endif
+  if(targetchr.multi.serial == house.serial)
+    if(targetchr.acctname == GetObjProperty(house,"owneracct"))
+      SendSysMessage(who, "You cannot ban yourself.");
+      return;
+    endif
+    checklists(house, targetchr, "friendlist", "coownlist");
+    MoveCharacterToLocation(targetchr, sign.x, sign.y, sign.z);
+    banlist.append(targetchr.serial);
+    SetObjProperty(house, "banlist", banlist);
+    SendSysMessage(who, targetchr.name + " was banned from your house.");
+  else
+    SendSysMessage(who, "That cannot be added to the list.");
+    return;
+  endif
+endfunction
+
+function DeleteBan(house,who)
+  var z := 0;
+  var fillname;
+  var retval1 := 0;
+  var banlist := GetObjProperty(house, "banlist");
+  if(!banlist)
+    banlist := {};
+  endif
+  var newlist := {};
+  foreach thing in banlist
+    fillname := SystemFindObjectBySerial(thing);
+    if(!fillname)
+      fillname := SystemFindObjectBySerial(thing, SYSFIND_SEARCH_OFFLINE_MOBILES);
+    endif
+    if(fillname)
+      newlist.append(thing);
+      databanlift[z+2] := fillname.name;
+      z := z + 1;
+    endif
+  endforeach
+  SetObjProperty(house, "banlist", newlist);
+  retval1 := SendDialogGump(who, layoutbanlift, databanlift);
+  var bancheck, returncheck;
+  if(retval1[0] > 2 && retval1[0] <= 22)
+    returncheck := retval1[0] - 2;
+    bancheck := banlist[returncheck];
+    if(!bancheck)
+      SendSysMessage(who, "There is no ban in that slot.");
+      return;
+    else
+      var newlist := {};
+      foreach thing in banlist
+        if(thing != bancheck)
+          newlist.append(thing);
+        endif
+      endforeach
+      SetObjProperty(house, "banlist", newlist);
+    endif
+  endif
+endfunction
+
+function ListBan(house, who)
+  var z := 0;
+  var fillname;
+  var banlist := GetObjProperty(house, "banlist");
+  if(!banlist)
+    banlist := {};
+  endif
+  var newlist := {};
+  foreach thing in banlist
+    fillname := SystemFindObjectBySerial(thing);
+    if(!fillname)
+      fillname := SystemFindObjectBySerial(thing, SYSFIND_SEARCH_OFFLINE_MOBILES);
+    endif
+    if(fillname)
+      newlist.append(thing);
+      databanlist[z+2] := fillname.name;
+      z := z + 1;
+    endif
+  endforeach
+  SetObjProperty(house, "banlist", newlist);
+  SendDialogGump(who, layoutbanlist, databanlist);
+endfunction
+
+function AddCoowner(house, who)
+  var banlist := GetObjProperty(house, "coownlist");
+  if(!banlist)
+    banlist := {};
+  endif
+  if(len(banlist) >= 20)
+    SendSysMessage(who, "The co-owner list is full.");
+    return;
+  endif
+  SendSysMessage(who,"Select character.");
+  var targetchr := Target(who);
+  if(!targetchr)
+    SendSysMessage(who,"Cancelled.");
+    return;
+  endif
+  if(!targetchr.isA(POLCLASS_MOBILE))
+    SendSysMessage(who,"That cannot be added to the list.");
+    return;
+  endif
+  if(targetchr.serial in banlist)
+    SendSysMessage(who, "That person is already a co-owner.");
+    return;
+  endif
+  if(targetchr.acctname == GetObjProperty(house,"owneracct"))
+    SendSysMessage(who, "Canceled.");
+    return;
+  endif
+  checklists(house, targetchr, "friendlist", "banlist");
+  banlist.append(targetchr.serial);
+  SetObjProperty(house, "coownlist", banlist);
+  SendSysMessage(who, targetchr.name + " was co-owned to your house.");
+endfunction
+
+function DeleteCoowner(house,who)
+  var z := 0;
+  var fillname;
+  var retval1 := 0;
+  var banlist := GetObjProperty(house, "coownlist");
+  if(!banlist)
+    banlist := {};
+  endif
+  var newlist := {};
+  foreach thing in banlist
+    fillname := SystemFindObjectBySerial(thing);
+    if(!fillname)
+      fillname := SystemFindObjectBySerial(thing, SYSFIND_SEARCH_OFFLINE_MOBILES);
+    endif
+    if(fillname)
+      newlist.append(thing);
+      datacownremove[z+2] := fillname.name;
+      z := z + 1;
+    endif
+  endforeach
+  SetObjProperty(house, "coownlist", newlist);
+  retval1 := SendDialogGump(who, layoutcownremove, datacownremove);
+  var bancheck, returncheck;
+  if(retval1[0] > 2 && retval1[0] <= 22)
+    returncheck := retval1[0] - 2;
+    bancheck := banlist[returncheck];
+    if(!bancheck)
+      SendSysMessage(who, "There is no co-owner in that slot.");
+      return;
+    else
+      var newlist := {};
+      foreach thing in banlist
+        if(thing != bancheck)
+          newlist.append(thing);
+        endif
+      endforeach
+      SetObjProperty(house, "coownlist", newlist);
+    endif
+  endif
+endfunction
+
+function ListCoowner(house, who)
+  var z := 0;
+  var fillname;
+  var banlist := GetObjProperty(house, "coownlist");
+  if(!banlist)
+    banlist := {};
+  endif
+  var newlist := {};
+  foreach thing in banlist
+    fillname := SystemFindObjectBySerial(thing);
+    if(!fillname)
+      fillname := SystemFindObjectBySerial(thing, SYSFIND_SEARCH_OFFLINE_MOBILES);
+    endif
+    if(fillname)
+      newlist.append(thing);
+      datacownlist[z+2] := fillname.name;
+      z := z + 1;
+    endif
+  endforeach
+  SetObjProperty(house, "coownlist", newlist);
+  SendDialogGump(who, layoutcownlist, datacownlist);
+endfunction
+
+function ChangeHouseOwner(oldowner, who, house)
+  var oldownerserial:=GetObjProperty(house, "ownerserial");
+  if(oldownerserial == who.serial)
+    return 0;
+  elseif(who.acctname)
+    var chk;
+    var builtdeed := GetObjProperty(house, "builtdeed");
+    if(builtdeed)
+      chk := SystemFindObjectBySerial(builtdeed);
+      if(!chk)
+        chk := SystemFindObjectBySerial(builtdeed, 1);
+      endif
+      if(!chk)
+        chk := SystemFindObjectBySerial(builtdeed, 2);
+      endif
+      if(!chk)
+        SendSysMessage(who, "Error: Could not find built deed. Page a GM.", 3, 40);
+        return 0;
+      endif
+    else
+      SendSysMessage(who, "Error: Could not find built deed. Page a GM.", 3, 40);
+      return 0;
+    endif
+    var hisbank := CP_GetStorageContainerForMobile(who, CP_DEFAULT_AREA, 1);
+    if(!hisbank)
+      SendSysMessage(who,      "House transfer was NOT successful.");
+      SendSysMessage(oldowner, "House transfer was NOT successful.");
+      return 0;
+    endif
+    if(!MoveItemToContainer(builtdeed, hisbank))
+      SendSysMessage(who,      "House transfer was NOT successful.");
+      SendSysMessage(oldowner, "House transfer was NOT successful.");
+      return 0;
+    endif
+    SetObjProperty(house,    "ownerserial", who.serial);
+    SetObjProperty(house,    "owneracct",   who.acctname);
+    SendSysMessage(who,      "House transfer was successful.");
+    SendSysMessage(who,      "It would be wise to change the locks soon.");
+    SendSysMessage(oldowner, "House transfer was successful.");
+    return 1;
+  endif
+  SendSysMessage(who,      "House transfer was NOT successful.");
+  SendSysMessage(oldowner, "House transfer was NOT successful.");
+  return 0;
+endfunction
+
+function DeclarePrivPub(who, house, sign)
+  var public := GetObjProperty(house, "Public");
+  if(public == 1)
+    var check := 0;
+    foreach mob in (house.mobiles)
+      if(mob.npctemplate == "playervendor")
+        check := 1;
+        break;
+      endif
+    endforeach
+    if(check == 1)
+      SendSysMessage(who, "You cannot declare this house private while there are vendors inside.");
+      return;
+    endif
+    foreach thing in (house.components)
+      if(((thing.y == (sign.y - 1)) or (thing.y == (sign.y))) and (thing.isa(POLCLASS_DOOR)))
+        thing.locked := 1;
+        EraseObjProperty(thing, "Public");
+      endif
+    endforeach
+    var signgraph := GetObjProperty(house, "oldsignprop");
+    if(signgraph)
+      sign.graphic := signgraph;
+    endif
+    EraseObjProperty(house, "Public");
+    SetObjProperty(house, "Private", 1);
+    EraseObjProperty(sign, "Public");
+    SetObjProperty(sign, "Private", 1);
+    SendSysMessage(who, "This house is now private. The front doors have been locked, and friends may no longer place vendors here.");
+  else
+    var result := SendDialogGump(who, checklayout, checkdata);
+    if(result[0] == 1)
+      EraseObjProperty(house, "Private");
+      SetObjProperty(house, "Public", 1);
+      EraseObjProperty(sign, "Private");
+      SetObjProperty(sign, "Public", 1);
+      foreach thing in (house.components)
+        if(((thing.y == (sign.y - 1)) or (thing.y == (sign.y))) and (thing.isa(POLCLASS_DOOR)))
+          thing.locked := 0;
+          SetObjProperty(thing, "Public", 1);
+        endif
+      endforeach
+      SendSysMessage(who, "This house is now public. Friends of the house may now place vendors.");
+    else
+      SendSysMessage(who, "Cancelled.");
+    endif
+  endif
+endfunction
+
+function ChangeSign(who, house, sign, result)
+  who := who;
+  var signgraph := result[0];
+  if(sign.graphic == 3024 || sign.graphic == 3026)
+    SetObjProperty(house, "oldsignprop", sign.graphic);
+    sign.graphic := signgraph;
+  else
+    sign.graphic := signgraph;
+  endif
+endfunction
+
+function Eject(house,who,sign)
+  house := house;
+  var targetchr:=Target(who);
+  if((!targetchr.multi) &&(Distance(who,sign)>15))
+    return;
+  endif
+  if(!targetchr)
+    SendSysMessage(who,"Cancelled.");
+    return;
+  endif
+  MoveCharacterToLocation(targetchr,sign.x,sign.y,0,MOVECHAR_FORCELOCATION);
+  SendSysMessage(who,targetchr.name+" was ejected!");
+endfunction
+
+function checklists(house, who, list1, list2)
+  var lista := GetObjProperty(house, list1);
+  var listb := GetObjProperty(house, list2);
+  var newarray := {};
+  if(who.serial in lista)
+    foreach thing in lista
+      if(thing != who.serial)
+        newarray.append(thing);
+      endif
+    endforeach
+    SetObjProperty(house, list1, newarray);
+  endif
+  newarray := {};
+  if(who.serial in listb)
+    foreach thing in listb
+      if(thing != who.serial)
+        newarray.append(thing);
+      endif
+    endforeach
+    SetObjProperty(house, list2, newarray);
+  endif
+endfunction
+
+function demolish(house, sign, who)
+  sign := sign;
+  var lists := GetObjProperty(house, "footage");
+  var itemlist := {};
+  var holder, chk := 0;
+  foreach thing in lists
+    holder := ListObjectsInBox(thing[1], thing[2], thing[3], thing[4], thing[5],thing[6], house.realm);
+    foreach thing in holder
+      itemlist.append(thing);
+    endforeach
+  endforeach
+  foreach thing in itemlist
+    if(thing.objtype == 0xa390)
+      chk := 1;
+      break;
+    endif
+  endforeach
+  foreach npc in (house.mobiles)
+    if(npc.npctemplate == "playervendor")
+      chk := 1;
+      break;
+    endif
+  endforeach
+  if(chk == 1)
+    SendSysMessage(who, "You cannot redeed a house with vendors in it.");
+    return;
+  endif
+  if(chk == 0)
+    var builtdeed := GetObjProperty(house, "builtdeed");
+    if(builtdeed)
+      if(!DestroyItem(SystemFindObjectBySerial(builtdeed)))
+         chk := 2;
+      endif
+    endif
+  endif
+  if(chk == 0)
+    var lockids := {}, id;
+    foreach thing in (house.components)
+      id := GetObjProperty(thing, "lockid");
+      if(id)
+        lockids.append(id);
+      endif
+    endforeach
+    foreach thing in EnumerateItemsInContainer(who.backpack)
+      id := GetObjProperty(thing, "lockid");
+      if(id)
+        if(id in lockids)
+          DestroyItem(thing);
+        endif
+      endif
+    endforeach
+    var bankbox := CP_GetStorageContainerForMobile(who, CP_DEFAULT_AREA, 1);
+    if(bankbox)
+      foreach thing in EnumerateItemsInContainer(bankbox)
+        id := GetObjProperty(thing, "lockid");
+        if(id)
+          if(id in lockids)
+            DestroyItem(thing);
+          endif
+        endif
+      endforeach
+    endif
+    var retdeed := 0;
+    case(house.objtype)
+      0x6060: retdeed := CreateItemInBackpack(who,0x6019,1); //smallstoneandplasterhouse
+      0x6061: retdeed := CreateItemInBackpack(who,0x601a,1); //smallstonehouse
+      0x6062: retdeed := CreateItemInBackpack(who,0x601b,1); //smallwoodenhouse
+      0x6063: retdeed := CreateItemInBackpack(who,0x601c,1); //smallplasterhouse
+      0x6064: retdeed := CreateItemInBackpack(who,0x601d,1); //smallwoodandstrawhouse
+      0x6073: retdeed := CreateItemInBackpack(who,0x601e,1); //smallbrickhouse
+      0x6065: retdeed := CreateItemInBackpack(who,0x6020,1); //largebrickhouse
+      0x6072: retdeed := CreateItemInBackpack(who,0x6026,1); //largepatiohouse
+      0x6066: retdeed := CreateItemInBackpack(who,0x6021,1); //twostorywoodandplasterhouse
+      0x6068: retdeed := CreateItemInBackpack(who,0x6022,1); //twostorystoneandplasterhouse
+      0x6069: retdeed := CreateItemInBackpack(who,0x6023,1); //tower
+      0x6070: retdeed := CreateItemInBackpack(who,0x6024,1); //keep
+      0x6071: retdeed := CreateItemInBackpack(who,0x6025,1); //castle
+      0x6074: retdeed := CreateItemInBackpack(who,0x602D,1); //smalltower
+      0x6075: retdeed := CreateItemInBackpack(who,0x602E,1); //smallmarbleshop
+      0x6076: retdeed := CreateItemInBackpack(who,0x602F,1); //smallstoneshop
+      0x6077: retdeed := CreateItemInBackpack(who,0x6030,1); //largemarblehouse
+      0x6078: retdeed := CreateItemInBackpack(who,0x6031,1); //logcabin
+      0x6079: retdeed := CreateItemInBackpack(who,0x6032,1); //sandstonepatiohouse
+      0x607A: retdeed := CreateItemInBackpack(who,0x6033,1); //twostoryvilla
+    endcase
+    if(retdeed)
+      var tilelist := GetObjProperty(house, "bantiles");
+      foreach thing in tilelist
+        DestroyItem(SystemFindObjectBySerial(thing));
+      endforeach
+      foreach thing in itemlist
+        if((GetObjProperty(thing,"secure") == 1) && (thing.movable == 0))
+          EraseObjProperty(thing,"secure");
+          if(GetObjProperty(thing, "houseserial" ) == house.serial)
+            var oldscript := GetObjProperty(thing, "oldscript");
+            if (oldscript == error)
+              oldscript := "";
+            endif
+            thing.usescript := oldscript;
+            thing.movable := 1;
+            EraseObjProperty(thing, "houseserial" );
+            EraseObjProperty(thing, "oldscript" );
+          endif
+        elseif ((GetObjProperty(thing, "lockeddown" ) == 1) && (thing.movable == 0))
+          thing.movable := 1;
+          EraseObjProperty(thing, "houseserial" );
+          EraseObjProperty(thing, "lockeddown");
+        elseif (thing.movable == 0)
+          if(thing.objtype == 0xa390)
+             MoveItemToLocation(thing, thing.x, thing.y, house.z, MOVEITEM_FORCELOCATION);
+          else
+            DestroyItem(thing);
+          endif
+        endif
+      endforeach
+      DestroyMulti(house);
+    else
+      SendSysMessage(who, "Could not create deed. Your pack may be too full.");
+      return;
+    endif
+  elseif(chk == 2)
+    SendSysMessage(who, "Could not find the built deed, please page a GM.");
+    return;
+  else
+    SendSysMessage(who, "You cannot redeed a house while it has a guildstone.");
+    return;
+  endif
+endfunction
+
+function SetPlaqueName(sign, house)
+  sign := sign;
+  var signname := GetObjProperty(house, "signname");
+  if(!signname)
+    signname := " ";
+  endif
+  var split := SplitWords(signname);
+  var j;
+  for(j := 1; j <= 5; j := j + 1)
+    if(!split[j])
+      split[j] := "";
+    endif
+  endfor
+  if(len(signname) <= 12)
+    data[1] := signname;
+  elseif((len(split[1]) + len(split[2]) + len(split[3]) + 2) <= 12)
+    data[1] := split[1] + " " + split[2] + " " + split[3];
+    data[32] := split[4] + " " + split[5];
+  elseif(len(split[1]) + len(split[2]) + 1 <= 12)
+    data[1] := split[1] + " " + split[2];
+    data[32] := split[3] + " " + split[4] + " " + split[5];
+  elseif(len(split[1]) <= 12)
+    data[1] := split[1];
+    data[32] := split[2] + " " + split[3] + " " + split[4] + " " + split[5];
+  endif
+endfunction
+
+function ChangeLocks(who,house)
+  SendSysMessage(who,"Target the new master key.");
+  var addonitem,newkey:=Target(who);
+  if((newkey.objtype>=KEYSTART) &&(newkey.objtype<=KEYEND) &&(newkey.objtype!=KEYRING))
+    var lockid:=AllocLockId();
+    SetObjProperty(newkey,"lockid",lockid);
+    foreach item in(house.components)
+      if(((item.objtype>=UOBJECT_DOORS_START) &&(item.objtype<=UOBJECT_DOORS_END)))
+        item.locked := 1;
+        SetObjProperty(item,"lockid",lockid);
+      endif
+    endforeach
+    addonitem:=CInt(GetObjProperty(house,"component2"));
+    if(addonitem)
+      addonitem.locked:=1;
+      SetObjProperty(addonitem,"lockid",lockid);
+    endif
+    SendSysMessage(who,"Locks have been changed.");
+  else
+    SendSysMessage(who,"That is not a key!");
+  endif
+endfunction

Added: trunk/096/pkg/multis/housing/signControl.src
===================================================================
--- trunk/096/pkg/multis/housing/signControl.src	2005-11-19 12:53:54 UTC (rev 1016)
+++ trunk/096/pkg/multis/housing/signControl.src	2005-11-19 12:58:15 UTC (rev 1017)
@@ -0,0 +1,483 @@
+use uo;
+use os;
+use basic;
+
+include "include/OLD/eventID";
+include ":attributes:attributes";
+include "include/sysEvent";
+include ":itemutils:objtype";
+
+program SignListener(sign)
+  var house := GetObjProperty(sign, "house_serial");
+  if (house)
+    house := SystemFindObjectBySerial(house);
+  endif
+  if(!house)
+    return;
+  endif
+  RegisterForSpeechEvents(sign, 30);
+  var owneracct, who, ev, decaytime;
+  while(sign)
+    owneracct := GetObjProperty(house,"owneracct");
+    ev := wait_for_event(120);
+    if(ev)
+      who := ev.source;
+      if((who.multi).serial == house.serial)
+        if(who.acctname == owneracct)
+          handle_speech(ev, house, sign, 3);
+        else
+          if(statuscheck(house, who, 1) == 1)
+            handle_speech(ev, house, sign, 2);
+          elseif(statuscheck(house, who, 2) == 1)
+            handle_speech(ev, house, sign, 1);
+          endif
+        endif
+      endif
+    endif
+    decaytime := GetObjProperty(sign,"decay");
+    if(!decaytime)
+      decaytime := (ReadGameClock() + 864000);
+      SetObjProperty(sign, "decay", decaytime);
+    endif
+    if(!GetObjProperty(sign,"nodecay"))
+      var tname;
+      var newname := GetObjProperty(sign,"signname");
+      if(!newname)
+        newname := "a house";
+        SetObjProperty(sign, "signname", newname);
+      endif
+      if (ReadGameClock() > decaytime)
+        demolish(house);
+      elseif((decaytime - ReadGameClock() ) > 861000 )
+        tname := newname + ", [this house is like new]";
+        SetName(sign, tname);
+      elseif((decaytime - ReadGameClock() ) > 604800 )
+        tname := newname + ", [this house is slightly worn]";
+        SetName(sign, tname);
+      elseif((decaytime - ReadGameClock() ) > 259200 )
+        tname := newname + ", [this house is fairly worn]";
+        SetName(sign, tname);
+      elseif((decaytime - ReadGameClock() ) > 86400 )
+        tname := newname + ", [this house is greatly worn]";
+        SetName(sign, tname);
+      else
+        tname := newname + ", [this house is in danger of collapsing]";
+        SetName(sign, tname);
+      endif
+    endif
+    cleareventque();
+  endwhile
+endprogram
+
+function cleareventque()
+  var ev;
+  repeat
+  until(!(ev := os::wait_for_event(0)));
+endfunction
+
+function handle_speech(event, house, sign, sec)
+  var text := lower(event.text );
+  if((text["i wish to lock this down"]) && (sec >= 2))
+    HouseFunction(house, event, 1 );
+  elseif((text["i wish to release this"]) && (sec >= 2))
+    HouseFunction(house, event, 2 );
+  elseif((text["i wish to secure this"]) && (sec >= 2))
+    secure(house, event );
+  elseif((text["i wish to unsecure this"]) && (sec >= 2))
+    unsecure(house, event);
+  elseif((text["remove thyself"]) && (sec >= 1))
+    remove(house, sign, event);
+  elseif((text["i ban thee"]) && (sec >= 1))
+    housebanning(house, event, sign);
+  elseif((text["i wish to place a trash barrel"]) && (sec >= 2))
+    trashbarrel(house, event);
+  elseif(text["reveal thyself"])
+    reveal(house, event);
+  endif
+endfunction
+
+function remove(house, sign, event)
+  var who := event.source;
+  if (who.multi.serial == house.serial)
+    SendSysMessage(who, "Target the person you wish to remove.");
+    var idiot := Target(who, TGTOPT_NOCHECK_LOS);
+    if (!idiot)
+      SendSysMessage(who, "Cancelled.");
+      return;
+    elseif (AP_GetVital(idiot, MANA) == error)
+      SendSysMessage(who,"You cannot eject items.");
+      return;
+    endif
+    if(InHouse(idiot, house))
+      var friend := statuscheck(house, idiot, 2);
+      var coown  := statuscheck(house, idiot, 1);
+      var staff  := who.cmdlevel;
+      if ((coown == 0) && (friend == 0) && (idiot.serial != who.serial) && (staff < 2))
+        MoveCharacterToLocation(idiot, sign.x, sign.y, sign.z, MOVECHAR_FORCELOCATION);
+        SendSysMessage(idiot,"You have been ejected from the house!");
+        return;
+      elseif((friend == 1) || (coown == 1) || (idiot.acctname == GetObjProperty(house,"owneracct")))
+        SendSysMessage(who,"You cannot eject friends.");
+        return;
+      elseif (idiot.serial == who.serial)
+        SendSysMessage(who,"You cannot eject yourself.");
+        return;
+      else
+        SendSysMessage(who,"You cannot do that!");
+      endif
+    else
+      SendSysMessage(who,"That person isn't inside the house.");
+      return;
+    endif
+  else
+    SendSysMessage(who,"You must be in a house to do this.");
+    return;
+  endif
+endfunction
+
+function trashbarrel(house, event)
+  var who := event.source;
+  var barrelcheck := GetObjProperty(house, "barrelserial");
+  if(barrelcheck)
+    var exists := 0;
+    foreach thing in (house.items)
+      if(thing.serial == barrelcheck)
+        exists := 1;
+        break;
+      endif
+    endforeach
+    if(exists == 1)
+      SendSysMessage(who, "This house already has a trash barrel.");
+      return;
+    endif
+  endif
+  var items := ListItemsNearLocation(who.x, who.y, who.z, 1, who.realm);
+  var check := 0;
+  foreach thing in items
+    if(thing.objtype == 0x8889)
+      check := 1;
+    endif
+  endforeach
+  if(check == 0)
+    var barrel := CreateItemAtLocation(who.x, who.y, who.z, 0x7007, 1, who.realm);
+    if(barrel)
+      SetObjProperty(house, "barrelserial", barrel.serial);
+      SetObjProperty(barrel, "houseserial", house.serial);
+    endif
+  else
+    SendSysMessage(who, "You cannot place that here.");
+  endif
+endfunction
+
+function HouseFunction(house, event, num)
+  var itemt := Target(event.source, TGTOPT_NOCHECK_LOS);
+  if(!itemt)
+    SendSysMessage(event.source, "Cancelled.");
+    return;
+  endif
+  var lists := GetObjProperty(house, "footage");
+  var itemlist := {};
+  var holder;
+  foreach thing in lists
+    holder := ListObjectsInBox(thing[1], thing[2], thing[3], thing[4], thing[5],thing[6], house.realm);
+    foreach thing in holder
+      itemlist.append(thing);
+    endforeach
+  endforeach
+  if(itemt in itemlist)
+    case(num)
+      1: if(GetObjProperty(house, "numlockdowns") > 0)
+           if(itemt.movable == 1)
+               itemt.movable := 0;
+               SetObjProperty(itemt, "lockeddown", 1);
+               SetObjProperty(itemt, "houseserial", house.serial);
+               SetObjProperty(house, "numlockdowns", GetObjProperty(house, "numlockdowns") - 1);
+               SendSysMessage(event.source, "Locked Down.");
+           elseif((itemt.movable == 0) && (GetObjProperty(itemt,"lockeddown") ==1))
+             SendSysMessage(event.source, "That item is already locked down!");
+             return;
+           elseif((itemt.movable == 0) && (GetObjProperty(itemt,"secure") ==1))
+             SendSysMessage(event.source, "That item is secure!");
+             return;
+           else
+             SendSysMessage(event.source, "You cannot lock that down!");
+             return;
+           endif
+         else
+           SendSysMessage(event.source, "The house has no more lockdowns remaining.");
+         endif
+      2: if(GetObjProperty(itemt, "lockeddown") && (itemt.movable == 0))
+           if(GetObjProperty(itemt,"secure") ==1)
+             EraseObjProperty(itemt,"secure");
+             var oldscript := GetObjProperty(itemt,"oldscript");
+             if(oldscript == error)
+               oldscript := "";
+             endif
+             itemt.usescript := oldscript;
+             SetObjProperty(house, "numsecure", GetObjProperty(house, "numsecure") + 1);
+             EraseObjProperty(itemt, "oldscript");
+             EraseObjProperty(itemt, "boxserial");
+           endif
+           EraseObjProperty(itemt, "houseserial");
+           itemt.movable := 1;
+           EraseObjProperty(itemt, "lockeddown");
+           SetObjProperty(house, "numlockdowns", GetObjProperty(house, "numlockdowns") + 1);
+           SendSysMessage(event.source, "Released.");
+           return;
+         elseif ((itemt.movable == 0) &&(GetObjProperty(itemt,"secure") ==1))
+           EraseObjProperty(itemt,"secure");
+           var oldscript := GetObjProperty(itemt,"oldscript");
+           if (oldscript == error)
+             oldscript := "";
+           endif
+           itemt.usescript := oldscript;
+           SetObjProperty(house, "numsecure", GetObjProperty(house, "numsecure") + 1);
+           EraseObjProperty(itemt, "houseserial");
+           EraseObjProperty(itemt, "oldscript");
+           itemt.movable := 1;
+           SendSysMessage(event.source, "Released.");
+           return;
+         elseif (itemt.movable == 1)
+           SendSysMessage(event.source, "That is not locked down.");
+           return;
+         else
+           SendSysMessage(event.source, "You cannot release that.");
+           return;
+         endif
+    endcase
+  else
+    SendSysMessage(event.source, "That is not inside your house.");
+  endif
+endfunction
+
+function secure(house, event)
+  var itemt := Target(event.source);
+  if(!itemt)
+    SendSysMessage(event.source, "Cancelled.");
+    return;
+  endif
+  if(GetObjProperty(house, "numsecure"))
+    var lists := GetObjProperty(house, "footage");
+    var itemlist := {};
+    var holder;
+    foreach thing in lists
+      holder := ListObjectsInBox(thing[1], thing[2], thing[3], thing[4], thing[5],thing[6], house.realm);
+      foreach thing in holder
+        itemlist.append(thing);
+      endforeach
+    endforeach
+    if(itemt in itemlist)
+      if(itemt.movable == 0)
+        if(GetObjProperty(itemt,"lockeddown") ==1)
+          SendSysMessage(event.source, "Securing this container. Your house will be credited with one lockdown.");
+          SetObjProperty(house, "numlockdowns", GetObjProperty(house, "numlockdowns") + 1);
+          EraseObjProperty(itemt,"lockeddown");
+        else
+          SendSysMessage(event.source, "You cannot secure that.");
+          return;
+        endif
+      endif
+      itemt.movable := 0;
+      SetObjProperty(itemt, "boxserial", itemt.serial);
+      SetObjProperty(itemt, "houseserial", house.serial);
+      SetObjProperty(itemt, "secure", 1);
+      SetObjProperty(itemt,"oldscript", itemt.script);
+      itemt.usescript := ":housing:secureCont";
+      SetObjProperty(house, "numsecure", GetObjProperty(house, "numsecure") - 1);
+      SendSysMessage(event.source, "Container is secure.");
+    else
+      SendSysMessage(event.source, "That item is not inside your house.");
+    endif
+  else
+    SendSysMessage(event.source, "The house has no more secure containers remaining.");
+  endif
+endfunction
+
+function unsecure(house, event)
+  var itemt := Target(event.source);
+  if(!itemt)
+    SendSysMessage(event.source, "Canceled.");
+    return;
+  endif
+  if (!GetObjProperty(itemt,"secure") ==1)
+    SendSysMessage(event.source,"You cannot unsecure that.");
+    return;
+  endif
+  EraseObjProperty(itemt,"secure");
+  if(GetObjProperty(itemt, "houseserial") == house.serial)
+    var lockdowns := GetObjProperty(house, "numlockdowns");
+    var oldscript := GetObjProperty(itemt,"oldscript");
+    if(oldscript == error)
+      oldscript := "";
+    endif
+    itemt.usescript := oldscript;
+    SetObjProperty(house, "numsecure", GetObjProperty(house, "numsecure") + 1);
+    EraseObjProperty(itemt, "houseserial");
+    EraseObjProperty(itemt, "oldscript");
+    EraseObjProperty(itemt, "boxserial");
+    if(lockdowns > 0)
+      SetObjProperty(itemt, "lockeddown", 1);
+      SetObjProperty(house, "numlockdowns", lockdowns - 1);
+      SendSysMessage(event.source, "The container is locked down and your house has been credited one secure container.");
+    else
+      itemt.movable := 1;
+      SendSysMessage(event.source, "The container is no longer locked down and your house has been credited one secure container.");
+    endif
+  else
+    SendSysMessage(event.source, "That is not in your house.");
+  endif
+endfunction
+
+function housebanning(house, event, sign)
+  var who := event.source;
+  var banlist := GetObjProperty(house, "banlist");
+  if(!banlist)
+    banlist := {};
+  endif
+  if(len(banlist) >= 20)
+    SendSysMessage(event.source, "The ban list is full.");
+    return;
+  endif
+  SendSysMessage(event.source,"Select character.");
+  var idiot := Target(event.source);
+  if(!idiot)
+    SendSysMessage(who, "Cancelled.");
+    return;
+  endif
+  if(!(idiot.isA(POLCLASS_NPC) || idiot.acctname))
+    SendSysMessage(who, "That cannot be added to the list.");
+    return;
+  endif
+  if((InHouse(idiot, house)) or (idiot.multi == house))
+    var friend := statuscheck(house, idiot, 2);
+    var coown  := statuscheck(house, idiot, 1);
+    var banned := statuscheck(house, idiot, 3);
+    var staff  := idiot.cmdlevel;
+    var act    := idiot.acctname;
+    var own    := GetObjProperty(house, "owneracct");
+    if((coown == 0) && (banned == 0) && (friend == 0) && ( act != own) && (idiot.serial != who.serial) && (staff < 2))
+      SendSysMessage(idiot, "You have been ejected from the house!");
+      MoveCharacterToLocation(idiot, sign.x, sign.y, sign.z);
+      banlist.append(idiot.serial);
+      SetObjProperty(house, "banlist", banlist);
+      SendSysMessage(event.source, idiot.name + " was banned from your house.");
+      return;
+    elseif((friend == 1) || (coown == 1) || (act == own))
+      SendSysMessage(who,"You cannot ban friends.");
+      return;
+    elseif(banned == 1)
+      SendSysMessage(who,"That person is already banned.");
+      MoveCharacterToLocation(idiot, sign.x, sign.y, sign.z, MOVECHAR_FORCELOCATION);
+      return;
+    else
+      SendSysMessage(who,"You cannot do that!");
+      return;
+    endif
+  else
+    SendSysMessage(event.source, "That cannot be added to the list.");
+    return;
+  endif
+endfunction
+
+function InHouse(who, house)
+  var lists := GetObjProperty(house, "footage");
+  var holder := 0;
+  foreach thing in lists
+    foreach thing in ListObjectsInBox(thing[1], thing[2], thing[3], thing[4], thing[5],thing[6], house.realm)
+      if(thing == who)
+        holder := 1;
+        break;
+      endif
+    endforeach
+    if(holder == 1)
+      break;
+    endif
+  endforeach
+  return holder;
+endfunction
+
+function demolish(house)
+  // Find the bantiles and ladders to make sure they get destroyed
+  var bantiles := GetObjProperty(house, "bantiles");
+  var thetile;
+  foreach entry in bantiles
+    thetile := SystemFindObjectBySerial(entry);
+    destroyitem(thetile);
+  endforeach
+  var lists := GetObjProperty(house, "footage");
+  var itemlist := {};
+  foreach entry in lists
+    foreach thing in ListObjectsInBox(entry[1], entry[2], entry[3], entry[4], entry[5],entry[6], house.realm)
+      itemlist.append(thing);
+    endforeach
+  endforeach
+  var builtdeed := GetObjProperty(house, "builtdeed");
+  if(builtdeed)
+    if(!DestroyItem(SystemFindObjectBySerial(builtdeed)))
+      DestroyItem(SystemFindObjectBySerial(builtdeed, 1));
+    endif
+  endif
+  foreach thing in itemlist
+    if(GetObjProperty(thing, "houseserial") == house.serial)
+      if ((GetObjProperty(thing, "secure") == 1) && (thing.movable == 0))
+        EraseObjProperty(thing, "secure");
+        if(GetObjProperty(thing, "houseserial" ) == house.serial)
+          var oldscript := GetObjProperty(thing, "oldscript");
+          if (oldscript == error)
+            oldscript := "";
+          endif
+          thing.usescript := oldscript;
+          thing.movable := 1;
+          EraseObjProperty(thing, "houseserial" );
+          EraseObjProperty(thing, "oldscript" );
+        endif
+      elseif ((GetObjProperty(thing, "lockeddown" ) == 1) && (thing.movable == 0))
+        thing.movable := 1;
+        EraseObjProperty(thing, "houseserial");
+        EraseObjProperty(thing, "lockeddown");
+      elseif (thing.movable == 0)
+        if(thing.objtype == 0xa390)
+           MoveItemToLocation(thing, thing.x, thing.y, (thing.z - 7), MOVEITEM_FORCELOCATION);
+        else
+          DestroyItem(thing);
+        endif
+      endif
+    endif
+  endforeach
+  DestroyMulti(house );
+  return;
+endfunction
+
+function statuscheck(house, who, type)
+  var nfo := {};
+  case(type)
+    1: nfo := GetObjProperty(house, "coownlist");
+    2: nfo := GetObjProperty(house, "friendlist");
+    3: nfo := GetObjProperty(house, "banlist");
+  endcase
+  if(who.serial in nfo)
+    return 1;
+  else
+    return 0;
+  endif
+endfunction
+
+function reveal(house, event)
+  var lists := GetObjProperty(house, "footage");
+  var holder := 0;
+  foreach thing in lists
+    foreach thing in ListObjectsInBox(thing[1], thing[2], thing[3], thing[4], thing[5],thing[6], house.realm)
+      if((AP_GetStat(thing, STRENGTH)) and (thing.hidden))
+        thing.hidden := 0;
+        holder := holder + 1;
+      endif
+    endforeach
+  endforeach
+  if(!holder)
+    SendSysMessage(event.source, "You didn't find anyone.");
+  elseif(holder == 1)
+    PrintTextAbovePrivate(event.source, "You have found one person hiding!", event.source);
+  else
+    PrintTextAbovePrivate(event.source, "You have found " + holder + " people hiding!", event.source);
+  endif
+endfunction
\ No newline at end of file



From austin at berlios.de  Sat Nov 19 14:01:58 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:01:58 +0100
Subject: [Poldistro-svn] r1018 - trunk/096/pkg/commands
Message-ID: <200511191301.jAJD1waS026545@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:01:56 +0100 (Sat, 19 Nov 2005)
New Revision: 1018

Removed:
   trunk/096/pkg/commands/onDelete.src
Log:
Deleting... to rename 
onDelete wont work in linux. Has to be 'ondelete'

Deleted: trunk/096/pkg/commands/onDelete.src
===================================================================
--- trunk/096/pkg/commands/onDelete.src	2005-11-19 12:58:15 UTC (rev 1017)
+++ trunk/096/pkg/commands/onDelete.src	2005-11-19 13:01:56 UTC (rev 1018)
@@ -1,21 +0,0 @@
-/* $Id$
- *
- */
-use datafile;
-
-include ":datafile:datafile";
-
-program commands_onDelete(who)
-
-	if( who.cmdlevel > 1 )
-		var go_data_gumps := DFOpenDataFile(":commands:GoGumps", DF_NO_CREATE);
-		var go_data_file  := DFOpenDataFile(":commands:GoFile", DF_NO_CREATE);
-		var go_elem       := DFFindElement(go_data_file, "GoList", DF_NO_CREATE);
-		var go_gump_elem  := DFFindElement(go_data_gumps, "LocationIndex", DF_NO_CREATE);
-		go_elem.EraseProp(who.acctname);
-		go_gump_elem.EraseProp(who.acctname);
-	endif
-
-	return 1;
-
-endprogram



From austin at berlios.de  Sat Nov 19 14:03:23 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:03:23 +0100
Subject: [Poldistro-svn] r1019 - trunk/096/pkg/commands
Message-ID: <200511191303.jAJD3Np1027319@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:03:15 +0100 (Sat, 19 Nov 2005)
New Revision: 1019

Added:
   trunk/096/pkg/commands/ondelete.src
Log:


Added: trunk/096/pkg/commands/ondelete.src
===================================================================
--- trunk/096/pkg/commands/ondelete.src	2005-11-19 13:01:56 UTC (rev 1018)
+++ trunk/096/pkg/commands/ondelete.src	2005-11-19 13:03:15 UTC (rev 1019)
@@ -0,0 +1,21 @@
+/* $Id: onDelete.src 661 2005-10-26 15:39:23Z muaddiblsd $
+ *
+ */
+use datafile;
+
+include ":datafile:datafile";
+
+program commands_onDelete(who)
+
+	if( who.cmdlevel > 1 )
+		var go_data_gumps := DFOpenDataFile(":commands:GoGumps", DF_NO_CREATE);
+		var go_data_file  := DFOpenDataFile(":commands:GoFile", DF_NO_CREATE);
+		var go_elem       := DFFindElement(go_data_file, "GoList", DF_NO_CREATE);
+		var go_gump_elem  := DFFindElement(go_data_gumps, "LocationIndex", DF_NO_CREATE);
+		go_elem.EraseProp(who.acctname);
+		go_gump_elem.EraseProp(who.acctname);
+	endif
+
+	return 1;
+
+endprogram



From austin at berlios.de  Sat Nov 19 14:05:43 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:05:43 +0100
Subject: [Poldistro-svn] r1020 - trunk/096/pkg/items/containers
Message-ID: <200511191305.jAJD5hXB028099@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:05:23 +0100 (Sat, 19 Nov 2005)
New Revision: 1020

Removed:
   trunk/096/pkg/items/containers/onDelete.src
Log:


Deleted: trunk/096/pkg/items/containers/onDelete.src
===================================================================
--- trunk/096/pkg/items/containers/onDelete.src	2005-11-19 13:03:15 UTC (rev 1019)
+++ trunk/096/pkg/items/containers/onDelete.src	2005-11-19 13:05:23 UTC (rev 1020)
@@ -1,21 +0,0 @@
-/*
- * $Id$
- *
- * Purpose:
- * When a player character is deleted this will remove all of its storage areas. 
- *
- */
-use uo;
-use file;
-
-include ":containers:storageAreas";
-
-program OnDelete(who)
-	var box_id := CP_GetMobileContainerID(who);
-	foreach area_name in ( CP_GetStorageAreaNames() )
-		LogToFile("::log/onDelete.log", "Deleting bank box in storage area ["+area_name+"] for character "+who.name+" ("+Hex(who.serial)+")", LOG_DATETIME);
-		CP_RemoveStorageAreaContainer(box_id, area_name);
-	endforeach
-	
-	return 1;
-endprogram
\ No newline at end of file



From austin at berlios.de  Sat Nov 19 14:07:51 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:07:51 +0100
Subject: [Poldistro-svn] r1021 - trunk/096/pkg/items/containers
Message-ID: <200511191307.jAJD7pn3028733@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:07:49 +0100 (Sat, 19 Nov 2005)
New Revision: 1021

Added:
   trunk/096/pkg/items/containers/ondelete.src
Log:


Added: trunk/096/pkg/items/containers/ondelete.src
===================================================================
--- trunk/096/pkg/items/containers/ondelete.src	2005-11-19 13:05:23 UTC (rev 1020)
+++ trunk/096/pkg/items/containers/ondelete.src	2005-11-19 13:07:49 UTC (rev 1021)
@@ -0,0 +1,21 @@
+/*
+ * $Id: onDelete.src 1005 2005-11-15 09:20:06Z muaddiblsd $
+ *
+ * Purpose:
+ * When a player character is deleted this will remove all of its storage areas. 
+ *
+ */
+use uo;
+use file;
+
+include ":containers:storageAreas";
+
+program OnDelete(who)
+	var box_id := CP_GetMobileContainerID(who);
+	foreach area_name in ( CP_GetStorageAreaNames() )
+		LogToFile("::log/onDelete.log", "Deleting bank box in storage area ["+area_name+"] for character "+who.name+" ("+Hex(who.serial)+")", LOG_DATETIME);
+		CP_RemoveStorageAreaContainer(box_id, area_name);
+	endforeach
+	
+	return 1;
+endprogram
\ No newline at end of file



From austin at berlios.de  Sat Nov 19 14:09:58 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:09:58 +0100
Subject: [Poldistro-svn] r1022 - trunk/096/pkg/mobiles/newCharacter
Message-ID: <200511191309.jAJD9w7v028981@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:09:30 +0100 (Sat, 19 Nov 2005)
New Revision: 1022

Removed:
   trunk/096/pkg/mobiles/newCharacter/onCreate.src
   trunk/096/pkg/mobiles/newCharacter/onDelete.src
Log:


Deleted: trunk/096/pkg/mobiles/newCharacter/onCreate.src
===================================================================
--- trunk/096/pkg/mobiles/newCharacter/onCreate.src	2005-11-19 13:07:49 UTC (rev 1021)
+++ trunk/096/pkg/mobiles/newCharacter/onCreate.src	2005-11-19 13:09:30 UTC (rev 1022)
@@ -1,111 +0,0 @@
-/*
- * $Id$
- *
- */
-
-use uo;
-use os;
-use file;
-use cfgfile;
-
-include ":attributes:attributes";
-include ":attributes:attributes_ex";
-include ":newcharacter:newCharacter";
-
-program OnCreate(params)
-	var who := params[1];
-	var selected_skills := params[2];
-	params := 0; // No longer needed.
-	
-	// Convert skill ID numbers to attribute names.
-	// Core currently sends them as skill IDs!
-	foreach skill in ( selected_skills )
-		skill := AP_SkillIdToAttributeName(skill);
-		sleepms(2);
-	endforeach
-	
-	// Save the chosen skills.
-	NC_SetStartupSkills(who, selected_skills);
-	
-	var uniques := array{};
-	GenerateItemsForSkill(who, "All", uniques);
-	foreach skill in ( selected_skills )
-		GenerateItemsForSkill(who, skill, uniques);
-		sleepms(2);
-	endforeach
-
-	return 1;
-endprogram
-
-function GenerateItemsForSkill(who, attribute, byref uniques)
-	var cfg_file := ReadConfigFile(":newcharacter:config/startEquip");
-	var cfg_elem := cfg_file[attribute];
-	
-	CreateItemsInElem(cfg_elem, who.backpack, "All");
-	
-	foreach entry in ( GetConfigStringArray(cfg_elem, "Unique") )
-		entry := ParseItemString(entry);
-		var objtype := GetObjTypeByName(entry.name);
-		if ( !(objtype in uniques) )
-			uniques.Append(objtype);
-			CreateItemInContainer(who.backpack, entry.name, entry.amount);
-		endif
-		sleepms(2);
-	endforeach
-	
-	foreach entry in ( GetConfigStringArray(cfg_elem, "Random") )
-		entry := SplitWords(entry);
-		var tmp_elem := cfg_file[entry[1]];
-		var amount := CInt(entry[2]);
-		
-		CreateItemsInElem(tmp_elem, who.backpack, amount);
-		sleepms(2);
-	endforeach
-	
-	return 1;
-endfunction
-
-function CreateItemsInElem(cfg_elem, container, amount)
-	var items := GetConfigStringArray(cfg_elem, "Item");
-	if ( amount == "All" )
-		foreach entry in ( GetConfigStringArray(cfg_elem, "Item") )
-			entry := ParseItemString(entry);
-			CreateItemInContainer(container, entry.name, entry.amount);
-			sleepms(2);
-		endforeach
-	else
-		for ( amount; amount>0; amount:=amount-1 )
-			var entry := items[RandomInt(items.Size())+1];
-			entry := ParseItemString(entry);
-			CreateItemInContainer(container, entry.name, entry.amount);
-			sleepms(2);
-		endfor
-	endif
-	
-	return 1;
-endfunction	
-
-function CreateItemFromElem(who, byref cfg_elem)
-	var item_list := GetConfigStringArray(cfg_elem, "Item");
-	var entry := item_list[RandomInt(item_list.Size())+1];
-	entry := SplitWords(entry);
-	
-	var item := CreateItemInBackPack(who, CInt(entry[1]), entry[2]);
-	if ( item.errortext )
-		SendSysMessage(who, "Error creating "+entry+" ->"+item.errortext);
-	endif
-	
-	return item;
-endfunction
-
-function ParseItemString(line)
-	line := SplitWords(line);
-	var name := CStr(line[1]);
-	var amount := RandomDiceRoll(CStr(line[2]));
-	
-	var result := struct;
-	result.+name := name;
-	result.+amount := CInt(amount);
-	
-	return result;
-endfunction

Deleted: trunk/096/pkg/mobiles/newCharacter/onDelete.src
===================================================================
--- trunk/096/pkg/mobiles/newCharacter/onDelete.src	2005-11-19 13:07:49 UTC (rev 1021)
+++ trunk/096/pkg/mobiles/newCharacter/onDelete.src	2005-11-19 13:09:30 UTC (rev 1022)
@@ -1,13 +0,0 @@
-/*
- * $Id$
- *
- */
-
-include ":newcharacter:newCharacter";
-
-program OnDelete(who)
-	var data_file := NC_GetDataFile();
-	data_file.DeleteElement(Hex(who.serial));
-	
-	return 1;
-endprogram



From austin at berlios.de  Sat Nov 19 14:11:10 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:11:10 +0100
Subject: [Poldistro-svn] r1023 - trunk/096/pkg/mobiles/newCharacter
Message-ID: <200511191311.jAJDBAll029450@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:11:01 +0100 (Sat, 19 Nov 2005)
New Revision: 1023

Added:
   trunk/096/pkg/mobiles/newCharacter/oncreate.src
   trunk/096/pkg/mobiles/newCharacter/ondelete.src
Log:


Added: trunk/096/pkg/mobiles/newCharacter/oncreate.src
===================================================================
--- trunk/096/pkg/mobiles/newCharacter/oncreate.src	2005-11-19 13:09:30 UTC (rev 1022)
+++ trunk/096/pkg/mobiles/newCharacter/oncreate.src	2005-11-19 13:11:01 UTC (rev 1023)
@@ -0,0 +1,111 @@
+/*
+ * $Id: onCreate.src 1005 2005-11-15 09:20:06Z muaddiblsd $
+ *
+ */
+
+use uo;
+use os;
+use file;
+use cfgfile;
+
+include ":attributes:attributes";
+include ":attributes:attributes_ex";
+include ":newcharacter:newCharacter";
+
+program OnCreate(params)
+	var who := params[1];
+	var selected_skills := params[2];
+	params := 0; // No longer needed.
+	
+	// Convert skill ID numbers to attribute names.
+	// Core currently sends them as skill IDs!
+	foreach skill in ( selected_skills )
+		skill := AP_SkillIdToAttributeName(skill);
+		sleepms(2);
+	endforeach
+	
+	// Save the chosen skills.
+	NC_SetStartupSkills(who, selected_skills);
+	
+	var uniques := array{};
+	GenerateItemsForSkill(who, "All", uniques);
+	foreach skill in ( selected_skills )
+		GenerateItemsForSkill(who, skill, uniques);
+		sleepms(2);
+	endforeach
+
+	return 1;
+endprogram
+
+function GenerateItemsForSkill(who, attribute, byref uniques)
+	var cfg_file := ReadConfigFile(":newcharacter:config/startEquip");
+	var cfg_elem := cfg_file[attribute];
+	
+	CreateItemsInElem(cfg_elem, who.backpack, "All");
+	
+	foreach entry in ( GetConfigStringArray(cfg_elem, "Unique") )
+		entry := ParseItemString(entry);
+		var objtype := GetObjTypeByName(entry.name);
+		if ( !(objtype in uniques) )
+			uniques.Append(objtype);
+			CreateItemInContainer(who.backpack, entry.name, entry.amount);
+		endif
+		sleepms(2);
+	endforeach
+	
+	foreach entry in ( GetConfigStringArray(cfg_elem, "Random") )
+		entry := SplitWords(entry);
+		var tmp_elem := cfg_file[entry[1]];
+		var amount := CInt(entry[2]);
+		
+		CreateItemsInElem(tmp_elem, who.backpack, amount);
+		sleepms(2);
+	endforeach
+	
+	return 1;
+endfunction
+
+function CreateItemsInElem(cfg_elem, container, amount)
+	var items := GetConfigStringArray(cfg_elem, "Item");
+	if ( amount == "All" )
+		foreach entry in ( GetConfigStringArray(cfg_elem, "Item") )
+			entry := ParseItemString(entry);
+			CreateItemInContainer(container, entry.name, entry.amount);
+			sleepms(2);
+		endforeach
+	else
+		for ( amount; amount>0; amount:=amount-1 )
+			var entry := items[RandomInt(items.Size())+1];
+			entry := ParseItemString(entry);
+			CreateItemInContainer(container, entry.name, entry.amount);
+			sleepms(2);
+		endfor
+	endif
+	
+	return 1;
+endfunction	
+
+function CreateItemFromElem(who, byref cfg_elem)
+	var item_list := GetConfigStringArray(cfg_elem, "Item");
+	var entry := item_list[RandomInt(item_list.Size())+1];
+	entry := SplitWords(entry);
+	
+	var item := CreateItemInBackPack(who, CInt(entry[1]), entry[2]);
+	if ( item.errortext )
+		SendSysMessage(who, "Error creating "+entry+" ->"+item.errortext);
+	endif
+	
+	return item;
+endfunction
+
+function ParseItemString(line)
+	line := SplitWords(line);
+	var name := CStr(line[1]);
+	var amount := RandomDiceRoll(CStr(line[2]));
+	
+	var result := struct;
+	result.+name := name;
+	result.+amount := CInt(amount);
+	
+	return result;
+endfunction

Added: trunk/096/pkg/mobiles/newCharacter/ondelete.src
===================================================================
--- trunk/096/pkg/mobiles/newCharacter/ondelete.src	2005-11-19 13:09:30 UTC (rev 1022)
+++ trunk/096/pkg/mobiles/newCharacter/ondelete.src	2005-11-19 13:11:01 UTC (rev 1023)
@@ -0,0 +1,13 @@
+/*
+ * $Id: onDelete.src 1005 2005-11-15 09:20:06Z muaddiblsd $
+ *
+ */
+
+include ":newcharacter:newCharacter";
+
+program OnDelete(who)
+	var data_file := NC_GetDataFile();
+	data_file.DeleteElement(Hex(who.serial));
+	
+	return 1;
+endprogram



From austin at berlios.de  Sat Nov 19 14:13:44 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:13:44 +0100
Subject: [Poldistro-svn] r1024 - trunk/096/pkg/packetHooks/CharProfile
Message-ID: <200511191313.jAJDDiT6030265@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:13:33 +0100 (Sat, 19 Nov 2005)
New Revision: 1024

Removed:
   trunk/096/pkg/packetHooks/CharProfile/onDelete.src
Log:


Deleted: trunk/096/pkg/packetHooks/CharProfile/onDelete.src
===================================================================
--- trunk/096/pkg/packetHooks/CharProfile/onDelete.src	2005-11-19 13:11:01 UTC (rev 1023)
+++ trunk/096/pkg/packetHooks/CharProfile/onDelete.src	2005-11-19 13:13:33 UTC (rev 1024)
@@ -1,17 +0,0 @@
-/* $Id: onDelete.src 661 2005-10-26 15:39:23Z muaddiblsd $
- *
- */
-use datafile;
-
-include ":datafile:datafile";
-
-program charProfile_onDelete(who)
-
-	var cp_data_file  := DFOpenDataFile(":charprofile:CPFile", DF_NO_CREATE);
-	if( cp_data_file )
-		return cp_data_file.DeleteElement(who.serial);
-	endif
-
-	return 1;
-
-endprogram



From austin at berlios.de  Sat Nov 19 14:15:58 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:15:58 +0100
Subject: [Poldistro-svn] r1025 - trunk/096/pkg/packetHooks/CharProfile
Message-ID: <200511191315.jAJDFwre031407@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:15:56 +0100 (Sat, 19 Nov 2005)
New Revision: 1025

Added:
   trunk/096/pkg/packetHooks/CharProfile/ondelete.src
Log:


Added: trunk/096/pkg/packetHooks/CharProfile/ondelete.src
===================================================================
--- trunk/096/pkg/packetHooks/CharProfile/ondelete.src	2005-11-19 13:13:33 UTC (rev 1024)
+++ trunk/096/pkg/packetHooks/CharProfile/ondelete.src	2005-11-19 13:15:56 UTC (rev 1025)
@@ -0,0 +1,17 @@
+/* $Id: onDelete.src 891 2005-11-04 06:29:43Z muaddiblsd $
+ *
+ */
+use datafile;
+
+include ":datafile:datafile";
+
+program charProfile_onDelete(who)
+
+	var cp_data_file  := DFOpenDataFile(":charprofile:CPFile", DF_NO_CREATE);
+	if( cp_data_file )
+		return cp_data_file.DeleteElement(who.serial);
+	endif
+
+	return 1;
+
+endprogram



From austin at berlios.de  Sat Nov 19 14:36:47 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:36:47 +0100
Subject: [Poldistro-svn] r1026 - trunk/096/scripts/misc
Message-ID: <200511191336.jAJDalr8009891@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:36:45 +0100 (Sat, 19 Nov 2005)
New Revision: 1026

Removed:
   trunk/096/scripts/misc/equipTest.src
   trunk/096/scripts/misc/unequipTest.src
Modified:
   trunk/096/scripts/misc/oncreate.src
Log:
More case fixings.

Deleted: trunk/096/scripts/misc/equipTest.src
===================================================================
--- trunk/096/scripts/misc/equipTest.src	2005-11-19 13:15:56 UTC (rev 1025)
+++ trunk/096/scripts/misc/equipTest.src	2005-11-19 13:36:45 UTC (rev 1026)
@@ -1,38 +0,0 @@
-use uo;
-use os;
-
-include "include/equipment";
-
-program EquipTest(mobile, item, start_up)
-	var retval;
-	
-	if ( start_up )
-		// POL is starting up, yes the mobile can equip it
-		retval := 1;
-	elseif ( mobile.npctemplate )
-		// NPCs can wear anything
-		retval := 1;
-	elseif ( mobile.cmdlevel )
-		// CmdLevel > 0 can equip anything.
-		retval := 1;
-	elseif ( item.isa(POLCLASS_CONTAINER) )	
-		// Makes backpacks always equippable.
-		retval := 1;
-	elseif ( (mobile.frozen) || (mobile.paralyzed) )
-		// Frozen players cant equip stuff
-		SendSysMessage(mobile, "You are unable to move in order to equip that.");
-		retval := 0;
-	else
-		retval := 1;
-	endif
-	
-	if ( retval )
-		SetObjProperty(item, "#EquippedOn", mobile.serial);
-		ApplyEquipmentMods(mobile, item);
-	else
-		// Unable to equip but no reaso was given above. 
-		SendSysMessage(mobile, "Unable to equip ->"+item.desc);
-	endif
-	
-	return retval;
-endprogram

Modified: trunk/096/scripts/misc/oncreate.src
===================================================================
--- trunk/096/scripts/misc/oncreate.src	2005-11-19 13:15:56 UTC (rev 1025)
+++ trunk/096/scripts/misc/oncreate.src	2005-11-19 13:36:45 UTC (rev 1026)
@@ -11,10 +11,10 @@
 
 
 program core_onCreate(who, skillids)
-	var script := Start_Script(":newcharacter:onCreate", {who, skillids});
+	var script := Start_Script(":newcharacter:oncreate", {who, skillids});
 	
 	if ( script.errortext )
-		SysLog("Error - Unable to start :newcharacter:onCreate ->"+script.errortext);
+		SysLog("Error - Unable to start :newcharacter:oncreate ->"+script.errortext);
 		return 0;
 	endif
 	

Deleted: trunk/096/scripts/misc/unequipTest.src
===================================================================
--- trunk/096/scripts/misc/unequipTest.src	2005-11-19 13:15:56 UTC (rev 1025)
+++ trunk/096/scripts/misc/unequipTest.src	2005-11-19 13:36:45 UTC (rev 1026)
@@ -1,19 +0,0 @@
-use uo;
-use os;
-
-include "include/equipment";
-
-program UnequipTest(mobile, item)
-	if ( mobile.cmdlevel ) 
-		return 1;
-	elseif ( (mobile.frozen) || (mobile.paralyzed))
-		SendSysMessage(mobile, "You are unable to move in order to unequip that.");
-		return 0;
-	elseif ( GetObjProperty(item, "cursed") )
-		return 0;
-	else
-		RemoveEquipmentMods(mobile, item);
-		EraseObjProperty(item, "#EquippedOn");
-		return 1;
-	endif
-endprogram
\ No newline at end of file



From austin at berlios.de  Sat Nov 19 14:38:22 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:38:22 +0100
Subject: [Poldistro-svn] r1027 - trunk/096/scripts/misc
Message-ID: <200511191338.jAJDcMxs010830@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:38:08 +0100 (Sat, 19 Nov 2005)
New Revision: 1027

Added:
   trunk/096/scripts/misc/equiptest.src
   trunk/096/scripts/misc/unequiptest.src
Log:


Added: trunk/096/scripts/misc/equiptest.src
===================================================================
--- trunk/096/scripts/misc/equiptest.src	2005-11-19 13:36:45 UTC (rev 1026)
+++ trunk/096/scripts/misc/equiptest.src	2005-11-19 13:38:08 UTC (rev 1027)
@@ -0,0 +1,38 @@
+use uo;
+use os;
+
+include "include/equipment";
+
+program EquipTest(mobile, item, start_up)
+	var retval;
+	
+	if ( start_up )
+		// POL is starting up, yes the mobile can equip it
+		retval := 1;
+	elseif ( mobile.npctemplate )
+		// NPCs can wear anything
+		retval := 1;
+	elseif ( mobile.cmdlevel )
+		// CmdLevel > 0 can equip anything.
+		retval := 1;
+	elseif ( item.isa(POLCLASS_CONTAINER) )	
+		// Makes backpacks always equippable.
+		retval := 1;
+	elseif ( (mobile.frozen) || (mobile.paralyzed) )
+		// Frozen players cant equip stuff
+		SendSysMessage(mobile, "You are unable to move in order to equip that.");
+		retval := 0;
+	else
+		retval := 1;
+	endif
+	
+	if ( retval )
+		SetObjProperty(item, "#EquippedOn", mobile.serial);
+		ApplyEquipmentMods(mobile, item);
+	else
+		// Unable to equip but no reaso was given above. 
+		SendSysMessage(mobile, "Unable to equip ->"+item.desc);
+	endif
+	
+	return retval;
+endprogram

Added: trunk/096/scripts/misc/unequiptest.src
===================================================================
--- trunk/096/scripts/misc/unequiptest.src	2005-11-19 13:36:45 UTC (rev 1026)
+++ trunk/096/scripts/misc/unequiptest.src	2005-11-19 13:38:08 UTC (rev 1027)
@@ -0,0 +1,19 @@
+use uo;
+use os;
+
+include "include/equipment";
+
+program UnequipTest(mobile, item)
+	if ( mobile.cmdlevel ) 
+		return 1;
+	elseif ( (mobile.frozen) || (mobile.paralyzed))
+		SendSysMessage(mobile, "You are unable to move in order to unequip that.");
+		return 0;
+	elseif ( GetObjProperty(item, "cursed") )
+		return 0;
+	else
+		RemoveEquipmentMods(mobile, item);
+		EraseObjProperty(item, "#EquippedOn");
+		return 1;
+	endif
+endprogram
\ No newline at end of file



From austin at berlios.de  Sat Nov 19 14:40:22 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:40:22 +0100
Subject: [Poldistro-svn] r1028 - trunk/096/scripts
Message-ID: <200511191340.jAJDeMTM011772@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:40:17 +0100 (Sat, 19 Nov 2005)
New Revision: 1028

Removed:
   trunk/096/scripts/doRes.src
   trunk/096/scripts/storageWipe.src
   trunk/096/scripts/testFile.esc
Log:


Deleted: trunk/096/scripts/doRes.src
===================================================================
--- trunk/096/scripts/doRes.src	2005-11-19 13:38:08 UTC (rev 1027)
+++ trunk/096/scripts/doRes.src	2005-11-19 13:40:17 UTC (rev 1028)
@@ -1,50 +0,0 @@
-use uo;
-use os;
-
-include "include/OLD/resurrection";
-include "include/client";
-//include "include/poisons";
-
-const SOUND_EFFECT_RES := 0x215;
-const ACTION_EFFECT_CAST2 := 0x11;
-
-
-program do_res(parms)
-
-	var who := parms[1];
-	var mobile := parms[2];
-
-	if( ((who.npctemplate == "healer") || (who.npctemplate == "townhealer") ||
-	(who.npctemplate == "wanderinghealer")) && (mobile.criminal) )
-		PrintTextAbove(who, "I will not aid a criminal.");
-		return 0;
-	endif
-	if( (mobile.dead) && (CheckLineOfSight(who, mobile)) )
-		set_critical(1);
-		if( GetObjProperty(mobile, "#ResMenu") )
-			return 0;
-		endif
-		SetObjProperty(mobile, "#ResMenu", 1);
-		set_critical(0);
-		if( ResNow(mobile) == 1 )
-			PrintTextAbove(who, "Live again by the Virtues!");
-			PerformAction(who, ACTION_EFFECT_CAST2);
-			PlaySoundEffect(who, SOUND_EFFECT_RES);
-			Resurrect(mobile);
-			MurdererStatLoss(mobile);
-		endif
-		EraseObjProperty(mobile, "#ResMenu");
-//	elseif( GetPoisonByType(who, "DefaultPoison").size() > 0 )
-//		if( CheckLineOfSight(who, mobile) )
-//			PrintTextAbove(who, "Sacrifice Purifies the Body and Soul!");
-//			PerformAction(who, ANIM_CAST_AREA);
-//			FakeDeath(who);
-//			sleep(1);
-//			PlayObjectCenteredEffect(mobile, FX_BLESS_EFFECT, 10,10);
-//			SendSysMessage(mobile, who.name + " has cured you completely!");
-//		endif
-	endif
-
-	return 1;
-
-endprogram

Deleted: trunk/096/scripts/storageWipe.src
===================================================================
--- trunk/096/scripts/storageWipe.src	2005-11-19 13:38:08 UTC (rev 1027)
+++ trunk/096/scripts/storageWipe.src	2005-11-19 13:40:17 UTC (rev 1028)
@@ -1,62 +0,0 @@
-use os;
-use uo;
-
-program storagewipe()
-
-	// without list line it runs fast, goes RunAway, makes megalag.
-	set_critical(0);
-
-	var endnum, npctest;
-	var startnum := CInt( GetGlobalProperty("storagestart") );
-
-	if (!startnum)
-		startnum := 1;
-		SetGlobalProperty("storagestart", startnum);
-	endif
-
-	if (GetGlobalProperty("storageend"))
-	EraseGlobalProperty("storageend");
-	endif
-
-	npctest := CreateNpcFromTemplate( "banker", 5445, 1153, 0, "britannia" ); //FIXME realms
-	endnum := npctest.serial;
-	RevokePrivilege( npctest, "invul" );
-	SetObjProperty(npctest, "guardkill", 1);
-	ApplyRawDamage( npctest, 510 );
-
-	print("Wiping orphaned storage locations");
-	var tamedstorage, merchantstorage, inv_fs, inv_pb, inv_1c;
-	tamedstorage := FindStorageArea( "Tamed Storage" );
-	merchantstorage := FindStorageArea( "Merchant Storage" );
-
-	var containername;
-	var num := 0;
-	var mercs := 0;
-	var i;
-	for (i := startnum; i < endnum; i:= i + 1)
-		//without list line it runs fast, goes RunAway, makes megalag.
-		sleepms(250);
-		if (!SystemFindObjectBySerial(i))
-			inv_fs := i + " FS";
-			inv_pb := i + " PB";
-			inv_1c := i + " 1C";
-			containername := "Bankbox  " + Hex(i);
-			if (DestroyRootItemInStorageArea( tamedstorage, containername))
-				num := num + 1;
-				print("Tamed Storage destroyed for "+i);
-			endif
-			if (DestroyRootItemInStorageArea( merchantstorage, inv_fs))
-				DestroyRootItemInStorageArea( merchantstorage, inv_pb);
-				DestroyRootItemInStorageArea( merchantstorage, inv_1c);
-				print("Merchant Storage destroyed for "+i);
-				mercs := mercs +1;
-			endif
-		endif
-		SetGlobalProperty("storagestart", i);
-	endfor
-
-	print("Searched from " + startnum + " through " + endnum);
-	print("Total Tamed areas destroyed: "+num);
-	print("Total Merc areas destroyed: "+mercs);
-
-endprogram
\ No newline at end of file

Deleted: trunk/096/scripts/testFile.esc
===================================================================
--- trunk/096/scripts/testFile.esc	2005-11-19 13:38:08 UTC (rev 1027)
+++ trunk/096/scripts/testFile.esc	2005-11-19 13:40:17 UTC (rev 1028)
@@ -1 +0,0 @@
-/* I am an escript in disguise! */
\ No newline at end of file



From austin at berlios.de  Sat Nov 19 14:42:23 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:42:23 +0100
Subject: [Poldistro-svn] r1029 - trunk/096/scripts/www
Message-ID: <200511191342.jAJDgN5w012327@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:41:51 +0100 (Sat, 19 Nov 2005)
New Revision: 1029

Removed:
   trunk/096/scripts/www/servperf/
Log:
Replaced by servperf package.



From austin at berlios.de  Sat Nov 19 14:46:49 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 14:46:49 +0100
Subject: [Poldistro-svn] r1030 - trunk/096/scripts
Message-ID: <200511191346.jAJDknoD013659@sheep.berlios.de>

Author: austin
Date: 2005-11-19 14:46:44 +0100 (Sat, 19 Nov 2005)
New Revision: 1030

Removed:
   trunk/096/scripts/util/
Log:
Not needed - old stuff...



From austin at berlios.de  Sat Nov 19 15:38:00 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 15:38:00 +0100
Subject: [Poldistro-svn] r1031 - in trunk/096/pkg/mobiles/brainAI: . bundled bundled/healer
Message-ID: <200511191438.jAJEc0MY028618@sheep.berlios.de>

Author: austin
Date: 2005-11-19 15:38:00 +0100 (Sat, 19 Nov 2005)
New Revision: 1031

Added:
   trunk/096/pkg/mobiles/brainAI/bundled/healer/
   trunk/096/pkg/mobiles/brainAI/bundled/healer/combat.src
   trunk/096/pkg/mobiles/brainAI/bundled/healer/enterArea.src
   trunk/096/pkg/mobiles/brainAI/bundled/healer/init.src
   trunk/096/pkg/mobiles/brainAI/bundled/healer/resMenu.src
Modified:
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
Log:
Working on healer... just need to get a picture of what the resurrection gump they give you looks like.

Added: trunk/096/pkg/mobiles/brainAI/bundled/healer/combat.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/healer/combat.src	2005-11-19 13:46:44 UTC (rev 1030)
+++ trunk/096/pkg/mobiles/brainAI/bundled/healer/combat.src	2005-11-19 14:38:00 UTC (rev 1031)
@@ -0,0 +1,44 @@
+// $Id: combat.src 1005 2005-11-15 09:20:06Z muaddiblsd $
+
+use uo;
+use os;
+
+include ":brainAI:npcNerves";
+include ":brainAI:npcCommands";
+include ":attributes:attributes";
+
+program BrainNerve(params)
+	var npc		:= params[1];
+	//var nerve_name	:= params[2];
+	var event	:= params[3];
+	//var settings	:= params[4];
+	//var scripts	:= params[5];
+	params := 0; // Not needed anymore.
+
+	while ( npc )
+		CheckForEvent(npc, event);
+	endwhile
+endprogram
+
+function CheckForEvent(npc, byref event)
+	if ( event )
+		var source := event.source;
+		case ( event.type )
+			SYSEVENT_ENGAGED:
+				AI_Speak(npc, "HELP! GUARDS!!", SPEAK_TEXTTYPE_YELL, SPEAK_DOEVENT_ENABLE);
+				ApplyRawDamage(source, AP_GetVitalMaximumValue(source, HITS));
+				break;
+			SYSEVENT_DAMAGED:
+				// Ignore 'damaged'.
+				break;
+			default:
+				break;
+		endcase
+		event := 0;
+	endif
+	
+	event := wait_for_event(100000);
+	
+
+	return 1;
+endfunction
\ No newline at end of file

Added: trunk/096/pkg/mobiles/brainAI/bundled/healer/enterArea.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/healer/enterArea.src	2005-11-19 13:46:44 UTC (rev 1030)
+++ trunk/096/pkg/mobiles/brainAI/bundled/healer/enterArea.src	2005-11-19 14:38:00 UTC (rev 1031)
@@ -0,0 +1,53 @@
+use uo;
+use os;
+
+include ":brainAI:npcNerves";
+include ":brainAI:npcCommands";
+include ":brainAI:npcWatchList";
+
+program BrainNerve(params)
+	var npc		:= params[1];
+	//var nerve_name	:= params[2];
+	var event	:= params[3];
+	//var settings	:= params[4];
+	var scripts	:= params[5];
+	params := 0; // Not needed anymore.
+	
+	while ( npc )
+		if ( event )
+			case ( event.type )
+				SYSEVENT_ENTEREDAREA:
+					EnteredArea(npc, event, scripts);
+					break;
+				default:
+					break;
+			endcase
+			
+			event := 0;
+		endif
+		
+		sleepms(5);
+		event := wait_for_event(600);
+	endwhile
+endprogram
+
+function EnteredArea(npc, byref event, byref scripts)
+	var source := event.source;
+	
+	if ( !source.dead )
+		return 0;
+	elseif ( !CheckLineOfSight(npc, source) )
+		return 0;
+	elseif ( source.criminal )
+		AI_Speak(npc, "I will not aid a criminal.");
+	elseif ( !GetObjProperty(source, "#ResMenu") )
+		var script := Start_Script(scripts["ResMenu"], {npc, source});
+		if ( script.errortext )
+			SendSysMessage(source, "Error - Unable to start "+scripts["ResMenu"]+" ->"+script.errortext);
+			return 0;
+		endif
+		return 1;
+	endif
+	
+	return 0;
+endfunction

Added: trunk/096/pkg/mobiles/brainAI/bundled/healer/init.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/healer/init.src	2005-11-19 13:46:44 UTC (rev 1030)
+++ trunk/096/pkg/mobiles/brainAI/bundled/healer/init.src	2005-11-19 14:38:00 UTC (rev 1031)
@@ -0,0 +1,29 @@
+/*
+ * $Id: init.src 1005 2005-11-15 09:20:06Z muaddiblsd $
+ *
+ */
+
+use uo;
+use os;
+
+include ":brainAI:npcNerves";
+include ":brainAI:npcInit";
+include ":brainAI:npcCommands";
+include ":dyes:dyes";
+
+program BrainCriticalScript(params)
+	var npc		:= params[1];
+	//var settings	:= params[2];
+	//var scripts	:= params[3];
+	params := 0; // Not needed anymore.
+
+	NPC_SetupName(npc);
+	NPC_SetupRandomEquipment(npc);
+
+	foreach item in ( ListEquippedItems(npc) )
+		item.color := RandomDyeColor();
+		sleepms(2);
+	endforeach
+
+	return 1;
+endprogram

Added: trunk/096/pkg/mobiles/brainAI/bundled/healer/resMenu.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/healer/resMenu.src	2005-11-19 13:46:44 UTC (rev 1030)
+++ trunk/096/pkg/mobiles/brainAI/bundled/healer/resMenu.src	2005-11-19 14:38:00 UTC (rev 1031)
@@ -0,0 +1,21 @@
+use uo;
+use os;
+
+include ":gumps:gumps";
+include ":brainAI:npcCommands";
+
+program ResMenu(params)
+	var npc := params[1];
+	var player := params[2];
+	params := 0; // Not needed anymore
+	
+	SetObjProperty(player, "#ResMenu", npc.serial);
+	
+	var result := 1;//RessurectGump(player);
+	if ( result )
+		AI_Speak(npc, "Live again by the virtues!");
+		Resurrect(player);
+	endif
+	
+	EraseObjProperty(player, "#ResMenu");
+endprogram

Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-19 13:46:44 UTC (rev 1030)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-19 14:38:00 UTC (rev 1031)
@@ -318,8 +318,60 @@
 	// CProps (eww!)
 	CProp	GuardKill	i1
 }
+
+NPCTemplate healer
+{
+	// Primary NPC settings
+	Name			<random> the healer
+	Script			:brainAI:brain
+	ObjType			0x190
+	Color			1024
+	TrueColor		1024
+	Gender			0
+	RunSpeed		255
+	AR			100
+	Alignment		good
+	Privs			invul seeghosts
+	Settings		invul seeghosts
+	Category		Utility
 	
+	// Attributes
+	Strength		200
+	Intelligence		200
+	Dexterity		200
+	Wrestling		500
+	
+	// Vitals
+	HITS			200
+	MANA			200
+	STAM			200
+	
+	// Intrinsic Weapon
+	AttackAttribute		Wrestling
+	AttackSpeed		80
+	AttackDamage		200
+	AttackHitScript		:combat:mainHitScript
 
+	// Brain AI Settings
+	AISetting	CycleWait	i100
+	AISetting	AreaSize	i5
+	
+	// Brain AI Nerves
+	AIScript	Combat		:brainAI:bundled/healer/combat
+	AIScript	Init		:brainAI:bundled/healer/init
+	AIScript	EnterArea	:brainAI:bundled/healer/enterArea
+	AIScript	ResMenu		:brainAI:bundled/healer/resMenu
+	
+	// Skinning Info
+
+	// Settings other scripts use...
+	NameTemplate		Human_Male
+	EquipTemplate		Villager_1
+	
+	// CProps (eww!)
+	CProp	GuardKill	i1
+}	
+
 ##########################################
 # Animals
 ##########################################



From austin at berlios.de  Sat Nov 19 15:40:20 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 19 Nov 2005 15:40:20 +0100
Subject: [Poldistro-svn] r1032 - in trunk/096/pkg/mobiles/brainAI: . scripts/sleep
Message-ID: <200511191440.jAJEeK5e028909@sheep.berlios.de>

Author: austin
Date: 2005-11-19 15:40:10 +0100 (Sat, 19 Nov 2005)
New Revision: 1032

Added:
   trunk/096/pkg/mobiles/brainAI/scripts/sleep/justWander.src
Modified:
   trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
Log:


Modified: trunk/096/pkg/mobiles/brainAI/npcdesc.cfg
===================================================================
--- trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-19 14:38:00 UTC (rev 1031)
+++ trunk/096/pkg/mobiles/brainAI/npcdesc.cfg	2005-11-19 14:40:10 UTC (rev 1032)
@@ -361,6 +361,7 @@
 	AIScript	Init		:brainAI:bundled/healer/init
 	AIScript	EnterArea	:brainAI:bundled/healer/enterArea
 	AIScript	ResMenu		:brainAI:bundled/healer/resMenu
+	AIScript	Sleep		:brainAI:scripts/sleep/justWander
 	
 	// Skinning Info
 

Added: trunk/096/pkg/mobiles/brainAI/scripts/sleep/justWander.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/sleep/justWander.src	2005-11-19 14:38:00 UTC (rev 1031)
+++ trunk/096/pkg/mobiles/brainAI/scripts/sleep/justWander.src	2005-11-19 14:40:10 UTC (rev 1032)
@@ -0,0 +1,34 @@
+use uo;
+use os;
+use util;
+
+include ":brainAI:npcNerves";
+include ":brainAI:npcCommands";
+include ":brainAI:npcSounds";
+
+program BrainNerve(params)
+	var npc		:= params[1];
+	var nerve_name	:= params[2];
+	//var settings	:= params[3];
+	//var scripts	:= params[4];
+	params := 0; // Not needed anymore.
+
+	// Shut down appropriate nerves.
+	foreach nerve in (LoadNerves(npc))
+		if ( nerve.flags & NF_CONTINUE_ON_SLEEP )
+			continue;
+		elseif ( _nerve_iter != nerve_name )
+			StopNerve(npc, _nerve_iter);
+		endif
+		sleepms(2);
+	endforeach
+
+	while ( npc )
+		npc.facing := RandomInt(8);
+		AI_Wander(npc, NOWAKE);
+
+		AI_ClearThoughts(npc, CLR_NERVE);
+		
+		Sleep(30+RandomInt(10));
+	endwhile
+endprogram



From austin at berlios.de  Sun Nov 20 03:10:14 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 20 Nov 2005 03:10:14 +0100
Subject: [Poldistro-svn] r1033 - trunk/096/scripts/include
Message-ID: <200511200210.jAK2AEqu019890@sheep.berlios.de>

Author: austin
Date: 2005-11-20 03:09:57 +0100 (Sun, 20 Nov 2005)
New Revision: 1033

Modified:
   trunk/096/scripts/include/client.inc
Log:
Added a few groups of graphical effects.


Modified: trunk/096/scripts/include/client.inc
===================================================================
--- trunk/096/scripts/include/client.inc	2005-11-19 14:40:10 UTC (rev 1032)
+++ trunk/096/scripts/include/client.inc	2005-11-20 02:09:57 UTC (rev 1033)
@@ -118,9 +118,43 @@
 endenum
 
 enum GRAPHIC_EFFECTS
-	GFX_SPELL_FAIL		:= 0x3735,
+	GFX_DEATH_VORTEX_BIRTH	:= 0x3789,
+	GFX_DEATH_VORTEX	:= 0x37CC,
+	GFX_FIELD_OF_BLADES	:= 0x37A0,
+	GFX_GLOW		:= 0x37B9,
+	GFX_BLACK_GLOW		:= 0x37C3,
+	GFX_SMOKE		:= 0x3728,
+	GFX_FIZZLE		:= 0x3735
+endenum
+
+enum GRAPHIC_FIELDS
+	GFX_POISON_FIELD_EW	:= 0x3915,
+	GFX_POISON_FIELD_NS	:= 0x3920,
+	GFX_ENERGY_FIELD_EW	:= 0x3946,
+	GFX_ENERGY_FIELD_NS	:= 0x3956,
+	GFX_PARALYSIS_FIELD_EW	:= 0x3967,
+	GFX_PARALYSIS_FIELD_NS	:= 0x3979,
+	GFX_FIRE_FIELD_EW	:= 0x398C,
+	GFX_FIRE_FIELD_NS	:= 0x3996
+endenum
+
+enum GRAPHIC_SPARKLES
+	GFX_MAGICAL_SPARKLES_EW	:= 0x1153,
+	GFX_MAGICAL_SPARKLES_NS	:= 0x1159,
+	GFX_BLUE_SPARKLES	:= 0x373A,
+	GFX_RED_SPARKLES	:= 0x374A,
+	GFX_BLUE_SPARKLE_SWIRL	:= 0x375A,
+	GFX_BLUE_SPARKLE_BORDER	:= 0x376A,
+	GFX_BLUE_SPARKLE_GROUND	:= 0x3779
+endenum
+
+enum GRAPHIC_FIRE
 	GFX_SMALL_FIREBALL	:= 0x36E4,
-	FX_EXPLODE_1		:= 0x36CB,
-	FX_EXPLODE_2		:= 0x36BD,
-	FX_EXPLODE_3		:= 0x36B0
+	GFX_LARGE_FIREBALL	:= 0x36D4,
+	GFX_WAVY_FIREBALL	:= 0x36F4,
+	GFX_EXPLOSION_BALL	:= 0x36FE,
+	GFX_FIRE_COLUMN		:= 0x3709,
+	GFX_EXPLODE_1		:= 0x36CB,
+	GFX_EXPLODE_2		:= 0x36BD,
+	GFX_EXPLODE_3		:= 0x36B0
 endenum
\ No newline at end of file



From austin at berlios.de  Sun Nov 20 03:42:09 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 20 Nov 2005 03:42:09 +0100
Subject: [Poldistro-svn] r1034 - in trunk/096/pkg/mobiles: brainAI/bundled/healer death/include
Message-ID: <200511200242.jAK2g9bO006591@sheep.berlios.de>

Author: austin
Date: 2005-11-20 03:42:05 +0100 (Sun, 20 Nov 2005)
New Revision: 1034

Added:
   trunk/096/pkg/mobiles/death/include/resurrection.inc
Modified:
   trunk/096/pkg/mobiles/brainAI/bundled/healer/enterArea.src
   trunk/096/pkg/mobiles/brainAI/bundled/healer/resMenu.src
Log:


Modified: trunk/096/pkg/mobiles/brainAI/bundled/healer/enterArea.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/healer/enterArea.src	2005-11-20 02:09:57 UTC (rev 1033)
+++ trunk/096/pkg/mobiles/brainAI/bundled/healer/enterArea.src	2005-11-20 02:42:05 UTC (rev 1034)
@@ -41,7 +41,7 @@
 	elseif ( source.criminal )
 		AI_Speak(npc, "I will not aid a criminal.");
 	elseif ( !GetObjProperty(source, "#ResMenu") )
-		var script := Start_Script(scripts["ResMenu"], {npc, source});
+		var script := Start_Script(scripts["ResMenu"], {source, npc});
 		if ( script.errortext )
 			SendSysMessage(source, "Error - Unable to start "+scripts["ResMenu"]+" ->"+script.errortext);
 			return 0;

Modified: trunk/096/pkg/mobiles/brainAI/bundled/healer/resMenu.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/bundled/healer/resMenu.src	2005-11-20 02:09:57 UTC (rev 1033)
+++ trunk/096/pkg/mobiles/brainAI/bundled/healer/resMenu.src	2005-11-20 02:42:05 UTC (rev 1034)
@@ -3,19 +3,25 @@
 
 include ":gumps:gumps";
 include ":brainAI:npcCommands";
+include ":death:resurrection";
 
 program ResMenu(params)
-	var npc := params[1];
-	var player := params[2];
+	var player := params[1];
+	var npc := params[2];
+	
 	params := 0; // Not needed anymore
 	
 	SetObjProperty(player, "#ResMenu", npc.serial);
 	
-	var result := 1;//RessurectGump(player);
+	var result := ResurrectionGump(player);
 	if ( result )
-		AI_Speak(npc, "Live again by the virtues!");
-		Resurrect(player);
+		if ( npc )
+			AI_Speak(npc, "Live again by the virtues!");
+		endif
+		
+		Resurrection(player);
 	endif
 	
 	EraseObjProperty(player, "#ResMenu");
 endprogram
+

Added: trunk/096/pkg/mobiles/death/include/resurrection.inc
===================================================================
--- trunk/096/pkg/mobiles/death/include/resurrection.inc	2005-11-20 02:09:57 UTC (rev 1033)
+++ trunk/096/pkg/mobiles/death/include/resurrection.inc	2005-11-20 02:42:05 UTC (rev 1034)
@@ -0,0 +1,27 @@
+/*
+ * $Id$
+ *
+ */
+
+use uo;
+
+include ":gumps:gumps";
+include "include/client";
+
+function ResurrectionGump(mobile)
+	var gump := GFCreateGump();
+	
+	return gump;
+endfunction
+
+function Resurrection(mobile)
+	if ( !mobile.IsA(POLCLASS_MOBILE) )
+		return error{"errortext":="object is not a mobile."};
+	elseif ( !mobile.dead )
+		return error{"errortext":="mobile is not dead."};
+	endif
+	
+	return Resurrect(mobile);
+endfunction
+
+	
\ No newline at end of file



From austin at berlios.de  Sun Nov 20 04:23:07 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 20 Nov 2005 04:23:07 +0100
Subject: [Poldistro-svn] r1035 - in trunk/096/pkg: commands/coun commands/player mobiles/brainAI/commands/gm other/motd utils/gumps/commands/admin utils/gumps/config
Message-ID: <200511200323.jAK3N7sb007020@sheep.berlios.de>

Author: austin
Date: 2005-11-20 04:23:06 +0100 (Sun, 20 Nov 2005)
New Revision: 1035

Modified:
   trunk/096/pkg/commands/coun/realms.src
   trunk/096/pkg/commands/player/msg.src
   trunk/096/pkg/mobiles/brainAI/commands/gm/createnpc.src
   trunk/096/pkg/other/motd/motd.src
   trunk/096/pkg/utils/gumps/commands/admin/samplegump.src
   trunk/096/pkg/utils/gumps/config/GumpInfo.cfg
Log:
Fixed # inline comments in GumpInfo.cfg.
Expanded gump constants for backgrounds for latest client release.
Adjusted some scripts that used gumps to fit other gump sets.
Changed background and foreground to blueslab and stoneslab to fit more gump graphics.

Modified: trunk/096/pkg/commands/coun/realms.src
===================================================================
--- trunk/096/pkg/commands/coun/realms.src	2005-11-20 02:42:05 UTC (rev 1034)
+++ trunk/096/pkg/commands/coun/realms.src	2005-11-20 03:23:06 UTC (rev 1035)
@@ -25,14 +25,14 @@
 	var gump := GFCreateGump();
 	
 	GFResizePic(gump, 0, 0, GFCfgConst("Defaults", "BackGround"), 435, 420);
-	GFResizePic(gump, 10, 10, GFCfgConst("Defaults", "ForeGround"), 415, 400);
+	GFResizePic(gump, 15, 15, GFCfgConst("Defaults", "ForeGround"), 405, 390);
 	
-	GFTextLine(gump, 20, 15, 2100, "Realm Name");
-	GFTextLine(gump, 150, 15, 2100, "Height");
-	GFTextLine(gump, 200, 15, 2100, "Width");
-	GFTextLine(gump, 245, 15, 2100, "MapID");
-	GFTextLine(gump, 300, 15, 2100, "TLI");
-	GFTextLine(gump, 340, 15, 2100, "Mobile Count");
+	GFTextLine(gump, 20, 20, 2100, "Realm Name");
+	GFTextLine(gump, 150, 20, 2100, "Height");
+	GFTextLine(gump, 200, 20, 2100, "Width");
+	GFTextLine(gump, 245, 20, 2100, "MapID");
+	GFTextLine(gump, 300, 20, 2100, "TLI");
+	GFTextLine(gump, 340, 20, 2100, "Mobile Count");
 	
 	var y_pos := 40;
 	foreach realm in realm_list

Modified: trunk/096/pkg/commands/player/msg.src
===================================================================
--- trunk/096/pkg/commands/player/msg.src	2005-11-20 02:42:05 UTC (rev 1034)
+++ trunk/096/pkg/commands/player/msg.src	2005-11-20 03:23:06 UTC (rev 1035)
@@ -29,16 +29,16 @@
 	var gump := GFCreateGump();
 	
 	GFResizePic(gump, 0, 0, GFCfgConst("Defaults", "BackGround"), 310, 420);
-	GFResizePic(gump, 10, 10, GFCfgConst("Defaults", "ForeGround"), 290, 400);
+	GFResizePic(gump, 15, 15, GFCfgConst("Defaults", "ForeGround"), 280, 390);
 	
-	GFTextLine(gump, 25, 15, 2100, "Player Name");
-	GFTextLine(gump, 255, 15, 2100, "Send");
+	GFTextLine(gump, 25, 20, 2100, "Player Name");
+	GFTextLine(gump, 255, 20, 2100, "Send");
 	
 	var names_list := GetNamesList(who);
 	var num_players := names_list.size();
 	var counter := 0;
 	var page_num := 1;
-	var y_pos := 40;
+	var y_pos := 45;
 	
 	GFPage(gump, 1);
 	foreach name in (names_list.keys())

Modified: trunk/096/pkg/mobiles/brainAI/commands/gm/createnpc.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/commands/gm/createnpc.src	2005-11-20 02:42:05 UTC (rev 1034)
+++ trunk/096/pkg/mobiles/brainAI/commands/gm/createnpc.src	2005-11-20 03:23:06 UTC (rev 1035)
@@ -109,15 +109,15 @@
 	var gump := GFCreateGump();
 	GFPage(gump, 0);
 	GFResizePic(gump, 0, 0, GFCfgConst("Defaults", "BackGround"), 300, 480);
-	GFResizePic(gump, 10, 10, GFCfgConst("Defaults", "ForeGround"), 280, 460);
+	GFResizePic(gump, 15, 15, GFCfgConst("Defaults", "ForeGround"), 270, 450);
 	var y_pos := 40;
 	var counter := 1;
 	var page_num := 1;
-	GFTextMid(gump, 10, 15, 280, 2100, "NPC Categories");
+	GFTextMid(gump, 10, 20, 280, 2100, "NPC Categories");
 	
 	/////
-	GFAddButton(gump, 158, 445, 4002, 4003, GF_CLOSE_BTN, UNCACHE_BTN);
-	GFTextLine(gump, 193, 445, 2100, "Uncache data");
+	GFAddButton(gump, 158, 440, 4002, 4003, GF_CLOSE_BTN, UNCACHE_BTN);
+	GFTextLine(gump, 193, 440, 2100, "Uncache data");
 	/////
 	
 	GFPage(gump, page_num);
@@ -155,11 +155,11 @@
 	var gump := GFCreateGump();
 	GFPage(gump, 0);
 	GFResizePic(gump, 0, 0, GFCfgConst("Defaults", "BackGround"), 300, 480);
-	GFResizePic(gump, 10, 10, GFCfgConst("Defaults", "ForeGround"), 280, 460);
+	GFResizePic(gump, 15, 15, GFCfgConst("Defaults", "ForeGround"), 270, 450);
 	var y_pos := 40;
 	var counter := 1;
 	var page_num := 1;
-	GFTextMid(gump, 10, 15, 280, 2100, "NPC List - "+category_name);
+	GFTextMid(gump, 10, 15, 290, 2100, "NPC List - "+category_name);
 	GFPage(gump, page_num);
 	foreach template in (npc_list[category_name])
 		GFAddButton(gump, 20, y_pos+3, 2117, 2118, GF_CLOSE_BTN, template.pos);

Modified: trunk/096/pkg/other/motd/motd.src
===================================================================
--- trunk/096/pkg/other/motd/motd.src	2005-11-20 02:42:05 UTC (rev 1034)
+++ trunk/096/pkg/other/motd/motd.src	2005-11-20 03:23:06 UTC (rev 1035)
@@ -28,21 +28,17 @@
 	if ( !text )
 		text := "There is no MOTD for today.";
 	endif
-
-	var BKGND_SILVERTRIM := GFCfgConst("Defaults", "BackGround");
-	var BKGND_DARK_STONE := GFCfgConst("Defaults", "ForeGround");
-	var BKGND_GOLDTRIM   := GFCfgConst("Backgrounds", "GOLDTRIM");
-
+	
 	var gump := GFCreateGump();
-	GFResizePic(gump, 0, 0, BKGND_SILVERTRIM, 360, 480);
+	GFResizePic(gump, 0, 0, GFCfgConst("Defaults", "BackGround"), 360, 480);
 
-	GFResizePic(gump, 10, 12, BKGND_DARK_STONE, 340, 30);
+	GFResizePic(gump, 15, 12, GFCfgConst("Defaults", "ForeGround"), 330, 30);
 	GFTextLine(gump, 110, 17, 2100, "Messages of the Day");
 
-	GFResizePic(gump, 10, 45, BKGND_GOLDTRIM, 340, 390);
+	GFResizePic(gump, 15, 45, GFCfgConst("Backgrounds", "GOLDTRIM"), 330, 390);
 	GFHTMLArea(gump, 22, 53, 322, 375, text, 0, 1);
 
-	GFResizePic(gump, 10, 438, BKGND_DARK_STONE, 340, 30);
+	GFResizePic(gump, 15, 438,GFCfgConst("Defaults", "ForeGround"), 330, 30);
 	GFCheckBox(gump, 20, 443, 0x768, 0x767, (off == 0), ONOFF_BTN);
 	GFTextLine(gump, 45, 443, 2100, "Open on login");
 

Modified: trunk/096/pkg/utils/gumps/commands/admin/samplegump.src
===================================================================
--- trunk/096/pkg/utils/gumps/commands/admin/samplegump.src	2005-11-20 02:42:05 UTC (rev 1034)
+++ trunk/096/pkg/utils/gumps/commands/admin/samplegump.src	2005-11-20 03:23:06 UTC (rev 1035)
@@ -8,8 +8,8 @@
 	var temp := "";
 	var gump := GFCreateGump(0, 0, 640, 480);
 	GFDisposable(gump, 0);
-	GFResizePic(gump, 0, 0, 83, 640, 480);		//Background
-	GFResizePic(gump, 15, 15, 5120, 610, 450);	//Foreground
+	GFResizePic(gump, 0, 0, GFCfgConst("Defaults", "BackGround"), 640, 480);		//Background
+	GFResizePic(gump, 15, 15, GFCfgConst("Defaults", "ForeGround"), 610, 450);	//Foreground
 	
 	GFPage(gump, 10);
 	GFTextMid(gump, 15, 100, 610, 1153, "You have reached page 10!");

Modified: trunk/096/pkg/utils/gumps/config/GumpInfo.cfg
===================================================================
--- trunk/096/pkg/utils/gumps/config/GumpInfo.cfg	2005-11-20 02:42:05 UTC (rev 1034)
+++ trunk/096/pkg/utils/gumps/config/GumpInfo.cfg	2005-11-20 03:23:06 UTC (rev 1035)
@@ -3,63 +3,75 @@
 #
 elem Defaults
 {
-	FontColor		0x5FF	# White
-	BackGround		0x53	# SILVER_TRIM
-	ForeGround		0x1400	# DARK_STONE
+	FontColor		0x5FF	// White
+	//BackGround		0x53	// SILVER_TRIM
+	//ForeGround		0x1400	// DARK_STONE
+	BackGround		0xE10	// BLUESLAB
+	ForeGround		0x13BE	// STONESLAB
 }
 
 elem BackGrounds
 {
-	BLUESLAB		0xE10	# Raised edge (blocky)
-	GOLDTRIM		0xA3C	# Gold-press, black backing
-	OLD_JOURNAL_SCROLL	0x141E	# Old journal scroll
-	PAPER			0xBB8	# Very thin edging
-	PAPER_EX		0xDAC	#  \_ PAPER with fancy inner border
-	SANDSTONE		0x13BE	# Custom sandstone background
-	SCROLL			0x9D8	# UO journal scroll
-	SILVERTRIM		0x53	# Fancy, dark-grey backing with a silver border
-	DARK_STONE		0x1400	# Dark colored stone with rounded corners
-	STONE			0x13BE	# Similar to DARK_STONE but much lighter
-	STONESLAB		0x13C8	# Gray stone (marble?) slab background
-	OPTIONS_MENU		0xA28	# Marble gump with rounded corners seen in the options menus
+	BLUESLAB		0xE10	// Raised edge (blocky)
+	GOLDTRIM		0xA3C	// Gold-press, black backing
+	OLD_SCROLL		0x1432	// Plain yellowish scroll
+	OLD_JOURNAL_SCROLL	0x141E	// Same as above but with up/down arrows and other buttons
+	YELLOW_SCROLL		0x24A4	// Scroll with yellow colored paper.
+	WHITE_SCROLL		0x24AE	// Scroll with white(gray?) colored paper.
+	PAPER			0xBB8	// Very thin edging
+	FANCY_PAPER		0xDAC	//  \_ PAPER with fancy inner border
+	YELLOW_PAPER		0x2454	// Plain yellow colored paper
+	WHITE_PAPER		0x2486	// Same as above but white	
+	STONESLAB		0x13BE	// Stone (mabrble?) background
+	STONESLAB_SQUARE	0x2422	// Same as above but squared with a two line border
+	STONESLAB_SQUARE_B	0x242C	// Same as above but with a neutral gray color
+	SCROLL			0x9D8	// UO journal scroll
+	SILVERTRIM		0x53	// Fancy, dark-grey backing with a silver border
+	ROUND_GOLDTRIM_DARK	0x24B8	// Gray gump with rounded edges and gold border
+	ROUND_GOLDTRIM_LIGHT	0x24B8	// Same as above but the gray is lighter in color
+	ROUND_SILVERTRIM_DARK	0x254E	// Gray gump with rounded edges and silver border
+	ROUND_GOLDTRIM_LIGHT	0x255E	// Same as above but the gray is lighter in color
+	DARK_STONE		0x1400	// Dark colored stone with rounded corners
+	LIGHT_STONE		0x13EC	// Similar to DARK_STONE but much lighter
+	OPTIONS_MENU		0xA28	// Marble gump with rounded corners seen in the options menus
 }
 
 elem CheckBoxes
 {
-	BLUE_DIAMOND_OFF	0x868	# Blue diamond check box with gold trim
-	BLUE_DIAMOND_ON		0x86A	# Blue diamond check box with gold trim
+	BLUE_DIAMOND_OFF	0x868	// Blue diamond check box with gold trim
+	BLUE_DIAMOND_ON		0x86A	// Blue diamond check box with gold trim
 }
 
 elem Buttons
 {
-	SMALL_BLUE_OFF		0xA37	# Small round blue button with gold trim
-	SMALL_BLUE_ON		0xA38	# Small round blue butotn with gold trim
+	SMALL_BLUE_OFF		0xA37	// Small round blue button with gold trim
+	SMALL_BLUE_ON		0xA38	// Small round blue butotn with gold trim
 
-	LARGE_BLUE_OFF		0xA45	# Large round blue button with gold trim
-	LARGE_BLUE_ON		0xA46	# Large round blue butotn with gold trim
+	LARGE_BLUE_OFF		0xA45	// Large round blue button with gold trim
+	LARGE_BLUE_ON		0xA46	// Large round blue butotn with gold trim
 
-	RED_DIAMOND_OFF		0x9AA	# Red diamond button with gold trim
-	RED_DIAMOND_ON		0x9A9	# Red diamond button with gold trim
+	RED_DIAMOND_OFF		0x9AA	// Red diamond button with gold trim
+	RED_DIAMOND_ON		0x9A9	// Red diamond button with gold trim
 
-	STONE_X_OFF		0xA94	# Stone button with an X on it
-	STONE_X_ON		0xA95	# Stone button with an X on it
+	STONE_X_OFF		0xA94	// Stone button with an X on it
+	STONE_X_ON		0xA95	// Stone button with an X on it
 
-	STONE_CHECK_OFF		0xA9A	# Stone button with a check mark on it
-	STONE_CHECK_ON		0xA9B	# Stone button with a check mark on it
+	STONE_CHECK_OFF		0xA9A	// Stone button with a check mark on it
+	STONE_CHECK_ON		0xA9B	// Stone button with a check mark on it
 }
 
 elem PageButtons
 {
-	STONE_DOWN_OFF		0xA56	# Stone button that points down
-	STONE_DOWN_ON		0xA57	# Stone button that points down
-	STONE_UP_OFF		0xA5A	# Stone button that points up
-	STONE_UP_ON		0xA5B	# Stone button that points up
+	STONE_DOWN_OFF		0xA56	// Stone button that points down
+	STONE_DOWN_ON		0xA57	// Stone button that points down
+	STONE_UP_OFF		0xA5A	// Stone button that points up
+	STONE_UP_ON		0xA5B	// Stone button that points up
 
-	STONE_SLIT_OFF		0xA96	# Stone button that has a "-" in the middle
-	STONE_SLIT_ON		0xA97	# Stone button that has a "-" in the middle
+	STONE_SLIT_OFF		0xA96	// Stone button that has a "-" in the middle
+	STONE_SLIT_ON		0xA97	// Stone button that has a "-" in the middle
 
-	GRAY_UP_OFF		0xA90	# Narrow gray button that points up
-	GRAY_UP_ON		0xA91	# Narrow gray button that points up
-	GRAY_UP_OFF		0xA92	# Narrow gray button that points down
-	GRAY_UP_ON		0xA93	# Narrow gray button that points down
+	GRAY_UP_OFF		0xA90	// Narrow gray button that points up
+	GRAY_UP_ON		0xA91	// Narrow gray button that points up
+	GRAY_UP_OFF		0xA92	// Narrow gray button that points down
+	GRAY_UP_ON		0xA93	// Narrow gray button that points down
 }
\ No newline at end of file



From austin at berlios.de  Sun Nov 20 05:14:15 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 20 Nov 2005 05:14:15 +0100
Subject: [Poldistro-svn] r1036 - trunk/096/pkg/mobiles/death/include
Message-ID: <200511200414.jAK4EFca014129@sheep.berlios.de>

Author: austin
Date: 2005-11-20 05:14:13 +0100 (Sun, 20 Nov 2005)
New Revision: 1036

Modified:
   trunk/096/pkg/mobiles/death/include/resurrection.inc
Log:
Little more progress on resurrection!

Modified: trunk/096/pkg/mobiles/death/include/resurrection.inc
===================================================================
--- trunk/096/pkg/mobiles/death/include/resurrection.inc	2005-11-20 03:23:06 UTC (rev 1035)
+++ trunk/096/pkg/mobiles/death/include/resurrection.inc	2005-11-20 04:14:13 UTC (rev 1036)
@@ -7,11 +7,13 @@
 
 include ":gumps:gumps";
 include "include/client";
+include "include/sounds";
 
 function ResurrectionGump(mobile)
 	var gump := GFCreateGump();
 	
-	return gump;
+	var input := GFSendGump(who, gump);
+	return input[0];
 endfunction
 
 function Resurrection(mobile)
@@ -21,6 +23,9 @@
 		return error{"errortext":="mobile is not dead."};
 	endif
 	
+	mobile.graphic := mobile.trueobjtype;
+	PlaySoundEffect(mobile, SFX_RESURRECT);
+	PlayObjectCenteredEffect(mobile, GFX_BLUE_SPARKLES, 10,10);
 	return Resurrect(mobile);
 endfunction
 



From panosl at berlios.de  Sun Nov 20 13:32:56 2005
From: panosl at berlios.de (panosl at BerliOS)
Date: Sun, 20 Nov 2005 13:32:56 +0100
Subject: [Poldistro-svn] r1037 - trunk/096/pkg/commands/seer
Message-ID: <200511201232.jAKCWu16027315@sheep.berlios.de>

Author: panosl
Date: 2005-11-20 13:32:07 +0100 (Sun, 20 Nov 2005)
New Revision: 1037

Modified:
   trunk/096/pkg/commands/seer/shape.src
   trunk/096/pkg/commands/seer/where.src
Log:


Modified: trunk/096/pkg/commands/seer/shape.src
===================================================================
--- trunk/096/pkg/commands/seer/shape.src	2005-11-20 04:14:13 UTC (rev 1036)
+++ trunk/096/pkg/commands/seer/shape.src	2005-11-20 12:32:07 UTC (rev 1037)
@@ -1,3 +1,8 @@
+/* $Id$
+ *
+ * Purpose
+ *
+ */
 use uo;
 
 include "include/mobileID";
@@ -23,3 +28,4 @@
 
 	return;
 endprogram
+

Modified: trunk/096/pkg/commands/seer/where.src
===================================================================
--- trunk/096/pkg/commands/seer/where.src	2005-11-20 04:14:13 UTC (rev 1036)
+++ trunk/096/pkg/commands/seer/where.src	2005-11-20 12:32:07 UTC (rev 1037)
@@ -1,3 +1,8 @@
+/* $Id$
+ *
+ * Purpose
+ *
+ */
 use uo;
 
 
@@ -6,3 +11,4 @@
 
 	return;
 endprogram
+



From austin at berlios.de  Sun Nov 20 18:23:38 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 20 Nov 2005 18:23:38 +0100
Subject: [Poldistro-svn] r1038 - trunk/096/scripts/include
Message-ID: <200511201723.jAKHNcYw024588@sheep.berlios.de>

Author: austin
Date: 2005-11-20 18:23:31 +0100 (Sun, 20 Nov 2005)
New Revision: 1038

Modified:
   trunk/096/scripts/include/equipment.inc
   trunk/096/scripts/include/shapes.inc
   trunk/096/scripts/include/sounds.inc
Log:
Added sleepms(2) entries to loops in equipment.inc that did not have them.

Added some more sound constants.

Shapes.inc GetCoordsInRect() can go different directions now.


Modified: trunk/096/scripts/include/equipment.inc
===================================================================
--- trunk/096/scripts/include/equipment.inc	2005-11-20 12:32:07 UTC (rev 1037)
+++ trunk/096/scripts/include/equipment.inc	2005-11-20 17:23:31 UTC (rev 1038)
@@ -183,6 +183,8 @@
 		
 		//SendSysMessage(mobile, "Attrib["+attrib+"] Amount["+new_val+"]");
 		AP_SetStatMod(mobile, attrib_name, new_val);
+		
+		sleepms(2);
 	endforeach
 	
 	return 1;
@@ -221,6 +223,8 @@
 		
 		//SendSysMessage(mobile, "Attrib["+attrib+"] Amount["+amount+"]");
 		AP_SetStatMod(mobile, attrib_name, new_val);
+		
+		sleepms(2);
 	endforeach
 	
 	return 1;

Modified: trunk/096/scripts/include/shapes.inc
===================================================================
--- trunk/096/scripts/include/shapes.inc	2005-11-20 12:32:07 UTC (rev 1037)
+++ trunk/096/scripts/include/shapes.inc	2005-11-20 17:23:31 UTC (rev 1038)
@@ -5,6 +5,7 @@
  
 use uo;
 use os;
+use math;
 
 /*
  * GetCoordsInSquare(mid_x, mid_y, radius)
@@ -22,24 +23,22 @@
  * 
  */
 function GetCoordsInSquare(mid_x, mid_y, radius)
-	var x_row := mid_x-radius;
-	var y_col := mid_y-radius;
-	var stop_x := mid_x+radius;
-	var stop_y := mid_y+radius;
+	var x_row := CInt(mid_x)-CInt(radius);
+	var y_col := CInt(mid_y)-CInt(radius);
+	var stop_x := CInt(mid_x)+CInt(radius);
+	var stop_y := CInt(mid_y)+CInt(radius);
 
 	var point_list := array{};
-	var coord := struct;
-	coord.+x;
-	coord.+y;
-
+	var coord := struct{"x", "y"};
+	
 	for ( x_row:=(mid_x-radius); x_row<=stop_x; x_row:=x_row+1 )
-		sleepms(2);
 		for ( y_col:=(mid_y-radius); y_col<=stop_y; y_col:=y_col+1 )
 			coord.x := x_row;
 			coord.y := y_col;
 			point_list.Append(coord);
 			sleepms(2);
 		endfor
+		sleepms(2);
 	endfor
 	
 	return point_list;
@@ -52,10 +51,10 @@
  * Retrieves the coordinates in the area of a rectangle.
  *
  * Parameters
- * x1:	Upper left X coordinate
- * y1:	Upper left Y coordinate
- * x2:	Lower right X coordinate
- * y2:	Lower right Y coordinate
+ * x1:	X coordinate
+ * y1:	Y coordinate
+ * x2:	X coordinate
+ * y2:	Y coordinate
  *
  * Return value
  * Array of structs (.x, .y)
@@ -63,26 +62,34 @@
  */
 function GetCoordsInRect(x1, y1, x2, y2)
 	var point_list := array{};
-	var coord := struct;
-	coord.+x;
-	coord.+y;
+	var coord := struct{"x", "y"};
 	
-	if ( x2 < x1 )
-		return error;
-	elseif ( y2 < y1 )
-		return error;
+	x1 := CInt(x1);
+	y1 := CInt(y1);
+	x2 := CInt(x2);
+	y2 := CInt(y2);
+	
+	if ( x1 > x2 )
+		x1 := x1*-1;
+		x2 := x2*-1;
 	endif
-
-	for ( x1; x1<=x2; x1:=x1+1 )
-		for ( y1; y1<=y2; y1:=y1+1 )
-			coord.x := x1;
-			coord.y := y1;
+	if ( y1 > y2 )
+		y1 := y1*-1;
+		y2 := y2*-1;
+	endif
+	
+	var sx, sy;
+	for ( sx:=x1; sx<=x2; sx:=sx+1 )
+		for ( sy:=y1; sy<=y2; sy:=sy+1 )
+			coord.x := Abs(sx);
+			coord.y := ABs(sy);
+			Broadcast(coord);
 			point_list.Append(coord);
 			sleepms(2);
 		endfor
 		sleepms(2);
 	endfor
-
+	
 	return point_list;
 endfunction
 
@@ -102,9 +109,9 @@
  * 
  */
 function GetCoordsInCircle(mid_x, mid_y, radius)
-	mid_x := mid_x;
-	mid_y := mid_y;
-	radius := radius;
+	mid_x := CInt(mid_x);
+	mid_y := CInt(mid_y);
+	radius := CInt(radius);
 	return error{"errortext":="Hasn't been coded yet!"};
 endfunction
 

Modified: trunk/096/scripts/include/sounds.inc
===================================================================
--- trunk/096/scripts/include/sounds.inc	2005-11-20 12:32:07 UTC (rev 1037)
+++ trunk/096/scripts/include/sounds.inc	2005-11-20 17:23:31 UTC (rev 1038)
@@ -46,7 +46,11 @@
 	SFX_BEAR_2C		:= 0x4C5,
 	SFX_BEAR_3C		:= 0x4C6,
 	SFX_BEAR_4C		:= 0x4C7,
-	SFX_BEAR_5C		:= 0x4C8
+	SFX_BEAR_5C		:= 0x4C8,
+	SFX_BELLOWS		:= 0x2C,
+	SFX_BIGFOOT_1		:= 0x120,
+	SFX_BIGFOOT_2		:= 0x121,
+	
 endenum
 
 enum CUSTOM_SOUNDS



From austin at berlios.de  Mon Nov 21 01:19:55 2005
From: austin at berlios.de (austin at BerliOS)
Date: Mon, 21 Nov 2005 01:19:55 +0100
Subject: [Poldistro-svn] r1039 - trunk/096/scripts/include
Message-ID: <200511210019.jAL0JthQ017605@sheep.berlios.de>

Author: austin
Date: 2005-11-21 01:19:37 +0100 (Mon, 21 Nov 2005)
New Revision: 1039

Modified:
   trunk/096/scripts/include/shapes.inc
Log:
Removed the broadcast() I had in there for debugging :-P


Modified: trunk/096/scripts/include/shapes.inc
===================================================================
--- trunk/096/scripts/include/shapes.inc	2005-11-20 17:23:31 UTC (rev 1038)
+++ trunk/096/scripts/include/shapes.inc	2005-11-21 00:19:37 UTC (rev 1039)
@@ -83,7 +83,6 @@
 		for ( sy:=y1; sy<=y2; sy:=sy+1 )
 			coord.x := Abs(sx);
 			coord.y := ABs(sy);
-			Broadcast(coord);
 			point_list.Append(coord);
 			sleepms(2);
 		endfor



From austin at berlios.de  Mon Nov 21 22:00:28 2005
From: austin at berlios.de (austin at BerliOS)
Date: Mon, 21 Nov 2005 22:00:28 +0100
Subject: [Poldistro-svn] r1040 - in trunk/096/pkg/commands: config gm include props
Message-ID: <200511212100.jALL0SuR017661@sheep.berlios.de>

Author: austin
Date: 2005-11-21 22:00:27 +0100 (Mon, 21 Nov 2005)
New Revision: 1040

Added:
   trunk/096/pkg/commands/config/cmdhelp.cfg
   trunk/096/pkg/commands/include/cmdhelp.inc
Removed:
   trunk/096/pkg/commands/gm/setprop.src
Modified:
   trunk/096/pkg/commands/config/flip.cfg
   trunk/096/pkg/commands/props/setprop.src
Log:
Removed duplicate .setprop command
Fixed elem errors in flip.cfg
Added an example cmdhelp.cfg for textcommand help.
Added cmdhelp.inc which will be used for getting help text for text commands. (No more .src, .ecl and .txt for every command)

Added: trunk/096/pkg/commands/config/cmdhelp.cfg
===================================================================
--- trunk/096/pkg/commands/config/cmdhelp.cfg	2005-11-21 00:19:37 UTC (rev 1039)
+++ trunk/096/pkg/commands/config/cmdhelp.cfg	2005-11-21 21:00:27 UTC (rev 1040)
@@ -0,0 +1,39 @@
+#
+# Help path
+# {
+# 	Text	Line Of Text to display
+#	Text	additional line of text to display
+# }
+#
+
+
+Help pkg/commands/props/setprop.ecl
+{
+	Text	.SetProp <property name> <property value>
+	Text	NULL for value will set it to "" or 0
+}
+
+Help pkg/commands/seer/go.ecl
+{
+	Text	<b>.go [text]</b>
+
+	Text	<u>Flags</u>
+	Text	text - Optional. Location name of a go location will take you directly to this location. If no location exists by this name, it brings up the gump of locations.
+
+	Text	<u>Reserved Location Names</u>
+	Text	xyz	- Used in .go xyz <x> <y> <z> to go to specific coordinates given.
+	Text	refresh	- Used to refresh your gumps. Gumps are stored once generated. Usually only used when altering the script.
+	
+	Text	<u>Purpose</u>
+	Text	The command .go is part of a staff travel system. It has a public menu, and a private menu. The private menu is only viewable by the person it belongs to. With the Menu, you can select to Goto the location, or Send someone, depending on which button you click on.
+
+	Text	You can Add, Copy, Edit, and Delete entries from the Public and Private Menus.
+
+	Text	To Add a new entry, go to the menu you wish to add it to (public or private) and click on the Add button.
+
+	Text	To Edit an existing entry, go to the menu that has the entry, and click Edit. This will let you edit the information for this entry (including name).
+
+	Text	To Delete an existing entry, select Delete from the Edit screen.
+
+	Text	To Copy an existing entry from one menu to another (from public to private, or vice versa), go to the appropriate menu that has the entry, and click Copy. Then select the entry you wish to Copy.
+}

Modified: trunk/096/pkg/commands/config/flip.cfg
===================================================================
--- trunk/096/pkg/commands/config/flip.cfg	2005-11-21 00:19:37 UTC (rev 1039)
+++ trunk/096/pkg/commands/config/flip.cfg	2005-11-21 21:00:27 UTC (rev 1040)
@@ -557,7 +557,7 @@
 FLIP 2890
 {
 	ChangeTo 2891
-{
+}
 
 FLIP 2891
 {
@@ -1016,7 +1016,7 @@
 FLIP 3057
 {
 	ChangeTo 3058
-{
+}
 
 FLIP 3058
 {
@@ -4239,7 +4239,7 @@
 FLIP 6787
 {
 	ChangeTo 6792
-{
+}
 
 FLIP 6792
 {

Deleted: trunk/096/pkg/commands/gm/setprop.src
===================================================================
--- trunk/096/pkg/commands/gm/setprop.src	2005-11-21 00:19:37 UTC (rev 1039)
+++ trunk/096/pkg/commands/gm/setprop.src	2005-11-21 21:00:27 UTC (rev 1040)
@@ -1,120 +0,0 @@
-/* $Id$
- *
- */
-use uo;
-
-
-program SetProperties(who, text)
-	var param := SplitWords(text);
-	if ( param.size() < 2 )
-		SendSysMessage(who, "SYNTAX: .setprop <property name> <value>");
-		return;
-	endif
-
-	var targ := target(who);
-	if ( !targ )
-		SendSysMessage(who, "Cancelled");
-		return;
-	endif
-
-	var property := Lower(param[1]);
-	var pos := Find(text, param[2], Len(param[1])+1);
-	var value := text[pos, Len(text)];
-
-	// Useful for clearing something like 'mobile.guild_title'.
-	if ( value == "NULL" )
-		value := "";
-	endif
-	var old_val := targ.get_member(property);
-	var old_type := Lower(TypeOf(old_val));
-	case ( old_type )
-		"integer"	: value := CInt(value); break;
-		"string"	: value := CStr(value); break;
-		"double"	: value := CDbl(value); break;
-		default:
-			SendSysMessage(who, "Original data-type '"+old_type+"' not supported. No changes can be made.");
-			return 0;
-	endcase
-	SendSysMessage(who, "Old Value->"+old_val);
-
-	ProcessInput(who, targ,property, value);
-
-	SendSysMessage(who, "New Value->"+targ.get_member(property));
-endprogram
-
-
-function ProcessInput(who, targ, byref property, byref value)
-	//Works on items and mobiles, so do this first.
-	if ( property in array{"x", "y", "z", "realm"} )
-		DoMovement(targ,property, value);
-		return 1;
-	elseif ( MobileProperties(who, targ,property, value) )
-		// Special mobile methods/functions were used.
-		return 1;
-	else
-		// Nothing special was needed to be done, just an ordinary member to change.
-		targ.set_member(property, value);
-		return 1;
-	endif
-endfunction
-
-
-function MobileProperties(who, targ, byref property, byref value)
-	if ( !targ.IsA(POLCLASS_MOBILE) )
-		return error;
-	endif
-	
-	case ( property )
-		"concealed":
-			if ( value > who.cmdlevel )
-				SendSysMessage(who, "You can not conceal something higher than your cmdlevel.");
-				return 1;
-			else
-				targ.concealed := value; return 1;
-			endif
-		"cmdlevel":
-			if ( value > who.cmdlevel )
-				SendSysMessage(who, "You can not set a command level higher than your own.");
-				return 1;
-			else
-				targ.cmdlevel := value; return 1;
-			endif
-		"criminal":
-			targ.SetCriminal(value); return 1;
-		"murderer":
-			targ.SetMurderer(value); return 1;
-		"poisoned":
-			targ.SetPoisoned(value); return 1;
-		"squelch":
-			targ.Squelch(value); return 1;
-		"warmode":
-			targ.SetWarMode(value); return 1;
-	endcase
-	
-	// Nothing was done here.
-	return 0;
-endfunction
-
-
-function DoMovement(targ, byref property, byref value)
-	var x := targ.x;
-	var y := targ.y;
-	var z := targ.z;
-	var realm := targ.realm;
-
-	if ( property == realm )
-		MoveObjectToRealm(targ, property, x, y, z);
-	else
-		case ( property )
-			"x": x := value;
-			"y": y := value;
-			"z": z := value;
-		endcase
-
-		if ( targ.IsA(POLCLASS_ITEM) )
-			MoveItemToLocation(targ, x, y, z, MOVEITEM_FORCELOCATION);
-		elseif ( targ.IsA(POLCLASS_MOBILE) )
-			MoveCharacterToLocation(targ, x, y, z, MOVECHAR_FORCELOCATION);
-		endif
-	endif
-endfunction

Added: trunk/096/pkg/commands/include/cmdhelp.inc
===================================================================
--- trunk/096/pkg/commands/include/cmdhelp.inc	2005-11-21 00:19:37 UTC (rev 1039)
+++ trunk/096/pkg/commands/include/cmdhelp.inc	2005-11-21 21:00:27 UTC (rev 1040)
@@ -0,0 +1,117 @@
+use uo;
+use os;
+use cfgfile;
+
+include ":datafile:datafile";
+
+/*
+ * GetCmdHelpText(path)
+ *
+ * Purpose
+ * Retrieves the help text for a text command.
+ *
+ * Parameters
+ * path:	Path to the script. 
+ *		If not set, will find the path of the script that calls the function.
+ * 
+ * Return value
+ * Returns a string
+ *
+ */
+function GetCmdHelpText(path:="")
+	if ( !path )
+		path := GetProcess(GetPid()).name;
+	endif
+	
+	// Attempt to find the text from cache first
+	var help_text := GetCmdHelpTextFromCache(path);
+	if ( help_text )
+		return help_text;
+	endif
+	
+	// Get all config/cmdhelp.cfg files and search them.
+	var cfg := ReadConfigFile(":*:config/cmdhelp");
+	if ( !cfg )
+		return cfg;
+	endif
+	var cfg_elem := cfg[path];
+	if ( !cfg )
+		return cfg_elem;
+	endif
+	
+	// Get the "Text" lines from the elem.
+	help_text := "";
+	foreach entry in ( GetConfigStringArray(cfg_elem, "Text") )
+		help_text := help_text + entry;
+		sleepms(2);
+	endforeach
+	// Cache the text for faster retrieval next time.
+	SetCmdHelpTextCache(path, help_text);
+	
+	return help_text;
+endfunction
+
+/*
+ * GetCmdHelpTextFromCache(path)
+ *
+ * Purpose
+ * Retrieves the cached help text for a text command.
+ *
+ * Parameters
+ * path:	Path to the script. 
+ *		If not set, will find the path of the script that calls the function.
+ * 
+ * Return value
+ * Returns a string
+ *
+ */
+function GetCmdHelpTextFromCache(path:="")
+	if ( !path )
+		path := GetProcess(GetPid()).name;
+	endif
+	
+	var data_file := DFOpenDataFile(":commands:helptext", DF_CREATE);
+	var data_elem := DFFindElement(data_file, path, DF_NO_CREATE);
+	return data_elem.GetProp("HelpText");
+endfunction
+
+/*
+ * SetCmdHelpTextCache(path)
+ *
+ * Purpose
+ * Saves the help text for a text command.
+ *
+ * Parameters
+ * path:	Path to the script. 
+ * text:	Text to cache.
+ * 
+ * Return value
+ * 1 on success
+ * error on failure
+ *
+ */
+function SetCmdHelpTextCache(path, text)
+	var data_file := DFOpenDataFile(":commands:helptext", DF_CREATE);
+	var data_elem := DFFindElement(data_file, path, DF_NO_CREATE);
+	
+	return data_elem.SetProp("HelpText", text);
+endfunction
+
+/*
+ * RemoveCmdHelpTextCache(path)
+ *
+ * Purpose
+ * Removes the cached help text for a text command.
+ *
+ * Parameters
+ * path:	Path to the script. 
+ * 
+ * Return value
+ * Returns a string
+ *
+ */
+function RemoveCmdHelpTextCache(path)
+	var data_file := DFOpenDataFile(":commands:helptext", DF_CREATE);
+	return data_file.DeleteElement(path);
+endfunction
+	
\ No newline at end of file

Modified: trunk/096/pkg/commands/props/setprop.src
===================================================================
--- trunk/096/pkg/commands/props/setprop.src	2005-11-21 00:19:37 UTC (rev 1039)
+++ trunk/096/pkg/commands/props/setprop.src	2005-11-21 21:00:27 UTC (rev 1040)
@@ -1,10 +1,14 @@
-/* $Id: setprop.src 385 2005-10-02 18:31:15Z panosl $
+/* $Id$
  *
  */
 use uo;
+use os;
 
-
 program SetProperties(who, text)
+	
+	var ref := GetProcess(GetPid());
+	SendSysMessage(who, "->"+ref.name);
+	
 	var param := SplitWords(text);
 	if ( param.size() < 2 )
 		SendSysMessage(who, "SYNTAX: .setprop <property name> <value>");



From austin at berlios.de  Wed Nov 23 15:15:04 2005
From: austin at berlios.de (austin at BerliOS)
Date: Wed, 23 Nov 2005 15:15:04 +0100
Subject: [Poldistro-svn] r1041 - in trunk/096/pkg: commands/gm systems/combat/include
Message-ID: <200511231415.jANEF4BD006731@sheep.berlios.de>

Author: austin
Date: 2005-11-23 15:15:01 +0100 (Wed, 23 Nov 2005)
New Revision: 1041

Modified:
   trunk/096/pkg/commands/gm/info.src
   trunk/096/pkg/systems/combat/include/weaponInfo.inc
Log:
Added a function to calculate the average damage a weapon will deal on a swing.
Updated .info to use this. (.info still has a long ways to go!)

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-21 21:00:27 UTC (rev 1040)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-23 14:15:01 UTC (rev 1041)
@@ -17,6 +17,7 @@
 include ":gumps:requestgump";
 include ":gumps:yesno";
 include ":containers:storageAreas";
+include ":combat:weaponInfo";
 
 unload_scripts("");
 
@@ -43,13 +44,13 @@
 		targ := who;
 	endif
 
-	var gump := PropertyGump(who, targ);
+	var gump := LocationGump(who, targ);
 	GFSendGump(who, gump);
 
 endprogram
 
 
-function PropertyGump(who, targ)
+function LocationGump(who, targ)
 	var gump := GumpTemplate(targ);
 	// Used to fix unused var report by ecompile: who;
 	who := who;
@@ -89,31 +90,34 @@
 	GFTextLine(gump, 40, 60, 2100, "General");
 
 	GFAddButton(gump, 20, 83, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 80, 2100, "Client");
+	GFTextLine(gump, 40, 80, 2100, "Location");
 
 	GFAddButton(gump, 20, 103, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 100, 2100, "Combat");
+	GFTextLine(gump, 40, 100, 2100, "Client");
 
 	GFAddButton(gump, 20, 123, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 120, 2100, "Script");
+	GFTextLine(gump, 40, 120, 2100, "Combat");
 
 	GFAddButton(gump, 20, 143, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 140, 2100, "Reputation");
+	GFTextLine(gump, 40, 140, 2100, "Script");
 
 	GFAddButton(gump, 20, 163, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 160, 2100, "Properties");
+	GFTextLine(gump, 40, 160, 2100, "Reputation");
 
 	GFAddButton(gump, 20, 183, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 180, 2100, "Attributes");
+	GFTextLine(gump, 40, 180, 2100, "Properties");
 
 	GFAddButton(gump, 20, 203, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 200, 2100, "Privileges");
+	GFTextLine(gump, 40, 200, 2100, "Attributes");
 
 	GFAddButton(gump, 20, 223, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 220, 2100, "Storage");
+	GFTextLine(gump, 40, 220, 2100, "Privileges");
 
 	GFAddButton(gump, 20, 243, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 240, 2100, "Miscellaneous");
+	GFTextLine(gump, 40, 240, 2100, "Storage");
+	
+	GFAddButton(gump, 20, 263, 2117, 2118, GF_CLOSE_BTN, 1);
+	GFTextLine(gump, 40, 260, 2100, "Misc.");
 
 	return gump;
 endfunction
@@ -211,17 +215,8 @@
 		wpn_speed := cfg.Speed;
 		wpn_dice := cfg.Damage;
 	endif
-	var dmg := wpn_dice;
-	dmg["d"] := " ";
-	dmg["-"] := " ";
-	dmg["+"] := " ";
-	dmg := SplitWords(dmg);
-	var X := CInt(dmg[1]);
-	var Y := CInt(dmg[2]);
-	var Z := CInt(dmg[3]);
-	Z := Z+CInt((targ.weapon).dmg_mod);
-	// (x*((1+y)/2))+z average formula
-	var average := (X*((1+Y)/2))+Z;
+	
+	var average := CS_GetAverageDamage(weapon);
 
 	GFTextLine(gump, 185, 180, 2100, "Weapon Name");
 	GFTextRight(gump, 475, 180, 2100, wpn_name);

Modified: trunk/096/pkg/systems/combat/include/weaponInfo.inc
===================================================================
--- trunk/096/pkg/systems/combat/include/weaponInfo.inc	2005-11-21 21:00:27 UTC (rev 1040)
+++ trunk/096/pkg/systems/combat/include/weaponInfo.inc	2005-11-23 14:15:01 UTC (rev 1041)
@@ -26,3 +26,33 @@
 	return GetConfigString(config, prop_name);
 endfunction
 
+/*
+ * CS_GetAverageDamage(weapon)
+ *
+ * Purpose
+ * Takes in the weapon's damage dice and damage modifier and
+ * calculates its average damage.
+ *
+ * Parameters
+ * weapon:	Weapon object to get the average damage for.
+ *
+ * Return value
+ * Integer
+ *
+ */
+function CS_GetAverageDamage(weapon)
+	var dmg := CS_GetWeaponInfo(weapon, "Damage");
+	
+	dmg["d"] := " ";
+	dmg["-"] := " ";
+	dmg["+"] := " ";
+	dmg := SplitWords(dmg);
+	var X := CInt(dmg[1]);
+	var Y := CInt(dmg[2]);
+	var Z := CInt(dmg[3]);
+	Z := Z+CInt((weapon).dmg_mod);
+	// (x*((1+y)/2))+z average formula
+	var average := (X*((1+Y)/2))+Z;
+	
+	return CInt(average);
+endfunction
\ No newline at end of file



From austin at berlios.de  Wed Nov 23 15:40:11 2005
From: austin at berlios.de (austin at BerliOS)
Date: Wed, 23 Nov 2005 15:40:11 +0100
Subject: [Poldistro-svn] r1042 - trunk/096/pkg/config
Message-ID: <200511231440.jANEeBQ5008800@sheep.berlios.de>

Author: austin
Date: 2005-11-23 15:40:10 +0100 (Wed, 23 Nov 2005)
New Revision: 1042

Added:
   trunk/096/pkg/config/info.cfg
Log:
Idea im playing with...

Added: trunk/096/pkg/config/info.cfg
===================================================================
--- trunk/096/pkg/config/info.cfg	2005-11-23 14:15:01 UTC (rev 1041)
+++ trunk/096/pkg/config/info.cfg	2005-11-23 14:40:10 UTC (rev 1042)
@@ -0,0 +1,87 @@
+Elem	Index
+{
+	Index	General
+	Index	Location
+	Index	Client
+	Index	Combat
+	Index	Script
+	Index	Reputation
+	Index	Properties
+	Index	Attributes
+	Index	Privileges
+	Index	Storage
+	Index	Miscellaneous
+}
+
+Elem	Index-General
+{
+	Group	NameAndTitles
+}
+
+Elem	Index-Location
+{
+	Group	Location
+}
+
+Elem	Index-Client
+{
+	Group	Client
+	Group	Account
+}
+
+Elem	Index-Combat
+{
+	Group	Combat
+	Group	WeaponInfo
+}
+
+Group	NameAndTitles
+{
+// 	Entry	Type	Display_Name	Property name	Editable
+	Entry	member	Title_Prefix	title_prefix	1
+	Entry	member	Name		name		1
+	Entry	member	Title_Suffix	title_suffix	1
+	Entry	member	Title_Race	title_race	1
+}
+
+Group	Location
+{
+	Entry	member	X	x	1
+	Entry	member	Y	y	1
+	Entry	member	Z	z	1
+	Entry	member	Realm	realm	1
+}
+
+Group	Client
+{
+	Entry	member	Connected	connected	0
+	Entry	member	IP_Address	ip		0
+	Entry	member	Client_Version	clientversion	0
+}
+
+Group	Account
+{
+	Entry	member	Account_Name	acctname	0
+	Entry	member	Account_Enabled	acct.enabled	0
+	Entry	member	Account_Banned	acct.banned	0
+}
+
+Group	Combat
+{
+	Entry	member	War_Mode		warmode		1
+	Entry	member	Armor_Rating_(AR)	ar		0
+	Entry	member	AR_Modifier		ar_mod		1
+	Entry	member	Attack_Speed_Mod	delay_mod	1
+}
+
+Group	WeaponInfo
+{
+	Entry	member	Weapon_Name	weapon.name	0
+	Entry	member	Weapon_Serial	weapon.serial	0
+	Entry	member	Weapon_Objtype	weapon.objtype	0
+	Entry	blank
+	Entry	custom	Weapon_Speed	0
+	Entry	member	Damage_Modifier	weapon.dmg_mod	1
+	Entry	custom	Damage_Dice	0
+	Entry	custom	Average_Damage	0
+}
\ No newline at end of file



From austin at berlios.de  Wed Nov 23 15:57:46 2005
From: austin at berlios.de (austin at BerliOS)
Date: Wed, 23 Nov 2005 15:57:46 +0100
Subject: [Poldistro-svn] r1043 - in trunk/096/pkg/commands: config gm
Message-ID: <200511231457.jANEvkXN010637@sheep.berlios.de>

Author: austin
Date: 2005-11-23 15:57:45 +0100 (Wed, 23 Nov 2005)
New Revision: 1043

Added:
   trunk/096/pkg/commands/config/info.cfg
Modified:
   trunk/096/pkg/commands/gm/info.src
Log:


Added: trunk/096/pkg/commands/config/info.cfg
===================================================================
--- trunk/096/pkg/commands/config/info.cfg	2005-11-23 14:40:10 UTC (rev 1042)
+++ trunk/096/pkg/commands/config/info.cfg	2005-11-23 14:57:45 UTC (rev 1043)
@@ -0,0 +1,120 @@
+Elem	Index
+{
+	Index	General
+	Index	Location
+	Index	Client
+	Index	Combat
+	Index	Script
+	Index	Reputation
+	Index	Properties
+	Index	Attributes
+	Index	Privileges
+	Index	Storage
+	Index	Miscellaneous
+}
+
+Elem	Index-General
+{
+	Group	NameAndTitles
+}
+
+Elem	Index-Location
+{
+	Group	Location
+}
+
+Elem	Index-Client
+{
+	Group	Client
+	Group	Account
+}
+
+Elem	Index-Combat
+{
+	Group	Combat
+	Group	WeaponInfo
+}
+
+Elem	Index-Script
+{
+	Group	Script
+	Group	AI
+}
+
+Elem	Index-Reputation
+{
+	Group	Reputation
+}
+
+Group	NameAndTitles
+{
+// 	Entry	Type	Display_Name	Property name	Editable
+	Entry	member	Title_Prefix	title_prefix	1
+	Entry	member	Name		name		1
+	Entry	member	Title_Suffix	title_suffix	1
+	Entry	member	Title_Race	title_race	1
+}
+
+Group	Location
+{
+	Entry	member	X	x	1
+	Entry	member	Y	y	1
+	Entry	member	Z	z	1
+	Entry	member	Realm	realm	1
+}
+
+Group	Client
+{
+	Entry	member	Connected	connected	0
+	Entry	member	IP_Address	ip		0
+	Entry	member	Client_Version	clientversion	0
+}
+
+Group	Account
+{
+	Entry	member	Account_Name	acctname	0
+	Entry	member	Account_Enabled	acct.enabled	0
+	Entry	member	Account_Banned	acct.banned	0
+}
+
+Group	Combat
+{
+	Entry	member	War_Mode		warmode		1
+	Entry	member	Armor_Rating_(AR)	ar		0
+	Entry	member	AR_Modifier		ar_mod		1
+	Entry	member	Attack_Speed_Mod	delay_mod	1
+}
+
+Group	WeaponInfo
+{
+	Entry	member	Weapon_Name	weapon.name	0
+	Entry	member	Weapon_Serial	weapon.serial	0
+	Entry	member	Weapon_Objtype	weapon.objtype	0
+	Entry	blank
+	Entry	custom	Weapon_Speed	0
+	Entry	member	Damage_Modifier	weapon.dmg_mod	1
+	Entry	custom	Damage_Dice	0
+	Entry	custom	Average_Damage	0
+}
+
+Group	Script
+{
+	Entry	member	Attached_Script	attached.name	0
+	Entry	member	Attached_Pid	attached.pid	0
+}
+
+Group	AI
+{
+	Entry	member	AI_Script	script		0
+	Entry	member	AI_Pid		process.pid	0
+	Entry	member	Event_Mask	eventmask	0
+	Entry	member	Master_Serial	master.serial	0
+}
+	
+Group	Reputation
+{
+	Entry	member	Criminal	criminal	1
+	Entry	member	Murderer	murderer	1
+	Entry	blank
+	Entry	custom	Reportables	0
+}
\ No newline at end of file

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-23 14:40:10 UTC (rev 1042)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-23 14:57:45 UTC (rev 1043)
@@ -21,6 +21,8 @@
 
 unload_scripts("");
 
+var info_config;	// Makes the script easier to use with this being global.
+
 var priv_names := array
 {
 	"ignoredoors", "seeinvisitems", "seehidden", "seeghosts",
@@ -28,7 +30,6 @@
 	"dblclickany", "clotheany", "freemove"
 };
 
-
 program textcmd_Info(who, serial)
 
 	var targ := who;
@@ -44,30 +45,15 @@
 		targ := who;
 	endif
 
-	var gump := LocationGump(who, targ);
-	GFSendGump(who, gump);
-
+	var info_config := ReadConfigFile(":commands:config/info");
+	if ( !info_config )
+		SendSysMessage(who, "Error reading in info.cfg ->"+info_config);
+		return 0;
+	endif
+	
+	GFSendGump(who, GumpTemplate(targ));
 endprogram
 
-
-function LocationGump(who, targ)
-	var gump := GumpTemplate(targ);
-	// Used to fix unused var report by ecompile: who;
-	who := who;
-	GFResizePic(gump, 160, 55, GFCfgConst("Defaults", "ForeGround"), 325, 95);
-	GFTextLine(gump, 185, 60, 2100, "X");
-	GFTextRight(gump, 475, 60, 2100, targ.x);
-	GFTextLine(gump, 185, 80, 2100, "Y");
-	GFTextRight(gump, 475, 80, 2100, targ.y);
-	GFTextLine(gump, 185, 100, 2100, "Z");
-	GFTextRight(gump, 475, 100, 2100, targ.z);
-	GFTextLine(gump, 185, 120, 2100, "Realm");
-	GFTextRight(gump, 475, 120, 2100, targ.realm);
-
-	return gump;
-endfunction
-
-
 function GumpTemplate(targ)
 
 	var gump := GFCreateGump();
@@ -85,43 +71,39 @@
 		GFTextRight(gump, 475, 22, 2100, "[Offline Player]");
 	endif
 
-	GFResizePic(gump, 15, 55, GFCfgConst("Defaults", "ForeGround"), 140, 410);
-	GFAddButton(gump, 20, 63, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 60, 2100, "General");
+	var menus := info_config["Index"];
+	var y_pos := 20;
+	foreach entry in ( GetConfigStringArray(menus, "Index") )
+		GFAddButton(gump, 20, (y_pos+3), 2117, 2118, GF_CLOSE_BTN, _entry_iter);
+		GFTextLine(gump, 40, y_pos, 2100, entry);
+		y_pos := y_pos+20;
+		sleepms(2);
+	endforeach
+	
+	return gump;
+endfunction
 
-	GFAddButton(gump, 20, 83, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 80, 2100, "Location");
+/*
+function LocationGump(who, targ)
+	var gump := GumpTemplate(targ);
+	// Used to fix unused var report by ecompile: who;
+	who := who;
+	GFResizePic(gump, 160, 55, GFCfgConst("Defaults", "ForeGround"), 325, 95);
+	GFTextLine(gump, 185, 60, 2100, "X");
+	GFTextRight(gump, 475, 60, 2100, targ.x);
+	GFTextLine(gump, 185, 80, 2100, "Y");
+	GFTextRight(gump, 475, 80, 2100, targ.y);
+	GFTextLine(gump, 185, 100, 2100, "Z");
+	GFTextRight(gump, 475, 100, 2100, targ.z);
+	GFTextLine(gump, 185, 120, 2100, "Realm");
+	GFTextRight(gump, 475, 120, 2100, targ.realm);
 
-	GFAddButton(gump, 20, 103, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 100, 2100, "Client");
+	return gump;
+endfunction
 
-	GFAddButton(gump, 20, 123, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 120, 2100, "Combat");
 
-	GFAddButton(gump, 20, 143, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 140, 2100, "Script");
 
-	GFAddButton(gump, 20, 163, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 160, 2100, "Reputation");
 
-	GFAddButton(gump, 20, 183, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 180, 2100, "Properties");
-
-	GFAddButton(gump, 20, 203, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 200, 2100, "Attributes");
-
-	GFAddButton(gump, 20, 223, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 220, 2100, "Privileges");
-
-	GFAddButton(gump, 20, 243, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 240, 2100, "Storage");
-	
-	GFAddButton(gump, 20, 263, 2117, 2118, GF_CLOSE_BTN, 1);
-	GFTextLine(gump, 40, 260, 2100, "Misc.");
-
-	return gump;
-endfunction
-
 function GeneralGump(who, targ)
 	var gump := GumpTemplate(targ);
 
@@ -297,3 +279,4 @@
 
 	return path;
 endfunction
+*/
\ No newline at end of file



From austin at berlios.de  Wed Nov 23 15:58:10 2005
From: austin at berlios.de (austin at BerliOS)
Date: Wed, 23 Nov 2005 15:58:10 +0100
Subject: [Poldistro-svn] r1044 - trunk/096/pkg/config
Message-ID: <200511231458.jANEwAci010681@sheep.berlios.de>

Author: austin
Date: 2005-11-23 15:58:10 +0100 (Wed, 23 Nov 2005)
New Revision: 1044

Removed:
   trunk/096/pkg/config/info.cfg
Log:
Put it in the wrong place, doh!

Deleted: trunk/096/pkg/config/info.cfg
===================================================================
--- trunk/096/pkg/config/info.cfg	2005-11-23 14:57:45 UTC (rev 1043)
+++ trunk/096/pkg/config/info.cfg	2005-11-23 14:58:10 UTC (rev 1044)
@@ -1,87 +0,0 @@
-Elem	Index
-{
-	Index	General
-	Index	Location
-	Index	Client
-	Index	Combat
-	Index	Script
-	Index	Reputation
-	Index	Properties
-	Index	Attributes
-	Index	Privileges
-	Index	Storage
-	Index	Miscellaneous
-}
-
-Elem	Index-General
-{
-	Group	NameAndTitles
-}
-
-Elem	Index-Location
-{
-	Group	Location
-}
-
-Elem	Index-Client
-{
-	Group	Client
-	Group	Account
-}
-
-Elem	Index-Combat
-{
-	Group	Combat
-	Group	WeaponInfo
-}
-
-Group	NameAndTitles
-{
-// 	Entry	Type	Display_Name	Property name	Editable
-	Entry	member	Title_Prefix	title_prefix	1
-	Entry	member	Name		name		1
-	Entry	member	Title_Suffix	title_suffix	1
-	Entry	member	Title_Race	title_race	1
-}
-
-Group	Location
-{
-	Entry	member	X	x	1
-	Entry	member	Y	y	1
-	Entry	member	Z	z	1
-	Entry	member	Realm	realm	1
-}
-
-Group	Client
-{
-	Entry	member	Connected	connected	0
-	Entry	member	IP_Address	ip		0
-	Entry	member	Client_Version	clientversion	0
-}
-
-Group	Account
-{
-	Entry	member	Account_Name	acctname	0
-	Entry	member	Account_Enabled	acct.enabled	0
-	Entry	member	Account_Banned	acct.banned	0
-}
-
-Group	Combat
-{
-	Entry	member	War_Mode		warmode		1
-	Entry	member	Armor_Rating_(AR)	ar		0
-	Entry	member	AR_Modifier		ar_mod		1
-	Entry	member	Attack_Speed_Mod	delay_mod	1
-}
-
-Group	WeaponInfo
-{
-	Entry	member	Weapon_Name	weapon.name	0
-	Entry	member	Weapon_Serial	weapon.serial	0
-	Entry	member	Weapon_Objtype	weapon.objtype	0
-	Entry	blank
-	Entry	custom	Weapon_Speed	0
-	Entry	member	Damage_Modifier	weapon.dmg_mod	1
-	Entry	custom	Damage_Dice	0
-	Entry	custom	Average_Damage	0
-}
\ No newline at end of file



From austin at berlios.de  Wed Nov 23 16:26:51 2005
From: austin at berlios.de (austin at BerliOS)
Date: Wed, 23 Nov 2005 16:26:51 +0100
Subject: [Poldistro-svn] r1045 - trunk/096/pkg/commands/gm
Message-ID: <200511231526.jANFQpWb013063@sheep.berlios.de>

Author: austin
Date: 2005-11-23 16:26:51 +0100 (Wed, 23 Nov 2005)
New Revision: 1045

Modified:
   trunk/096/pkg/commands/gm/info.src
Log:
Starting to make the config driven .info work.

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-23 14:58:10 UTC (rev 1044)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-23 15:26:51 UTC (rev 1045)
@@ -21,8 +21,6 @@
 
 unload_scripts("");
 
-var info_config;	// Makes the script easier to use with this being global.
-
 var priv_names := array
 {
 	"ignoredoors", "seeinvisitems", "seehidden", "seeghosts",
@@ -30,13 +28,25 @@
 	"dblclickany", "clotheany", "freemove"
 };
 
+// Storing these globally just makes the script easier to use...
+var info_cfg;			// info.cfg
+var index_list; 		// info.cfg "Index" lines from Index elem
+var template;			// Template gump (so it doesn't need to be rebuilt)
+var gump_list := array{};	// Gumps for each index category
+
 program textcmd_Info(who, serial)
-
+	info_cfg := ReadConfigFile(":commands:config/info");
+	if ( !info_cfg )
+		SendSysMessage(who, "Error reading in info.cfg ->"+info_cfg);
+		return 0;
+	else
+		index_list := GetConfigStringArray(info_cfg["Index"], "Index");
+	endif
+	
 	var targ := who;
-
 	if ( serial )
 		targ := SystemFindObjectBySerial(CInt(serial));
-	else
+	elseif ( !targ )
 		targ := Target(who);
 	endif
 	if ( !targ.IsA(POLCLASS_MOBILE) )
@@ -44,16 +54,41 @@
 		//return 0;
 		targ := who;
 	endif
-
-	var info_config := ReadConfigFile(":commands:config/info");
-	if ( !info_config )
-		SendSysMessage(who, "Error reading in info.cfg ->"+info_config);
-		return 0;
-	endif
+	template := GumpTemplate(targ);
 	
-	GFSendGump(who, GumpTemplate(targ));
+	BuildGumps(who, targ);
+	
+	GFSendGump(who, gump_list[1]);
 endprogram
 
+function BuildGumps(who, targ)
+	foreach index in ( index_list)
+		var gump := template;
+		var cfg_elem := info_cfg["Index-"+index];
+		var groups := GetConfigStringArray(cfg_elem, "Group");
+		var y_pos := 55;
+		foreach group in ( groups )
+			var group_elem := info_cfg[group];
+			BuildEntries(gump, group_elem, y_pos);
+			sleepms(2);
+		endforeach
+		sleepms(2);
+		gump_list.Append(gump);
+	endforeach
+endfunction
+
+function BuildEntries(byref gump, byref group_elem, byref y_pos)
+	var entries := GetConfigStringArray(group_elem, "Entry");
+	var num_entries := entries.Size();
+	
+	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_entries*20));
+	foreach entry in ( entries )
+		GFTextLine(gump, 175, y_pos, 2100, entry);
+		y_pos := y_pos+20;
+		sleepms(2);
+	endforeach
+endfunction			
+
 function GumpTemplate(targ)
 
 	var gump := GFCreateGump();
@@ -71,9 +106,10 @@
 		GFTextRight(gump, 475, 22, 2100, "[Offline Player]");
 	endif
 
-	var menus := info_config["Index"];
-	var y_pos := 20;
-	foreach entry in ( GetConfigStringArray(menus, "Index") )
+	GFResizePic(gump, 15, 55, GFCfgConst("Defaults", "ForeGround"), 125, 410);
+	var index := info_cfg["Index"];
+	var y_pos := 60;
+	foreach entry in ( index_list )
 		GFAddButton(gump, 20, (y_pos+3), 2117, 2118, GF_CLOSE_BTN, _entry_iter);
 		GFTextLine(gump, 40, y_pos, 2100, entry);
 		y_pos := y_pos+20;



From austin at berlios.de  Wed Nov 23 16:34:31 2005
From: austin at berlios.de (austin at BerliOS)
Date: Wed, 23 Nov 2005 16:34:31 +0100
Subject: [Poldistro-svn] r1046 - trunk/096/pkg/commands/gm
Message-ID: <200511231534.jANFYVTD014086@sheep.berlios.de>

Author: austin
Date: 2005-11-23 16:34:31 +0100 (Wed, 23 Nov 2005)
New Revision: 1046

Modified:
   trunk/096/pkg/commands/gm/info.src
Log:
More progress!
Itll parse the 'member' entries :-D

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-23 15:26:51 UTC (rev 1045)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-23 15:34:31 UTC (rev 1046)
@@ -42,7 +42,7 @@
 	else
 		index_list := GetConfigStringArray(info_cfg["Index"], "Index");
 	endif
-	
+
 	var targ := who;
 	if ( serial )
 		targ := SystemFindObjectBySerial(CInt(serial));
@@ -55,13 +55,13 @@
 		targ := who;
 	endif
 	template := GumpTemplate(targ);
-	
-	BuildGumps(who, targ);
-	
+
+	BuildGumps(targ);
+
 	GFSendGump(who, gump_list[1]);
 endprogram
 
-function BuildGumps(who, targ)
+function BuildGumps(targ)
 	foreach index in ( index_list)
 		var gump := template;
 		var cfg_elem := info_cfg["Index-"+index];
@@ -69,7 +69,7 @@
 		var y_pos := 55;
 		foreach group in ( groups )
 			var group_elem := info_cfg[group];
-			BuildEntries(gump, group_elem, y_pos);
+			BuildEntries(targ, gump, group_elem, y_pos);
 			sleepms(2);
 		endforeach
 		sleepms(2);
@@ -77,18 +77,33 @@
 	endforeach
 endfunction
 
-function BuildEntries(byref gump, byref group_elem, byref y_pos)
+function BuildEntries(targ, byref gump, byref group_elem, byref y_pos)
 	var entries := GetConfigStringArray(group_elem, "Entry");
 	var num_entries := entries.Size();
-	
+
 	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_entries*20));
 	foreach entry in ( entries )
-		GFTextLine(gump, 175, y_pos, 2100, entry);
-		y_pos := y_pos+20;
+		entry := SplitWords(entry);
+		case ( Lower(entry[1]) )
+			"member": AddMemberEntry(targ, gump, entry, y_pos);
+			default: GFTextLine(175, y_pos, "Ahhhh ERRRRRROOORRRR!!!");
+		endcase
+		
 		sleepms(2);
 	endforeach
-endfunction			
+endfunction
 
+function AddMemberEntry(targ, byref gump, byref entry, byref y_pos)
+	//GFTextLine(gump, 175, y_pos, 2100, entry);
+	if ( entry[4] )
+		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
+	endif
+	GFTextLine(gump, 175, y_pos, 2100, entry[2]);
+	GFTextRight(gump, 480, y_pos, 2100, targ.Get_Member(entry[3]));
+		
+	y_pos := y_pos+20;
+endfunction
+
 function GumpTemplate(targ)
 
 	var gump := GFCreateGump();
@@ -115,7 +130,7 @@
 		y_pos := y_pos+20;
 		sleepms(2);
 	endforeach
-	
+
 	return gump;
 endfunction
 
@@ -233,7 +248,7 @@
 		wpn_speed := cfg.Speed;
 		wpn_dice := cfg.Damage;
 	endif
-	
+
 	var average := CS_GetAverageDamage(weapon);
 
 	GFTextLine(gump, 185, 180, 2100, "Weapon Name");



From austin at berlios.de  Wed Nov 23 16:37:58 2005
From: austin at berlios.de (austin at BerliOS)
Date: Wed, 23 Nov 2005 16:37:58 +0100
Subject: [Poldistro-svn] r1047 - trunk/096/pkg/commands/gm
Message-ID: <200511231537.jANFbwEw014334@sheep.berlios.de>

Author: austin
Date: 2005-11-23 16:37:58 +0100 (Wed, 23 Nov 2005)
New Revision: 1047

Modified:
   trunk/096/pkg/commands/gm/info.src
Log:


Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-23 15:34:31 UTC (rev 1046)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-23 15:37:58 UTC (rev 1047)
@@ -32,7 +32,6 @@
 var info_cfg;			// info.cfg
 var index_list; 		// info.cfg "Index" lines from Index elem
 var template;			// Template gump (so it doesn't need to be rebuilt)
-var gump_list := array{};	// Gumps for each index category
 
 program textcmd_Info(who, serial)
 	info_cfg := ReadConfigFile(":commands:config/info");
@@ -55,26 +54,24 @@
 		targ := who;
 	endif
 	template := GumpTemplate(targ);
-
-	BuildGumps(targ);
-
-	GFSendGump(who, gump_list[1]);
+	var cur_gump := 1;
+	
+	GFSendGump(who, BuildGump(targ, 2));
 endprogram
 
-function BuildGumps(targ)
-	foreach index in ( index_list)
-		var gump := template;
-		var cfg_elem := info_cfg["Index-"+index];
-		var groups := GetConfigStringArray(cfg_elem, "Group");
-		var y_pos := 55;
-		foreach group in ( groups )
-			var group_elem := info_cfg[group];
-			BuildEntries(targ, gump, group_elem, y_pos);
-			sleepms(2);
-		endforeach
+function BuildGump(targ, index_num)
+	var index := index_list[index_num];
+	var gump := template;
+	var cfg_elem := info_cfg["Index-"+index];
+	var groups := GetConfigStringArray(cfg_elem, "Group");
+	var y_pos := 55;
+	foreach group in ( groups )
+		var group_elem := info_cfg[group];
+		BuildEntries(targ, gump, group_elem, y_pos);
 		sleepms(2);
-		gump_list.Append(gump);
 	endforeach
+	
+	return gump;
 endfunction
 
 function BuildEntries(targ, byref gump, byref group_elem, byref y_pos)



From austin at berlios.de  Wed Nov 23 16:41:22 2005
From: austin at berlios.de (austin at BerliOS)
Date: Wed, 23 Nov 2005 16:41:22 +0100
Subject: [Poldistro-svn] r1048 - trunk/096/pkg/commands/gm
Message-ID: <200511231541.jANFfMBc014613@sheep.berlios.de>

Author: austin
Date: 2005-11-23 16:41:21 +0100 (Wed, 23 Nov 2005)
New Revision: 1048

Modified:
   trunk/096/pkg/commands/gm/info.src
Log:
Proper case break; formatting


Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-23 15:37:58 UTC (rev 1047)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-23 15:41:21 UTC (rev 1048)
@@ -82,8 +82,16 @@
 	foreach entry in ( entries )
 		entry := SplitWords(entry);
 		case ( Lower(entry[1]) )
-			"member": AddMemberEntry(targ, gump, entry, y_pos);
-			default: GFTextLine(175, y_pos, "Ahhhh ERRRRRROOORRRR!!!");
+			"member": 
+				AddMemberEntry(targ, gump, entry, y_pos);
+				break;
+			"blank": 
+				y_pos := y_pos + 20;
+				break;
+			default: 
+				GFTextLine(gump, 175, y_pos, 32, entry); 
+				y_pos:=y_pos+20; 
+				break;
 		endcase
 		
 		sleepms(2);



From muaddiblsd at berlios.de  Thu Nov 24 04:14:39 2005
From: muaddiblsd at berlios.de (muaddiblsd at BerliOS)
Date: Thu, 24 Nov 2005 04:14:39 +0100
Subject: [Poldistro-svn] r1049 - trunk/096/config
Message-ID: <200511240314.jAO3Ed2d017373@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-24 04:14:34 +0100 (Thu, 24 Nov 2005)
New Revision: 1049

Modified:
   trunk/096/config/combat.cfg
Log:


Modified: trunk/096/config/combat.cfg
===================================================================
--- trunk/096/config/combat.cfg	2005-11-23 15:41:21 UTC (rev 1048)
+++ trunk/096/config/combat.cfg	2005-11-24 03:14:34 UTC (rev 1049)
@@ -1,4 +1,4 @@
-# $id$
+# $Id$
 #
 # Purpose:
 # Defines some combat-specific options.
@@ -7,7 +7,9 @@
 #
 #[DisplayParrySuccessMessages (0/1)]
 #[WarmodeInhibitsRegen        (0/1)]
+#[WarModeDelay                (int seconds for delay)]
 #
 
 DisplayParrySuccessMessages	0
 WarmodeInhibitsRegen		0
+WarModeDelay			2
\ No newline at end of file



From austin at berlios.de  Thu Nov 24 04:39:16 2005
From: austin at berlios.de (austin at BerliOS)
Date: Thu, 24 Nov 2005 04:39:16 +0100
Subject: [Poldistro-svn] r1050 - in trunk/096/pkg/commands: config gm
Message-ID: <200511240339.jAO3dGsp015515@sheep.berlios.de>

Author: austin
Date: 2005-11-24 04:39:13 +0100 (Thu, 24 Nov 2005)
New Revision: 1050

Modified:
   trunk/096/pkg/commands/config/info.cfg
   trunk/096/pkg/commands/gm/info.src
Log:
.info updates

Modified: trunk/096/pkg/commands/config/info.cfg
===================================================================
--- trunk/096/pkg/commands/config/info.cfg	2005-11-24 03:14:34 UTC (rev 1049)
+++ trunk/096/pkg/commands/config/info.cfg	2005-11-24 03:39:13 UTC (rev 1050)
@@ -87,7 +87,7 @@
 
 Group	WeaponInfo
 {
-	Entry	member	Weapon_Name	weapon.name	0
+	Entry	member	Weapon_Name	weapon.desc	0
 	Entry	member	Weapon_Serial	weapon.serial	0
 	Entry	member	Weapon_Objtype	weapon.objtype	0
 	Entry	blank

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-24 03:14:34 UTC (rev 1049)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-24 03:39:13 UTC (rev 1050)
@@ -42,7 +42,7 @@
 		index_list := GetConfigStringArray(info_cfg["Index"], "Index");
 	endif
 
-	var targ := who;
+	var targ;
 	if ( serial )
 		targ := SystemFindObjectBySerial(CInt(serial));
 	elseif ( !targ )
@@ -56,7 +56,15 @@
 	template := GumpTemplate(targ);
 	var cur_gump := 1;
 	
-	GFSendGump(who, BuildGump(targ, 2));
+	while ( 1 )
+		cur_gump := GFSendGump(who, BuildGump(targ, cur_gump));
+		cur_gump := cur_gump[0];
+		if ( !who.connected )
+			break;
+		elseif ( !cur_gump )
+			break;
+		endif
+	endwhile
 endprogram
 
 function BuildGump(targ, index_num)
@@ -68,6 +76,7 @@
 	foreach group in ( groups )
 		var group_elem := info_cfg[group];
 		BuildEntries(targ, gump, group_elem, y_pos);
+		y_pos := y_pos+5;
 		sleepms(2);
 	endforeach
 	
@@ -80,7 +89,7 @@
 
 	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_entries*20));
 	foreach entry in ( entries )
-		entry := SplitWords(entry);
+		entry := SplitWords(entry, " ");
 		case ( Lower(entry[1]) )
 			"member": 
 				AddMemberEntry(targ, gump, entry, y_pos);
@@ -103,12 +112,37 @@
 	if ( entry[4] )
 		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
 	endif
-	GFTextLine(gump, 175, y_pos, 2100, entry[2]);
-	GFTextRight(gump, 480, y_pos, 2100, targ.Get_Member(entry[3]));
+	GFTextLine(gump, 175, y_pos, 2100, ParseEntryName(entry[2]));
+	GFTextRight(gump, 480, y_pos, 2100, ParseMembers(targ, entry[3]));
 		
 	y_pos := y_pos+20;
 endfunction
 
+function ParseEntryName(entry_name)
+	while ( entry_name["_"] )
+		entry_name["_"] := " ";
+		sleepms(2);
+	endwhile
+	return entry_name;
+endfunction
+
+function ParseMembers(targ, members)
+	members := SplitWords(members, ".");
+	var result := targ;
+	foreach member in ( members )
+		var temp := result.Get_Member(member);
+		if ( temp != error ) 
+			result := temp;
+		else
+			result := "error";
+			break;
+		endif
+		
+		sleepms(2);
+	endforeach
+	return CStr(result);
+endfunction
+
 function GumpTemplate(targ)
 
 	var gump := GFCreateGump();
@@ -127,7 +161,7 @@
 	endif
 
 	GFResizePic(gump, 15, 55, GFCfgConst("Defaults", "ForeGround"), 125, 410);
-	var index := info_cfg["Index"];
+	
 	var y_pos := 60;
 	foreach entry in ( index_list )
 		GFAddButton(gump, 20, (y_pos+3), 2117, 2118, GF_CLOSE_BTN, _entry_iter);



From austin at berlios.de  Thu Nov 24 05:28:40 2005
From: austin at berlios.de (austin at BerliOS)
Date: Thu, 24 Nov 2005 05:28:40 +0100
Subject: [Poldistro-svn] r1051 - in trunk/096/pkg/commands: config gm
Message-ID: <200511240428.jAO4SecQ031341@sheep.berlios.de>

Author: austin
Date: 2005-11-24 05:28:37 +0100 (Thu, 24 Nov 2005)
New Revision: 1051

Modified:
   trunk/096/pkg/commands/config/info.cfg
   trunk/096/pkg/commands/gm/info.src
Log:


Modified: trunk/096/pkg/commands/config/info.cfg
===================================================================
--- trunk/096/pkg/commands/config/info.cfg	2005-11-24 03:39:13 UTC (rev 1050)
+++ trunk/096/pkg/commands/config/info.cfg	2005-11-24 04:28:37 UTC (rev 1051)
@@ -7,7 +7,8 @@
 	Index	Script
 	Index	Reputation
 	Index	Properties
-	Index	Attributes
+	Index	Stats & Vitals
+	Index	Skills
 	Index	Privileges
 	Index	Storage
 	Index	Miscellaneous
@@ -46,8 +47,25 @@
 	Group	Reputation
 }
 
+Elem	Index-Properties
+{
+	Group	Properties
+}
+
+Elem	Index-Stats & Vitals
+{
+	Group	Vitals
+	Group	Stats
+}
+
+Elem	Index-Attributes
+{
+	Group	Attributes
+}
+
 Group	NameAndTitles
 {
+	AutoBox	1
 // 	Entry	Type	Display_Name	Property name	Editable
 	Entry	member	Title_Prefix	title_prefix	1
 	Entry	member	Name		name		1
@@ -57,6 +75,7 @@
 
 Group	Location
 {
+	AutoBox	1
 	Entry	member	X	x	1
 	Entry	member	Y	y	1
 	Entry	member	Z	z	1
@@ -65,6 +84,7 @@
 
 Group	Client
 {
+	AutoBox	1
 	Entry	member	Connected	connected	0
 	Entry	member	IP_Address	ip		0
 	Entry	member	Client_Version	clientversion	0
@@ -72,6 +92,7 @@
 
 Group	Account
 {
+	AutoBox	1
 	Entry	member	Account_Name	acctname	0
 	Entry	member	Account_Enabled	acct.enabled	0
 	Entry	member	Account_Banned	acct.banned	0
@@ -79,6 +100,7 @@
 
 Group	Combat
 {
+	AutoBox	1
 	Entry	member	War_Mode		warmode		1
 	Entry	member	Armor_Rating_(AR)	ar		0
 	Entry	member	AR_Modifier		ar_mod		1
@@ -87,6 +109,7 @@
 
 Group	WeaponInfo
 {
+	AutoBox	1
 	Entry	member	Weapon_Name	weapon.desc	0
 	Entry	member	Weapon_Serial	weapon.serial	0
 	Entry	member	Weapon_Objtype	weapon.objtype	0
@@ -99,12 +122,14 @@
 
 Group	Script
 {
+	AutoBox	1
 	Entry	member	Attached_Script	attached.name	0
 	Entry	member	Attached_Pid	attached.pid	0
 }
 
 Group	AI
 {
+	AutoBox	1
 	Entry	member	AI_Script	script		0
 	Entry	member	AI_Pid		process.pid	0
 	Entry	member	Event_Mask	eventmask	0
@@ -113,8 +138,30 @@
 	
 Group	Reputation
 {
+	AutoBox	1
 	Entry	member	Criminal	criminal	1
 	Entry	member	Murderer	murderer	1
 	Entry	blank
 	Entry	custom	Reportables	0
-}
\ No newline at end of file
+}
+
+Group	Properties
+{
+	AutoBox	1
+	
+}
+
+Group	Vitals
+{
+	Entry	Vitals
+}
+
+Group	Stats
+{
+	Entry	Attributes	Stats
+}
+
+Group	Skills
+{
+	Entry	Attributes	Skills
+}

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-24 03:39:13 UTC (rev 1050)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-24 04:28:37 UTC (rev 1051)
@@ -42,7 +42,7 @@
 		index_list := GetConfigStringArray(info_cfg["Index"], "Index");
 	endif
 
-	var targ;
+	var targ := who;
 	if ( serial )
 		targ := SystemFindObjectBySerial(CInt(serial));
 	elseif ( !targ )
@@ -86,14 +86,19 @@
 function BuildEntries(targ, byref gump, byref group_elem, byref y_pos)
 	var entries := GetConfigStringArray(group_elem, "Entry");
 	var num_entries := entries.Size();
-
-	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_entries*20));
+	
+	if ( group_elem.AutoBox )
+		GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_entries*20));
+	endif
+	
 	foreach entry in ( entries )
 		entry := SplitWords(entry, " ");
 		case ( Lower(entry[1]) )
 			"member": 
 				AddMemberEntry(targ, gump, entry, y_pos);
 				break;
+			"vitals":
+				DisplayVitals(targ, gump, y_pos);				
 			"blank": 
 				y_pos := y_pos + 20;
 				break;
@@ -105,19 +110,38 @@
 		
 		sleepms(2);
 	endforeach
+	
+	return 1;
 endfunction
 
 function AddMemberEntry(targ, byref gump, byref entry, byref y_pos)
-	//GFTextLine(gump, 175, y_pos, 2100, entry);
-	if ( entry[4] )
+	if ( CInt(entry[4]) )
 		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
 	endif
 	GFTextLine(gump, 175, y_pos, 2100, ParseEntryName(entry[2]));
 	GFTextRight(gump, 480, y_pos, 2100, ParseMembers(targ, entry[3]));
 		
 	y_pos := y_pos+20;
+	
+	return 1;
 endfunction
 
+function DisplayVitals(targ, byref gump, byref y_pos)
+	var vitals := AP_GetVitalNames();
+	var num_vitals := vitals.size();
+	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_vitals*20));
+	foreach vital_name in ( vitals )
+		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
+		GFTextLine(gump, 175, y_pos, 2100, vital_name);
+		var value := AP_GetVital(targ, vital_name);
+		var max_value := AP_GetVitalMaximumValue(targ, vital_name);
+		GFTextRight(gump, 480, y_pos, 2100, value+" / "+max_value);
+		y_pos := y_pos+20;
+	endforeach
+	
+	return 1;
+endfunction
+
 function ParseEntryName(entry_name)
 	while ( entry_name["_"] )
 		entry_name["_"] := " ";



From austin at berlios.de  Thu Nov 24 06:42:20 2005
From: austin at berlios.de (austin at BerliOS)
Date: Thu, 24 Nov 2005 06:42:20 +0100
Subject: [Poldistro-svn] r1052 - trunk/096/pkg/commands/gm
Message-ID: <200511240542.jAO5gKnj023393@sheep.berlios.de>

Author: austin
Date: 2005-11-24 06:42:10 +0100 (Thu, 24 Nov 2005)
New Revision: 1052

Modified:
   trunk/096/pkg/commands/gm/info.src
Log:


Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-24 04:28:37 UTC (rev 1051)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-24 05:42:10 UTC (rev 1052)
@@ -19,6 +19,9 @@
 include ":containers:storageAreas";
 include ":combat:weaponInfo";
 
+CONST START_Y	:= 55;
+CONST END_Y	:= 410;
+
 unload_scripts("");
 
 var priv_names := array
@@ -72,7 +75,7 @@
 	var gump := template;
 	var cfg_elem := info_cfg["Index-"+index];
 	var groups := GetConfigStringArray(cfg_elem, "Group");
-	var y_pos := 55;
+	var y_pos := START_Y;
 	foreach group in ( groups )
 		var group_elem := info_cfg[group];
 		BuildEntries(targ, gump, group_elem, y_pos);
@@ -85,9 +88,8 @@
 
 function BuildEntries(targ, byref gump, byref group_elem, byref y_pos)
 	var entries := GetConfigStringArray(group_elem, "Entry");
-	var num_entries := entries.Size();
-	
 	if ( group_elem.AutoBox )
+		var num_entries := entries.Size();
 		GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_entries*20));
 	endif
 	
@@ -98,16 +100,19 @@
 				AddMemberEntry(targ, gump, entry, y_pos);
 				break;
 			"vitals":
-				DisplayVitals(targ, gump, y_pos);				
+				DisplayVitals(targ, gump, y_pos);
+				break;
+			"attributes":
+				DisplayAttributes(targ, gump, entry, y_pos);
+				break;			
 			"blank": 
-				y_pos := y_pos + 20;
+				y_pos := y_pos+20;
 				break;
 			default: 
 				GFTextLine(gump, 175, y_pos, 32, entry); 
-				y_pos:=y_pos+20; 
+				y_pos := y_pos+20;
 				break;
 		endcase
-		
 		sleepms(2);
 	endforeach
 	
@@ -120,9 +125,8 @@
 	endif
 	GFTextLine(gump, 175, y_pos, 2100, ParseEntryName(entry[2]));
 	GFTextRight(gump, 480, y_pos, 2100, ParseMembers(targ, entry[3]));
-		
+	
 	y_pos := y_pos+20;
-	
 	return 1;
 endfunction
 
@@ -137,11 +141,33 @@
 		var max_value := AP_GetVitalMaximumValue(targ, vital_name);
 		GFTextRight(gump, 480, y_pos, 2100, value+" / "+max_value);
 		y_pos := y_pos+20;
+		sleepms(2);
 	endforeach
 	
 	return 1;
 endfunction
 
+function DisplayAttributes(targ, byref gump, byref entry, byref y_pos)
+	var type := entry[2];
+	var attributes := AP_ListAttributesByType("Stats");
+	var num_attribs := attributes.Size();
+	
+	var y_space := (END_Y-y_pos)+START_Y;
+	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, y_space);
+	
+	foreach attrib_name in ( attributes )
+		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
+		GFTextLine(gump, 175, y_pos, 2100, attrib_name);
+		var value := AP_GetTrueSkill(targ, attrib_name);
+		var mod_value := AP_GetSkillMod(targ, attrib_name);
+		GFTextRight(gump, 480, y_pos, 2100, value+" (+"+mod_value+")");
+		y_pos := y_pos+20;
+		sleepms(2);
+	endforeach
+	
+	return 1;
+endfunction	
+
 function ParseEntryName(entry_name)
 	while ( entry_name["_"] )
 		entry_name["_"] := " ";
@@ -170,7 +196,7 @@
 function GumpTemplate(targ)
 
 	var gump := GFCreateGump();
-
+	GFPage(gump, 0);
 	GFResizePic(gump, 0, 0, GFCfgConst("Defaults", "BackGround"), 500, 480);
 
 	GFResizePic(gump, 15, 15, GFCfgConst("Defaults", "ForeGround"), 470, 35);
@@ -184,7 +210,7 @@
 		GFTextRight(gump, 475, 22, 2100, "[Offline Player]");
 	endif
 
-	GFResizePic(gump, 15, 55, GFCfgConst("Defaults", "ForeGround"), 125, 410);
+	GFResizePic(gump, 15, START_Y, GFCfgConst("Defaults", "ForeGround"), 125, END_Y);
 	
 	var y_pos := 60;
 	foreach entry in ( index_list )
@@ -193,6 +219,7 @@
 		y_pos := y_pos+20;
 		sleepms(2);
 	endforeach
+	GFPage(gump, 1);
 
 	return gump;
 endfunction



From austin at berlios.de  Thu Nov 24 06:54:45 2005
From: austin at berlios.de (austin at BerliOS)
Date: Thu, 24 Nov 2005 06:54:45 +0100
Subject: [Poldistro-svn] r1053 - trunk/096/pkg/systems/attributes/startup
Message-ID: <200511240554.jAO5sjBR029073@sheep.berlios.de>

Author: austin
Date: 2005-11-24 06:54:35 +0100 (Thu, 24 Nov 2005)
New Revision: 1053

Modified:
   trunk/096/pkg/systems/attributes/startup/attributeCache.src
Log:
Fixes a bug with caching categories.
The type names are now properly stored in lowercase.

Modified: trunk/096/pkg/systems/attributes/startup/attributeCache.src
===================================================================
--- trunk/096/pkg/systems/attributes/startup/attributeCache.src	2005-11-24 05:42:10 UTC (rev 1052)
+++ trunk/096/pkg/systems/attributes/startup/attributeCache.src	2005-11-24 05:54:35 UTC (rev 1053)
@@ -18,9 +18,9 @@
 	var cfg_file := AP_GetAttributesCfgFile();
 	foreach elem_name in ( GetConfigStringKeys(cfg_file) )
 		var cfg_elem := AP_GetAttributeCfgElem(elem_name, cfg_file);
-		var type_name := cfg_elem.AttributeType;
+		var type_name := Lower(cfg_elem.AttributeType);
 		if ( !type_name )
-			type_name := "Unknown";
+			type_name := "unknown";
 		endif
 		
 		var type_list := data_elem.GetProp(type_name);



From austin at berlios.de  Thu Nov 24 07:04:51 2005
From: austin at berlios.de (austin at BerliOS)
Date: Thu, 24 Nov 2005 07:04:51 +0100
Subject: [Poldistro-svn] r1054 - in trunk/096/pkg/commands: config gm
Message-ID: <200511240604.jAO64p8F000987@sheep.berlios.de>

Author: austin
Date: 2005-11-24 07:04:27 +0100 (Thu, 24 Nov 2005)
New Revision: 1054

Modified:
   trunk/096/pkg/commands/config/info.cfg
   trunk/096/pkg/commands/gm/info.src
Log:


Modified: trunk/096/pkg/commands/config/info.cfg
===================================================================
--- trunk/096/pkg/commands/config/info.cfg	2005-11-24 05:54:35 UTC (rev 1053)
+++ trunk/096/pkg/commands/config/info.cfg	2005-11-24 06:04:27 UTC (rev 1054)
@@ -158,10 +158,10 @@
 
 Group	Stats
 {
-	Entry	Attributes	Stats
+	Entry	Attributes	Stat
 }
 
 Group	Skills
 {
-	Entry	Attributes	Skills
+	Entry	Attributes	Skill
 }

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-24 05:54:35 UTC (rev 1053)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-24 06:04:27 UTC (rev 1054)
@@ -149,7 +149,7 @@
 
 function DisplayAttributes(targ, byref gump, byref entry, byref y_pos)
 	var type := entry[2];
-	var attributes := AP_ListAttributesByType("Stats");
+	var attributes := AP_ListAttributesByType("Stat");
 	var num_attribs := attributes.Size();
 	
 	var y_space := (END_Y-y_pos)+START_Y;



From austin at berlios.de  Thu Nov 24 09:29:17 2005
From: austin at berlios.de (austin at BerliOS)
Date: Thu, 24 Nov 2005 09:29:17 +0100
Subject: [Poldistro-svn] r1055 - trunk/096
Message-ID: <200511240829.jAO8THFs004884@sheep.berlios.de>

Author: austin
Date: 2005-11-24 09:29:10 +0100 (Thu, 24 Nov 2005)
New Revision: 1055

Modified:
   trunk/096/CoreChanges-096.txt
Log:


Modified: trunk/096/CoreChanges-096.txt
===================================================================
--- trunk/096/CoreChanges-096.txt	2005-11-24 06:04:27 UTC (rev 1054)
+++ trunk/096/CoreChanges-096.txt	2005-11-24 08:29:10 UTC (rev 1055)
@@ -1,3 +1,18 @@
+11-23 Austin
+        Fixed : account.Get_Member(member name) now works.
+        Fixed : .Get_Member(member name) for script objects now works.
+    
+11-23 MuadDib
+        Added : Added second optional param to SplitWords() function. Second param now defaults to space.
+                Allows use of "bleh" "+" "," "_," "." etc. as the delimiter instead of just whitespace.
+        Added : New combat.cfg setting "WarModeDelay". Setting is in Integer for Seconds delay between
+                ability to toggle war mode status via client. Does not affect using SetWarMode method.
+
+11-20 Austin
+        Fixed : Attempt # 2 with *InBox() coordinate checks. 
+        Fixed : Region scripts (EnterScript / LeaveScript) no longer need an 
+                EnterText and LeaveText to work.
+
 11-15 Austin
         Added : using "::regions/" in a config path will allow a config file from pol/regions/ to be read.
                 Example ReadConfigFile("::regions/justice");



From austin at berlios.de  Thu Nov 24 10:38:11 2005
From: austin at berlios.de (austin at BerliOS)
Date: Thu, 24 Nov 2005 10:38:11 +0100
Subject: [Poldistro-svn] r1056 - trunk/096/config
Message-ID: <200511240938.jAO9cBCX011346@sheep.berlios.de>

Author: austin
Date: 2005-11-24 10:38:08 +0100 (Thu, 24 Nov 2005)
New Revision: 1056

Modified:
   trunk/096/config/servspecopt.cfg
Log:
Tired of a 5 second wait :-D

Modified: trunk/096/config/servspecopt.cfg
===================================================================
--- trunk/096/config/servspecopt.cfg	2005-11-24 08:29:10 UTC (rev 1055)
+++ trunk/096/config/servspecopt.cfg	2005-11-24 09:38:08 UTC (rev 1056)
@@ -18,7 +18,7 @@
 # DoubleClickWait - Number of seconds that must pass before a player can
 #                   double click an object again.
 #
-DoubleClickWait=5
+DoubleClickWait=2
 
 #
 # EventVisibilityCoreChecks - If enabled, the core will not send system events



From austin at berlios.de  Thu Nov 24 12:42:31 2005
From: austin at berlios.de (austin at BerliOS)
Date: Thu, 24 Nov 2005 12:42:31 +0100
Subject: [Poldistro-svn] r1057 - in trunk/096/pkg/commands: config gm
Message-ID: <200511241142.jAOBgVt5026307@sheep.berlios.de>

Author: austin
Date: 2005-11-24 12:42:29 +0100 (Thu, 24 Nov 2005)
New Revision: 1057

Modified:
   trunk/096/pkg/commands/config/info.cfg
   trunk/096/pkg/commands/gm/info.src
Log:
Updated info.cfg to give examples and to give an idea of what im planning to do in the script.


Modified: trunk/096/pkg/commands/config/info.cfg
===================================================================
--- trunk/096/pkg/commands/config/info.cfg	2005-11-24 09:38:08 UTC (rev 1056)
+++ trunk/096/pkg/commands/config/info.cfg	2005-11-24 11:42:29 UTC (rev 1057)
@@ -1,3 +1,40 @@
+####################################
+# $Id$
+#
+# Elem	Index
+# {
+#	Index	IndexName
+# }
+#
+# Elem	Index-IndexName
+# {
+#	Group	GroupName
+# }
+#
+# Group	GroupName
+# {
+#	// Stanard member (.whatever) entry
+#	Entry	member	Display_Name	PropertyNames	ValueParser	Editable	EditFunction
+#	Entry	member	Weapon_Name	weapon.desc	0	1	0
+#
+#	// Display Vitals
+#	Entry	vitals
+#
+#	// Display attributes in a category
+#	Entry	Attributes	CategoryName
+#	Entry	Attributes	Stat
+#
+#	// Display specific attribute
+#	Entry	Attribute	AttributeName
+#	Entry	Attribute	Swordsmanship
+#
+#	// Custom parameter (must edit BuildEntries() and write a function to support this param type)
+#	Entry	Custom	EntryName (data)
+#	Entry	Custom	Reportables	
+# }
+#
+####################################
+
 Elem	Index
 {
 	Index	General

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-24 09:38:08 UTC (rev 1056)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-24 11:42:29 UTC (rev 1057)
@@ -56,6 +56,7 @@
 		//return 0;
 		targ := who;
 	endif
+	
 	template := GumpTemplate(targ);
 	var cur_gump := 1;
 	
@@ -123,9 +124,12 @@
 	if ( CInt(entry[4]) )
 		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
 	endif
+	
 	GFTextLine(gump, 175, y_pos, 2100, ParseEntryName(entry[2]));
-	GFTextRight(gump, 480, y_pos, 2100, ParseMembers(targ, entry[3]));
 	
+	var value := ParseMembers(targ, entry[3]);
+	GFTextRight(gump, 480, y_pos, 2100, value);
+	
 	y_pos := y_pos+20;
 	return 1;
 endfunction
@@ -152,8 +156,9 @@
 	var attributes := AP_ListAttributesByType("Stat");
 	var num_attribs := attributes.Size();
 	
+	var y_needed := num_attribs * 20;	
 	var y_space := (END_Y-y_pos)+START_Y;
-	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, y_space);
+	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, y_needed);
 	
 	foreach attrib_name in ( attributes )
 		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
@@ -184,7 +189,7 @@
 		if ( temp != error ) 
 			result := temp;
 		else
-			result := "error";
+			result := "None";
 			break;
 		endif
 		
@@ -224,188 +229,6 @@
 	return gump;
 endfunction
 
-/*
-function LocationGump(who, targ)
-	var gump := GumpTemplate(targ);
-	// Used to fix unused var report by ecompile: who;
-	who := who;
-	GFResizePic(gump, 160, 55, GFCfgConst("Defaults", "ForeGround"), 325, 95);
-	GFTextLine(gump, 185, 60, 2100, "X");
-	GFTextRight(gump, 475, 60, 2100, targ.x);
-	GFTextLine(gump, 185, 80, 2100, "Y");
-	GFTextRight(gump, 475, 80, 2100, targ.y);
-	GFTextLine(gump, 185, 100, 2100, "Z");
-	GFTextRight(gump, 475, 100, 2100, targ.z);
-	GFTextLine(gump, 185, 120, 2100, "Realm");
-	GFTextRight(gump, 475, 120, 2100, targ.realm);
-
-	return gump;
-endfunction
-
-
-
-
-function GeneralGump(who, targ)
-	var gump := GumpTemplate(targ);
-
-	GFResizePic(gump, 160, 55, GFCfgConst("Defaults", "ForeGround"), 325, 95);
-
-	GFAddButton(gump, 165, 63, 2117, 2118, GF_DUMMY_BTN);
-	GFTextLine(gump, 185, 60, 2100, "Title Prefix");
-	GFTextRight(gump, 475, 60, 2100, targ.title_prefix);
-
-	GFAddButton(gump, 165, 83, 2117, 2118, GF_DUMMY_BTN);
-	GFTextLine(gump, 185, 80, 2100, "Name");
-	GFTextRight(gump, 475, 80, 2100, targ.name);
-
-	GFAddButton(gump, 165, 103, 2117, 2118, GF_DUMMY_BTN);
-	GFTextLine(gump, 185, 100, 2100, "Title Suffix");
-	GFTextRight(gump, 475, 100, 2100, targ.title_suffix);
-
-	GFAddButton(gump, 165, 123, 2117, 2118, GF_DUMMY_BTN);
-	GFTextLine(gump, 185, 120, 2100, "Tile Race");
-	GFTextRight(gump, 475, 120, 2100, targ.title_race);
-
-	return gump;
-endfunction
-
-function ClientGump(who, targ)
-	var gump := GumpTemplate(targ);
-
-	GFResizePic(gump, 160, 55, GFCfgConst("Defaults", "ForeGround"), 325, 75);
-	GFTextLine(gump, 185, 60, 2100, "Connected");
-	GFTextRight(gump, 475, 60, 2100, targ.connected);
-	GFTextLine(gump, 185, 80, 2100, "IP Address");
-	GFTextRight(gump, 475, 80, 2100, targ.ip);
-	GFTextLine(gump, 185, 100, 2100, "Client Version");
-	GFTextRight(gump, 475, 100, 2100, targ.clientversion);
-
-	GFResizePic(gump, 160, 135, GFCfgConst("Defaults", "ForeGround"), 325, 75);
-	GFTextLine(gump, 185, 140, 2100, "Account Name");
-	GFTextRight(gump, 475, 140, 2100, targ.acctname);
-	GFTextLine(gump, 185, 160, 2100, "Account Enabled");
-	GFTextRight(gump, 475, 160, 2100, (targ.acct).enabled);
-	GFTextLine(gump, 185, 180, 2100, "Account Banned");
-	GFTextRight(gump, 475, 180, 2100, (targ.acct).banned);
-
-	GFResizePic(gump, 163, 215, GFCfgConst("Backgrounds", "GOLDTRIM"), 315, 245);
-	var client_info := targ.clientinfo;
-	var info_string := "<U>Client Info</U><BR>";
-	foreach key in ( (client_info).keys() )
-		info_string := info_string + key +" <B>:</B> "+client_info[key]+"<BR>";
-		sleepms(2);
-	endforeach
-
-	GFHTMLArea(gump, 170, 222, 303, 231, info_string, 0, 1);
-
-	return gump;
-endfunction
-
-function CombatGump(who, targ)
-	var gump := GumpTemplate(targ);
-
-	GFResizePic(gump, 160, 55, GFCfgConst("Defaults", "ForeGround"), 325, 95);
-	GFAddButton(gump, 165, 63, 2117, 2118, GF_DUMMY_BTN);
-	GFTextLine(gump, 185, 60, 2100, "Warmode");
-	GFTextRight(gump, 475, 60, 2100, targ.warmode);
-
-	GFTextLine(gump, 185, 80, 2100, "Armor Rating (AR)");
-	GFTextRight(gump, 475, 80, 2100, targ.ar);
-
-	GFAddButton(gump, 165, 103, 2117, 2118, GF_DUMMY_BTN);
-	GFTextLine(gump, 185, 100, 2100, "AR Mod");
-	GFTextRight(gump, 475, 100, 2100, targ.ar_mod);
-
-	GFAddButton(gump, 165, 123, 2117, 2118, GF_DUMMY_BTN);
-	GFTextLine(gump, 185, 120, 2100, "Attack Speed Mod");
-	GFTextRight(gump, 475, 120, 2100, targ.delay_mod);
-
-	GFResizePic(gump, 160, 155, GFCfgConst("Defaults", "ForeGround"), 325, 195);
-	GFTextLine(gump, 170, 160, 2100, "Weapon Information");
-
-	var weapon := targ.weapon;
-	var wpn_name, wpn_speed, wpn_dice;
-	if ( targ.IsA(POLCLASS_NPC) && ((targ.weapon).objtype == 0xF020) )
-		var cfg := NPC_GetNPCConfig(targ.npctemplate);
-		cfg := cfg[targ.npctemplate];
-		wpn_name := "NPC intrinsic weapon";
-		wpn_speed := cfg.AttackSpeed;
-		wpn_dice := cfg.AttackDamage;
-	elseif ( targ.weapon )
-		var cfg := ReadConfigFile(":*:itemdesc");
-		cfg := cfg[(targ.weapon).objtype];
-		wpn_name := (targ.weapon).desc;
-		wpn_speed := cfg.Speed;
-		wpn_dice := cfg.Damage;
-	endif
-
-	var average := CS_GetAverageDamage(weapon);
-
-	GFTextLine(gump, 185, 180, 2100, "Weapon Name");
-	GFTextRight(gump, 475, 180, 2100, wpn_name);
-	GFTextLine(gump, 185, 200, 2100, "Weapon Serial");
-	GFTextRight(gump, 475, 200, 2100, Hex(weapon.serial));
-	GFTextLine(gump, 185, 220, 2100, "Weapon Objtype");
-	GFTextRight(gump, 475, 220, 2100, Hex(weapon.objtype));
-
-	GFTextLine(gump, 185, 260, 2100, "Weapon Speed");
-	GFTextRight(gump, 475, 260, 2100, CInt(wpn_speed));
-	GFTextLine(gump, 185, 280, 2100, "Damage Modifier");
-	GFTextRight(gump, 475, 280, 2100, weapon.dmg_mod);
-	GFTextLine(gump, 185, 300, 2100, "Damage Dice");
-	GFTextRight(gump, 475, 300, 2100, wpn_dice);
-	GFTextLine(gump, 185, 320, 2100, "Average Damage");
-	GFTextRight(gump, 475, 320, 2100, average);
-
-	return gump;
-endfunction
-
-function ScriptGump(who, targ)
-	var gump := GumpTemplate(targ);
-
-	GFResizePic(gump, 160, 55, GFCfgConst("Defaults", "ForeGround"), 325, 55);
-	GFTextLine(gump, 175, 60, 2100, "Attached Script");
-	GFTextRight(gump, 475, 60, 2100, GetScriptName((targ.attached).name));
-	GFTextLine(gump, 175, 80, 2100, "Attached PID");
-	GFTextRight(gump, 475, 80, 2100, CInt((targ.attached).pid));
-
-	GFResizePic(gump, 160, 115, GFCfgConst("Defaults", "ForeGround"), 325, 95);
-	GFTextLine(gump, 175, 120, 2100, "AI Script");
-	GFTextRight(gump, 475, 120, 2100, GetScriptName(targ.script));
-	GFTextLine(gump, 175, 140, 2100, "AI PID");
-	GFTextRight(gump, 475, 140, 2100, CInt((targ.process).pid));
-	GFTextLine(gump, 175, 160, 2100, "Event Mask");
-	GFTextRight(gump, 475, 160, 2100, Hex(CInt(targ.eventmask)));
-	GFTextLine(gump, 175, 180, 2100, "Master Serial");
-	GFTextRight(gump, 475, 180, 2100, Hex(CInt((targ.master).serial)));
-
-	return gump;
-endfunction
-
-function RepSysGump(who, targ)
-	var gump := GumpTemplate(targ);
-
-	GFResizePic(gump, 160, 55, GFCfgConst("Defaults", "ForeGround"), 325, 55);
-	GFAddButton(gump, 165, 63, 2117, 2118, GF_DUMMY_BTN);
-	GFTextLine(gump, 185, 60, 2100, "Criminal");
-	GFTextRight(gump, 475, 60, 2100, targ.criminal);
-	GFAddButton(gump, 165, 83, 2117, 2118, GF_DUMMY_BTN);
-	GFTextLine(gump, 185, 80, 2100, "Murderer");
-	GFTextRight(gump, 475, 80, 2100, targ.murderer);
-
-	GFResizePic(gump, 163, 115, GFCfgConst("Backgrounds", "GOLDTRIM"), 315, 245);
-	var client_info := targ.clientinfo;
-	var info_string := "<U>Reportables</U><BR>";
-	foreach entry in ( targ.reportables )
-		info_string := info_string + "<B>o</B> "+ entry + "<BR>";
-		sleepms(2);
-	endforeach
-
-	GFHTMLArea(gump, 170, 122, 303, 231, info_string, 0, 1);
-
-	return gump;
-endfunction
-
 function GetScriptName(path)
 	if ( !path )
 		return "None";
@@ -420,4 +243,3 @@
 
 	return path;
 endfunction
-*/
\ No newline at end of file



From austin at berlios.de  Thu Nov 24 15:25:06 2005
From: austin at berlios.de (austin at BerliOS)
Date: Thu, 24 Nov 2005 15:25:06 +0100
Subject: [Poldistro-svn] r1058 - in trunk/096/pkg/commands: config gm
Message-ID: <200511241425.jAOEP6hE015427@sheep.berlios.de>

Author: austin
Date: 2005-11-24 15:25:05 +0100 (Thu, 24 Nov 2005)
New Revision: 1058

Modified:
   trunk/096/pkg/commands/config/info.cfg
   trunk/096/pkg/commands/gm/info.src
Log:
Added parser support for member values.

Modified: trunk/096/pkg/commands/config/info.cfg
===================================================================
--- trunk/096/pkg/commands/config/info.cfg	2005-11-24 11:42:29 UTC (rev 1057)
+++ trunk/096/pkg/commands/config/info.cfg	2005-11-24 14:25:05 UTC (rev 1058)
@@ -14,8 +14,8 @@
 # Group	GroupName
 # {
 #	// Stanard member (.whatever) entry
-#	Entry	member	Display_Name	PropertyNames	ValueParser	Editable	EditFunction
-#	Entry	member	Weapon_Name	weapon.desc	0	1	0
+#	Entry	member	Display_Name	PropertyNames	ValueParser	EditFunction
+#	Entry	member	Weapon_Name	weapon.desc	0		PropChange
 #
 #	// Display Vitals
 #	Entry	vitals
@@ -30,7 +30,7 @@
 #
 #	// Custom parameter (must edit BuildEntries() and write a function to support this param type)
 #	Entry	Custom	EntryName (data)
-#	Entry	Custom	Reportables	
+#	Entry	Custom	Reportables
 # }
 #
 ####################################
@@ -103,81 +103,81 @@
 Group	NameAndTitles
 {
 	AutoBox	1
-// 	Entry	Type	Display_Name	Property name	Editable
-	Entry	member	Title_Prefix	title_prefix	1
-	Entry	member	Name		name		1
-	Entry	member	Title_Suffix	title_suffix	1
-	Entry	member	Title_Race	title_race	1
+// 	Entry	Type	Display_Name	Property name	VP	Editable
+	Entry	member	Title_Prefix	title_prefix	0	PropEdit
+	Entry	member	Name		name		0	PropEdit
+	Entry	member	Title_Suffix	title_suffix	0	PropEdit
+	Entry	member	Title_Race	title_race	0	PropEdit
 }
 
 Group	Location
 {
 	AutoBox	1
-	Entry	member	X	x	1
-	Entry	member	Y	y	1
-	Entry	member	Z	z	1
-	Entry	member	Realm	realm	1
+	Entry	member	X	x	0	CoordEdit
+	Entry	member	Y	y	0	CoordEdit
+	Entry	member	Z	z	0	CoordEdit
+	Entry	member	Realm	realm	0	CoordEdit
 }
 
 Group	Client
 {
 	AutoBox	1
-	Entry	member	Connected	connected	0
-	Entry	member	IP_Address	ip		0
-	Entry	member	Client_Version	clientversion	0
+	Entry	member	Connected	connected
+	Entry	member	IP_Address	ip
+	Entry	member	Client_Version	clientversion
 }
 
 Group	Account
 {
 	AutoBox	1
-	Entry	member	Account_Name	acctname	0
-	Entry	member	Account_Enabled	acct.enabled	0
-	Entry	member	Account_Banned	acct.banned	0
+	Entry	member	Account_Name	acctname
+	Entry	member	Account_Enabled	acct.enabled
+	Entry	member	Account_Banned	acct.banned
 }
 
 Group	Combat
 {
 	AutoBox	1
-	Entry	member	War_Mode		warmode		1
-	Entry	member	Armor_Rating_(AR)	ar		0
-	Entry	member	AR_Modifier		ar_mod		1
-	Entry	member	Attack_Speed_Mod	delay_mod	1
+	Entry	member	War_Mode		warmode		0	WarModeEdit
+	Entry	member	Armor_Rating_(AR)	ar		0	0
+	Entry	member	AR_Modifier		ar_mod		0	PropEdit
+	Entry	member	Attack_Speed_Mod	delay_mod	0	PropEdit
 }
 
 Group	WeaponInfo
 {
 	AutoBox	1
-	Entry	member	Weapon_Name	weapon.desc	0
-	Entry	member	Weapon_Serial	weapon.serial	0
-	Entry	member	Weapon_Objtype	weapon.objtype	0
+	Entry	member	Weapon_Name	weapon.desc
+	Entry	member	Weapon_Serial	weapon.serial	Hex
+	Entry	member	Weapon_Objtype	weapon.objtype	Hex
 	Entry	blank
-	Entry	custom	Weapon_Speed	0
-	Entry	member	Damage_Modifier	weapon.dmg_mod	1
-	Entry	custom	Damage_Dice	0
-	Entry	custom	Average_Damage	0
+	Entry	custom	Weapon_Speed
+	Entry	member	Damage_Modifier	weapon.dmg_mod	0	PropEdit
+	Entry	custom	Damage_Dice
+	Entry	custom	Average_Damage
 }
 
 Group	Script
 {
 	AutoBox	1
-	Entry	member	Attached_Script	attached.name	0
-	Entry	member	Attached_Pid	attached.pid	0
+	Entry	member	Attached_Script	attached.name
+	Entry	member	Attached_Pid	attached.pid
 }
 
 Group	AI
 {
 	AutoBox	1
-	Entry	member	AI_Script	script		0
-	Entry	member	AI_Pid		process.pid	0
-	Entry	member	Event_Mask	eventmask	0
-	Entry	member	Master_Serial	master.serial	0
+	Entry	member	AI_Script	script		Script
+	Entry	member	AI_Pid		process.pid	
+	Entry	member	Event_Mask	eventmask	Binary
+	Entry	member	Master_Serial	master.serial	Hex
 }
-	
+
 Group	Reputation
 {
 	AutoBox	1
-	Entry	member	Criminal	criminal	1
-	Entry	member	Murderer	murderer	1
+	Entry	member	Criminal	criminal	0	CrimEdit
+	Entry	member	Murderer	murderer	0	MurdererEdit
 	Entry	blank
 	Entry	custom	Reportables	0
 }
@@ -185,7 +185,6 @@
 Group	Properties
 {
 	AutoBox	1
-	
 }
 
 Group	Vitals

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-24 11:42:29 UTC (rev 1057)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-24 14:25:05 UTC (rev 1058)
@@ -128,6 +128,17 @@
 	GFTextLine(gump, 175, y_pos, 2100, ParseEntryName(entry[2]));
 	
 	var value := ParseMembers(targ, entry[3]);
+	case ( Lower(entry[4]) )
+		"hex":	
+			value := Hex(value);
+			break;
+		"binary": 
+			value := CInt(value);
+			break;
+		"script":
+			value := GetScriptName(value);
+			break;
+	endcase
 	GFTextRight(gump, 480, y_pos, 2100, value);
 	
 	y_pos := y_pos+20;



From austin at berlios.de  Thu Nov 24 16:44:28 2005
From: austin at berlios.de (austin at BerliOS)
Date: Thu, 24 Nov 2005 16:44:28 +0100
Subject: [Poldistro-svn] r1059 - trunk/096/pkg/commands/gm
Message-ID: <200511241544.jAOFiSd3023476@sheep.berlios.de>

Author: austin
Date: 2005-11-24 16:44:28 +0100 (Thu, 24 Nov 2005)
New Revision: 1059

Modified:
   trunk/096/pkg/commands/gm/info.src
Log:
Support for Bin()

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-24 14:25:05 UTC (rev 1058)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-24 15:44:28 UTC (rev 1059)
@@ -133,7 +133,7 @@
 			value := Hex(value);
 			break;
 		"binary": 
-			value := CInt(value);
+			value := Bin(CInt(value));
 			break;
 		"script":
 			value := GetScriptName(value);
@@ -206,7 +206,8 @@
 		
 		sleepms(2);
 	endforeach
-	return CStr(result);
+	
+	return result;
 endfunction
 
 function GumpTemplate(targ)



From austin at berlios.de  Thu Nov 24 22:01:45 2005
From: austin at berlios.de (austin at BerliOS)
Date: Thu, 24 Nov 2005 22:01:45 +0100
Subject: [Poldistro-svn] r1060 - in trunk/096/pkg/commands: config gm
Message-ID: <200511242101.jAOL1jbb009836@sheep.berlios.de>

Author: austin
Date: 2005-11-24 22:01:44 +0100 (Thu, 24 Nov 2005)
New Revision: 1060

Modified:
   trunk/096/pkg/commands/config/info.cfg
   trunk/096/pkg/commands/gm/info.src
Log:


Modified: trunk/096/pkg/commands/config/info.cfg
===================================================================
--- trunk/096/pkg/commands/config/info.cfg	2005-11-24 15:44:28 UTC (rev 1059)
+++ trunk/096/pkg/commands/config/info.cfg	2005-11-24 21:01:44 UTC (rev 1060)
@@ -28,7 +28,7 @@
 #	Entry	Attribute	AttributeName
 #	Entry	Attribute	Swordsmanship
 #
-#	// Custom parameter (must edit BuildEntries() and write a function to support this param type)
+#	// Custom parameter (must edit BuildCustomEntry() and write a function to support this param type)
 #	Entry	Custom	EntryName (data)
 #	Entry	Custom	Reportables
 # }

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-24 15:44:28 UTC (rev 1059)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-24 21:01:44 UTC (rev 1060)
@@ -56,10 +56,10 @@
 		//return 0;
 		targ := who;
 	endif
-	
+
 	template := GumpTemplate(targ);
 	var cur_gump := 1;
-	
+
 	while ( 1 )
 		cur_gump := GFSendGump(who, BuildGump(targ, cur_gump));
 		cur_gump := cur_gump[0];
@@ -83,7 +83,7 @@
 		y_pos := y_pos+5;
 		sleepms(2);
 	endforeach
-	
+
 	return gump;
 endfunction
 
@@ -93,11 +93,11 @@
 		var num_entries := entries.Size();
 		GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_entries*20));
 	endif
-	
+
 	foreach entry in ( entries )
 		entry := SplitWords(entry, " ");
 		case ( Lower(entry[1]) )
-			"member": 
+			"member":
 				AddMemberEntry(targ, gump, entry, y_pos);
 				break;
 			"vitals":
@@ -105,34 +105,49 @@
 				break;
 			"attributes":
 				DisplayAttributes(targ, gump, entry, y_pos);
-				break;			
-			"blank": 
+				break;
+			"blank":
 				y_pos := y_pos+20;
 				break;
-			default: 
-				GFTextLine(gump, 175, y_pos, 32, entry); 
+			"custom":
+				BuildCustomEntry(targ, gump, entry, y_pos);
+				break;
+			default:
+				GFTextLine(gump, 175, y_pos, 32, entry);
 				y_pos := y_pos+20;
 				break;
 		endcase
 		sleepms(2);
 	endforeach
-	
+
 	return 1;
 endfunction
 
+function BuildCustomEntry(targ, byref gump, byref entry, byref y_pos)
+	case ( Lower(entry[2]) )
+		"Weapon_Speed":
+		"Damage_Dice":
+		"Average_Damage":
+		default:
+		break;
+	endcase
+
+	return 1;
+endfunction
+
 function AddMemberEntry(targ, byref gump, byref entry, byref y_pos)
 	if ( CInt(entry[4]) )
 		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
 	endif
-	
+
 	GFTextLine(gump, 175, y_pos, 2100, ParseEntryName(entry[2]));
-	
+
 	var value := ParseMembers(targ, entry[3]);
 	case ( Lower(entry[4]) )
-		"hex":	
+		"hex":
 			value := Hex(value);
 			break;
-		"binary": 
+		"binary":
 			value := Bin(CInt(value));
 			break;
 		"script":
@@ -140,7 +155,7 @@
 			break;
 	endcase
 	GFTextRight(gump, 480, y_pos, 2100, value);
-	
+
 	y_pos := y_pos+20;
 	return 1;
 endfunction
@@ -158,7 +173,7 @@
 		y_pos := y_pos+20;
 		sleepms(2);
 	endforeach
-	
+
 	return 1;
 endfunction
 
@@ -166,11 +181,11 @@
 	var type := entry[2];
 	var attributes := AP_ListAttributesByType("Stat");
 	var num_attribs := attributes.Size();
-	
-	var y_needed := num_attribs * 20;	
+
+	var y_needed := num_attribs * 20;
 	var y_space := (END_Y-y_pos)+START_Y;
 	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, y_needed);
-	
+
 	foreach attrib_name in ( attributes )
 		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
 		GFTextLine(gump, 175, y_pos, 2100, attrib_name);
@@ -180,9 +195,9 @@
 		y_pos := y_pos+20;
 		sleepms(2);
 	endforeach
-	
+
 	return 1;
-endfunction	
+endfunction
 
 function ParseEntryName(entry_name)
 	while ( entry_name["_"] )
@@ -197,21 +212,20 @@
 	var result := targ;
 	foreach member in ( members )
 		var temp := result.Get_Member(member);
-		if ( temp != error ) 
+		if ( temp != error )
 			result := temp;
 		else
 			result := "None";
 			break;
 		endif
-		
+
 		sleepms(2);
 	endforeach
-	
+
 	return result;
 endfunction
 
 function GumpTemplate(targ)
-
 	var gump := GFCreateGump();
 	GFPage(gump, 0);
 	GFResizePic(gump, 0, 0, GFCfgConst("Defaults", "BackGround"), 500, 480);
@@ -228,7 +242,7 @@
 	endif
 
 	GFResizePic(gump, 15, START_Y, GFCfgConst("Defaults", "ForeGround"), 125, END_Y);
-	
+
 	var y_pos := 60;
 	foreach entry in ( index_list )
 		GFAddButton(gump, 20, (y_pos+3), 2117, 2118, GF_CLOSE_BTN, _entry_iter);



From muaddiblsd at berlios.de  Fri Nov 25 07:23:16 2005
From: muaddiblsd at berlios.de (muaddiblsd at BerliOS)
Date: Fri, 25 Nov 2005 07:23:16 +0100
Subject: [Poldistro-svn] r1061 - trunk/096
Message-ID: <200511250623.jAP6NGgu013108@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-25 07:22:26 +0100 (Fri, 25 Nov 2005)
New Revision: 1061

Modified:
   trunk/096/CoreChanges-096.txt
Log:


Modified: trunk/096/CoreChanges-096.txt
===================================================================
--- trunk/096/CoreChanges-096.txt	2005-11-24 21:01:44 UTC (rev 1060)
+++ trunk/096/CoreChanges-096.txt	2005-11-25 06:22:26 UTC (rev 1061)
@@ -1,3 +1,7 @@
+11-25 MuadDib
+        Fixed : AttackRequest now checks for distance < 20, realm, hidden, concealed higher, and dead characters.
+	Fixed : Visibility checks now check for same realm.
+
 11-23 Austin
         Fixed : account.Get_Member(member name) now works.
         Fixed : .Get_Member(member name) for script objects now works.



From austin at berlios.de  Sat Nov 26 10:15:24 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 26 Nov 2005 10:15:24 +0100
Subject: [Poldistro-svn] r1062 - in trunk/096/pkg: mobiles/brainAI/scripts/combat skills/magery skills/magery/spellScripts/circle4
Message-ID: <200511260915.jAQ9FOkq009367@sheep.berlios.de>

Author: austin
Date: 2005-11-26 10:15:21 +0100 (Sat, 26 Nov 2005)
New Revision: 1062

Modified:
   trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
   trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src
   trunk/096/pkg/skills/magery/spellStarter.src
Log:
Fixed small compiler errors.
Note: Not sure why recall.src is almost a complete copy of spellStarter.src ... makes no sense.

Modified: trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
===================================================================
--- trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-25 06:22:26 UTC (rev 1061)
+++ trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src	2005-11-26 09:15:21 UTC (rev 1062)
@@ -130,13 +130,13 @@
 		endif
 		case( RandomInt(3) )
 			default:
-				PlayStationaryEffect(coord.x, coord.y, npc.z, FX_EXPLODE_1, 10, 10, 0);
+				PlayStationaryEffect(coord.x, coord.y, npc.z, GFX_EXPLODE_1, 10, 10, 0);
 				break;
 			1:
-				PlayStationaryEffect(coord.x, coord.y, npc.z, FX_EXPLODE_2, 10, 10, 0);
+				PlayStationaryEffect(coord.x, coord.y, npc.z, GFX_EXPLODE_2, 10, 10, 0);
 				break;
 			2:
-				PlayStationaryEffect(coord.x, coord.y, npc.z, FX_EXPLODE_3, 10, 10, 0);
+				PlayStationaryEffect(coord.x, coord.y, npc.z, GFX_EXPLODE_3, 10, 10, 0);
 				break;
 		endcase
 		var field := CreateItemAtLocation(coord.x, coord.y, opponent.z, "FireFieldNS", 1);

Modified: trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src
===================================================================
--- trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src	2005-11-25 06:22:26 UTC (rev 1061)
+++ trunk/096/pkg/skills/magery/spellScripts/circle4/recall.src	2005-11-26 09:15:21 UTC (rev 1062)
@@ -285,7 +285,7 @@
 	// fails the casting.
 	who.frozen := 0;
 	EraseObjProperty(who, "#medding");
-	PlayObjectCenteredEffect(who, GFX_SPELL_FAIL, 5, 50);
+	PlayObjectCenteredEffect(who, GFX_FIZZLE, 5, 50);
 	PlaySoundEffect(who, SFX_SPELL_FAIL);
 
 	return 1;

Modified: trunk/096/pkg/skills/magery/spellStarter.src
===================================================================
--- trunk/096/pkg/skills/magery/spellStarter.src	2005-11-25 06:22:26 UTC (rev 1061)
+++ trunk/096/pkg/skills/magery/spellStarter.src	2005-11-26 09:15:21 UTC (rev 1062)
@@ -190,7 +190,7 @@
 	// fails the casting.
 	who.frozen := 0;
 	EraseObjProperty(who, "#medding");
-	PlayObjectCenteredEffect(who, GFX_SPELL_FAIL, 5, 50);
+	PlayObjectCenteredEffect(who, GFX_FIZZLE, 5, 50);
 	PlaySoundEffect(who, SFX_SPELL_FAIL);
 
 	return 1;



From austin at berlios.de  Sat Nov 26 10:17:14 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sat, 26 Nov 2005 10:17:14 +0100
Subject: [Poldistro-svn] r1063 - trunk/096/pkg/commands/gm
Message-ID: <200511260917.jAQ9HEbR009444@sheep.berlios.de>

Author: austin
Date: 2005-11-26 10:17:13 +0100 (Sat, 26 Nov 2005)
New Revision: 1063

Removed:
   trunk/096/pkg/commands/gm/makekey.src
   trunk/096/pkg/commands/gm/rekey.src
   trunk/096/pkg/commands/gm/relock.src
Log:


Deleted: trunk/096/pkg/commands/gm/makekey.src
===================================================================
--- trunk/096/pkg/commands/gm/makekey.src	2005-11-26 09:15:21 UTC (rev 1062)
+++ trunk/096/pkg/commands/gm/makekey.src	2005-11-26 09:17:13 UTC (rev 1063)
@@ -1,25 +0,0 @@
-use uo;
-
-include "util/key";
-
-program makekey ( who )
-
-    SendSysMessage( who, "Target a door or container now." );
-    var lockeditem := Target( who, "" );
-
-    if(! lockeditem)
-       SendSysMessage( who, "Cancelled." );
-       return;
-    endif
-
-    var lockid := GetObjProperty(lockeditem, "lockid");
-
-    if (! lockid)
-	SendSysMessage( who, "There's no lock on that." );
-    else
-	var key := CreateItemInBackpack( who, 0x100f, 1 );
-	SetObjProperty( key, "lockid", lockid );   
-    	SendSysMessage( who, "Created a key to match that lock." );
-    endif
-
-endprogram
\ No newline at end of file

Deleted: trunk/096/pkg/commands/gm/rekey.src
===================================================================
--- trunk/096/pkg/commands/gm/rekey.src	2005-11-26 09:15:21 UTC (rev 1062)
+++ trunk/096/pkg/commands/gm/rekey.src	2005-11-26 09:17:13 UTC (rev 1063)
@@ -1,24 +0,0 @@
-use uo;
-
-include "util/key";
-
-program rekey( who )
-
-    SendSysMessage( who, "Target a DOOR to rekey." );
-    var lockeditem := Target( who, "" );
-
-    if(! lockeditem)
-       SendSysMessage( who, "Cancelled." );
-       return;
-    endif
-
-    var lockid := AllocLockId();
-
-    SetObjProperty( lockeditem, "lockid", lockid );
-   
-    var key := CreateItemInBackpack( who, 0x100f, 1 );
-    SetObjProperty( key, "lockid", lockid );
-
-    SendSysMessage( who, "Created a key in your pack." );
-
-endprogram

Deleted: trunk/096/pkg/commands/gm/relock.src
===================================================================
--- trunk/096/pkg/commands/gm/relock.src	2005-11-26 09:15:21 UTC (rev 1062)
+++ trunk/096/pkg/commands/gm/relock.src	2005-11-26 09:17:13 UTC (rev 1063)
@@ -1,28 +0,0 @@
-use uo;
-
-include "util/key";
-
-program relock( who )
-
-    SendSysMessage( who, "Target a KEY first." );
-    var key := Target( who, "" );
-    if(! key)
-       SendSysMessage( who, "Cancelled." );
-       return;
-    endif
-
-    SendSysMessage( who, "Target a door or container now." );
-    var lockeditem := Target( who, "" );
-
-    if(! lockeditem)
-       SendSysMessage( who, "Cancelled." );
-       return;
-    endif
-
-    var lockid := GetObjProperty(key, "lockid");
-
-    SetObjProperty( lockeditem, "lockid", lockid );
-   
-    SendSysMessage( who, "Changed the item to match that key." );
-
-endprogram
\ No newline at end of file



From muaddiblsd at berlios.de  Sun Nov 27 00:41:30 2005
From: muaddiblsd at berlios.de (muaddiblsd at BerliOS)
Date: Sun, 27 Nov 2005 00:41:30 +0100
Subject: [Poldistro-svn] r1064 - trunk/096
Message-ID: <200511262341.jAQNfU0F025696@sheep.berlios.de>

Author: muaddiblsd
Date: 2005-11-27 00:41:28 +0100 (Sun, 27 Nov 2005)
New Revision: 1064

Modified:
   trunk/096/CoreChanges-096.txt
Log:


Modified: trunk/096/CoreChanges-096.txt
===================================================================
--- trunk/096/CoreChanges-096.txt	2005-11-26 09:17:13 UTC (rev 1063)
+++ trunk/096/CoreChanges-096.txt	2005-11-26 23:41:28 UTC (rev 1064)
@@ -1,7 +1,30 @@
+-- POL096 --
+11-26 MuadDib
+        Fixed : Fixed Attack Denied method for client expectations.
+        Fixed : Logon issues involving map visibility on >2 mapid.
+        Fixed : Issues with weather and seasons on logon.
+
+11-26 Austin
+        Added : Support for bit shifting integers using << and >>
+
+11-26 Shinigami
+        Fixed : Compiler will work case insensitive now.
+        Added : New Mounts to uoconvert.cfg
+        Added : uoconvert.cfg to Linux Files
+        Fixed : illegal Attack Requests (Packet 0x05) will not crash Pol
+
+11-25 Shinigami
+        Changed : Packet 0xBF Subcommand 0x24 will no longer cause POL to treat client as active.
+
 11-25 MuadDib
         Fixed : AttackRequest now checks for distance < 20, realm, hidden, concealed higher, and dead characters.
-	Fixed : Visibility checks now check for same realm.
+        Fixed : Visibility checks now check for same realm.
+        Added : Packet 0xBF Subcommand 0x24 no longer reports in unknown packets. Packet will still cause
+                POL to treat client as active.
 
+11-24 Austin
+        Added : basic::Bin() - Convert 25 to 11001
+
 11-23 Austin
         Fixed : account.Get_Member(member name) now works.
         Fixed : .Get_Member(member name) for script objects now works.
@@ -16,7 +39,7 @@
         Fixed : Attempt # 2 with *InBox() coordinate checks. 
         Fixed : Region scripts (EnterScript / LeaveScript) no longer need an 
                 EnterText and LeaveText to work.
-
+                
 11-15 Austin
         Added : using "::regions/" in a config path will allow a config file from pol/regions/ to be read.
                 Example ReadConfigFile("::regions/justice");
@@ -53,7 +76,7 @@
         Added : weapon.intrinsic
     
 11-10 Austin
-        Fixed : Items moved to invalid locations will not go to the player's feet on the 
+        Fixed : Items moved to invalid locations will now go to the player's feet on the 
                 correct realm and not just to britannia.
             
 11-03 Austin



From austin at berlios.de  Sun Nov 27 12:03:22 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 27 Nov 2005 12:03:22 +0100
Subject: [Poldistro-svn] r1065 - trunk/096/pkg/utils/gumps/include
Message-ID: <200511271103.jARB3MtY009846@sheep.berlios.de>

Author: austin
Date: 2005-11-27 12:03:18 +0100 (Sun, 27 Nov 2005)
New Revision: 1065

Modified:
   trunk/096/pkg/utils/gumps/include/gumps.inc
Log:
Added .cur_page to gump objects - to retrieve the page the gump is writing to in the layout.

Modified: trunk/096/pkg/utils/gumps/include/gumps.inc
===================================================================
--- trunk/096/pkg/utils/gumps/include/gumps.inc	2005-11-26 23:41:28 UTC (rev 1064)
+++ trunk/096/pkg/utils/gumps/include/gumps.inc	2005-11-27 11:03:18 UTC (rev 1065)
@@ -79,6 +79,9 @@
 	
 	// Starting points for data values
 	gump.+data_id	:= 1;
+	
+	// Current page the gump is writing to
+	gump.+cur_page := 0;
 
 	return(gump);
 endfunction
@@ -226,12 +229,7 @@
 function GFPage(byref gump, page_num)
 	(gump.layout).append("Page " + CStr(CInt(page_num)));
 	
-	if ( gump.optimize )
-		gump.cur_page := page_num;
-		if ( !gump.pagelocs[page_num] )
-			gump.pagelocs[page_num] := (gump.layout).size();
-		endif
-	endif
+	gump.cur_page := page_num;
 	
 	return 1;
 endfunction



From austin at berlios.de  Sun Nov 27 12:09:27 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 27 Nov 2005 12:09:27 +0100
Subject: [Poldistro-svn] r1066 - trunk/096/scripts/include
Message-ID: <200511271109.jARB9Rau011454@sheep.berlios.de>

Author: austin
Date: 2005-11-27 12:09:25 +0100 (Sun, 27 Nov 2005)
New Revision: 1066

Modified:
   trunk/096/scripts/include/arrays.inc
Log:
Fixed compile issues.

Modified: trunk/096/scripts/include/arrays.inc
===================================================================
--- trunk/096/scripts/include/arrays.inc	2005-11-27 11:03:18 UTC (rev 1065)
+++ trunk/096/scripts/include/arrays.inc	2005-11-27 11:09:25 UTC (rev 1066)
@@ -5,6 +5,7 @@
  *
  */
 use basic;
+use math;
 use os;
 use uo;
 
@@ -150,7 +151,7 @@
 	if( the_array[1].IsA(POLCLASS_UOBJECT) )
 		while( min <= max )
 			ctr := Cint((min+max)/2);
-			if( the_array[ctr].serial = to_find.serial )
+			if( the_array[ctr].serial == to_find.serial )
 				return ctr;
 			elseif( the_array[ctr].serial < to_find.serial )
 				min := ctr + 1;
@@ -165,7 +166,7 @@
 	else
 		while( min <= max )
 			ctr := Cint((min+max)/2);
-			if( the_array[ctr] = to_find )
+			if( the_array[ctr] == to_find )
 				return ctr;
 			elseif( the_array[ctr] < to_find )
 				min := ctr + 1;
@@ -208,7 +209,7 @@
 	if( the_array[1].IsA(POLCLASS_UOBJECT) )
 		while( min <= max )
 			ctr := Cint((min+max)/2);
-			if( the_array[ctr].serial = element.serial )
+			if( the_array[ctr].serial == element.serial )
 				var ret := error;
 				ret.+errortext := "Element " + element + " already exist in array";
 				return ret;
@@ -221,7 +222,7 @@
 	else
 		while( min <= max )
 			ctr := Cint((min+max)/2);
-			if( the_array[ctr] = element )
+			if( the_array[ctr] == element )
 				var ret := error;
 				ret.+errortext := "Element " + element + " already exist in array";
 				return ret;



From austin at berlios.de  Sun Nov 27 12:19:26 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 27 Nov 2005 12:19:26 +0100
Subject: [Poldistro-svn] r1067 - trunk/096/pkg/utils/gumps/include
Message-ID: <200511271119.jARBJQse013063@sheep.berlios.de>

Author: austin
Date: 2005-11-27 12:19:25 +0100 (Sun, 27 Nov 2005)
New Revision: 1067

Modified:
   trunk/096/pkg/utils/gumps/include/gumps.inc
Log:
Made GFPage() a little more optimized.

Modified: trunk/096/pkg/utils/gumps/include/gumps.inc
===================================================================
--- trunk/096/pkg/utils/gumps/include/gumps.inc	2005-11-27 11:09:25 UTC (rev 1066)
+++ trunk/096/pkg/utils/gumps/include/gumps.inc	2005-11-27 11:19:25 UTC (rev 1067)
@@ -227,9 +227,9 @@
  *
  */
 function GFPage(byref gump, page_num)
-	(gump.layout).append("Page " + CStr(CInt(page_num)));
+	gump.cur_page := CInt(page_num);
 	
-	gump.cur_page := page_num;
+	(gump.layout).Append("Page " + CStr(gump.cur_page));
 	
 	return 1;
 endfunction



From austin at berlios.de  Sun Nov 27 12:46:53 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 27 Nov 2005 12:46:53 +0100
Subject: [Poldistro-svn] r1070 - trunk/096/pkg/commands/gm
Message-ID: <200511271146.jARBkrtZ029248@sheep.berlios.de>

Author: austin
Date: 2005-11-27 12:46:49 +0100 (Sun, 27 Nov 2005)
New Revision: 1070

Modified:
   trunk/096/pkg/commands/gm/info.src
Log:
More attribute listing updates

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-27 11:33:58 UTC (rev 1069)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-27 11:46:49 UTC (rev 1070)
@@ -182,31 +182,33 @@
 	var type := entry[2];
 	var attributes := AP_ListAttributesByType(type);
 	attributes := BreakArray(attributes, 20);
-	
+
 	foreach group in ( attributes )
 		var num_attribs := group.Size();
-		var y_needed := (num_attribs * 20)+10;
+		var y_needed := (num_attribs * 20);
 		var y_space := (END_Y-y_pos)+START_Y;
-		
+
 		GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, y_needed);
+		if ( _group_iter > 1 )
+			GFAddButton(gump, 460, START_Y+5, 2650, 2651, GF_PAGE_BTN, gump.cur_page-1);
+		endif
 		
 		foreach attrib_name in ( group )
 			GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
 			GFTextLine(gump, 175, y_pos, 2100, attrib_name);
 			var value := AP_GetTrueSkill(targ, attrib_name);
 			var mod_value := AP_GetSkillMod(targ, attrib_name);
-			GFTextRight(gump, 480, y_pos, 2100, value+" (+"+mod_value+")");
+			GFTextRight(gump, 455, y_pos, 2100, value+" (+"+mod_value+")");
 			y_pos := y_pos+20;
 			sleepms(2);
 		endforeach
-		
+
 		if ( _group_iter < attributes.Size() )
-			GFAddButton(gump, 460, 400, 2648, 2649, GF_PAGE_BTN, gump.cur_page+1);
+			GFAddButton(gump, 460, 440, 2648, 2649, GF_PAGE_BTN, gump.cur_page+1);
 			GFPage(gump, gump.cur_page+1);
-			GFAddButton(gump, 460, START_Y, 2650, 1651, GF_PAGE_BTN, gump.cur_page-1);
 			y_pos := START_Y;
 		endif
-		
+
 		sleepms(2);
 	endforeach
 



From austin at berlios.de  Sun Nov 27 13:29:58 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 27 Nov 2005 13:29:58 +0100
Subject: [Poldistro-svn] r1071 - trunk/096/pkg/commands/gm
Message-ID: <200511271229.jARCTwn8009096@sheep.berlios.de>

Author: austin
Date: 2005-11-27 13:29:33 +0100 (Sun, 27 Nov 2005)
New Revision: 1071

Modified:
   trunk/096/pkg/commands/gm/info.src
Log:
Okay it can fully dynamically display attributes now.. O_o

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-27 11:46:49 UTC (rev 1070)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-27 12:29:33 UTC (rev 1071)
@@ -99,7 +99,7 @@
 		entry := SplitWords(entry, " ");
 		case ( Lower(entry[1]) )
 			"member":
-				AddMemberEntry(targ, gump, entry, y_pos);
+				DisplayMember(targ, gump, entry, y_pos);
 				break;
 			"vitals":
 				DisplayVitals(targ, gump, y_pos);
@@ -136,8 +136,8 @@
 	return 1;
 endfunction
 
-function AddMemberEntry(targ, byref gump, byref entry, byref y_pos)
-	if ( CInt(entry[4]) )
+function DisplayMember(targ, byref gump, byref entry, byref y_pos)
+	if ( entry[5] )
 		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
 	endif
 
@@ -181,14 +181,30 @@
 function DisplayAttributes(targ, byref gump, byref entry, byref y_pos)
 	var type := entry[2];
 	var attributes := AP_ListAttributesByType(type);
-	attributes := BreakArray(attributes, 20);
-
+	//
+	// Notes about the first page of showing attributes:
+	// 1. The Y position they start showing on is dynamic.
+	// 2. They may all fit on the first page.
+	// 3. The remaining attributes on other pages start on START_Y
+	// With this in mind, the array must be broken once for the first page.
+	// Then broken again for the remaining pages. Not the most 'efficient' way I suppose.
+	//
+	
+	var y_space := (END_Y-y_pos)+START_Y;
+	var available_lines := CInt(y_space / 20);
+	var num_attribs := attributes.Size();
+	if ( available_lines > num_attribs )
+		attributes := array{attributes};
+	else
+		var page_1 := GetArrayRange(attributes, 1, available_lines);
+		var rest := GetArrayRange(attributes, available_lines+1, num_attribs);
+		attributes := BreakArray(rest, 20);
+		attributes.Insert(1, page_1);
+	endif
+		
 	foreach group in ( attributes )
-		var num_attribs := group.Size();
-		var y_needed := (num_attribs * 20);
-		var y_space := (END_Y-y_pos)+START_Y;
-
-		GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, y_needed);
+		num_attribs := group.Size();
+		GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, num_attribs * 20);
 		if ( _group_iter > 1 )
 			GFAddButton(gump, 460, START_Y+5, 2650, 2651, GF_PAGE_BTN, gump.cur_page-1);
 		endif
@@ -204,7 +220,7 @@
 		endforeach
 
 		if ( _group_iter < attributes.Size() )
-			GFAddButton(gump, 460, 440, 2648, 2649, GF_PAGE_BTN, gump.cur_page+1);
+			GFAddButton(gump, 460, 430, 2648, 2649, GF_PAGE_BTN, gump.cur_page+1);
 			GFPage(gump, gump.cur_page+1);
 			y_pos := START_Y;
 		endif



From austin at berlios.de  Sun Nov 27 14:02:11 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 27 Nov 2005 14:02:11 +0100
Subject: [Poldistro-svn] r1072 - in trunk/096/pkg/commands: config gm
Message-ID: <200511271302.jARD2BJs020996@sheep.berlios.de>

Author: austin
Date: 2005-11-27 14:01:54 +0100 (Sun, 27 Nov 2005)
New Revision: 1072

Modified:
   trunk/096/pkg/commands/config/info.cfg
   trunk/096/pkg/commands/gm/info.src
Log:
Support for storage areas and privileges.

Modified: trunk/096/pkg/commands/config/info.cfg
===================================================================
--- trunk/096/pkg/commands/config/info.cfg	2005-11-27 12:29:33 UTC (rev 1071)
+++ trunk/096/pkg/commands/config/info.cfg	2005-11-27 13:01:54 UTC (rev 1072)
@@ -50,6 +50,21 @@
 	Index	Storage
 	Index	Miscellaneous
 }
+Elem	PrivList
+{
+	Priv	ignoredoors
+	Priv	seeinvisitems
+	Priv	seehidden
+	Priv	seeghosts
+	Priv	renameany
+	Priv	moveany
+	Priv	losany
+	Priv	invul
+	Priv	hearghosts
+	Priv	dblclickany
+	Priv	clotheany
+	Priv	freemove
+}
 
 Elem	Index-General
 {
@@ -100,6 +115,21 @@
 	Group	Skills
 }
 
+Elem	Index-Privileges
+{
+	Group	Privileges
+}
+
+Elem	Index-Storage
+{
+	AutoBox	1
+	Entry	member	Back_Pack	backpack	0	0
+	Group	Storage
+}
+
+
+
+
 Group	NameAndTitles
 {
 	AutoBox	1
@@ -201,3 +231,13 @@
 {
 	Entry	Attributes	Skill
 }
+
+Group	Privileges
+{
+	Entry	Privileges
+}
+
+Group	Storage
+{
+	Entry	StorageAreas
+}
\ No newline at end of file

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-27 12:29:33 UTC (rev 1071)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-27 13:01:54 UTC (rev 1072)
@@ -25,16 +25,9 @@
 
 unload_scripts("");
 
-var priv_names := array
-{
-	"ignoredoors", "seeinvisitems", "seehidden", "seeghosts",
-	"renameany", "moveany", "losany", "invul", "hearghosts",
-	"dblclickany", "clotheany", "freemove"
-};
-
 // Storing these globally just makes the script easier to use...
 var info_cfg;			// info.cfg
-var index_list; 		// info.cfg "Index" lines from Index elem
+var index_list; 		// info.cfg "Index" lines from Settings elem
 var template;			// Template gump (so it doesn't need to be rebuilt)
 
 program textcmd_Info(who, serial)
@@ -78,19 +71,23 @@
 	var cfg_elem := info_cfg["Index-"+index];
 	var groups := GetConfigStringArray(cfg_elem, "Group");
 	var y_pos := START_Y;
+	BuildEntries(targ, gump, cfg_elem, y_pos);
 	foreach group in ( groups )
 		var group_elem := info_cfg[group];
 		BuildEntries(targ, gump, group_elem, y_pos);
-		y_pos := y_pos+5;
 		sleepms(2);
 	endforeach
 
 	return gump;
 endfunction
 
-function BuildEntries(targ, byref gump, byref group_elem, byref y_pos)
-	var entries := GetConfigStringArray(group_elem, "Entry");
-	if ( group_elem.AutoBox )
+function BuildEntries(targ, byref gump, byref cfg_elem, byref y_pos)
+	var entries := GetConfigStringArray(cfg_elem, "Entry");
+	if ( entries.Size() < 1 )
+		return 0;
+	endif
+	
+	if ( cfg_elem.AutoBox )
 		var num_entries := entries.Size();
 		GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_entries*20));
 	endif
@@ -107,6 +104,16 @@
 			"attributes":
 				DisplayAttributes(targ, gump, entry, y_pos);
 				break;
+			"privileges":
+				DisplayPrivileges(targ, gump, y_pos);
+				break;	
+			"text":
+				GFTextLine(gump, 175, y_pos, 2100, entry);
+				y_pos := y_pos+20;
+				break;
+			"storageareas":
+				DisplayStorageAreas(targ, gump, y_pos);
+				break;
 			"blank":
 				y_pos := y_pos+20;
 				break;
@@ -120,7 +127,8 @@
 		endcase
 		sleepms(2);
 	endforeach
-
+	y_pos := y_pos+5;
+		
 	return 1;
 endfunction
 
@@ -163,7 +171,7 @@
 
 function DisplayVitals(targ, byref gump, byref y_pos)
 	var vitals := AP_GetVitalNames();
-	var num_vitals := vitals.size();
+	var num_vitals := vitals.Size();
 	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_vitals*20));
 	foreach vital_name in ( vitals )
 		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
@@ -204,7 +212,7 @@
 		
 	foreach group in ( attributes )
 		num_attribs := group.Size();
-		GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, num_attribs * 20);
+		GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, num_attribs*20);
 		if ( _group_iter > 1 )
 			GFAddButton(gump, 460, START_Y+5, 2650, 2651, GF_PAGE_BTN, gump.cur_page-1);
 		endif
@@ -231,6 +239,42 @@
 	return 1;
 endfunction
 
+function DisplayPrivileges(targ, byref gump, byref y_pos)
+	var privs := info_cfg["PrivList"];
+	privs := GetConfigStringArray(privs, "Priv");
+	
+	var num_privs := privs.Size();
+	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_privs*20));
+	foreach priv_name in ( privs )
+		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
+		GFTextLine(gump, 175, y_pos, 2100, priv_name);
+		GFTextRight(gump, 480, y_pos, 2100, targ.Enabled(priv_name));
+		y_pos := y_pos+20;
+		sleepms(2);
+	endforeach
+
+	return 1;
+endfunction
+
+function DisplayStorageAreas(targ, byref gump, byref y_pos)
+	
+	var storage_areas := CP_GetStorageAreaNames();
+	
+	var num_areas := storage_areas.Size();
+	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_areas*20));
+	foreach area_name in ( storage_areas )
+		var container := CP_GetStorageContainerForMobile(targ, area_name, CP_NOCREATE);
+		if ( container )
+			GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
+		endif
+		GFTextLine(gump, 175, y_pos, 2100, area_name);
+		y_pos := y_pos+20;
+		sleepms(2);
+	endforeach
+
+	return 1;
+endfunction
+
 function ParseEntryName(entry_name)
 	while ( entry_name["_"] )
 		entry_name["_"] := " ";



From austin at berlios.de  Sun Nov 27 14:26:34 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 27 Nov 2005 14:26:34 +0100
Subject: [Poldistro-svn] r1073 - in trunk/096/pkg/commands: config gm
Message-ID: <200511271326.jARDQYpg030737@sheep.berlios.de>

Author: austin
Date: 2005-11-27 14:26:30 +0100 (Sun, 27 Nov 2005)
New Revision: 1073

Modified:
   trunk/096/pkg/commands/config/info.cfg
   trunk/096/pkg/commands/gm/info.src
Log:
Populated the "Properties" section

Modified: trunk/096/pkg/commands/config/info.cfg
===================================================================
--- trunk/096/pkg/commands/config/info.cfg	2005-11-27 13:01:54 UTC (rev 1072)
+++ trunk/096/pkg/commands/config/info.cfg	2005-11-27 13:26:30 UTC (rev 1073)
@@ -69,6 +69,7 @@
 Elem	Index-General
 {
 	Group	NameAndTitles
+	Group	CommandLevels
 }
 
 Elem	Index-Location
@@ -102,6 +103,10 @@
 Elem	Index-Properties
 {
 	Group	Properties
+	Group	Colors
+	Group	Graphics
+	Group	Visibility
+	Group	Movement
 }
 
 Elem	Index-Stats & Vitals
@@ -157,6 +162,13 @@
 	Entry	member	Client_Version	clientversion
 }
 
+Group	CommandLevels
+{
+	AutoBox	1
+	Entry	member	Account_CmdLevel	acct.defaultcmdlevel
+	Entry	member	Character_CmdLevel	cmdlevel
+}
+
 Group	Account
 {
 	AutoBox	1
@@ -215,8 +227,39 @@
 Group	Properties
 {
 	AutoBox	1
+	Entry	member	Dead		dead
+	Entry	member	NPC_Template	npctemplate
 }
 
+Group	Colors
+{
+	AutoBox	1
+	Entry	member	Color		color		0	PropEdit
+	Entry	member	True_Color	truecolor	0	PropEdit
+}
+
+Group	Graphics
+{
+	AutoBox	1
+	Entry	member	Gender		gender		0	PropEdit
+	Entry	member	Graphic		graphic		0	PropEdit
+	Entry	member	True_Graphic	trueobjtype	0	PropEdit
+}
+
+Group	Movement
+{
+	AutoBox	1
+	Entry	member	Frozen		frozen		0	PropEdit
+	Entry	member	Paralyzed	paralyzed	0	PropEdit
+}
+
+Group	Visibility
+{
+	AutoBox	1
+	Entry	member	Hidden		hidden		0	PropEdit
+	Entry	member	Concealed	concealed	0	PropEdit
+}
+
 Group	Vitals
 {
 	Entry	Vitals

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-27 13:01:54 UTC (rev 1072)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-27 13:26:30 UTC (rev 1073)
@@ -160,7 +160,7 @@
 			value := Bin(CInt(value));
 			break;
 		"script":
-			value := GetScriptName(value);
+			value := ParseScriptName(value);
 			break;
 	endcase
 	GFTextRight(gump, 480, y_pos, 2100, value);
@@ -222,7 +222,7 @@
 			GFTextLine(gump, 175, y_pos, 2100, attrib_name);
 			var value := AP_GetTrueSkill(targ, attrib_name);
 			var mod_value := AP_GetSkillMod(targ, attrib_name);
-			GFTextRight(gump, 455, y_pos, 2100, value+" (+"+mod_value+")");
+			GFTextRight(gump, 465, y_pos, 2100, value+" (+"+mod_value+")");
 			y_pos := y_pos+20;
 			sleepms(2);
 		endforeach
@@ -301,6 +301,22 @@
 	return result;
 endfunction
 
+function ParseScriptName(path)
+	if ( !path )
+		return "None";
+	endif
+
+	while ( path["/"] )
+		// Breaks it down to just the file name.
+		var pos := Find(path, "/", 1);
+		path[1, pos] := "";
+		sleepms(2);
+	endwhile
+
+	return path;
+endfunction
+
+
 function GumpTemplate(targ)
 	var gump := GFCreateGump();
 	GFPage(gump, 0);
@@ -330,18 +346,3 @@
 
 	return gump;
 endfunction
-
-function GetScriptName(path)
-	if ( !path )
-		return "None";
-	endif
-
-	while ( path["/"] )
-		// Breaks it down to just the file name.
-		var pos := Find(path, "/", 1);
-		path[1, pos] := "";
-		sleepms(2);
-	endwhile
-
-	return path;
-endfunction



From austin at berlios.de  Sun Nov 27 16:46:00 2005
From: austin at berlios.de (austin at BerliOS)
Date: Sun, 27 Nov 2005 16:46:00 +0100
Subject: [Poldistro-svn] r1074 - in trunk/096/pkg/commands: config gm
Message-ID: <200511271546.jARFk0GX031485@sheep.berlios.de>

Author: austin
Date: 2005-11-27 16:45:59 +0100 (Sun, 27 Nov 2005)
New Revision: 1074

Modified:
   trunk/096/pkg/commands/config/info.cfg
   trunk/096/pkg/commands/gm/info.src
Log:
Added support for custom members

Modified: trunk/096/pkg/commands/config/info.cfg
===================================================================
--- trunk/096/pkg/commands/config/info.cfg	2005-11-27 13:26:30 UTC (rev 1073)
+++ trunk/096/pkg/commands/config/info.cfg	2005-11-27 15:45:59 UTC (rev 1074)
@@ -27,10 +27,6 @@
 #	// Display specific attribute
 #	Entry	Attribute	AttributeName
 #	Entry	Attribute	Swordsmanship
-#
-#	// Custom parameter (must edit BuildCustomEntry() and write a function to support this param type)
-#	Entry	Custom	EntryName (data)
-#	Entry	Custom	Reportables
 # }
 #
 ####################################
@@ -44,6 +40,7 @@
 	Index	Script
 	Index	Reputation
 	Index	Properties
+	Index	NPC Properties
 	Index	Stats & Vitals
 	Index	Skills
 	Index	Privileges
@@ -75,12 +72,14 @@
 Elem	Index-Location
 {
 	Group	Location
+	Group	Multi
 }
 
 Elem	Index-Client
 {
 	Group	Client
 	Group	Account
+	Group	GottenItem
 }
 
 Elem	Index-Combat
@@ -98,6 +97,7 @@
 Elem	Index-Reputation
 {
 	Group	Reputation
+	Group	Reportables
 }
 
 Elem	Index-Properties
@@ -109,6 +109,11 @@
 	Group	Movement
 }
 
+Elem	Index-NPC Properties
+{
+	Group	NPCProperties
+}
+
 Elem	Index-Stats & Vitals
 {
 	Group	Vitals
@@ -152,7 +157,14 @@
 	Entry	member	Y	y	0	CoordEdit
 	Entry	member	Z	z	0	CoordEdit
 	Entry	member	Realm	realm	0	CoordEdit
+	Entry	member	Facing	facing	0	PropEdit
 }
+Group	Multi
+{
+	AutoBox	1
+	Entry	member	Multi_Name	multi.desc
+	Entry	member	Multi_Serial	multi.serial	Hex
+}	
 
 Group	Client
 {
@@ -177,6 +189,13 @@
 	Entry	member	Account_Banned	acct.banned
 }
 
+Group	GottenItem
+{
+	AutoBox	1
+	Entry	custom	Gotten_Item_Name
+	Entry	custom	Gotten_Item_Serial	0	hex
+}	
+
 Group	Combat
 {
 	AutoBox	1
@@ -220,17 +239,34 @@
 	AutoBox	1
 	Entry	member	Criminal	criminal	0	CrimEdit
 	Entry	member	Murderer	murderer	0	MurdererEdit
-	Entry	blank
-	Entry	custom	Reportables	0
 }
 
+Group	Reportables
+{
+	Entry	Reportables
+}
+
 Group	Properties
 {
 	AutoBox	1
+	Entry	member	Serial_Number	serial		Hex
+	Entry	member	Poisoned	poisoned
+	Entry	member	Squelched	squelched
 	Entry	member	Dead		dead
-	Entry	member	NPC_Template	npctemplate
+	Entry	member	Height		height
+	Entry	member	Weight		weight
 }
 
+Group	NPCProperties
+{
+	AutoBox	1
+	Entry	member	NPC_Template		npctemplate
+	Entry	member	Speech_Color		speechcolor		0	PropEdit
+	Entry	member	Speech_Font		speechfont		0	PropEdit
+	Entry	member	Use_Adjustments		useadjustments		0	PropEdit
+	Entry	member	Run_Speed		runspeed		0	PropEdit
+}
+
 Group	Colors
 {
 	AutoBox	1
@@ -258,6 +294,7 @@
 	AutoBox	1
 	Entry	member	Hidden		hidden		0	PropEdit
 	Entry	member	Concealed	concealed	0	PropEdit
+	Entry	member	Stealth_Steps	stealthsteps	0	PropEdit
 }
 
 Group	Vitals

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-27 13:26:30 UTC (rev 1073)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-27 15:45:59 UTC (rev 1074)
@@ -95,7 +95,7 @@
 	foreach entry in ( entries )
 		entry := SplitWords(entry, " ");
 		case ( Lower(entry[1]) )
-			"member":
+			"member": "custom":
 				DisplayMember(targ, gump, entry, y_pos);
 				break;
 			"vitals":
@@ -115,10 +115,14 @@
 				DisplayStorageAreas(targ, gump, y_pos);
 				break;
 			"blank":
-				y_pos := y_pos+20;
+				var buffer := CInt(entry[2]);
+				if ( !buffer )
+					buffer := 20;
+				endif
+				y_pos := y_pos+buffer;
 				break;
-			"custom":
-				BuildCustomEntry(targ, gump, entry, y_pos);
+			"reportables":
+				DisplayReportables(targ, gump, y_pos);
 				break;
 			default:
 				GFTextLine(gump, 175, y_pos, 32, entry);
@@ -132,18 +136,6 @@
 	return 1;
 endfunction
 
-function BuildCustomEntry(targ, byref gump, byref entry, byref y_pos)
-	case ( Lower(entry[2]) )
-		"Weapon_Speed":
-		"Damage_Dice":
-		"Average_Damage":
-		default:
-		break;
-	endcase
-
-	return 1;
-endfunction
-
 function DisplayMember(targ, byref gump, byref entry, byref y_pos)
 	if ( entry[5] )
 		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
@@ -151,7 +143,16 @@
 
 	GFTextLine(gump, 175, y_pos, 2100, ParseEntryName(entry[2]));
 
-	var value := ParseMembers(targ, entry[3]);
+	var value := "";
+	if ( Lower(entry[1]) == "member" )
+		value := ParseMembers(targ, entry[3]);
+	else
+		value := GetCustom(targ, entry[2]);
+	endif
+	if ( value == error )
+		value := "None";
+	endif
+	
 	case ( Lower(entry[4]) )
 		"hex":
 			value := Hex(value);
@@ -275,6 +276,31 @@
 	return 1;
 endfunction
 
+function DisplayReportables(targ, byref gump, byref y_pos)
+	GFResizePic(gump, 145, y_pos, GFCfgConst("BackGrounds", "GoldTrim"), 340, 200);
+	var lines := "<CENTER><U>Reportables</U></CENTER><BR>";
+	foreach line in ( targ.reportables )
+		lines := "<B>o</B>"+lines+line+"<BR>";
+		sleepms(2);
+	endforeach
+	GFHTMLArea(gump, 155, y_pos+7, 325, 186, lines, 0, 1);
+	
+	y_pos := y_pos+340;	
+	return 1;
+endfunction
+
+function DisplayWeaponInfo(targ, byref gump, byref entry, byref y_pos)
+	var weapon := targ.weapon;
+	
+	case ( Lower(entry[1]) )
+		"weaponspeed": 
+		"damagedice": 
+		"averagedamage":
+	endcase
+	y_pos := y_pos+20;
+	return 1;
+endfunction
+
 function ParseEntryName(entry_name)
 	while ( entry_name["_"] )
 		entry_name["_"] := " ";
@@ -288,11 +314,10 @@
 	var result := targ;
 	foreach member in ( members )
 		var temp := result.Get_Member(member);
-		if ( temp != error )
+		if ( temp == error )
+			return error;
+		else
 			result := temp;
-		else
-			result := "None";
-			break;
 		endif
 
 		sleepms(2);
@@ -301,11 +326,24 @@
 	return result;
 endfunction
 
+function GetCustom(targ, property)
+	case ( Lower(property) )
+		"weapon_speed": 
+			return CS_GetWeaponInfo(targ.weapon, "Speed");
+		"damage_dice":
+			return CS_GetWeaponInfo(targ.weapon, "Damage");
+		"average_damage":
+			return CS_GetAverageDamage(targ.weapon);
+		"gotten_item_name":
+			return targ.GetGottenItem().desc;
+		"gotten_item_serial":
+			return targ.GetGottenItem().serial;
+	endcase
+	
+	return "Unknown custom type!";
+endfunction
+
 function ParseScriptName(path)
-	if ( !path )
-		return "None";
-	endif
-
 	while ( path["/"] )
 		// Breaks it down to just the file name.
 		var pos := Find(path, "/", 1);



From austin at berlios.de  Tue Nov 29 11:41:47 2005
From: austin at berlios.de (austin at BerliOS)
Date: Tue, 29 Nov 2005 11:41:47 +0100
Subject: [Poldistro-svn] r1075 - in trunk/096/pkg/commands: config gm
Message-ID: <200511291041.jATAfltO019504@sheep.berlios.de>

Author: austin
Date: 2005-11-29 11:41:42 +0100 (Tue, 29 Nov 2005)
New Revision: 1075

Modified:
   trunk/096/pkg/commands/config/info.cfg
   trunk/096/pkg/commands/gm/info.src
Log:
.info appearance is done.. now to make the buttons work!
Ill add support for "squiggily-doos" maybe too.

Modified: trunk/096/pkg/commands/config/info.cfg
===================================================================
--- trunk/096/pkg/commands/config/info.cfg	2005-11-27 15:45:59 UTC (rev 1074)
+++ trunk/096/pkg/commands/config/info.cfg	2005-11-29 10:41:42 UTC (rev 1075)
@@ -137,9 +137,13 @@
 	Group	Storage
 }
 
+Elem	Index-Miscellaneous
+{
+	AutoBox	1
+	Entry	Blank
+	Entry	Blank
+}
 
-
-
 Group	NameAndTitles
 {
 	AutoBox	1
@@ -169,7 +173,7 @@
 Group	Client
 {
 	AutoBox	1
-	Entry	member	Connected	connected
+	Entry	member	Connected	connected	0	Disconnect
 	Entry	member	IP_Address	ip
 	Entry	member	Client_Version	clientversion
 }
@@ -251,7 +255,7 @@
 	AutoBox	1
 	Entry	member	Serial_Number	serial		Hex
 	Entry	member	Poisoned	poisoned
-	Entry	member	Squelched	squelched
+	Entry	member	Squelched	squelched	0	PropEdit
 	Entry	member	Dead		dead
 	Entry	member	Height		height
 	Entry	member	Weight		weight

Modified: trunk/096/pkg/commands/gm/info.src
===================================================================
--- trunk/096/pkg/commands/gm/info.src	2005-11-27 15:45:59 UTC (rev 1074)
+++ trunk/096/pkg/commands/gm/info.src	2005-11-29 10:41:42 UTC (rev 1075)
@@ -86,7 +86,7 @@
 	if ( entries.Size() < 1 )
 		return 0;
 	endif
-	
+
 	if ( cfg_elem.AutoBox )
 		var num_entries := entries.Size();
 		GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_entries*20));
@@ -106,7 +106,7 @@
 				break;
 			"privileges":
 				DisplayPrivileges(targ, gump, y_pos);
-				break;	
+				break;
 			"text":
 				GFTextLine(gump, 175, y_pos, 2100, entry);
 				y_pos := y_pos+20;
@@ -132,7 +132,7 @@
 		sleepms(2);
 	endforeach
 	y_pos := y_pos+5;
-		
+
 	return 1;
 endfunction
 
@@ -152,7 +152,7 @@
 	if ( value == error )
 		value := "None";
 	endif
-	
+
 	case ( Lower(entry[4]) )
 		"hex":
 			value := Hex(value);
@@ -198,7 +198,7 @@
 	// With this in mind, the array must be broken once for the first page.
 	// Then broken again for the remaining pages. Not the most 'efficient' way I suppose.
 	//
-	
+
 	var y_space := (END_Y-y_pos)+START_Y;
 	var available_lines := CInt(y_space / 20);
 	var num_attribs := attributes.Size();
@@ -210,14 +210,21 @@
 		attributes := BreakArray(rest, 20);
 		attributes.Insert(1, page_1);
 	endif
-		
+
+	var num_groups := attributes.Size();
 	foreach group in ( attributes )
 		num_attribs := group.Size();
-		GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, num_attribs*20);
+
+		var y_stretch := num_attribs * 20;
+		if ( _group_iter < num_groups )
+			y_stretch := y_stretch + 10;
+		endif
+		
+		GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, y_stretch);
 		if ( _group_iter > 1 )
 			GFAddButton(gump, 460, START_Y+5, 2650, 2651, GF_PAGE_BTN, gump.cur_page-1);
 		endif
-		
+
 		foreach attrib_name in ( group )
 			GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
 			GFTextLine(gump, 175, y_pos, 2100, attrib_name);
@@ -228,7 +235,7 @@
 			sleepms(2);
 		endforeach
 
-		if ( _group_iter < attributes.Size() )
+		if ( _group_iter < num_groups )
 			GFAddButton(gump, 460, 430, 2648, 2649, GF_PAGE_BTN, gump.cur_page+1);
 			GFPage(gump, gump.cur_page+1);
 			y_pos := START_Y;
@@ -243,13 +250,19 @@
 function DisplayPrivileges(targ, byref gump, byref y_pos)
 	var privs := info_cfg["PrivList"];
 	privs := GetConfigStringArray(privs, "Priv");
-	
+
 	var num_privs := privs.Size();
 	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_privs*20));
 	foreach priv_name in ( privs )
 		GFAddButton(gump, 150, (y_pos+3), 2117, 2118, GF_CLOSE_BTN);
 		GFTextLine(gump, 175, y_pos, 2100, priv_name);
-		GFTextRight(gump, 480, y_pos, 2100, targ.Enabled(priv_name));
+		
+		var status := "Disabled";
+		if ( targ.Enabled(priv_name) )
+			status := "Enabled";
+		endif
+		
+		GFTextRight(gump, 480, y_pos, 2100, status);
 		y_pos := y_pos+20;
 		sleepms(2);
 	endforeach
@@ -258,9 +271,9 @@
 endfunction
 
 function DisplayStorageAreas(targ, byref gump, byref y_pos)
-	
+
 	var storage_areas := CP_GetStorageAreaNames();
-	
+
 	var num_areas := storage_areas.Size();
 	GFResizePic(gump, 145, y_pos, GFCfgConst("Defaults", "ForeGround"), 340, (num_areas*20));
 	foreach area_name in ( storage_areas )
@@ -284,17 +297,17 @@
 		sleepms(2);
 	endforeach
 	GFHTMLArea(gump, 155, y_pos+7, 325, 186, lines, 0, 1);
-	
-	y_pos := y_pos+340;	
+
+	y_pos := y_pos+340;
 	return 1;
 endfunction
 
 function DisplayWeaponInfo(targ, byref gump, byref entry, byref y_pos)
 	var weapon := targ.weapon;
-	
+
 	case ( Lower(entry[1]) )
-		"weaponspeed": 
-		"damagedice": 
+		"weaponspeed":
+		"damagedice":
 		"averagedamage":
 	endcase
 	y_pos := y_pos+20;
@@ -328,7 +341,7 @@
 
 function GetCustom(targ, property)
 	case ( Lower(property) )
-		"weapon_speed": 
+		"weapon_speed":
 			return CS_GetWeaponInfo(targ.weapon, "Speed");
 		"damage_dice":
 			return CS_GetWeaponInfo(targ.weapon, "Damage");
@@ -339,7 +352,7 @@
 		"gotten_item_serial":
 			return targ.GetGottenItem().serial;
 	endcase
-	
+
 	return "Unknown custom type!";
 endfunction
 



