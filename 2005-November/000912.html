<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Poldistro-svn] r938 - in trunk/096/pkg: items/bountyboard items/food/config items/food/include items/guildstone items/moongates items/moongates/config items/walkOn/energyField items/walkOn/fireField items/walkOn/paraField items/walkOn/poisonField items/walkOn/spiderWeb mobiles/brainAI/complete/blackEye mobiles/brainAI/scripts/combat skills/magery/delay skills/magery/spellScripts/circle1 systems/loot/configs/OLD systems/spawnSystem/config/OLD
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/poldistro-svn/2005-November/index.html" >
   <LINK REL="made" HREF="mailto:poldistro-svn%40lists.berlios.de?Subject=Re%3A%20%5BPoldistro-svn%5D%20r938%20-%20in%20trunk/096/pkg%3A%20items/bountyboard%20items/food/config%20items/food/include%20items/guildstone%20items/moongates%20items/moongates/config%20items/walkOn/energyField%20items/walkOn/fireField%20items/walkOn/paraField%20items/walkOn/poisonField%20items/walkOn/spiderWeb%20mobiles/brainAI/complete/blackEye%20mobiles/brainAI/scripts/combat%20skills/magery/delay%20skills/magery/spellScripts/circle1%20systems/loot/configs/OLD%20systems/spawnSystem/config/OLD&In-Reply-To=%3C200511070623.jA76NAQT020947%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000911.html">
   <LINK REL="Next"  HREF="000913.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Poldistro-svn] r938 - in trunk/096/pkg: items/bountyboard items/food/config items/food/include items/guildstone items/moongates items/moongates/config items/walkOn/energyField items/walkOn/fireField items/walkOn/paraField items/walkOn/poisonField items/walkOn/spiderWeb mobiles/brainAI/complete/blackEye mobiles/brainAI/scripts/combat skills/magery/delay skills/magery/spellScripts/circle1 systems/loot/configs/OLD systems/spawnSystem/config/OLD</H1>
    <B>Scott E. Royalty at BerliOS</B> 
    <A HREF="mailto:poldistro-svn%40lists.berlios.de?Subject=Re%3A%20%5BPoldistro-svn%5D%20r938%20-%20in%20trunk/096/pkg%3A%20items/bountyboard%20items/food/config%20items/food/include%20items/guildstone%20items/moongates%20items/moongates/config%20items/walkOn/energyField%20items/walkOn/fireField%20items/walkOn/paraField%20items/walkOn/poisonField%20items/walkOn/spiderWeb%20mobiles/brainAI/complete/blackEye%20mobiles/brainAI/scripts/combat%20skills/magery/delay%20skills/magery/spellScripts/circle1%20systems/loot/configs/OLD%20systems/spawnSystem/config/OLD&In-Reply-To=%3C200511070623.jA76NAQT020947%40sheep.berlios.de%3E"
       TITLE="[Poldistro-svn] r938 - in trunk/096/pkg: items/bountyboard items/food/config items/food/include items/guildstone items/moongates items/moongates/config items/walkOn/energyField items/walkOn/fireField items/walkOn/paraField items/walkOn/poisonField items/walkOn/spiderWeb mobiles/brainAI/complete/blackEye mobiles/brainAI/scripts/combat skills/magery/delay skills/magery/spellScripts/circle1 systems/loot/configs/OLD systems/spawnSystem/config/OLD">muaddiblsd at berlios.de
       </A><BR>
    <I>Mon Nov  7 07:23:10 CET 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000911.html">[Poldistro-svn] r937 - in trunk/096: pkg/commands/seer pkg/items/bountyboard pkg/mobiles/death pkg/mobiles/oldAI pkg/skills/magery pkg/systems/boat pkg/systems/stafflist scripts scripts/include/OLD scripts/misc
</A></li>
        <LI>Next message: <A HREF="000913.html">[Poldistro-svn] r939 - trunk/096/pkg/packetHooks/BFCommand
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#912">[ date ]</a>
              <a href="thread.html#912">[ thread ]</a>
              <a href="subject.html#912">[ subject ]</a>
              <a href="author.html#912">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: muaddiblsd
Date: 2005-11-07 07:22:45 +0100 (Mon, 07 Nov 2005)
New Revision: 938

Added:
   trunk/096/pkg/items/moongates/autoload.cfg
   trunk/096/pkg/items/moongates/config/
   trunk/096/pkg/items/moongates/config/moongate.cfg
   trunk/096/pkg/items/moongates/moongateInit.src
Removed:
   trunk/096/pkg/items/moongates/moongate.cfg
   trunk/096/pkg/items/moongates/moongates.inc
   trunk/096/pkg/items/moongates/start.src
Modified:
   trunk/096/pkg/items/bountyboard/autoload.cfg
   trunk/096/pkg/items/food/config/food.cfg
   trunk/096/pkg/items/food/include/food.inc
   trunk/096/pkg/items/guildstone/autoload.cfg
   trunk/096/pkg/items/walkOn/energyField/control.src
   trunk/096/pkg/items/walkOn/energyField/methods.src
   trunk/096/pkg/items/walkOn/fireField/methods.src
   trunk/096/pkg/items/walkOn/paraField/methods.src
   trunk/096/pkg/items/walkOn/poisonField/methods.src
   trunk/096/pkg/items/walkOn/spiderWeb/methods.src
   trunk/096/pkg/mobiles/brainAI/complete/blackEye/combat.src
   trunk/096/pkg/mobiles/brainAI/complete/blackEye/virtual.src
   trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
   trunk/096/pkg/skills/magery/delay/delayCheck.src
   trunk/096/pkg/skills/magery/spellScripts/circle1/createFood.src
   trunk/096/pkg/systems/loot/configs/OLD/lootgroup.cfg
   trunk/096/pkg/systems/loot/configs/OLD/nlootgroup.cfg
   trunk/096/pkg/systems/spawnSystem/config/OLD/spawngroups.cfg
   trunk/096/pkg/systems/spawnSystem/config/OLD/spawnregions.cfg
Log:
Update for $Id$ property.

New moongates package. Upgraded it for autoload.cfg, and also rewrote the src. Now uses a formatted config for if a realm should be generated for moongates and added to the menu on the gump.

Still need to make the gump use this new system. Also, need to finish testing out the moongates pkg. Testing was limited for me, so recommend more.


Property changes on: trunk/096/pkg/items/bountyboard/autoload.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/food/config/food.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/food/include/food.inc
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/guildstone/autoload.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/moongates/autoload.cfg
===================================================================
--- trunk/096/pkg/items/moongates/autoload.cfg	2005-11-07 01:20:20 UTC (rev 937)
+++ trunk/096/pkg/items/moongates/autoload.cfg	2005-11-07 06:22:45 UTC (rev 938)
@@ -0,0 +1,9 @@
+# $Id$
+
+Autoload moongateInit
+{
+	Script      moongateInit
+	Resistent   1
+	Name        Town Moongate Initializer
+	Priority    0
+}


Property changes on: trunk/096/pkg/items/moongates/autoload.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/096/pkg/items/moongates/config/moongate.cfg
===================================================================
--- trunk/096/pkg/items/moongates/config/moongate.cfg	2005-11-07 01:20:20 UTC (rev 937)
+++ trunk/096/pkg/items/moongates/config/moongate.cfg	2005-11-07 06:22:45 UTC (rev 938)
@@ -0,0 +1,50 @@
+# $Id$
+#
+#
+###############################
+# Moongates Setup File:
+#
+# Purpose:
+# Each entry in this file contains
+# three element types. Realm, Active,
+# and Town. The Realm element is the
+# string name for the realm it is for.
+# Active, is the setting that will
+# decide if you want town gates to
+# include this realm. Town elements
+# can be as many as you need. Although
+# Don't get too carried away. The
+# layout for them are as follows:
+# X Y Z TownName. The TownName part
+# of the string is the name as it
+# would appear in your gump for the
+# moongates.
+#
+###############################
+Setting britannia
+{
+	Realm		britannia
+	Active		1
+	Town		4467 1283 5 Moonglow
+	Town		1336 1997 5 Britain
+	Town		1499 3771 5 Jhelom
+	Town		771 753 5 Yew
+	Town		2701 693 5 Minoc
+	Town		1828 2948 -20 Trinsic
+	Town		643 2067 5 Skara
+	Town		3564 2140 34 Magincia
+}
+
+Setting britannia_alt
+{
+	Realm		britannia_alt
+	Active		1
+	Town		4467 1283 5 Moonglow
+	Town		1336 1997 5 Britain
+	Town		1499 3771 5 Jhelom
+	Town		771 753 5 Yew
+	Town		2701 693 5 Minoc
+	Town		1828 2948 -20 Trinsic
+	Town		643 2067 5 Skara
+	Town		3564 2140 34 Magincia
+}
\ No newline at end of file


Property changes on: trunk/096/pkg/items/moongates/config/moongate.cfg
___________________________________________________________________
Name: svn:keywords
   + Id

Deleted: trunk/096/pkg/items/moongates/moongate.cfg
===================================================================
--- trunk/096/pkg/items/moongates/moongate.cfg	2005-11-07 01:20:20 UTC (rev 937)
+++ trunk/096/pkg/items/moongates/moongate.cfg	2005-11-07 06:22:45 UTC (rev 938)
@@ -1,16 +0,0 @@
-# $Id$
-#
-#
-###############################
-# system settings:
-# currently with core 94 there is no handling for the new ishtar
-# world map, nor is there handling for facets. when core support
-# becomes available, admins will be able to change the &quot;Value&quot;
-# setting to &quot;2&quot; to enable moongates to allow players to travel
-# to the new lands and/or facets. At this time, only setting &quot;1&quot;
-# is supported.
-###############################
-Setting Facets
-{
-    Value   1
-}

Copied: trunk/096/pkg/items/moongates/moongateInit.src (from rev 902, trunk/096/pkg/items/moongates/moongates.inc)
===================================================================
--- trunk/096/pkg/items/moongates/moongates.inc	2005-11-05 07:46:41 UTC (rev 902)
+++ trunk/096/pkg/items/moongates/moongateInit.src	2005-11-07 06:22:45 UTC (rev 938)
@@ -0,0 +1,47 @@
+use uo;
+use os;
+
+include &quot;:logger:log&quot;;
+
+var mgate_config := ReadConfigFile(&quot;:moongates:config/moongate&quot;);
+
+program CreateMoongates()
+	var facet_list := GetConfigStringKeys(mgate_config);
+	if( facet_list.errortext )
+        	Log(LOG_ERROR, &quot;Moongate Facet List Failed Config Read '&quot; + GetLogInfo(facet_list) + &quot;'&quot;);
+		return 0;
+	endif
+  	syslog( &quot;Creating moongates.&quot; );
+	foreach key_name in facet_list
+		var key_elem := FindConfigElem(mgate_config, key_name);
+		if( GetConfigInt(key_elem, &quot;Active&quot;) == 1 )
+			var gate_realm := GetConfigString(key_elem, &quot;Realm&quot;);
+			var gate_towns := GetConfigStringArray(key_elem, &quot;Town&quot;);
+			foreach town_entry in gate_towns
+				var gate := SplitWords(town_entry);
+				RemoveOldGates(gate, gate_realm);
+				CreateNewGates(gate, gate_realm);
+			endforeach
+		endif
+	endforeach
+endprogram
+
+
+function RemoveOldGates(gate, gate_realm)
+	foreach thing in ListItemsNearLocation(CInt(gate[1]), CInt(gate[2]), CInt(gate[3]), 0, gate_realm);
+		if(thing.objtype != 0x887b)
+			DestroyItem(thing);
+		endif
+	endforeach
+	return 1;
+endfunction
+
+
+function CreateNewGates(gate, gate_realm)
+	var moongate := CreateItemAtLocation(CInt(gate[1]), CInt(gate[2]), CInt(gate[3]), &quot;systemmoongate&quot;, 1, gate_realm);
+	SetObjProperty(moongate, &quot;City&quot;, gate[4]);
+	moongate.facing := 29;
+	moongate.decayAt := 0;
+	moongate.movable := 0;
+	return 1;
+endfunction
\ No newline at end of file

Deleted: trunk/096/pkg/items/moongates/moongates.inc
===================================================================
--- trunk/096/pkg/items/moongates/moongates.inc	2005-11-07 01:20:20 UTC (rev 937)
+++ trunk/096/pkg/items/moongates/moongates.inc	2005-11-07 06:22:45 UTC (rev 938)
@@ -1,38 +0,0 @@
-use uo;
-use os;
-
-function CreateMoongates()
-  var moongates := {
-	{4467,	1283,	5, &quot;Moonglow&quot;, &quot;britannia&quot;},		// moonglow
-    {1336,	1997,	5, &quot;Britain&quot;, &quot;britannia&quot;},		// britain
-    {1499,	3771,	5, &quot;Jhelom&quot;, &quot;britannia&quot;},		// jehlom
-	{771,	753,	5, &quot;Yew&quot;, &quot;britannia&quot;},		    // yew
-    {2701,	693,	5, &quot;Minoc&quot;, &quot;britannia&quot;},		// minoc
-    {1828,	2948, -20, &quot;Trinsic&quot;, &quot;britannia&quot;},	    // trinsic
-    {643,	2067,	5, &quot;Skara&quot;, &quot;britannia&quot;},		// skara
-    {3564,	2140,  34, &quot;Magincia&quot;, &quot;britannia&quot;}, 	    // magincia
-    
-	{4467,	1283,	5, &quot;Moonglow&quot;, &quot;britannia_alt&quot;},		// moonglow
-    {1336,	1997,	5, &quot;Britain&quot;, &quot;britannia_alt&quot;},		// britain
-    {1499,	3771,	5, &quot;Jhelom&quot;, &quot;britannia_alt&quot;},		// jehlom
-	{771,	753,	5, &quot;Yew&quot;, &quot;britannia_alt&quot;},		    // yew
-    {2701,	693,	5, &quot;Minoc&quot;, &quot;britannia_alt&quot;},		// minoc
-    {1828,	2948, -20, &quot;Trinsic&quot;, &quot;britannia_alt&quot;},	    // trinsic
-    {643,	2067,	5, &quot;Skara&quot;, &quot;britannia_alt&quot;},		// skara
-    {3564,	2140,  34, &quot;Magincia&quot;, &quot;britannia_alt&quot;} 	    // magincia    
-  };
-  var moongate;
-  syslog( &quot;Creating moongates.&quot; );
-  foreach gate in moongates
-    foreach thing in ListItemsNearLocation(gate[1], gate[2], gate[3], 0, gate[5]);
-      if(thing.objtype != 0x887b)
-        DestroyItem(thing);
-      endif
-    endforeach
-	moongate := CreateItemAtLocation( gate[1], gate[2], gate[3], &quot;systemmoongate&quot;, 1, gate[5] );
-    SetObjProperty(moongate, &quot;City&quot;, gate[4]);
-    moongate.facing := 29;
-    moongate.decayAt := 0;
-    moongate.movable := 0;
-  endforeach
-endfunction

Deleted: trunk/096/pkg/items/moongates/start.src
===================================================================
--- trunk/096/pkg/items/moongates/start.src	2005-11-07 01:20:20 UTC (rev 937)
+++ trunk/096/pkg/items/moongates/start.src	2005-11-07 06:22:45 UTC (rev 938)
@@ -1,6 +0,0 @@
-use uo;
-
-include &quot;moongates&quot;;
-
-print(&quot;Initializing moongates&quot;);
-CreateMoongates();


Property changes on: trunk/096/pkg/items/walkOn/energyField/control.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/walkOn/energyField/methods.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/walkOn/fireField/methods.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/walkOn/paraField/methods.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/walkOn/poisonField/methods.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/items/walkOn/spiderWeb/methods.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/complete/blackEye/combat.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/complete/blackEye/virtual.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/mobiles/brainAI/scripts/combat/fireBeetle.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/delay/delayCheck.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/skills/magery/spellScripts/circle1/createFood.src
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/loot/configs/OLD/lootgroup.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/loot/configs/OLD/nlootgroup.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/spawnSystem/config/OLD/spawngroups.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


Property changes on: trunk/096/pkg/systems/spawnSystem/config/OLD/spawnregions.cfg
___________________________________________________________________
Name: svn:keywords
   + Id


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000911.html">[Poldistro-svn] r937 - in trunk/096: pkg/commands/seer pkg/items/bountyboard pkg/mobiles/death pkg/mobiles/oldAI pkg/skills/magery pkg/systems/boat pkg/systems/stafflist scripts scripts/include/OLD scripts/misc
</A></li>
	<LI>Next message: <A HREF="000913.html">[Poldistro-svn] r939 - trunk/096/pkg/packetHooks/BFCommand
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#912">[ date ]</a>
              <a href="thread.html#912">[ thread ]</a>
              <a href="subject.html#912">[ subject ]</a>
              <a href="author.html#912">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/poldistro-svn">More information about the Poldistro-svn
mailing list</a><br>
</body></html>
